const zb=function(){const p=document.createElement("link").relList;if(p&&p.supports&&p.supports("modulepreload"))return;for(const T of document.querySelectorAll('link[rel="modulepreload"]'))b(T);new MutationObserver(T=>{for(const I of T)if(I.type==="childList")for(const D of I.addedNodes)D.tagName==="LINK"&&D.rel==="modulepreload"&&b(D)}).observe(document,{childList:!0,subtree:!0});function y(T){const I={};return T.integrity&&(I.integrity=T.integrity),T.referrerpolicy&&(I.referrerPolicy=T.referrerpolicy),T.crossorigin==="use-credentials"?I.credentials="include":T.crossorigin==="anonymous"?I.credentials="omit":I.credentials="same-origin",I}function b(T){if(T.ep)return;T.ep=!0;const I=y(T);fetch(T.href,I)}};zb();function cm(c,p){const y=Object.create(null),b=c.split(",");for(let T=0;T<b.length;T++)y[b[T]]=!0;return p?T=>!!y[T.toLowerCase()]:T=>!!y[T]}const kb="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Db=cm(kb);function p1(c){return!!c||c===""}function um(c){if(Qt(c)){const p={};for(let y=0;y<c.length;y++){const b=c[y],T=yn(b)?Lb(b):um(b);if(T)for(const I in T)p[I]=T[I]}return p}else{if(yn(c))return c;if(hn(c))return c}}const Pb=/;(?![^(]*\))/g,Bb=/:(.+)/;function Lb(c){const p={};return c.split(Pb).forEach(y=>{if(y){const b=y.split(Bb);b.length>1&&(p[b[0].trim()]=b[1].trim())}}),p}function Bl(c){let p="";if(yn(c))p=c;else if(Qt(c))for(let y=0;y<c.length;y++){const b=Bl(c[y]);b&&(p+=b+" ")}else if(hn(c))for(const y in c)c[y]&&(p+=y+" ");return p.trim()}const Qg=c=>yn(c)?c:c==null?"":Qt(c)||hn(c)&&(c.toString===g1||!Jt(c.toString))?JSON.stringify(c,f1,2):String(c),f1=(c,p)=>p&&p.__v_isRef?f1(c,p.value):kl(p)?{[`Map(${p.size})`]:[...p.entries()].reduce((y,[b,T])=>(y[`${b} =>`]=T,y),{})}:m1(p)?{[`Set(${p.size})`]:[...p.values()]}:hn(p)&&!Qt(p)&&!y1(p)?String(p):p,Bi={},zl=[],Lr=()=>{},Rb=()=>!1,Ob=/^on[^a-z]/,Dd=c=>Ob.test(c),hm=c=>c.startsWith("onUpdate:"),Nn=Object.assign,dm=(c,p)=>{const y=c.indexOf(p);y>-1&&c.splice(y,1)},Fb=Object.prototype.hasOwnProperty,pi=(c,p)=>Fb.call(c,p),Qt=Array.isArray,kl=c=>Pd(c)==="[object Map]",m1=c=>Pd(c)==="[object Set]",Jt=c=>typeof c=="function",yn=c=>typeof c=="string",pm=c=>typeof c=="symbol",hn=c=>c!==null&&typeof c=="object",_1=c=>hn(c)&&Jt(c.then)&&Jt(c.catch),g1=Object.prototype.toString,Pd=c=>g1.call(c),Nb=c=>Pd(c).slice(8,-1),y1=c=>Pd(c)==="[object Object]",fm=c=>yn(c)&&c!=="NaN"&&c[0]!=="-"&&""+parseInt(c,10)===c,hd=cm(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Bd=c=>{const p=Object.create(null);return y=>p[y]||(p[y]=c(y))},Ub=/-(\w)/g,co=Bd(c=>c.replace(Ub,(p,y)=>y?y.toUpperCase():"")),Vb=/\B([A-Z])/g,Fl=Bd(c=>c.replace(Vb,"-$1").toLowerCase()),Ld=Bd(c=>c.charAt(0).toUpperCase()+c.slice(1)),xf=Bd(c=>c?`on${Ld(c)}`:""),wu=(c,p)=>!Object.is(c,p),vf=(c,p)=>{for(let y=0;y<c.length;y++)c[y](p)},vd=(c,p,y)=>{Object.defineProperty(c,p,{configurable:!0,enumerable:!1,value:y})},jb=c=>{const p=parseFloat(c);return isNaN(p)?c:p};let Kg;const Gb=()=>Kg||(Kg=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});let no;class x1{constructor(p=!1){this.active=!0,this.effects=[],this.cleanups=[],!p&&no&&(this.parent=no,this.index=(no.scopes||(no.scopes=[])).push(this)-1)}run(p){if(this.active){const y=no;try{return no=this,p()}finally{no=y}}}on(){no=this}off(){no=this.parent}stop(p){if(this.active){let y,b;for(y=0,b=this.effects.length;y<b;y++)this.effects[y].stop();for(y=0,b=this.cleanups.length;y<b;y++)this.cleanups[y]();if(this.scopes)for(y=0,b=this.scopes.length;y<b;y++)this.scopes[y].stop(!0);if(this.parent&&!p){const T=this.parent.scopes.pop();T&&T!==this&&(this.parent.scopes[this.index]=T,T.index=this.index)}this.active=!1}}}function Zb(c){return new x1(c)}function qb(c,p=no){p&&p.active&&p.effects.push(c)}const mm=c=>{const p=new Set(c);return p.w=0,p.n=0,p},v1=c=>(c.w&Is)>0,b1=c=>(c.n&Is)>0,Wb=({deps:c})=>{if(c.length)for(let p=0;p<c.length;p++)c[p].w|=Is},Hb=c=>{const{deps:p}=c;if(p.length){let y=0;for(let b=0;b<p.length;b++){const T=p[b];v1(T)&&!b1(T)?T.delete(c):p[y++]=T,T.w&=~Is,T.n&=~Is}p.length=y}},Df=new WeakMap;let uu=0,Is=1;const Pf=30;let so;const xa=Symbol(""),Bf=Symbol("");class _m{constructor(p,y=null,b){this.fn=p,this.scheduler=y,this.active=!0,this.deps=[],this.parent=void 0,qb(this,b)}run(){if(!this.active)return this.fn();let p=so,y=Cs;for(;p;){if(p===this)return;p=p.parent}try{return this.parent=so,so=this,Cs=!0,Is=1<<++uu,uu<=Pf?Wb(this):$g(this),this.fn()}finally{uu<=Pf&&Hb(this),Is=1<<--uu,so=this.parent,Cs=y,this.parent=void 0}}stop(){this.active&&($g(this),this.onStop&&this.onStop(),this.active=!1)}}function $g(c){const{deps:p}=c;if(p.length){for(let y=0;y<p.length;y++)p[y].delete(c);p.length=0}}let Cs=!0;const A1=[];function Nl(){A1.push(Cs),Cs=!1}function Ul(){const c=A1.pop();Cs=c===void 0?!0:c}function hr(c,p,y){if(Cs&&so){let b=Df.get(c);b||Df.set(c,b=new Map);let T=b.get(y);T||b.set(y,T=mm()),w1(T)}}function w1(c,p){let y=!1;uu<=Pf?b1(c)||(c.n|=Is,y=!v1(c)):y=!c.has(so),y&&(c.add(so),so.deps.push(c))}function Oo(c,p,y,b,T,I){const D=Df.get(c);if(!D)return;let o=[];if(p==="clear")o=[...D.values()];else if(y==="length"&&Qt(c))D.forEach((U,oe)=>{(oe==="length"||oe>=b)&&o.push(U)});else switch(y!==void 0&&o.push(D.get(y)),p){case"add":Qt(c)?fm(y)&&o.push(D.get("length")):(o.push(D.get(xa)),kl(c)&&o.push(D.get(Bf)));break;case"delete":Qt(c)||(o.push(D.get(xa)),kl(c)&&o.push(D.get(Bf)));break;case"set":kl(c)&&o.push(D.get(xa));break}if(o.length===1)o[0]&&Lf(o[0]);else{const U=[];for(const oe of o)oe&&U.push(...oe);Lf(mm(U))}}function Lf(c,p){for(const y of Qt(c)?c:[...c])(y!==so||y.allowRecurse)&&(y.scheduler?y.scheduler():y.run())}const Yb=cm("__proto__,__v_isRef,__isVue"),T1=new Set(Object.getOwnPropertyNames(Symbol).map(c=>Symbol[c]).filter(pm)),Xb=gm(),Qb=gm(!1,!0),Kb=gm(!0),Jg=$b();function $b(){const c={};return["includes","indexOf","lastIndexOf"].forEach(p=>{c[p]=function(...y){const b=wi(this);for(let I=0,D=this.length;I<D;I++)hr(b,"get",I+"");const T=b[p](...y);return T===-1||T===!1?b[p](...y.map(wi)):T}}),["push","pop","shift","unshift","splice"].forEach(p=>{c[p]=function(...y){Nl();const b=wi(this)[p].apply(this,y);return Ul(),b}}),c}function gm(c=!1,p=!1){return function(b,T,I){if(T==="__v_isReactive")return!c;if(T==="__v_isReadonly")return c;if(T==="__v_isShallow")return p;if(T==="__v_raw"&&I===(c?p?f2:I1:p?S1:M1).get(b))return b;const D=Qt(b);if(!c&&D&&pi(Jg,T))return Reflect.get(Jg,T,I);const o=Reflect.get(b,T,I);return(pm(T)?T1.has(T):Yb(T))||(c||hr(b,"get",T),p)?o:gn(o)?!D||!fm(T)?o.value:o:hn(o)?c?z1(o):Vl(o):o}}const Jb=E1(),e2=E1(!0);function E1(c=!1){return function(y,b,T,I){let D=y[b];if(Tu(D)&&gn(D)&&!gn(T))return!1;if(!c&&!Tu(T)&&(k1(T)||(T=wi(T),D=wi(D)),!Qt(y)&&gn(D)&&!gn(T)))return D.value=T,!0;const o=Qt(y)&&fm(b)?Number(b)<y.length:pi(y,b),U=Reflect.set(y,b,T,I);return y===wi(I)&&(o?wu(T,D)&&Oo(y,"set",b,T):Oo(y,"add",b,T)),U}}function t2(c,p){const y=pi(c,p);c[p];const b=Reflect.deleteProperty(c,p);return b&&y&&Oo(c,"delete",p,void 0),b}function i2(c,p){const y=Reflect.has(c,p);return(!pm(p)||!T1.has(p))&&hr(c,"has",p),y}function n2(c){return hr(c,"iterate",Qt(c)?"length":xa),Reflect.ownKeys(c)}const C1={get:Xb,set:Jb,deleteProperty:t2,has:i2,ownKeys:n2},r2={get:Kb,set(c,p){return!0},deleteProperty(c,p){return!0}},o2=Nn({},C1,{get:Qb,set:e2}),ym=c=>c,Rd=c=>Reflect.getPrototypeOf(c);function od(c,p,y=!1,b=!1){c=c.__v_raw;const T=wi(c),I=wi(p);p!==I&&!y&&hr(T,"get",p),!y&&hr(T,"get",I);const{has:D}=Rd(T),o=b?ym:y?Am:Eu;if(D.call(T,p))return o(c.get(p));if(D.call(T,I))return o(c.get(I));c!==T&&c.get(p)}function sd(c,p=!1){const y=this.__v_raw,b=wi(y),T=wi(c);return c!==T&&!p&&hr(b,"has",c),!p&&hr(b,"has",T),c===T?y.has(c):y.has(c)||y.has(T)}function ad(c,p=!1){return c=c.__v_raw,!p&&hr(wi(c),"iterate",xa),Reflect.get(c,"size",c)}function ey(c){c=wi(c);const p=wi(this);return Rd(p).has.call(p,c)||(p.add(c),Oo(p,"add",c,c)),this}function ty(c,p){p=wi(p);const y=wi(this),{has:b,get:T}=Rd(y);let I=b.call(y,c);I||(c=wi(c),I=b.call(y,c));const D=T.call(y,c);return y.set(c,p),I?wu(p,D)&&Oo(y,"set",c,p):Oo(y,"add",c,p),this}function iy(c){const p=wi(this),{has:y,get:b}=Rd(p);let T=y.call(p,c);T||(c=wi(c),T=y.call(p,c)),b&&b.call(p,c);const I=p.delete(c);return T&&Oo(p,"delete",c,void 0),I}function ny(){const c=wi(this),p=c.size!==0,y=c.clear();return p&&Oo(c,"clear",void 0,void 0),y}function ld(c,p){return function(b,T){const I=this,D=I.__v_raw,o=wi(D),U=p?ym:c?Am:Eu;return!c&&hr(o,"iterate",xa),D.forEach((oe,te)=>b.call(T,U(oe),U(te),I))}}function cd(c,p,y){return function(...b){const T=this.__v_raw,I=wi(T),D=kl(I),o=c==="entries"||c===Symbol.iterator&&D,U=c==="keys"&&D,oe=T[c](...b),te=y?ym:p?Am:Eu;return!p&&hr(I,"iterate",U?Bf:xa),{next(){const{value:Z,done:se}=oe.next();return se?{value:Z,done:se}:{value:o?[te(Z[0]),te(Z[1])]:te(Z),done:se}},[Symbol.iterator](){return this}}}}function xs(c){return function(...p){return c==="delete"?!1:this}}function s2(){const c={get(I){return od(this,I)},get size(){return ad(this)},has:sd,add:ey,set:ty,delete:iy,clear:ny,forEach:ld(!1,!1)},p={get(I){return od(this,I,!1,!0)},get size(){return ad(this)},has:sd,add:ey,set:ty,delete:iy,clear:ny,forEach:ld(!1,!0)},y={get(I){return od(this,I,!0)},get size(){return ad(this,!0)},has(I){return sd.call(this,I,!0)},add:xs("add"),set:xs("set"),delete:xs("delete"),clear:xs("clear"),forEach:ld(!0,!1)},b={get(I){return od(this,I,!0,!0)},get size(){return ad(this,!0)},has(I){return sd.call(this,I,!0)},add:xs("add"),set:xs("set"),delete:xs("delete"),clear:xs("clear"),forEach:ld(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(I=>{c[I]=cd(I,!1,!1),y[I]=cd(I,!0,!1),p[I]=cd(I,!1,!0),b[I]=cd(I,!0,!0)}),[c,y,p,b]}const[a2,l2,c2,u2]=s2();function xm(c,p){const y=p?c?u2:c2:c?l2:a2;return(b,T,I)=>T==="__v_isReactive"?!c:T==="__v_isReadonly"?c:T==="__v_raw"?b:Reflect.get(pi(y,T)&&T in b?y:b,T,I)}const h2={get:xm(!1,!1)},d2={get:xm(!1,!0)},p2={get:xm(!0,!1)},M1=new WeakMap,S1=new WeakMap,I1=new WeakMap,f2=new WeakMap;function m2(c){switch(c){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function _2(c){return c.__v_skip||!Object.isExtensible(c)?0:m2(Nb(c))}function Vl(c){return Tu(c)?c:vm(c,!1,C1,h2,M1)}function g2(c){return vm(c,!1,o2,d2,S1)}function z1(c){return vm(c,!0,r2,p2,I1)}function vm(c,p,y,b,T){if(!hn(c)||c.__v_raw&&!(p&&c.__v_isReactive))return c;const I=T.get(c);if(I)return I;const D=_2(c);if(D===0)return c;const o=new Proxy(c,D===2?b:y);return T.set(c,o),o}function Dl(c){return Tu(c)?Dl(c.__v_raw):!!(c&&c.__v_isReactive)}function Tu(c){return!!(c&&c.__v_isReadonly)}function k1(c){return!!(c&&c.__v_isShallow)}function D1(c){return Dl(c)||Tu(c)}function wi(c){const p=c&&c.__v_raw;return p?wi(p):c}function bm(c){return vd(c,"__v_skip",!0),c}const Eu=c=>hn(c)?Vl(c):c,Am=c=>hn(c)?z1(c):c;function P1(c){Cs&&so&&(c=wi(c),w1(c.dep||(c.dep=mm())))}function B1(c,p){c=wi(c),c.dep&&Lf(c.dep)}function gn(c){return!!(c&&c.__v_isRef===!0)}function L1(c){return R1(c,!1)}function y2(c){return R1(c,!0)}function R1(c,p){return gn(c)?c:new x2(c,p)}class x2{constructor(p,y){this.__v_isShallow=y,this.dep=void 0,this.__v_isRef=!0,this._rawValue=y?p:wi(p),this._value=y?p:Eu(p)}get value(){return P1(this),this._value}set value(p){p=this.__v_isShallow?p:wi(p),wu(p,this._rawValue)&&(this._rawValue=p,this._value=this.__v_isShallow?p:Eu(p),B1(this))}}function mu(c){return gn(c)?c.value:c}const v2={get:(c,p,y)=>mu(Reflect.get(c,p,y)),set:(c,p,y,b)=>{const T=c[p];return gn(T)&&!gn(y)?(T.value=y,!0):Reflect.set(c,p,y,b)}};function O1(c){return Dl(c)?c:new Proxy(c,v2)}class b2{constructor(p,y,b,T){this._setter=y,this.dep=void 0,this.__v_isRef=!0,this._dirty=!0,this.effect=new _m(p,()=>{this._dirty||(this._dirty=!0,B1(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!T,this.__v_isReadonly=b}get value(){const p=wi(this);return P1(p),(p._dirty||!p._cacheable)&&(p._dirty=!1,p._value=p.effect.run()),p._value}set value(p){this._setter(p)}}function A2(c,p,y=!1){let b,T;const I=Jt(c);return I?(b=c,T=Lr):(b=c.get,T=c.set),new b2(b,T,I||!T,y)}Promise.resolve();function Ms(c,p,y,b){let T;try{T=b?c(...b):c()}catch(I){Od(I,p,y)}return T}function Rr(c,p,y,b){if(Jt(c)){const I=Ms(c,p,y,b);return I&&_1(I)&&I.catch(D=>{Od(D,p,y)}),I}const T=[];for(let I=0;I<c.length;I++)T.push(Rr(c[I],p,y,b));return T}function Od(c,p,y,b=!0){const T=p?p.vnode:null;if(p){let I=p.parent;const D=p.proxy,o=y;for(;I;){const oe=I.ec;if(oe){for(let te=0;te<oe.length;te++)if(oe[te](c,D,o)===!1)return}I=I.parent}const U=p.appContext.config.errorHandler;if(U){Ms(U,null,10,[c,D,o]);return}}w2(c,y,T,b)}function w2(c,p,y,b=!0){console.error(c)}let bd=!1,Rf=!1;const ur=[];let Ro=0;const _u=[];let hu=null,Tl=0;const gu=[];let ws=null,El=0;const F1=Promise.resolve();let wm=null,Of=null;function N1(c){const p=wm||F1;return c?p.then(this?c.bind(this):c):p}function T2(c){let p=Ro+1,y=ur.length;for(;p<y;){const b=p+y>>>1;Cu(ur[b])<c?p=b+1:y=b}return p}function U1(c){(!ur.length||!ur.includes(c,bd&&c.allowRecurse?Ro+1:Ro))&&c!==Of&&(c.id==null?ur.push(c):ur.splice(T2(c.id),0,c),V1())}function V1(){!bd&&!Rf&&(Rf=!0,wm=F1.then(Z1))}function E2(c){const p=ur.indexOf(c);p>Ro&&ur.splice(p,1)}function j1(c,p,y,b){Qt(c)?y.push(...c):(!p||!p.includes(c,c.allowRecurse?b+1:b))&&y.push(c),V1()}function C2(c){j1(c,hu,_u,Tl)}function M2(c){j1(c,ws,gu,El)}function Tm(c,p=null){if(_u.length){for(Of=p,hu=[...new Set(_u)],_u.length=0,Tl=0;Tl<hu.length;Tl++)hu[Tl]();hu=null,Tl=0,Of=null,Tm(c,p)}}function G1(c){if(gu.length){const p=[...new Set(gu)];if(gu.length=0,ws){ws.push(...p);return}for(ws=p,ws.sort((y,b)=>Cu(y)-Cu(b)),El=0;El<ws.length;El++)ws[El]();ws=null,El=0}}const Cu=c=>c.id==null?1/0:c.id;function Z1(c){Rf=!1,bd=!0,Tm(c),ur.sort((y,b)=>Cu(y)-Cu(b));const p=Lr;try{for(Ro=0;Ro<ur.length;Ro++){const y=ur[Ro];y&&y.active!==!1&&Ms(y,null,14)}}finally{Ro=0,ur.length=0,G1(),bd=!1,wm=null,(ur.length||_u.length||gu.length)&&Z1(c)}}function S2(c,p,...y){const b=c.vnode.props||Bi;let T=y;const I=p.startsWith("update:"),D=I&&p.slice(7);if(D&&D in b){const te=`${D==="modelValue"?"model":D}Modifiers`,{number:Z,trim:se}=b[te]||Bi;se?T=y.map(me=>me.trim()):Z&&(T=y.map(jb))}let o,U=b[o=xf(p)]||b[o=xf(co(p))];!U&&I&&(U=b[o=xf(Fl(p))]),U&&Rr(U,c,6,T);const oe=b[o+"Once"];if(oe){if(!c.emitted)c.emitted={};else if(c.emitted[o])return;c.emitted[o]=!0,Rr(oe,c,6,T)}}function q1(c,p,y=!1){const b=p.emitsCache,T=b.get(c);if(T!==void 0)return T;const I=c.emits;let D={},o=!1;if(!Jt(c)){const U=oe=>{const te=q1(oe,p,!0);te&&(o=!0,Nn(D,te))};!y&&p.mixins.length&&p.mixins.forEach(U),c.extends&&U(c.extends),c.mixins&&c.mixins.forEach(U)}return!I&&!o?(b.set(c,null),null):(Qt(I)?I.forEach(U=>D[U]=null):Nn(D,I),b.set(c,D),D)}function Fd(c,p){return!c||!Dd(p)?!1:(p=p.slice(2).replace(/Once$/,""),pi(c,p[0].toLowerCase()+p.slice(1))||pi(c,Fl(p))||pi(c,p))}let ao=null,Nd=null;function Ad(c){const p=ao;return ao=c,Nd=c&&c.type.__scopeId||null,p}function Du(c){Nd=c}function Pu(){Nd=null}function du(c,p=ao,y){if(!p||c._n)return c;const b=(...T)=>{b._d&&py(-1);const I=Ad(p),D=c(...T);return Ad(I),b._d&&py(1),D};return b._n=!0,b._c=!0,b._d=!0,b}function bf(c){const{type:p,vnode:y,proxy:b,withProxy:T,props:I,propsOptions:[D],slots:o,attrs:U,emit:oe,render:te,renderCache:Z,data:se,setupState:me,ctx:Ye,inheritAttrs:ft}=c;let Fe,ke;const Xe=Ad(c);try{if(y.shapeFlag&4){const Dt=T||b;Fe=ro(te.call(Dt,Dt,Z,I,me,se,Ye)),ke=U}else{const Dt=p;Fe=ro(Dt.length>1?Dt(I,{attrs:U,slots:o,emit:oe}):Dt(I,null)),ke=p.props?U:I2(U)}}catch(Dt){yu.length=0,Od(Dt,c,1),Fe=gi(Mu)}let vt=Fe;if(ke&&ft!==!1){const Dt=Object.keys(ke),{shapeFlag:Ut}=vt;Dt.length&&Ut&7&&(D&&Dt.some(hm)&&(ke=z2(ke,D)),vt=Su(vt,ke))}return y.dirs&&(vt.dirs=vt.dirs?vt.dirs.concat(y.dirs):y.dirs),y.transition&&(vt.transition=y.transition),Fe=vt,Ad(Xe),Fe}const I2=c=>{let p;for(const y in c)(y==="class"||y==="style"||Dd(y))&&((p||(p={}))[y]=c[y]);return p},z2=(c,p)=>{const y={};for(const b in c)(!hm(b)||!(b.slice(9)in p))&&(y[b]=c[b]);return y};function k2(c,p,y){const{props:b,children:T,component:I}=c,{props:D,children:o,patchFlag:U}=p,oe=I.emitsOptions;if(p.dirs||p.transition)return!0;if(y&&U>=0){if(U&1024)return!0;if(U&16)return b?ry(b,D,oe):!!D;if(U&8){const te=p.dynamicProps;for(let Z=0;Z<te.length;Z++){const se=te[Z];if(D[se]!==b[se]&&!Fd(oe,se))return!0}}}else return(T||o)&&(!o||!o.$stable)?!0:b===D?!1:b?D?ry(b,D,oe):!0:!!D;return!1}function ry(c,p,y){const b=Object.keys(p);if(b.length!==Object.keys(c).length)return!0;for(let T=0;T<b.length;T++){const I=b[T];if(p[I]!==c[I]&&!Fd(y,I))return!0}return!1}function D2({vnode:c,parent:p},y){for(;p&&p.subTree===c;)(c=p.vnode).el=y,p=p.parent}const P2=c=>c.__isSuspense;function B2(c,p){p&&p.pendingBranch?Qt(c)?p.effects.push(...c):p.effects.push(c):M2(c)}function dd(c,p){if(_n){let y=_n.provides;const b=_n.parent&&_n.parent.provides;b===y&&(y=_n.provides=Object.create(b)),y[c]=p}}function Ss(c,p,y=!1){const b=_n||ao;if(b){const T=b.parent==null?b.vnode.appContext&&b.vnode.appContext.provides:b.parent.provides;if(T&&c in T)return T[c];if(arguments.length>1)return y&&Jt(p)?p.call(b.proxy):p}}const oy={};function pd(c,p,y){return W1(c,p,y)}function W1(c,p,{immediate:y,deep:b,flush:T,onTrack:I,onTrigger:D}=Bi){const o=_n;let U,oe=!1,te=!1;if(gn(c)?(U=()=>c.value,oe=k1(c)):Dl(c)?(U=()=>c,b=!0):Qt(c)?(te=!0,oe=c.some(Dl),U=()=>c.map(ke=>{if(gn(ke))return ke.value;if(Dl(ke))return Ml(ke);if(Jt(ke))return Ms(ke,o,2)})):Jt(c)?p?U=()=>Ms(c,o,2):U=()=>{if(!(o&&o.isUnmounted))return Z&&Z(),Rr(c,o,3,[se])}:U=Lr,p&&b){const ke=U;U=()=>Ml(ke())}let Z,se=ke=>{Z=Fe.onStop=()=>{Ms(ke,o,4)}};if(Iu)return se=Lr,p?y&&Rr(p,o,3,[U(),te?[]:void 0,se]):U(),Lr;let me=te?[]:oy;const Ye=()=>{if(!!Fe.active)if(p){const ke=Fe.run();(b||oe||(te?ke.some((Xe,vt)=>wu(Xe,me[vt])):wu(ke,me)))&&(Z&&Z(),Rr(p,o,3,[ke,me===oy?void 0:me,se]),me=ke)}else Fe.run()};Ye.allowRecurse=!!p;let ft;T==="sync"?ft=Ye:T==="post"?ft=()=>Jn(Ye,o&&o.suspense):ft=()=>{!o||o.isMounted?C2(Ye):Ye()};const Fe=new _m(U,ft);return p?y?Ye():me=Fe.run():T==="post"?Jn(Fe.run.bind(Fe),o&&o.suspense):Fe.run(),()=>{Fe.stop(),o&&o.scope&&dm(o.scope.effects,Fe)}}function L2(c,p,y){const b=this.proxy,T=yn(c)?c.includes(".")?H1(b,c):()=>b[c]:c.bind(b,b);let I;Jt(p)?I=p:(I=p.handler,y=p);const D=_n;Ll(this);const o=W1(T,I.bind(b),y);return D?Ll(D):ba(),o}function H1(c,p){const y=p.split(".");return()=>{let b=c;for(let T=0;T<y.length&&b;T++)b=b[y[T]];return b}}function Ml(c,p){if(!hn(c)||c.__v_skip||(p=p||new Set,p.has(c)))return c;if(p.add(c),gn(c))Ml(c.value,p);else if(Qt(c))for(let y=0;y<c.length;y++)Ml(c[y],p);else if(m1(c)||kl(c))c.forEach(y=>{Ml(y,p)});else if(y1(c))for(const y in c)Ml(c[y],p);return c}function Y1(c){return Jt(c)?{setup:c,name:c.name}:c}const Ff=c=>!!c.type.__asyncLoader,X1=c=>c.type.__isKeepAlive;function R2(c,p){Q1(c,"a",p)}function O2(c,p){Q1(c,"da",p)}function Q1(c,p,y=_n){const b=c.__wdc||(c.__wdc=()=>{let T=y;for(;T;){if(T.isDeactivated)return;T=T.parent}return c()});if(Ud(p,b,y),y){let T=y.parent;for(;T&&T.parent;)X1(T.parent.vnode)&&F2(b,p,y,T),T=T.parent}}function F2(c,p,y,b){const T=Ud(p,c,b,!0);$1(()=>{dm(b[p],T)},y)}function Ud(c,p,y=_n,b=!1){if(y){const T=y[c]||(y[c]=[]),I=p.__weh||(p.__weh=(...D)=>{if(y.isUnmounted)return;Nl(),Ll(y);const o=Rr(p,y,c,D);return ba(),Ul(),o});return b?T.unshift(I):T.push(I),I}}const Vo=c=>(p,y=_n)=>(!Iu||c==="sp")&&Ud(c,p,y),N2=Vo("bm"),K1=Vo("m"),U2=Vo("bu"),V2=Vo("u"),j2=Vo("bum"),$1=Vo("um"),G2=Vo("sp"),Z2=Vo("rtg"),q2=Vo("rtc");function W2(c,p=_n){Ud("ec",c,p)}let Nf=!0;function H2(c){const p=e0(c),y=c.proxy,b=c.ctx;Nf=!1,p.beforeCreate&&sy(p.beforeCreate,c,"bc");const{data:T,computed:I,methods:D,watch:o,provide:U,inject:oe,created:te,beforeMount:Z,mounted:se,beforeUpdate:me,updated:Ye,activated:ft,deactivated:Fe,beforeDestroy:ke,beforeUnmount:Xe,destroyed:vt,unmounted:Dt,render:Ut,renderTracked:At,renderTriggered:Ci,errorCaptured:Li,serverPrefetch:zi,expose:xn,inheritAttrs:yi,components:dn,directives:Mn,filters:er}=p;if(oe&&Y2(oe,b,null,c.appContext.config.unwrapInjectedRef),D)for(const hi in D){const Kt=D[hi];Jt(Kt)&&(b[hi]=Kt.bind(y))}if(T){const hi=T.call(y,y);hn(hi)&&(c.data=Vl(hi))}if(Nf=!0,I)for(const hi in I){const Kt=I[hi],Ui=Jt(Kt)?Kt.bind(y,y):Jt(Kt.get)?Kt.get.bind(y,y):Lr,Un=!Jt(Kt)&&Jt(Kt.set)?Kt.set.bind(y):Lr,Vi=oo({get:Ui,set:Un});Object.defineProperty(b,hi,{enumerable:!0,configurable:!0,get:()=>Vi.value,set:pn=>Vi.value=pn})}if(o)for(const hi in o)J1(o[hi],b,y,hi);if(U){const hi=Jt(U)?U.call(y):U;Reflect.ownKeys(hi).forEach(Kt=>{dd(Kt,hi[Kt])})}te&&sy(te,c,"c");function Ti(hi,Kt){Qt(Kt)?Kt.forEach(Ui=>hi(Ui.bind(y))):Kt&&hi(Kt.bind(y))}if(Ti(N2,Z),Ti(K1,se),Ti(U2,me),Ti(V2,Ye),Ti(R2,ft),Ti(O2,Fe),Ti(W2,Li),Ti(q2,At),Ti(Z2,Ci),Ti(j2,Xe),Ti($1,Dt),Ti(G2,zi),Qt(xn))if(xn.length){const hi=c.exposed||(c.exposed={});xn.forEach(Kt=>{Object.defineProperty(hi,Kt,{get:()=>y[Kt],set:Ui=>y[Kt]=Ui})})}else c.exposed||(c.exposed={});Ut&&c.render===Lr&&(c.render=Ut),yi!=null&&(c.inheritAttrs=yi),dn&&(c.components=dn),Mn&&(c.directives=Mn)}function Y2(c,p,y=Lr,b=!1){Qt(c)&&(c=Uf(c));for(const T in c){const I=c[T];let D;hn(I)?"default"in I?D=Ss(I.from||T,I.default,!0):D=Ss(I.from||T):D=Ss(I),gn(D)&&b?Object.defineProperty(p,T,{enumerable:!0,configurable:!0,get:()=>D.value,set:o=>D.value=o}):p[T]=D}}function sy(c,p,y){Rr(Qt(c)?c.map(b=>b.bind(p.proxy)):c.bind(p.proxy),p,y)}function J1(c,p,y,b){const T=b.includes(".")?H1(y,b):()=>y[b];if(yn(c)){const I=p[c];Jt(I)&&pd(T,I)}else if(Jt(c))pd(T,c.bind(y));else if(hn(c))if(Qt(c))c.forEach(I=>J1(I,p,y,b));else{const I=Jt(c.handler)?c.handler.bind(y):p[c.handler];Jt(I)&&pd(T,I,c)}}function e0(c){const p=c.type,{mixins:y,extends:b}=p,{mixins:T,optionsCache:I,config:{optionMergeStrategies:D}}=c.appContext,o=I.get(p);let U;return o?U=o:!T.length&&!y&&!b?U=p:(U={},T.length&&T.forEach(oe=>wd(U,oe,D,!0)),wd(U,p,D)),I.set(p,U),U}function wd(c,p,y,b=!1){const{mixins:T,extends:I}=p;I&&wd(c,I,y,!0),T&&T.forEach(D=>wd(c,D,y,!0));for(const D in p)if(!(b&&D==="expose")){const o=X2[D]||y&&y[D];c[D]=o?o(c[D],p[D]):p[D]}return c}const X2={data:ay,props:_a,emits:_a,methods:_a,computed:_a,beforeCreate:Fn,created:Fn,beforeMount:Fn,mounted:Fn,beforeUpdate:Fn,updated:Fn,beforeDestroy:Fn,beforeUnmount:Fn,destroyed:Fn,unmounted:Fn,activated:Fn,deactivated:Fn,errorCaptured:Fn,serverPrefetch:Fn,components:_a,directives:_a,watch:K2,provide:ay,inject:Q2};function ay(c,p){return p?c?function(){return Nn(Jt(c)?c.call(this,this):c,Jt(p)?p.call(this,this):p)}:p:c}function Q2(c,p){return _a(Uf(c),Uf(p))}function Uf(c){if(Qt(c)){const p={};for(let y=0;y<c.length;y++)p[c[y]]=c[y];return p}return c}function Fn(c,p){return c?[...new Set([].concat(c,p))]:p}function _a(c,p){return c?Nn(Nn(Object.create(null),c),p):p}function K2(c,p){if(!c)return p;if(!p)return c;const y=Nn(Object.create(null),c);for(const b in p)y[b]=Fn(c[b],p[b]);return y}function $2(c,p,y,b=!1){const T={},I={};vd(I,Vd,1),c.propsDefaults=Object.create(null),t0(c,p,T,I);for(const D in c.propsOptions[0])D in T||(T[D]=void 0);y?c.props=b?T:g2(T):c.type.props?c.props=T:c.props=I,c.attrs=I}function J2(c,p,y,b){const{props:T,attrs:I,vnode:{patchFlag:D}}=c,o=wi(T),[U]=c.propsOptions;let oe=!1;if((b||D>0)&&!(D&16)){if(D&8){const te=c.vnode.dynamicProps;for(let Z=0;Z<te.length;Z++){let se=te[Z];if(Fd(c.emitsOptions,se))continue;const me=p[se];if(U)if(pi(I,se))me!==I[se]&&(I[se]=me,oe=!0);else{const Ye=co(se);T[Ye]=Vf(U,o,Ye,me,c,!1)}else me!==I[se]&&(I[se]=me,oe=!0)}}}else{t0(c,p,T,I)&&(oe=!0);let te;for(const Z in o)(!p||!pi(p,Z)&&((te=Fl(Z))===Z||!pi(p,te)))&&(U?y&&(y[Z]!==void 0||y[te]!==void 0)&&(T[Z]=Vf(U,o,Z,void 0,c,!0)):delete T[Z]);if(I!==o)for(const Z in I)(!p||!pi(p,Z)&&!0)&&(delete I[Z],oe=!0)}oe&&Oo(c,"set","$attrs")}function t0(c,p,y,b){const[T,I]=c.propsOptions;let D=!1,o;if(p)for(let U in p){if(hd(U))continue;const oe=p[U];let te;T&&pi(T,te=co(U))?!I||!I.includes(te)?y[te]=oe:(o||(o={}))[te]=oe:Fd(c.emitsOptions,U)||(!(U in b)||oe!==b[U])&&(b[U]=oe,D=!0)}if(I){const U=wi(y),oe=o||Bi;for(let te=0;te<I.length;te++){const Z=I[te];y[Z]=Vf(T,U,Z,oe[Z],c,!pi(oe,Z))}}return D}function Vf(c,p,y,b,T,I){const D=c[y];if(D!=null){const o=pi(D,"default");if(o&&b===void 0){const U=D.default;if(D.type!==Function&&Jt(U)){const{propsDefaults:oe}=T;y in oe?b=oe[y]:(Ll(T),b=oe[y]=U.call(null,p),ba())}else b=U}D[0]&&(I&&!o?b=!1:D[1]&&(b===""||b===Fl(y))&&(b=!0))}return b}function i0(c,p,y=!1){const b=p.propsCache,T=b.get(c);if(T)return T;const I=c.props,D={},o=[];let U=!1;if(!Jt(c)){const te=Z=>{U=!0;const[se,me]=i0(Z,p,!0);Nn(D,se),me&&o.push(...me)};!y&&p.mixins.length&&p.mixins.forEach(te),c.extends&&te(c.extends),c.mixins&&c.mixins.forEach(te)}if(!I&&!U)return b.set(c,zl),zl;if(Qt(I))for(let te=0;te<I.length;te++){const Z=co(I[te]);ly(Z)&&(D[Z]=Bi)}else if(I)for(const te in I){const Z=co(te);if(ly(Z)){const se=I[te],me=D[Z]=Qt(se)||Jt(se)?{type:se}:se;if(me){const Ye=hy(Boolean,me.type),ft=hy(String,me.type);me[0]=Ye>-1,me[1]=ft<0||Ye<ft,(Ye>-1||pi(me,"default"))&&o.push(Z)}}}const oe=[D,o];return b.set(c,oe),oe}function ly(c){return c[0]!=="$"}function cy(c){const p=c&&c.toString().match(/^\s*function (\w+)/);return p?p[1]:c===null?"null":""}function uy(c,p){return cy(c)===cy(p)}function hy(c,p){return Qt(p)?p.findIndex(y=>uy(y,c)):Jt(p)&&uy(p,c)?0:-1}const n0=c=>c[0]==="_"||c==="$stable",Em=c=>Qt(c)?c.map(ro):[ro(c)],eA=(c,p,y)=>{const b=du((...T)=>Em(p(...T)),y);return b._c=!1,b},r0=(c,p,y)=>{const b=c._ctx;for(const T in c){if(n0(T))continue;const I=c[T];if(Jt(I))p[T]=eA(T,I,b);else if(I!=null){const D=Em(I);p[T]=()=>D}}},o0=(c,p)=>{const y=Em(p);c.slots.default=()=>y},tA=(c,p)=>{if(c.vnode.shapeFlag&32){const y=p._;y?(c.slots=wi(p),vd(p,"_",y)):r0(p,c.slots={})}else c.slots={},p&&o0(c,p);vd(c.slots,Vd,1)},iA=(c,p,y)=>{const{vnode:b,slots:T}=c;let I=!0,D=Bi;if(b.shapeFlag&32){const o=p._;o?y&&o===1?I=!1:(Nn(T,p),!y&&o===1&&delete T._):(I=!p.$stable,r0(p,T)),D=p}else p&&(o0(c,p),D={default:1});if(I)for(const o in T)!n0(o)&&!(o in D)&&delete T[o]};function fa(c,p,y,b){const T=c.dirs,I=p&&p.dirs;for(let D=0;D<T.length;D++){const o=T[D];I&&(o.oldValue=I[D].value);let U=o.dir[b];U&&(Nl(),Rr(U,y,8,[c.el,o,c,p]),Ul())}}function s0(){return{app:null,config:{isNativeTag:Rb,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let nA=0;function rA(c,p){return function(b,T=null){Jt(b)||(b=Object.assign({},b)),T!=null&&!hn(T)&&(T=null);const I=s0(),D=new Set;let o=!1;const U=I.app={_uid:nA++,_component:b,_props:T,_container:null,_context:I,_instance:null,version:CA,get config(){return I.config},set config(oe){},use(oe,...te){return D.has(oe)||(oe&&Jt(oe.install)?(D.add(oe),oe.install(U,...te)):Jt(oe)&&(D.add(oe),oe(U,...te))),U},mixin(oe){return I.mixins.includes(oe)||I.mixins.push(oe),U},component(oe,te){return te?(I.components[oe]=te,U):I.components[oe]},directive(oe,te){return te?(I.directives[oe]=te,U):I.directives[oe]},mount(oe,te,Z){if(!o){const se=gi(b,T);return se.appContext=I,te&&p?p(se,oe):c(se,oe,Z),o=!0,U._container=oe,oe.__vue_app__=U,Sm(se.component)||se.component.proxy}},unmount(){o&&(c(null,U._container),delete U._container.__vue_app__)},provide(oe,te){return I.provides[oe]=te,U}};return U}}function jf(c,p,y,b,T=!1){if(Qt(c)){c.forEach((se,me)=>jf(se,p&&(Qt(p)?p[me]:p),y,b,T));return}if(Ff(b)&&!T)return;const I=b.shapeFlag&4?Sm(b.component)||b.component.proxy:b.el,D=T?null:I,{i:o,r:U}=c,oe=p&&p.r,te=o.refs===Bi?o.refs={}:o.refs,Z=o.setupState;if(oe!=null&&oe!==U&&(yn(oe)?(te[oe]=null,pi(Z,oe)&&(Z[oe]=null)):gn(oe)&&(oe.value=null)),Jt(U))Ms(U,o,12,[D,te]);else{const se=yn(U),me=gn(U);if(se||me){const Ye=()=>{if(c.f){const ft=se?te[U]:U.value;T?Qt(ft)&&dm(ft,I):Qt(ft)?ft.includes(I)||ft.push(I):se?(te[U]=[I],pi(Z,U)&&(Z[U]=te[U])):(U.value=[I],c.k&&(te[c.k]=U.value))}else se?(te[U]=D,pi(Z,U)&&(Z[U]=D)):gn(U)&&(U.value=D,c.k&&(te[c.k]=D))};D?(Ye.id=-1,Jn(Ye,y)):Ye()}}}const Jn=B2;function oA(c){return sA(c)}function sA(c,p){const y=Gb();y.__VUE__=!0;const{insert:b,remove:T,patchProp:I,createElement:D,createText:o,createComment:U,setText:oe,setElementText:te,parentNode:Z,nextSibling:se,setScopeId:me=Lr,cloneNode:Ye,insertStaticContent:ft}=c,Fe=(ie,pe,Ee,Ne=null,ze=null,Ke=null,at=!1,He=null,$e=!!pe.dynamicChildren)=>{if(ie===pe)return;ie&&!lu(ie,pe)&&(Ne=wt(ie),Gt(ie,ze,Ke,!0),ie=null),pe.patchFlag===-2&&($e=!1,pe.dynamicChildren=null);const{type:Ge,ref:Mt,shapeFlag:mt}=pe;switch(Ge){case Cm:ke(ie,pe,Ee,Ne);break;case Mu:Xe(ie,pe,Ee,Ne);break;case fd:ie==null&&vt(pe,Ee,Ne,at);break;case Lo:Mn(ie,pe,Ee,Ne,ze,Ke,at,He,$e);break;default:mt&1?At(ie,pe,Ee,Ne,ze,Ke,at,He,$e):mt&6?er(ie,pe,Ee,Ne,ze,Ke,at,He,$e):(mt&64||mt&128)&&Ge.process(ie,pe,Ee,Ne,ze,Ke,at,He,$e,li)}Mt!=null&&ze&&jf(Mt,ie&&ie.ref,Ke,pe||ie,!pe)},ke=(ie,pe,Ee,Ne)=>{if(ie==null)b(pe.el=o(pe.children),Ee,Ne);else{const ze=pe.el=ie.el;pe.children!==ie.children&&oe(ze,pe.children)}},Xe=(ie,pe,Ee,Ne)=>{ie==null?b(pe.el=U(pe.children||""),Ee,Ne):pe.el=ie.el},vt=(ie,pe,Ee,Ne)=>{[ie.el,ie.anchor]=ft(ie.children,pe,Ee,Ne,ie.el,ie.anchor)},Dt=({el:ie,anchor:pe},Ee,Ne)=>{let ze;for(;ie&&ie!==pe;)ze=se(ie),b(ie,Ee,Ne),ie=ze;b(pe,Ee,Ne)},Ut=({el:ie,anchor:pe})=>{let Ee;for(;ie&&ie!==pe;)Ee=se(ie),T(ie),ie=Ee;T(pe)},At=(ie,pe,Ee,Ne,ze,Ke,at,He,$e)=>{at=at||pe.type==="svg",ie==null?Ci(pe,Ee,Ne,ze,Ke,at,He,$e):xn(ie,pe,ze,Ke,at,He,$e)},Ci=(ie,pe,Ee,Ne,ze,Ke,at,He)=>{let $e,Ge;const{type:Mt,props:mt,shapeFlag:Ct,transition:It,patchFlag:qt,dirs:ei}=ie;if(ie.el&&Ye!==void 0&&qt===-1)$e=ie.el=Ye(ie.el);else{if($e=ie.el=D(ie.type,Ke,mt&&mt.is,mt),Ct&8?te($e,ie.children):Ct&16&&zi(ie.children,$e,null,Ne,ze,Ke&&Mt!=="foreignObject",at,He),ei&&fa(ie,null,Ne,"created"),mt){for(const ci in mt)ci!=="value"&&!hd(ci)&&I($e,ci,null,mt[ci],Ke,ie.children,Ne,ze,tt);"value"in mt&&I($e,"value",null,mt.value),(Ge=mt.onVnodeBeforeMount)&&io(Ge,Ne,ie)}Li($e,ie,ie.scopeId,at,Ne)}ei&&fa(ie,null,Ne,"beforeMount");const Xt=(!ze||ze&&!ze.pendingBranch)&&It&&!It.persisted;Xt&&It.beforeEnter($e),b($e,pe,Ee),((Ge=mt&&mt.onVnodeMounted)||Xt||ei)&&Jn(()=>{Ge&&io(Ge,Ne,ie),Xt&&It.enter($e),ei&&fa(ie,null,Ne,"mounted")},ze)},Li=(ie,pe,Ee,Ne,ze)=>{if(Ee&&me(ie,Ee),Ne)for(let Ke=0;Ke<Ne.length;Ke++)me(ie,Ne[Ke]);if(ze){let Ke=ze.subTree;if(pe===Ke){const at=ze.vnode;Li(ie,at,at.scopeId,at.slotScopeIds,ze.parent)}}},zi=(ie,pe,Ee,Ne,ze,Ke,at,He,$e=0)=>{for(let Ge=$e;Ge<ie.length;Ge++){const Mt=ie[Ge]=He?Ts(ie[Ge]):ro(ie[Ge]);Fe(null,Mt,pe,Ee,Ne,ze,Ke,at,He)}},xn=(ie,pe,Ee,Ne,ze,Ke,at)=>{const He=pe.el=ie.el;let{patchFlag:$e,dynamicChildren:Ge,dirs:Mt}=pe;$e|=ie.patchFlag&16;const mt=ie.props||Bi,Ct=pe.props||Bi;let It;Ee&&ma(Ee,!1),(It=Ct.onVnodeBeforeUpdate)&&io(It,Ee,pe,ie),Mt&&fa(pe,ie,Ee,"beforeUpdate"),Ee&&ma(Ee,!0);const qt=ze&&pe.type!=="foreignObject";if(Ge?yi(ie.dynamicChildren,Ge,He,Ee,Ne,qt,Ke):at||Ui(ie,pe,He,null,Ee,Ne,qt,Ke,!1),$e>0){if($e&16)dn(He,pe,mt,Ct,Ee,Ne,ze);else if($e&2&&mt.class!==Ct.class&&I(He,"class",null,Ct.class,ze),$e&4&&I(He,"style",mt.style,Ct.style,ze),$e&8){const ei=pe.dynamicProps;for(let Xt=0;Xt<ei.length;Xt++){const ci=ei[Xt],nn=mt[ci],vn=Ct[ci];(vn!==nn||ci==="value")&&I(He,ci,nn,vn,ze,ie.children,Ee,Ne,tt)}}$e&1&&ie.children!==pe.children&&te(He,pe.children)}else!at&&Ge==null&&dn(He,pe,mt,Ct,Ee,Ne,ze);((It=Ct.onVnodeUpdated)||Mt)&&Jn(()=>{It&&io(It,Ee,pe,ie),Mt&&fa(pe,ie,Ee,"updated")},Ne)},yi=(ie,pe,Ee,Ne,ze,Ke,at)=>{for(let He=0;He<pe.length;He++){const $e=ie[He],Ge=pe[He],Mt=$e.el&&($e.type===Lo||!lu($e,Ge)||$e.shapeFlag&70)?Z($e.el):Ee;Fe($e,Ge,Mt,null,Ne,ze,Ke,at,!0)}},dn=(ie,pe,Ee,Ne,ze,Ke,at)=>{if(Ee!==Ne){for(const He in Ne){if(hd(He))continue;const $e=Ne[He],Ge=Ee[He];$e!==Ge&&He!=="value"&&I(ie,He,Ge,$e,at,pe.children,ze,Ke,tt)}if(Ee!==Bi)for(const He in Ee)!hd(He)&&!(He in Ne)&&I(ie,He,Ee[He],null,at,pe.children,ze,Ke,tt);"value"in Ne&&I(ie,"value",Ee.value,Ne.value)}},Mn=(ie,pe,Ee,Ne,ze,Ke,at,He,$e)=>{const Ge=pe.el=ie?ie.el:o(""),Mt=pe.anchor=ie?ie.anchor:o("");let{patchFlag:mt,dynamicChildren:Ct,slotScopeIds:It}=pe;It&&(He=He?He.concat(It):It),ie==null?(b(Ge,Ee,Ne),b(Mt,Ee,Ne),zi(pe.children,Ee,Mt,ze,Ke,at,He,$e)):mt>0&&mt&64&&Ct&&ie.dynamicChildren?(yi(ie.dynamicChildren,Ct,Ee,ze,Ke,at,He),(pe.key!=null||ze&&pe===ze.subTree)&&a0(ie,pe,!0)):Ui(ie,pe,Ee,Mt,ze,Ke,at,He,$e)},er=(ie,pe,Ee,Ne,ze,Ke,at,He,$e)=>{pe.slotScopeIds=He,ie==null?pe.shapeFlag&512?ze.ctx.activate(pe,Ee,Ne,at,$e):tr(pe,Ee,Ne,ze,Ke,at,$e):Ti(ie,pe,$e)},tr=(ie,pe,Ee,Ne,ze,Ke,at)=>{const He=ie.component=xA(ie,Ne,ze);if(X1(ie)&&(He.ctx.renderer=li),vA(He),He.asyncDep){if(ze&&ze.registerDep(He,hi),!ie.el){const $e=He.subTree=gi(Mu);Xe(null,$e,pe,Ee)}return}hi(He,ie,pe,Ee,ze,Ke,at)},Ti=(ie,pe,Ee)=>{const Ne=pe.component=ie.component;if(k2(ie,pe,Ee))if(Ne.asyncDep&&!Ne.asyncResolved){Kt(Ne,pe,Ee);return}else Ne.next=pe,E2(Ne.update),Ne.update();else pe.component=ie.component,pe.el=ie.el,Ne.vnode=pe},hi=(ie,pe,Ee,Ne,ze,Ke,at)=>{const He=()=>{if(ie.isMounted){let{next:Mt,bu:mt,u:Ct,parent:It,vnode:qt}=ie,ei=Mt,Xt;ma(ie,!1),Mt?(Mt.el=qt.el,Kt(ie,Mt,at)):Mt=qt,mt&&vf(mt),(Xt=Mt.props&&Mt.props.onVnodeBeforeUpdate)&&io(Xt,It,Mt,qt),ma(ie,!0);const ci=bf(ie),nn=ie.subTree;ie.subTree=ci,Fe(nn,ci,Z(nn.el),wt(nn),ie,ze,Ke),Mt.el=ci.el,ei===null&&D2(ie,ci.el),Ct&&Jn(Ct,ze),(Xt=Mt.props&&Mt.props.onVnodeUpdated)&&Jn(()=>io(Xt,It,Mt,qt),ze)}else{let Mt;const{el:mt,props:Ct}=pe,{bm:It,m:qt,parent:ei}=ie,Xt=Ff(pe);if(ma(ie,!1),It&&vf(It),!Xt&&(Mt=Ct&&Ct.onVnodeBeforeMount)&&io(Mt,ei,pe),ma(ie,!0),mt&&rt){const ci=()=>{ie.subTree=bf(ie),rt(mt,ie.subTree,ie,ze,null)};Xt?pe.type.__asyncLoader().then(()=>!ie.isUnmounted&&ci()):ci()}else{const ci=ie.subTree=bf(ie);Fe(null,ci,Ee,Ne,ie,ze,Ke),pe.el=ci.el}if(qt&&Jn(qt,ze),!Xt&&(Mt=Ct&&Ct.onVnodeMounted)){const ci=pe;Jn(()=>io(Mt,ei,ci),ze)}pe.shapeFlag&256&&ie.a&&Jn(ie.a,ze),ie.isMounted=!0,pe=Ee=Ne=null}},$e=ie.effect=new _m(He,()=>U1(ie.update),ie.scope),Ge=ie.update=$e.run.bind($e);Ge.id=ie.uid,ma(ie,!0),Ge()},Kt=(ie,pe,Ee)=>{pe.component=ie;const Ne=ie.vnode.props;ie.vnode=pe,ie.next=null,J2(ie,pe.props,Ne,Ee),iA(ie,pe.children,Ee),Nl(),Tm(void 0,ie.update),Ul()},Ui=(ie,pe,Ee,Ne,ze,Ke,at,He,$e=!1)=>{const Ge=ie&&ie.children,Mt=ie?ie.shapeFlag:0,mt=pe.children,{patchFlag:Ct,shapeFlag:It}=pe;if(Ct>0){if(Ct&128){Vi(Ge,mt,Ee,Ne,ze,Ke,at,He,$e);return}else if(Ct&256){Un(Ge,mt,Ee,Ne,ze,Ke,at,He,$e);return}}It&8?(Mt&16&&tt(Ge,ze,Ke),mt!==Ge&&te(Ee,mt)):Mt&16?It&16?Vi(Ge,mt,Ee,Ne,ze,Ke,at,He,$e):tt(Ge,ze,Ke,!0):(Mt&8&&te(Ee,""),It&16&&zi(mt,Ee,Ne,ze,Ke,at,He,$e))},Un=(ie,pe,Ee,Ne,ze,Ke,at,He,$e)=>{ie=ie||zl,pe=pe||zl;const Ge=ie.length,Mt=pe.length,mt=Math.min(Ge,Mt);let Ct;for(Ct=0;Ct<mt;Ct++){const It=pe[Ct]=$e?Ts(pe[Ct]):ro(pe[Ct]);Fe(ie[Ct],It,Ee,null,ze,Ke,at,He,$e)}Ge>Mt?tt(ie,ze,Ke,!0,!1,mt):zi(pe,Ee,Ne,ze,Ke,at,He,$e,mt)},Vi=(ie,pe,Ee,Ne,ze,Ke,at,He,$e)=>{let Ge=0;const Mt=pe.length;let mt=ie.length-1,Ct=Mt-1;for(;Ge<=mt&&Ge<=Ct;){const It=ie[Ge],qt=pe[Ge]=$e?Ts(pe[Ge]):ro(pe[Ge]);if(lu(It,qt))Fe(It,qt,Ee,null,ze,Ke,at,He,$e);else break;Ge++}for(;Ge<=mt&&Ge<=Ct;){const It=ie[mt],qt=pe[Ct]=$e?Ts(pe[Ct]):ro(pe[Ct]);if(lu(It,qt))Fe(It,qt,Ee,null,ze,Ke,at,He,$e);else break;mt--,Ct--}if(Ge>mt){if(Ge<=Ct){const It=Ct+1,qt=It<Mt?pe[It].el:Ne;for(;Ge<=Ct;)Fe(null,pe[Ge]=$e?Ts(pe[Ge]):ro(pe[Ge]),Ee,qt,ze,Ke,at,He,$e),Ge++}}else if(Ge>Ct)for(;Ge<=mt;)Gt(ie[Ge],ze,Ke,!0),Ge++;else{const It=Ge,qt=Ge,ei=new Map;for(Ge=qt;Ge<=Ct;Ge++){const $i=pe[Ge]=$e?Ts(pe[Ge]):ro(pe[Ge]);$i.key!=null&&ei.set($i.key,Ge)}let Xt,ci=0;const nn=Ct-qt+1;let vn=!1,br=0;const Ar=new Array(nn);for(Ge=0;Ge<nn;Ge++)Ar[Ge]=0;for(Ge=It;Ge<=mt;Ge++){const $i=ie[Ge];if(ci>=nn){Gt($i,ze,Ke,!0);continue}let rn;if($i.key!=null)rn=ei.get($i.key);else for(Xt=qt;Xt<=Ct;Xt++)if(Ar[Xt-qt]===0&&lu($i,pe[Xt])){rn=Xt;break}rn===void 0?Gt($i,ze,Ke,!0):(Ar[rn-qt]=Ge+1,rn>=br?br=rn:vn=!0,Fe($i,pe[rn],Ee,null,ze,Ke,at,He,$e),ci++)}const ho=vn?aA(Ar):zl;for(Xt=ho.length-1,Ge=nn-1;Ge>=0;Ge--){const $i=qt+Ge,rn=pe[$i],po=$i+1<Mt?pe[$i+1].el:Ne;Ar[Ge]===0?Fe(null,rn,Ee,po,ze,Ke,at,He,$e):vn&&(Xt<0||Ge!==ho[Xt]?pn(rn,Ee,po,2):Xt--)}}},pn=(ie,pe,Ee,Ne,ze=null)=>{const{el:Ke,type:at,transition:He,children:$e,shapeFlag:Ge}=ie;if(Ge&6){pn(ie.component.subTree,pe,Ee,Ne);return}if(Ge&128){ie.suspense.move(pe,Ee,Ne);return}if(Ge&64){at.move(ie,pe,Ee,li);return}if(at===Lo){b(Ke,pe,Ee);for(let mt=0;mt<$e.length;mt++)pn($e[mt],pe,Ee,Ne);b(ie.anchor,pe,Ee);return}if(at===fd){Dt(ie,pe,Ee);return}if(Ne!==2&&Ge&1&&He)if(Ne===0)He.beforeEnter(Ke),b(Ke,pe,Ee),Jn(()=>He.enter(Ke),ze);else{const{leave:mt,delayLeave:Ct,afterLeave:It}=He,qt=()=>b(Ke,pe,Ee),ei=()=>{mt(Ke,()=>{qt(),It&&It()})};Ct?Ct(Ke,qt,ei):ei()}else b(Ke,pe,Ee)},Gt=(ie,pe,Ee,Ne=!1,ze=!1)=>{const{type:Ke,props:at,ref:He,children:$e,dynamicChildren:Ge,shapeFlag:Mt,patchFlag:mt,dirs:Ct}=ie;if(He!=null&&jf(He,null,Ee,ie,!0),Mt&256){pe.ctx.deactivate(ie);return}const It=Mt&1&&Ct,qt=!Ff(ie);let ei;if(qt&&(ei=at&&at.onVnodeBeforeUnmount)&&io(ei,pe,ie),Mt&6)dt(ie.component,Ee,Ne);else{if(Mt&128){ie.suspense.unmount(Ee,Ne);return}It&&fa(ie,null,pe,"beforeUnmount"),Mt&64?ie.type.remove(ie,pe,Ee,ze,li,Ne):Ge&&(Ke!==Lo||mt>0&&mt&64)?tt(Ge,pe,Ee,!1,!0):(Ke===Lo&&mt&384||!ze&&Mt&16)&&tt($e,pe,Ee),Ne&&Wi(ie)}(qt&&(ei=at&&at.onVnodeUnmounted)||It)&&Jn(()=>{ei&&io(ei,pe,ie),It&&fa(ie,null,pe,"unmounted")},Ee)},Wi=ie=>{const{type:pe,el:Ee,anchor:Ne,transition:ze}=ie;if(pe===Lo){Le(Ee,Ne);return}if(pe===fd){Ut(ie);return}const Ke=()=>{T(Ee),ze&&!ze.persisted&&ze.afterLeave&&ze.afterLeave()};if(ie.shapeFlag&1&&ze&&!ze.persisted){const{leave:at,delayLeave:He}=ze,$e=()=>at(Ee,Ke);He?He(ie.el,Ke,$e):$e()}else Ke()},Le=(ie,pe)=>{let Ee;for(;ie!==pe;)Ee=se(ie),T(ie),ie=Ee;T(pe)},dt=(ie,pe,Ee)=>{const{bum:Ne,scope:ze,update:Ke,subTree:at,um:He}=ie;Ne&&vf(Ne),ze.stop(),Ke&&(Ke.active=!1,Gt(at,ie,pe,Ee)),He&&Jn(He,pe),Jn(()=>{ie.isUnmounted=!0},pe),pe&&pe.pendingBranch&&!pe.isUnmounted&&ie.asyncDep&&!ie.asyncResolved&&ie.suspenseId===pe.pendingId&&(pe.deps--,pe.deps===0&&pe.resolve())},tt=(ie,pe,Ee,Ne=!1,ze=!1,Ke=0)=>{for(let at=Ke;at<ie.length;at++)Gt(ie[at],pe,Ee,Ne,ze)},wt=ie=>ie.shapeFlag&6?wt(ie.component.subTree):ie.shapeFlag&128?ie.suspense.next():se(ie.anchor||ie.el),di=(ie,pe,Ee)=>{ie==null?pe._vnode&&Gt(pe._vnode,null,null,!0):Fe(pe._vnode||null,ie,pe,null,null,null,Ee),G1(),pe._vnode=ie},li={p:Fe,um:Gt,m:pn,r:Wi,mt:tr,mc:zi,pc:Ui,pbc:yi,n:wt,o:c};let Ot,rt;return p&&([Ot,rt]=p(li)),{render:di,hydrate:Ot,createApp:rA(di,Ot)}}function ma({effect:c,update:p},y){c.allowRecurse=p.allowRecurse=y}function a0(c,p,y=!1){const b=c.children,T=p.children;if(Qt(b)&&Qt(T))for(let I=0;I<b.length;I++){const D=b[I];let o=T[I];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=T[I]=Ts(T[I]),o.el=D.el),y||a0(D,o))}}function aA(c){const p=c.slice(),y=[0];let b,T,I,D,o;const U=c.length;for(b=0;b<U;b++){const oe=c[b];if(oe!==0){if(T=y[y.length-1],c[T]<oe){p[b]=T,y.push(b);continue}for(I=0,D=y.length-1;I<D;)o=I+D>>1,c[y[o]]<oe?I=o+1:D=o;oe<c[y[I]]&&(I>0&&(p[b]=y[I-1]),y[I]=b)}}for(I=y.length,D=y[I-1];I-- >0;)y[I]=D,D=p[D];return y}const lA=c=>c.__isTeleport,l0="components";function cr(c,p){return uA(l0,c,!0,p)||c}const cA=Symbol();function uA(c,p,y=!0,b=!1){const T=ao||_n;if(T){const I=T.type;if(c===l0){const o=TA(I);if(o&&(o===p||o===co(p)||o===Ld(co(p))))return I}const D=dy(T[c]||I[c],p)||dy(T.appContext[c],p);return!D&&b?I:D}}function dy(c,p){return c&&(c[p]||c[co(p)]||c[Ld(co(p))])}const Lo=Symbol(void 0),Cm=Symbol(void 0),Mu=Symbol(void 0),fd=Symbol(void 0),yu=[];let va=null;function dr(c=!1){yu.push(va=c?null:[])}function hA(){yu.pop(),va=yu[yu.length-1]||null}let Td=1;function py(c){Td+=c}function dA(c){return c.dynamicChildren=Td>0?va||zl:null,hA(),Td>0&&va&&va.push(c),c}function pr(c,p,y,b,T,I){return dA(zt(c,p,y,b,T,I,!0))}function Gf(c){return c?c.__v_isVNode===!0:!1}function lu(c,p){return c.type===p.type&&c.key===p.key}const Vd="__vInternal",c0=({key:c})=>c!=null?c:null,md=({ref:c,ref_key:p,ref_for:y})=>c!=null?yn(c)||gn(c)||Jt(c)?{i:ao,r:c,k:p,f:!!y}:c:null;function zt(c,p=null,y=null,b=0,T=null,I=c===Lo?0:1,D=!1,o=!1){const U={__v_isVNode:!0,__v_skip:!0,type:c,props:p,key:p&&c0(p),ref:p&&md(p),scopeId:Nd,slotScopeIds:null,children:y,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:I,patchFlag:b,dynamicProps:T,dynamicChildren:null,appContext:null};return o?(Mm(U,y),I&128&&c.normalize(U)):y&&(U.shapeFlag|=yn(y)?8:16),Td>0&&!D&&va&&(U.patchFlag>0||I&6)&&U.patchFlag!==32&&va.push(U),U}const gi=pA;function pA(c,p=null,y=null,b=0,T=null,I=!1){if((!c||c===cA)&&(c=Mu),Gf(c)){const o=Su(c,p,!0);return y&&Mm(o,y),o}if(EA(c)&&(c=c.__vccOpts),p){p=fA(p);let{class:o,style:U}=p;o&&!yn(o)&&(p.class=Bl(o)),hn(U)&&(D1(U)&&!Qt(U)&&(U=Nn({},U)),p.style=um(U))}const D=yn(c)?1:P2(c)?128:lA(c)?64:hn(c)?4:Jt(c)?2:0;return zt(c,p,y,b,T,D,I,!0)}function fA(c){return c?D1(c)||Vd in c?Nn({},c):c:null}function Su(c,p,y=!1){const{props:b,ref:T,patchFlag:I,children:D}=c,o=p?mA(b||{},p):b;return{__v_isVNode:!0,__v_skip:!0,type:c.type,props:o,key:o&&c0(o),ref:p&&p.ref?y&&T?Qt(T)?T.concat(md(p)):[T,md(p)]:md(p):T,scopeId:c.scopeId,slotScopeIds:c.slotScopeIds,children:D,target:c.target,targetAnchor:c.targetAnchor,staticCount:c.staticCount,shapeFlag:c.shapeFlag,patchFlag:p&&c.type!==Lo?I===-1?16:I|16:I,dynamicProps:c.dynamicProps,dynamicChildren:c.dynamicChildren,appContext:c.appContext,dirs:c.dirs,transition:c.transition,component:c.component,suspense:c.suspense,ssContent:c.ssContent&&Su(c.ssContent),ssFallback:c.ssFallback&&Su(c.ssFallback),el:c.el,anchor:c.anchor}}function uo(c=" ",p=0){return gi(Cm,null,c,p)}function Ta(c,p){const y=gi(fd,null,c);return y.staticCount=p,y}function ro(c){return c==null||typeof c=="boolean"?gi(Mu):Qt(c)?gi(Lo,null,c.slice()):typeof c=="object"?Ts(c):gi(Cm,null,String(c))}function Ts(c){return c.el===null||c.memo?c:Su(c)}function Mm(c,p){let y=0;const{shapeFlag:b}=c;if(p==null)p=null;else if(Qt(p))y=16;else if(typeof p=="object")if(b&65){const T=p.default;T&&(T._c&&(T._d=!1),Mm(c,T()),T._c&&(T._d=!0));return}else{y=32;const T=p._;!T&&!(Vd in p)?p._ctx=ao:T===3&&ao&&(ao.slots._===1?p._=1:(p._=2,c.patchFlag|=1024))}else Jt(p)?(p={default:p,_ctx:ao},y=32):(p=String(p),b&64?(y=16,p=[uo(p)]):y=8);c.children=p,c.shapeFlag|=y}function mA(...c){const p={};for(let y=0;y<c.length;y++){const b=c[y];for(const T in b)if(T==="class")p.class!==b.class&&(p.class=Bl([p.class,b.class]));else if(T==="style")p.style=um([p.style,b.style]);else if(Dd(T)){const I=p[T],D=b[T];D&&I!==D&&!(Qt(I)&&I.includes(D))&&(p[T]=I?[].concat(I,D):D)}else T!==""&&(p[T]=b[T])}return p}function io(c,p,y,b=null){Rr(c,p,7,[y,b])}const Zf=c=>c?u0(c)?Sm(c)||c.proxy:Zf(c.parent):null,Ed=Nn(Object.create(null),{$:c=>c,$el:c=>c.vnode.el,$data:c=>c.data,$props:c=>c.props,$attrs:c=>c.attrs,$slots:c=>c.slots,$refs:c=>c.refs,$parent:c=>Zf(c.parent),$root:c=>Zf(c.root),$emit:c=>c.emit,$options:c=>e0(c),$forceUpdate:c=>()=>U1(c.update),$nextTick:c=>N1.bind(c.proxy),$watch:c=>L2.bind(c)}),_A={get({_:c},p){const{ctx:y,setupState:b,data:T,props:I,accessCache:D,type:o,appContext:U}=c;let oe;if(p[0]!=="$"){const me=D[p];if(me!==void 0)switch(me){case 1:return b[p];case 2:return T[p];case 4:return y[p];case 3:return I[p]}else{if(b!==Bi&&pi(b,p))return D[p]=1,b[p];if(T!==Bi&&pi(T,p))return D[p]=2,T[p];if((oe=c.propsOptions[0])&&pi(oe,p))return D[p]=3,I[p];if(y!==Bi&&pi(y,p))return D[p]=4,y[p];Nf&&(D[p]=0)}}const te=Ed[p];let Z,se;if(te)return p==="$attrs"&&hr(c,"get",p),te(c);if((Z=o.__cssModules)&&(Z=Z[p]))return Z;if(y!==Bi&&pi(y,p))return D[p]=4,y[p];if(se=U.config.globalProperties,pi(se,p))return se[p]},set({_:c},p,y){const{data:b,setupState:T,ctx:I}=c;return T!==Bi&&pi(T,p)?(T[p]=y,!0):b!==Bi&&pi(b,p)?(b[p]=y,!0):pi(c.props,p)||p[0]==="$"&&p.slice(1)in c?!1:(I[p]=y,!0)},has({_:{data:c,setupState:p,accessCache:y,ctx:b,appContext:T,propsOptions:I}},D){let o;return!!y[D]||c!==Bi&&pi(c,D)||p!==Bi&&pi(p,D)||(o=I[0])&&pi(o,D)||pi(b,D)||pi(Ed,D)||pi(T.config.globalProperties,D)},defineProperty(c,p,y){return y.get!=null?c.$.accessCache[p]=0:pi(y,"value")&&this.set(c,p,y.value,null),Reflect.defineProperty(c,p,y)}},gA=s0();let yA=0;function xA(c,p,y){const b=c.type,T=(p?p.appContext:c.appContext)||gA,I={uid:yA++,vnode:c,type:b,parent:p,appContext:T,root:null,next:null,subTree:null,effect:null,update:null,scope:new x1(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:p?p.provides:Object.create(T.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:i0(b,T),emitsOptions:q1(b,T),emit:null,emitted:null,propsDefaults:Bi,inheritAttrs:b.inheritAttrs,ctx:Bi,data:Bi,props:Bi,attrs:Bi,slots:Bi,refs:Bi,setupState:Bi,setupContext:null,suspense:y,suspenseId:y?y.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return I.ctx={_:I},I.root=p?p.root:I,I.emit=S2.bind(null,I),c.ce&&c.ce(I),I}let _n=null;const Ll=c=>{_n=c,c.scope.on()},ba=()=>{_n&&_n.scope.off(),_n=null};function u0(c){return c.vnode.shapeFlag&4}let Iu=!1;function vA(c,p=!1){Iu=p;const{props:y,children:b}=c.vnode,T=u0(c);$2(c,y,T,p),tA(c,b);const I=T?bA(c,p):void 0;return Iu=!1,I}function bA(c,p){const y=c.type;c.accessCache=Object.create(null),c.proxy=bm(new Proxy(c.ctx,_A));const{setup:b}=y;if(b){const T=c.setupContext=b.length>1?wA(c):null;Ll(c),Nl();const I=Ms(b,c,0,[c.props,T]);if(Ul(),ba(),_1(I)){if(I.then(ba,ba),p)return I.then(D=>{fy(c,D,p)}).catch(D=>{Od(D,c,0)});c.asyncDep=I}else fy(c,I,p)}else h0(c,p)}function fy(c,p,y){Jt(p)?c.type.__ssrInlineRender?c.ssrRender=p:c.render=p:hn(p)&&(c.setupState=O1(p)),h0(c,y)}let my;function h0(c,p,y){const b=c.type;if(!c.render){if(!p&&my&&!b.render){const T=b.template;if(T){const{isCustomElement:I,compilerOptions:D}=c.appContext.config,{delimiters:o,compilerOptions:U}=b,oe=Nn(Nn({isCustomElement:I,delimiters:o},D),U);b.render=my(T,oe)}}c.render=b.render||Lr}Ll(c),Nl(),H2(c),Ul(),ba()}function AA(c){return new Proxy(c.attrs,{get(p,y){return hr(c,"get","$attrs"),p[y]}})}function wA(c){const p=b=>{c.exposed=b||{}};let y;return{get attrs(){return y||(y=AA(c))},slots:c.slots,emit:c.emit,expose:p}}function Sm(c){if(c.exposed)return c.exposeProxy||(c.exposeProxy=new Proxy(O1(bm(c.exposed)),{get(p,y){if(y in p)return p[y];if(y in Ed)return Ed[y](c)}}))}function TA(c){return Jt(c)&&c.displayName||c.name}function EA(c){return Jt(c)&&"__vccOpts"in c}const oo=(c,p)=>A2(c,p,Iu);function d0(c,p,y){const b=arguments.length;return b===2?hn(p)&&!Qt(p)?Gf(p)?gi(c,null,[p]):gi(c,p):gi(c,null,p):(b>3?y=Array.prototype.slice.call(arguments,2):b===3&&Gf(y)&&(y=[y]),gi(c,p,y))}const CA="3.2.32",MA="http://www.w3.org/2000/svg",ga=typeof document!="undefined"?document:null,_y=ga&&ga.createElement("template"),SA={insert:(c,p,y)=>{p.insertBefore(c,y||null)},remove:c=>{const p=c.parentNode;p&&p.removeChild(c)},createElement:(c,p,y,b)=>{const T=p?ga.createElementNS(MA,c):ga.createElement(c,y?{is:y}:void 0);return c==="select"&&b&&b.multiple!=null&&T.setAttribute("multiple",b.multiple),T},createText:c=>ga.createTextNode(c),createComment:c=>ga.createComment(c),setText:(c,p)=>{c.nodeValue=p},setElementText:(c,p)=>{c.textContent=p},parentNode:c=>c.parentNode,nextSibling:c=>c.nextSibling,querySelector:c=>ga.querySelector(c),setScopeId(c,p){c.setAttribute(p,"")},cloneNode(c){const p=c.cloneNode(!0);return"_value"in c&&(p._value=c._value),p},insertStaticContent(c,p,y,b,T,I){const D=y?y.previousSibling:p.lastChild;if(T&&(T===I||T.nextSibling))for(;p.insertBefore(T.cloneNode(!0),y),!(T===I||!(T=T.nextSibling)););else{_y.innerHTML=b?`<svg>${c}</svg>`:c;const o=_y.content;if(b){const U=o.firstChild;for(;U.firstChild;)o.appendChild(U.firstChild);o.removeChild(U)}p.insertBefore(o,y)}return[D?D.nextSibling:p.firstChild,y?y.previousSibling:p.lastChild]}};function IA(c,p,y){const b=c._vtc;b&&(p=(p?[p,...b]:[...b]).join(" ")),p==null?c.removeAttribute("class"):y?c.setAttribute("class",p):c.className=p}function zA(c,p,y){const b=c.style,T=yn(y);if(y&&!T){for(const I in y)qf(b,I,y[I]);if(p&&!yn(p))for(const I in p)y[I]==null&&qf(b,I,"")}else{const I=b.display;T?p!==y&&(b.cssText=y):p&&c.removeAttribute("style"),"_vod"in c&&(b.display=I)}}const gy=/\s*!important$/;function qf(c,p,y){if(Qt(y))y.forEach(b=>qf(c,p,b));else if(p.startsWith("--"))c.setProperty(p,y);else{const b=kA(c,p);gy.test(y)?c.setProperty(Fl(b),y.replace(gy,""),"important"):c[b]=y}}const yy=["Webkit","Moz","ms"],Af={};function kA(c,p){const y=Af[p];if(y)return y;let b=co(p);if(b!=="filter"&&b in c)return Af[p]=b;b=Ld(b);for(let T=0;T<yy.length;T++){const I=yy[T]+b;if(I in c)return Af[p]=I}return p}const xy="http://www.w3.org/1999/xlink";function DA(c,p,y,b,T){if(b&&p.startsWith("xlink:"))y==null?c.removeAttributeNS(xy,p.slice(6,p.length)):c.setAttributeNS(xy,p,y);else{const I=Db(p);y==null||I&&!p1(y)?c.removeAttribute(p):c.setAttribute(p,I?"":y)}}function PA(c,p,y,b,T,I,D){if(p==="innerHTML"||p==="textContent"){b&&D(b,T,I),c[p]=y==null?"":y;return}if(p==="value"&&c.tagName!=="PROGRESS"&&!c.tagName.includes("-")){c._value=y;const o=y==null?"":y;(c.value!==o||c.tagName==="OPTION")&&(c.value=o),y==null&&c.removeAttribute(p);return}if(y===""||y==null){const o=typeof c[p];if(o==="boolean"){c[p]=p1(y);return}else if(y==null&&o==="string"){c[p]="",c.removeAttribute(p);return}else if(o==="number"){try{c[p]=0}catch{}c.removeAttribute(p);return}}try{c[p]=y}catch{}}let Cd=Date.now,p0=!1;if(typeof window!="undefined"){Cd()>document.createEvent("Event").timeStamp&&(Cd=()=>performance.now());const c=navigator.userAgent.match(/firefox\/(\d+)/i);p0=!!(c&&Number(c[1])<=53)}let Wf=0;const BA=Promise.resolve(),LA=()=>{Wf=0},RA=()=>Wf||(BA.then(LA),Wf=Cd());function OA(c,p,y,b){c.addEventListener(p,y,b)}function FA(c,p,y,b){c.removeEventListener(p,y,b)}function NA(c,p,y,b,T=null){const I=c._vei||(c._vei={}),D=I[p];if(b&&D)D.value=b;else{const[o,U]=UA(p);if(b){const oe=I[p]=VA(b,T);OA(c,o,oe,U)}else D&&(FA(c,o,D,U),I[p]=void 0)}}const vy=/(?:Once|Passive|Capture)$/;function UA(c){let p;if(vy.test(c)){p={};let y;for(;y=c.match(vy);)c=c.slice(0,c.length-y[0].length),p[y[0].toLowerCase()]=!0}return[Fl(c.slice(2)),p]}function VA(c,p){const y=b=>{const T=b.timeStamp||Cd();(p0||T>=y.attached-1)&&Rr(jA(b,y.value),p,5,[b])};return y.value=c,y.attached=RA(),y}function jA(c,p){if(Qt(p)){const y=c.stopImmediatePropagation;return c.stopImmediatePropagation=()=>{y.call(c),c._stopped=!0},p.map(b=>T=>!T._stopped&&b&&b(T))}else return p}const by=/^on[a-z]/,GA=(c,p,y,b,T=!1,I,D,o,U)=>{p==="class"?IA(c,b,T):p==="style"?zA(c,y,b):Dd(p)?hm(p)||NA(c,p,y,b,D):(p[0]==="."?(p=p.slice(1),!0):p[0]==="^"?(p=p.slice(1),!1):ZA(c,p,b,T))?PA(c,p,b,I,D,o,U):(p==="true-value"?c._trueValue=b:p==="false-value"&&(c._falseValue=b),DA(c,p,b,T))};function ZA(c,p,y,b){return b?!!(p==="innerHTML"||p==="textContent"||p in c&&by.test(p)&&Jt(y)):p==="spellcheck"||p==="draggable"||p==="form"||p==="list"&&c.tagName==="INPUT"||p==="type"&&c.tagName==="TEXTAREA"||by.test(p)&&yn(y)?!1:p in c}const qA=["ctrl","shift","alt","meta"],WA={stop:c=>c.stopPropagation(),prevent:c=>c.preventDefault(),self:c=>c.target!==c.currentTarget,ctrl:c=>!c.ctrlKey,shift:c=>!c.shiftKey,alt:c=>!c.altKey,meta:c=>!c.metaKey,left:c=>"button"in c&&c.button!==0,middle:c=>"button"in c&&c.button!==1,right:c=>"button"in c&&c.button!==2,exact:(c,p)=>qA.some(y=>c[`${y}Key`]&&!p.includes(y))},HA=(c,p)=>(y,...b)=>{for(let T=0;T<p.length;T++){const I=WA[p[T]];if(I&&I(y,p))return}return c(y,...b)},YA=Nn({patchProp:GA},SA);let Ay;function XA(){return Ay||(Ay=oA(YA))}const QA=(...c)=>{const p=XA().createApp(...c),{mount:y}=p;return p.mount=b=>{const T=KA(b);if(!T)return;const I=p._component;!Jt(I)&&!I.render&&!I.template&&(I.template=T.innerHTML),T.innerHTML="";const D=y(T,!1,T instanceof SVGElement);return T instanceof Element&&(T.removeAttribute("v-cloak"),T.setAttribute("data-v-app","")),D},p};function KA(c){return yn(c)?document.querySelector(c):c}var $A=!1;/*!
  * pinia v2.0.13
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const JA=Symbol();var wy;(function(c){c.direct="direct",c.patchObject="patch object",c.patchFunction="patch function"})(wy||(wy={}));function ew(){const c=Zb(!0),p=c.run(()=>L1({}));let y=[],b=[];const T=bm({install(I){T._a=I,I.provide(JA,T),I.config.globalProperties.$pinia=T,b.forEach(D=>y.push(D)),b=[]},use(I){return!this._a&&!$A?b.push(I):y.push(I),this},_p:y,_a:null,_e:c,_s:new Map,state:p});return T}const f0=Vl({isVisible:!1});/*!
  * vue-router v4.0.14
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const m0=typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol",jl=c=>m0?Symbol(c):"_vr_"+c,tw=jl("rvlm"),Ty=jl("rvd"),Im=jl("r"),_0=jl("rl"),Hf=jl("rvl"),Cl=typeof window!="undefined";function iw(c){return c.__esModule||m0&&c[Symbol.toStringTag]==="Module"}const Ii=Object.assign;function wf(c,p){const y={};for(const b in p){const T=p[b];y[b]=Array.isArray(T)?T.map(c):c(T)}return y}const xu=()=>{},nw=/\/$/,rw=c=>c.replace(nw,"");function Tf(c,p,y="/"){let b,T={},I="",D="";const o=p.indexOf("?"),U=p.indexOf("#",o>-1?o:0);return o>-1&&(b=p.slice(0,o),I=p.slice(o+1,U>-1?U:p.length),T=c(I)),U>-1&&(b=b||p.slice(0,U),D=p.slice(U,p.length)),b=lw(b!=null?b:p,y),{fullPath:b+(I&&"?")+I+D,path:b,query:T,hash:D}}function ow(c,p){const y=p.query?c(p.query):"";return p.path+(y&&"?")+y+(p.hash||"")}function Ey(c,p){return!p||!c.toLowerCase().startsWith(p.toLowerCase())?c:c.slice(p.length)||"/"}function sw(c,p,y){const b=p.matched.length-1,T=y.matched.length-1;return b>-1&&b===T&&Rl(p.matched[b],y.matched[T])&&g0(p.params,y.params)&&c(p.query)===c(y.query)&&p.hash===y.hash}function Rl(c,p){return(c.aliasOf||c)===(p.aliasOf||p)}function g0(c,p){if(Object.keys(c).length!==Object.keys(p).length)return!1;for(const y in c)if(!aw(c[y],p[y]))return!1;return!0}function aw(c,p){return Array.isArray(c)?Cy(c,p):Array.isArray(p)?Cy(p,c):c===p}function Cy(c,p){return Array.isArray(p)?c.length===p.length&&c.every((y,b)=>y===p[b]):c.length===1&&c[0]===p}function lw(c,p){if(c.startsWith("/"))return c;if(!c)return p;const y=p.split("/"),b=c.split("/");let T=y.length-1,I,D;for(I=0;I<b.length;I++)if(D=b[I],!(T===1||D==="."))if(D==="..")T--;else break;return y.slice(0,T).join("/")+"/"+b.slice(I-(I===b.length?1:0)).join("/")}var zu;(function(c){c.pop="pop",c.push="push"})(zu||(zu={}));var vu;(function(c){c.back="back",c.forward="forward",c.unknown=""})(vu||(vu={}));function cw(c){if(!c)if(Cl){const p=document.querySelector("base");c=p&&p.getAttribute("href")||"/",c=c.replace(/^\w+:\/\/[^\/]+/,"")}else c="/";return c[0]!=="/"&&c[0]!=="#"&&(c="/"+c),rw(c)}const uw=/^[^#]+#/;function hw(c,p){return c.replace(uw,"#")+p}function dw(c,p){const y=document.documentElement.getBoundingClientRect(),b=c.getBoundingClientRect();return{behavior:p.behavior,left:b.left-y.left-(p.left||0),top:b.top-y.top-(p.top||0)}}const jd=()=>({left:window.pageXOffset,top:window.pageYOffset});function pw(c){let p;if("el"in c){const y=c.el,b=typeof y=="string"&&y.startsWith("#"),T=typeof y=="string"?b?document.getElementById(y.slice(1)):document.querySelector(y):y;if(!T)return;p=dw(T,c)}else p=c;"scrollBehavior"in document.documentElement.style?window.scrollTo(p):window.scrollTo(p.left!=null?p.left:window.pageXOffset,p.top!=null?p.top:window.pageYOffset)}function My(c,p){return(history.state?history.state.position-p:-1)+c}const Yf=new Map;function fw(c,p){Yf.set(c,p)}function mw(c){const p=Yf.get(c);return Yf.delete(c),p}let _w=()=>location.protocol+"//"+location.host;function y0(c,p){const{pathname:y,search:b,hash:T}=p,I=c.indexOf("#");if(I>-1){let o=T.includes(c.slice(I))?c.slice(I).length:1,U=T.slice(o);return U[0]!=="/"&&(U="/"+U),Ey(U,"")}return Ey(y,c)+b+T}function gw(c,p,y,b){let T=[],I=[],D=null;const o=({state:se})=>{const me=y0(c,location),Ye=y.value,ft=p.value;let Fe=0;if(se){if(y.value=me,p.value=se,D&&D===Ye){D=null;return}Fe=ft?se.position-ft.position:0}else b(me);T.forEach(ke=>{ke(y.value,Ye,{delta:Fe,type:zu.pop,direction:Fe?Fe>0?vu.forward:vu.back:vu.unknown})})};function U(){D=y.value}function oe(se){T.push(se);const me=()=>{const Ye=T.indexOf(se);Ye>-1&&T.splice(Ye,1)};return I.push(me),me}function te(){const{history:se}=window;!se.state||se.replaceState(Ii({},se.state,{scroll:jd()}),"")}function Z(){for(const se of I)se();I=[],window.removeEventListener("popstate",o),window.removeEventListener("beforeunload",te)}return window.addEventListener("popstate",o),window.addEventListener("beforeunload",te),{pauseListeners:U,listen:oe,destroy:Z}}function Sy(c,p,y,b=!1,T=!1){return{back:c,current:p,forward:y,replaced:b,position:window.history.length,scroll:T?jd():null}}function yw(c){const{history:p,location:y}=window,b={value:y0(c,y)},T={value:p.state};T.value||I(b.value,{back:null,current:b.value,forward:null,position:p.length-1,replaced:!0,scroll:null},!0);function I(U,oe,te){const Z=c.indexOf("#"),se=Z>-1?(y.host&&document.querySelector("base")?c:c.slice(Z))+U:_w()+c+U;try{p[te?"replaceState":"pushState"](oe,"",se),T.value=oe}catch(me){console.error(me),y[te?"replace":"assign"](se)}}function D(U,oe){const te=Ii({},p.state,Sy(T.value.back,U,T.value.forward,!0),oe,{position:T.value.position});I(U,te,!0),b.value=U}function o(U,oe){const te=Ii({},T.value,p.state,{forward:U,scroll:jd()});I(te.current,te,!0);const Z=Ii({},Sy(b.value,U,null),{position:te.position+1},oe);I(U,Z,!1),b.value=U}return{location:b,state:T,push:o,replace:D}}function xw(c){c=cw(c);const p=yw(c),y=gw(c,p.state,p.location,p.replace);function b(I,D=!0){D||y.pauseListeners(),history.go(I)}const T=Ii({location:"",base:c,go:b,createHref:hw.bind(null,c)},p,y);return Object.defineProperty(T,"location",{enumerable:!0,get:()=>p.location.value}),Object.defineProperty(T,"state",{enumerable:!0,get:()=>p.state.value}),T}function vw(c){return typeof c=="string"||c&&typeof c=="object"}function x0(c){return typeof c=="string"||typeof c=="symbol"}const vs={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},v0=jl("nf");var Iy;(function(c){c[c.aborted=4]="aborted",c[c.cancelled=8]="cancelled",c[c.duplicated=16]="duplicated"})(Iy||(Iy={}));function Ol(c,p){return Ii(new Error,{type:c,[v0]:!0},p)}function bs(c,p){return c instanceof Error&&v0 in c&&(p==null||!!(c.type&p))}const zy="[^/]+?",bw={sensitive:!1,strict:!1,start:!0,end:!0},Aw=/[.+*?^${}()[\]/\\]/g;function ww(c,p){const y=Ii({},bw,p),b=[];let T=y.start?"^":"";const I=[];for(const oe of c){const te=oe.length?[]:[90];y.strict&&!oe.length&&(T+="/");for(let Z=0;Z<oe.length;Z++){const se=oe[Z];let me=40+(y.sensitive?.25:0);if(se.type===0)Z||(T+="/"),T+=se.value.replace(Aw,"\\$&"),me+=40;else if(se.type===1){const{value:Ye,repeatable:ft,optional:Fe,regexp:ke}=se;I.push({name:Ye,repeatable:ft,optional:Fe});const Xe=ke||zy;if(Xe!==zy){me+=10;try{new RegExp(`(${Xe})`)}catch(Dt){throw new Error(`Invalid custom RegExp for param "${Ye}" (${Xe}): `+Dt.message)}}let vt=ft?`((?:${Xe})(?:/(?:${Xe}))*)`:`(${Xe})`;Z||(vt=Fe&&oe.length<2?`(?:/${vt})`:"/"+vt),Fe&&(vt+="?"),T+=vt,me+=20,Fe&&(me+=-8),ft&&(me+=-20),Xe===".*"&&(me+=-50)}te.push(me)}b.push(te)}if(y.strict&&y.end){const oe=b.length-1;b[oe][b[oe].length-1]+=.7000000000000001}y.strict||(T+="/?"),y.end?T+="$":y.strict&&(T+="(?:/|$)");const D=new RegExp(T,y.sensitive?"":"i");function o(oe){const te=oe.match(D),Z={};if(!te)return null;for(let se=1;se<te.length;se++){const me=te[se]||"",Ye=I[se-1];Z[Ye.name]=me&&Ye.repeatable?me.split("/"):me}return Z}function U(oe){let te="",Z=!1;for(const se of c){(!Z||!te.endsWith("/"))&&(te+="/"),Z=!1;for(const me of se)if(me.type===0)te+=me.value;else if(me.type===1){const{value:Ye,repeatable:ft,optional:Fe}=me,ke=Ye in oe?oe[Ye]:"";if(Array.isArray(ke)&&!ft)throw new Error(`Provided param "${Ye}" is an array but it is not repeatable (* or + modifiers)`);const Xe=Array.isArray(ke)?ke.join("/"):ke;if(!Xe)if(Fe)se.length<2&&(te.endsWith("/")?te=te.slice(0,-1):Z=!0);else throw new Error(`Missing required param "${Ye}"`);te+=Xe}}return te}return{re:D,score:b,keys:I,parse:o,stringify:U}}function Tw(c,p){let y=0;for(;y<c.length&&y<p.length;){const b=p[y]-c[y];if(b)return b;y++}return c.length<p.length?c.length===1&&c[0]===40+40?-1:1:c.length>p.length?p.length===1&&p[0]===40+40?1:-1:0}function Ew(c,p){let y=0;const b=c.score,T=p.score;for(;y<b.length&&y<T.length;){const I=Tw(b[y],T[y]);if(I)return I;y++}return T.length-b.length}const Cw={type:0,value:""},Mw=/[a-zA-Z0-9_]/;function Sw(c){if(!c)return[[]];if(c==="/")return[[Cw]];if(!c.startsWith("/"))throw new Error(`Invalid path "${c}"`);function p(me){throw new Error(`ERR (${y})/"${oe}": ${me}`)}let y=0,b=y;const T=[];let I;function D(){I&&T.push(I),I=[]}let o=0,U,oe="",te="";function Z(){!oe||(y===0?I.push({type:0,value:oe}):y===1||y===2||y===3?(I.length>1&&(U==="*"||U==="+")&&p(`A repeatable param (${oe}) must be alone in its segment. eg: '/:ids+.`),I.push({type:1,value:oe,regexp:te,repeatable:U==="*"||U==="+",optional:U==="*"||U==="?"})):p("Invalid state to consume buffer"),oe="")}function se(){oe+=U}for(;o<c.length;){if(U=c[o++],U==="\\"&&y!==2){b=y,y=4;continue}switch(y){case 0:U==="/"?(oe&&Z(),D()):U===":"?(Z(),y=1):se();break;case 4:se(),y=b;break;case 1:U==="("?y=2:Mw.test(U)?se():(Z(),y=0,U!=="*"&&U!=="?"&&U!=="+"&&o--);break;case 2:U===")"?te[te.length-1]=="\\"?te=te.slice(0,-1)+U:y=3:te+=U;break;case 3:Z(),y=0,U!=="*"&&U!=="?"&&U!=="+"&&o--,te="";break;default:p("Unknown state");break}}return y===2&&p(`Unfinished custom RegExp for param "${oe}"`),Z(),D(),T}function Iw(c,p,y){const b=ww(Sw(c.path),y),T=Ii(b,{record:c,parent:p,children:[],alias:[]});return p&&!T.record.aliasOf==!p.record.aliasOf&&p.children.push(T),T}function zw(c,p){const y=[],b=new Map;p=Dy({strict:!1,end:!0,sensitive:!1},p);function T(te){return b.get(te)}function I(te,Z,se){const me=!se,Ye=Dw(te);Ye.aliasOf=se&&se.record;const ft=Dy(p,te),Fe=[Ye];if("alias"in te){const vt=typeof te.alias=="string"?[te.alias]:te.alias;for(const Dt of vt)Fe.push(Ii({},Ye,{components:se?se.record.components:Ye.components,path:Dt,aliasOf:se?se.record:Ye}))}let ke,Xe;for(const vt of Fe){const{path:Dt}=vt;if(Z&&Dt[0]!=="/"){const Ut=Z.record.path,At=Ut[Ut.length-1]==="/"?"":"/";vt.path=Z.record.path+(Dt&&At+Dt)}if(ke=Iw(vt,Z,ft),se?se.alias.push(ke):(Xe=Xe||ke,Xe!==ke&&Xe.alias.push(ke),me&&te.name&&!ky(ke)&&D(te.name)),"children"in Ye){const Ut=Ye.children;for(let At=0;At<Ut.length;At++)I(Ut[At],ke,se&&se.children[At])}se=se||ke,U(ke)}return Xe?()=>{D(Xe)}:xu}function D(te){if(x0(te)){const Z=b.get(te);Z&&(b.delete(te),y.splice(y.indexOf(Z),1),Z.children.forEach(D),Z.alias.forEach(D))}else{const Z=y.indexOf(te);Z>-1&&(y.splice(Z,1),te.record.name&&b.delete(te.record.name),te.children.forEach(D),te.alias.forEach(D))}}function o(){return y}function U(te){let Z=0;for(;Z<y.length&&Ew(te,y[Z])>=0&&(te.record.path!==y[Z].record.path||!b0(te,y[Z]));)Z++;y.splice(Z,0,te),te.record.name&&!ky(te)&&b.set(te.record.name,te)}function oe(te,Z){let se,me={},Ye,ft;if("name"in te&&te.name){if(se=b.get(te.name),!se)throw Ol(1,{location:te});ft=se.record.name,me=Ii(kw(Z.params,se.keys.filter(Xe=>!Xe.optional).map(Xe=>Xe.name)),te.params),Ye=se.stringify(me)}else if("path"in te)Ye=te.path,se=y.find(Xe=>Xe.re.test(Ye)),se&&(me=se.parse(Ye),ft=se.record.name);else{if(se=Z.name?b.get(Z.name):y.find(Xe=>Xe.re.test(Z.path)),!se)throw Ol(1,{location:te,currentLocation:Z});ft=se.record.name,me=Ii({},Z.params,te.params),Ye=se.stringify(me)}const Fe=[];let ke=se;for(;ke;)Fe.unshift(ke.record),ke=ke.parent;return{name:ft,path:Ye,params:me,matched:Fe,meta:Bw(Fe)}}return c.forEach(te=>I(te)),{addRoute:I,resolve:oe,removeRoute:D,getRoutes:o,getRecordMatcher:T}}function kw(c,p){const y={};for(const b of p)b in c&&(y[b]=c[b]);return y}function Dw(c){return{path:c.path,redirect:c.redirect,name:c.name,meta:c.meta||{},aliasOf:void 0,beforeEnter:c.beforeEnter,props:Pw(c),children:c.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in c?c.components||{}:{default:c.component}}}function Pw(c){const p={},y=c.props||!1;if("component"in c)p.default=y;else for(const b in c.components)p[b]=typeof y=="boolean"?y:y[b];return p}function ky(c){for(;c;){if(c.record.aliasOf)return!0;c=c.parent}return!1}function Bw(c){return c.reduce((p,y)=>Ii(p,y.meta),{})}function Dy(c,p){const y={};for(const b in c)y[b]=b in p?p[b]:c[b];return y}function b0(c,p){return p.children.some(y=>y===c||b0(c,y))}const A0=/#/g,Lw=/&/g,Rw=/\//g,Ow=/=/g,Fw=/\?/g,w0=/\+/g,Nw=/%5B/g,Uw=/%5D/g,T0=/%5E/g,Vw=/%60/g,E0=/%7B/g,jw=/%7C/g,C0=/%7D/g,Gw=/%20/g;function zm(c){return encodeURI(""+c).replace(jw,"|").replace(Nw,"[").replace(Uw,"]")}function Zw(c){return zm(c).replace(E0,"{").replace(C0,"}").replace(T0,"^")}function Xf(c){return zm(c).replace(w0,"%2B").replace(Gw,"+").replace(A0,"%23").replace(Lw,"%26").replace(Vw,"`").replace(E0,"{").replace(C0,"}").replace(T0,"^")}function qw(c){return Xf(c).replace(Ow,"%3D")}function Ww(c){return zm(c).replace(A0,"%23").replace(Fw,"%3F")}function Hw(c){return c==null?"":Ww(c).replace(Rw,"%2F")}function Md(c){try{return decodeURIComponent(""+c)}catch{}return""+c}function Yw(c){const p={};if(c===""||c==="?")return p;const b=(c[0]==="?"?c.slice(1):c).split("&");for(let T=0;T<b.length;++T){const I=b[T].replace(w0," "),D=I.indexOf("="),o=Md(D<0?I:I.slice(0,D)),U=D<0?null:Md(I.slice(D+1));if(o in p){let oe=p[o];Array.isArray(oe)||(oe=p[o]=[oe]),oe.push(U)}else p[o]=U}return p}function Py(c){let p="";for(let y in c){const b=c[y];if(y=qw(y),b==null){b!==void 0&&(p+=(p.length?"&":"")+y);continue}(Array.isArray(b)?b.map(I=>I&&Xf(I)):[b&&Xf(b)]).forEach(I=>{I!==void 0&&(p+=(p.length?"&":"")+y,I!=null&&(p+="="+I))})}return p}function Xw(c){const p={};for(const y in c){const b=c[y];b!==void 0&&(p[y]=Array.isArray(b)?b.map(T=>T==null?null:""+T):b==null?b:""+b)}return p}function cu(){let c=[];function p(b){return c.push(b),()=>{const T=c.indexOf(b);T>-1&&c.splice(T,1)}}function y(){c=[]}return{add:p,list:()=>c,reset:y}}function Es(c,p,y,b,T){const I=b&&(b.enterCallbacks[T]=b.enterCallbacks[T]||[]);return()=>new Promise((D,o)=>{const U=Z=>{Z===!1?o(Ol(4,{from:y,to:p})):Z instanceof Error?o(Z):vw(Z)?o(Ol(2,{from:p,to:Z})):(I&&b.enterCallbacks[T]===I&&typeof Z=="function"&&I.push(Z),D())},oe=c.call(b&&b.instances[T],p,y,U);let te=Promise.resolve(oe);c.length<3&&(te=te.then(U)),te.catch(Z=>o(Z))})}function Ef(c,p,y,b){const T=[];for(const I of c)for(const D in I.components){let o=I.components[D];if(!(p!=="beforeRouteEnter"&&!I.instances[D]))if(Qw(o)){const oe=(o.__vccOpts||o)[p];oe&&T.push(Es(oe,y,b,I,D))}else{let U=o();T.push(()=>U.then(oe=>{if(!oe)return Promise.reject(new Error(`Couldn't resolve component "${D}" at "${I.path}"`));const te=iw(oe)?oe.default:oe;I.components[D]=te;const se=(te.__vccOpts||te)[p];return se&&Es(se,y,b,I,D)()}))}}return T}function Qw(c){return typeof c=="object"||"displayName"in c||"props"in c||"__vccOpts"in c}function By(c){const p=Ss(Im),y=Ss(_0),b=oo(()=>p.resolve(mu(c.to))),T=oo(()=>{const{matched:U}=b.value,{length:oe}=U,te=U[oe-1],Z=y.matched;if(!te||!Z.length)return-1;const se=Z.findIndex(Rl.bind(null,te));if(se>-1)return se;const me=Ly(U[oe-2]);return oe>1&&Ly(te)===me&&Z[Z.length-1].path!==me?Z.findIndex(Rl.bind(null,U[oe-2])):se}),I=oo(()=>T.value>-1&&e5(y.params,b.value.params)),D=oo(()=>T.value>-1&&T.value===y.matched.length-1&&g0(y.params,b.value.params));function o(U={}){return Jw(U)?p[mu(c.replace)?"replace":"push"](mu(c.to)).catch(xu):Promise.resolve()}return{route:b,href:oo(()=>b.value.href),isActive:I,isExactActive:D,navigate:o}}const Kw=Y1({name:"RouterLink",props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:By,setup(c,{slots:p}){const y=Vl(By(c)),{options:b}=Ss(Im),T=oo(()=>({[Ry(c.activeClass,b.linkActiveClass,"router-link-active")]:y.isActive,[Ry(c.exactActiveClass,b.linkExactActiveClass,"router-link-exact-active")]:y.isExactActive}));return()=>{const I=p.default&&p.default(y);return c.custom?I:d0("a",{"aria-current":y.isExactActive?c.ariaCurrentValue:null,href:y.href,onClick:y.navigate,class:T.value},I)}}}),$w=Kw;function Jw(c){if(!(c.metaKey||c.altKey||c.ctrlKey||c.shiftKey)&&!c.defaultPrevented&&!(c.button!==void 0&&c.button!==0)){if(c.currentTarget&&c.currentTarget.getAttribute){const p=c.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(p))return}return c.preventDefault&&c.preventDefault(),!0}}function e5(c,p){for(const y in p){const b=p[y],T=c[y];if(typeof b=="string"){if(b!==T)return!1}else if(!Array.isArray(T)||T.length!==b.length||b.some((I,D)=>I!==T[D]))return!1}return!0}function Ly(c){return c?c.aliasOf?c.aliasOf.path:c.path:""}const Ry=(c,p,y)=>c!=null?c:p!=null?p:y,t5=Y1({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},setup(c,{attrs:p,slots:y}){const b=Ss(Hf),T=oo(()=>c.route||b.value),I=Ss(Ty,0),D=oo(()=>T.value.matched[I]);dd(Ty,I+1),dd(tw,D),dd(Hf,T);const o=L1();return pd(()=>[o.value,D.value,c.name],([U,oe,te],[Z,se,me])=>{oe&&(oe.instances[te]=U,se&&se!==oe&&U&&U===Z&&(oe.leaveGuards.size||(oe.leaveGuards=se.leaveGuards),oe.updateGuards.size||(oe.updateGuards=se.updateGuards))),U&&oe&&(!se||!Rl(oe,se)||!Z)&&(oe.enterCallbacks[te]||[]).forEach(Ye=>Ye(U))},{flush:"post"}),()=>{const U=T.value,oe=D.value,te=oe&&oe.components[c.name],Z=c.name;if(!te)return Oy(y.default,{Component:te,route:U});const se=oe.props[c.name],me=se?se===!0?U.params:typeof se=="function"?se(U):se:null,ft=d0(te,Ii({},me,p,{onVnodeUnmounted:Fe=>{Fe.component.isUnmounted&&(oe.instances[Z]=null)},ref:o}));return Oy(y.default,{Component:ft,route:U})||ft}}});function Oy(c,p){if(!c)return null;const y=c(p);return y.length===1?y[0]:y}const i5=t5;function n5(c){const p=zw(c.routes,c),y=c.parseQuery||Yw,b=c.stringifyQuery||Py,T=c.history,I=cu(),D=cu(),o=cu(),U=y2(vs);let oe=vs;Cl&&c.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const te=wf.bind(null,Le=>""+Le),Z=wf.bind(null,Hw),se=wf.bind(null,Md);function me(Le,dt){let tt,wt;return x0(Le)?(tt=p.getRecordMatcher(Le),wt=dt):wt=Le,p.addRoute(wt,tt)}function Ye(Le){const dt=p.getRecordMatcher(Le);dt&&p.removeRoute(dt)}function ft(){return p.getRoutes().map(Le=>Le.record)}function Fe(Le){return!!p.getRecordMatcher(Le)}function ke(Le,dt){if(dt=Ii({},dt||U.value),typeof Le=="string"){const rt=Tf(y,Le,dt.path),ie=p.resolve({path:rt.path},dt),pe=T.createHref(rt.fullPath);return Ii(rt,ie,{params:se(ie.params),hash:Md(rt.hash),redirectedFrom:void 0,href:pe})}let tt;if("path"in Le)tt=Ii({},Le,{path:Tf(y,Le.path,dt.path).path});else{const rt=Ii({},Le.params);for(const ie in rt)rt[ie]==null&&delete rt[ie];tt=Ii({},Le,{params:Z(Le.params)}),dt.params=Z(dt.params)}const wt=p.resolve(tt,dt),di=Le.hash||"";wt.params=te(se(wt.params));const li=ow(b,Ii({},Le,{hash:Zw(di),path:wt.path})),Ot=T.createHref(li);return Ii({fullPath:li,hash:di,query:b===Py?Xw(Le.query):Le.query||{}},wt,{redirectedFrom:void 0,href:Ot})}function Xe(Le){return typeof Le=="string"?Tf(y,Le,U.value.path):Ii({},Le)}function vt(Le,dt){if(oe!==Le)return Ol(8,{from:dt,to:Le})}function Dt(Le){return Ci(Le)}function Ut(Le){return Dt(Ii(Xe(Le),{replace:!0}))}function At(Le){const dt=Le.matched[Le.matched.length-1];if(dt&&dt.redirect){const{redirect:tt}=dt;let wt=typeof tt=="function"?tt(Le):tt;return typeof wt=="string"&&(wt=wt.includes("?")||wt.includes("#")?wt=Xe(wt):{path:wt},wt.params={}),Ii({query:Le.query,hash:Le.hash,params:Le.params},wt)}}function Ci(Le,dt){const tt=oe=ke(Le),wt=U.value,di=Le.state,li=Le.force,Ot=Le.replace===!0,rt=At(tt);if(rt)return Ci(Ii(Xe(rt),{state:di,force:li,replace:Ot}),dt||tt);const ie=tt;ie.redirectedFrom=dt;let pe;return!li&&sw(b,wt,tt)&&(pe=Ol(16,{to:ie,from:wt}),Un(wt,wt,!0,!1)),(pe?Promise.resolve(pe):zi(ie,wt)).catch(Ee=>bs(Ee)?bs(Ee,2)?Ee:Ui(Ee):hi(Ee,ie,wt)).then(Ee=>{if(Ee){if(bs(Ee,2))return Ci(Ii(Xe(Ee.to),{state:di,force:li,replace:Ot}),dt||ie)}else Ee=yi(ie,wt,!0,Ot,di);return xn(ie,wt,Ee),Ee})}function Li(Le,dt){const tt=vt(Le,dt);return tt?Promise.reject(tt):Promise.resolve()}function zi(Le,dt){let tt;const[wt,di,li]=r5(Le,dt);tt=Ef(wt.reverse(),"beforeRouteLeave",Le,dt);for(const rt of wt)rt.leaveGuards.forEach(ie=>{tt.push(Es(ie,Le,dt))});const Ot=Li.bind(null,Le,dt);return tt.push(Ot),wl(tt).then(()=>{tt=[];for(const rt of I.list())tt.push(Es(rt,Le,dt));return tt.push(Ot),wl(tt)}).then(()=>{tt=Ef(di,"beforeRouteUpdate",Le,dt);for(const rt of di)rt.updateGuards.forEach(ie=>{tt.push(Es(ie,Le,dt))});return tt.push(Ot),wl(tt)}).then(()=>{tt=[];for(const rt of Le.matched)if(rt.beforeEnter&&!dt.matched.includes(rt))if(Array.isArray(rt.beforeEnter))for(const ie of rt.beforeEnter)tt.push(Es(ie,Le,dt));else tt.push(Es(rt.beforeEnter,Le,dt));return tt.push(Ot),wl(tt)}).then(()=>(Le.matched.forEach(rt=>rt.enterCallbacks={}),tt=Ef(li,"beforeRouteEnter",Le,dt),tt.push(Ot),wl(tt))).then(()=>{tt=[];for(const rt of D.list())tt.push(Es(rt,Le,dt));return tt.push(Ot),wl(tt)}).catch(rt=>bs(rt,8)?rt:Promise.reject(rt))}function xn(Le,dt,tt){for(const wt of o.list())wt(Le,dt,tt)}function yi(Le,dt,tt,wt,di){const li=vt(Le,dt);if(li)return li;const Ot=dt===vs,rt=Cl?history.state:{};tt&&(wt||Ot?T.replace(Le.fullPath,Ii({scroll:Ot&&rt&&rt.scroll},di)):T.push(Le.fullPath,di)),U.value=Le,Un(Le,dt,tt,Ot),Ui()}let dn;function Mn(){dn=T.listen((Le,dt,tt)=>{const wt=ke(Le),di=At(wt);if(di){Ci(Ii(di,{replace:!0}),wt).catch(xu);return}oe=wt;const li=U.value;Cl&&fw(My(li.fullPath,tt.delta),jd()),zi(wt,li).catch(Ot=>bs(Ot,12)?Ot:bs(Ot,2)?(Ci(Ot.to,wt).then(rt=>{bs(rt,20)&&!tt.delta&&tt.type===zu.pop&&T.go(-1,!1)}).catch(xu),Promise.reject()):(tt.delta&&T.go(-tt.delta,!1),hi(Ot,wt,li))).then(Ot=>{Ot=Ot||yi(wt,li,!1),Ot&&(tt.delta?T.go(-tt.delta,!1):tt.type===zu.pop&&bs(Ot,20)&&T.go(-1,!1)),xn(wt,li,Ot)}).catch(xu)})}let er=cu(),tr=cu(),Ti;function hi(Le,dt,tt){Ui(Le);const wt=tr.list();return wt.length?wt.forEach(di=>di(Le,dt,tt)):console.error(Le),Promise.reject(Le)}function Kt(){return Ti&&U.value!==vs?Promise.resolve():new Promise((Le,dt)=>{er.add([Le,dt])})}function Ui(Le){return Ti||(Ti=!Le,Mn(),er.list().forEach(([dt,tt])=>Le?tt(Le):dt()),er.reset()),Le}function Un(Le,dt,tt,wt){const{scrollBehavior:di}=c;if(!Cl||!di)return Promise.resolve();const li=!tt&&mw(My(Le.fullPath,0))||(wt||!tt)&&history.state&&history.state.scroll||null;return N1().then(()=>di(Le,dt,li)).then(Ot=>Ot&&pw(Ot)).catch(Ot=>hi(Ot,Le,dt))}const Vi=Le=>T.go(Le);let pn;const Gt=new Set;return{currentRoute:U,addRoute:me,removeRoute:Ye,hasRoute:Fe,getRoutes:ft,resolve:ke,options:c,push:Dt,replace:Ut,go:Vi,back:()=>Vi(-1),forward:()=>Vi(1),beforeEach:I.add,beforeResolve:D.add,afterEach:o.add,onError:tr.add,isReady:Kt,install(Le){const dt=this;Le.component("RouterLink",$w),Le.component("RouterView",i5),Le.config.globalProperties.$router=dt,Object.defineProperty(Le.config.globalProperties,"$route",{enumerable:!0,get:()=>mu(U)}),Cl&&!pn&&U.value===vs&&(pn=!0,Dt(T.location).catch(di=>{}));const tt={};for(const di in vs)tt[di]=oo(()=>U.value[di]);Le.provide(Im,dt),Le.provide(_0,Vl(tt)),Le.provide(Hf,U);const wt=Le.unmount;Gt.add(Le),Le.unmount=function(){Gt.delete(Le),Gt.size<1&&(oe=vs,dn&&dn(),U.value=vs,pn=!1,Ti=!1),wt()}}}}function wl(c){return c.reduce((p,y)=>p.then(()=>y()),Promise.resolve())}function r5(c,p){const y=[],b=[],T=[],I=Math.max(p.matched.length,c.matched.length);for(let D=0;D<I;D++){const o=p.matched[D];o&&(c.matched.find(oe=>Rl(oe,o))?b.push(o):y.push(o));const U=c.matched[D];U&&(p.matched.find(oe=>Rl(oe,U))||T.push(U))}return[y,b,T]}var o5="/assets/Group338.cc02c2c4.png",s5="/assets/Group406.5765f38c.png",a5="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD4AAAAoCAYAAACmTknCAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAm8SURBVHgB7VlpbFTXFT5v5r1ZbOOFpRhsaqAsZYvAqVD5UQKhPyo2qaWFAiJiqRCCH9QIVbgNDUGt3MQhtA1Bqdo/LUJggaKKVG1ToFQVSzFF4EBALF4Ag42Nd2zPjGfp992ZO31jYTMGBpo0R7q67725b+75znbPOU/kC/r/IkP+x2jHjh0jHzx4MLOpqcnV09NjhcNhy+VyWT6fr9Hv97dnZGTcXbNmTc38+fP98hT0woGvW7euIBQKrQbAWcFgsDASjgwLhUOCe4lEIoLf1Mx7PXCPKfwvjD/j939UV1efr6mp8Q1k3xcCfOPGjRnQ3mYw/n2AmKoBESQ0q2YOw4iy53A44td6HazBLgg/5jIIrvT06dOXk+HhuQJfu3btIJjtCjD5JsZwMg0BSEtLi3R1dQkYVyBN0xSsE8uy1HA6nUrrWgB6DgQC6j0OCoP/h7Uf4t3Xjx07drU/Xp4b8O3bt09pb239oy/QMw6WKt3d3XL37l3p6OhQQLKysiQ7O1sGDRokaWlp4na7FWgKgcC5hkSAFBDBPnz4UIGlABATpL29XVvAPaz/0alTp/bLiwReXFz8jc7Ozo/AcBYZr6urkzt37iitDhs2THJzc+Mg+Yz3FAKvKQRqm6atAVNoWhi8bmxsVEKgEG/duqXWxlxlW3l5+VvyIoBv3rx5OKbzYDqPAAj43r17MnLkSMnJyRGv1yv5+XkycfxEKRg9WnIG58TN227WnPXQGqbFNDQ0qLhAl9H3169fV2sYASGAhRcuXPhLb75MSTGB6d9g/zwyf//+faWdcePGSXpaurz88gyZMmWyDBk8FNoGWNMZB9wXUXi0hLy8PAgsX2mW/3np0iXBUacshXT5sopxkJPjg5kzZxZC8032/3FKCmnr1q1jwNj7uDTI4M2bN2XUqFEyfvx4WbRwAeaoAJxOSxw03Zg/E3iyg+7B+DBx4kT1Lt2Bz+rr65UbQFBZEPwduFe5nbeUahybzsCkolJra6sMHTpUpk6dInPnvCIej0ccBv3UBGhHdBhP53mTJk1S7kOroDXQHUiwkGWY9tjXOiSF5DSMr3MmIxxfGTtW5r06F4y4FWCn04xq2ha1n5ZGjBghhYWFyrI0IWbk9l6XUuAeT1qAM02Sx9S8eXOVGZowbTMO2tGvTz8JjYWAeTJoGjx4sAuCT8CaUuAvTX/J1KDS09Phi9nidEQjtsOMgn5Wmu5NVVVV8evZs2dbmCz77ykFPnr0aHPIkCHqmsfLp59eQeQ2o6Adz17Tms6dOycnT55U19xn8eLFEVxG7GtSCtxyOn2zZs2Ka7Xik0+kqroqeh/DrDKtcCSecoZD0XvGBNHcGpK0kHiWl5aWqujOdzZs2MCjrxbXAfu6lAJ3eTxl1DjBMykhnThxQioqKiQY6JEef0ACGH4kIAGfH3M3Rldsjj4LwlKCPcF4ldYfXblyRbZs2aLyBRI0LStWrKAAKnuvTWnmBkaNixcvXsbGk5mtETTTSmp27JgxiL4zcPxkiRExFCcOdTbDBRyGigPxYVoqwWFANK3ERIczi5x9+/YJChPlUrQolLuybNkyxQcC6tdwpJ1/bsBJ0G4hGDwNjbupsbNnz8qZM2cUeDKYjwxsAjK5/LyRCWkpx3+BRwGbsWrNMl2UklRWVsrRo0eVT2uBTpgwQTZt2iSTJ0/WLPwa+f7m3nylHDjSyQUoID5AtZXPo4yM0w+PHz8uN27cUMWFPudx7CB9zZFMHH08ATJwElAA+BXFSbd0POyQZmj39u3byPlrdT6uKjkmL0uWLJHp06fHYwqEdhWangPBN0gqgS9fvnwoNhm7f//+c+iIDMf1bgD6LgCb1JwGzmsWE6jYpLa2Vq5du6aEwLJSBznddemjA6OOR4KdNm2aiiHMCm3EYPAeCqDt4KH9Ubw+E+Dr16+3UHUVITf+KaJpOja7jVI0C8VIlh2svubc3Nysykd79cWSU5eYbW1tauYaEvNxJkGZmZkqQWHQ7CPSV+D/fwBN/7s/np8KOIPXokWLFkIr78LsxukmAWeCKykpUeVnb+BkuPF+gzrPdbFh9237fX+/9SJKaC9K1DfgMm2P4/2Jga9evXo8oukuaGQhwBq6T6aBc9AU0TWNd1E4R/C8GVpV3RJYpOX2QpMZ4kXD4VGA+wMe5j7Yj5btslx19Y2NOCzGJNV0HHB1BsDZMMk3YYob4W9mf2crz1UGsoKCAqFVhhGMOhl9wbATjPf4fQhYnWoNjyg2JRio9GDdrS0imtyEVOLBd7mvidnj9Ygb71mmmYtE5av4+WIyOJIGDs25UE+/Bj8uBRPZj0smSNQ6wLeh7v6nxzQX+ZGQ0NRpFQSlgpcKWBHxoYPSFujbQl04x71ul3ggEC9KWpa1Joai6KlgGJHItyRJ4Ellbkj7XkXSXw4gv8VttiRJ1NShQ4e2DR+eu9hpmT8maBeY1xoliDSPV9K9bslIg7YhDFXA2BoN1K7bwjsunuEmNatcJm7+THiMuAsEk+WtX41Dy7noXPwK/azvUaIyQILp9sAlPuZ1RmZ2SXtrU6PbcO+FSCztq84YEJcVEA9S0yD9llaATqxaA1Cm06GyNgKHL8fbzlY8i2MjwzzpqDX3JMvbI4Hv3r07G0nCOoB+HVpOWsN2Qj18FsnET3bu3Fmtn2VmD/ldR0er5XA495JZzTzNXndRdWBUSY3E0lhkaSpdjQlJv2O58T5mZHQtkOJqY4yR9NeUBC1Sq0VFRUtwNL0D/yvQn3B0tObQSYVm0s4sB9LDCkTzt3bt2nWgr0272tu/HY5E3g8G/CMIuIeajrWE7QmMJnsKq8GbrpjQ3O46dHKKXV7v72UAlAAclc1CJA0fMXFgu5ZJAzdMBjjW1aPf9Q40vAfNxMd+0AOwL/t8na+EAsEFbAEjYqeHYv/P0pSmHmdSH2EJhYvZjOLll75A4D3s2yoDpARTR6ScT9AkAmI6yQSkv1qYv+G9t1EJ/WLlypUtBw4cSGpjZneY9nEgWxvk9abNsiKh14xQZA6MPA8WAVcP+wC4G7v78IIPJo9702cYzo89aZ538R/N8oSUABwmlCA5apJtWjbw7EQzxKZhmNpR9LGLUBJePXLkiDwp4WtKB6a/ccSCKFzbCEkKKQE4Eo2/o4gvtj9juccCoJfWKxFcflhWVvYnecaEfejcKQVNSgCOIuAEAH2Iy+/oZ/qTLKMozK4LGik5fPjwz2MMfmYpIYFZunRpCFXPG7issT+Hr3UA9NsoI/MOHjz4s886aNIjo9aqVau+hKj+B3z9+Caqnb/CBbbBj5P64P65IPTIMuQL+nzRfwAvmzxCxnCF2AAAAABJRU5ErkJggg==",Fy="/assets/farxod.833046d4.png";var fr=(c,p)=>{const y=c.__vccOpts||c;for(const[b,T]of p)y[b]=T;return y};const l5={},c5={class:"homeIntroImg"},u5=Ta('<div class="blueBlock1" data-v-2c206913></div><div class="blueBlock2" data-v-2c206913></div><img class="introMan" src="'+o5+'" alt="You are welcome" data-v-2c206913><img class="progress" src="'+s5+'" alt="You are welcome" data-v-2c206913><img class="lupa" src="'+a5+'" alt="You are welcome" data-v-2c206913><div class="smallCard" data-v-2c206913><img src="'+Fy+'" alt="\u0424\u0430\u0440\u0445\u043E\u0434 \u0418\u0441\u0440\u043E\u0438\u043B\u043E\u0432" data-v-2c206913><div data-v-2c206913><p class="smallCardName" data-v-2c206913>\u0424\u0430\u0440\u0445\u043E\u0434 \u0418\u0441\u0440\u043E\u0438\u043B\u043E\u0432</p><p data-v-2c206913>\u041D\u0430\u043B\u043E\u0433\u043E\u0432\u044B\u0439 \u043A\u043E\u043D\u0441\u0443\u043B\u044C\u0442\u0430\u043D\u0442</p></div></div><div class="smallCard secondSmallCard" data-v-2c206913><img src="'+Fy+'" alt="\u0424\u0430\u0440\u0445\u043E\u0434 \u0418\u0441\u0440\u043E\u0438\u043B\u043E\u0432" data-v-2c206913><div data-v-2c206913><p class="smallCardName" data-v-2c206913>OOO \u201C\u041C\u0415\u0427\u0422\u0410\u201D</p><p data-v-2c206913>\u041C\u043D\u0435 \u043D\u0443\u0436\u043D\u0430 \u0432\u0430\u0448\u0430 \u043F\u043E\u043C\u043E\u0449\u044C</p></div></div>',7),h5=[u5];function d5(c,p,y,b,T,I){return dr(),pr("div",c5,h5)}var p5=fr(l5,[["render",d5],["__scopeId","data-v-2c206913"]]);const f5={components:{HomeIntroImg:p5}},m5=c=>(Du("data-v-cbb81250"),c=c(),Pu(),c),_5={class:"home-intro"},g5=m5(()=>zt("div",{class:"home-intro-text"},[zt("h1",null,[uo(" \u041D\u0430\u0434\u0435\u0436\u043D\u0430\u044F "),zt("span",{class:"yellow"},"\u0411\u0423\u0425\u0413\u0410\u041B\u0422\u0415\u0420\u0418\u042F"),uo(" \u0434\u043B\u044F "),zt("span",{class:"yellow"},"\u0412\u0410\u0428\u0415\u0413\u041E \u0411\u0418\u0417\u041D\u0415\u0421\u0410")]),zt("p",null," \u0412\u044B \u0437\u0430\u043D\u0438\u043C\u0430\u0435\u0442\u0435\u0441\u044C \u0431\u0438\u0437\u043D\u0435\u0441\u043E\u043C, \u043C\u044B \u0437\u0430\u043D\u0438\u043C\u0430\u0435\u043C\u0441\u044F \u0412\u0430\u0448\u0435\u0439 \u0431\u0443\u0445\u0433\u0430\u043B\u0442\u0435\u0440\u0438\u0435\u0439. \u0412\u0430\u0448\u0430 \u043B\u0438\u0447\u043D\u0430\u044F \u043A\u043E\u043C\u0430\u043D\u0434\u0430 \u043F\u0440\u043E\u0444\u0435\u0441\u0441\u0438\u043E\u043D\u0430\u043B\u044C\u043D\u044B\u0445 \u0431\u0443\u0445\u0433\u0430\u043B\u0442\u0435\u0440\u043E\u0432, \u043A\u043E\u0442\u043E\u0440\u0430\u044F \u0432\u0441\u0435\u0433\u0434\u0430 \u043F\u043E\u0434 \u0440\u0443\u043A\u043E\u0439. "),zt("a",{href:""},[zt("button",null,"\u041E\u0441\u0442\u0430\u0432\u0438\u0442\u044C \u0437\u0430\u044F\u0432\u043A\u0443")])],-1));function y5(c,p,y,b,T,I){const D=cr("HomeIntroImg");return dr(),pr("div",_5,[g5,gi(D)])}var x5=fr(f5,[["render",y5],["__scopeId","data-v-cbb81250"]]);const v5={props:["title","description","imageUrl"]},b5={class:"serviceCard"},A5=["src"];function w5(c,p,y,b,T,I){return dr(),pr("div",b5,[zt("h3",null,Qg(y.title),1),zt("p",null,Qg(y.description),1),zt("img",{src:y.imageUrl,alt:"Service"},null,8,A5)])}var T5=fr(v5,[["render",w5],["__scopeId","data-v-41bcbe6e"]]),E5="/assets/calc.b9b52796.png",C5="/assets/stamp.ec76809c.png",M5="/assets/files.866f037e.png",S5="/assets/taxy.91c24906.png",I5="/assets/scessor.51d1368c.png";window.addEventListener("scroll",()=>{const c=document.getElementById("groupOne"),p=document.getElementById("groupTwo");window.scrollY>260&&c.classList.add("cardGroupOne"),window.scrollY>530&&p.classList.add("cardGroupOne")});const z5={components:{ServiceCard:T5},data(){return{card1:{title:"\u0411\u0443\u0445\u0433\u0430\u043B\u0442\u0435\u0440\u0441\u043A\u043E\u0435 \u0441\u043E\u043F\u0440\u043E\u0432\u043E\u0436\u0434\u0435\u043D\u0438\u0435 \u0432 \u0423\u0437\u0431\u0435\u043A\u0438\u0441\u0442\u0430\u043D\u0435",description:"\u0411\u0435\u0440\u0451\u043C \u043D\u0430 \u0441\u0435\u0431\u044F \u0432\u0441\u044E \u0431\u0443\u0433\u0430\u043B\u0442\u0435\u0440\u0438\u044E! \u0412\u0435\u0434\u0435\u043C \u043D\u0430\u043B\u043E\u0433\u043E\u0432\u044B\u0439 \u0443\u0447\u0435\u0442 \u0438 \u0433\u043E\u0442\u043E\u0432\u0438\u043C \u0441\u0447\u0435\u0442\u0430 \u043A \u043E\u043F\u043B\u0430\u0442\u0435 \u0432\u043E\u0432\u0440\u0435\u043C\u044F \u0438 \u0431\u0435\u0437 \u0437\u0430\u0434\u0435\u0440\u0436\u0435\u043A.",path:E5},card2:{title:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044F \u043A\u043E\u043C\u043F\u0430\u043D\u0438\u0438 \u0432 \u0420\u0435\u0441\u043F\u0443\u0431\u043B\u0438\u043A\u0435 \u0423\u0437\u0431\u0435\u043A\u0438\u0441\u0442\u0430\u043D",description:"\u041F\u043E\u0434\u0433\u043E\u0442\u043E\u0432\u0438\u043C \u043E\u0442\u0447\u0435\u0442\u043D\u043E\u0441\u0442\u044C \u0438 \u043E\u043F\u043E\u0432\u0435\u0441\u0442\u0438\u043C \u0432\u0430\u0441 o \u0441\u0440\u043E\u043A\u0430\u0445. \u0412\u0430\u043C \u043E\u0441\u0442\u0430\u0435\u0442\u0441\u044F \u0442\u043E\u043B\u044C\u043A\u043E \u043F\u043E\u0434\u043F\u0438\u0441\u0430\u0442\u044C \u043E\u0442\u0447\u0451\u0442\u044B.",path:C5},card3:{title:"\u0412\u043E\u0441\u0441\u0442\u0430\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u0435 \u0431\u0443\u0445\u0433\u0430\u043B\u0442\u0435\u0440\u0441\u043A\u043E\u0433\u043E \u0443\u0447\u0435\u0442\u0430 \u0432 \u0423\u0437\u0431\u0435\u043A\u0438\u0441\u0442\u0430\u043D\u0435",description:"\u041F\u043E\u0434\u0433\u043E\u0442\u043E\u0432\u043A\u0430 \u0434\u043E\u043A\u0443\u043C\u0435\u043D\u0442\u043E\u0432 \u0438 \u043F\u043B\u0430\u0442\u0435\u0436\u0438 \u043A\u043E\u043D\u0442\u0440\u0430\u0433\u0435\u043D\u0442\u0430\u043C",path:M5},card4:{title:"\u041F\u0435\u0440\u0435\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044F (\u0418\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u0435)",description:"\u041A\u043E\u043D\u0442\u0440\u043E\u043B\u044C \u0438 \u0443\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u0435 \u0432\u0441\u0435\u043C\u0438 \u0441\u0447\u0435\u0442\u0430\u043C\u0438",path:S5},card5:{title:"\u041B\u0438\u043A\u0432\u0438\u0434\u0430\u0446\u0438\u044F \u043F\u0440\u0435\u0434\u043F\u0440\u0438\u044F\u0442\u0438\u044F \u0432 \u0423\u0437\u0431\u0435\u043A\u0438\u0441\u0442\u0430\u043D\u0435",description:"\u041D\u0430\u0448\u0438 \u0441\u043F\u0435\u0446\u0438\u0430\u043B\u0438\u0441\u0442\u044B \u0432\u0441\u0435\u0433\u0434\u0430 \u0433\u043E\u0442\u043E\u0432\u044B\u043E\u0442\u0432\u0435\u0442\u0438\u0442\u044C \u043D\u0430 \u0432\u043E\u0437\u043D\u0438\u043A\u0448\u0438\u0435 y \u0432\u0430\u0441 \u0432\u043E\u043F\u0440\u043E\u0441\u044B \u0432 \u0447\u0430\u0442\u0435 \u0438\u043B\u0438 \u043B\u044E\u0431\u043E\u043C \u043C\u0435\u0441\u0441\u0435\u043D\u043D\u0434\u0436\u0435\u0440\u0435",path:I5}}}},M0=c=>(Du("data-v-392a673b"),c=c(),Pu(),c),k5={class:"homeService"},D5=M0(()=>zt("h1",null,"\u041D\u0410\u0428\u0418 \u0423\u0421\u041B\u0423\u0413\u0418",-1)),P5={class:"cards",id:"groupOne"},B5={class:"cards",id:"groupTwo"},L5=M0(()=>zt("a",{href:""},[zt("button",null,"\u041E\u0441\u0442\u0430\u0432\u0438\u0442\u044C \u0437\u0430\u044F\u0432\u043A\u0443")],-1));function R5(c,p,y,b,T,I){const D=cr("ServiceCard");return dr(),pr("div",k5,[D5,zt("div",P5,[gi(D,{class:"cardGroupOne",title:T.card1.title,description:T.card1.description,imageUrl:T.card1.path},null,8,["title","description","imageUrl"]),gi(D,{class:"cardGroupOne",title:T.card2.title,description:T.card2.description,imageUrl:T.card2.path},null,8,["title","description","imageUrl"])]),zt("div",B5,[gi(D,{title:T.card3.title,description:T.card3.description,imageUrl:T.card3.path},null,8,["title","description","imageUrl"]),gi(D,{title:T.card4.title,description:T.card4.description,imageUrl:T.card4.path},null,8,["title","description","imageUrl"]),gi(D,{title:T.card5.title,description:T.card5.description,imageUrl:T.card5.path},null,8,["title","description","imageUrl"])]),L5])}var O5=fr(z5,[["render",R5],["__scopeId","data-v-392a673b"]]),F5="/assets/aboutImg.a4f61460.png";const N5={},km=c=>(Du("data-v-501c86bd"),c=c(),Pu(),c),U5={class:"home-about-img"},V5=km(()=>zt("div",{class:"corner-block"},null,-1)),j5=km(()=>zt("img",{src:F5,alt:""},null,-1)),G5=km(()=>zt("div",{class:"corner-block2"},null,-1)),Z5=[V5,j5,G5];function q5(c,p,y,b,T,I){return dr(),pr("div",U5,Z5)}var W5=fr(N5,[["render",q5],["__scopeId","data-v-501c86bd"]]);const H5={components:{HomeAboutImg:W5}},S0=c=>(Du("data-v-8bf9bb16"),c=c(),Pu(),c),Y5={class:"home-about"},X5=S0(()=>zt("h1",null,"\u041E \u043A\u043E\u043C\u043F\u0430\u043D\u0438\u0438",-1)),Q5={class:"details"},K5=Ta('<p class="about-text" data-v-8bf9bb16>\u041A\u043E\u043C\u043F\u0430\u043D\u0438\u044F \u201CGrossProfit\u201D \u0431\u044B\u043B\u0430 \u0441\u043E\u0437\u0434\u0430\u043D\u0430 \u0432 2008 \u0433\u043E\u0434\u0443. \u0412 \u043D\u0430\u0448\u0435\u0439 \u043A\u043E\u043C\u0430\u043D\u0434\u0435 \u0441\u043E\u0431\u0440\u0430\u043D\u044B \u0441\u043F\u0435\u0441\u0446\u0438\u0430\u043B\u0438\u0441\u0442\u044B \u0438\u0437 \u0440\u0430\u0437\u043D\u044B\u0445 \u043E\u0431\u043B\u0430\u0441\u0442\u0435\u0439 \u0438\u043C\u0435\u044E\u0449\u0438\u0435 \u043E\u043F\u044B\u0442 \u0440\u0430\u0431\u043E\u0442\u044B \u0431\u043E\u043B\u0435\u0435 <b data-v-8bf9bb16>17 \u043B\u0435\u0442.</b><br data-v-8bf9bb16><br data-v-8bf9bb16> \u201CGrossProfit\u201D \u0435\u0434\u0438\u043D\u0441\u0442\u0432\u0435\u043D\u043D\u0430\u044F \u0432 \u0422\u0430\u0448\u043A\u0435\u043D\u0442\u0435 \u043A\u043E\u043C\u043F\u0430\u043D\u0438\u044F \u0434\u0435\u043B\u0430\u044E\u0449\u0430\u044F \u0441\u043F\u0435\u0446\u0438\u0444\u0438\u0447\u0435\u0441\u043A\u0438\u0435 \u043B\u0438\u0446\u0435\u043D\u0437\u0438. \u0417\u0430 \u043D\u0430\u0448\u0435\u0439 \u043F\u043E\u043C\u043E\u0449\u044C\u044E \u043E\u0431\u0440\u0430\u0449\u0430\u044E\u0442\u0441\u044F \u0441\u043E\u0431\u0441\u0442\u0432\u0435\u043D\u043D\u0438\u043A\u0438 \u0431\u0438\u0437\u043D\u0435\u0441\u0430 \u0438\u0437 <b data-v-8bf9bb16>\u0432\u0441\u0435\u0445 \u0433\u043E\u0440\u043E\u0434\u043E\u0432 \u0423\u0437\u0431\u0435\u043A\u0438\u0441\u0442\u0430\u043D\u0430.</b><br data-v-8bf9bb16><br data-v-8bf9bb16> \u041C\u044B \u0441\u0435\u043A\u043E\u043D\u043E\u043C\u0438\u043B\u0438 \u0432\u0440\u0435\u043C\u044F \u0438 \u0434\u0435\u043D\u044C\u0433\u0438 \u0431\u043E\u043B\u0435\u0435 \u0447\u0435\u043C <b data-v-8bf9bb16>2000</b> \u043D\u0430\u0448\u0438\u0445 \u043A\u043B\u0438\u0435\u043D\u0442\u043E\u0432. </p><div class="years-cards" data-v-8bf9bb16><div class="years-card" data-v-8bf9bb16><div class="text" data-v-8bf9bb16><h2 data-v-8bf9bb16>17</h2><p data-v-8bf9bb16>\u043B\u0435\u0442 \u043D\u0430 \u0440\u044B\u043D\u043A\u0435 \u0423\u0437\u0431\u0435\u043A\u0438\u0441\u0442\u0430\u043D\u0430</p></div><div class="corner" data-v-8bf9bb16></div></div><div class="years-card" data-v-8bf9bb16><div class="text" data-v-8bf9bb16><h2 data-v-8bf9bb16>12</h2><p data-v-8bf9bb16>\u0434\u043E\u0432\u043E\u043B\u043D\u0438\u0445 \u043A\u043B\u0438\u0435\u043D\u0442\u043E\u0432</p></div><div class="corner" data-v-8bf9bb16></div></div><div class="years-card" data-v-8bf9bb16><div class="text" data-v-8bf9bb16><h2 data-v-8bf9bb16>3</h2><p data-v-8bf9bb16>\u043A\u0432\u0430\u043B\u0438\u0444\u0438\u0446\u0438\u0440\u043E\u0432\u0430\u043D\u043D\u044B\u0445 \u0441\u043F\u0435\u0446\u0438\u0430\u043B\u0438\u0441\u0442\u043E\u0432</p></div><div class="corner" data-v-8bf9bb16></div></div></div>',2),$5=S0(()=>zt("a",{href:""},[zt("button",null,"\u041F\u043E\u0434\u0440\u043E\u0431\u043D\u0435\u0435")],-1));function J5(c,p,y,b,T,I){const D=cr("HomeAboutImg");return dr(),pr("div",Y5,[X5,zt("div",Q5,[gi(D),K5]),$5])}var e3=fr(H5,[["render",J5],["__scopeId","data-v-8bf9bb16"]]);const t3={},i3={class:"home-stake-holders"},n3=Ta('<div class="stake-holders-text" data-v-3d3c7e39><h1 data-v-3d3c7e39>\u041F\u043E\u0447\u0435\u043C\u0443 \u043D\u0443\u0436\u043D\u043E \u0432\u044B\u0431\u0440\u0430\u0442\u044C <br data-v-3d3c7e39>\u0438\u043C\u0435\u043D\u043D\u043E\u043D\u0430\u0441?</h1><h3 data-v-3d3c7e39>\u041C\u044B \u043F\u043E\u043C\u043E\u0436\u0435\u043C \u0441\u043E\u043A\u0440\u0430\u0442\u0438\u0442\u044C <span class="yellow" data-v-3d3c7e39>\u0440\u0430\u0441\u0445\u043E\u0434\u044B \u043D\u0430 15%</span></h3><p data-v-3d3c7e39>\u041E\u0431\u0440\u0430\u0442\u0438\u0442\u0435\u0441\u044C \u043A \u043D\u0430\u043C \u0438 \u0443\u0432\u0435\u043B\u0438\u0447\u044C\u0442\u0435 \u043C\u0430\u0442\u0435\u0440\u0438\u0430\u043B\u044C\u043D\u0443\u044E \u0432\u044B\u0433\u043E\u0434\u0443, \u0442\u0430\u043A \u043A\u0430\u043A \u0431\u0438\u0437\u043D\u0435\u0441 \u0441\u0442\u0430\u043D\u0435\u0442 \u0431\u043E\u043B\u0435\u0435 \u043F\u0440\u043E\u0437\u0440\u0430\u0447\u043D\u044B\u043C</p><div class="smallCards" data-v-3d3c7e39><div class="smallCard" data-v-3d3c7e39><p data-v-3d3c7e39>\u0421\u043E\u043A\u0440\u0430\u0442\u0438\u043C \u0432\u0430\u0448\u0438 \u0440\u0430\u0441\u0445\u043E\u0434\u044B</p><h4 data-v-3d3c7e39>1</h4></div><div class="smallCard" data-v-3d3c7e39><p data-v-3d3c7e39>\u041E\u043A\u0430\u0436\u0435\u043C \u043A\u0430\u0447\u0435\u0441\u0442\u0432\u0435\u043D\u043D\u0443\u044E \u043F\u043E\u0434\u0434\u0435\u0440\u0436\u043A\u0443</p><h4 data-v-3d3c7e39>2</h4></div><div class="smallCard" data-v-3d3c7e39><p data-v-3d3c7e39>\u0412\u043E\u0432\u0435\u0440\u0435\u043C\u044F \u0441\u0434\u0430\u0434\u0438\u043C \u0432\u0441\u044E \u043E\u0442\u0447\u0435\u0442\u043D\u043E\u0441\u0442\u044C</p><h4 data-v-3d3c7e39>3</h4></div></div></div><div class="stakeHolders" data-v-3d3c7e39><h1 data-v-3d3c7e39>\u041D\u0430\u043C \u0434\u043E\u0432\u0435\u0440\u044F\u0435\u0442 </h1><h6 data-v-3d3c7e39>Logolo</h6><h6 data-v-3d3c7e39>Logolo</h6><h6 data-v-3d3c7e39>Logolo</h6></div>',2),r3=[n3];function o3(c,p,y,b,T,I){return dr(),pr("div",i3,r3)}var s3=fr(t3,[["render",o3],["__scopeId","data-v-3d3c7e39"]]),a3="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADkAAAA4CAYAAABHRFAgAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAaDSURBVHgBzVq9c9xEFH97MeNAzIxSgN2x6eg4U6WL0jndpaOzjvwBsUsqnzs67H8glstUJB1UVrpQ5dJB5XVnoDlmAmMobnlPu/JJq11p9eHz/WZysXS7e/vT+9j3IQY1CHgU3IXBcwlyxACG+naC/+JLcXIKK4gt/mwXQIaX4sWYrln14IjjkDP8kzuGCFzs8aWIBawIFMF5rK5YTESZe3AtwRQSYIaL7K2CVIsEM7D4jn2wH8F0CYC7+N9oI/gaPszevYFbgp0gQR4PyoPtBNEmj69A3se/HoCySXOxyRYf78ItoILgGE0pZsXBLgnKQxw8McbiNTuwLEw2moDX5qIQYJB7MDJpqvZ1BOkvQ5LsBDwIEugeSne/tDSwH9XD8gKOk1HuXwgN4EOQMFhMiCL8LzQGWwlm+F3ER7Rg/h6qRkDa0IBoK/gSJOQkaaqejKsIZlALFolCKiF2Rmcs3ACaECSkJD/n0QjKnvQQPKGJmuM5ut096BlNCRIG6oONjAlx0wNeSz0prALsOfSINgQJmbp+AcXNvYJWkGMKDrIrss++bLMtQUJKUi5i0hRzkBfQAiR9liPZF7oQJKQklUdc4E8RT6EFNvkzUk+ev9c1ru1KkDCAnvAZj1Ab5pPiXRlDB/RBkNALSYpc0HmdmRoBDTx0ec1+CBIykqL4A/7OQh0/NoJpICGgBfokSMgcj+ksuMfc9GEwFQqamzn0CSTsa/ZLkKAdj3xfWM7wtm6wiSlBimfbEsT1wr4JEjJJFrwpbvyruolapY3USh6qeLY1ePlWN4KElOS8HKmMPOby4iWlSW0l6EJ3goQ1+qBzcZOPZ5nq6UglrMoL8cEERddcWS5qA4EyeLTFv33kP8Wej67lBuCXi1gTVZikmbiWGxgqjgg3ebTXUV3z4CrHbAJJHyWS18JAORjxKtutSpX08ZAYcw5UULBauCZJqpl3QKSydakSxrjH+Wuac6dZZWApWMtf4FHyGj9zkmDkPSeuyX+I+BUSOjQSbq4rAz712MSScHeBsN0seAtSz3Vg58bZF9UVl2xFLdKKf7GoNRNx71lJUxTqrlez6dWnwfBjdShfY7gWDE/pO9ciH2bTZCMYsvw8vNhC1d35KBi+rJq7DJQCdNzNkRHmeZUx1BlZLIFQ72T9Bms9vihV0G3SxOBgiPdeosQqVW9VJWpNtUxp6jLjCXhgFSVq7YXQE78XDH/DDOOb3G2O9/76ezZ9CzWokihqxM91GtE3alp3Y2oZhNm16mDJbd880dFKEG3bfapXqjx/k/m1/Um0x3fGkSKw8bPtezT0QVT3aMhcwuIaLMGQpDY5ryx/0GRpqY6vw8DLPvUaE1vh2beVoIpj7BxKLYwstq1f5w7UAG3wV7TF+2ifD7N7KNkvm/QjbTYKyplhX3P42mWjmIEcoHl8D9WoXaeWJAGJ/nQv2KZ3BrZyt0NfR0RoSpQkaCcoBc4xvXSAZhWhU/sF1xHmDO9qHf7gUzBiQ5TuD00ar76qqyQ4L6Rs6khL7fiBagTL0+JeVDeN0j0o7b0BKI1ylB6jJs1TdwMXKBMKmFFjIoKY8Tw2i96udajOlM9rvdQ1wz+z6SWpBC4cGZsIXapig0N1CdwwiRSoRU8w43lrW4dMBjVqpzie7WwE2wK/Twt0jUjqhQVu8AJydSD1cgSL8gt7rOMieg19Lj+pKsOQTzD3o+eGn2DgQYJpTFJvcOrY4KiFM7rQOaxZnE7wB4hgbV9G76f04NG0diiD6lR9ctsWm1yKF4fQAGTv+MQDKpD9h7bZJg9Fp3PEjJ4o2WcnknrhPfKy5n3qcaKH3F/221pmKIpIOjd8yIuh53tqthrQlkawhBckyigeUdQN6KWrRbUecvFQrrFwCsno3IMl4arcDQh660+qM8xKFPTbWufLkCq90Vn4ZSTd2SZtsDmAxY8y/G5+fBO2qjRGToq/J/dbHSF1oFjXdTTgU32o4tXtme+Z6gMbQQS9w/DdjUhy8cOpek50/dYGob6Xb7pI1kUwy1lvlORiE/RKW3qecvcoFmMCfOr78qFel1uSaYLIJ+VLIbnYEESOwPwa6ihKM36KeEidRV7KtA4GDBhupdHWriVZEGbVYWkkM3iocBcIW1ll6SQzqPoRjLQX5tAZMsGPsc22b41kHurl3lSVqeHKG0zNkunKNv5KkMyDCEv1zkKo7Y3jNvliBJU/AAts8J56qj6O6n/sSXLF3EZLYQAAAABJRU5ErkJggg==",Cf="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAmCAYAAADAzmuWAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAD1SURBVHgBtdY7DoMwDAZgB68dGBk5QtUTcJSqF2l6kx6lPUF7hI4dGZhJCYKKRwA7Nr8UybGlT1GWBKBLll+ufoFSsEcBnG3K4pCeoCpfTxAGB2gfFTwBqM287az0WrAq349DemxwU0xmopO3d7wHjn2hjeNwo4njtKGFY6ipgePSQIrj2lCCr8ISfBOOxUlwDE6GuTgL5uBsmIpHwRQ8AVESF+7XxkBkAi9PF3f7fu42Ct5CfcWGKSgbpqIsmIOSYS5KgmPQTTgWXYUl6CIsRYOwBjqDtdARrIn+YW20hfdAfZb+xyLUJ/A/lqOjZPnZ+gVK+QFBlQMh648PeAAAAABJRU5ErkJggg==",l3="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADoAAAA8CAYAAAA34qk1AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAX3SURBVHgBzVq9cttGEN6j5LEy9kyQIpG7nJ4glKuUdJcuUpnKpP0App5AYJmK0gtYUJV0oquUprp0Qrp0vnRy0jAzzow0GfO8iwNN/BzugOOB5DcD/gC4n73v9va7BRi0iID3gz3ovMKfXJ2Zj25FJGADYNASnvB+D6u/gM9Gfm4yvBWvR7BmeDeUWHwInVMGcmi4TQDIZ+tkdwc8gljcBfYbjt4PllsDHOPh4+ApfJjdXMMa4IVRO4sywqZ6UJrGCcQ62O3Aivia97t7wG4qjBSpEQP6xuNScw/HQXj3hL84hRaxEqOqczLUXZMgz+8BwpmIZvky/T42S0ZxTTHRFrtOhmJnuQR2hYW7mssCOzvAzk5N5fErxOaf6+/wvzI3NnSfv8S4OA9ZsqDkUcViFdbJbm1DFQtJXOyBvlNGFs31ts9uLUMtLE6QxUFdFqvQNrvM0jivYlECzNDIwd8imoAnKN+HIQP2Sn+HO7usutGXzyXMz3QsoplT/Bi0Ffuq5WMC4eImJUPT4H+BcfGoeI1YxM/RexGdQctQ/YCwil1c9c/ucZNQ12VyhppHsl0Wq+CL3cRQk4RbJ4tV8MEuU3tGdgOaEUMjYzT+eFN7yCJs7N6BPKwytrOnFhtNQWLx4nBbjCTQFCVjSJhoLvM97cKpUCXqBR5T2EIQY+hvFNJEk3K7Fec5TpG3+/xFo5WtbSwiAmgigg0dNTXlAWhGiBYn8l/aisGGQcrpIW7nmN5IYVNOxfASpjJMd+tGcj0WjQ20lqCBIVjANBX3LHFrbbkek8amuP4R4OQfEcV16tJKQFvcaptdm8Z2ies2Ud9bN7s2FsFRnVm3aetilxa8HWBj8MhiFk023r222DXlnnxp7EapFN/s0uChTh3rck++NbZrcqy3Cru2PLCvrEUWTpn6D7NYPA66b/DnV2hwkQ1jFt6SzRdo5jGy+PPdLL4Dj2Bp45wkHzjs+ermemqwaMwgUjvpNA+a9pHgRRnZMnm0X0ylG4eGndxKZWRht9xFC4sUUxnMh+nKe41KKP4f++Diu96VkT1Pm0DYWeycYnIuxoG49LEotaaMqtmVI1xlzky+iOXkrbi4BI9oVRkt87TwJf3HqXdeJcKVMqLXAMyP/1XqRy1IOGAzpyygCW0rI/TXo6r8VCos8Dr8WGyfhAWep8GLTLNg48ooHTzQDZR9xS1B4BHqDN64MlKMyMOykaYnBWYg+6is5jll5fTEW62Wbk+waZDyT8jlqGwklZ1HLkYSKGZj2uUtDejyHNRSRq6xU1iUkcBpdlCor5f2xQemWP8z+pFoXdSuMzzOUb+y9KWKLIzaFcvFNt37KHgaPMCQotG3Qyz/x+JPOuBX0JxJgQP6RtM+fxR0//1vFv++SWWkYdO0L63GR/RxClv7vE+PHMfZa7QG3GOWs+Sjtmy4yf+wbGTw3SwEKaPyadmHxpCjRWxWe1d5oPayCuTnGCn6W6OMXHyT9q1o3HH23De8f9RR0z+LqXE/SvvO3aB7iTd9gVPi+8LlWr6Lo8twNP/EUzEqI3pC/qtur4m+NNS0YYLAen+i9WVxgnwc6/gFyj7Ot0IZEfDxx5X+4bOc0AJZDDULv8zXMbhh+leC6sfRVXy3DtBIzYsgENPUJEEBuUcmS79cgNquMlLV7wAfyqjsowPyz15VPcsHTHOo6Zc5bEwZZVWLgvwr+28O8iQ7WDQw78XrY0qaFerjnUJI0cH5pUfqBB79NEyI8h0yRJbepRvxhBH0w/FCgT0o70LifMfYFcXFYq3FmSAVkxwMoHCz8tudltjJiV0ysPgG6E7Bn1jBUHWOjU1+b/PLZT1y4uSj1Q03UUYyUq+3ZsuX/FTdqXmXoo5fZsofeTWUsErOyNJ5KkN7XY4T+1u1Ua+liROp6d3QBdxzRnpW3SEPaCa0ZiihSc4oW8awZWyIZc63VUNd4cfYfGJ75VW3DaQvkNCGeQoNkb51elLM3m8lo1nUXcnT3BPqYtCmS7fe0AVUyjMJE9/hd5CuuCI9rnGBm5hyvJ8Ao3wUs/GYuwIAAAAASUVORK5CYII=",c3="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD0AAAA6CAYAAAADZ1FRAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAbISURBVHgBzVtNVtxGEK6WecGLvBe8SGDn5gQMJ7C8S1bACdA4BwBOwMwJgAsE+QQ2J7A4QSa77GjvcLKAvJcFJA91qtTSTKvVUuunhfO9B0Iaqaeqq/qrnxYMnglbPAolsH0GsCcBNvC4gcd7PC4kyI94vLoVsYBnAIORgcpy/JpL/DN03YuTcv4I6fxexPcwIkZV+gceoWXZJVm1w2MC1X87ptVHU/p7Hk1eAPsV+kGMqXgAI4BcGhX+UP1EJqTMA8hXt4IcQG7jzxQyJUvg+ZIYBaNYeotPYzwclq/KOVpu1vEZsnYCnuHd0hs8IlbeK19tVpiAlo/wkJSvslMYAd6V/gZZ2iAu4VJ4BTk3LoQ0ieAZ3pXGASflK7SO24FcGb1koV97WRlvOMYgMm6cX0MHMJC/OcYbjFHYewgkBN/ByBhDaaGfyM7uKXnTeD7gXenUWJPosIdtyYjiOzMm6aEy3nCsQb0AIc7JG1iuqfQz/kpccfMfvGddFRKZonRch4BCzwk4YSYkMnHl4TShRHaqmGHZ0pCQLpoKmEpy0qJAEK4UEceYVWMsm92KX+ZQK3hwhuNGxkcRxu/3UAN3bs/iB0hPzIkrKU35cgDsk6tAoJIwRcX/FPGiXoks7+bGRwk+d0HeQILQBFMig4IfV++VMU7stE6GLf4OJ1XOwA2Bae+urjhbDZJZ+BO0DBGqFpa7dRZXyyMbrw9Ekzfh2FHH3ByX5eXb4kQjMjaD6mwnqiDIfkpuprwhqE0Tae2jVQ9ocqAbhLvCKi8d+g5sRFyQnHg8hirjh8oIS9kVNvn0ruzW1XzZtlapYmoim9yFz9CF98EBEvwRYNY0Hq3jwKjgntDj9KWWLy+6J9RuW1o7yAVrlS/n14R+bR3YG2gAWeyLiA/IeuQtqNhipSR5QeZNc5o8vO/YxdasQrAyNrlFjVHO4/V8oSZkSQG1kJhWMr4SQr6CFshDXQIDYSHZ67rvw3LV+lxm6Sdj3WHMa2Bv9tq49w6eERaO4Lb7FDHbkSn9r+GylBXpC98YKCzfWykQxoYon9ZlfEGpIaFXb1rImlJ4CbWbKKs6xrV2ReeqxMvCBNcH+iIud+EZQQoij9yYHETMTS6tPg9OmWJxHctERwtZ5YWfDxojC969zFy4GsPxnnN4ZhBJsSw8lcBJPjScJFktCgvFRQovij/+vl+IbzcmqAcLoRWykHYBXwFrG5MFNh5/RGG3XPfm2eNPf4j49+KaLfeeuXpTGHZOMLy0tjJxAVZfmOI2preCKqq2jf680DinNd00JsbwAzOksToh8TDDWdrBpCKPb1Lg+RW5dJt+dF5EHFGG5MrldRBPqO+oLzQMWUM8RBhF9lZbRVkucI2TeG6bRAYjYJP/fISl6KyLshaIsRr+3psIVP0wSM8HKkzgaJMbJKdD8Ayvlq4r9zSXE7bnil1MG4m6ytg+8KZ0Xpre6NdyZS/q1pZ9DJhZyAlrgctt8ISK0gUBocghJel93XSIhdpEENd3M5WBxTZCZMaX0cb5Bw/rkRC1ZWAbNnmEvMCOYDiESYhLpW11al/QTGN62qr6qkNeE/sqZoSueFFPc1T4DDyBaTVzXxAHSH/tX663l/J62toqmncgoFgnHxTWS+WlKjg20WSioiJ2PadeCIBjgxCzlhEVJUUTweh+uLdWDfFel4Xt/QZCWQpFSDp4m+dy8owwxpNcofYRTUIS5LUo1x/qprBNGPkZPIBV3fs1dILZMlJeE5hboV3XUc2kJeABacsuSR0sW0KcfgXVDbZuVrJMWteWby2C6r4Yhw7I+Ugsn0YbKdKuNgY6WdqcNB/MXeBhoKUJ6NIL43wnQNLZMS52IiFWYtdsEv4CTzAtRWhq+NmRGp4rtyvunXYnIYO5/W6tyoHWNuXBc7J0OeXskSuH+onPNU3w8DqGMJ8PTCG7vM1DSYB57f9mafN+Wn6BKeR6w6acCWYR4MmzpaFqqY6xulytkb5r2MPCvteqeKf2KTYDUPD0vatVwywb9z6LfQJaRvTJyvKt4lPL/TFr2EDvI+Dg6sqErTnRH2qjP6Cw8NRvH7kCnzG6wIO/5SLwJ0tLs9KSXDLNtlKHvb7UvPH3NaHePi6Wq63ZH+HhkJLzfh0Uue2zbdvjVQslRb73jTpcmLXA4MagZeMPm/XywIfiORmVNg1dL+C0wRoMBr2LorN/trtJ/eoEjwJ6AqMK5QATy0dzGIjBliZs8nfYTJT7MDq6Njfs8LLD8QjpFDngI4wKPwoTvFi6QE46toRgALL3xec+/63Bq9IFKCenFDUY0D+nrknxZiF4xn8ENCLeobOzZgAAAABJRU5ErkJggg==",u3="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAABACAYAAABcIPRGAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAQ9SURBVHgB7ZrNbhMxEMf/TkGtBBLhAO0N9wlIb9xIn4DyBN3AAwA3bqRPQHkB2D4B4caNcONGeQLMraWHhgNSK9SYmf1Am91sas9utUHan9Q2dp1Zj3c8Ho+tUAMbOtD0R/t85wKYnJjwEBVRENLVQXcNnWcW9jkJ6UKAJSUU1AiY7h2Z0ECASIF4xNUneI76Agypsy1RogMRtXYesSz1DgIKb4BN4zoJXCk1i85DGq1htobM6JAETeD3aI3CINgBorcxH3pD44KUbGFDP3nlb9M2JMEDCFjXwT7NgWceXzHUZXre27204p8JbejBJx5ZwYQ8gBB61sjvG/zG7HBdD76mFZECPPL0pw8ZfcjREECK98iRDKPPsTtUp7k2hjQdl3xdo9BpFZIr/AwvOvfy5krlUflcUn1kFGYXfA67qe7qYKcD9T7T0pzBbk1MOFcQK7wK9V3q+xdgjsy7zUUN2HR49NMyKbHT6RQ6Yg/KOs/w/xTsY9SOvdQR0HM/5Mq3ResAu7MLektY4PI8MMkiNoaAaxCSxDGbNJn6EExkev2nZA7fpB1PESuQknRgjIYQhhLLQ6tA07QKNE2rQNO0CjRN5ZW4Kml2g4KLvoWiQHH6wmdz76xAEkbzju0+xNhBvnO0F9mn+l3+rHhHQHE/xVdbrko4K7AKcOd99q9ziDIP22kpSYjtzrSgsaJA7znin0txngN1bGCsowx61i044jOJh6gQ//MWkAxkL1uXmIkptlZjOOJsQsnDNpPX7s05KTB/p2e3Sbn3lF7p2Wg/bPeOTeic6fD2QtIc5iXytthJLNrKlrE064Ck80y7EjdNq0Bd8CSGAG8vJHWjZyVuNDks4RWaQoiByWefL8NZgaqnMmuRjEFA6cOcj5+RqTn7TM/67JovcjahJD7RqMYwW7ijg16JzF044hMLifz0LNZkSyslMmmwfsERZxMiG95fg9X08R4ExCeSeJGt41V4XT+hlLrdybXbd5XrrEAyAQPUzLF5+5iOmvic4BEVzRR4c3IVG5qrhII3HnHnUc/SLmRN0yrQNEsxiePUCtiVGt8TGy8FkuMkDQHkHic/TTgqynxKq+40TMt0EnlIx6fbrhscn1gokF7IYDqxDL5WM0zr4gh0Osy242PU1Xi9cXKrPnOgj8qomRjnevw2daGVR/LMR4ExKjN7+v+HbN7OjYeuJq0SkgnwRw0BfKxKK+6bbB3bOYURFPur15lqvinwwVWu1yRmJVAzHEbQwPDkDhB1HiOfDMVSuNEkNzSEgHYlbppWgaZhBcxsldqVpk6uknjVVvnNvlElN7AM6rkLVBu0jvTyfeQbXtdKFhONei+2VqZwwRU2yi+t8K/fk8MvN7q923TI8AD/BfaA1o7oDG0lrSIlPt7s9n6QrpxsqvtCX01Yjp34BOdlWqPmNUs2GD0sCXxVn5Ng806H/gLb14gD5xk/bgAAAABJRU5ErkJggg==";const h3={},d3={class:"home-contact-details"},p3=Ta('<h1 data-v-c386d4a0>\u042D\u0442\u0430\u043F\u044B \u0440\u0430\u0431\u043E\u0442\u044B \u0441 \u043D\u0430\u043C\u0438<br data-v-c386d4a0>\u043E\u0447\u0435\u043D \u043F\u0440\u043E\u0441\u0442\u044B</h1><div class="smallCards" data-v-c386d4a0><div class="frame" data-v-c386d4a0><div class="smallCard" data-v-c386d4a0><img src="'+a3+'" alt="" data-v-c386d4a0></div><div class="cornerBlock" data-v-c386d4a0></div><p data-v-c386d4a0>\u0412\u044B \u043E\u0441\u0442\u0430\u0432\u0434\u044F\u0435\u0442\u0435 \u0437\u0430\u044F\u0432\u043A\u0443 \u0438 \u043D\u0430\u0448 \u043C\u0435\u043D\u0435\u0434\u0436\u0435\u0440 \u0441\u0432\u044F\u0437\u044B\u0432\u0430\u0435\u0442\u0441\u044F \u0441 \u0412\u0430\u043C\u0438</p></div><img class="arrow" src="'+Cf+'" alt="" data-v-c386d4a0><div class="frame" data-v-c386d4a0><div class="smallCard" data-v-c386d4a0><img src="'+l3+'" alt="" data-v-c386d4a0></div><div class="cornerBlock" data-v-c386d4a0></div><p data-v-c386d4a0>\u041E\u043F\u0440\u0435\u0434\u0435\u043B\u044F\u0435\u043C \u043F\u043B\u0430\u043D \u0440\u0430\u0431\u043E\u0442\u044B, \u0441\u0442\u043E\u0438\u043C\u043E\u0441\u0442\u044C \u0438 \u043F\u043E\u0434\u043F\u0438\u0441\u044B\u0432\u0430\u0435\u043C \u0434\u043E\u0433\u043E\u0432\u043E\u0440</p></div><img class="arrow" src="'+Cf+'" alt="" data-v-c386d4a0><div class="frame" data-v-c386d4a0><div class="smallCard" data-v-c386d4a0><img src="'+c3+'" alt="" data-v-c386d4a0></div><div class="cornerBlock" data-v-c386d4a0></div><p data-v-c386d4a0>\u041D\u0430\u0448\u0438 \u0441\u043F\u0435\u0446\u0438\u0430\u043B\u0438\u0441\u0442\u044B \u043F\u0440\u0438\u0432\u043E\u0434\u044F\u0442 \u0432 \u043F\u043E\u0440\u044F\u0434\u043E\u043A \u043E\u0442\u0447\u0435\u0442\u043D\u043E\u0441\u0442\u044C</p></div><img class="arrow" src="'+Cf+'" alt="" data-v-c386d4a0><div class="frame" data-v-c386d4a0><div class="smallCard" data-v-c386d4a0><img src="'+u3+'" alt="" data-v-c386d4a0></div><div class="cornerBlock" data-v-c386d4a0></div><p data-v-c386d4a0>\u0412\u044B \u0440\u0435\u0433\u0443\u043B\u044F\u0440\u043D\u043E \u043F\u043E\u043B\u0443\u0447\u0430\u0435\u0442\u0435 \u0433\u043E\u0442\u043E\u0432\u0443\u044E \u043E\u0442\u0447\u0435\u0442\u043D\u043E\u0441\u0442\u044C</p></div></div>',2),f3=[p3];function m3(c,p,y,b,T,I){return dr(),pr("div",d3,f3)}var _3=fr(h3,[["render",m3],["__scopeId","data-v-c386d4a0"]]),g3="/assets/logoText.a03b827a.png",y3="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAATCAYAAACgADyUAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAH7SURBVHgBpVJBbxJREH6z+zBEwdAbsCayePEmSdF43AZiPPoPir8AvHkr/ILSmzfLP9BbTWi6vXmAdPsHyl6EvUnSxqh9u+PM42HIdpseOgmPtzPzzfe9mQGxYaWGV3ooZRcROgBYM+5AIAZJnBtEwVG4zoX1xXnV2sUYhuQpiWxbohCDxWQ85A+Lj8rLVhcTOGQQBf1EiJ1fSm3NJ2PgOyKOWBCx7JeJQDOWG29rlq3ODNOAkvtZdNVmm/17zExFXbvoPB0CwGt6x+F8evzBJO0VK/UvxWr9Y8Gpl6/mF98u5xd+oVr3iPV5zrL+WAR6wckJwEi/tdnep7++VgBaXs+wCX6jpkfY5Tc2+B5Nxr4JdjKUdvnIKxWsWoo1a3MU4g4LA3+5vjNQV8lL2TC+gzTAdFWUm23PuAIGftUVEHWbuauAeECal/rHs5se91YKsWMKnUKNJP6V8qdukJLu5nZsmh6bVLNVnnIt1q0ZuKJUn8Ut9j9GY4sCP9TNycVxn+hDar3HM0yD2McxzkniWI/E5mMZhb8LzrNzWI3Ce/TEDa9+zM45Vtl+844W/pOp8T46O/muFaQq94VZq2uAnQfXpMzGk6x1hLQsZ7s1RAAeOHdV3LbDdhp4uZgdPa64WwLAI1AeUYwW03EvnXcDuAbTgrOa0yzQvewfEunarqBTnyYAAAAASUVORK5CYII=",x3="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAAUCAYAAABvVQZ0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAADASURBVHgB7ZQxDoIwFIb/1zSGUW8Aq4nExUFdPIZ4C47gDTyFuukNdFJHwgXgCGwyKE8cSBoSg9B24xua/mma9+VPWkINfx4kILiiYC96HNM25wIGofFsM5WST99p6ARl5bKLb/stTZbrCzGtoIkYPEeSCnJLK/zqqImqQ+TO0GhnstoUghJ/EUAHO2bancGWWX1SZdqU1bt2zeL7wWuTVfrO/ssqZs0YnBLI1X6bTp6J90uEYKToTPk5MsLoes4+Hz91ix2+A44AAAAASUVORK5CYII=",v3="/assets/girlOnCall.a9bd4ad1.png",b3=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},I0={exports:{}};(function(c,p){(function(y,b){c.exports=b()})(b3,function(){var y,b,T;function I(o,U){if(!y)y=U;else if(!b)b=U;else{var oe="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+y+")(sharedChunk); ("+b+")(sharedChunk); self.onerror = null;",te={};y(te),T=U(te),typeof window!="undefined"&&window&&window.URL&&window.URL.createObjectURL&&(T.workerUrl=window.URL.createObjectURL(new Blob([oe],{type:"text/javascript"})))}}I(["exports"],function(o){var U="2.8.1",oe=te;function te(i,e,n,r){this.cx=3*i,this.bx=3*(n-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(r-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=r,this.p2x=n,this.p2y=r}te.prototype.sampleCurveX=function(i){return((this.ax*i+this.bx)*i+this.cx)*i},te.prototype.sampleCurveY=function(i){return((this.ay*i+this.by)*i+this.cy)*i},te.prototype.sampleCurveDerivativeX=function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},te.prototype.solveCurveX=function(i,e){var n,r,a,u,d;for(e===void 0&&(e=1e-6),a=i,d=0;d<8;d++){if(u=this.sampleCurveX(a)-i,Math.abs(u)<e)return a;var f=this.sampleCurveDerivativeX(a);if(Math.abs(f)<1e-6)break;a-=u/f}if((a=i)<(n=0))return n;if(a>(r=1))return r;for(;n<r;){if(u=this.sampleCurveX(a),Math.abs(u-i)<e)return a;i>u?n=a:r=a,a=.5*(r-n)+n}return a},te.prototype.solve=function(i,e){return this.sampleCurveY(this.solveCurveX(i,e))};var Z=se;function se(i,e){this.x=i,this.y=e}se.prototype={clone:function(){return new se(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,e){return this.clone()._rotateAround(i,e)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var e=i.x-this.x,n=i.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,e){return Math.atan2(this.x*e-this.y*i,this.x*i+this.y*e)},_matMult:function(i){var e=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=e,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var e=Math.cos(i),n=Math.sin(i),r=n*this.x+e*this.y;return this.x=e*this.x-n*this.y,this.y=r,this},_rotateAround:function(i,e){var n=Math.cos(i),r=Math.sin(i),a=e.y+r*(this.x-e.x)+n*(this.y-e.y);return this.x=e.x+n*(this.x-e.x)-r*(this.y-e.y),this.y=a,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},se.convert=function(i){return i instanceof se?i:Array.isArray(i)?new se(i[0],i[1]):i};var me=typeof self!="undefined"?self:{};const Ye=Math.PI/180,ft=180/Math.PI;function Fe(i){return i*Ye}function ke(i){return i*ft}const Xe=[[0,0],[1,0],[1,1],[0,1]];function vt(i){if(i<=0)return 0;if(i>=1)return 1;const e=i*i,n=e*i;return 4*(i<.5?n:3*(i-e)+n-.75)}function Dt(i,e,n,r){const a=new oe(i,e,n,r);return function(u){return a.solve(u)}}const Ut=Dt(.25,.1,.25,1);function At(i,e,n){return Math.min(n,Math.max(e,i))}function Ci(i,e,n){return(n=At((n-i)/(e-i),0,1))*n*(3-2*n)}function Li(i,e,n){const r=n-e,a=((i-e)%r+r)%r+e;return a===e?n:a}function zi(i,e,n){if(!i.length)return n(null,[]);let r=i.length;const a=new Array(i.length);let u=null;i.forEach((d,f)=>{e(d,(g,v)=>{g&&(u=g),a[f]=v,--r==0&&n(u,a)})})}function xn(i){const e=[];for(const n in i)e.push(i[n]);return e}function yi(i,...e){for(const n of e)for(const r in n)i[r]=n[r];return i}let dn=1;function Mn(){return dn++}function er(){return function i(e){return e?(e^Math.random()*(16>>e/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,i)}()}function tr(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function Ti(i){return!!i&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(i)}function hi(i,e){i.forEach(n=>{e[n]&&(e[n]=e[n].bind(e))})}function Kt(i,e){return i.indexOf(e,i.length-e.length)!==-1}function Ui(i,e,n){const r={};for(const a in i)r[a]=e.call(n||this,i[a],a,i);return r}function Un(i,e,n){const r={};for(const a in i)e.call(n||this,i[a],a,i)&&(r[a]=i[a]);return r}function Vi(i){return Array.isArray(i)?i.map(Vi):typeof i=="object"&&i?Ui(i,Vi):i}const pn={};function Gt(i){pn[i]||(typeof console!="undefined"&&console.warn(i),pn[i]=!0)}function Wi(i,e,n){return(n.y-i.y)*(e.x-i.x)>(e.y-i.y)*(n.x-i.x)}function Le(i){let e=0;for(let n,r,a=0,u=i.length,d=u-1;a<u;d=a++)n=i[a],r=i[d],e+=(r.x-n.x)*(n.y+r.y);return e}function dt(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function tt(i){const e={};if(i.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(n,r,a,u)=>{const d=a||u;return e[r]=!d||d.toLowerCase(),""}),e["max-age"]){const n=parseInt(e["max-age"],10);isNaN(n)?delete e["max-age"]:e["max-age"]=n}return e}let wt,di,li,Ot,rt=null;function ie(i){if(rt==null){const e=i.navigator?i.navigator.userAgent:null;rt=!!i.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return rt}function pe(i){try{const e=me[i];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}const Ee={now:()=>li!==void 0?li:me.performance.now(),setNow(i){li=i},restoreNow(){li=void 0},frame(i){const e=me.requestAnimationFrame(i);return{cancel:()=>me.cancelAnimationFrame(e)}},getImageData(i,e=0){const{width:n,height:r}=i;Ot||(Ot=me.document.createElement("canvas"));const a=Ot.getContext("2d");if(!a)throw new Error("failed to create canvas 2d context");return(n>Ot.width||r>Ot.height)&&(Ot.width=n,Ot.height=r),a.clearRect(-e,-e,n+2*e,r+2*e),a.drawImage(i,0,0,n,r),a.getImageData(-e,-e,n+2*e,r+2*e)},resolveURL:i=>(wt||(wt=me.document.createElement("a")),wt.href=i,wt.href),get devicePixelRatio(){return me.devicePixelRatio},get prefersReducedMotion(){return!!me.matchMedia&&(di==null&&(di=me.matchMedia("(prefers-reduced-motion: reduce)")),di.matches)}};let Ne;const ze={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(Ne==null){const i=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{Ne={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):i}catch{Ne=i}}return Ne},get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Ke={supported:!1,testSupport:function(i){!$e&&He&&(Ge?Mt(i):at=i)}};let at,He,$e=!1,Ge=!1;function Mt(i){const e=i.createTexture();i.bindTexture(i.TEXTURE_2D,e);try{if(i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,He),i.isContextLost())return;Ke.supported=!0}catch{}i.deleteTexture(e),$e=!0}me.document&&(He=me.document.createElement("img"),He.onload=function(){at&&Mt(at),at=null,Ge=!0},He.onerror=function(){$e=!0,at=null},He.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const mt="01",Ct="NO_ACCESS_TOKEN";function It(i){return i.indexOf("mapbox:")===0}function qt(i){return ze.API_URL_REGEX.test(i)}const ei=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Xt(i){const e=i.match(ei);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function ci(i){const e=i.params.length?`?${i.params.join("&")}`:"";return`${i.protocol}://${i.authority}${i.path}${e}`}function nn(i){if(!i)return null;const e=i.split(".");if(!e||e.length!==3)return null;try{return JSON.parse(decodeURIComponent(me.atob(e[1]).split("").map(n=>"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class vn{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const n=nn(ze.ACCESS_TOKEN);let r="";return r=n&&n.u?me.btoa(encodeURIComponent(n.u).replace(/%([0-9A-F]{2})/g,(a,u)=>String.fromCharCode(Number("0x"+u)))):ze.ACCESS_TOKEN||"",e?`mapbox.eventData.${e}:${r}`:`mapbox.eventData:${r}`}fetchEventData(){const e=pe("localStorage"),n=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{const a=me.localStorage.getItem(n);a&&(this.eventData=JSON.parse(a));const u=me.localStorage.getItem(r);u&&(this.anonId=u)}catch{Gt("Unable to read from LocalStorage")}}saveEventData(){const e=pe("localStorage"),n=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{me.localStorage.setItem(r,this.anonId),Object.keys(this.eventData).length>=1&&me.localStorage.setItem(n,JSON.stringify(this.eventData))}catch{Gt("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,n,r,a){if(!ze.EVENTS_URL)return;const u=Xt(ze.EVENTS_URL);u.params.push(`access_token=${a||ze.ACCESS_TOKEN||""}`);const d={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:U,skuId:mt,userId:this.anonId},f=n?yi(d,n):d,g={url:ci(u),headers:{"Content-Type":"text/plain"},body:JSON.stringify([f])};this.pendingRequest=ae(g,v=>{this.pendingRequest=null,r(v),this.saveEventData(),this.processRequests(a)})}queueRequest(e,n){this.queue.push(e),this.processRequests(n)}}const br=new class extends vn{constructor(i){super("appUserTurnstile"),this._customAccessToken=i}postTurnstileEvent(i,e){ze.EVENTS_URL&&ze.ACCESS_TOKEN&&Array.isArray(i)&&i.some(n=>It(n)||qt(n))&&this.queueRequest(Date.now(),e)}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=nn(ze.ACCESS_TOKEN),n=e?e.u:ze.ACCESS_TOKEN;let r=n!==this.eventData.tokenU;Ti(this.anonId)||(this.anonId=er(),r=!0);const a=this.queue.shift();if(this.eventData.lastSuccess){const u=new Date(this.eventData.lastSuccess),d=new Date(a),f=(a-this.eventData.lastSuccess)/864e5;r=r||f>=1||f<-1||u.getDate()!==d.getDate()}else r=!0;r?this.postEvent(a,{"enabled.telemetry":!1},u=>{u||(this.eventData.lastSuccess=a,this.eventData.tokenU=n)},i):this.processRequests()}},Ar=br.postTurnstileEvent.bind(br),ho=new class extends vn{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(i,e,n,r){this.skuToken=e,this.errorCb=r,ze.EVENTS_URL&&(n||ze.ACCESS_TOKEN?this.queueRequest({id:i,timestamp:Date.now()},n):this.errorCb(new Error(Ct)))}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:n}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),Ti(this.anonId)||(this.anonId=er()),this.postEvent(n,{skuToken:this.skuToken},r=>{r?this.errorCb(r):e&&(this.success[e]=!0)},i))}},$i=ho.postMapLoadEvent.bind(ho),rn=new class extends vn{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(i,e,n,r){if(!ze.API_URL||!ze.SESSION_PATH)return;const a=Xt(ze.API_URL+ze.SESSION_PATH);a.params.push(`sku=${e||""}`),a.params.push(`access_token=${r||ze.ACCESS_TOKEN||""}`);const u={url:ci(a),headers:{"Content-Type":"text/plain"}};this.pendingRequest=_e(u,d=>{this.pendingRequest=null,n(d),this.saveEventData(),this.processRequests(r)})}getSessionAPI(i,e,n,r){this.skuToken=e,this.errorCb=r,ze.SESSION_PATH&&ze.API_URL&&(n||ze.ACCESS_TOKEN?this.queueRequest({id:i,timestamp:Date.now()},n):this.errorCb(new Error(Ct)))}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:n}=this.queue.shift();e&&this.success[e]||this.getSession(n,this.skuToken,r=>{r?this.errorCb(r):e&&(this.success[e]=!0)},i)}},po=rn.getSessionAPI.bind(rn),fo=new Set,Ea="mapbox-tiles";let ir,Or,mo=500,_o=50;function Go(){me.caches&&!ir&&(ir=me.caches.open(Ea))}function Ds(i){const e=i.indexOf("?");return e<0?i:i.slice(0,e)}let Zo=1/0;const Y={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Y);class P extends Error{constructor(e,n,r){n===401&&qt(r)&&(e+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),super(e),this.status=n,this.url=r}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const R=dt()?()=>self.worker&&self.worker.referrer:()=>(me.location.protocol==="blob:"?me.parent:me).location.href,q=function(i,e){if(!(/^file:/.test(n=i.url)||/^file:/.test(R())&&!/^\w+:/.test(n))){if(me.fetch&&me.Request&&me.AbortController&&me.Request.prototype.hasOwnProperty("signal"))return function(r,a){const u=new me.AbortController,d=new me.Request(r.url,{method:r.method||"GET",body:r.body,credentials:r.credentials,headers:r.headers,referrer:R(),signal:u.signal});let f=!1,g=!1;const v=(w=d.url).indexOf("sku=")>0&&qt(w);var w;r.type==="json"&&d.headers.set("Accept","application/json");const E=(k,L,F)=>{if(g)return;if(k&&k.message!=="SecurityError"&&Gt(k),L&&F)return M(L);const j=Date.now();me.fetch(d).then(H=>{if(H.ok){const ne=v?H.clone():null;return M(H,ne,j)}return a(new P(H.statusText,H.status,r.url))}).catch(H=>{H.code!==20&&a(new Error(H.message))})},M=(k,L,F)=>{(r.type==="arrayBuffer"?k.arrayBuffer():r.type==="json"?k.json():k.text()).then(j=>{g||(L&&F&&function(H,ne,le){if(Go(),!ir)return;const ue={status:ne.status,statusText:ne.statusText,headers:new me.Headers};ne.headers.forEach((Te,Me)=>ue.headers.set(Me,Te));const he=tt(ne.headers.get("Cache-Control")||"");if(he["no-store"])return;he["max-age"]&&ue.headers.set("Expires",new Date(le+1e3*he["max-age"]).toUTCString());const de=ue.headers.get("Expires");de&&(new Date(de).getTime()-le<42e4||function(Te,Me){if(Or===void 0)try{new Response(new ReadableStream),Or=!0}catch{Or=!1}Or?Me(Te.body):Te.blob().then(Me)}(ne,Te=>{const Me=new me.Response(Te,ue);Go(),ir&&ir.then(De=>De.put(Ds(H.url),Me)).catch(De=>Gt(De.message))}))}(d,L,F),f=!0,a(null,j,k.headers.get("Cache-Control"),k.headers.get("Expires")))}).catch(j=>{g||a(new Error(j.message))})};return v?function(k,L){if(Go(),!ir)return L(null);const F=Ds(k.url);ir.then(j=>{j.match(F).then(H=>{const ne=function(le){if(!le)return!1;const ue=new Date(le.headers.get("Expires")||0),he=tt(le.headers.get("Cache-Control")||"");return ue>Date.now()&&!he["no-cache"]}(H);j.delete(F),ne&&j.put(F,H.clone()),L(null,H,ne)}).catch(L)}).catch(L)}(d,E):E(null,null),{cancel:()=>{g=!0,f||u.abort()}}}(i,e);if(dt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",i,e,void 0,!0)}var n;return function(r,a){const u=new me.XMLHttpRequest;u.open(r.method||"GET",r.url,!0),r.type==="arrayBuffer"&&(u.responseType="arraybuffer");for(const d in r.headers)u.setRequestHeader(d,r.headers[d]);return r.type==="json"&&(u.responseType="text",u.setRequestHeader("Accept","application/json")),u.withCredentials=r.credentials==="include",u.onerror=()=>{a(new Error(u.statusText))},u.onload=()=>{if((u.status>=200&&u.status<300||u.status===0)&&u.response!==null){let d=u.response;if(r.type==="json")try{d=JSON.parse(u.response)}catch(f){return a(f)}a(null,d,u.getResponseHeader("Cache-Control"),u.getResponseHeader("Expires"))}else a(new P(u.statusText,u.status,r.url))},u.send(r.body),{cancel:()=>u.abort()}}(i,e)},J=function(i,e){return q(yi(i,{type:"arrayBuffer"}),e)},ae=function(i,e){return q(yi(i,{method:"POST"}),e)},_e=function(i,e){return q(yi(i,{method:"GET"}),e)};function fe(i){const e=me.document.createElement("a");return e.href=i,e.protocol===me.document.location.protocol&&e.host===me.document.location.host}const ce="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let xe,Pe;xe=[],Pe=0;const Je=function(i,e){if(Ke.supported&&(i.headers||(i.headers={}),i.headers.accept="image/webp,*/*"),Pe>=ze.MAX_PARALLEL_IMAGE_REQUESTS){const u={requestParameters:i,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return xe.push(u),u}Pe++;let n=!1;const r=()=>{if(!n)for(n=!0,Pe--;xe.length&&Pe<ze.MAX_PARALLEL_IMAGE_REQUESTS;){const u=xe.shift(),{requestParameters:d,callback:f,cancelled:g}=u;g||(u.cancel=Je(d,f).cancel)}},a=J(i,(u,d,f,g)=>{r(),u?e(u):d&&(me.createImageBitmap?function(v,w){const E=new me.Blob([new Uint8Array(v)],{type:"image/png"});me.createImageBitmap(E).then(M=>{w(null,M)}).catch(M=>{w(new Error(`Could not load image because of ${M.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(d,(v,w)=>e(v,w,f,g)):function(v,w){const E=new me.Image,M=me.URL;E.onload=()=>{w(null,E),M.revokeObjectURL(E.src),E.onload=null,me.requestAnimationFrame(()=>{E.src=ce})},E.onerror=()=>w(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const k=new me.Blob([new Uint8Array(v)],{type:"image/png"});E.src=v.byteLength?M.createObjectURL(k):ce}(d,(v,w)=>e(v,w,f,g)))});return{cancel:()=>{a.cancel(),r()}}};function Re(i,e,n){n[i]&&n[i].indexOf(e)!==-1||(n[i]=n[i]||[],n[i].push(e))}function Tt(i,e,n){if(n&&n[i]){const r=n[i].indexOf(e);r!==-1&&n[i].splice(r,1)}}class _t{constructor(e,n={}){yi(this,n),this.type=e}}class gt extends _t{constructor(e,n={}){super("error",yi({error:e},n))}}class St{on(e,n){return this._listeners=this._listeners||{},Re(e,n,this._listeners),this}off(e,n){return Tt(e,n,this._listeners),Tt(e,n,this._oneTimeListeners),this}once(e,n){return n?(this._oneTimeListeners=this._oneTimeListeners||{},Re(e,n,this._oneTimeListeners),this):new Promise(r=>this.once(e,r))}fire(e,n){typeof e=="string"&&(e=new _t(e,n||{}));const r=e.type;if(this.listens(r)){e.target=this;const a=this._listeners&&this._listeners[r]?this._listeners[r].slice():[];for(const f of a)f.call(this,e);const u=this._oneTimeListeners&&this._oneTimeListeners[r]?this._oneTimeListeners[r].slice():[];for(const f of u)Tt(r,f,this._oneTimeListeners),f.call(this,e);const d=this._eventedParent;d&&(yi(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),d.fire(e))}else e instanceof gt&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,n){return this._eventedParent=e,this._eventedParentData=n,this}}var ve=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":0.1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":true,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"cross-faded"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"cross-faded":{"type":"property-type"},"cross-faded-data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function ni(i,...e){for(const n of e)for(const r in n)i[r]=n[r];return i}function ct(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function ti(i){if(Array.isArray(i))return i.map(ti);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){const e={};for(const n in i)e[n]=ti(i[n]);return e}return ct(i)}class ri extends Error{constructor(e,n){super(n),this.message=n,this.key=e}}class go{constructor(e,n=[]){this.parent=e,this.bindings={};for(const[r,a]of n)this.bindings[r]=a}concat(e){return new go(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const wr={kind:"null"},Qe={kind:"number"},Ht={kind:"string"},Vt={kind:"boolean"},_r={kind:"color"},yo={kind:"object"},Zt={kind:"value"},xo={kind:"collator"},qo={kind:"formatted"},fn={kind:"resolvedImage"};function Vn(i,e){return{kind:"array",itemType:i,N:e}}function Mi(i){if(i.kind==="array"){const e=Mi(i.itemType);return typeof i.N=="number"?`array<${e}, ${i.N}>`:i.itemType.kind==="value"?"array":`array<${e}>`}return i.kind}const Xd=[wr,Qe,Ht,Vt,_r,qo,yo,Vn(Zt),fn];function Ps(i,e){if(e.kind==="error")return null;if(i.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!Ps(i.itemType,e.itemType))&&(typeof i.N!="number"||i.N===e.N))return null}else{if(i.kind===e.kind)return null;if(i.kind==="value"){for(const n of Xd)if(!Ps(n,e))return null}}return`Expected ${Mi(i)} but found ${Mi(e)} instead.`}function Ca(i,e){return e.some(n=>n.kind===i.kind)}function Wo(i,e){return e.some(n=>n==="null"?i===null:n==="array"?Array.isArray(i):n==="object"?i&&!Array.isArray(i)&&typeof i=="object":n===typeof i)}function Ma(i){var e={exports:{}};return i(e,e.exports),e.exports}var ql=Ma(function(i,e){var n={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function r(f){return(f=Math.round(f))<0?0:f>255?255:f}function a(f){return r(f[f.length-1]==="%"?parseFloat(f)/100*255:parseInt(f))}function u(f){return(g=f[f.length-1]==="%"?parseFloat(f)/100:parseFloat(f))<0?0:g>1?1:g;var g}function d(f,g,v){return v<0?v+=1:v>1&&(v-=1),6*v<1?f+(g-f)*v*6:2*v<1?g:3*v<2?f+(g-f)*(2/3-v)*6:f}try{e.parseCSSColor=function(f){var g,v=f.replace(/ /g,"").toLowerCase();if(v in n)return n[v].slice();if(v[0]==="#")return v.length===4?(g=parseInt(v.substr(1),16))>=0&&g<=4095?[(3840&g)>>4|(3840&g)>>8,240&g|(240&g)>>4,15&g|(15&g)<<4,1]:null:v.length===7&&(g=parseInt(v.substr(1),16))>=0&&g<=16777215?[(16711680&g)>>16,(65280&g)>>8,255&g,1]:null;var w=v.indexOf("("),E=v.indexOf(")");if(w!==-1&&E+1===v.length){var M=v.substr(0,w),k=v.substr(w+1,E-(w+1)).split(","),L=1;switch(M){case"rgba":if(k.length!==4)return null;L=u(k.pop());case"rgb":return k.length!==3?null:[a(k[0]),a(k[1]),a(k[2]),L];case"hsla":if(k.length!==4)return null;L=u(k.pop());case"hsl":if(k.length!==3)return null;var F=(parseFloat(k[0])%360+360)%360/360,j=u(k[1]),H=u(k[2]),ne=H<=.5?H*(j+1):H+j-H*j,le=2*H-ne;return[r(255*d(le,ne,F+1/3)),r(255*d(le,ne,F)),r(255*d(le,ne,F-1/3)),L];default:return null}}return null}}catch{}});class ii{constructor(e,n,r,a=1){this.r=e,this.g=n,this.b=r,this.a=a}static parse(e){if(!e)return;if(e instanceof ii)return e;if(typeof e!="string")return;const n=ql.parseCSSColor(e);return n?new ii(n[0]/255*n[3],n[1]/255*n[3],n[2]/255*n[3],n[3]):void 0}toString(){const[e,n,r,a]=this.toArray();return`rgba(${Math.round(e)},${Math.round(n)},${Math.round(r)},${a})`}toArray(){const{r:e,g:n,b:r,a}=this;return a===0?[0,0,0,0]:[255*e/a,255*n/a,255*r/a,a]}}ii.black=new ii(0,0,0,1),ii.white=new ii(1,1,1,1),ii.transparent=new ii(0,0,0,0),ii.red=new ii(1,0,0,1),ii.blue=new ii(0,0,1,1);class Ho{constructor(e,n,r){this.sensitivity=e?n?"variant":"case":n?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,n){return this.collator.compare(e,n)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Wl{constructor(e,n,r,a,u){this.text=e.normalize?e.normalize():e,this.image=n,this.scale=r,this.fontStack=a,this.textColor=u}}class Hi{constructor(e){this.sections=e}static fromString(e){return new Hi([new Wl(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof Hi?e:Hi.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const n of this.sections){if(n.image){e.push(["image",n.image.name]);continue}e.push(n.text);const r={};n.fontStack&&(r["text-font"]=["literal",n.fontStack.split(",")]),n.scale&&(r["font-scale"]=n.scale),n.textColor&&(r["text-color"]=["rgba"].concat(n.textColor.toArray())),e.push(r)}return e}}class Sn{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new Sn({name:e,available:!1}):null}serialize(){return["image",this.name]}}function nr(i,e,n,r){return typeof i=="number"&&i>=0&&i<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof n=="number"&&n>=0&&n<=255?r===void 0||typeof r=="number"&&r>=0&&r<=1?null:`Invalid rgba value [${[i,e,n,r].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof r=="number"?[i,e,n,r]:[i,e,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Sa(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof ii||i instanceof Ho||i instanceof Hi||i instanceof Sn)return!0;if(Array.isArray(i)){for(const e of i)if(!Sa(e))return!1;return!0}if(typeof i=="object"){for(const e in i)if(!Sa(i[e]))return!1;return!0}return!1}function ji(i){if(i===null)return wr;if(typeof i=="string")return Ht;if(typeof i=="boolean")return Vt;if(typeof i=="number")return Qe;if(i instanceof ii)return _r;if(i instanceof Ho)return xo;if(i instanceof Hi)return qo;if(i instanceof Sn)return fn;if(Array.isArray(i)){const e=i.length;let n;for(const r of i){const a=ji(r);if(n){if(n===a)continue;n=Zt;break}n=a}return Vn(n||Zt,e)}return yo}function Tr(i){const e=typeof i;return i===null?"":e==="string"||e==="number"||e==="boolean"?String(i):i instanceof ii||i instanceof Hi||i instanceof Sn?i.toString():JSON.stringify(i)}class Er{constructor(e,n){this.type=e,this.value=n}static parse(e,n){if(e.length!==2)return n.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Sa(e[1]))return n.error("invalid value");const r=e[1];let a=ji(r);const u=n.expectedType;return a.kind!=="array"||a.N!==0||!u||u.kind!=="array"||typeof u.N=="number"&&u.N!==0||(a=u),new Er(a,r)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof ii?["rgba"].concat(this.value.toArray()):this.value instanceof Hi?this.value.serialize():this.value}}class on{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}}const Hl={string:Ht,number:Qe,boolean:Vt,object:yo};class rr{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");let r,a=1;const u=e[0];if(u==="array"){let f,g;if(e.length>2){const v=e[1];if(typeof v!="string"||!(v in Hl)||v==="object")return n.error('The item type argument of "array" must be one of string, number, boolean',1);f=Hl[v],a++}else f=Zt;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return n.error('The length argument to "array" must be a positive integer literal',2);g=e[2],a++}r=Vn(f,g)}else r=Hl[u];const d=[];for(;a<e.length;a++){const f=n.parse(e[a],a,Zt);if(!f)return null;d.push(f)}return new rr(r,d)}evaluate(e){for(let n=0;n<this.args.length;n++){const r=this.args[n].evaluate(e);if(!Ps(this.type,ji(r)))return r;if(n===this.args.length-1)throw new on(`Expected value to be of type ${Mi(this.type)}, but found ${Mi(ji(r))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,n=[e.kind];if(e.kind==="array"){const r=e.itemType;if(r.kind==="string"||r.kind==="number"||r.kind==="boolean"){n.push(r.kind);const a=e.N;(typeof a=="number"||this.args.length>1)&&n.push(a)}}return n.concat(this.args.map(r=>r.serialize()))}}class Yo{constructor(e){this.type=qo,this.sections=e}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");const r=e[1];if(!Array.isArray(r)&&typeof r=="object")return n.error("First argument must be an image or text section.");const a=[];let u=!1;for(let d=1;d<=e.length-1;++d){const f=e[d];if(u&&typeof f=="object"&&!Array.isArray(f)){u=!1;let g=null;if(f["font-scale"]&&(g=n.parse(f["font-scale"],1,Qe),!g))return null;let v=null;if(f["text-font"]&&(v=n.parse(f["text-font"],1,Vn(Ht)),!v))return null;let w=null;if(f["text-color"]&&(w=n.parse(f["text-color"],1,_r),!w))return null;const E=a[a.length-1];E.scale=g,E.font=v,E.textColor=w}else{const g=n.parse(e[d],1,Zt);if(!g)return null;const v=g.type.kind;if(v!=="string"&&v!=="value"&&v!=="null"&&v!=="resolvedImage")return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");u=!0,a.push({content:g,scale:null,font:null,textColor:null})}}return new Yo(a)}evaluate(e){return new Hi(this.sections.map(n=>{const r=n.content.evaluate(e);return ji(r)===fn?new Wl("",r,null,null,null):new Wl(Tr(r),null,n.scale?n.scale.evaluate(e):null,n.font?n.font.evaluate(e).join(","):null,n.textColor?n.textColor.evaluate(e):null)}))}eachChild(e){for(const n of this.sections)e(n.content),n.scale&&e(n.scale),n.font&&e(n.font),n.textColor&&e(n.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const n of this.sections){e.push(n.content.serialize());const r={};n.scale&&(r["font-scale"]=n.scale.serialize()),n.font&&(r["text-font"]=n.font.serialize()),n.textColor&&(r["text-color"]=n.textColor.serialize()),e.push(r)}return e}}class Xo{constructor(e){this.type=fn,this.input=e}static parse(e,n){if(e.length!==2)return n.error("Expected two arguments.");const r=n.parse(e[1],1,Ht);return r?new Xo(r):n.error("No image name provided.")}evaluate(e){const n=this.input.evaluate(e),r=Sn.fromString(n);return r&&e.availableImages&&(r.available=e.availableImages.indexOf(n)>-1),r}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Qd={"to-boolean":Vt,"to-color":_r,"to-number":Qe,"to-string":Ht};class or{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");const r=e[0];if((r==="to-boolean"||r==="to-string")&&e.length!==2)return n.error("Expected one argument.");const a=Qd[r],u=[];for(let d=1;d<e.length;d++){const f=n.parse(e[d],d,Zt);if(!f)return null;u.push(f)}return new or(a,u)}evaluate(e){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(e));if(this.type.kind==="color"){let n,r;for(const a of this.args){if(n=a.evaluate(e),r=null,n instanceof ii)return n;if(typeof n=="string"){const u=e.parseColor(n);if(u)return u}else if(Array.isArray(n)&&(r=n.length<3||n.length>4?`Invalid rbga value ${JSON.stringify(n)}: expected an array containing either three or four numeric values.`:nr(n[0],n[1],n[2],n[3]),!r))return new ii(n[0]/255,n[1]/255,n[2]/255,n[3])}throw new on(r||`Could not parse color from value '${typeof n=="string"?n:String(JSON.stringify(n))}'`)}if(this.type.kind==="number"){let n=null;for(const r of this.args){if(n=r.evaluate(e),n===null)return 0;const a=Number(n);if(!isNaN(a))return a}throw new on(`Could not convert ${JSON.stringify(n)} to number.`)}return this.type.kind==="formatted"?Hi.fromString(Tr(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Sn.fromString(Tr(this.args[0].evaluate(e))):Tr(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Yo([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Xo(this.args[0]).serialize();const e=[`to-${this.type.kind}`];return this.eachChild(n=>{e.push(n.serialize())}),e}}const Kd=["Unknown","Point","LineString","Polygon"];class Lu{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&"id"in this.feature&&this.feature.id?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Kd[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const e=this.featureDistanceData.center,n=this.featureDistanceData.scale,{x:r,y:a}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(r*n-e[0])+this.featureDistanceData.bearing[1]*(a*n-e[1])}return 0}parseColor(e){let n=this._parseColorCache[e];return n||(n=this._parseColorCache[e]=ii.parse(e)),n}}class In{constructor(e,n,r,a){this.name=e,this.type=n,this._evaluate=r,this.args=a}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,n){const r=e[0],a=In.definitions[r];if(!a)return n.error(`Unknown expression "${r}". If you wanted a literal array, use ["literal", [...]].`,0);const u=Array.isArray(a)?a[0]:a.type,d=Array.isArray(a)?[[a[1],a[2]]]:a.overloads,f=d.filter(([v])=>!Array.isArray(v)||v.length===e.length-1);let g=null;for(const[v,w]of f){g=new Nr(n.registry,n.path,null,n.scope);const E=[];let M=!1;for(let k=1;k<e.length;k++){const L=e[k],F=Array.isArray(v)?v[k-1]:v.type,j=g.parse(L,1+E.length,F);if(!j){M=!0;break}E.push(j)}if(!M)if(Array.isArray(v)&&v.length!==E.length)g.error(`Expected ${v.length} arguments, but found ${E.length} instead.`);else{for(let k=0;k<E.length;k++){const L=Array.isArray(v)?v[k]:v.type,F=E[k];g.concat(k+1).checkSubtype(L,F.type)}if(g.errors.length===0)return new In(r,u,w,E)}}if(f.length===1)n.errors.push(...g.errors);else{const v=(f.length?f:d).map(([E])=>{return M=E,Array.isArray(M)?`(${M.map(Mi).join(", ")})`:`(${Mi(M.type)}...)`;var M}).join(" | "),w=[];for(let E=1;E<e.length;E++){const M=n.parse(e[E],1+w.length);if(!M)return null;w.push(Mi(M.type))}n.error(`Expected arguments of type ${v}, but found (${w.join(", ")}) instead.`)}return null}static register(e,n){In.definitions=n;for(const r in n)e[r]=In}}class Ia{constructor(e,n,r){this.type=xo,this.locale=r,this.caseSensitive=e,this.diacriticSensitive=n}static parse(e,n){if(e.length!==2)return n.error("Expected one argument.");const r=e[1];if(typeof r!="object"||Array.isArray(r))return n.error("Collator options argument must be an object.");const a=n.parse(r["case-sensitive"]!==void 0&&r["case-sensitive"],1,Vt);if(!a)return null;const u=n.parse(r["diacritic-sensitive"]!==void 0&&r["diacritic-sensitive"],1,Vt);if(!u)return null;let d=null;return r.locale&&(d=n.parse(r.locale,1,Ht),!d)?null:new Ia(a,u,d)}evaluate(e){return new Ho(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}const Fr=8192;function Yl(i,e){i[0]=Math.min(i[0],e[0]),i[1]=Math.min(i[1],e[1]),i[2]=Math.max(i[2],e[0]),i[3]=Math.max(i[3],e[1])}function za(i,e){return!(i[0]<=e[0]||i[2]>=e[2]||i[1]<=e[1]||i[3]>=e[3])}function Ru(i,e){const n=(180+i[0])/360,r=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i[1]*Math.PI/360)))/360,a=Math.pow(2,e.z);return[Math.round(n*a*Fr),Math.round(r*a*Fr)]}function ka(i,e,n){const r=i[0]-e[0],a=i[1]-e[1],u=i[0]-n[0],d=i[1]-n[1];return r*d-u*a==0&&r*u<=0&&a*d<=0}function Xl(i,e){let n=!1;for(let d=0,f=e.length;d<f;d++){const g=e[d];for(let v=0,w=g.length;v<w-1;v++){if(ka(i,g[v],g[v+1]))return!1;(a=g[v])[1]>(r=i)[1]!=(u=g[v+1])[1]>r[1]&&r[0]<(u[0]-a[0])*(r[1]-a[1])/(u[1]-a[1])+a[0]&&(n=!n)}}var r,a,u;return n}function $d(i,e){for(let n=0;n<e.length;n++)if(Xl(i,e[n]))return!0;return!1}function Ou(i,e,n,r){const a=r[0]-n[0],u=r[1]-n[1],d=(i[0]-n[0])*u-a*(i[1]-n[1]),f=(e[0]-n[0])*u-a*(e[1]-n[1]);return d>0&&f<0||d<0&&f>0}function Jd(i,e,n){for(const v of n)for(let w=0;w<v.length-1;++w)if((f=[(d=v[w+1])[0]-(u=v[w])[0],d[1]-u[1]])[0]*(g=[(a=e)[0]-(r=i)[0],a[1]-r[1]])[1]-f[1]*g[0]!=0&&Ou(r,a,u,d)&&Ou(u,d,r,a))return!0;var r,a,u,d,f,g;return!1}function Fu(i,e){for(let n=0;n<i.length;++n)if(!Xl(i[n],e))return!1;for(let n=0;n<i.length-1;++n)if(Jd(i[n],i[n+1],e))return!1;return!0}function ep(i,e){for(let n=0;n<e.length;n++)if(Fu(i,e[n]))return!0;return!1}function Da(i,e,n){const r=[];for(let a=0;a<i.length;a++){const u=[];for(let d=0;d<i[a].length;d++){const f=Ru(i[a][d],n);Yl(e,f),u.push(f)}r.push(u)}return r}function Bs(i,e,n){const r=[];for(let a=0;a<i.length;a++){const u=Da(i[a],e,n);r.push(u)}return r}function Nu(i,e,n,r){if(i[0]<n[0]||i[0]>n[2]){const a=.5*r;let u=i[0]-n[0]>a?-r:n[0]-i[0]>a?r:0;u===0&&(u=i[0]-n[2]>a?-r:n[2]-i[0]>a?r:0),i[0]+=u}Yl(e,i)}function Uu(i,e,n,r){const a=Math.pow(2,r.z)*Fr,u=[r.x*Fr,r.y*Fr],d=[];if(!i)return d;for(const f of i)for(const g of f){const v=[g.x+u[0],g.y+u[1]];Nu(v,e,n,a),d.push(v)}return d}function Vu(i,e,n,r){const a=Math.pow(2,r.z)*Fr,u=[r.x*Fr,r.y*Fr],d=[];if(!i)return d;for(const g of i){const v=[];for(const w of g){const E=[w.x+u[0],w.y+u[1]];Yl(e,E),v.push(E)}d.push(v)}if(e[2]-e[0]<=a/2){(f=e)[0]=f[1]=1/0,f[2]=f[3]=-1/0;for(const g of d)for(const v of g)Nu(v,e,n,a)}var f;return d}class vo{constructor(e,n){this.type=Vt,this.geojson=e,this.geometries=n}static parse(e,n){if(e.length!==2)return n.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Sa(e[1])){const r=e[1];if(r.type==="FeatureCollection")for(let a=0;a<r.features.length;++a){const u=r.features[a].geometry.type;if(u==="Polygon"||u==="MultiPolygon")return new vo(r,r.features[a].geometry)}else if(r.type==="Feature"){const a=r.geometry.type;if(a==="Polygon"||a==="MultiPolygon")return new vo(r,r.geometry)}else if(r.type==="Polygon"||r.type==="MultiPolygon")return new vo(r,r)}return n.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(n,r){const a=[1/0,1/0,-1/0,-1/0],u=[1/0,1/0,-1/0,-1/0],d=n.canonicalID();if(!d)return!1;if(r.type==="Polygon"){const f=Da(r.coordinates,u,d),g=Uu(n.geometry(),a,u,d);if(!za(a,u))return!1;for(const v of g)if(!Xl(v,f))return!1}if(r.type==="MultiPolygon"){const f=Bs(r.coordinates,u,d),g=Uu(n.geometry(),a,u,d);if(!za(a,u))return!1;for(const v of g)if(!$d(v,f))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(n,r){const a=[1/0,1/0,-1/0,-1/0],u=[1/0,1/0,-1/0,-1/0],d=n.canonicalID();if(!d)return!1;if(r.type==="Polygon"){const f=Da(r.coordinates,u,d),g=Vu(n.geometry(),a,u,d);if(!za(a,u))return!1;for(const v of g)if(!Fu(v,f))return!1}if(r.type==="MultiPolygon"){const f=Bs(r.coordinates,u,d),g=Vu(n.geometry(),a,u,d);if(!za(a,u))return!1;for(const v of g)if(!ep(v,f))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}function bn(i){if(i instanceof In&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof vo)return!1;let e=!0;return i.eachChild(n=>{e&&!bn(n)&&(e=!1)}),e}function Ls(i){if(i instanceof In&&i.name==="feature-state")return!1;let e=!0;return i.eachChild(n=>{e&&!Ls(n)&&(e=!1)}),e}function Rs(i,e){if(i instanceof In&&e.indexOf(i.name)>=0)return!1;let n=!0;return i.eachChild(r=>{n&&!Rs(r,e)&&(n=!1)}),n}class bo{constructor(e,n){this.type=n.type,this.name=e,this.boundExpression=n}static parse(e,n){if(e.length!==2||typeof e[1]!="string")return n.error("'var' expression requires exactly one string literal argument.");const r=e[1];return n.scope.has(r)?new bo(r,n.scope.get(r)):n.error(`Unknown variable "${r}". Make sure "${r}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class Nr{constructor(e,n=[],r,a=new go,u=[]){this.registry=e,this.path=n,this.key=n.map(d=>`[${d}]`).join(""),this.scope=a,this.errors=u,this.expectedType=r}parse(e,n,r,a,u={}){return n?this.concat(n,r,a)._parse(e,u):this._parse(e,u)}_parse(e,n){function r(a,u,d){return d==="assert"?new rr(u,[a]):d==="coerce"?new or(u,[a]):a}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const a=e[0];if(typeof a!="string")return this.error(`Expression name must be a string, but found ${typeof a} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const u=this.registry[a];if(u){let d=u.parse(e,this);if(!d)return null;if(this.expectedType){const f=this.expectedType,g=d.type;if(f.kind!=="string"&&f.kind!=="number"&&f.kind!=="boolean"&&f.kind!=="object"&&f.kind!=="array"||g.kind!=="value")if(f.kind!=="color"&&f.kind!=="formatted"&&f.kind!=="resolvedImage"||g.kind!=="value"&&g.kind!=="string"){if(this.checkSubtype(f,g))return null}else d=r(d,f,n.typeAnnotation||"coerce");else d=r(d,f,n.typeAnnotation||"assert")}if(!(d instanceof Er)&&d.type.kind!=="resolvedImage"&&Pa(d)){const f=new Lu;try{d=new Er(d.type,d.evaluate(f))}catch(g){return this.error(g.message),null}}return d}return this.error(`Unknown expression "${a}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,n,r){const a=typeof e=="number"?this.path.concat(e):this.path,u=r?this.scope.concat(r):this.scope;return new Nr(this.registry,a,n||null,u,this.errors)}error(e,...n){const r=`${this.key}${n.map(a=>`[${a}]`).join("")}`;this.errors.push(new ri(r,e))}checkSubtype(e,n){const r=Ps(e,n);return r&&this.error(r),r}}function Pa(i){if(i instanceof bo)return Pa(i.boundExpression);if(i instanceof In&&i.name==="error"||i instanceof Ia||i instanceof vo)return!1;const e=i instanceof or||i instanceof rr;let n=!0;return i.eachChild(r=>{n=e?n&&Pa(r):n&&r instanceof Er}),!!n&&bn(i)&&Rs(i,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Os(i,e){const n=i.length-1;let r,a,u=0,d=n,f=0;for(;u<=d;)if(f=Math.floor((u+d)/2),r=i[f],a=i[f+1],r<=e){if(f===n||e<a)return f;u=f+1}else{if(!(r>e))throw new on("Input is not a number.");d=f-1}return 0}class Fs{constructor(e,n,r){this.type=e,this.input=n,this.labels=[],this.outputs=[];for(const[a,u]of r)this.labels.push(a),this.outputs.push(u)}static parse(e,n){if(e.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");const r=n.parse(e[1],1,Qe);if(!r)return null;const a=[];let u=null;n.expectedType&&n.expectedType.kind!=="value"&&(u=n.expectedType);for(let d=1;d<e.length;d+=2){const f=d===1?-1/0:e[d],g=e[d+1],v=d,w=d+1;if(typeof f!="number")return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',v);if(a.length&&a[a.length-1][0]>=f)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',v);const E=n.parse(g,w,u);if(!E)return null;u=u||E.type,a.push([f,E])}return new Fs(u,r,a)}evaluate(e){const n=this.labels,r=this.outputs;if(n.length===1)return r[0].evaluate(e);const a=this.input.evaluate(e);if(a<=n[0])return r[0].evaluate(e);const u=n.length;return a>=n[u-1]?r[u-1].evaluate(e):r[Os(n,a)].evaluate(e)}eachChild(e){e(this.input);for(const n of this.outputs)e(n)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let n=0;n<this.labels.length;n++)n>0&&e.push(this.labels[n]),e.push(this.outputs[n].serialize());return e}}function xt(i,e,n){return i*(1-n)+e*n}var Ba=Object.freeze({__proto__:null,number:xt,color:function(i,e,n){return new ii(xt(i.r,e.r,n),xt(i.g,e.g,n),xt(i.b,e.b,n),xt(i.a,e.a,n))},array:function(i,e,n){return i.map((r,a)=>xt(r,e[a],n))}});const ju=.95047,Gu=1.08883,Ql=4/29,Kl=6/29,$l=3*Kl*Kl,Zu=Math.PI/180,qu=180/Math.PI;function La(i){return i>.008856451679035631?Math.pow(i,1/3):i/$l+Ql}function Ur(i){return i>Kl?i*i*i:$l*(i-Ql)}function Qo(i){return 255*(i<=.0031308?12.92*i:1.055*Math.pow(i,1/2.4)-.055)}function Jl(i){return(i/=255)<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function Ra(i){const e=Jl(i.r),n=Jl(i.g),r=Jl(i.b),a=La((.4124564*e+.3575761*n+.1804375*r)/ju),u=La((.2126729*e+.7151522*n+.072175*r)/1);return{l:116*u-16,a:500*(a-u),b:200*(u-La((.0193339*e+.119192*n+.9503041*r)/Gu)),alpha:i.a}}function ec(i){let e=(i.l+16)/116,n=isNaN(i.a)?e:e+i.a/500,r=isNaN(i.b)?e:e-i.b/200;return e=1*Ur(e),n=ju*Ur(n),r=Gu*Ur(r),new ii(Qo(3.2404542*n-1.5371385*e-.4985314*r),Qo(-.969266*n+1.8760108*e+.041556*r),Qo(.0556434*n-.2040259*e+1.0572252*r),i.alpha)}function tp(i,e,n){const r=e-i;return i+n*(r>180||r<-180?r-360*Math.round(r/360):r)}const Ns={forward:Ra,reverse:ec,interpolate:function(i,e,n){return{l:xt(i.l,e.l,n),a:xt(i.a,e.a,n),b:xt(i.b,e.b,n),alpha:xt(i.alpha,e.alpha,n)}}},Us={forward:function(i){const{l:e,a:n,b:r}=Ra(i),a=Math.atan2(r,n)*qu;return{h:a<0?a+360:a,c:Math.sqrt(n*n+r*r),l:e,alpha:i.a}},reverse:function(i){const e=i.h*Zu,n=i.c;return ec({l:i.l,a:Math.cos(e)*n,b:Math.sin(e)*n,alpha:i.alpha})},interpolate:function(i,e,n){return{h:tp(i.h,e.h,n),c:xt(i.c,e.c,n),l:xt(i.l,e.l,n),alpha:xt(i.alpha,e.alpha,n)}}};var tc=Object.freeze({__proto__:null,lab:Ns,hcl:Us});class zn{constructor(e,n,r,a,u){this.type=e,this.operator=n,this.interpolation=r,this.input=a,this.labels=[],this.outputs=[];for(const[d,f]of u)this.labels.push(d),this.outputs.push(f)}static interpolationFactor(e,n,r,a){let u=0;if(e.name==="exponential")u=Oa(n,e.base,r,a);else if(e.name==="linear")u=Oa(n,1,r,a);else if(e.name==="cubic-bezier"){const d=e.controlPoints;u=new oe(d[0],d[1],d[2],d[3]).solve(Oa(n,1,r,a))}return u}static parse(e,n){let[r,a,u,...d]=e;if(!Array.isArray(a)||a.length===0)return n.error("Expected an interpolation type expression.",1);if(a[0]==="linear")a={name:"linear"};else if(a[0]==="exponential"){const v=a[1];if(typeof v!="number")return n.error("Exponential interpolation requires a numeric base.",1,1);a={name:"exponential",base:v}}else{if(a[0]!=="cubic-bezier")return n.error(`Unknown interpolation type ${String(a[0])}`,1,0);{const v=a.slice(1);if(v.length!==4||v.some(w=>typeof w!="number"||w<0||w>1))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);a={name:"cubic-bezier",controlPoints:v}}}if(e.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");if(u=n.parse(u,2,Qe),!u)return null;const f=[];let g=null;r==="interpolate-hcl"||r==="interpolate-lab"?g=_r:n.expectedType&&n.expectedType.kind!=="value"&&(g=n.expectedType);for(let v=0;v<d.length;v+=2){const w=d[v],E=d[v+1],M=v+3,k=v+4;if(typeof w!="number")return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',M);if(f.length&&f[f.length-1][0]>=w)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',M);const L=n.parse(E,k,g);if(!L)return null;g=g||L.type,f.push([w,L])}return g.kind==="number"||g.kind==="color"||g.kind==="array"&&g.itemType.kind==="number"&&typeof g.N=="number"?new zn(g,r,a,u,f):n.error(`Type ${Mi(g)} is not interpolatable.`)}evaluate(e){const n=this.labels,r=this.outputs;if(n.length===1)return r[0].evaluate(e);const a=this.input.evaluate(e);if(a<=n[0])return r[0].evaluate(e);const u=n.length;if(a>=n[u-1])return r[u-1].evaluate(e);const d=Os(n,a),f=zn.interpolationFactor(this.interpolation,a,n[d],n[d+1]),g=r[d].evaluate(e),v=r[d+1].evaluate(e);return this.operator==="interpolate"?Ba[this.type.kind.toLowerCase()](g,v,f):this.operator==="interpolate-hcl"?Us.reverse(Us.interpolate(Us.forward(g),Us.forward(v),f)):Ns.reverse(Ns.interpolate(Ns.forward(g),Ns.forward(v),f))}eachChild(e){e(this.input);for(const n of this.outputs)e(n)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const n=[this.operator,e,this.input.serialize()];for(let r=0;r<this.labels.length;r++)n.push(this.labels[r],this.outputs[r].serialize());return n}}function Oa(i,e,n,r){const a=r-n,u=i-n;return a===0?0:e===1?u/a:(Math.pow(e,u)-1)/(Math.pow(e,a)-1)}class Vs{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expectected at least one argument.");let r=null;const a=n.expectedType;a&&a.kind!=="value"&&(r=a);const u=[];for(const f of e.slice(1)){const g=n.parse(f,1+u.length,r,void 0,{typeAnnotation:"omit"});if(!g)return null;r=r||g.type,u.push(g)}const d=a&&u.some(f=>Ps(a,f.type));return new Vs(d?Zt:r,u)}evaluate(e){let n,r=null,a=0;for(const u of this.args){if(a++,r=u.evaluate(e),r&&r instanceof Sn&&!r.available&&(n||(n=r),r=null,a===this.args.length))return n;if(r!==null)break}return r}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(n=>{e.push(n.serialize())}),e}}class js{constructor(e,n){this.type=n.type,this.bindings=[].concat(e),this.result=n}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const n of this.bindings)e(n[1]);e(this.result)}static parse(e,n){if(e.length<4)return n.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const r=[];for(let u=1;u<e.length-1;u+=2){const d=e[u];if(typeof d!="string")return n.error(`Expected string, but found ${typeof d} instead.`,u);if(/[^a-zA-Z0-9_]/.test(d))return n.error("Variable names must contain only alphanumeric characters or '_'.",u);const f=n.parse(e[u+1],u+1);if(!f)return null;r.push([d,f])}const a=n.parse(e[e.length-1],e.length-1,n.expectedType,r);return a?new js(r,a):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[n,r]of this.bindings)e.push(n,r.serialize());return e.push(this.result.serialize()),e}}class ic{constructor(e,n,r){this.type=e,this.index=n,this.input=r}static parse(e,n){if(e.length!==3)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const r=n.parse(e[1],1,Qe),a=n.parse(e[2],2,Vn(n.expectedType||Zt));return r&&a?new ic(a.type.itemType,r,a):null}evaluate(e){const n=this.index.evaluate(e),r=this.input.evaluate(e);if(n<0)throw new on(`Array index out of bounds: ${n} < 0.`);if(n>=r.length)throw new on(`Array index out of bounds: ${n} > ${r.length-1}.`);if(n!==Math.floor(n))throw new on(`Array index must be an integer, but found ${n} instead.`);return r[n]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class Fa{constructor(e,n){this.type=Vt,this.needle=e,this.haystack=n}static parse(e,n){if(e.length!==3)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const r=n.parse(e[1],1,Zt),a=n.parse(e[2],2,Zt);return r&&a?Ca(r.type,[Vt,Ht,Qe,wr,Zt])?new Fa(r,a):n.error(`Expected first argument to be of type boolean, string, number or null, but found ${Mi(r.type)} instead`):null}evaluate(e){const n=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(r==null)return!1;if(!Wo(n,["boolean","string","number","null"]))throw new on(`Expected first argument to be of type boolean, string, number or null, but found ${Mi(ji(n))} instead.`);if(!Wo(r,["string","array"]))throw new on(`Expected second argument to be of type array or string, but found ${Mi(ji(r))} instead.`);return r.indexOf(n)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class Na{constructor(e,n,r){this.type=Qe,this.needle=e,this.haystack=n,this.fromIndex=r}static parse(e,n){if(e.length<=2||e.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const r=n.parse(e[1],1,Zt),a=n.parse(e[2],2,Zt);if(!r||!a)return null;if(!Ca(r.type,[Vt,Ht,Qe,wr,Zt]))return n.error(`Expected first argument to be of type boolean, string, number or null, but found ${Mi(r.type)} instead`);if(e.length===4){const u=n.parse(e[3],3,Qe);return u?new Na(r,a,u):null}return new Na(r,a)}evaluate(e){const n=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!Wo(n,["boolean","string","number","null"]))throw new on(`Expected first argument to be of type boolean, string, number or null, but found ${Mi(ji(n))} instead.`);if(!Wo(r,["string","array"]))throw new on(`Expected second argument to be of type array or string, but found ${Mi(ji(r))} instead.`);if(this.fromIndex){const a=this.fromIndex.evaluate(e);return r.indexOf(n,a)}return r.indexOf(n)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class Ua{constructor(e,n,r,a,u,d){this.inputType=e,this.type=n,this.input=r,this.cases=a,this.outputs=u,this.otherwise=d}static parse(e,n){if(e.length<5)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return n.error("Expected an even number of arguments.");let r,a;n.expectedType&&n.expectedType.kind!=="value"&&(a=n.expectedType);const u={},d=[];for(let v=2;v<e.length-1;v+=2){let w=e[v];const E=e[v+1];Array.isArray(w)||(w=[w]);const M=n.concat(v);if(w.length===0)return M.error("Expected at least one branch label.");for(const L of w){if(typeof L!="number"&&typeof L!="string")return M.error("Branch labels must be numbers or strings.");if(typeof L=="number"&&Math.abs(L)>Number.MAX_SAFE_INTEGER)return M.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof L=="number"&&Math.floor(L)!==L)return M.error("Numeric branch labels must be integer values.");if(r){if(M.checkSubtype(r,ji(L)))return null}else r=ji(L);if(u[String(L)]!==void 0)return M.error("Branch labels must be unique.");u[String(L)]=d.length}const k=n.parse(E,v,a);if(!k)return null;a=a||k.type,d.push(k)}const f=n.parse(e[1],1,Zt);if(!f)return null;const g=n.parse(e[e.length-1],e.length-1,a);return g?f.type.kind!=="value"&&n.concat(1).checkSubtype(r,f.type)?null:new Ua(r,a,f,u,d,g):null}evaluate(e){const n=this.input.evaluate(e);return(ji(n)===this.inputType&&this.outputs[this.cases[n]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],n=Object.keys(this.cases).sort(),r=[],a={};for(const d of n){const f=a[this.cases[d]];f===void 0?(a[this.cases[d]]=r.length,r.push([this.cases[d],[d]])):r[f][1].push(d)}const u=d=>this.inputType.kind==="number"?Number(d):d;for(const[d,f]of r)e.push(f.length===1?u(f[0]):f.map(u)),e.push(this.outputs[d].serialize());return e.push(this.otherwise.serialize()),e}}class Va{constructor(e,n,r){this.type=e,this.branches=n,this.otherwise=r}static parse(e,n){if(e.length<4)return n.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return n.error("Expected an odd number of arguments.");let r;n.expectedType&&n.expectedType.kind!=="value"&&(r=n.expectedType);const a=[];for(let d=1;d<e.length-1;d+=2){const f=n.parse(e[d],d,Vt);if(!f)return null;const g=n.parse(e[d+1],d+1,r);if(!g)return null;a.push([f,g]),r=r||g.type}const u=n.parse(e[e.length-1],e.length-1,r);return u?new Va(r,a,u):null}evaluate(e){for(const[n,r]of this.branches)if(n.evaluate(e))return r.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[n,r]of this.branches)e(n),e(r);e(this.otherwise)}outputDefined(){return this.branches.every(([e,n])=>n.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(n=>{e.push(n.serialize())}),e}}class ja{constructor(e,n,r,a){this.type=e,this.input=n,this.beginIndex=r,this.endIndex=a}static parse(e,n){if(e.length<=2||e.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const r=n.parse(e[1],1,Zt),a=n.parse(e[2],2,Qe);if(!r||!a)return null;if(!Ca(r.type,[Vn(Zt),Ht,Zt]))return n.error(`Expected first argument to be of type array or string, but found ${Mi(r.type)} instead`);if(e.length===4){const u=n.parse(e[3],3,Qe);return u?new ja(r.type,r,a,u):null}return new ja(r.type,r,a)}evaluate(e){const n=this.input.evaluate(e),r=this.beginIndex.evaluate(e);if(!Wo(n,["string","array"]))throw new on(`Expected first argument to be of type array or string, but found ${Mi(ji(n))} instead.`);if(this.endIndex){const a=this.endIndex.evaluate(e);return n.slice(r,a)}return n.slice(r)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function Wu(i,e){return i==="=="||i==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function Hu(i,e,n,r){return r.compare(e,n)===0}function Ko(i,e,n){const r=i!=="=="&&i!=="!=";return class z0{constructor(u,d,f){this.type=Vt,this.lhs=u,this.rhs=d,this.collator=f,this.hasUntypedArgument=u.type.kind==="value"||d.type.kind==="value"}static parse(u,d){if(u.length!==3&&u.length!==4)return d.error("Expected two or three arguments.");const f=u[0];let g=d.parse(u[1],1,Zt);if(!g)return null;if(!Wu(f,g.type))return d.concat(1).error(`"${f}" comparisons are not supported for type '${Mi(g.type)}'.`);let v=d.parse(u[2],2,Zt);if(!v)return null;if(!Wu(f,v.type))return d.concat(2).error(`"${f}" comparisons are not supported for type '${Mi(v.type)}'.`);if(g.type.kind!==v.type.kind&&g.type.kind!=="value"&&v.type.kind!=="value")return d.error(`Cannot compare types '${Mi(g.type)}' and '${Mi(v.type)}'.`);r&&(g.type.kind==="value"&&v.type.kind!=="value"?g=new rr(v.type,[g]):g.type.kind!=="value"&&v.type.kind==="value"&&(v=new rr(g.type,[v])));let w=null;if(u.length===4){if(g.type.kind!=="string"&&v.type.kind!=="string"&&g.type.kind!=="value"&&v.type.kind!=="value")return d.error("Cannot use collator to compare non-string types.");if(w=d.parse(u[3],3,xo),!w)return null}return new z0(g,v,w)}evaluate(u){const d=this.lhs.evaluate(u),f=this.rhs.evaluate(u);if(r&&this.hasUntypedArgument){const g=ji(d),v=ji(f);if(g.kind!==v.kind||g.kind!=="string"&&g.kind!=="number")throw new on(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${g.kind}, ${v.kind}) instead.`)}if(this.collator&&!r&&this.hasUntypedArgument){const g=ji(d),v=ji(f);if(g.kind!=="string"||v.kind!=="string")return e(u,d,f)}return this.collator?n(u,d,f,this.collator.evaluate(u)):e(u,d,f)}eachChild(u){u(this.lhs),u(this.rhs),this.collator&&u(this.collator)}outputDefined(){return!0}serialize(){const u=[i];return this.eachChild(d=>{u.push(d.serialize())}),u}}}const ip=Ko("==",function(i,e,n){return e===n},Hu),np=Ko("!=",function(i,e,n){return e!==n},function(i,e,n,r){return!Hu(0,e,n,r)}),Yu=Ko("<",function(i,e,n){return e<n},function(i,e,n,r){return r.compare(e,n)<0}),rp=Ko(">",function(i,e,n){return e>n},function(i,e,n,r){return r.compare(e,n)>0}),op=Ko("<=",function(i,e,n){return e<=n},function(i,e,n,r){return r.compare(e,n)<=0}),sp=Ko(">=",function(i,e,n){return e>=n},function(i,e,n,r){return r.compare(e,n)>=0});class nc{constructor(e,n,r,a,u){this.type=Ht,this.number=e,this.locale=n,this.currency=r,this.minFractionDigits=a,this.maxFractionDigits=u}static parse(e,n){if(e.length!==3)return n.error("Expected two arguments.");const r=n.parse(e[1],1,Qe);if(!r)return null;const a=e[2];if(typeof a!="object"||Array.isArray(a))return n.error("NumberFormat options argument must be an object.");let u=null;if(a.locale&&(u=n.parse(a.locale,1,Ht),!u))return null;let d=null;if(a.currency&&(d=n.parse(a.currency,1,Ht),!d))return null;let f=null;if(a["min-fraction-digits"]&&(f=n.parse(a["min-fraction-digits"],1,Qe),!f))return null;let g=null;return a["max-fraction-digits"]&&(g=n.parse(a["max-fraction-digits"],1,Qe),!g)?null:new nc(r,u,d,f,g)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class Ga{constructor(e){this.type=Qe,this.input=e}static parse(e,n){if(e.length!==2)return n.error(`Expected 1 argument, but found ${e.length-1} instead.`);const r=n.parse(e[1],1);return r?r.type.kind!=="array"&&r.type.kind!=="string"&&r.type.kind!=="value"?n.error(`Expected argument of type string or array, but found ${Mi(r.type)} instead.`):new Ga(r):null}evaluate(e){const n=this.input.evaluate(e);if(typeof n=="string"||Array.isArray(n))return n.length;throw new on(`Expected value to be of type string or array, but found ${Mi(ji(n))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(n=>{e.push(n.serialize())}),e}}const Ao={"==":ip,"!=":np,">":rp,"<":Yu,">=":sp,"<=":op,array:rr,at:ic,boolean:rr,case:Va,coalesce:Vs,collator:Ia,format:Yo,image:Xo,in:Fa,"index-of":Na,interpolate:zn,"interpolate-hcl":zn,"interpolate-lab":zn,length:Ga,let:js,literal:Er,match:Ua,number:rr,"number-format":nc,object:rr,slice:ja,step:Fs,string:rr,"to-boolean":or,"to-color":or,"to-number":or,"to-string":or,var:bo,within:vo};function rc(i,[e,n,r,a]){e=e.evaluate(i),n=n.evaluate(i),r=r.evaluate(i);const u=a?a.evaluate(i):1,d=nr(e,n,r,u);if(d)throw new on(d);return new ii(e/255*u,n/255*u,r/255*u,u)}function Xu(i,e){return i in e}function oc(i,e){const n=e[i];return n===void 0?null:n}function Vr(i){return{type:i}}function sc(i){return{result:"success",value:i}}function wo(i){return{result:"error",value:i}}function $o(i){return i["property-type"]==="data-driven"||i["property-type"]==="cross-faded-data-driven"}function Qu(i){return!!i.expression&&i.expression.parameters.indexOf("zoom")>-1}function ac(i){return!!i.expression&&i.expression.interpolated}function ui(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}function To(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}function Ku(i){return i}function lc(i,e){const n=e.type==="color",r=i.stops&&typeof i.stops[0][0]=="object",a=r||!(r||i.property!==void 0),u=i.type||(ac(e)?"exponential":"interval");if(n&&((i=ni({},i)).stops&&(i.stops=i.stops.map(v=>[v[0],ii.parse(v[1])])),i.default=ii.parse(i.default?i.default:e.default)),i.colorSpace&&i.colorSpace!=="rgb"&&!tc[i.colorSpace])throw new Error(`Unknown color space: ${i.colorSpace}`);let d,f,g;if(u==="exponential")d=cc;else if(u==="interval")d=lp;else if(u==="categorical"){d=ap,f=Object.create(null);for(const v of i.stops)f[v[0]]=v[1];g=typeof i.stops[0][0]}else{if(u!=="identity")throw new Error(`Unknown function type "${u}"`);d=$u}if(r){const v={},w=[];for(let k=0;k<i.stops.length;k++){const L=i.stops[k],F=L[0].zoom;v[F]===void 0&&(v[F]={zoom:F,type:i.type,property:i.property,default:i.default,stops:[]},w.push(F)),v[F].stops.push([L[0].value,L[1]])}const E=[];for(const k of w)E.push([v[k].zoom,lc(v[k],e)]);const M={name:"linear"};return{kind:"composite",interpolationType:M,interpolationFactor:zn.interpolationFactor.bind(void 0,M),zoomStops:E.map(k=>k[0]),evaluate:({zoom:k},L)=>cc({stops:E,base:i.base},e,k).evaluate(k,L)}}if(a){const v=u==="exponential"?{name:"exponential",base:i.base!==void 0?i.base:1}:null;return{kind:"camera",interpolationType:v,interpolationFactor:zn.interpolationFactor.bind(void 0,v),zoomStops:i.stops.map(w=>w[0]),evaluate:({zoom:w})=>d(i,e,w,f,g)}}return{kind:"source",evaluate(v,w){const E=w&&w.properties?w.properties[i.property]:void 0;return E===void 0?Gs(i.default,e.default):d(i,e,E,f,g)}}}function Gs(i,e,n){return i!==void 0?i:e!==void 0?e:n!==void 0?n:void 0}function ap(i,e,n,r,a){return Gs(typeof n===a?r[n]:void 0,i.default,e.default)}function lp(i,e,n){if(ui(n)!=="number")return Gs(i.default,e.default);const r=i.stops.length;if(r===1||n<=i.stops[0][0])return i.stops[0][1];if(n>=i.stops[r-1][0])return i.stops[r-1][1];const a=Os(i.stops.map(u=>u[0]),n);return i.stops[a][1]}function cc(i,e,n){const r=i.base!==void 0?i.base:1;if(ui(n)!=="number")return Gs(i.default,e.default);const a=i.stops.length;if(a===1||n<=i.stops[0][0])return i.stops[0][1];if(n>=i.stops[a-1][0])return i.stops[a-1][1];const u=Os(i.stops.map(w=>w[0]),n),d=function(w,E,M,k){const L=k-M,F=w-M;return L===0?0:E===1?F/L:(Math.pow(E,F)-1)/(Math.pow(E,L)-1)}(n,r,i.stops[u][0],i.stops[u+1][0]),f=i.stops[u][1],g=i.stops[u+1][1];let v=Ba[e.type]||Ku;if(i.colorSpace&&i.colorSpace!=="rgb"){const w=tc[i.colorSpace];v=(E,M)=>w.reverse(w.interpolate(w.forward(E),w.forward(M),d))}return typeof f.evaluate=="function"?{evaluate(...w){const E=f.evaluate.apply(void 0,w),M=g.evaluate.apply(void 0,w);if(E!==void 0&&M!==void 0)return v(E,M,d)}}:v(f,g,d)}function $u(i,e,n){return e.type==="color"?n=ii.parse(n):e.type==="formatted"?n=Hi.fromString(n.toString()):e.type==="resolvedImage"?n=Sn.fromString(n.toString()):ui(n)===e.type||e.type==="enum"&&e.values[n]||(n=void 0),Gs(n,i.default,e.default)}In.register(Ao,{error:[{kind:"error"},[Ht],(i,[e])=>{throw new on(e.evaluate(i))}],typeof:[Ht,[Zt],(i,[e])=>Mi(ji(e.evaluate(i)))],"to-rgba":[Vn(Qe,4),[_r],(i,[e])=>e.evaluate(i).toArray()],rgb:[_r,[Qe,Qe,Qe],rc],rgba:[_r,[Qe,Qe,Qe,Qe],rc],has:{type:Vt,overloads:[[[Ht],(i,[e])=>Xu(e.evaluate(i),i.properties())],[[Ht,yo],(i,[e,n])=>Xu(e.evaluate(i),n.evaluate(i))]]},get:{type:Zt,overloads:[[[Ht],(i,[e])=>oc(e.evaluate(i),i.properties())],[[Ht,yo],(i,[e,n])=>oc(e.evaluate(i),n.evaluate(i))]]},"feature-state":[Zt,[Ht],(i,[e])=>oc(e.evaluate(i),i.featureState||{})],properties:[yo,[],i=>i.properties()],"geometry-type":[Ht,[],i=>i.geometryType()],id:[Zt,[],i=>i.id()],zoom:[Qe,[],i=>i.globals.zoom],pitch:[Qe,[],i=>i.globals.pitch||0],"distance-from-center":[Qe,[],i=>i.distanceFromCenter()],"heatmap-density":[Qe,[],i=>i.globals.heatmapDensity||0],"line-progress":[Qe,[],i=>i.globals.lineProgress||0],"sky-radial-progress":[Qe,[],i=>i.globals.skyRadialProgress||0],accumulated:[Zt,[],i=>i.globals.accumulated===void 0?null:i.globals.accumulated],"+":[Qe,Vr(Qe),(i,e)=>{let n=0;for(const r of e)n+=r.evaluate(i);return n}],"*":[Qe,Vr(Qe),(i,e)=>{let n=1;for(const r of e)n*=r.evaluate(i);return n}],"-":{type:Qe,overloads:[[[Qe,Qe],(i,[e,n])=>e.evaluate(i)-n.evaluate(i)],[[Qe],(i,[e])=>-e.evaluate(i)]]},"/":[Qe,[Qe,Qe],(i,[e,n])=>e.evaluate(i)/n.evaluate(i)],"%":[Qe,[Qe,Qe],(i,[e,n])=>e.evaluate(i)%n.evaluate(i)],ln2:[Qe,[],()=>Math.LN2],pi:[Qe,[],()=>Math.PI],e:[Qe,[],()=>Math.E],"^":[Qe,[Qe,Qe],(i,[e,n])=>Math.pow(e.evaluate(i),n.evaluate(i))],sqrt:[Qe,[Qe],(i,[e])=>Math.sqrt(e.evaluate(i))],log10:[Qe,[Qe],(i,[e])=>Math.log(e.evaluate(i))/Math.LN10],ln:[Qe,[Qe],(i,[e])=>Math.log(e.evaluate(i))],log2:[Qe,[Qe],(i,[e])=>Math.log(e.evaluate(i))/Math.LN2],sin:[Qe,[Qe],(i,[e])=>Math.sin(e.evaluate(i))],cos:[Qe,[Qe],(i,[e])=>Math.cos(e.evaluate(i))],tan:[Qe,[Qe],(i,[e])=>Math.tan(e.evaluate(i))],asin:[Qe,[Qe],(i,[e])=>Math.asin(e.evaluate(i))],acos:[Qe,[Qe],(i,[e])=>Math.acos(e.evaluate(i))],atan:[Qe,[Qe],(i,[e])=>Math.atan(e.evaluate(i))],min:[Qe,Vr(Qe),(i,e)=>Math.min(...e.map(n=>n.evaluate(i)))],max:[Qe,Vr(Qe),(i,e)=>Math.max(...e.map(n=>n.evaluate(i)))],abs:[Qe,[Qe],(i,[e])=>Math.abs(e.evaluate(i))],round:[Qe,[Qe],(i,[e])=>{const n=e.evaluate(i);return n<0?-Math.round(-n):Math.round(n)}],floor:[Qe,[Qe],(i,[e])=>Math.floor(e.evaluate(i))],ceil:[Qe,[Qe],(i,[e])=>Math.ceil(e.evaluate(i))],"filter-==":[Vt,[Ht,Zt],(i,[e,n])=>i.properties()[e.value]===n.value],"filter-id-==":[Vt,[Zt],(i,[e])=>i.id()===e.value],"filter-type-==":[Vt,[Ht],(i,[e])=>i.geometryType()===e.value],"filter-<":[Vt,[Ht,Zt],(i,[e,n])=>{const r=i.properties()[e.value],a=n.value;return typeof r==typeof a&&r<a}],"filter-id-<":[Vt,[Zt],(i,[e])=>{const n=i.id(),r=e.value;return typeof n==typeof r&&n<r}],"filter->":[Vt,[Ht,Zt],(i,[e,n])=>{const r=i.properties()[e.value],a=n.value;return typeof r==typeof a&&r>a}],"filter-id->":[Vt,[Zt],(i,[e])=>{const n=i.id(),r=e.value;return typeof n==typeof r&&n>r}],"filter-<=":[Vt,[Ht,Zt],(i,[e,n])=>{const r=i.properties()[e.value],a=n.value;return typeof r==typeof a&&r<=a}],"filter-id-<=":[Vt,[Zt],(i,[e])=>{const n=i.id(),r=e.value;return typeof n==typeof r&&n<=r}],"filter->=":[Vt,[Ht,Zt],(i,[e,n])=>{const r=i.properties()[e.value],a=n.value;return typeof r==typeof a&&r>=a}],"filter-id->=":[Vt,[Zt],(i,[e])=>{const n=i.id(),r=e.value;return typeof n==typeof r&&n>=r}],"filter-has":[Vt,[Zt],(i,[e])=>e.value in i.properties()],"filter-has-id":[Vt,[],i=>i.id()!==null&&i.id()!==void 0],"filter-type-in":[Vt,[Vn(Ht)],(i,[e])=>e.value.indexOf(i.geometryType())>=0],"filter-id-in":[Vt,[Vn(Zt)],(i,[e])=>e.value.indexOf(i.id())>=0],"filter-in-small":[Vt,[Ht,Vn(Zt)],(i,[e,n])=>n.value.indexOf(i.properties()[e.value])>=0],"filter-in-large":[Vt,[Ht,Vn(Zt)],(i,[e,n])=>function(r,a,u,d){for(;u<=d;){const f=u+d>>1;if(a[f]===r)return!0;a[f]>r?d=f-1:u=f+1}return!1}(i.properties()[e.value],n.value,0,n.value.length-1)],all:{type:Vt,overloads:[[[Vt,Vt],(i,[e,n])=>e.evaluate(i)&&n.evaluate(i)],[Vr(Vt),(i,e)=>{for(const n of e)if(!n.evaluate(i))return!1;return!0}]]},any:{type:Vt,overloads:[[[Vt,Vt],(i,[e,n])=>e.evaluate(i)||n.evaluate(i)],[Vr(Vt),(i,e)=>{for(const n of e)if(n.evaluate(i))return!0;return!1}]]},"!":[Vt,[Vt],(i,[e])=>!e.evaluate(i)],"is-supported-script":[Vt,[Ht],(i,[e])=>{const n=i.globals&&i.globals.isSupportedScript;return!n||n(e.evaluate(i))}],upcase:[Ht,[Ht],(i,[e])=>e.evaluate(i).toUpperCase()],downcase:[Ht,[Ht],(i,[e])=>e.evaluate(i).toLowerCase()],concat:[Ht,Vr(Zt),(i,e)=>e.map(n=>Tr(n.evaluate(i))).join("")],"resolved-locale":[Ht,[xo],(i,[e])=>e.evaluate(i).resolvedLocale()]});class Za{constructor(e,n){this.expression=e,this._warningHistory={},this._evaluator=new Lu,this._defaultValue=n?function(r){return r.type==="color"&&To(r.default)?new ii(0,0,0,0):r.type==="color"?ii.parse(r.default)||null:r.default===void 0?null:r.default}(n):null,this._enumValues=n&&n.type==="enum"?n.values:null}evaluateWithoutErrorHandling(e,n,r,a,u,d,f,g){return this._evaluator.globals=e,this._evaluator.feature=n,this._evaluator.featureState=r,this._evaluator.canonical=a||null,this._evaluator.availableImages=u||null,this._evaluator.formattedSection=d,this._evaluator.featureTileCoord=f||null,this._evaluator.featureDistanceData=g||null,this.expression.evaluate(this._evaluator)}evaluate(e,n,r,a,u,d,f,g){this._evaluator.globals=e,this._evaluator.feature=n||null,this._evaluator.featureState=r||null,this._evaluator.canonical=a||null,this._evaluator.availableImages=u||null,this._evaluator.formattedSection=d||null,this._evaluator.featureTileCoord=f||null,this._evaluator.featureDistanceData=g||null;try{const v=this.expression.evaluate(this._evaluator);if(v==null||typeof v=="number"&&v!=v)return this._defaultValue;if(this._enumValues&&!(v in this._enumValues))throw new on(`Expected value to be one of ${Object.keys(this._enumValues).map(w=>JSON.stringify(w)).join(", ")}, but found ${JSON.stringify(v)} instead.`);return v}catch(v){return this._warningHistory[v.message]||(this._warningHistory[v.message]=!0,typeof console!="undefined"&&console.warn(v.message)),this._defaultValue}}}function Jo(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in Ao}function Zs(i,e){const n=new Nr(Ao,[],e?function(a){const u={color:_r,string:Ht,number:Qe,enum:Ht,boolean:Vt,formatted:qo,resolvedImage:fn};return a.type==="array"?Vn(u[a.value]||Zt,a.length):u[a.type]}(e):void 0),r=n.parse(i,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return r?sc(new Za(r,e)):wo(n.errors)}class uc{constructor(e,n){this.kind=e,this._styleExpression=n,this.isStateDependent=e!=="constant"&&!Ls(n.expression)}evaluateWithoutErrorHandling(e,n,r,a,u,d){return this._styleExpression.evaluateWithoutErrorHandling(e,n,r,a,u,d)}evaluate(e,n,r,a,u,d){return this._styleExpression.evaluate(e,n,r,a,u,d)}}class hc{constructor(e,n,r,a){this.kind=e,this.zoomStops=r,this._styleExpression=n,this.isStateDependent=e!=="camera"&&!Ls(n.expression),this.interpolationType=a}evaluateWithoutErrorHandling(e,n,r,a,u,d){return this._styleExpression.evaluateWithoutErrorHandling(e,n,r,a,u,d)}evaluate(e,n,r,a,u,d){return this._styleExpression.evaluate(e,n,r,a,u,d)}interpolationFactor(e,n,r){return this.interpolationType?zn.interpolationFactor(this.interpolationType,e,n,r):0}}function Ju(i,e){if((i=Zs(i,e)).result==="error")return i;const n=i.value.expression,r=bn(n);if(!r&&!$o(e))return wo([new ri("","data expressions not supported")]);const a=Rs(n,["zoom","pitch","distance-from-center"]);if(!a&&!Qu(e))return wo([new ri("","zoom expressions not supported")]);const u=Wa(n);return u||a?u instanceof ri?wo([u]):u instanceof zn&&!ac(e)?wo([new ri("",'"interpolate" expressions cannot be used with this property')]):sc(u?new hc(r?"camera":"composite",i.value,u.labels,u instanceof zn?u.interpolation:void 0):new uc(r?"constant":"source",i.value)):wo([new ri("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class qa{constructor(e,n){this._parameters=e,this._specification=n,ni(this,lc(this._parameters,this._specification))}static deserialize(e){return new qa(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function Wa(i){let e=null;if(i instanceof js)e=Wa(i.result);else if(i instanceof Vs){for(const n of i.args)if(e=Wa(n),e)break}else(i instanceof Fs||i instanceof zn)&&i.input instanceof In&&i.input.name==="zoom"&&(e=i);return e instanceof ri||i.eachChild(n=>{const r=Wa(n);r instanceof ri?e=r:!e&&r?e=new ri("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&r&&e!==r&&(e=new ri("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}class et{constructor(e,n,r,a){this.message=(e?`${e}: `:"")+r,a&&(this.identifier=a),n!=null&&n.__line__&&(this.line=n.__line__)}}function jn(i){const e=i.key,n=i.value,r=i.valueSpec||{},a=i.objectElementValidators||{},u=i.style,d=i.styleSpec;let f=[];const g=ui(n);if(g!=="object")return[new et(e,n,`object expected, ${g} found`)];for(const v in n){const w=v.split(".")[0],E=r[w]||r["*"];let M;a[w]?M=a[w]:r[w]?M=Ki:a["*"]?M=a["*"]:r["*"]&&(M=Ki),M?f=f.concat(M({key:(e&&`${e}.`)+v,value:n[v],valueSpec:E,style:u,styleSpec:d,object:n,objectKey:v},n)):f.push(new et(e,n[v],`unknown property "${v}"`))}for(const v in r)a[v]||r[v].required&&r[v].default===void 0&&n[v]===void 0&&f.push(new et(e,n,`missing required property "${v}"`));return f}function qs(i){const e=i.value,n=i.valueSpec,r=i.style,a=i.styleSpec,u=i.key,d=i.arrayElementValidator||Ki;if(ui(e)!=="array")return[new et(u,e,`array expected, ${ui(e)} found`)];if(n.length&&e.length!==n.length)return[new et(u,e,`array length ${n.length} expected, length ${e.length} found`)];if(n["min-length"]&&e.length<n["min-length"])return[new et(u,e,`array length at least ${n["min-length"]} expected, length ${e.length} found`)];let f={type:n.value,values:n.values,minimum:n.minimum,maximum:n.maximum,function:void 0};a.$version<7&&(f.function=n.function),ui(n.value)==="object"&&(f=n.value);let g=[];for(let v=0;v<e.length;v++)g=g.concat(d({array:e,arrayIndex:v,value:e[v],valueSpec:f,style:r,styleSpec:a,key:`${u}[${v}]`}));return g}function eh(i){const e=i.key,n=i.value,r=i.valueSpec;let a=ui(n);if(a==="number"&&n!=n&&(a="NaN"),a!=="number")return[new et(e,n,`number expected, ${a} found`)];if("minimum"in r){let u=r.minimum;if(ui(r.minimum)==="array"&&(u=r.minimum[i.arrayIndex]),n<u)return[new et(e,n,`${n} is less than the minimum value ${u}`)]}if("maximum"in r){let u=r.maximum;if(ui(r.maximum)==="array"&&(u=r.maximum[i.arrayIndex]),n>u)return[new et(e,n,`${n} is greater than the maximum value ${u}`)]}return[]}function th(i){const e=i.valueSpec,n=ct(i.value.type);let r,a,u,d={};const f=n!=="categorical"&&i.value.property===void 0,g=!f,v=ui(i.value.stops)==="array"&&ui(i.value.stops[0])==="array"&&ui(i.value.stops[0][0])==="object",w=jn({key:i.key,value:i.value,valueSpec:i.styleSpec.function,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:function(k){if(n==="identity")return[new et(k.key,k.value,'identity function may not have a "stops" property')];let L=[];const F=k.value;return L=L.concat(qs({key:k.key,value:F,valueSpec:k.valueSpec,style:k.style,styleSpec:k.styleSpec,arrayElementValidator:E})),ui(F)==="array"&&F.length===0&&L.push(new et(k.key,F,"array must have at least one stop")),L},default:function(k){return Ki({key:k.key,value:k.value,valueSpec:e,style:k.style,styleSpec:k.styleSpec})}}});return n==="identity"&&f&&w.push(new et(i.key,i.value,'missing required property "property"')),n==="identity"||i.value.stops||w.push(new et(i.key,i.value,'missing required property "stops"')),n==="exponential"&&i.valueSpec.expression&&!ac(i.valueSpec)&&w.push(new et(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(g&&!$o(i.valueSpec)?w.push(new et(i.key,i.value,"property functions not supported")):f&&!Qu(i.valueSpec)&&w.push(new et(i.key,i.value,"zoom functions not supported"))),n!=="categorical"&&!v||i.value.property!==void 0||w.push(new et(i.key,i.value,'"property" property is required')),w;function E(k){let L=[];const F=k.value,j=k.key;if(ui(F)!=="array")return[new et(j,F,`array expected, ${ui(F)} found`)];if(F.length!==2)return[new et(j,F,`array length 2 expected, length ${F.length} found`)];if(v){if(ui(F[0])!=="object")return[new et(j,F,`object expected, ${ui(F[0])} found`)];if(F[0].zoom===void 0)return[new et(j,F,"object stop key must have zoom")];if(F[0].value===void 0)return[new et(j,F,"object stop key must have value")];const H=ct(F[0].zoom);if(typeof H!="number")return[new et(j,F[0].zoom,"stop zoom values must be numbers")];if(u&&u>H)return[new et(j,F[0].zoom,"stop zoom values must appear in ascending order")];H!==u&&(u=H,a=void 0,d={}),L=L.concat(jn({key:`${j}[0]`,value:F[0],valueSpec:{zoom:{}},style:k.style,styleSpec:k.styleSpec,objectElementValidators:{zoom:eh,value:M}}))}else L=L.concat(M({key:`${j}[0]`,value:F[0],valueSpec:{},style:k.style,styleSpec:k.styleSpec},F));return Jo(ti(F[1]))?L.concat([new et(`${j}[1]`,F[1],"expressions are not allowed in function stops.")]):L.concat(Ki({key:`${j}[1]`,value:F[1],valueSpec:e,style:k.style,styleSpec:k.styleSpec}))}function M(k,L){const F=ui(k.value),j=ct(k.value),H=k.value!==null?k.value:L;if(r){if(F!==r)return[new et(k.key,H,`${F} stop domain type must match previous stop domain type ${r}`)]}else r=F;if(F!=="number"&&F!=="string"&&F!=="boolean"&&typeof j!="number"&&typeof j!="string"&&typeof j!="boolean")return[new et(k.key,H,"stop domain value must be a number, string, or boolean")];if(F!=="number"&&n!=="categorical"){let ne=`number expected, ${F} found`;return $o(e)&&n===void 0&&(ne+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new et(k.key,H,ne)]}return n!=="categorical"||F!=="number"||typeof j=="number"&&isFinite(j)&&Math.floor(j)===j?n!=="categorical"&&F==="number"&&typeof j=="number"&&typeof a=="number"&&a!==void 0&&j<a?[new et(k.key,H,"stop domain values must appear in ascending order")]:(a=j,n==="categorical"&&j in d?[new et(k.key,H,"stop domain values must be unique")]:(d[j]=!0,[])):[new et(k.key,H,`integer expected, found ${String(j)}`)]}}function es(i){const e=(i.expressionContext==="property"?Ju:Zs)(ti(i.value),i.valueSpec);if(e.result==="error")return e.value.map(r=>new et(`${i.key}${r.key}`,i.value,r.message));const n=e.value.expression||e.value._styleExpression.expression;if(i.expressionContext==="property"&&i.propertyKey==="text-font"&&!n.outputDefined())return[new et(i.key,i.value,`Invalid data expression for "${i.propertyKey}". Output values must be contained as literals within the expression.`)];if(i.expressionContext==="property"&&i.propertyType==="layout"&&!Ls(n))return[new et(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if(i.expressionContext==="filter")return Cr(n,i);if(i.expressionContext&&i.expressionContext.indexOf("cluster")===0){if(!Rs(n,["zoom","feature-state"]))return[new et(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(i.expressionContext==="cluster-initial"&&!bn(n))return[new et(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Cr(i,e){const n=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(e.valueSpec&&e.valueSpec.expression)for(const a of e.valueSpec.expression.parameters)n.delete(a);if(n.size===0)return[];const r=[];return i instanceof In&&n.has(i.name)?[new et(e.key,e.value,`["${i.name}"] expression is not supported in a filter for a ${e.object.type} layer with id: ${e.object.id}`)]:(i.eachChild(a=>{r.push(...Cr(a,e))}),r)}function Ws(i){const e=i.key,n=i.value,r=i.valueSpec,a=[];return Array.isArray(r.values)?r.values.indexOf(ct(n))===-1&&a.push(new et(e,n,`expected one of [${r.values.join(", ")}], ${JSON.stringify(n)} found`)):Object.keys(r.values).indexOf(ct(n))===-1&&a.push(new et(e,n,`expected one of [${Object.keys(r.values).join(", ")}], ${JSON.stringify(n)} found`)),a}function jr(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(const e of i.slice(1))if(!jr(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}function Gr(i,e="fill"){if(i==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};jr(i)||(i=Hs(i));const n=i;let r=!0;try{r=function(v){if(!Zr(v))return v;let w=ti(v);return ih(w),w=dc(w),w}(n)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(n,null,2)}
        `)}const a=ve[`filter_${e}`],u=Zs(r,a);let d=null;if(u.result==="error")throw new Error(u.value.map(v=>`${v.key}: ${v.message}`).join(", "));d=(v,w,E)=>u.value.evaluate(v,w,{},E);let f=null,g=null;if(r!==n){const v=Zs(n,a);if(v.result==="error")throw new Error(v.value.map(w=>`${w.key}: ${w.message}`).join(", "));f=(w,E,M,k,L)=>v.value.evaluate(w,E,{},M,void 0,void 0,k,L),g=!bn(v.value.expression)}return d=d,{filter:d,dynamicFilter:f||void 0,needGeometry:Ha(r),needFeature:!!g}}function dc(i){if(!Array.isArray(i))return i;const e=function(n){if(nh.has(n[0])){for(let r=1;r<n.length;r++)if(Zr(n[r]))return!0}return n}(i);return e===!0?e:e.map(n=>dc(n))}function ih(i){let e=!1;const n=[];if(i[0]==="case"){for(let r=1;r<i.length-1;r+=2)e=e||Zr(i[r]),n.push(i[r+1]);n.push(i[i.length-1])}else if(i[0]==="match"){e=e||Zr(i[1]);for(let r=2;r<i.length-1;r+=2)n.push(i[r+1]);n.push(i[i.length-1])}else if(i[0]==="step"){e=e||Zr(i[1]);for(let r=1;r<i.length-1;r+=2)n.push(i[r+1])}e&&(i.length=0,i.push("any",...n));for(let r=1;r<i.length;r++)ih(i[r])}function Zr(i){if(!Array.isArray(i))return!1;if((e=i[0])==="pitch"||e==="distance-from-center")return!0;var e;for(let n=1;n<i.length;n++)if(Zr(i[n]))return!0;return!1}const nh=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function pc(i,e){return i<e?-1:i>e?1:0}function Ha(i){if(!Array.isArray(i))return!1;if(i[0]==="within")return!0;for(let e=1;e<i.length;e++)if(Ha(i[e]))return!0;return!1}function Hs(i){if(!i)return!0;const e=i[0];return i.length<=1?e!=="any":e==="=="?Ys(i[1],i[2],"=="):e==="!="?Xs(Ys(i[1],i[2],"==")):e==="<"||e===">"||e==="<="||e===">="?Ys(i[1],i[2],e):e==="any"?(n=i.slice(1),["any"].concat(n.map(Hs))):e==="all"?["all"].concat(i.slice(1).map(Hs)):e==="none"?["all"].concat(i.slice(1).map(Hs).map(Xs)):e==="in"?fc(i[1],i.slice(2)):e==="!in"?Xs(fc(i[1],i.slice(2))):e==="has"?mc(i[1]):e==="!has"?Xs(mc(i[1])):e!=="within"||i;var n}function Ys(i,e,n){switch(i){case"$type":return[`filter-type-${n}`,e];case"$id":return[`filter-id-${n}`,e];default:return[`filter-${n}`,i,e]}}function fc(i,e){if(e.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(n=>typeof n!=typeof e[0])?["filter-in-large",i,["literal",e.sort(pc)]]:["filter-in-small",i,["literal",e]]}}function mc(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}function Xs(i){return["!",i]}function qr(i){return jr(ti(i.value))?es(ni({},i,{expressionContext:"filter",valueSpec:i.styleSpec[`filter_${i.layerType||"fill"}`]})):_c(i)}function _c(i){const e=i.value,n=i.key;if(ui(e)!=="array")return[new et(n,e,`array expected, ${ui(e)} found`)];const r=i.styleSpec;let a,u=[];if(e.length<1)return[new et(n,e,"filter array must have at least 1 element")];switch(u=u.concat(Ws({key:`${n}[0]`,value:e[0],valueSpec:r.filter_operator,style:i.style,styleSpec:i.styleSpec})),ct(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&ct(e[1])==="$type"&&u.push(new et(n,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&u.push(new et(n,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(a=ui(e[1]),a!=="string"&&u.push(new et(`${n}[1]`,e[1],`string expected, ${a} found`)));for(let d=2;d<e.length;d++)a=ui(e[d]),ct(e[1])==="$type"?u=u.concat(Ws({key:`${n}[${d}]`,value:e[d],valueSpec:r.geometry_type,style:i.style,styleSpec:i.styleSpec})):a!=="string"&&a!=="number"&&a!=="boolean"&&u.push(new et(`${n}[${d}]`,e[d],`string, number, or boolean expected, ${a} found`));break;case"any":case"all":case"none":for(let d=1;d<e.length;d++)u=u.concat(_c({key:`${n}[${d}]`,value:e[d],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":a=ui(e[1]),e.length!==2?u.push(new et(n,e,`filter array for "${e[0]}" operator must have 2 elements`)):a!=="string"&&u.push(new et(`${n}[1]`,e[1],`string expected, ${a} found`));break;case"within":a=ui(e[1]),e.length!==2?u.push(new et(n,e,`filter array for "${e[0]}" operator must have 2 elements`)):a!=="object"&&u.push(new et(`${n}[1]`,e[1],`object expected, ${a} found`))}return u}function gc(i,e){const n=i.key,r=i.style,a=i.styleSpec,u=i.value,d=i.objectKey,f=a[`${e}_${i.layerType}`];if(!f)return[];const g=d.match(/^(.*)-transition$/);if(e==="paint"&&g&&f[g[1]]&&f[g[1]].transition)return Ki({key:n,value:u,valueSpec:a.transition,style:r,styleSpec:a});const v=i.valueSpec||f[d];if(!v)return[new et(n,u,`unknown property "${d}"`)];let w;if(ui(u)==="string"&&$o(v)&&!v.tokens&&(w=/^{([^}]+)}$/.exec(u)))return[new et(n,u,`"${d}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(w[1])} }\`.`)];const E=[];return i.layerType==="symbol"&&(d==="text-field"&&r&&!r.glyphs&&E.push(new et(n,u,'use of "text-field" requires a style "glyphs" property')),d==="text-font"&&To(ti(u))&&ct(u.type)==="identity"&&E.push(new et(n,u,'"text-font" does not support identity functions'))),E.concat(Ki({key:i.key,value:u,valueSpec:v,style:r,styleSpec:a,expressionContext:"property",propertyType:e,propertyKey:d}))}function Ya(i){return gc(i,"paint")}function yc(i){return gc(i,"layout")}function rh(i){let e=[];const n=i.value,r=i.key,a=i.style,u=i.styleSpec;n.type||n.ref||e.push(new et(r,n,'either "type" or "ref" is required'));let d=ct(n.type);const f=ct(n.ref);if(n.id){const g=ct(n.id);for(let v=0;v<i.arrayIndex;v++){const w=a.layers[v];ct(w.id)===g&&e.push(new et(r,n.id,`duplicate layer id "${n.id}", previously used at line ${w.id.__line__}`))}}if("ref"in n){let g;["type","source","source-layer","filter","layout"].forEach(v=>{v in n&&e.push(new et(r,n[v],`"${v}" is prohibited for ref layers`))}),a.layers.forEach(v=>{ct(v.id)===f&&(g=v)}),g?g.ref?e.push(new et(r,n.ref,"ref cannot reference another ref layer")):d=ct(g.type):typeof f=="string"&&e.push(new et(r,n.ref,`ref layer "${f}" not found`))}else if(d!=="background"&&d!=="sky")if(n.source){const g=a.sources&&a.sources[n.source],v=g&&ct(g.type);g?v==="vector"&&d==="raster"?e.push(new et(r,n.source,`layer "${n.id}" requires a raster source`)):v==="raster"&&d!=="raster"?e.push(new et(r,n.source,`layer "${n.id}" requires a vector source`)):v!=="vector"||n["source-layer"]?v==="raster-dem"&&d!=="hillshade"?e.push(new et(r,n.source,"raster-dem source can only be used with layer type 'hillshade'.")):d!=="line"||!n.paint||!n.paint["line-gradient"]||v==="geojson"&&g.lineMetrics||e.push(new et(r,n,`layer "${n.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new et(r,n,`layer "${n.id}" must specify a "source-layer"`)):e.push(new et(r,n.source,`source "${n.source}" not found`))}else e.push(new et(r,n,'missing required property "source"'));return e=e.concat(jn({key:r,value:n,valueSpec:u.layer,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Ki({key:`${r}.type`,value:n.type,valueSpec:u.layer.type,style:i.style,styleSpec:i.styleSpec,object:n,objectKey:"type"}),filter:g=>qr(ni({layerType:d},g)),layout:g=>jn({layer:n,key:g.key,value:g.value,valueSpec:{},style:g.style,styleSpec:g.styleSpec,objectElementValidators:{"*":v=>yc(ni({layerType:d},v))}}),paint:g=>jn({layer:n,key:g.key,value:g.value,valueSpec:{},style:g.style,styleSpec:g.styleSpec,objectElementValidators:{"*":v=>Ya(ni({layerType:d},v))}})}})),e}function Mr(i){const e=i.value,n=i.key,r=ui(e);return r!=="string"?[new et(n,e,`string expected, ${r} found`)]:[]}const oh={promoteId:function({key:i,value:e}){if(ui(e)==="string")return Mr({key:i,value:e});{const n=[];for(const r in e)n.push(...Mr({key:`${i}.${r}`,value:e[r]}));return n}}};function sh(i){const e=i.value,n=i.key,r=i.styleSpec,a=i.style;if(!e.type)return[new et(n,e,'"type" is required')];const u=ct(e.type);let d;switch(u){case"vector":case"raster":case"raster-dem":return d=jn({key:n,value:e,valueSpec:r[`source_${u.replace("-","_")}`],style:i.style,styleSpec:r,objectElementValidators:oh}),d;case"geojson":if(d=jn({key:n,value:e,valueSpec:r.source_geojson,style:a,styleSpec:r,objectElementValidators:oh}),e.cluster)for(const f in e.clusterProperties){const[g,v]=e.clusterProperties[f],w=typeof g=="string"?[g,["accumulated"],["get",f]]:g;d.push(...es({key:`${n}.${f}.map`,value:v,expressionContext:"cluster-map"})),d.push(...es({key:`${n}.${f}.reduce`,value:w,expressionContext:"cluster-reduce"}))}return d;case"video":return jn({key:n,value:e,valueSpec:r.source_video,style:a,styleSpec:r});case"image":return jn({key:n,value:e,valueSpec:r.source_image,style:a,styleSpec:r});case"canvas":return[new et(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ws({key:`${n}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:a,styleSpec:r})}}function ah(i){const e=i.value,n=i.styleSpec,r=n.light,a=i.style;let u=[];const d=ui(e);if(e===void 0)return u;if(d!=="object")return u=u.concat([new et("light",e,`object expected, ${d} found`)]),u;for(const f in e){const g=f.match(/^(.*)-transition$/);u=u.concat(g&&r[g[1]]&&r[g[1]].transition?Ki({key:f,value:e[f],valueSpec:n.transition,style:a,styleSpec:n}):r[f]?Ki({key:f,value:e[f],valueSpec:r[f],style:a,styleSpec:n}):[new et(f,e[f],`unknown property "${f}"`)])}return u}function lh(i){const e=i.value,n=i.key,r=i.style,a=i.styleSpec,u=a.terrain;let d=[];const f=ui(e);if(e===void 0)return d;if(f!=="object")return d=d.concat([new et("terrain",e,`object expected, ${f} found`)]),d;for(const g in e){const v=g.match(/^(.*)-transition$/);d=d.concat(v&&u[v[1]]&&u[v[1]].transition?Ki({key:g,value:e[g],valueSpec:a.transition,style:r,styleSpec:a}):u[g]?Ki({key:g,value:e[g],valueSpec:u[g],style:r,styleSpec:a}):[new et(g,e[g],`unknown property "${g}"`)])}if(e.source){const g=r.sources&&r.sources[e.source],v=g&&ct(g.type);g?v!=="raster-dem"&&d.push(new et(n,e.source,`terrain cannot be used with a source of type ${String(v)}, it only be used with a "raster-dem" source type`)):d.push(new et(n,e.source,`source "${e.source}" not found`))}else d.push(new et(n,e,'terrain is missing required property "source"'));return d}function ch(i){const e=i.value,n=i.style,r=i.styleSpec,a=r.fog;let u=[];const d=ui(e);if(e===void 0)return u;if(d!=="object")return u=u.concat([new et("fog",e,`object expected, ${d} found`)]),u;for(const f in e){const g=f.match(/^(.*)-transition$/);u=u.concat(g&&a[g[1]]&&a[g[1]].transition?Ki({key:f,value:e[f],valueSpec:r.transition,style:n,styleSpec:r}):a[f]?Ki({key:f,value:e[f],valueSpec:a[f],style:n,styleSpec:r}):[new et(f,e[f],`unknown property "${f}"`)])}return u}const Qs={"*":()=>[],array:qs,boolean:function(i){const e=i.value,n=i.key,r=ui(e);return r!=="boolean"?[new et(n,e,`boolean expected, ${r} found`)]:[]},number:eh,color:function(i){const e=i.key,n=i.value,r=ui(n);return r!=="string"?[new et(e,n,`color expected, ${r} found`)]:ql.parseCSSColor(n)===null?[new et(e,n,`color expected, "${n}" found`)]:[]},enum:Ws,filter:qr,function:th,layer:rh,object:jn,source:sh,light:ah,terrain:lh,fog:ch,string:Mr,formatted:function(i){return Mr(i).length===0?[]:es(i)},resolvedImage:function(i){return Mr(i).length===0?[]:es(i)},projection:function(i){const e=i.value,n=i.styleSpec,r=n.projection,a=i.style;let u=[];const d=ui(e);if(d==="object")for(const f in e)u=u.concat(Ki({key:f,value:e[f],valueSpec:r[f],style:a,styleSpec:n}));else d!=="string"&&(u=u.concat([new et("projection",e,`object or string expected, ${d} found`)]));return u}};function Ki(i){const e=i.value,n=i.valueSpec,r=i.styleSpec;return n.expression&&To(ct(e))?th(i):n.expression&&Jo(ti(e))?es(i):n.type&&Qs[n.type]?Qs[n.type](i):jn(ni({},i,{valueSpec:n.type?r[n.type]:n}))}function kn(i){const e=i.value,n=i.key,r=Mr(i);return r.length||(e.indexOf("{fontstack}")===-1&&r.push(new et(n,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&r.push(new et(n,e,'"glyphs" url must include a "{range}" token'))),r}function Ks(i,e=ve){return Sr(Ki({key:"",value:i,valueSpec:e.$root,styleSpec:e,style:i,objectElementValidators:{glyphs:kn,"*":()=>[]}}))}const cp=i=>Sr(Ya(i)),up=i=>Sr(yc(i));function Sr(i){return i.slice().sort((e,n)=>e.line&&n.line?e.line-n.line:0)}function uh(i,e){let n=!1;if(e&&e.length)for(const r of e)i.fire(new gt(new Error(r.message))),n=!0;return n}var Wr=gr;function gr(i,e,n){var r=this.cells=[];if(i instanceof ArrayBuffer){this.arrayBuffer=i;var a=new Int32Array(this.arrayBuffer);i=a[0],this.d=(e=a[1])+2*(n=a[2]);for(var u=0;u<this.d*this.d;u++){var d=a[3+u],f=a[3+u+1];r.push(d===f?null:a.subarray(d,f))}var g=a[3+r.length+1];this.keys=a.subarray(a[3+r.length],g),this.bboxes=a.subarray(g),this.insert=this._insertReadonly}else{this.d=e+2*n;for(var v=0;v<this.d*this.d;v++)r.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=i,this.padding=n,this.scale=e/i,this.uid=0;var w=n/e*i;this.min=-w,this.max=i+w}gr.prototype.insert=function(i,e,n,r,a){this._forEachCell(e,n,r,a,this._insertCell,this.uid++),this.keys.push(i),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(r),this.bboxes.push(a)},gr.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},gr.prototype._insertCell=function(i,e,n,r,a,u){this.cells[a].push(u)},gr.prototype.query=function(i,e,n,r,a){var u=this.min,d=this.max;if(i<=u&&e<=u&&d<=n&&d<=r&&!a)return Array.prototype.slice.call(this.keys);var f=[];return this._forEachCell(i,e,n,r,this._queryCell,f,{},a),f},gr.prototype._queryCell=function(i,e,n,r,a,u,d,f){var g=this.cells[a];if(g!==null)for(var v=this.keys,w=this.bboxes,E=0;E<g.length;E++){var M=g[E];if(d[M]===void 0){var k=4*M;(f?f(w[k+0],w[k+1],w[k+2],w[k+3]):i<=w[k+2]&&e<=w[k+3]&&n>=w[k+0]&&r>=w[k+1])?(d[M]=!0,u.push(v[M])):d[M]=!1}}},gr.prototype._forEachCell=function(i,e,n,r,a,u,d,f){for(var g=this._convertToCellCoord(i),v=this._convertToCellCoord(e),w=this._convertToCellCoord(n),E=this._convertToCellCoord(r),M=g;M<=w;M++)for(var k=v;k<=E;k++){var L=this.d*k+M;if((!f||f(this._convertFromCellCoord(M),this._convertFromCellCoord(k),this._convertFromCellCoord(M+1),this._convertFromCellCoord(k+1)))&&a.call(this,i,e,n,r,L,u,d,f))return}},gr.prototype._convertFromCellCoord=function(i){return(i-this.padding)/this.scale},gr.prototype._convertToCellCoord=function(i){return Math.max(0,Math.min(this.d-1,Math.floor(i*this.scale)+this.padding))},gr.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var i=this.cells,e=3+this.cells.length+1+1,n=0,r=0;r<this.cells.length;r++)n+=this.cells[r].length;var a=new Int32Array(e+n+this.keys.length+this.bboxes.length);a[0]=this.extent,a[1]=this.n,a[2]=this.padding;for(var u=e,d=0;d<i.length;d++){var f=i[d];a[3+d]=u,a.set(f,u),u+=f.length}return a[3+i.length]=u,a.set(this.keys,u),a[3+i.length+1]=u+=this.keys.length,a.set(this.bboxes,u),u+=this.bboxes.length,a.buffer};const Eo={};function nt(i,e={}){Eo[i.name]={klass:i,omit:e.omit||[]}}nt(Object),Wr.serialize=function(i,e){const n=i.toArrayBuffer();return e&&e.push(n),{buffer:n}},Wr.deserialize=function(i){return new Wr(i.buffer)},Object.defineProperty(Wr,"name",{value:"Grid"}),nt(Wr),nt(ii),nt(Error),nt(P),nt(Sn),nt(qa),nt(Za,{omit:["_evaluator"]}),nt(hc),nt(uc),nt(In,{omit:["_evaluate"]});for(const i in Ao)Eo[Ao[i].name]||nt(Ao[i]);function hh(i){return i&&typeof ArrayBuffer!="undefined"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}function Xa(i){return me.ImageBitmap&&i instanceof me.ImageBitmap}function $s(i,e){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp)return i;if(hh(i)||Xa(i))return e&&e.push(i),i;if(ArrayBuffer.isView(i)){const n=i;return e&&e.push(n.buffer),n}if(i instanceof me.ImageData)return e&&e.push(i.data.buffer),i;if(Array.isArray(i)){const n=[];for(const r of i)n.push($s(r,e));return n}if(typeof i=="object"){const n=i.constructor,r=n.name;if(!Eo[r])throw new Error(`can't serialize object of unregistered class ${r}`);const a=n.serialize?n.serialize(i,e):{};if(!n.serialize){for(const u in i)i.hasOwnProperty(u)&&(Eo[r].omit.indexOf(u)>=0||(a[u]=$s(i[u],e)));i instanceof Error&&(a.message=i.message)}if(a.$name)throw new Error("$name property is reserved for worker serialization logic.");return r!=="Object"&&(a.$name=r),a}throw new Error("can't serialize object of type "+typeof i)}function ts(i){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||hh(i)||Xa(i)||ArrayBuffer.isView(i)||i instanceof me.ImageData)return i;if(Array.isArray(i))return i.map(ts);if(typeof i=="object"){const e=i.$name||"Object",{klass:n}=Eo[e];if(!n)throw new Error(`can't deserialize unregistered class ${e}`);if(n.deserialize)return n.deserialize(i);const r=Object.create(n.prototype);for(const a of Object.keys(i))a!=="$name"&&(r[a]=ts(i[a]));return r}throw new Error("can't deserialize object of type "+typeof i)}class xc{constructor(){this.first=!0}update(e,n){const r=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=n):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=n),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=r,!0))}}const dh=i=>i>=1536&&i<=1791,Qa=i=>i>=1872&&i<=1919,Js=i=>i>=2208&&i<=2303,vc=i=>i>=11904&&i<=12031,ph=i=>i>=12032&&i<=12255,bc=i=>i>=12272&&i<=12287,Ka=i=>i>=12288&&i<=12351,ea=i=>i>=12352&&i<=12447,$a=i=>i>=12448&&i<=12543,fh=i=>i>=12544&&i<=12591,mh=i=>i>=12704&&i<=12735,_h=i=>i>=12736&&i<=12783,Ac=i=>i>=12784&&i<=12799,gh=i=>i>=12800&&i<=13055,yh=i=>i>=13056&&i<=13311,xh=i=>i>=13312&&i<=19903,wc=i=>i>=19968&&i<=40959,vh=i=>i>=40960&&i<=42127,bh=i=>i>=42128&&i<=42191,Ah=i=>i>=44032&&i<=55215,ta=i=>i>=63744&&i<=64255,Tc=i=>i>=64336&&i<=65023,wh=i=>i>=65040&&i<=65055,is=i=>i>=65072&&i<=65103,Th=i=>i>=65104&&i<=65135,Ja=i=>i>=65136&&i<=65279,Ec=i=>i>=65280&&i<=65519;function el(i){for(const e of i)if(tl(e.charCodeAt(0)))return!0;return!1}function Eh(i){for(const e of i)if(!Ch(e.charCodeAt(0)))return!1;return!0}function Ch(i){return!(dh(i)||Qa(i)||Js(i)||Tc(i)||Ja(i))}function tl(i){return!(i!==746&&i!==747&&(i<4352||!(mh(i)||fh(i)||is(i)&&!(i>=65097&&i<=65103)||ta(i)||yh(i)||vc(i)||_h(i)||!(!Ka(i)||i>=12296&&i<=12305||i>=12308&&i<=12319||i===12336)||xh(i)||wc(i)||gh(i)||(e=>e>=12592&&e<=12687)(i)||(e=>e>=43360&&e<=43391)(i)||(e=>e>=55216&&e<=55295)(i)||(e=>e>=4352&&e<=4607)(i)||Ah(i)||ea(i)||bc(i)||(e=>e>=12688&&e<=12703)(i)||ph(i)||Ac(i)||$a(i)&&i!==12540||!(!Ec(i)||i===65288||i===65289||i===65293||i>=65306&&i<=65310||i===65339||i===65341||i===65343||i>=65371&&i<=65503||i===65507||i>=65512&&i<=65519)||!(!Th(i)||i>=65112&&i<=65118||i>=65123&&i<=65126)||(e=>e>=5120&&e<=5759)(i)||(e=>e>=6320&&e<=6399)(i)||wh(i)||(e=>e>=19904&&e<=19967)(i)||vh(i)||bh(i))))}function il(i){return!(tl(i)||function(e){return!!((n=>n>=128&&n<=255)(e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||(n=>n>=8192&&n<=8303)(e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||(n=>n>=8448&&n<=8527)(e)||(n=>n>=8528&&n<=8591)(e)||(n=>n>=8960&&n<=9215)(e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||(n=>n>=9216&&n<=9279)(e)&&e!==9251||(n=>n>=9280&&n<=9311)(e)||(n=>n>=9312&&n<=9471)(e)||(n=>n>=9632&&n<=9727)(e)||(n=>n>=9728&&n<=9983)(e)&&!(e>=9754&&e<=9759)||(n=>n>=11008&&n<=11263)(e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||Ka(e)||$a(e)||(n=>n>=57344&&n<=63743)(e)||is(e)||Th(e)||Ec(e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(i))}function nl(i){return i>=1424&&i<=2303||Tc(i)||Ja(i)}function hp(i,e){return!(!e&&nl(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||(n=>n>=6016&&n<=6143)(i))}function dp(i){for(const e of i)if(nl(e.charCodeAt(0)))return!0;return!1}const Cc="deferred",ia="loading",Mc="loaded";let Sc=null,An="unavailable",Dn=null;const na=function(i){i&&typeof i=="string"&&i.indexOf("NetworkError")>-1&&(An="error"),Sc&&Sc(i)};function Co(){Ic.fire(new _t("pluginStateChange",{pluginStatus:An,pluginURL:Dn}))}const Ic=new St,rl=function(){return An},ns=function(){if(An!==Cc||!Dn)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");An=ia,Co(),Dn&&J({url:Dn},i=>{i?na(i):(An=Mc,Co())})},Gn={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>An===Mc||Gn.applyArabicShaping!=null,isLoading:()=>An===ia,setState(i){An=i.pluginStatus,Dn=i.pluginURL},isParsed:()=>Gn.applyArabicShaping!=null&&Gn.processBidirectionalText!=null&&Gn.processStyledBidirectionalText!=null,getPluginURL:()=>Dn};class vi{constructor(e,n){this.zoom=e,n?(this.now=n.now,this.fadeDuration=n.fadeDuration,this.zoomHistory=n.zoomHistory,this.transition=n.transition,this.pitch=n.pitch):(this.now=0,this.fadeDuration=0,this.zoomHistory=new xc,this.transition={},this.pitch=0)}isSupportedScript(e){return function(n,r){for(const a of n)if(!hp(a.charCodeAt(0),r))return!1;return!0}(e,Gn.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,n=e-Math.floor(e),r=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:n+(1-n)*r}:{fromScale:.5,toScale:1,t:1-(1-r)*n}}}class ra{constructor(e,n){this.property=e,this.value=n,this.expression=function(r,a){if(To(r))return new qa(r,a);if(Jo(r)){const u=Ju(r,a);if(u.result==="error")throw new Error(u.value.map(d=>`${d.key}: ${d.message}`).join(", "));return u.value}{let u=r;return typeof r=="string"&&a.type==="color"&&(u=ii.parse(r)),{kind:"constant",evaluate:()=>u}}}(n===void 0?e.specification.default:n,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,n,r){return this.property.possiblyEvaluate(this,e,n,r)}}class rs{constructor(e){this.property=e,this.value=new ra(e,void 0)}transitioned(e,n){return new t(this.property,this.value,n,yi({},e.transition,this.transition),e.now)}untransitioned(){return new t(this.property,this.value,null,{},0)}}class l{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return Vi(this._values[e].value.value)}setValue(e,n){this._values.hasOwnProperty(e)||(this._values[e]=new rs(this._values[e].property)),this._values[e].value=new ra(this._values[e].property,n===null?void 0:Vi(n))}getTransition(e){return Vi(this._values[e].transition)}setTransition(e,n){this._values.hasOwnProperty(e)||(this._values[e]=new rs(this._values[e].property)),this._values[e].transition=Vi(n)||void 0}serialize(){const e={};for(const n of Object.keys(this._values)){const r=this.getValue(n);r!==void 0&&(e[n]=r);const a=this.getTransition(n);a!==void 0&&(e[`${n}-transition`]=a)}return e}transitioned(e,n){const r=new s(this._properties);for(const a of Object.keys(this._values))r._values[a]=this._values[a].transitioned(e,n._values[a]);return r}untransitioned(){const e=new s(this._properties);for(const n of Object.keys(this._values))e._values[n]=this._values[n].untransitioned();return e}}class t{constructor(e,n,r,a,u){const d=a.delay||0,f=a.duration||0;u=u||0,this.property=e,this.value=n,this.begin=u+d,this.end=this.begin+f,e.specification.transition&&(a.delay||a.duration)&&(this.prior=r)}possiblyEvaluate(e,n,r){const a=e.now||0,u=this.value.possiblyEvaluate(e,n,r),d=this.prior;if(d){if(a>this.end)return this.prior=null,u;if(this.value.isDataDriven())return this.prior=null,u;if(a<this.begin)return d.possiblyEvaluate(e,n,r);{const f=(a-this.begin)/(this.end-this.begin);return this.property.interpolate(d.possiblyEvaluate(e,n,r),u,vt(f))}}return u}}class s{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,n,r){const a=new _(this._properties);for(const u of Object.keys(this._values))a._values[u]=this._values[u].possiblyEvaluate(e,n,r);return a}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class h{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return Vi(this._values[e].value)}setValue(e,n){this._values[e]=new ra(this._values[e].property,n===null?void 0:Vi(n))}serialize(){const e={};for(const n of Object.keys(this._values)){const r=this.getValue(n);r!==void 0&&(e[n]=r)}return e}possiblyEvaluate(e,n,r){const a=new _(this._properties);for(const u of Object.keys(this._values))a._values[u]=this._values[u].possiblyEvaluate(e,n,r);return a}}class m{constructor(e,n,r){this.property=e,this.value=n,this.parameters=r}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,n,r,a){return this.property.evaluate(this.value,this.parameters,e,n,r,a)}}class _{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class x{constructor(e){this.specification=e}possiblyEvaluate(e,n){return e.expression.evaluate(n)}interpolate(e,n,r){const a=Ba[this.specification.type];return a?a(e,n,r):e}}class A{constructor(e,n){this.specification=e,this.overrides=n}possiblyEvaluate(e,n,r,a){return new m(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(n,null,{},r,a)}:e.expression,n)}interpolate(e,n,r){if(e.value.kind!=="constant"||n.value.kind!=="constant")return e;if(e.value.value===void 0||n.value.value===void 0)return new m(this,{kind:"constant",value:void 0},e.parameters);const a=Ba[this.specification.type];return a?new m(this,{kind:"constant",value:a(e.value.value,n.value.value,r)},e.parameters):e}evaluate(e,n,r,a,u,d){return e.kind==="constant"?e.value:e.evaluate(n,r,a,u,d)}}class C extends A{possiblyEvaluate(e,n,r,a){if(e.value===void 0)return new m(this,{kind:"constant",value:void 0},n);if(e.expression.kind==="constant"){const u=e.expression.evaluate(n,null,{},r,a),d=e.property.specification.type==="resolvedImage"&&typeof u!="string"?u.name:u,f=this._calculate(d,d,d,n);return new m(this,{kind:"constant",value:f},n)}if(e.expression.kind==="camera"){const u=this._calculate(e.expression.evaluate({zoom:n.zoom-1}),e.expression.evaluate({zoom:n.zoom}),e.expression.evaluate({zoom:n.zoom+1}),n);return new m(this,{kind:"constant",value:u},n)}return new m(this,e.expression,n)}evaluate(e,n,r,a,u,d){if(e.kind==="source"){const f=e.evaluate(n,r,a,u,d);return this._calculate(f,f,f,n)}return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(n.zoom)-1},r,a),e.evaluate({zoom:Math.floor(n.zoom)},r,a),e.evaluate({zoom:Math.floor(n.zoom)+1},r,a),n):e.value}_calculate(e,n,r,a){return a.zoom>a.zoomHistory.lastIntegerZoom?{from:e,to:n,other:r}:{from:r,to:n,other:e}}interpolate(e){return e}}class S{constructor(e){this.specification=e}possiblyEvaluate(e,n,r,a){if(e.value!==void 0){if(e.expression.kind==="constant"){const u=e.expression.evaluate(n,null,{},r,a);return this._calculate(u,u,u,n)}return this._calculate(e.expression.evaluate(new vi(Math.floor(n.zoom-1),n)),e.expression.evaluate(new vi(Math.floor(n.zoom),n)),e.expression.evaluate(new vi(Math.floor(n.zoom+1),n)),n)}}_calculate(e,n,r,a){return a.zoom>a.zoomHistory.lastIntegerZoom?{from:e,to:n}:{from:r,to:n}}interpolate(e){return e}}class z{constructor(e){this.specification=e}possiblyEvaluate(e,n,r,a){return!!e.expression.evaluate(n,null,{},r,a)}interpolate(){return!1}}class B{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const n in e){const r=e[n];r.specification.overridable&&this.overridableProperties.push(n);const a=this.defaultPropertyValues[n]=new ra(r,void 0),u=this.defaultTransitionablePropertyValues[n]=new rs(r);this.defaultTransitioningPropertyValues[n]=u.untransitioned(),this.defaultPossiblyEvaluatedValues[n]=a.possiblyEvaluate({})}}}function N(i,e){return 256*(i=At(Math.floor(i),0,255))+At(Math.floor(e),0,255)}nt(A),nt(x),nt(C),nt(S),nt(z);const G={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class V{constructor(e,n){this._structArray=e,this._pos1=n*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class O{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,n){return e._trim(),n&&(e.isTransferred=!0,n.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const n=Object.create(this.prototype);return n.arrayBuffer=e.arrayBuffer,n.length=e.length,n.capacity=e.arrayBuffer.byteLength/n.bytesPerElement,n._refreshViews(),n}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const n=this.uint8;this._refreshViews(),n&&this.uint8.set(n)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function $(i,e=1){let n=0,r=0;return{members:i.map(a=>{const u=G[a.type].BYTES_PER_ELEMENT,d=n=W(n,Math.max(e,u)),f=a.components||1;return r=Math.max(r,u),n+=u*f,{name:a.name,type:a.type,components:f,offset:d}}),size:W(n,Math.max(r,e)),alignment:e}}function W(i,e){return Math.ceil(i/e)*e}class Q extends O{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n){const r=this.length;return this.resize(r+1),this.emplace(r,e,n)}emplace(e,n,r){const a=2*e;return this.int16[a+0]=n,this.int16[a+1]=r,e}}Q.prototype.bytesPerElement=4,nt(Q);class K extends O{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,r){const a=this.length;return this.resize(a+1),this.emplace(a,e,n,r)}emplace(e,n,r,a){const u=3*e;return this.int16[u+0]=n,this.int16[u+1]=r,this.int16[u+2]=a,e}}K.prototype.bytesPerElement=6,nt(K);class ee extends O{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,r,a){const u=this.length;return this.resize(u+1),this.emplace(u,e,n,r,a)}emplace(e,n,r,a,u){const d=4*e;return this.int16[d+0]=n,this.int16[d+1]=r,this.int16[d+2]=a,this.int16[d+3]=u,e}}ee.prototype.bytesPerElement=8,nt(ee);class X extends O{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,r,a,u,d,f){const g=this.length;return this.resize(g+1),this.emplace(g,e,n,r,a,u,d,f)}emplace(e,n,r,a,u,d,f,g){const v=6*e,w=12*e,E=3*e;return this.int16[v+0]=n,this.int16[v+1]=r,this.uint8[w+4]=a,this.uint8[w+5]=u,this.uint8[w+6]=d,this.uint8[w+7]=f,this.float32[E+2]=g,e}}X.prototype.bytesPerElement=12,nt(X);class re extends O{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,r){const a=this.length;return this.resize(a+1),this.emplace(a,e,n,r)}emplace(e,n,r,a){const u=3*e;return this.float32[u+0]=n,this.float32[u+1]=r,this.float32[u+2]=a,e}}re.prototype.bytesPerElement=12,nt(re);class ge extends O{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,r,a,u,d,f,g,v,w){const E=this.length;return this.resize(E+1),this.emplace(E,e,n,r,a,u,d,f,g,v,w)}emplace(e,n,r,a,u,d,f,g,v,w,E){const M=10*e;return this.uint16[M+0]=n,this.uint16[M+1]=r,this.uint16[M+2]=a,this.uint16[M+3]=u,this.uint16[M+4]=d,this.uint16[M+5]=f,this.uint16[M+6]=g,this.uint16[M+7]=v,this.uint16[M+8]=w,this.uint16[M+9]=E,e}}ge.prototype.bytesPerElement=20,nt(ge);class Ae extends O{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,r,a,u,d,f,g){const v=this.length;return this.resize(v+1),this.emplace(v,e,n,r,a,u,d,f,g)}emplace(e,n,r,a,u,d,f,g,v){const w=8*e;return this.uint16[w+0]=n,this.uint16[w+1]=r,this.uint16[w+2]=a,this.uint16[w+3]=u,this.uint16[w+4]=d,this.uint16[w+5]=f,this.uint16[w+6]=g,this.uint16[w+7]=v,e}}Ae.prototype.bytesPerElement=16,nt(Ae);class Se extends O{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,r,a,u,d){const f=this.length;return this.resize(f+1),this.emplace(f,e,n,r,a,u,d)}emplace(e,n,r,a,u,d,f){const g=6*e;return this.int16[g+0]=n,this.int16[g+1]=r,this.int16[g+2]=a,this.int16[g+3]=u,this.int16[g+4]=d,this.int16[g+5]=f,e}}Se.prototype.bytesPerElement=12,nt(Se);class Ce extends O{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,r,a,u,d,f,g,v,w,E,M,k,L,F,j){const H=this.length;return this.resize(H+1),this.emplace(H,e,n,r,a,u,d,f,g,v,w,E,M,k,L,F,j)}emplace(e,n,r,a,u,d,f,g,v,w,E,M,k,L,F,j,H){const ne=16*e;return this.int16[ne+0]=n,this.int16[ne+1]=r,this.int16[ne+2]=a,this.int16[ne+3]=u,this.uint16[ne+4]=d,this.uint16[ne+5]=f,this.uint16[ne+6]=g,this.uint16[ne+7]=v,this.int16[ne+8]=w,this.int16[ne+9]=E,this.int16[ne+10]=M,this.int16[ne+11]=k,this.int16[ne+12]=L,this.int16[ne+13]=F,this.int16[ne+14]=j,this.int16[ne+15]=H,e}}Ce.prototype.bytesPerElement=32,nt(Ce);class Ze extends O{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint32[1*e+0]=n,e}}Ze.prototype.bytesPerElement=4,nt(Ze);class ye extends O{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,r,a,u,d,f,g,v,w,E,M,k){const L=this.length;return this.resize(L+1),this.emplace(L,e,n,r,a,u,d,f,g,v,w,E,M,k)}emplace(e,n,r,a,u,d,f,g,v,w,E,M,k,L){const F=20*e,j=10*e;return this.int16[F+0]=n,this.int16[F+1]=r,this.int16[F+2]=a,this.int16[F+3]=u,this.int16[F+4]=d,this.float32[j+3]=f,this.float32[j+4]=g,this.float32[j+5]=v,this.float32[j+6]=w,this.int16[F+14]=E,this.uint32[j+8]=M,this.uint16[F+18]=k,this.uint16[F+19]=L,e}}ye.prototype.bytesPerElement=40,nt(ye);class je extends O{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,r,a,u,d,f){const g=this.length;return this.resize(g+1),this.emplace(g,e,n,r,a,u,d,f)}emplace(e,n,r,a,u,d,f,g){const v=8*e;return this.int16[v+0]=n,this.int16[v+1]=r,this.int16[v+2]=a,this.int16[v+4]=u,this.int16[v+5]=d,this.int16[v+6]=f,this.int16[v+7]=g,e}}je.prototype.bytesPerElement=16,nt(je);class Ue extends O{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,r,a,u){const d=this.length;return this.resize(d+1),this.emplace(d,e,n,r,a,u)}emplace(e,n,r,a,u,d){const f=4*e,g=8*e;return this.float32[f+0]=n,this.float32[f+1]=r,this.float32[f+2]=a,this.int16[g+6]=u,this.int16[g+7]=d,e}}Ue.prototype.bytesPerElement=16,nt(Ue);class lt extends O{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,r,a){const u=this.length;return this.resize(u+1),this.emplace(u,e,n,r,a)}emplace(e,n,r,a,u){const d=12*e,f=3*e;return this.uint8[d+0]=n,this.uint8[d+1]=r,this.float32[f+1]=a,this.float32[f+2]=u,e}}lt.prototype.bytesPerElement=12,nt(lt);class we extends O{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,r){const a=this.length;return this.resize(a+1),this.emplace(a,e,n,r)}emplace(e,n,r,a){const u=3*e;return this.uint16[u+0]=n,this.uint16[u+1]=r,this.uint16[u+2]=a,e}}we.prototype.bytesPerElement=6,nt(we);class pt extends O{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,n,r,a,u,d,f,g,v,w,E,M,k,L,F,j,H,ne,le,ue,he){const de=this.length;return this.resize(de+1),this.emplace(de,e,n,r,a,u,d,f,g,v,w,E,M,k,L,F,j,H,ne,le,ue,he)}emplace(e,n,r,a,u,d,f,g,v,w,E,M,k,L,F,j,H,ne,le,ue,he,de){const Te=30*e,Me=15*e,De=60*e;return this.int16[Te+0]=n,this.int16[Te+1]=r,this.int16[Te+2]=a,this.float32[Me+2]=u,this.float32[Me+3]=d,this.uint16[Te+8]=f,this.uint16[Te+9]=g,this.uint32[Me+5]=v,this.uint32[Me+6]=w,this.uint32[Me+7]=E,this.uint16[Te+16]=M,this.uint16[Te+17]=k,this.uint16[Te+18]=L,this.float32[Me+10]=F,this.float32[Me+11]=j,this.uint8[De+48]=H,this.uint8[De+49]=ne,this.uint8[De+50]=le,this.uint32[Me+13]=ue,this.int16[Te+28]=he,this.uint8[De+58]=de,e}}pt.prototype.bytesPerElement=60,nt(pt);class yt extends O{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,n,r,a,u,d,f,g,v,w,E,M,k,L,F,j,H,ne,le,ue,he,de,Te,Me,De,Be,be,Ie,Oe,We){const Ve=this.length;return this.resize(Ve+1),this.emplace(Ve,e,n,r,a,u,d,f,g,v,w,E,M,k,L,F,j,H,ne,le,ue,he,de,Te,Me,De,Be,be,Ie,Oe,We)}emplace(e,n,r,a,u,d,f,g,v,w,E,M,k,L,F,j,H,ne,le,ue,he,de,Te,Me,De,Be,be,Ie,Oe,We,Ve){const qe=38*e,Pt=19*e;return this.int16[qe+0]=n,this.int16[qe+1]=r,this.int16[qe+2]=a,this.float32[Pt+2]=u,this.float32[Pt+3]=d,this.int16[qe+8]=f,this.int16[qe+9]=g,this.int16[qe+10]=v,this.int16[qe+11]=w,this.int16[qe+12]=E,this.int16[qe+13]=M,this.uint16[qe+14]=k,this.uint16[qe+15]=L,this.uint16[qe+16]=F,this.uint16[qe+17]=j,this.uint16[qe+18]=H,this.uint16[qe+19]=ne,this.uint16[qe+20]=le,this.uint16[qe+21]=ue,this.uint16[qe+22]=he,this.uint16[qe+23]=de,this.uint16[qe+24]=Te,this.uint16[qe+25]=Me,this.uint16[qe+26]=De,this.uint16[qe+27]=Be,this.uint16[qe+28]=be,this.uint32[Pt+15]=Ie,this.float32[Pt+16]=Oe,this.float32[Pt+17]=We,this.float32[Pt+18]=Ve,e}}yt.prototype.bytesPerElement=76,nt(yt);class ot extends O{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.float32[1*e+0]=n,e}}ot.prototype.bytesPerElement=4,nt(ot);class st extends O{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,r,a,u,d,f){const g=this.length;return this.resize(g+1),this.emplace(g,e,n,r,a,u,d,f)}emplace(e,n,r,a,u,d,f,g){const v=7*e;return this.float32[v+0]=n,this.float32[v+1]=r,this.float32[v+2]=a,this.float32[v+3]=u,this.float32[v+4]=d,this.float32[v+5]=f,this.float32[v+6]=g,e}}st.prototype.bytesPerElement=28,nt(st);class Et extends O{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,r,a,u){const d=this.length;return this.resize(d+1),this.emplace(d,e,n,r,a,u)}emplace(e,n,r,a,u,d){const f=5*e;return this.float32[f+0]=n,this.float32[f+1]=r,this.float32[f+2]=a,this.float32[f+3]=u,this.float32[f+4]=d,e}}Et.prototype.bytesPerElement=20,nt(Et);class Ft extends O{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,r,a){const u=this.length;return this.resize(u+1),this.emplace(u,e,n,r,a)}emplace(e,n,r,a,u){const d=6*e;return this.uint32[3*e+0]=n,this.uint16[d+2]=r,this.uint16[d+3]=a,this.uint16[d+4]=u,e}}Ft.prototype.bytesPerElement=12,nt(Ft);class ht extends O{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n){const r=this.length;return this.resize(r+1),this.emplace(r,e,n)}emplace(e,n,r){const a=2*e;return this.uint16[a+0]=n,this.uint16[a+1]=r,e}}ht.prototype.bytesPerElement=4,nt(ht);class kt extends O{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint16[1*e+0]=n,e}}kt.prototype.bytesPerElement=2,nt(kt);class $t extends O{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n){const r=this.length;return this.resize(r+1),this.emplace(r,e,n)}emplace(e,n,r){const a=2*e;return this.float32[a+0]=n,this.float32[a+1]=r,e}}$t.prototype.bytesPerElement=8,nt($t);class ki extends O{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,r,a){const u=this.length;return this.resize(u+1),this.emplace(u,e,n,r,a)}emplace(e,n,r,a,u){const d=4*e;return this.float32[d+0]=n,this.float32[d+1]=r,this.float32[d+2]=a,this.float32[d+3]=u,e}}ki.prototype.bytesPerElement=16,nt(ki);class an extends O{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,r,a,u,d,f){const g=this.length;return this.resize(g+1),this.emplace(g,e,n,r,a,u,d,f)}emplace(e,n,r,a,u,d,f,g){const v=8*e,w=4*e;return this.int16[v+0]=n,this.int16[v+1]=r,this.int16[v+2]=a,this.int16[v+3]=u,this.int16[v+4]=d,this.int16[v+5]=f,this.float32[w+3]=g,e}}an.prototype.bytesPerElement=16,nt(an);class ln extends V{get a_pos_30(){return this._structArray.int16[this._pos2+0]}get a_pos_31(){return this._structArray.int16[this._pos2+1]}get a_pos_32(){return this._structArray.int16[this._pos2+2]}get a_pos_normal_30(){return this._structArray.int16[this._pos2+3]}get a_pos_normal_31(){return this._structArray.int16[this._pos2+4]}get a_pos_normal_32(){return this._structArray.int16[this._pos2+5]}}ln.prototype.size=12;class Pn extends Se{get(e){return new ln(this,e)}}nt(Pn);class sr extends V{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}sr.prototype.size=40;class Ir extends ye{get(e){return new sr(this,e)}}nt(Ir);class Hr extends V{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}Hr.prototype.size=60;class zr extends pt{get(e){return new Hr(this,e)}}nt(zr);class Di extends V{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(e){this._structArray.uint32[this._pos4+15]=e}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Di.prototype.size=76;class Ri extends yt{get(e){return new Di(this,e)}}nt(Ri);class oi extends ot{getoffsetX(e){return this.float32[1*e+0]}}nt(oi);class Gi extends K{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}nt(Gi);class Bn extends V{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Bn.prototype.size=12;class Si extends Ft{get(e){return new Bn(this,e)}}nt(Si);class Zn extends V{get a_centroid_pos0(){return this._structArray.uint16[this._pos2+0]}get a_centroid_pos1(){return this._structArray.uint16[this._pos2+1]}}Zn.prototype.size=4;class oa extends ht{get(e){return new Zn(this,e)}}nt(oa);class Ln extends V{get a_pos_30(){return this._structArray.int16[this._pos2+0]}get a_pos_31(){return this._structArray.int16[this._pos2+1]}get a_pos_32(){return this._structArray.int16[this._pos2+2]}get a_pos_normal_30(){return this._structArray.int16[this._pos2+3]}get a_pos_normal_31(){return this._structArray.int16[this._pos2+4]}get a_pos_normal_32(){return this._structArray.int16[this._pos2+5]}get a_scale(){return this._structArray.float32[this._pos4+3]}}Ln.prototype.size=16;class Mo extends an{get(e){return new Ln(this,e)}}nt(Mo);const Mh=$([{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"}]),zc=$([{name:"a_dash_to",components:4,type:"Uint16"},{name:"a_dash_from",components:4,type:"Uint16"}]);var os=Ma(function(i){i.exports=function(e,n){var r,a,u,d,f,g,v,w;for(a=e.length-(r=3&e.length),u=n,f=3432918353,g=461845907,w=0;w<a;)v=255&e.charCodeAt(w)|(255&e.charCodeAt(++w))<<8|(255&e.charCodeAt(++w))<<16|(255&e.charCodeAt(++w))<<24,++w,u=27492+(65535&(d=5*(65535&(u=(u^=v=(65535&(v=(v=(65535&v)*f+(((v>>>16)*f&65535)<<16)&4294967295)<<15|v>>>17))*g+(((v>>>16)*g&65535)<<16)&4294967295)<<13|u>>>19))+((5*(u>>>16)&65535)<<16)&4294967295))+((58964+(d>>>16)&65535)<<16);switch(v=0,r){case 3:v^=(255&e.charCodeAt(w+2))<<16;case 2:v^=(255&e.charCodeAt(w+1))<<8;case 1:u^=v=(65535&(v=(v=(65535&(v^=255&e.charCodeAt(w)))*f+(((v>>>16)*f&65535)<<16)&4294967295)<<15|v>>>17))*g+(((v>>>16)*g&65535)<<16)&4294967295}return u^=e.length,u=2246822507*(65535&(u^=u>>>16))+((2246822507*(u>>>16)&65535)<<16)&4294967295,u=3266489909*(65535&(u^=u>>>13))+((3266489909*(u>>>16)&65535)<<16)&4294967295,(u^=u>>>16)>>>0}}),pp=Ma(function(i){i.exports=function(e,n){for(var r,a=e.length,u=n^a,d=0;a>=4;)r=1540483477*(65535&(r=255&e.charCodeAt(d)|(255&e.charCodeAt(++d))<<8|(255&e.charCodeAt(++d))<<16|(255&e.charCodeAt(++d))<<24))+((1540483477*(r>>>16)&65535)<<16),u=1540483477*(65535&u)+((1540483477*(u>>>16)&65535)<<16)^(r=1540483477*(65535&(r^=r>>>24))+((1540483477*(r>>>16)&65535)<<16)),a-=4,++d;switch(a){case 3:u^=(255&e.charCodeAt(d+2))<<16;case 2:u^=(255&e.charCodeAt(d+1))<<8;case 1:u=1540483477*(65535&(u^=255&e.charCodeAt(d)))+((1540483477*(u>>>16)&65535)<<16)}return u=1540483477*(65535&(u^=u>>>13))+((1540483477*(u>>>16)&65535)<<16),(u^=u>>>15)>>>0}}),Yr=os,kc=pp;Yr.murmur3=os,Yr.murmur2=kc;class Sh{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,n,r,a){this.ids.push(qm(e)),this.positions.push(n,r,a)}getPositions(e){const n=qm(e);let r=0,a=this.ids.length-1;for(;r<a;){const d=r+a>>1;this.ids[d]>=n?a=d:r=d+1}const u=[];for(;this.ids[r]===n;)u.push({index:this.positions[3*r],start:this.positions[3*r+1],end:this.positions[3*r+2]}),r++;return u}static serialize(e,n){const r=new Float64Array(e.ids),a=new Uint32Array(e.positions);return fp(r,a,0,r.length-1),n&&n.push(r.buffer,a.buffer),{ids:r,positions:a}}static deserialize(e){const n=new Sh;return n.ids=e.ids,n.positions=e.positions,n.indexed=!0,n}}function qm(i){const e=+i;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:Yr(String(i))}function fp(i,e,n,r){for(;n<r;){const a=i[n+r>>1];let u=n-1,d=r+1;for(;;){do u++;while(i[u]<a);do d--;while(i[d]>a);if(u>=d)break;Ih(i,u,d),Ih(e,3*u,3*d),Ih(e,3*u+1,3*d+1),Ih(e,3*u+2,3*d+2)}d-n<r-d?(fp(i,e,n,d),n=d+1):(fp(i,e,d+1,r),r=d)}}function Ih(i,e,n){const r=i[e];i[e]=i[n],i[n]=r}nt(Sh);class So{constructor(e,n){this.gl=e.gl,this.location=n}}class zh extends So{constructor(e,n){super(e,n),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class Wm extends So{constructor(e,n){super(e,n),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class Hm extends So{constructor(e,n){super(e,n),this.current=ii.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const lx=new Float32Array(16),cx=new Float32Array(9),ux=new Float32Array(4);function mp(i){return[N(255*i.r,255*i.g),N(255*i.b,255*i.a)]}class Dc{constructor(e,n,r){this.value=e,this.uniformNames=n.map(a=>`u_${a}`),this.type=r}setUniform(e,n,r){e.set(r.constantOr(this.value))}getBinding(e,n,r){return this.type==="color"?new Hm(e,n):new zh(e,n)}}class ol{constructor(e,n){this.uniformNames=n.map(r=>`u_${r}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,n){this.pixelRatioFrom=n.pixelRatio||1,this.pixelRatioTo=e.pixelRatio||1,this.patternFrom=n.tl.concat(n.br),this.patternTo=e.tl.concat(e.br)}setUniform(e,n,r,a){const u=a==="u_pattern_to"||a==="u_dash_to"?this.patternTo:a==="u_pattern_from"||a==="u_dash_from"?this.patternFrom:a==="u_pixel_ratio_to"?this.pixelRatioTo:a==="u_pixel_ratio_from"?this.pixelRatioFrom:null;u&&e.set(u)}getBinding(e,n,r){return r==="u_pattern_from"||r==="u_pattern_to"||r==="u_dash_from"||r==="u_dash_to"?new Wm(e,n):new zh(e,n)}}class Io{constructor(e,n,r,a){this.expression=e,this.type=r,this.maxValue=0,this.paintVertexAttributes=n.map(u=>({name:`a_${u}`,type:"Float32",components:r==="color"?2:1,offset:0})),this.paintVertexArray=new a}populatePaintArray(e,n,r,a,u,d){const f=this.paintVertexArray.length,g=this.expression.evaluate(new vi(0),n,{},u,a,d);this.paintVertexArray.resize(e),this._setPaintValue(f,e,g)}updatePaintArray(e,n,r,a,u){const d=this.expression.evaluate({zoom:0},r,a,void 0,u);this._setPaintValue(e,n,d)}_setPaintValue(e,n,r){if(this.type==="color"){const a=mp(r);for(let u=e;u<n;u++)this.paintVertexArray.emplace(u,a[0],a[1])}else{for(let a=e;a<n;a++)this.paintVertexArray.emplace(a,r);this.maxValue=Math.max(this.maxValue,Math.abs(r))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class kr{constructor(e,n,r,a,u,d){this.expression=e,this.uniformNames=n.map(f=>`u_${f}_t`),this.type=r,this.useIntegerZoom=a,this.zoom=u,this.maxValue=0,this.paintVertexAttributes=n.map(f=>({name:`a_${f}`,type:"Float32",components:r==="color"?4:2,offset:0})),this.paintVertexArray=new d}populatePaintArray(e,n,r,a,u,d){const f=this.expression.evaluate(new vi(this.zoom),n,{},u,a,d),g=this.expression.evaluate(new vi(this.zoom+1),n,{},u,a,d),v=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(v,e,f,g)}updatePaintArray(e,n,r,a,u){const d=this.expression.evaluate({zoom:this.zoom},r,a,void 0,u),f=this.expression.evaluate({zoom:this.zoom+1},r,a,void 0,u);this._setPaintValue(e,n,d,f)}_setPaintValue(e,n,r,a){if(this.type==="color"){const u=mp(r),d=mp(a);for(let f=e;f<n;f++)this.paintVertexArray.emplace(f,u[0],u[1],d[0],d[1])}else{for(let u=e;u<n;u++)this.paintVertexArray.emplace(u,r,a);this.maxValue=Math.max(this.maxValue,Math.abs(r),Math.abs(a))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,n){const r=this.useIntegerZoom?Math.floor(n.zoom):n.zoom,a=At(this.expression.interpolationFactor(r,this.zoom,this.zoom+1),0,1);e.set(a)}getBinding(e,n,r){return new zh(e,n)}}class ss{constructor(e,n,r,a,u,d,f){this.expression=e,this.type=r,this.useIntegerZoom=a,this.zoom=u,this.layerId=f,this.paintVertexAttributes=(r==="array"?zc:Mh).members;for(let g=0;g<n.length;++g);this.zoomInPaintVertexArray=new d,this.zoomOutPaintVertexArray=new d}populatePaintArray(e,n,r){const a=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(a,e,n.patterns&&n.patterns[this.layerId],r)}updatePaintArray(e,n,r,a,u,d){this._setPaintValues(e,n,r.patterns&&r.patterns[this.layerId],d)}_setPaintValues(e,n,r,a){if(!a||!r)return;const{min:u,mid:d,max:f}=r,g=a[u],v=a[d],w=a[f];if(g&&v&&w)for(let E=e;E<n;E++)this._setPaintValue(this.zoomInPaintVertexArray,E,v,g),this._setPaintValue(this.zoomOutPaintVertexArray,E,v,w)}_setPaintValue(e,n,r,a){e.emplace(n,r.tl[0],r.tl[1],r.br[0],r.br[1],a.tl[0],a.tl[1],a.br[0],a.br[1],r.pixelRatio,a.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class as{constructor(e,n,r=()=>!0){this.binders={},this._buffers=[];const a=[];for(const u in e.paint._values){if(!r(u))continue;const d=e.paint.get(u);if(!(d instanceof m&&$o(d.property.specification)))continue;const f=dx(u,e.type),g=d.value,v=d.property.specification.type,w=d.property.useIntegerZoom,E=d.property.specification["property-type"],M=E==="cross-faded"||E==="cross-faded-data-driven",k=String(u)==="line-dasharray"&&e.layout.get("line-cap").value.kind!=="constant";if(g.kind!=="constant"||k)if(g.kind==="source"||k||M){const L=Ym(u,v,"source");this.binders[u]=M?new ss(g,f,v,w,n,L,e.id):new Io(g,f,v,L),a.push(`/a_${u}`)}else{const L=Ym(u,v,"composite");this.binders[u]=new kr(g,f,v,w,n,L),a.push(`/z_${u}`)}else this.binders[u]=M?new ol(g.value,f):new Dc(g.value,f,v),a.push(`/u_${u}`)}this.cacheKey=a.sort().join("")}getMaxValue(e){const n=this.binders[e];return n instanceof Io||n instanceof kr?n.maxValue:0}populatePaintArrays(e,n,r,a,u,d){for(const f in this.binders){const g=this.binders[f];(g instanceof Io||g instanceof kr||g instanceof ss)&&g.populatePaintArray(e,n,r,a,u,d)}}setConstantPatternPositions(e,n){for(const r in this.binders){const a=this.binders[r];a instanceof ol&&a.setConstantPatternPositions(e,n)}}updatePaintArrays(e,n,r,a,u,d){let f=!1;for(const g in e){const v=n.getPositions(g);for(const w of v){const E=r.feature(w.index);for(const M in this.binders){const k=this.binders[M];if((k instanceof Io||k instanceof kr||k instanceof ss)&&k.expression.isStateDependent===!0){const L=a.paint.get(M);k.expression=L.value,k.updatePaintArray(w.start,w.end,E,e[g],u,d),f=!0}}}}return f}defines(){const e=[];for(const n in this.binders){const r=this.binders[n];(r instanceof Dc||r instanceof ol)&&e.push(...r.uniformNames.map(a=>`#define HAS_UNIFORM_${a}`))}return e}getBinderAttributes(){const e=[];for(const n in this.binders){const r=this.binders[n];if(r instanceof Io||r instanceof kr||r instanceof ss)for(let a=0;a<r.paintVertexAttributes.length;a++)e.push(r.paintVertexAttributes[a].name)}return e}getBinderUniforms(){const e=[];for(const n in this.binders){const r=this.binders[n];if(r instanceof Dc||r instanceof ol||r instanceof kr)for(const a of r.uniformNames)e.push(a)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,n){const r=[];for(const a in this.binders){const u=this.binders[a];if(u instanceof Dc||u instanceof ol||u instanceof kr){for(const d of u.uniformNames)if(n[d]){const f=u.getBinding(e,n[d],d);r.push({name:d,property:a,binding:f})}}}return r}setUniforms(e,n,r,a){for(const{name:u,property:d,binding:f}of n)this.binders[d].setUniform(f,a,r.get(d),u)}updatePaintBuffers(e){this._buffers=[];for(const n in this.binders){const r=this.binders[n];if(e&&r instanceof ss){const a=e.fromScale===2?r.zoomInPaintVertexBuffer:r.zoomOutPaintVertexBuffer;a&&this._buffers.push(a)}else(r instanceof Io||r instanceof kr)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}}upload(e){for(const n in this.binders){const r=this.binders[n];(r instanceof Io||r instanceof kr||r instanceof ss)&&r.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const n=this.binders[e];(n instanceof Io||n instanceof kr||n instanceof ss)&&n.destroy()}}}class sa{constructor(e,n,r=()=>!0){this.programConfigurations={};for(const a of e)this.programConfigurations[a.id]=new as(a,n,r);this.needsUpload=!1,this._featureMap=new Sh,this._bufferOffset=0}populatePaintArrays(e,n,r,a,u,d,f){for(const g in this.programConfigurations)this.programConfigurations[g].populatePaintArrays(e,n,a,u,d,f);n.id!==void 0&&this._featureMap.add(n.id,r,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,n,r,a,u){for(const d of r)this.needsUpload=this.programConfigurations[d.id].updatePaintArrays(e,this._featureMap,n,d,a,u)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const n in this.programConfigurations)this.programConfigurations[n].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const hx={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"line-dasharray":["dash_to","dash_from"]};function dx(i,e){return hx[i]||[i.replace(`${e}-`,"").replace(/-/g,"_")]}const px={"line-pattern":{source:ge,composite:ge},"fill-pattern":{source:ge,composite:ge},"fill-extrusion-pattern":{source:ge,composite:ge},"line-dasharray":{source:Ae,composite:Ae}},fx={color:{source:$t,composite:ki},number:{source:ot,composite:$t}};function Ym(i,e,n){const r=px[i];return r&&r[n]||fx[e][n]}nt(Dc),nt(ol),nt(Io),nt(ss),nt(kr),nt(as,{omit:["_buffers"]}),nt(sa);const kh="-transition";class Dr extends St{constructor(e,n){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,e.type!=="custom"&&(this.metadata=(e=e).metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&e.type!=="sky"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),n.layout&&(this._unevaluatedLayout=new h(n.layout)),n.paint)){this._transitionablePaint=new l(n.paint);for(const r in e.paint)this.setPaintProperty(r,e.paint[r],{validate:!1});for(const r in e.layout)this.setLayoutProperty(r,e.layout[r],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new _(n.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,n,r={}){n!=null&&this._validate(up,`layers.${this.id}.layout.${e}`,e,n,r)||(e!=="visibility"?this._unevaluatedLayout.setValue(e,n):this.visibility=n)}getPaintProperty(e){return Kt(e,kh)?this._transitionablePaint.getTransition(e.slice(0,-kh.length)):this._transitionablePaint.getValue(e)}setPaintProperty(e,n,r={}){if(n!=null&&this._validate(cp,`layers.${this.id}.paint.${e}`,e,n,r))return!1;if(Kt(e,kh))return this._transitionablePaint.setTransition(e.slice(0,-kh.length),n||void 0),!1;{const a=this._transitionablePaint._values[e],u=a.property.specification["property-type"]==="cross-faded-data-driven",d=a.value.isDataDriven(),f=a.value;this._transitionablePaint.setValue(e,n),this._handleSpecialPaintPropertyUpdate(e);const g=this._transitionablePaint._values[e].value;return g.isDataDriven()||d||u||this._handleOverridablePaintPropertyUpdate(e,f,g)}}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getProgramConfiguration(e){return null}_handleOverridablePaintPropertyUpdate(e,n,r){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,n){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,n)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,n)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),Un(e,(n,r)=>!(n===void 0||r==="layout"&&!Object.keys(n).length||r==="paint"&&!Object.keys(n).length))}_validate(e,n,r,a,u={}){return(!u||u.validate!==!1)&&uh(this,e.call(Ks,{key:n,layerType:this.type,objectKey:r,value:a,styleSpec:ve,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const n=this.paint.get(e);if(n instanceof m&&$o(n.property.specification)&&(n.value.kind==="source"||n.value.kind==="composite")&&n.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=Gr(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const mx=$([{name:"a_pos",components:2,type:"Int16"}],4),_x=$([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"},{name:"a_scale",components:1,type:"Float32"}]);class Oi{constructor(e=[]){this.segments=e}prepareSegment(e,n,r,a){let u=this.segments[this.segments.length-1];return e>Oi.MAX_VERTEX_ARRAY_LENGTH&&Gt(`Max vertices per segment is ${Oi.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!u||u.vertexLength+e>Oi.MAX_VERTEX_ARRAY_LENGTH||u.sortKey!==a)&&(u={vertexOffset:n.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0},a!==void 0&&(u.sortKey=a),this.segments.push(u)),u}get(){return this.segments}destroy(){for(const e of this.segments)for(const n in e.vaos)e.vaos[n].destroy()}static simpleSegment(e,n,r,a){return new Oi([{vertexOffset:e,primitiveOffset:n,vertexLength:r,primitiveLength:a,vaos:{},sortKey:0}])}}Oi.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,nt(Oi);var Rt=8192;class ls{constructor(e,n){e&&(n?this.setSouthWest(e).setNorthEast(n):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof fi?new fi(e.lng,e.lat):fi.convert(e),this}setSouthWest(e){return this._sw=e instanceof fi?new fi(e.lng,e.lat):fi.convert(e),this}extend(e){const n=this._sw,r=this._ne;let a,u;if(e instanceof fi)a=e,u=e;else{if(!(e instanceof ls))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(ls.convert(e)):this.extend(fi.convert(e)):this;if(a=e._sw,u=e._ne,!a||!u)return this}return n||r?(n.lng=Math.min(a.lng,n.lng),n.lat=Math.min(a.lat,n.lat),r.lng=Math.max(u.lng,r.lng),r.lat=Math.max(u.lat,r.lat)):(this._sw=new fi(a.lng,a.lat),this._ne=new fi(u.lng,u.lat)),this}getCenter(){return new fi((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new fi(this.getWest(),this.getNorth())}getSouthEast(){return new fi(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:n,lat:r}=fi.convert(e);let a=this._sw.lng<=n&&n<=this._ne.lng;return this._sw.lng>this._ne.lng&&(a=this._sw.lng>=n&&n>=this._ne.lng),this._sw.lat<=r&&r<=this._ne.lat&&a}static convert(e){return!e||e instanceof ls?e:new ls(e)}}const _p=63710088e-1;class fi{constructor(e,n){if(isNaN(e)||isNaN(n))throw new Error(`Invalid LngLat object: (${e}, ${n})`);if(this.lng=+e,this.lat=+n,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new fi(Li(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const n=Math.PI/180,r=this.lat*n,a=e.lat*n,u=Math.sin(r)*Math.sin(a)+Math.cos(r)*Math.cos(a)*Math.cos((e.lng-this.lng)*n);return _p*Math.acos(Math.min(u,1))}toBounds(e=0){const n=360*e/40075017,r=n/Math.cos(Math.PI/180*this.lat);return new ls(new fi(this.lng-r,this.lat-n),new fi(this.lng+r,this.lat+n))}static convert(e){if(e instanceof fi)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new fi(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new fi(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Xm=2*Math.PI*_p;function gp(i){return Xm*Math.cos(i*Math.PI/180)}function Pc(i){return(180+i)/360}function sl(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function al(i,e){return i/gp(e)}function yr(i){return 360*i-180}function cn(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}function Qm(i,e){return i*gp(cn(e))}const Xr=85.051129;class Dh{constructor(e,n,r=0){this.x=+e,this.y=+n,this.z=+r}static fromLngLat(e,n=0){const r=fi.convert(e);return new Dh(Pc(r.lng),sl(r.lat),al(n,r.lat))}toLngLat(){return new fi(yr(this.x),cn(this.y))}toAltitude(){return Qm(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Xm*(e=cn(this.y),1/Math.cos(e*Math.PI/180));var e}}function yp(i,e,n,r,a,u,d,f,g){const v=(e+r)/2,w=(n+a)/2,E=new Z(v,w);f(E),function(M,k,L,F,j,H){const ne=L-j,le=F-H;return Math.abs((F-k)*ne-(L-M)*le)/Math.hypot(ne,le)}(E.x,E.y,u.x,u.y,d.x,d.y)>=g?(yp(i,e,n,v,w,u,E,f,g),yp(i,v,w,r,a,E,d,f,g)):i.push(d)}function gx(i,e,n){let r=i[0],a=r.x,u=r.y;e(r);const d=[r];for(let f=1;f<i.length;f++){const g=i[f],{x:v,y:w}=g;e(g),yp(d,a,u,v,w,r,g,e,n),a=v,u=w,r=g}return d}const xp=Math.pow(2,14)-1,Km=-xp-1;function yx(i,e){const n=Math.round(i.x*e),r=Math.round(i.y*e);return i.x=At(n,Km,xp),i.y=At(r,Km,xp),(n<i.x||n>i.x+1||r<i.y||r>i.y+1)&&Gt("Geometry exceeds allowed extent, reduce your vector tile buffer size"),i}function zo(i,e,n){const r=i.loadGeometry(),a=i.extent,u=Rt/a;if(e&&n&&n.projection.isReprojectedInTileSpace){const d=1<<e.z,{scale:f,x:g,y:v,projection:w}=n,E=M=>{const k=yr((e.x+M.x/a)/d),L=cn((e.y+M.y/a)/d),F=w.project(k,L);M.x=(F.x*f-g)*a,M.y=(F.y*f-v)*a};for(let M=0;M<r.length;M++)if(i.type!==1)r[M]=gx(r[M],E,1);else{const k=[];for(const L of r[M])L.x<0||L.x>=a||L.y<0||L.y>=a||(E(L),k.push(L));r[M]=k}}for(const d of r)for(const f of d)yx(f,u);return r}function aa(i,e){return{type:i.type,id:i.id,properties:i.properties,geometry:e?zo(i):[]}}function Ph(i,e,n,r,a){i.emplaceBack(2*e+(r+1)/2,2*n+(a+1)/2)}function Bh(i,e,n,r){i.emplaceBack(e.x,e.y,e.z,n[0]*16384,n[1]*16384,n[2]*16384,r)}class vp{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new Q,this.indexArray=new we,this.segments=new Oi,this.programConfigurations=new sa(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(e,n,r,a){const u=this.layers[0],d=[];let f=null;u.type==="circle"&&(f=u.layout.get("circle-sort-key"));for(const{feature:v,id:w,index:E,sourceLayerIndex:M}of e){const k=this.layers[0]._featureFilter.needGeometry,L=aa(v,k);if(!this.layers[0]._featureFilter.filter(new vi(this.zoom),L,r))continue;const F=f?f.evaluate(L,{},r):void 0,j={id:w,properties:v.properties,type:v.type,sourceLayerIndex:M,index:E,geometry:k?L.geometry:zo(v,r,a),patterns:{},sortKey:F};d.push(j)}f&&d.sort((v,w)=>v.sortKey-w.sortKey);let g=null;a.projection.name==="globe"&&(this.globeExtVertexArray=new Mo,g=a.projection);for(const v of d){const{geometry:w,index:E,sourceLayerIndex:M}=v,k=e[E].feature;this.addFeature(v,w,E,n.availableImages,r,g),n.featureIndex.insert(k,w,E,M,this.index)}}update(e,n,r,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,r,a)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,mx.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,_x.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(e,n,r,a,u,d){for(const f of n)for(const g of f){const v=g.x,w=g.y;if(v<0||v>=Rt||w<0||w>=Rt)continue;if(d){const k=d.projectTilePoint(v,w,u),L=d.upVector(u,v,w),F=cn((w/Rt+u.y)/(1<<u.z)),j=d.pixelsPerMeter(F,1)/al(1,F),H=this.globeExtVertexArray;Bh(H,k,L,j),Bh(H,k,L,j),Bh(H,k,L,j),Bh(H,k,L,j)}const E=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),M=E.vertexLength;Ph(this.layoutVertexArray,v,w,-1,-1),Ph(this.layoutVertexArray,v,w,1,-1),Ph(this.layoutVertexArray,v,w,1,1),Ph(this.layoutVertexArray,v,w,-1,1),this.indexArray.emplaceBack(M,M+1,M+2),this.indexArray.emplaceBack(M,M+3,M+2),E.vertexLength+=4,E.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,{},a,u)}}function $m(i,e){for(let n=0;n<i.length;n++)if(ll(e,i[n]))return!0;for(let n=0;n<e.length;n++)if(ll(i,e[n]))return!0;return!!bp(i,e)}function xx(i,e,n){return!!ll(i,e)||!!Ap(e,i,n)}function Jm(i,e){if(i.length===1)return t_(e,i[0]);for(let n=0;n<e.length;n++){const r=e[n];for(let a=0;a<r.length;a++)if(ll(i,r[a]))return!0}for(let n=0;n<i.length;n++)if(t_(e,i[n]))return!0;for(let n=0;n<e.length;n++)if(bp(i,e[n]))return!0;return!1}function vx(i,e,n){if(i.length>1){if(bp(i,e))return!0;for(let r=0;r<e.length;r++)if(Ap(e[r],i,n))return!0}for(let r=0;r<i.length;r++)if(Ap(i[r],e,n))return!0;return!1}function bp(i,e){if(i.length===0||e.length===0)return!1;for(let n=0;n<i.length-1;n++){const r=i[n],a=i[n+1];for(let u=0;u<e.length-1;u++)if(bx(r,a,e[u],e[u+1]))return!0}return!1}function bx(i,e,n,r){return Wi(i,n,r)!==Wi(e,n,r)&&Wi(i,e,n)!==Wi(i,e,r)}function Ap(i,e,n){const r=n*n;if(e.length===1)return i.distSqr(e[0])<r;for(let a=1;a<e.length;a++)if(e_(i,e[a-1],e[a])<r)return!0;return!1}function e_(i,e,n){const r=e.distSqr(n);if(r===0)return i.distSqr(e);const a=((i.x-e.x)*(n.x-e.x)+(i.y-e.y)*(n.y-e.y))/r;return i.distSqr(a<0?e:a>1?n:n.sub(e)._mult(a)._add(e))}function t_(i,e){let n,r,a,u=!1;for(let d=0;d<i.length;d++){n=i[d];for(let f=0,g=n.length-1;f<n.length;g=f++)r=n[f],a=n[g],r.y>e.y!=a.y>e.y&&e.x<(a.x-r.x)*(e.y-r.y)/(a.y-r.y)+r.x&&(u=!u)}return u}function ll(i,e){let n=!1;for(let r=0,a=i.length-1;r<i.length;a=r++){const u=i[r],d=i[a];u.y>e.y!=d.y>e.y&&e.x<(d.x-u.x)*(e.y-u.y)/(d.y-u.y)+u.x&&(n=!n)}return n}function i_(i,e,n,r,a){for(const d of i)if(e<=d.x&&n<=d.y&&r>=d.x&&a>=d.y)return!0;const u=[new Z(e,n),new Z(e,a),new Z(r,a),new Z(r,n)];if(i.length>2){for(const d of u)if(ll(i,d))return!0}for(let d=0;d<i.length-1;d++)if(Ax(i[d],i[d+1],u))return!0;return!1}function Ax(i,e,n){const r=n[0],a=n[2];if(i.x<r.x&&e.x<r.x||i.x>a.x&&e.x>a.x||i.y<r.y&&e.y<r.y||i.y>a.y&&e.y>a.y)return!1;const u=Wi(i,e,n[0]);return u!==Wi(i,e,n[1])||u!==Wi(i,e,n[2])||u!==Wi(i,e,n[3])}function cl(i,e,n){const r=e.paint.get(i).value;return r.kind==="constant"?r.value:n.programConfigurations.get(e.id).getMaxValue(i)}function Lh(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}function n_(i,e,n,r,a){if(!e[0]&&!e[1])return i;const u=Z.convert(e)._mult(a);n==="viewport"&&u._rotate(-r);const d=[];for(let f=0;f<i.length;f++)d.push(i[f].sub(u));return d}function r_(i,e,n,r){const a=Z.convert(i)._mult(r);return e==="viewport"&&a._rotate(-n),a}nt(vp,{omit:["layers"]});const wx=new B({"circle-sort-key":new A(ve.layout_circle["circle-sort-key"])});var Tx={paint:new B({"circle-radius":new A(ve.paint_circle["circle-radius"]),"circle-color":new A(ve.paint_circle["circle-color"]),"circle-blur":new A(ve.paint_circle["circle-blur"]),"circle-opacity":new A(ve.paint_circle["circle-opacity"]),"circle-translate":new x(ve.paint_circle["circle-translate"]),"circle-translate-anchor":new x(ve.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new x(ve.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new x(ve.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new A(ve.paint_circle["circle-stroke-width"]),"circle-stroke-color":new A(ve.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new A(ve.paint_circle["circle-stroke-opacity"])}),layout:wx},wp=1e-6,qn=typeof Float32Array!="undefined"?Float32Array:Array;function o_(){var i=new qn(9);return qn!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[5]=0,i[6]=0,i[7]=0),i[0]=1,i[4]=1,i[8]=1,i}function Qr(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function Tp(i,e,n){var r=e[0],a=e[1],u=e[2],d=e[3],f=e[4],g=e[5],v=e[6],w=e[7],E=e[8],M=e[9],k=e[10],L=e[11],F=e[12],j=e[13],H=e[14],ne=e[15],le=n[0],ue=n[1],he=n[2],de=n[3];return i[0]=le*r+ue*f+he*E+de*F,i[1]=le*a+ue*g+he*M+de*j,i[2]=le*u+ue*v+he*k+de*H,i[3]=le*d+ue*w+he*L+de*ne,i[4]=(le=n[4])*r+(ue=n[5])*f+(he=n[6])*E+(de=n[7])*F,i[5]=le*a+ue*g+he*M+de*j,i[6]=le*u+ue*v+he*k+de*H,i[7]=le*d+ue*w+he*L+de*ne,i[8]=(le=n[8])*r+(ue=n[9])*f+(he=n[10])*E+(de=n[11])*F,i[9]=le*a+ue*g+he*M+de*j,i[10]=le*u+ue*v+he*k+de*H,i[11]=le*d+ue*w+he*L+de*ne,i[12]=(le=n[12])*r+(ue=n[13])*f+(he=n[14])*E+(de=n[15])*F,i[13]=le*a+ue*g+he*M+de*j,i[14]=le*u+ue*v+he*k+de*H,i[15]=le*d+ue*w+he*L+de*ne,i}function la(i,e,n){var r,a,u,d,f,g,v,w,E,M,k,L,F=n[0],j=n[1],H=n[2];return e===i?(i[12]=e[0]*F+e[4]*j+e[8]*H+e[12],i[13]=e[1]*F+e[5]*j+e[9]*H+e[13],i[14]=e[2]*F+e[6]*j+e[10]*H+e[14],i[15]=e[3]*F+e[7]*j+e[11]*H+e[15]):(a=e[1],u=e[2],d=e[3],f=e[4],g=e[5],v=e[6],w=e[7],E=e[8],M=e[9],k=e[10],L=e[11],i[0]=r=e[0],i[1]=a,i[2]=u,i[3]=d,i[4]=f,i[5]=g,i[6]=v,i[7]=w,i[8]=E,i[9]=M,i[10]=k,i[11]=L,i[12]=r*F+f*j+E*H+e[12],i[13]=a*F+g*j+M*H+e[13],i[14]=u*F+v*j+k*H+e[14],i[15]=d*F+w*j+L*H+e[15]),i}function cs(i,e,n){var r=n[0],a=n[1],u=n[2];return i[0]=e[0]*r,i[1]=e[1]*r,i[2]=e[2]*r,i[3]=e[3]*r,i[4]=e[4]*a,i[5]=e[5]*a,i[6]=e[6]*a,i[7]=e[7]*a,i[8]=e[8]*u,i[9]=e[9]*u,i[10]=e[10]*u,i[11]=e[11]*u,i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15],i}function Ep(i,e,n){var r=Math.sin(n),a=Math.cos(n),u=e[4],d=e[5],f=e[6],g=e[7],v=e[8],w=e[9],E=e[10],M=e[11];return e!==i&&(i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[4]=u*a+v*r,i[5]=d*a+w*r,i[6]=f*a+E*r,i[7]=g*a+M*r,i[8]=v*a-u*r,i[9]=w*a-d*r,i[10]=E*a-f*r,i[11]=M*a-g*r,i}function Cp(i,e,n){var r=Math.sin(n),a=Math.cos(n),u=e[0],d=e[1],f=e[2],g=e[3],v=e[8],w=e[9],E=e[10],M=e[11];return e!==i&&(i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[0]=u*a-v*r,i[1]=d*a-w*r,i[2]=f*a-E*r,i[3]=g*a-M*r,i[8]=u*r+v*a,i[9]=d*r+w*a,i[10]=f*r+E*a,i[11]=g*r+M*a,i}Math.hypot||(Math.hypot=function(){for(var i=0,e=arguments.length;e--;)i+=arguments[e]*arguments[e];return Math.sqrt(i)});var Ex=Tp;function Mp(){var i=new qn(3);return qn!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i}function s_(i){var e=new qn(3);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e}function a_(i){return Math.hypot(i[0],i[1],i[2])}function Bc(i,e,n){var r=new qn(3);return r[0]=i,r[1]=e,r[2]=n,r}function l_(i,e,n){return i[0]=e[0]+n[0],i[1]=e[1]+n[1],i[2]=e[2]+n[2],i}function c_(i,e,n){return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],i}function u_(i,e,n){return i[0]=e[0]*n[0],i[1]=e[1]*n[1],i[2]=e[2]*n[2],i}function Sp(i,e,n){return i[0]=Math.min(e[0],n[0]),i[1]=Math.min(e[1],n[1]),i[2]=Math.min(e[2],n[2]),i}function Ip(i,e,n){return i[0]=Math.max(e[0],n[0]),i[1]=Math.max(e[1],n[1]),i[2]=Math.max(e[2],n[2]),i}function Lc(i,e,n){return i[0]=e[0]*n,i[1]=e[1]*n,i[2]=e[2]*n,i}function zp(i,e,n,r){return i[0]=e[0]+n[0]*r,i[1]=e[1]+n[1]*r,i[2]=e[2]+n[2]*r,i}function Rc(i,e){var n=e[0],r=e[1],a=e[2],u=n*n+r*r+a*a;return u>0&&(u=1/Math.sqrt(u)),i[0]=e[0]*u,i[1]=e[1]*u,i[2]=e[2]*u,i}function Oc(i,e){return i[0]*e[0]+i[1]*e[1]+i[2]*e[2]}function h_(i,e,n){var r=e[0],a=e[1],u=e[2],d=n[0],f=n[1],g=n[2];return i[0]=a*g-u*f,i[1]=u*d-r*g,i[2]=r*f-a*d,i}function ca(i,e,n){var r=e[0],a=e[1],u=e[2],d=n[3]*r+n[7]*a+n[11]*u+n[15];return i[0]=(n[0]*r+n[4]*a+n[8]*u+n[12])/(d=d||1),i[1]=(n[1]*r+n[5]*a+n[9]*u+n[13])/d,i[2]=(n[2]*r+n[6]*a+n[10]*u+n[14])/d,i}function d_(i,e,n){var r=n[0],a=n[1],u=n[2],d=e[0],f=e[1],g=e[2],v=a*g-u*f,w=u*d-r*g,E=r*f-a*d,M=a*E-u*w,k=u*v-r*E,L=r*w-a*v,F=2*n[3];return w*=F,E*=F,k*=2,L*=2,i[0]=d+(v*=F)+(M*=2),i[1]=f+w+k,i[2]=g+E+L,i}var Fc,ul=c_,Cx=u_,Mx=a_;function hl(i,e,n){var r=e[0],a=e[1],u=e[2],d=e[3];return i[0]=n[0]*r+n[4]*a+n[8]*u+n[12]*d,i[1]=n[1]*r+n[5]*a+n[9]*u+n[13]*d,i[2]=n[2]*r+n[6]*a+n[10]*u+n[14]*d,i[3]=n[3]*r+n[7]*a+n[11]*u+n[15]*d,i}function p_(){var i=new qn(4);return qn!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i[3]=1,i}function f_(i){return i[0]=0,i[1]=0,i[2]=0,i[3]=1,i}function m_(i,e,n){n*=.5;var r=e[0],a=e[1],u=e[2],d=e[3],f=Math.sin(n),g=Math.cos(n);return i[0]=r*g+d*f,i[1]=a*g+u*f,i[2]=u*g-a*f,i[3]=d*g-r*f,i}Mp(),Fc=new qn(4),qn!=Float32Array&&(Fc[0]=0,Fc[1]=0,Fc[2]=0,Fc[3]=0),Mp(),Bc(1,0,0),Bc(0,1,0),p_(),p_(),o_();class kp{constructor(e,n){this.points=e,this.planes=n}static fromInvProjectionMatrix(e,n,r,a){const u=Math.pow(2,r),d=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(g=>{const v=hl([],g,e),w=1/v[3]/n*u;return function(E,M,k){return E[0]=M[0]*k[0],E[1]=M[1]*k[1],E[2]=M[2]*k[2],E[3]=M[3]*k[3],E}(v,v,[w,w,a?1/v[3]:w,w])}),f=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(g=>{const v=Rc([],h_([],ul([],d[g[0]],d[g[1]]),ul([],d[g[2]],d[g[1]]))),w=-Oc(v,d[g[1]]);return v.concat(w)});return new kp(d,f)}}class ar{constructor(e,n){this.min=e,this.max=n,this.center=Lc([],l_([],this.min,this.max),.5)}quadrant(e){const n=[e%2==0,e<2],r=s_(this.min),a=s_(this.max);for(let u=0;u<n.length;u++)r[u]=n[u]?this.min[u]:this.center[u],a[u]=n[u]?this.center[u]:this.max[u];return a[2]=this.max[2],new ar(r,a)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,n=this.max;return[[e[0],e[1],e[2]],[n[0],e[1],e[2]],[n[0],n[1],e[2]],[e[0],n[1],e[2]],[e[0],e[1],n[2]],[n[0],e[1],n[2]],[n[0],n[1],n[2]],[e[0],n[1],n[2]]]}intersects(e){const n=this.getCorners();let r=!0;for(let a=0;a<e.planes.length;a++){const u=e.planes[a];let d=0;for(let f=0;f<n.length;f++)d+=Oc(u,n[f])+u[3]>=0;if(d===0)return 0;d!==n.length&&(r=!1)}if(r)return 2;for(let a=0;a<3;a++){let u=Number.MAX_VALUE,d=-Number.MAX_VALUE;for(let f=0;f<e.points.length;f++){const g=e.points[f][a]-this.min[a];u=Math.min(u,g),d=Math.max(d,g)}if(d<0||u>this.max[a]-this.min[a])return 0}return 1}}function __(i,e,n,r,a,u,d,f,g){if(u&&i.queryGeometry.isAboveHorizon)return!1;u&&(g*=i.pixelToTileUnitsFactor);for(const v of e)for(const w of v){const E=w.add(f),M=a&&n.elevation?n.elevation.exaggeration()*a.getElevationAt(E.x,E.y,!0):0,k=u?E:Sx(E,M,r),L=u?i.tilespaceRays.map(j=>zx(j,M)):i.queryGeometry.screenGeometry,F=hl([],[w.x,w.y,M,1],r);if(!d&&u?g*=F[3]/n.cameraToCenterDistance:d&&!u&&(g*=n.cameraToCenterDistance/F[3]),xx(L,k,g))return!0}return!1}function Sx(i,e,n){const r=hl([],[i.x,i.y,e,1],n);return new Z(r[0]/r[3],r[1]/r[3])}const g_=Bc(0,0,0),Ix=Bc(0,0,1);function zx(i,e){const n=Mp();return g_[2]=e,i.intersectsPlane(g_,Ix,n),new Z(n[0],n[1])}class y_ extends vp{}function x_(i,{width:e,height:n},r,a){if(a){if(a instanceof Uint8ClampedArray)a=new Uint8Array(a.buffer);else if(a.length!==e*n*r)throw new RangeError("mismatched image size")}else a=new Uint8Array(e*n*r);return i.width=e,i.height=n,i.data=a,i}function v_(i,e,n){const{width:r,height:a}=e;r===i.width&&a===i.height||(Dp(i,e,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,r),height:Math.min(i.height,a)},n),i.width=r,i.height=a,i.data=e.data)}function Dp(i,e,n,r,a,u){if(a.width===0||a.height===0)return e;if(a.width>i.width||a.height>i.height||n.x>i.width-a.width||n.y>i.height-a.height)throw new RangeError("out of range source coordinates for image copy");if(a.width>e.width||a.height>e.height||r.x>e.width-a.width||r.y>e.height-a.height)throw new RangeError("out of range destination coordinates for image copy");const d=i.data,f=e.data;for(let g=0;g<a.height;g++){const v=((n.y+g)*i.width+n.x)*u,w=((r.y+g)*e.width+r.x)*u;for(let E=0;E<a.width*u;E++)f[w+E]=d[v+E]}return e}nt(y_,{omit:["layers"]});class ko{constructor(e,n){x_(this,e,1,n)}resize(e){v_(this,new ko(e),1)}clone(){return new ko({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,n,r,a,u){Dp(e,n,r,a,u,1)}}class Wn{constructor(e,n){x_(this,e,4,n)}resize(e){v_(this,new Wn(e),4)}replace(e,n){n?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Wn({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,n,r,a,u){Dp(e,n,r,a,u,4)}}nt(ko),nt(Wn);var kx={paint:new B({"heatmap-radius":new A(ve.paint_heatmap["heatmap-radius"]),"heatmap-weight":new A(ve.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new x(ve.paint_heatmap["heatmap-intensity"]),"heatmap-color":new z(ve.paint_heatmap["heatmap-color"]),"heatmap-opacity":new x(ve.paint_heatmap["heatmap-opacity"])})};function Pp(i){const e={},n=i.resolution||256,r=i.clips?i.clips.length:1,a=i.image||new Wn({width:n,height:r}),u=(d,f,g)=>{e[i.evaluationKey]=g;const v=i.expression.evaluate(e);a.data[d+f+0]=Math.floor(255*v.r/v.a),a.data[d+f+1]=Math.floor(255*v.g/v.a),a.data[d+f+2]=Math.floor(255*v.b/v.a),a.data[d+f+3]=Math.floor(255*v.a)};if(i.clips)for(let d=0,f=0;d<r;++d,f+=4*n)for(let g=0,v=0;g<n;g++,v+=4){const w=g/(n-1),{start:E,end:M}=i.clips[d];u(f,v,E*(1-w)+M*w)}else for(let d=0,f=0;d<n;d++,f+=4)u(0,f,d/(n-1));return a}var Dx={paint:new B({"hillshade-illumination-direction":new x(ve.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new x(ve.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new x(ve.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new x(ve.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new x(ve.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new x(ve.paint_hillshade["hillshade-accent-color"])})};const Px=$([{name:"a_pos",components:2,type:"Int16"}],4),{members:Bx}=Px;var Rh=Oh,Lx=Oh;function Oh(i,e,n){n=n||2;var r,a,u,d,f,g,v,w=e&&e.length,E=w?e[0]*n:i.length,M=b_(i,0,E,n,!0),k=[];if(!M||M.next===M.prev)return k;if(w&&(M=function(F,j,H,ne){var le,ue,he,de=[];for(le=0,ue=j.length;le<ue;le++)(he=b_(F,j[le]*ne,le<ue-1?j[le+1]*ne:F.length,ne,!1))===he.next&&(he.steiner=!0),de.push(Gx(he));for(de.sort(Ux),le=0;le<de.length;le++)H=us(H=Vx(de[le],H),H.next);return H}(i,e,M,n)),i.length>80*n){r=u=i[0],a=d=i[1];for(var L=n;L<E;L+=n)(f=i[L])<r&&(r=f),(g=i[L+1])<a&&(a=g),f>u&&(u=f),g>d&&(d=g);v=(v=Math.max(u-r,d-a))!==0?1/v:0}return Nc(M,k,n,r,a,v),k}function b_(i,e,n,r,a){var u,d;if(a===Rp(i,e,n,r)>0)for(u=e;u<n;u+=r)d=T_(u,i[u],i[u+1],d);else for(u=n-r;u>=e;u-=r)d=T_(u,i[u],i[u+1],d);return d&&Fh(d,d.next)&&(Vc(d),d=d.next),d}function us(i,e){if(!i)return i;e||(e=i);var n,r=i;do if(n=!1,r.steiner||!Fh(r,r.next)&&Zi(r.prev,r,r.next)!==0)r=r.next;else{if(Vc(r),(r=e=r.prev)===r.next)break;n=!0}while(n||r!==e);return e}function Nc(i,e,n,r,a,u,d){if(i){!d&&u&&function(w,E,M,k){var L=w;do L.z===null&&(L.z=Bp(L.x,L.y,E,M,k)),L.prevZ=L.prev,L.nextZ=L.next,L=L.next;while(L!==w);L.prevZ.nextZ=null,L.prevZ=null,function(F){var j,H,ne,le,ue,he,de,Te,Me=1;do{for(H=F,F=null,ue=null,he=0;H;){for(he++,ne=H,de=0,j=0;j<Me&&(de++,ne=ne.nextZ);j++);for(Te=Me;de>0||Te>0&&ne;)de!==0&&(Te===0||!ne||H.z<=ne.z)?(le=H,H=H.nextZ,de--):(le=ne,ne=ne.nextZ,Te--),ue?ue.nextZ=le:F=le,le.prevZ=ue,ue=le;H=ne}ue.nextZ=null,Me*=2}while(he>1)}(L)}(i,r,a,u);for(var f,g,v=i;i.prev!==i.next;)if(f=i.prev,g=i.next,u?Ox(i,r,a,u):Rx(i))e.push(f.i/n),e.push(i.i/n),e.push(g.i/n),Vc(i),i=g.next,v=g.next;else if((i=g)===v){d?d===1?Nc(i=Fx(us(i),e,n),e,n,r,a,u,2):d===2&&Nx(i,e,n,r,a,u):Nc(us(i),e,n,r,a,u,1);break}}}function Rx(i){var e=i.prev,n=i,r=i.next;if(Zi(e,n,r)>=0)return!1;for(var a=i.next.next;a!==i.prev;){if(dl(e.x,e.y,n.x,n.y,r.x,r.y,a.x,a.y)&&Zi(a.prev,a,a.next)>=0)return!1;a=a.next}return!0}function Ox(i,e,n,r){var a=i.prev,u=i,d=i.next;if(Zi(a,u,d)>=0)return!1;for(var f=a.x>u.x?a.x>d.x?a.x:d.x:u.x>d.x?u.x:d.x,g=a.y>u.y?a.y>d.y?a.y:d.y:u.y>d.y?u.y:d.y,v=Bp(a.x<u.x?a.x<d.x?a.x:d.x:u.x<d.x?u.x:d.x,a.y<u.y?a.y<d.y?a.y:d.y:u.y<d.y?u.y:d.y,e,n,r),w=Bp(f,g,e,n,r),E=i.prevZ,M=i.nextZ;E&&E.z>=v&&M&&M.z<=w;){if(E!==i.prev&&E!==i.next&&dl(a.x,a.y,u.x,u.y,d.x,d.y,E.x,E.y)&&Zi(E.prev,E,E.next)>=0||(E=E.prevZ,M!==i.prev&&M!==i.next&&dl(a.x,a.y,u.x,u.y,d.x,d.y,M.x,M.y)&&Zi(M.prev,M,M.next)>=0))return!1;M=M.nextZ}for(;E&&E.z>=v;){if(E!==i.prev&&E!==i.next&&dl(a.x,a.y,u.x,u.y,d.x,d.y,E.x,E.y)&&Zi(E.prev,E,E.next)>=0)return!1;E=E.prevZ}for(;M&&M.z<=w;){if(M!==i.prev&&M!==i.next&&dl(a.x,a.y,u.x,u.y,d.x,d.y,M.x,M.y)&&Zi(M.prev,M,M.next)>=0)return!1;M=M.nextZ}return!0}function Fx(i,e,n){var r=i;do{var a=r.prev,u=r.next.next;!Fh(a,u)&&A_(a,r,r.next,u)&&Uc(a,u)&&Uc(u,a)&&(e.push(a.i/n),e.push(r.i/n),e.push(u.i/n),Vc(r),Vc(r.next),r=i=u),r=r.next}while(r!==i);return us(r)}function Nx(i,e,n,r,a,u){var d=i;do{for(var f=d.next.next;f!==d.prev;){if(d.i!==f.i&&Zx(d,f)){var g=w_(d,f);return d=us(d,d.next),g=us(g,g.next),Nc(d,e,n,r,a,u),void Nc(g,e,n,r,a,u)}f=f.next}d=d.next}while(d!==i)}function Ux(i,e){return i.x-e.x}function Vx(i,e){var n=function(u,d){var f,g=d,v=u.x,w=u.y,E=-1/0;do{if(w<=g.y&&w>=g.next.y&&g.next.y!==g.y){var M=g.x+(w-g.y)*(g.next.x-g.x)/(g.next.y-g.y);if(M<=v&&M>E){if(E=M,M===v){if(w===g.y)return g;if(w===g.next.y)return g.next}f=g.x<g.next.x?g:g.next}}g=g.next}while(g!==d);if(!f)return null;if(v===E)return f;var k,L=f,F=f.x,j=f.y,H=1/0;g=f;do v>=g.x&&g.x>=F&&v!==g.x&&dl(w<j?v:E,w,F,j,w<j?E:v,w,g.x,g.y)&&(k=Math.abs(w-g.y)/(v-g.x),Uc(g,u)&&(k<H||k===H&&(g.x>f.x||g.x===f.x&&jx(f,g)))&&(f=g,H=k)),g=g.next;while(g!==L);return f}(i,e);if(!n)return e;var r=w_(n,i),a=us(n,n.next);return us(r,r.next),e===n?a:e}function jx(i,e){return Zi(i.prev,i,e.prev)<0&&Zi(e.next,i,i.next)<0}function Bp(i,e,n,r,a){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=32767*(i-n)*a)|i<<8))|i<<4))|i<<2))|i<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*a)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Gx(i){var e=i,n=i;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==i);return n}function dl(i,e,n,r,a,u,d,f){return(a-d)*(e-f)-(i-d)*(u-f)>=0&&(i-d)*(r-f)-(n-d)*(e-f)>=0&&(n-d)*(u-f)-(a-d)*(r-f)>=0}function Zx(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!function(n,r){var a=n;do{if(a.i!==n.i&&a.next.i!==n.i&&a.i!==r.i&&a.next.i!==r.i&&A_(a,a.next,n,r))return!0;a=a.next}while(a!==n);return!1}(i,e)&&(Uc(i,e)&&Uc(e,i)&&function(n,r){var a=n,u=!1,d=(n.x+r.x)/2,f=(n.y+r.y)/2;do a.y>f!=a.next.y>f&&a.next.y!==a.y&&d<(a.next.x-a.x)*(f-a.y)/(a.next.y-a.y)+a.x&&(u=!u),a=a.next;while(a!==n);return u}(i,e)&&(Zi(i.prev,i,e.prev)||Zi(i,e.prev,e))||Fh(i,e)&&Zi(i.prev,i,i.next)>0&&Zi(e.prev,e,e.next)>0)}function Zi(i,e,n){return(e.y-i.y)*(n.x-e.x)-(e.x-i.x)*(n.y-e.y)}function Fh(i,e){return i.x===e.x&&i.y===e.y}function A_(i,e,n,r){var a=Uh(Zi(i,e,n)),u=Uh(Zi(i,e,r)),d=Uh(Zi(n,r,i)),f=Uh(Zi(n,r,e));return a!==u&&d!==f||!(a!==0||!Nh(i,n,e))||!(u!==0||!Nh(i,r,e))||!(d!==0||!Nh(n,i,r))||!(f!==0||!Nh(n,e,r))}function Nh(i,e,n){return e.x<=Math.max(i.x,n.x)&&e.x>=Math.min(i.x,n.x)&&e.y<=Math.max(i.y,n.y)&&e.y>=Math.min(i.y,n.y)}function Uh(i){return i>0?1:i<0?-1:0}function Uc(i,e){return Zi(i.prev,i,i.next)<0?Zi(i,e,i.next)>=0&&Zi(i,i.prev,e)>=0:Zi(i,e,i.prev)<0||Zi(i,i.next,e)<0}function w_(i,e){var n=new Lp(i.i,i.x,i.y),r=new Lp(e.i,e.x,e.y),a=i.next,u=e.prev;return i.next=e,e.prev=i,n.next=a,a.prev=n,r.next=n,n.prev=r,u.next=r,r.prev=u,r}function T_(i,e,n,r){var a=new Lp(i,e,n);return r?(a.next=r.next,a.prev=r,r.next.prev=a,r.next=a):(a.prev=a,a.next=a),a}function Vc(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function Lp(i,e,n){this.i=i,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Rp(i,e,n,r){for(var a=0,u=e,d=n-r;u<n;u+=r)a+=(i[d]-i[u])*(i[u+1]+i[d+1]),d=u;return a}function qx(i,e,n,r,a){E_(i,e,n||0,r||i.length-1,a||Wx)}function E_(i,e,n,r,a){for(;r>n;){if(r-n>600){var u=r-n+1,d=e-n+1,f=Math.log(u),g=.5*Math.exp(2*f/3),v=.5*Math.sqrt(f*g*(u-g)/u)*(d-u/2<0?-1:1);E_(i,e,Math.max(n,Math.floor(e-d*g/u+v)),Math.min(r,Math.floor(e+(u-d)*g/u+v)),a)}var w=i[e],E=n,M=r;for(jc(i,n,e),a(i[r],w)>0&&jc(i,n,r);E<M;){for(jc(i,E,M),E++,M--;a(i[E],w)<0;)E++;for(;a(i[M],w)>0;)M--}a(i[n],w)===0?jc(i,n,M):jc(i,++M,r),M<=e&&(n=M+1),e<=M&&(r=M-1)}}function jc(i,e,n){var r=i[e];i[e]=i[n],i[n]=r}function Wx(i,e){return i<e?-1:i>e?1:0}function Op(i,e){const n=i.length;if(n<=1)return[i];const r=[];let a,u;for(let d=0;d<n;d++){const f=Le(i[d]);f!==0&&(i[d].area=Math.abs(f),u===void 0&&(u=f<0),u===f<0?(a&&r.push(a),a=[i[d]]):a.push(i[d]))}if(a&&r.push(a),e>1)for(let d=0;d<r.length;d++)r[d].length<=e||(qx(r[d],e,1,r[d].length-1,Hx),r[d]=r[d].slice(0,e));return r}function Hx(i,e){return e.area-i.area}function Fp(i,e,n){const r=n.patternDependencies;let a=!1;for(const u of e){const d=u.paint.get(`${i}-pattern`);d.isConstant()||(a=!0);const f=d.constantOr(null);f&&(a=!0,r[f.to]=!0,r[f.from]=!0)}return a}function Np(i,e,n,r,a){const u=a.patternDependencies;for(const d of e){const f=d.paint.get(`${i}-pattern`).value;if(f.kind!=="constant"){let g=f.evaluate({zoom:r-1},n,{},a.availableImages),v=f.evaluate({zoom:r},n,{},a.availableImages),w=f.evaluate({zoom:r+1},n,{},a.availableImages);g=g&&g.name?g.name:g,v=v&&v.name?v.name:v,w=w&&w.name?w.name:w,u[g]=!0,u[v]=!0,u[w]=!0,n.patterns[d.id]={min:g,mid:v,max:w}}}return n}Oh.deviation=function(i,e,n,r){var a=e&&e.length,u=Math.abs(Rp(i,0,a?e[0]*n:i.length,n));if(a)for(var d=0,f=e.length;d<f;d++)u-=Math.abs(Rp(i,e[d]*n,d<f-1?e[d+1]*n:i.length,n));var g=0;for(d=0;d<r.length;d+=3){var v=r[d]*n,w=r[d+1]*n,E=r[d+2]*n;g+=Math.abs((i[v]-i[E])*(i[w+1]-i[v+1])-(i[v]-i[w])*(i[E+1]-i[v+1]))}return u===0&&g===0?0:Math.abs((g-u)/u)},Oh.flatten=function(i){for(var e=i[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,a=0;a<i.length;a++){for(var u=0;u<i[a].length;u++)for(var d=0;d<e;d++)n.vertices.push(i[a][u][d]);a>0&&n.holes.push(r+=i[a-1].length)}return n},Rh.default=Lx;class Vh{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Q,this.indexArray=new we,this.indexArray2=new ht,this.programConfigurations=new sa(e.layers,e.zoom),this.segments=new Oi,this.segments2=new Oi,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id),this.projection=e.projection}populate(e,n,r,a){this.hasPattern=Fp("fill",this.layers,n);const u=this.layers[0].layout.get("fill-sort-key"),d=[];for(const{feature:f,id:g,index:v,sourceLayerIndex:w}of e){const E=this.layers[0]._featureFilter.needGeometry,M=aa(f,E);if(!this.layers[0]._featureFilter.filter(new vi(this.zoom),M,r))continue;const k=u?u.evaluate(M,{},r,n.availableImages):void 0,L={id:g,properties:f.properties,type:f.type,sourceLayerIndex:w,index:v,geometry:E?M.geometry:zo(f,r,a),patterns:{},sortKey:k};d.push(L)}u&&d.sort((f,g)=>f.sortKey-g.sortKey);for(const f of d){const{geometry:g,index:v,sourceLayerIndex:w}=f;if(this.hasPattern){const E=Np("fill",this.layers,f,this.zoom,n);this.patternFeatures.push(E)}else this.addFeature(f,g,v,r,{},n.availableImages);n.featureIndex.insert(e[v].feature,g,v,w,this.index)}}update(e,n,r,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,r,a)}addFeatures(e,n,r,a,u){for(const d of this.patternFeatures)this.addFeature(d,d.geometry,d.index,n,r,a)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Bx),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,n,r,a,u,d=[]){for(const f of Op(n,500)){let g=0;for(const L of f)g+=L.length;const v=this.segments.prepareSegment(g,this.layoutVertexArray,this.indexArray),w=v.vertexLength,E=[],M=[];for(const L of f){if(L.length===0)continue;L!==f[0]&&M.push(E.length/2);const F=this.segments2.prepareSegment(L.length,this.layoutVertexArray,this.indexArray2),j=F.vertexLength;this.layoutVertexArray.emplaceBack(L[0].x,L[0].y),this.indexArray2.emplaceBack(j+L.length-1,j),E.push(L[0].x),E.push(L[0].y);for(let H=1;H<L.length;H++)this.layoutVertexArray.emplaceBack(L[H].x,L[H].y),this.indexArray2.emplaceBack(j+H-1,j+H),E.push(L[H].x),E.push(L[H].y);F.vertexLength+=L.length,F.primitiveLength+=L.length}const k=Rh(E,M);for(let L=0;L<k.length;L+=3)this.indexArray.emplaceBack(w+k[L],w+k[L+1],w+k[L+2]);v.vertexLength+=g,v.primitiveLength+=k.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,u,d,a)}}nt(Vh,{omit:["layers","patternFeatures"]});const Yx=new B({"fill-sort-key":new A(ve.layout_fill["fill-sort-key"])});var Xx={paint:new B({"fill-antialias":new x(ve.paint_fill["fill-antialias"]),"fill-opacity":new A(ve.paint_fill["fill-opacity"]),"fill-color":new A(ve.paint_fill["fill-color"]),"fill-outline-color":new A(ve.paint_fill["fill-outline-color"]),"fill-translate":new x(ve.paint_fill["fill-translate"]),"fill-translate-anchor":new x(ve.paint_fill["fill-translate-anchor"]),"fill-pattern":new C(ve.paint_fill["fill-pattern"])}),layout:Yx};const Qx=$([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),Kx=$([{name:"a_centroid_pos",components:2,type:"Uint16"}]),$x=$([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:Jx}=Qx;var C_=pl;function pl(i,e,n,r,a){this.properties={},this.extent=n,this.type=0,this._pbf=i,this._geometry=-1,this._keys=r,this._values=a,i.readFields(ev,this,e)}function ev(i,e,n){i==1?e.id=n.readVarint():i==2?function(r,a){for(var u=r.readVarint()+r.pos;r.pos<u;){var d=a._keys[r.readVarint()],f=a._values[r.readVarint()];a.properties[d]=f}}(n,e):i==3?e.type=n.readVarint():i==4&&(e._geometry=n.pos)}function tv(i){for(var e,n,r=0,a=0,u=i.length,d=u-1;a<u;d=a++)r+=((n=i[d]).x-(e=i[a]).x)*(e.y+n.y);return r}pl.types=["Unknown","Point","LineString","Polygon"],pl.prototype.loadGeometry=function(){var i=this._pbf;i.pos=this._geometry;for(var e,n=i.readVarint()+i.pos,r=1,a=0,u=0,d=0,f=[];i.pos<n;){if(a<=0){var g=i.readVarint();r=7&g,a=g>>3}if(a--,r===1||r===2)u+=i.readSVarint(),d+=i.readSVarint(),r===1&&(e&&f.push(e),e=[]),e.push(new Z(u,d));else{if(r!==7)throw new Error("unknown command "+r);e&&e.push(e[0].clone())}}return e&&f.push(e),f},pl.prototype.bbox=function(){var i=this._pbf;i.pos=this._geometry;for(var e=i.readVarint()+i.pos,n=1,r=0,a=0,u=0,d=1/0,f=-1/0,g=1/0,v=-1/0;i.pos<e;){if(r<=0){var w=i.readVarint();n=7&w,r=w>>3}if(r--,n===1||n===2)(a+=i.readSVarint())<d&&(d=a),a>f&&(f=a),(u+=i.readSVarint())<g&&(g=u),u>v&&(v=u);else if(n!==7)throw new Error("unknown command "+n)}return[d,g,f,v]},pl.prototype.toGeoJSON=function(i,e,n){var r,a,u=this.extent*Math.pow(2,n),d=this.extent*i,f=this.extent*e,g=this.loadGeometry(),v=pl.types[this.type];function w(k){for(var L=0;L<k.length;L++){var F=k[L];k[L]=[360*(F.x+d)/u-180,360/Math.PI*Math.atan(Math.exp((180-360*(F.y+f)/u)*Math.PI/180))-90]}}switch(this.type){case 1:var E=[];for(r=0;r<g.length;r++)E[r]=g[r][0];w(g=E);break;case 2:for(r=0;r<g.length;r++)w(g[r]);break;case 3:for(g=function(k){var L=k.length;if(L<=1)return[k];for(var F,j,H=[],ne=0;ne<L;ne++){var le=tv(k[ne]);le!==0&&(j===void 0&&(j=le<0),j===le<0?(F&&H.push(F),F=[k[ne]]):F.push(k[ne]))}return F&&H.push(F),H}(g),r=0;r<g.length;r++)for(a=0;a<g[r].length;a++)w(g[r][a])}g.length===1?g=g[0]:v="Multi"+v;var M={type:"Feature",geometry:{type:v,coordinates:g},properties:this.properties};return"id"in this&&(M.id=this.id),M};var M_=S_;function S_(i,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(iv,this,e),this.length=this._features.length}function iv(i,e,n){i===15?e.version=n.readVarint():i===1?e.name=n.readString():i===5?e.extent=n.readVarint():i===2?e._features.push(n.pos):i===3?e._keys.push(n.readString()):i===4&&e._values.push(function(r){for(var a=null,u=r.readVarint()+r.pos;r.pos<u;){var d=r.readVarint()>>3;a=d===1?r.readString():d===2?r.readFloat():d===3?r.readDouble():d===4?r.readVarint64():d===5?r.readVarint():d===6?r.readSVarint():d===7?r.readBoolean():null}return a}(n))}function nv(i,e,n){if(i===3){var r=new M_(n,n.readVarint()+n.pos);r.length&&(e[r.name]=r)}}S_.prototype.feature=function(i){if(i<0||i>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[i];var e=this._pbf.readVarint()+this._pbf.pos;return new C_(this._pbf,e,this.extent,this._keys,this._values)};var ua={VectorTile:function(i,e){this.layers=i.readFields(nv,{},e)},VectorTileFeature:C_,VectorTileLayer:M_};function jh(i,e,n,r){const a=[],u=r===0?(d,f,g,v,w,E)=>{d.push(new Z(E,g+(E-f)/(v-f)*(w-g)))}:(d,f,g,v,w,E)=>{d.push(new Z(f+(E-g)/(w-g)*(v-f),E))};for(const d of i){const f=[];for(const g of d){if(g.length<=2)continue;const v=[];for(let M=0;M<g.length-1;M++){const k=g[M].x,L=g[M].y,F=g[M+1].x,j=g[M+1].y,H=r===0?k:L,ne=r===0?F:j;H<e?ne>e&&u(v,k,L,F,j,e):H>n?ne<n&&u(v,k,L,F,j,n):v.push(g[M]),ne<e&&H>=e&&u(v,k,L,F,j,e),ne>n&&H<=n&&u(v,k,L,F,j,n)}let w=g[g.length-1];const E=r===0?w.x:w.y;E>=e&&E<=n&&v.push(w),v.length&&(w=v[v.length-1],v[0].x===w.x&&v[0].y===w.y||v.push(v[0]),f.push(v))}f.length&&a.push(f)}return a}const rv=ua.VectorTileFeature.types,ov=Math.pow(2,13);function Gc(i,e,n,r,a,u,d,f){i.emplaceBack((e<<1)+d,(n<<1)+u,(Math.floor(r*ov)<<1)+a,Math.round(f))}function Zc(i,e,n){i.emplaceBack(e.x,e.y,e.z,n[0]*16384,n[1]*16384,n[2]*16384)}class I_{constructor(){this.acc=new Z(0,0),this.polyCount=[]}startRing(e){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new Z(e.x,e.y),this.max=new Z(e.x,e.y))}append(e,n){this.currentPolyCount.edges++,this.acc._add(e);const r=this.min,a=this.max;e.x<r.x?r.x=e.x:e.x>a.x&&(a.x=e.x),e.y<r.y?r.y=e.y:e.y>a.y&&(a.y=e.y),((e.x===0||e.x===Rt)&&e.x===n.x)!=((e.y===0||e.y===Rt)&&e.y===n.y)&&this.processBorderOverlap(e,n),n.x<0!=e.x<0&&this.addBorderIntersection(0,xt(n.y,e.y,(0-n.x)/(e.x-n.x))),n.x>Rt!=e.x>Rt&&this.addBorderIntersection(1,xt(n.y,e.y,(Rt-n.x)/(e.x-n.x))),n.y<0!=e.y<0&&this.addBorderIntersection(2,xt(n.x,e.x,(0-n.y)/(e.y-n.y))),n.y>Rt!=e.y>Rt&&this.addBorderIntersection(3,xt(n.x,e.x,(Rt-n.y)/(e.y-n.y)))}addBorderIntersection(e,n){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const r=this.borders[e];n<r[0]&&(r[0]=n),n>r[1]&&(r[1]=n)}processBorderOverlap(e,n){if(e.x===n.x){if(e.y===n.y)return;const r=e.x===0?0:1;this.addBorderIntersection(r,n.y),this.addBorderIntersection(r,e.y)}else{const r=e.y===0?2:3;this.addBorderIntersection(r,n.x),this.addBorderIntersection(r,e.x)}}centroid(){const e=this.polyCount.reduce((n,r)=>n+r.edges,0);return e!==0?this.acc.div(e)._round():new Z(0,0)}span(){return new Z(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((e,n)=>e+ +(n[0]!==Number.MAX_VALUE),0)}}class qc{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new ee,this.centroidVertexArray=new oa,this.indexArray=new we,this.programConfigurations=new sa(e.layers,e.zoom),this.segments=new Oi,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id),this.enableTerrain=e.enableTerrain}populate(e,n,r,a){this.features=[],this.hasPattern=Fp("fill-extrusion",this.layers,n),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(u){const d=Math.exp(Math.PI*(1-u.y/(1<<u.z)*2));return 80150034*d/(d*d+1)/Rt/(1<<u.z)}(r);for(const{feature:u,id:d,index:f,sourceLayerIndex:g}of e){const v=this.layers[0]._featureFilter.needGeometry,w=aa(u,v);if(!this.layers[0]._featureFilter.filter(new vi(this.zoom),w,r))continue;const E={id:d,sourceLayerIndex:g,index:f,geometry:v?w.geometry:zo(u,r,a),properties:u.properties,type:u.type,patterns:{}},M=this.layoutVertexArray.length;this.hasPattern?this.features.push(Np("fill-extrusion",this.layers,E,this.zoom,n)):this.addFeature(E,E.geometry,f,r,{},n.availableImages,a),n.featureIndex.insert(u,E.geometry,f,g,this.index,M)}this.sortBorders()}addFeatures(e,n,r,a,u){for(const d of this.features){const{geometry:f}=d;this.addFeature(d,f,d.index,n,r,a,u)}this.sortBorders()}update(e,n,r,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,r,a)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Jx),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,$x.members,!0))),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,Kx.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,n,r,a,u,d,f){const g=[new Z(0,0),new Z(Rt,Rt)],v=f.projection,w=v.name==="globe",E=this.enableTerrain&&!w?new I_:null;w&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Pn);const M=Op(n,500);for(let F=M.length-1;F>=0;F--){const j=M[F];(j.length===0||(k=j[0]).every(H=>H.x<=0)||k.every(H=>H.x>=Rt)||k.every(H=>H.y<=0)||k.every(H=>H.y>=Rt))&&M.splice(F,1)}var k;let L;if(w){const j=1<<a.z,H=yr(a.x/j),ne=yr((a.x+1)/j),le=cn(a.y/j),ue=cn((a.y+1)/j);L=function(he,de,Te,Me,De=0,Be){const be=[];if(!he.length||!Te||!Me)return be;const Ie=(Bt,Nt)=>{for(const ut of Bt)be.push({polygon:ut,bounds:Nt})},Oe=Math.ceil(Math.log2(Te)),We=Math.ceil(Math.log2(Me)),Ve=Oe-We,qe=[];for(let Bt=0;Bt<Math.abs(Ve);Bt++)qe.push(Ve>0?0:1);for(let Bt=0;Bt<Math.min(Oe,We);Bt++)qe.push(0),qe.push(1);let Pt=he;if(Pt=jh(Pt,de[0].y-De,de[1].y+De,1),Pt=jh(Pt,de[0].x-De,de[1].x+De,0),!Pt.length)return be;const jt=[];for(qe.length?jt.push({polygons:Pt,bounds:de,depth:0}):Ie(Pt,de);jt.length;){const Bt=jt.pop(),Nt=Bt.depth,ut=qe[Nt],it=Bt.bounds[0],Wt=Bt.bounds[1],si=ut===0?it.x:it.y,Yi=ut===0?Wt.x:Wt.y,bi=Be?Be(ut,si,Yi):.5*(si+Yi),Xi=jh(Bt.polygons,si-De,bi+De,ut),ai=jh(Bt.polygons,bi-De,Yi+De,ut);if(Xi.length){const Yt=[it,new Z(ut===0?bi:Wt.x,ut===1?bi:Wt.y)];qe.length>Nt+1?jt.push({polygons:Xi,bounds:Yt,depth:Nt+1}):Ie(Xi,Yt)}if(ai.length){const Yt=[new Z(ut===0?bi:it.x,ut===1?bi:it.y),Wt];qe.length>Nt+1?jt.push({polygons:ai,bounds:Yt,depth:Nt+1}):Ie(ai,Yt)}}return be}(M,g,Math.ceil((ne-H)/11.25),Math.ceil((le-ue)/11.25),1,(he,de,Te)=>{if(he===0)return .5*(de+Te);{const Me=cn((a.y+de/Rt)/j);return(sl(.5*(cn((a.y+Te/Rt)/j)+Me))*j-a.y)*Rt}})}else{L=[];for(const F of M)L.push({polygon:F,bounds:g})}for(const F of L){const j=F.polygon;let H=0,ne=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(let Te=0;Te<j.length;Te++){const Me=j[Te];if(Me.length===0)continue;H+=Me.length;let De=0;E&&E.startRing(Me[0]);for(let Be=0;Be<Me.length;Be++){const be=Me[Be];if(Be>=1){const Ie=Me[Be-1];if(!sv(be,Ie,F.bounds)){E&&E.append(be,Ie),ne.vertexLength+4>Oi.MAX_VERTEX_ARRAY_LENGTH&&(ne=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Oe=be.sub(Ie)._perp(),We=Oe.x/(Math.abs(Oe.x)+Math.abs(Oe.y)),Ve=Oe.y>0?1:0,qe=Ie.dist(be);De+qe>32768&&(De=0),Gc(this.layoutVertexArray,be.x,be.y,We,Ve,0,0,De),Gc(this.layoutVertexArray,be.x,be.y,We,Ve,0,1,De),De+=qe,Gc(this.layoutVertexArray,Ie.x,Ie.y,We,Ve,0,0,De),Gc(this.layoutVertexArray,Ie.x,Ie.y,We,Ve,0,1,De);const Pt=ne.vertexLength;if(this.indexArray.emplaceBack(Pt,Pt+2,Pt+1),this.indexArray.emplaceBack(Pt+1,Pt+2,Pt+3),ne.vertexLength+=4,ne.primitiveLength+=2,w){const jt=this.layoutVertexExtArray,Bt=v.projectTilePoint(be.x,be.y,a),Nt=v.projectTilePoint(Ie.x,Ie.y,a),ut=v.upVector(a,be.x,be.y),it=v.upVector(a,Ie.x,Ie.y);Zc(jt,Bt,ut),Zc(jt,Bt,ut),Zc(jt,Nt,it),Zc(jt,Nt,it)}}}}}if(ne.vertexLength+H>Oi.MAX_VERTEX_ARRAY_LENGTH&&(ne=this.segments.prepareSegment(H,this.layoutVertexArray,this.indexArray)),rv[e.type]!=="Polygon")continue;const le=[],ue=[],he=ne.vertexLength;for(let Te=0;Te<j.length;Te++){const Me=j[Te];if(Me.length!==0){Me!==j[0]&&ue.push(le.length/2);for(let De=0;De<Me.length;De++){const Be=Me[De];Gc(this.layoutVertexArray,Be.x,Be.y,0,0,1,1,0),le.push(Be.x),le.push(Be.y),E&&E.currentPolyCount.top++,w&&Zc(this.layoutVertexExtArray,v.projectTilePoint(Be.x,Be.y,a),v.upVector(a,Be.x,Be.y))}}}const de=Rh(le,ue);for(let Te=0;Te<de.length;Te+=3)this.indexArray.emplaceBack(he+de[Te],he+de[Te+2],he+de[Te+1]);ne.primitiveLength+=de.length/3,ne.vertexLength+=H}if(E&&E.polyCount.length>0){if(E.borders){E.vertexArrayOffset=this.centroidVertexArray.length;const F=E.borders,j=this.featuresOnBorder.push(E)-1;for(let H=0;H<4;H++)F[H][0]!==Number.MAX_VALUE&&this.borders[H].push(j)}this.encodeCentroid(E.borders?void 0:E.centroid(),E)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,u,d,a)}sortBorders(){for(let e=0;e<4;e++)this.borders[e].sort((n,r)=>this.featuresOnBorder[n].borders[e][0]-this.featuresOnBorder[r].borders[e][0])}encodeCentroid(e,n,r=!0){let a,u;if(e)if(e.y!==0){const f=n.span()._mult(this.tileToMeter);a=(Math.max(e.x,1)<<3)+Math.min(7,Math.round(f.x/10)),u=(Math.max(e.y,1)<<3)+Math.min(7,Math.round(f.y/10))}else a=Math.ceil(7*(e.x+450)),u=0;else a=0,u=+r;let d=r?this.centroidVertexArray.length:n.vertexArrayOffset;for(const f of n.polyCount){r&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*f.edges+f.top);for(let g=0;g<2*f.edges;g++)this.centroidVertexArray.emplace(d++,0,u),this.centroidVertexArray.emplace(d++,a,u);for(let g=0;g<f.top;g++)this.centroidVertexArray.emplace(d++,a,u)}}}function sv(i,e,n){return i.x===e.x&&(i.x<n[0].x||i.x>n[1].x)||i.y===e.y&&(i.y<n[0].y||i.y>n[1].y)}nt(qc,{omit:["layers","features"]}),nt(I_);var av={paint:new B({"fill-extrusion-opacity":new x(ve["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new A(ve["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new x(ve["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new x(ve["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new C(ve["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new A(ve["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new A(ve["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new x(ve["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function Wc(i,e){return i.x*e.x+i.y*e.y}function z_(i,e){if(i.length===1){let n=0;const r=e[n++];let a;for(;!a||r.equals(a);)if(a=e[n++],!a)return 1/0;for(;n<e.length;n++){const u=e[n],d=i[0],f=a.sub(r),g=u.sub(r),v=d.sub(r),w=Wc(f,f),E=Wc(f,g),M=Wc(g,g),k=Wc(v,f),L=Wc(v,g),F=w*M-E*E,j=(M*k-E*L)/F,H=(w*L-E*k)/F,ne=r.z*(1-j-H)+a.z*j+u.z*H;if(isFinite(ne))return ne}return 1/0}{let n=1/0;for(const r of e)n=Math.min(n,r.z);return n}}function k_(i){const e=new Z(i[0],i[1]);return e.z=i[2],e}function lv(i,e,n,r,a,u,d,f){const g=d*a.getElevationAt(i,e,!0,!0),v=u[0]!==0,w=v?u[1]===0?d*(u[0]/7-450):d*function(E,M,k){const L=Math.floor(M[0]/8),F=Math.floor(M[1]/8),j=10*(M[0]-8*L),H=10*(M[1]-8*F),ne=E.getElevationAt(L,F,!0,!0),le=E.getMeterToDEM(k),ue=Math.floor(.5*(j*le-1)),he=Math.floor(.5*(H*le-1)),de=E.tileCoordToPixel(L,F),Te=2*ue+1,Me=2*he+1,De=function(Ve,qe,Pt,jt,Bt){return[Ve.getElevationAtPixel(qe,Pt,!0),Ve.getElevationAtPixel(qe+Bt,Pt,!0),Ve.getElevationAtPixel(qe,Pt+Bt,!0),Ve.getElevationAtPixel(qe+jt,Pt+Bt,!0)]}(E,de.x-ue,de.y-he,Te,Me),Be=Math.abs(De[0]-De[1]),be=Math.abs(De[2]-De[3]),Ie=Math.abs(De[0]-De[2])+Math.abs(De[1]-De[3]),Oe=Math.min(.25,.5*le*(Be+be)/Te),We=Math.min(.25,.5*le*Ie/Me);return ne+Math.max(Oe*j,We*H)}(a,u,f):g;return{base:g+(n===0)?-1:n,top:v?Math.max(w+r,g+n+2):g+r}}const cv=$([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:uv}=cv,hv=$([{name:"a_packed",components:3,type:"Float32"}]),{members:dv}=hv,pv=ua.VectorTileFeature.types,fv=Math.cos(Math.PI/180*37.5);class Gh{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(n=>{this.gradients[n.id]={}}),this.layoutVertexArray=new X,this.layoutVertexArray2=new re,this.indexArray=new we,this.programConfigurations=new sa(e.layers,e.zoom),this.segments=new Oi,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(e,n,r,a){this.hasPattern=Fp("line",this.layers,n);const u=this.layers[0].layout.get("line-sort-key"),d=[];for(const{feature:w,id:E,index:M,sourceLayerIndex:k}of e){const L=this.layers[0]._featureFilter.needGeometry,F=aa(w,L);if(!this.layers[0]._featureFilter.filter(new vi(this.zoom),F,r))continue;const j=u?u.evaluate(F,{},r):void 0,H={id:E,properties:w.properties,type:w.type,sourceLayerIndex:k,index:M,geometry:L?F.geometry:zo(w,r,a),patterns:{},sortKey:j};d.push(H)}u&&d.sort((w,E)=>w.sortKey-E.sortKey);const{lineAtlas:f,featureIndex:g}=n,v=this.addConstantDashes(f);for(const w of d){const{geometry:E,index:M,sourceLayerIndex:k}=w;if(v&&this.addFeatureDashes(w,f),this.hasPattern){const L=Np("line",this.layers,w,this.zoom,n);this.patternFeatures.push(L)}else this.addFeature(w,E,M,r,f.positions,n.availableImages);g.insert(e[M].feature,E,M,k,this.index)}}addConstantDashes(e){let n=!1;for(const r of this.layers){const a=r.paint.get("line-dasharray").value,u=r.layout.get("line-cap").value;if(a.kind!=="constant"||u.kind!=="constant")n=!0;else{const d=u.value,f=a.value;if(!f)continue;e.addDash(f.from,d),e.addDash(f.to,d),f.other&&e.addDash(f.other,d)}}return n}addFeatureDashes(e,n){const r=this.zoom;for(const a of this.layers){const u=a.paint.get("line-dasharray").value,d=a.layout.get("line-cap").value;if(u.kind==="constant"&&d.kind==="constant")continue;let f,g,v,w,E,M;if(u.kind==="constant"){const j=u.value;if(!j)continue;f=j.other||j.to,g=j.to,v=j.from}else f=u.evaluate({zoom:r-1},e),g=u.evaluate({zoom:r},e),v=u.evaluate({zoom:r+1},e);d.kind==="constant"?w=E=M=d.value:(w=d.evaluate({zoom:r-1},e),E=d.evaluate({zoom:r},e),M=d.evaluate({zoom:r+1},e)),n.addDash(f,w),n.addDash(g,E),n.addDash(v,M);const k=n.getKey(f,w),L=n.getKey(g,E),F=n.getKey(v,M);e.patterns[a.id]={min:k,mid:L,max:F}}}update(e,n,r,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,r,a)}addFeatures(e,n,r,a,u){for(const d of this.patternFeatures)this.addFeature(d,d.geometry,d.index,n,r,a)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,dv)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,uv),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,n,r,a,u,d){const f=this.layers[0].layout,g=f.get("line-join").evaluate(e,{}),v=f.get("line-cap").evaluate(e,{}),w=f.get("line-miter-limit"),E=f.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const M of n)this.addLine(M,e,g,v,w,E);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,u,d,a)}addLine(e,n,r,a,u,d){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let H=0;H<e.length-1;H++)this.totalDistance+=e[H].dist(e[H+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const f=pv[n.type]==="Polygon";let g=e.length;for(;g>=2&&e[g-1].equals(e[g-2]);)g--;let v=0;for(;v<g-1&&e[v].equals(e[v+1]);)v++;if(g<(f?3:2))return;r==="bevel"&&(u=1.05);const w=this.overscaling<=16?122880/(512*this.overscaling):0,E=this.segments.prepareSegment(10*g,this.layoutVertexArray,this.indexArray);let M,k,L,F,j;this.e1=this.e2=-1,f&&(M=e[g-2],j=e[v].sub(M)._unit()._perp());for(let H=v;H<g;H++){if(L=H===g-1?f?e[v+1]:void 0:e[H+1],L&&e[H].equals(L))continue;j&&(F=j),M&&(k=M),M=e[H],j=L?L.sub(M)._unit()._perp():F,F=F||j;let ne=F.add(j);ne.x===0&&ne.y===0||ne._unit();const le=F.x*j.x+F.y*j.y,ue=ne.x*j.x+ne.y*j.y,he=ue!==0?1/ue:1/0,de=2*Math.sqrt(2-2*ue),Te=ue<fv&&k&&L,Me=F.x*j.y-F.y*j.x>0;if(Te&&H>v){const be=M.dist(k);if(be>2*w){const Ie=M.sub(M.sub(k)._mult(w/be)._round());this.updateDistance(k,Ie),this.addCurrentVertex(Ie,F,0,0,E),k=Ie}}const De=k&&L;let Be=De?r:f?"butt":a;if(De&&Be==="round"&&(he<d?Be="miter":he<=2&&(Be="fakeround")),Be==="miter"&&he>u&&(Be="bevel"),Be==="bevel"&&(he>2&&(Be="flipbevel"),he<u&&(Be="miter")),k&&this.updateDistance(k,M),Be==="miter")ne._mult(he),this.addCurrentVertex(M,ne,0,0,E);else if(Be==="flipbevel"){if(he>100)ne=j.mult(-1);else{const be=he*F.add(j).mag()/F.sub(j).mag();ne._perp()._mult(be*(Me?-1:1))}this.addCurrentVertex(M,ne,0,0,E),this.addCurrentVertex(M,ne.mult(-1),0,0,E)}else if(Be==="bevel"||Be==="fakeround"){const be=-Math.sqrt(he*he-1),Ie=Me?be:0,Oe=Me?0:be;if(k&&this.addCurrentVertex(M,F,Ie,Oe,E),Be==="fakeround"){const We=Math.round(180*de/Math.PI/20);for(let Ve=1;Ve<We;Ve++){let qe=Ve/We;if(qe!==.5){const jt=qe-.5;qe+=qe*jt*(qe-1)*((1.0904+le*(le*(3.55645-1.43519*le)-3.2452))*jt*jt+(.848013+le*(.215638*le-1.06021)))}const Pt=j.sub(F)._mult(qe)._add(F)._unit()._mult(Me?-1:1);this.addHalfVertex(M,Pt.x,Pt.y,!1,Me,0,E)}}L&&this.addCurrentVertex(M,j,-Ie,-Oe,E)}else if(Be==="butt")this.addCurrentVertex(M,ne,0,0,E);else if(Be==="square"){const be=k?1:-1;k||this.addCurrentVertex(M,ne,be,be,E),this.addCurrentVertex(M,ne,0,0,E),k&&this.addCurrentVertex(M,ne,be,be,E)}else Be==="round"&&(k&&(this.addCurrentVertex(M,F,0,0,E),this.addCurrentVertex(M,F,1,1,E,!0)),L&&(this.addCurrentVertex(M,j,-1,-1,E,!0),this.addCurrentVertex(M,j,0,0,E)));if(Te&&H<g-1){const be=M.dist(L);if(be>2*w){const Ie=M.add(L.sub(M)._mult(w/be)._round());this.updateDistance(M,Ie),this.addCurrentVertex(Ie,j,0,0,E),M=Ie}}}}addCurrentVertex(e,n,r,a,u,d=!1){const f=n.y*a-n.x,g=-n.y-n.x*a;this.addHalfVertex(e,n.x+n.y*r,n.y-n.x*r,d,!1,r,u),this.addHalfVertex(e,f,g,d,!0,-a,u)}addHalfVertex({x:e,y:n},r,a,u,d,f,g){this.layoutVertexArray.emplaceBack((e<<1)+(u?1:0),(n<<1)+(d?1:0),Math.round(63*r)+128,Math.round(63*a)+128,1+(f===0?0:f<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineSoFar);const v=g.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,v),g.primitiveLength++),d?this.e2=v:this.e1=v}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,n){this.distance+=e.dist(n),this.updateScaledDistance()}}nt(Gh,{omit:["layers","patternFeatures"]});const mv=new B({"line-cap":new A(ve.layout_line["line-cap"]),"line-join":new A(ve.layout_line["line-join"]),"line-miter-limit":new x(ve.layout_line["line-miter-limit"]),"line-round-limit":new x(ve.layout_line["line-round-limit"]),"line-sort-key":new A(ve.layout_line["line-sort-key"])});var D_={paint:new B({"line-opacity":new A(ve.paint_line["line-opacity"]),"line-color":new A(ve.paint_line["line-color"]),"line-translate":new x(ve.paint_line["line-translate"]),"line-translate-anchor":new x(ve.paint_line["line-translate-anchor"]),"line-width":new A(ve.paint_line["line-width"]),"line-gap-width":new A(ve.paint_line["line-gap-width"]),"line-offset":new A(ve.paint_line["line-offset"]),"line-blur":new A(ve.paint_line["line-blur"]),"line-dasharray":new C(ve.paint_line["line-dasharray"]),"line-pattern":new C(ve.paint_line["line-pattern"]),"line-gradient":new z(ve.paint_line["line-gradient"])}),layout:mv};const P_=new class extends A{possiblyEvaluate(i,e){return e=new vi(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,zoomHistory:e.zoomHistory,transition:e.transition}),super.possiblyEvaluate(i,e)}evaluate(i,e,n,r){return e=yi({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(i,e,n,r)}}(D_.paint.properties["line-width"].specification);function B_(i,e){return e>0?e+2*i:i}P_.useIntegerZoom=!0;const _v=$([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"},{name:"a_z_tile_anchor",components:4,type:"Int16"}],4),gv=$([{name:"a_projected_pos",components:3,type:"Float32"}],4);$([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const yv=$([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),xv=$([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);$([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const L_=$([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),vv=$([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);$([{name:"triangle",components:3,type:"Uint16"}]),$([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),$([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),$([{type:"Float32",name:"offsetX"}]),$([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var un=24;const Kr=128;function Up(i,e){const{expression:n}=e;if(n.kind==="constant")return{kind:"constant",layoutSize:n.evaluate(new vi(i+1))};if(n.kind==="source")return{kind:"source"};{const{zoomStops:r,interpolationType:a}=n;let u=0;for(;u<r.length&&r[u]<=i;)u++;u=Math.max(0,u-1);let d=u;for(;d<r.length&&r[d]<i+1;)d++;d=Math.min(r.length-1,d);const f=r[u],g=r[d];return n.kind==="composite"?{kind:"composite",minZoom:f,maxZoom:g,interpolationType:a}:{kind:"camera",minZoom:f,maxZoom:g,minSize:n.evaluate(new vi(f)),maxSize:n.evaluate(new vi(g)),interpolationType:a}}}function Zh(i,{uSize:e,uSizeT:n},{lowerSize:r,upperSize:a}){return i.kind==="source"?r/Kr:i.kind==="composite"?xt(r/Kr,a/Kr,n):e}function fl(i,e){let n=0,r=0;if(i.kind==="constant")r=i.layoutSize;else if(i.kind!=="source"){const{interpolationType:a,minZoom:u,maxZoom:d}=i,f=a?At(zn.interpolationFactor(a,e,u,d),0,1):0;i.kind==="camera"?r=xt(i.minSize,i.maxSize,f):n=f}return{uSizeT:n,uSize:r}}var bv=Object.freeze({__proto__:null,getSizeData:Up,evaluateSizeForFeature:Zh,evaluateSizeForZoom:fl,SIZE_PACK_FACTOR:Kr});function Av(i,e,n){return i.sections.forEach(r=>{r.text=function(a,u,d){const f=u.layout.get("text-transform").evaluate(d,{});return f==="uppercase"?a=a.toLocaleUpperCase():f==="lowercase"&&(a=a.toLocaleLowerCase()),Gn.applyArabicShaping&&(a=Gn.applyArabicShaping(a)),a}(r.text,e,n)}),i}const Hc={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"};function wv(i){return i==="\uFE36"||i==="\uFE48"||i==="\uFE38"||i==="\uFE44"||i==="\uFE42"||i==="\uFE3E"||i==="\uFE3C"||i==="\uFE3A"||i==="\uFE18"||i==="\uFE40"||i==="\uFE10"||i==="\uFE13"||i==="\uFE14"||i==="\uFF40"||i==="\uFFE3"||i==="\uFE11"||i==="\uFE12"}function Tv(i){return i==="\uFE35"||i==="\uFE47"||i==="\uFE37"||i==="\uFE43"||i==="\uFE41"||i==="\uFE3D"||i==="\uFE3B"||i==="\uFE39"||i==="\uFE17"||i==="\uFE3F"}var R_=function(i,e,n,r,a){var u,d,f=8*a-r-1,g=(1<<f)-1,v=g>>1,w=-7,E=n?a-1:0,M=n?-1:1,k=i[e+E];for(E+=M,u=k&(1<<-w)-1,k>>=-w,w+=f;w>0;u=256*u+i[e+E],E+=M,w-=8);for(d=u&(1<<-w)-1,u>>=-w,w+=r;w>0;d=256*d+i[e+E],E+=M,w-=8);if(u===0)u=1-v;else{if(u===g)return d?NaN:1/0*(k?-1:1);d+=Math.pow(2,r),u-=v}return(k?-1:1)*d*Math.pow(2,u-r)},O_=function(i,e,n,r,a,u){var d,f,g,v=8*u-a-1,w=(1<<v)-1,E=w>>1,M=a===23?Math.pow(2,-24)-Math.pow(2,-77):0,k=r?0:u-1,L=r?1:-1,F=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(f=isNaN(e)?1:0,d=w):(d=Math.floor(Math.log(e)/Math.LN2),e*(g=Math.pow(2,-d))<1&&(d--,g*=2),(e+=d+E>=1?M/g:M*Math.pow(2,1-E))*g>=2&&(d++,g/=2),d+E>=w?(f=0,d=w):d+E>=1?(f=(e*g-1)*Math.pow(2,a),d+=E):(f=e*Math.pow(2,E-1)*Math.pow(2,a),d=0));a>=8;i[n+k]=255&f,k+=L,f/=256,a-=8);for(d=d<<a|f,v+=a;v>0;i[n+k]=255&d,k+=L,d/=256,v-=8);i[n+k-L]|=128*F},Yc=xi;function xi(i){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(i)?i:new Uint8Array(i||0),this.pos=0,this.type=0,this.length=this.buf.length}xi.Varint=0,xi.Fixed64=1,xi.Bytes=2,xi.Fixed32=5;var Vp=4294967296,F_=1/Vp,N_=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function Do(i){return i.type===xi.Bytes?i.readVarint()+i.pos:i.pos+1}function ml(i,e,n){return n?4294967296*e+(i>>>0):4294967296*(e>>>0)+(i>>>0)}function U_(i,e,n){var r=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(r);for(var a=n.pos-1;a>=i;a--)n.buf[a+r]=n.buf[a]}function Ev(i,e){for(var n=0;n<i.length;n++)e.writeVarint(i[n])}function Cv(i,e){for(var n=0;n<i.length;n++)e.writeSVarint(i[n])}function Mv(i,e){for(var n=0;n<i.length;n++)e.writeFloat(i[n])}function Sv(i,e){for(var n=0;n<i.length;n++)e.writeDouble(i[n])}function Iv(i,e){for(var n=0;n<i.length;n++)e.writeBoolean(i[n])}function zv(i,e){for(var n=0;n<i.length;n++)e.writeFixed32(i[n])}function kv(i,e){for(var n=0;n<i.length;n++)e.writeSFixed32(i[n])}function Dv(i,e){for(var n=0;n<i.length;n++)e.writeFixed64(i[n])}function Pv(i,e){for(var n=0;n<i.length;n++)e.writeSFixed64(i[n])}function qh(i,e){return(i[e]|i[e+1]<<8|i[e+2]<<16)+16777216*i[e+3]}function _l(i,e,n){i[n]=e,i[n+1]=e>>>8,i[n+2]=e>>>16,i[n+3]=e>>>24}function V_(i,e){return(i[e]|i[e+1]<<8|i[e+2]<<16)+(i[e+3]<<24)}function Bv(i,e,n){e.glyphs=[],i===1&&n.readMessage(Lv,e)}function Lv(i,e,n){if(i===3){const{id:r,bitmap:a,width:u,height:d,left:f,top:g,advance:v}=n.readMessage(Rv,{});e.glyphs.push({id:r,bitmap:new ko({width:u+6,height:d+6},a),metrics:{width:u,height:d,left:f,top:g,advance:v}})}else i===4?e.ascender=n.readSVarint():i===5&&(e.descender=n.readSVarint())}function Rv(i,e,n){i===1?e.id=n.readVarint():i===2?e.bitmap=n.readBytes():i===3?e.width=n.readVarint():i===4?e.height=n.readVarint():i===5?e.left=n.readSVarint():i===6?e.top=n.readSVarint():i===7&&(e.advance=n.readVarint())}function jp(i){let e=0,n=0;for(const d of i)e+=d.w*d.h,n=Math.max(n,d.w);i.sort((d,f)=>f.h-d.h);const r=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),n),h:1/0}];let a=0,u=0;for(const d of i)for(let f=r.length-1;f>=0;f--){const g=r[f];if(!(d.w>g.w||d.h>g.h)){if(d.x=g.x,d.y=g.y,u=Math.max(u,d.y+d.h),a=Math.max(a,d.x+d.w),d.w===g.w&&d.h===g.h){const v=r.pop();f<r.length&&(r[f]=v)}else d.h===g.h?(g.x+=d.w,g.w-=d.w):d.w===g.w?(g.y+=d.h,g.h-=d.h):(r.push({x:g.x+d.w,y:g.y,w:g.w-d.w,h:d.h}),g.y+=d.h,g.h-=d.h);break}}return{w:a,h:u,fill:e/(a*u)||0}}xi.prototype={destroy:function(){this.buf=null},readFields:function(i,e,n){for(n=n||this.length;this.pos<n;){var r=this.readVarint(),a=r>>3,u=this.pos;this.type=7&r,i(a,e,this),this.pos===u&&this.skip(r)}return e},readMessage:function(i,e){return this.readFields(i,e,this.readVarint()+this.pos)},readFixed32:function(){var i=qh(this.buf,this.pos);return this.pos+=4,i},readSFixed32:function(){var i=V_(this.buf,this.pos);return this.pos+=4,i},readFixed64:function(){var i=qh(this.buf,this.pos)+qh(this.buf,this.pos+4)*Vp;return this.pos+=8,i},readSFixed64:function(){var i=qh(this.buf,this.pos)+V_(this.buf,this.pos+4)*Vp;return this.pos+=8,i},readFloat:function(){var i=R_(this.buf,this.pos,!0,23,4);return this.pos+=4,i},readDouble:function(){var i=R_(this.buf,this.pos,!0,52,8);return this.pos+=8,i},readVarint:function(i){var e,n,r=this.buf;return e=127&(n=r[this.pos++]),n<128?e:(e|=(127&(n=r[this.pos++]))<<7,n<128?e:(e|=(127&(n=r[this.pos++]))<<14,n<128?e:(e|=(127&(n=r[this.pos++]))<<21,n<128?e:function(a,u,d){var f,g,v=d.buf;if(f=(112&(g=v[d.pos++]))>>4,g<128||(f|=(127&(g=v[d.pos++]))<<3,g<128)||(f|=(127&(g=v[d.pos++]))<<10,g<128)||(f|=(127&(g=v[d.pos++]))<<17,g<128)||(f|=(127&(g=v[d.pos++]))<<24,g<128)||(f|=(1&(g=v[d.pos++]))<<31,g<128))return ml(a,f,u);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=r[this.pos]))<<28,i,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var i=this.readVarint();return i%2==1?(i+1)/-2:i/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var i=this.readVarint()+this.pos,e=this.pos;return this.pos=i,i-e>=12&&N_?function(n,r,a){return N_.decode(n.subarray(r,a))}(this.buf,e,i):function(n,r,a){for(var u="",d=r;d<a;){var f,g,v,w=n[d],E=null,M=w>239?4:w>223?3:w>191?2:1;if(d+M>a)break;M===1?w<128&&(E=w):M===2?(192&(f=n[d+1]))==128&&(E=(31&w)<<6|63&f)<=127&&(E=null):M===3?(g=n[d+2],(192&(f=n[d+1]))==128&&(192&g)==128&&((E=(15&w)<<12|(63&f)<<6|63&g)<=2047||E>=55296&&E<=57343)&&(E=null)):M===4&&(g=n[d+2],v=n[d+3],(192&(f=n[d+1]))==128&&(192&g)==128&&(192&v)==128&&((E=(15&w)<<18|(63&f)<<12|(63&g)<<6|63&v)<=65535||E>=1114112)&&(E=null)),E===null?(E=65533,M=1):E>65535&&(E-=65536,u+=String.fromCharCode(E>>>10&1023|55296),E=56320|1023&E),u+=String.fromCharCode(E),d+=M}return u}(this.buf,e,i)},readBytes:function(){var i=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,i);return this.pos=i,e},readPackedVarint:function(i,e){if(this.type!==xi.Bytes)return i.push(this.readVarint(e));var n=Do(this);for(i=i||[];this.pos<n;)i.push(this.readVarint(e));return i},readPackedSVarint:function(i){if(this.type!==xi.Bytes)return i.push(this.readSVarint());var e=Do(this);for(i=i||[];this.pos<e;)i.push(this.readSVarint());return i},readPackedBoolean:function(i){if(this.type!==xi.Bytes)return i.push(this.readBoolean());var e=Do(this);for(i=i||[];this.pos<e;)i.push(this.readBoolean());return i},readPackedFloat:function(i){if(this.type!==xi.Bytes)return i.push(this.readFloat());var e=Do(this);for(i=i||[];this.pos<e;)i.push(this.readFloat());return i},readPackedDouble:function(i){if(this.type!==xi.Bytes)return i.push(this.readDouble());var e=Do(this);for(i=i||[];this.pos<e;)i.push(this.readDouble());return i},readPackedFixed32:function(i){if(this.type!==xi.Bytes)return i.push(this.readFixed32());var e=Do(this);for(i=i||[];this.pos<e;)i.push(this.readFixed32());return i},readPackedSFixed32:function(i){if(this.type!==xi.Bytes)return i.push(this.readSFixed32());var e=Do(this);for(i=i||[];this.pos<e;)i.push(this.readSFixed32());return i},readPackedFixed64:function(i){if(this.type!==xi.Bytes)return i.push(this.readFixed64());var e=Do(this);for(i=i||[];this.pos<e;)i.push(this.readFixed64());return i},readPackedSFixed64:function(i){if(this.type!==xi.Bytes)return i.push(this.readSFixed64());var e=Do(this);for(i=i||[];this.pos<e;)i.push(this.readSFixed64());return i},skip:function(i){var e=7&i;if(e===xi.Varint)for(;this.buf[this.pos++]>127;);else if(e===xi.Bytes)this.pos=this.readVarint()+this.pos;else if(e===xi.Fixed32)this.pos+=4;else{if(e!==xi.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(i,e){this.writeVarint(i<<3|e)},realloc:function(i){for(var e=this.length||16;e<this.pos+i;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(i){this.realloc(4),_l(this.buf,i,this.pos),this.pos+=4},writeSFixed32:function(i){this.realloc(4),_l(this.buf,i,this.pos),this.pos+=4},writeFixed64:function(i){this.realloc(8),_l(this.buf,-1&i,this.pos),_l(this.buf,Math.floor(i*F_),this.pos+4),this.pos+=8},writeSFixed64:function(i){this.realloc(8),_l(this.buf,-1&i,this.pos),_l(this.buf,Math.floor(i*F_),this.pos+4),this.pos+=8},writeVarint:function(i){(i=+i||0)>268435455||i<0?function(e,n){var r,a;if(e>=0?(r=e%4294967296|0,a=e/4294967296|0):(a=~(-e/4294967296),4294967295^(r=~(-e%4294967296))?r=r+1|0:(r=0,a=a+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");n.realloc(10),function(u,d,f){f.buf[f.pos++]=127&u|128,u>>>=7,f.buf[f.pos++]=127&u|128,u>>>=7,f.buf[f.pos++]=127&u|128,u>>>=7,f.buf[f.pos++]=127&u|128,f.buf[f.pos]=127&(u>>>=7)}(r,0,n),function(u,d){var f=(7&u)<<4;d.buf[d.pos++]|=f|((u>>>=3)?128:0),u&&(d.buf[d.pos++]=127&u|((u>>>=7)?128:0),u&&(d.buf[d.pos++]=127&u|((u>>>=7)?128:0),u&&(d.buf[d.pos++]=127&u|((u>>>=7)?128:0),u&&(d.buf[d.pos++]=127&u|((u>>>=7)?128:0),u&&(d.buf[d.pos++]=127&u)))))}(a,n)}(i,this):(this.realloc(4),this.buf[this.pos++]=127&i|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=i>>>7&127))))},writeSVarint:function(i){this.writeVarint(i<0?2*-i-1:2*i)},writeBoolean:function(i){this.writeVarint(Boolean(i))},writeString:function(i){i=String(i),this.realloc(4*i.length),this.pos++;var e=this.pos;this.pos=function(r,a,u){for(var d,f,g=0;g<a.length;g++){if((d=a.charCodeAt(g))>55295&&d<57344){if(!f){d>56319||g+1===a.length?(r[u++]=239,r[u++]=191,r[u++]=189):f=d;continue}if(d<56320){r[u++]=239,r[u++]=191,r[u++]=189,f=d;continue}d=f-55296<<10|d-56320|65536,f=null}else f&&(r[u++]=239,r[u++]=191,r[u++]=189,f=null);d<128?r[u++]=d:(d<2048?r[u++]=d>>6|192:(d<65536?r[u++]=d>>12|224:(r[u++]=d>>18|240,r[u++]=d>>12&63|128),r[u++]=d>>6&63|128),r[u++]=63&d|128)}return u}(this.buf,i,this.pos);var n=this.pos-e;n>=128&&U_(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(i){this.realloc(4),O_(this.buf,i,this.pos,!0,23,4),this.pos+=4},writeDouble:function(i){this.realloc(8),O_(this.buf,i,this.pos,!0,52,8),this.pos+=8},writeBytes:function(i){var e=i.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=i[n]},writeRawMessage:function(i,e){this.pos++;var n=this.pos;i(e,this);var r=this.pos-n;r>=128&&U_(n,r,this),this.pos=n-1,this.writeVarint(r),this.pos+=r},writeMessage:function(i,e,n){this.writeTag(i,xi.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(i,e){e.length&&this.writeMessage(i,Ev,e)},writePackedSVarint:function(i,e){e.length&&this.writeMessage(i,Cv,e)},writePackedBoolean:function(i,e){e.length&&this.writeMessage(i,Iv,e)},writePackedFloat:function(i,e){e.length&&this.writeMessage(i,Mv,e)},writePackedDouble:function(i,e){e.length&&this.writeMessage(i,Sv,e)},writePackedFixed32:function(i,e){e.length&&this.writeMessage(i,zv,e)},writePackedSFixed32:function(i,e){e.length&&this.writeMessage(i,kv,e)},writePackedFixed64:function(i,e){e.length&&this.writeMessage(i,Dv,e)},writePackedSFixed64:function(i,e){e.length&&this.writeMessage(i,Pv,e)},writeBytesField:function(i,e){this.writeTag(i,xi.Bytes),this.writeBytes(e)},writeFixed32Field:function(i,e){this.writeTag(i,xi.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(i,e){this.writeTag(i,xi.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(i,e){this.writeTag(i,xi.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(i,e){this.writeTag(i,xi.Fixed64),this.writeSFixed64(e)},writeVarintField:function(i,e){this.writeTag(i,xi.Varint),this.writeVarint(e)},writeSVarintField:function(i,e){this.writeTag(i,xi.Varint),this.writeSVarint(e)},writeStringField:function(i,e){this.writeTag(i,xi.Bytes),this.writeString(e)},writeFloatField:function(i,e){this.writeTag(i,xi.Fixed32),this.writeFloat(e)},writeDoubleField:function(i,e){this.writeTag(i,xi.Fixed64),this.writeDouble(e)},writeBooleanField:function(i,e){this.writeVarintField(i,Boolean(e))}};class Gp{constructor(e,{pixelRatio:n,version:r,stretchX:a,stretchY:u,content:d}){this.paddedRect=e,this.pixelRatio=n,this.stretchX=a,this.stretchY=u,this.content=d,this.version=r}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class j_{constructor(e,n){const r={},a={};this.haveRenderCallbacks=[];const u=[];this.addImages(e,r,u),this.addImages(n,a,u);const{w:d,h:f}=jp(u),g=new Wn({width:d||1,height:f||1});for(const v in e){const w=e[v],E=r[v].paddedRect;Wn.copy(w.data,g,{x:0,y:0},{x:E.x+1,y:E.y+1},w.data)}for(const v in n){const w=n[v],E=a[v].paddedRect,M=E.x+1,k=E.y+1,L=w.data.width,F=w.data.height;Wn.copy(w.data,g,{x:0,y:0},{x:M,y:k},w.data),Wn.copy(w.data,g,{x:0,y:F-1},{x:M,y:k-1},{width:L,height:1}),Wn.copy(w.data,g,{x:0,y:0},{x:M,y:k+F},{width:L,height:1}),Wn.copy(w.data,g,{x:L-1,y:0},{x:M-1,y:k},{width:1,height:F}),Wn.copy(w.data,g,{x:0,y:0},{x:M+L,y:k},{width:1,height:F})}this.image=g,this.iconPositions=r,this.patternPositions=a}addImages(e,n,r){for(const a in e){const u=e[a],d={x:0,y:0,w:u.data.width+2,h:u.data.height+2};r.push(d),n[a]=new Gp(d,u),u.hasRenderCallback&&this.haveRenderCallbacks.push(a)}}patchUpdatedImages(e,n){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(r=>e.hasImage(r)),e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const r in e.updatedImages)this.patchUpdatedImage(this.iconPositions[r],e.getImage(r),n),this.patchUpdatedImage(this.patternPositions[r],e.getImage(r),n)}patchUpdatedImage(e,n,r){if(!e||!n||e.version===n.version)return;e.version=n.version;const[a,u]=e.tl;r.update(n.data,void 0,{x:a,y:u})}}nt(Gp),nt(j_);const lr={horizontal:1,vertical:2,horizontalOnly:3};class Xc{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,n){const r=new Xc;return r.scale=e||1,r.fontStack=n,r}static forImage(e){const n=new Xc;return n.imageName=e,n}}class gl{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,n){const r=new gl;for(let a=0;a<e.sections.length;a++){const u=e.sections[a];u.image?r.addImageSection(u):r.addTextSection(u,n)}return r}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(e){this.text=function(n,r){let a="";for(let u=0;u<n.length;u++){const d=n.charCodeAt(u+1)||null,f=n.charCodeAt(u-1)||null;a+=!r&&(d&&il(d)&&!Hc[n[u+1]]||f&&il(f)&&!Hc[n[u-1]])||!Hc[n[u]]?n[u]:Hc[n[u]]}return a}(this.text,e)}trim(){let e=0;for(let r=0;r<this.text.length&&Wh[this.text.charCodeAt(r)];r++)e++;let n=this.text.length;for(let r=this.text.length-1;r>=0&&r>=e&&Wh[this.text.charCodeAt(r)];r--)n--;this.text=this.text.substring(e,n),this.sectionIndex=this.sectionIndex.slice(e,n)}substring(e,n){const r=new gl;return r.text=this.text.substring(e,n),r.sectionIndex=this.sectionIndex.slice(e,n),r.sections=this.sections,r}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,n)=>Math.max(e,this.sections[n].scale),0)}addTextSection(e,n){this.text+=e.text,this.sections.push(Xc.forText(e.scale,e.fontStack||n));const r=this.sections.length-1;for(let a=0;a<e.text.length;++a)this.sectionIndex.push(r)}addImageSection(e){const n=e.image?e.image.name:"";if(n.length===0)return void Gt("Can't add FormattedSection with an empty image.");const r=this.getNextImageSectionCharCode();r?(this.text+=String.fromCharCode(r),this.sections.push(Xc.forImage(n)),this.sectionIndex.push(this.sections.length-1)):Gt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Zp(i,e,n,r,a,u,d,f,g,v,w,E,M,k,L,F){const j=gl.fromFeature(i,a);let H;E===lr.vertical&&j.verticalizePunctuation(M);const{processBidirectionalText:ne,processStyledBidirectionalText:le}=Gn;if(ne&&j.sections.length===1){H=[];const de=ne(j.toString(),qp(j,v,u,e,r,k,L));for(const Te of de){const Me=new gl;Me.text=Te,Me.sections=j.sections;for(let De=0;De<Te.length;De++)Me.sectionIndex.push(0);H.push(Me)}}else if(le){H=[];const de=le(j.text,j.sectionIndex,qp(j,v,u,e,r,k,L));for(const Te of de){const Me=new gl;Me.text=Te[0],Me.sectionIndex=Te[1],Me.sections=j.sections,H.push(Me)}}else H=function(de,Te){const Me=[],De=de.text;let Be=0;for(const be of Te)Me.push(de.substring(Be,be)),Be=be;return Be<De.length&&Me.push(de.substring(Be,De.length)),Me}(j,qp(j,v,u,e,r,k,L));const ue=[],he={positionedLines:ue,text:j.toString(),top:w[1],bottom:w[1],left:w[0],right:w[0],writingMode:E,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(de,Te,Me,De,Be,be,Ie,Oe,We,Ve,qe,Pt){let jt=0,Bt=0,Nt=0;const ut=Oe==="right"?1:Oe==="left"?0:.5;let it=!1;for(const ai of Be){const Yt=ai.getSections();for(const mi of Yt){if(mi.imageName)continue;const Pi=Te[mi.fontStack];if(Pi&&(it=Pi.ascender!==void 0&&Pi.descender!==void 0,!it))break}if(!it)break}let Wt=0;for(const ai of Be){ai.trim();const Yt=ai.getMaxScale(),mi=(Yt-1)*un,Pi={positionedGlyphs:[],lineOffset:0};de.positionedLines[Wt]=Pi;const Fi=Pi.positionedGlyphs;let Qi=0;if(!ai.length()){Bt+=be,++Wt;continue}let Ji=0,Xn=0;for(let _i=0;_i<ai.length();_i++){const Tn=ai.getSection(_i),Qn=ai.getSectionIndex(_i),sn=ai.getCharCode(_i);let en=Tn.scale,Ei=null,Ai=null,On=null,En=un,qi=0;const Cn=!(We===lr.horizontal||!qe&&!tl(sn)||qe&&(Wh[sn]||(si=sn,dh(si)||Qa(si)||Js(si)||Tc(si)||Ja(si))));if(Tn.imageName){const mn=De[Tn.imageName];if(!mn)continue;On=Tn.imageName,de.iconsInText=de.iconsInText||!0,Ai=mn.paddedRect;const tn=mn.displaySize;en=en*un/Pt,Ei={width:tn[0],height:tn[1],left:1,top:-3,advance:Cn?tn[1]:tn[0],localGlyph:!1},qi=it?-Ei.height*en:Yt*un-17-tn[1]*en,En=Ei.advance;const vr=(Cn?tn[0]:tn[1])*en-un*Yt;vr>0&&vr>Qi&&(Qi=vr)}else{const mn=Me[Tn.fontStack];if(!mn)continue;mn[sn]&&(Ai=mn[sn]);const tn=Te[Tn.fontStack];if(!tn)continue;const vr=tn.glyphs[sn];if(!vr)continue;if(Ei=vr.metrics,En=sn!==8203?un:0,it){const gs=tn.ascender!==void 0?Math.abs(tn.ascender):0,ou=tn.descender!==void 0?Math.abs(tn.descender):0,su=(gs+ou)*en;Ji<su&&(Ji=su,Xn=(gs-ou)/2*en),qi=-gs*en}else qi=(Yt-en)*un-17}Cn?(de.verticalizable=!0,Fi.push({glyph:sn,imageName:On,x:jt,y:Bt+qi,vertical:Cn,scale:en,localGlyph:Ei.localGlyph,fontStack:Tn.fontStack,sectionIndex:Qn,metrics:Ei,rect:Ai}),jt+=En*en+Ve):(Fi.push({glyph:sn,imageName:On,x:jt,y:Bt+qi,vertical:Cn,scale:en,localGlyph:Ei.localGlyph,fontStack:Tn.fontStack,sectionIndex:Qn,metrics:Ei,rect:Ai}),jt+=Ei.advance*en+Ve)}Fi.length!==0&&(Nt=Math.max(jt-Ve,Nt),it?H_(Fi,ut,Qi,Xn,be*Yt/2):H_(Fi,ut,Qi,0,be/2)),jt=0;const Rn=be*Yt+Qi;Pi.lineOffset=Math.max(Qi,mi),Bt+=Rn,++Wt}var si;const Yi=Bt,{horizontalAlign:bi,verticalAlign:Xi}=Wp(Ie);(function(ai,Yt,mi,Pi,Fi,Qi){const Ji=(Yt-mi)*Fi,Xn=-Qi*Pi;for(const Rn of ai)for(const _i of Rn.positionedGlyphs)_i.x+=Ji,_i.y+=Xn})(de.positionedLines,ut,bi,Xi,Nt,Yi),de.top+=-Xi*Yi,de.bottom=de.top+Yi,de.left+=-bi*Nt,de.right=de.left+Nt,de.hasBaseline=it}(he,e,n,r,H,d,f,g,E,v,M,F),!function(de){for(const Te of de)if(Te.positionedGlyphs.length!==0)return!1;return!0}(ue)&&he}const Wh={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Ov={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function G_(i,e,n,r,a,u){if(e.imageName){const d=r[e.imageName];return d?d.displaySize[0]*e.scale*un/u+a:0}{const d=n[e.fontStack],f=d&&d.glyphs[i];return f?f.metrics.advance*e.scale+a:0}}function Z_(i,e,n,r){const a=Math.pow(i-e,2);return r?i<e?a/2:2*a:a+Math.abs(n)*n}function Fv(i,e,n){let r=0;return i===10&&(r-=1e4),n&&(r+=150),i!==40&&i!==65288||(r+=50),e!==41&&e!==65289||(r+=50),r}function q_(i,e,n,r,a,u){let d=null,f=Z_(e,n,a,u);for(const g of r){const v=Z_(e-g.x,n,a,u)+g.badness;v<=f&&(d=g,f=v)}return{index:i,x:e,priorBreak:d,badness:f}}function W_(i){return i?W_(i.priorBreak).concat(i.index):[]}function qp(i,e,n,r,a,u,d){if(u!=="point")return[];if(!i)return[];const f=[],g=function(M,k,L,F,j,H){let ne=0;for(let le=0;le<M.length();le++){const ue=M.getSection(le);ne+=G_(M.getCharCode(le),ue,F,j,k,H)}return ne/Math.max(1,Math.ceil(ne/L))}(i,e,n,r,a,d),v=i.text.indexOf("\u200B")>=0;let w=0;for(let M=0;M<i.length();M++){const k=i.getSection(M),L=i.getCharCode(M);if(Wh[L]||(w+=G_(L,k,r,a,e,d)),M<i.length()-1){const F=!((E=L)<11904||!(mh(E)||fh(E)||is(E)||ta(E)||yh(E)||vc(E)||_h(E)||Ka(E)||xh(E)||wc(E)||gh(E)||Ec(E)||ea(E)||bc(E)||ph(E)||Ac(E)||$a(E)||wh(E)||bh(E)||vh(E)));(Ov[L]||F||k.imageName)&&f.push(q_(M+1,w,g,f,Fv(L,i.getCharCode(M+1),F&&v),!1))}}var E;return W_(q_(i.length(),w,g,f,0,!0))}function Wp(i){let e=.5,n=.5;switch(i){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(i){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:e,verticalAlign:n}}function H_(i,e,n,r,a){if(!(e||n||r||a))return;const u=i.length-1,d=i[u],f=(d.x+d.metrics.advance*d.scale)*e;for(let g=0;g<=u;g++)i[g].x-=f,i[g].y+=n+r+a}function Nv(i,e,n){const{horizontalAlign:r,verticalAlign:a}=Wp(n),u=e[0]-i.displaySize[0]*r,d=e[1]-i.displaySize[1]*a;return{image:i,top:d,bottom:d+i.displaySize[1],left:u,right:u+i.displaySize[0]}}function Y_(i,e,n,r,a,u){const d=i.image;let f;if(d.content){const j=d.content,H=d.pixelRatio||1;f=[j[0]/H,j[1]/H,d.displaySize[0]-j[2]/H,d.displaySize[1]-j[3]/H]}const g=e.left*u,v=e.right*u;let w,E,M,k;n==="width"||n==="both"?(k=a[0]+g-r[3],E=a[0]+v+r[1]):(k=a[0]+(g+v-d.displaySize[0])/2,E=k+d.displaySize[0]);const L=e.top*u,F=e.bottom*u;return n==="height"||n==="both"?(w=a[1]+L-r[0],M=a[1]+F+r[2]):(w=a[1]+(L+F-d.displaySize[1])/2,M=w+d.displaySize[1]),{image:d,top:w,right:E,bottom:M,left:k,collisionPadding:f}}class Po extends Z{constructor(e,n,r,a,u){super(e,n),this.angle=a,this.z=r,u!==void 0&&(this.segment=u)}clone(){return new Po(this.x,this.y,this.z,this.angle,this.segment)}}function X_(i,e,n,r,a){if(e.segment===void 0)return!0;let u=e,d=e.segment+1,f=0;for(;f>-n/2;){if(d--,d<0)return!1;f-=i[d].dist(u),u=i[d]}f+=i[d].dist(i[d+1]),d++;const g=[];let v=0;for(;f<n/2;){const w=i[d],E=i[d+1];if(!E)return!1;let M=i[d-1].angleTo(w)-w.angleTo(E);for(M=Math.abs((M+3*Math.PI)%(2*Math.PI)-Math.PI),g.push({distance:f,angleDelta:M}),v+=M;f-g[0].distance>r;)v-=g.shift().angleDelta;if(v>a)return!1;d++,f+=w.dist(E)}return!0}function Q_(i){let e=0;for(let n=0;n<i.length-1;n++)e+=i[n].dist(i[n+1]);return e}function K_(i,e,n){return i?.6*e*n:0}function $_(i,e){return Math.max(i?i.right-i.left:0,e?e.right-e.left:0)}function Uv(i,e,n,r,a,u){const d=K_(n,a,u),f=$_(n,r)*u;let g=0;const v=Q_(i)/2;for(let w=0;w<i.length-1;w++){const E=i[w],M=i[w+1],k=E.dist(M);if(g+k>v){const L=(v-g)/k,F=xt(E.x,M.x,L),j=xt(E.y,M.y,L),H=new Po(F,j,0,M.angleTo(E),w);return!d||X_(i,H,f,d,e)?H:void 0}g+=k}}function Vv(i,e,n,r,a,u,d,f,g){const v=K_(r,u,d),w=$_(r,a),E=w*d,M=i[0].x===0||i[0].x===g||i[0].y===0||i[0].y===g;return e-E<e/4&&(e=E+e/4),J_(i,M?e/2*f%e:(w/2+2*u)*d*f%e,e,v,n,E,M,!1,g)}function J_(i,e,n,r,a,u,d,f,g){const v=u/2,w=Q_(i);let E=0,M=e-n,k=[];for(let L=0;L<i.length-1;L++){const F=i[L],j=i[L+1],H=F.dist(j),ne=j.angleTo(F);for(;M+n<E+H;){M+=n;const le=(M-E)/H,ue=xt(F.x,j.x,le),he=xt(F.y,j.y,le);if(ue>=0&&ue<g&&he>=0&&he<g&&M-v>=0&&M+v<=w){const de=new Po(ue,he,0,ne,L);de._round(),r&&!X_(i,de,u,r,a)||k.push(de)}}E+=H}return f||k.length||d||(k=J_(i,E/2,n,r,a,u,d,!0,g)),k}function eg(i,e,n,r,a){const u=[];for(let d=0;d<i.length;d++){const f=i[d];let g;for(let v=0;v<f.length-1;v++){let w=f[v],E=f[v+1];w.x<e&&E.x<e||(w.x<e?w=new Z(e,w.y+(e-w.x)/(E.x-w.x)*(E.y-w.y))._round():E.x<e&&(E=new Z(e,w.y+(e-w.x)/(E.x-w.x)*(E.y-w.y))._round()),w.y<n&&E.y<n||(w.y<n?w=new Z(w.x+(n-w.y)/(E.y-w.y)*(E.x-w.x),n)._round():E.y<n&&(E=new Z(w.x+(n-w.y)/(E.y-w.y)*(E.x-w.x),n)._round()),w.x>=r&&E.x>=r||(w.x>=r?w=new Z(r,w.y+(r-w.x)/(E.x-w.x)*(E.y-w.y))._round():E.x>=r&&(E=new Z(r,w.y+(r-w.x)/(E.x-w.x)*(E.y-w.y))._round()),w.y>=a&&E.y>=a||(w.y>=a?w=new Z(w.x+(a-w.y)/(E.y-w.y)*(E.x-w.x),a)._round():E.y>=a&&(E=new Z(w.x+(a-w.y)/(E.y-w.y)*(E.x-w.x),a)._round()),g&&w.equals(g[g.length-1])||(g=[w],u.push(g)),g.push(E)))))}}return u}nt(Po);const Qc=1e20;function tg(i,e,n,r,a,u,d,f,g){for(let v=e;v<e+r;v++)ig(i,n*u+v,u,a,d,f,g);for(let v=n;v<n+a;v++)ig(i,v*u+e,1,r,d,f,g)}function ig(i,e,n,r,a,u,d){u[0]=0,d[0]=-Qc,d[1]=Qc,a[0]=i[e];for(let f=1,g=0,v=0;f<r;f++){a[f]=i[e+f*n];const w=f*f;do{const E=u[g];v=(a[f]-a[E]+w-E*E)/(f-E)/2}while(v<=d[g]&&--g>-1);g++,u[g]=f,d[g]=v,d[g+1]=Qc}for(let f=0,g=0;f<r;f++){for(;d[g+1]<f;)g++;const v=u[g],w=f-v;i[e+f*n]=a[v]+w*w}}const Hp={none:0,ideographs:1,all:2};class yl{constructor(e,n,r){this.requestManager=e,this.localGlyphMode=n,this.localFontFamily=r,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e){this.url=e}getGlyphs(e,n){const r=[];for(const a in e)for(const u of e[a])r.push({stack:a,id:u});zi(r,({stack:a,id:u},d)=>{let f=this.entries[a];f||(f=this.entries[a]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let g=f.glyphs[u];if(g!==void 0)return void d(null,{stack:a,id:u,glyph:g});if(g=this._tinySDF(f,a,u),g)return f.glyphs[u]=g,void d(null,{stack:a,id:u,glyph:g});const v=Math.floor(u/256);if(256*v>65535)return void d(new Error("glyphs > 65535 not supported"));if(f.ranges[v])return void d(null,{stack:a,id:u,glyph:g});let w=f.requests[v];w||(w=f.requests[v]=[],yl.loadGlyphRange(a,v,this.url,this.requestManager,(E,M)=>{if(M){f.ascender=M.ascender,f.descender=M.descender;for(const k in M.glyphs)this._doesCharSupportLocalGlyph(+k)||(f.glyphs[+k]=M.glyphs[+k]);f.ranges[v]=!0}for(const k of w)k(E,M);delete f.requests[v]})),w.push((E,M)=>{E?d(E):M&&d(null,{stack:a,id:u,glyph:M.glyphs[u]||null})})},(a,u)=>{if(a)n(a);else if(u){const d={};for(const{stack:f,id:g,glyph:v}of u)d[f]===void 0&&(d[f]={}),d[f].glyphs===void 0&&(d[f].glyphs={}),d[f].glyphs[g]=v&&{id:v.id,bitmap:v.bitmap.clone(),metrics:v.metrics},d[f].ascender=this.entries[f].ascender,d[f].descender=this.entries[f].descender;n(null,d)}})}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==Hp.none&&(this.localGlyphMode===Hp.all?!!this.localFontFamily:!!this.localFontFamily&&(wc(e)||Ah(e)||ea(e)||$a(e)||Ka(e)))}_tinySDF(e,n,r){const a=this.localFontFamily;if(!a||!this._doesCharSupportLocalGlyph(r))return;let u=e.tinySDF;if(!u){let F="400";/bold/i.test(n)?F="900":/medium/i.test(n)?F="500":/light/i.test(n)&&(F="200"),u=e.tinySDF=new yl.TinySDF({fontFamily:a,fontWeight:F,fontSize:48,buffer:6,radius:16}),u.fontWeight=F}if(this.localGlyphs[u.fontWeight][r])return this.localGlyphs[u.fontWeight][r];const d=String.fromCharCode(r),{data:f,width:g,height:v,glyphWidth:w,glyphHeight:E,glyphLeft:M,glyphTop:k,glyphAdvance:L}=u.draw(d);return this.localGlyphs[u.fontWeight][r]={id:r,bitmap:new ko({width:g,height:v},f),metrics:{width:w/2,height:E/2,left:M/2,top:k/2-27,advance:L/2,localGlyph:!0}}}}function ng(i,e,n,r){const a=[],u=i.image,d=u.pixelRatio,f=u.paddedRect.w-2,g=u.paddedRect.h-2,v=i.right-i.left,w=i.bottom-i.top,E=u.stretchX||[[0,f]],M=u.stretchY||[[0,g]],k=(be,Ie)=>be+Ie[1]-Ie[0],L=E.reduce(k,0),F=M.reduce(k,0),j=f-L,H=g-F;let ne=0,le=L,ue=0,he=F,de=0,Te=j,Me=0,De=H;if(u.content&&r){const be=u.content;ne=Hh(E,0,be[0]),ue=Hh(M,0,be[1]),le=Hh(E,be[0],be[2]),he=Hh(M,be[1],be[3]),de=be[0]-ne,Me=be[1]-ue,Te=be[2]-be[0]-le,De=be[3]-be[1]-he}const Be=(be,Ie,Oe,We)=>{const Ve=Yh(be.stretch-ne,le,v,i.left),qe=Xh(be.fixed-de,Te,be.stretch,L),Pt=Yh(Ie.stretch-ue,he,w,i.top),jt=Xh(Ie.fixed-Me,De,Ie.stretch,F),Bt=Yh(Oe.stretch-ne,le,v,i.left),Nt=Xh(Oe.fixed-de,Te,Oe.stretch,L),ut=Yh(We.stretch-ue,he,w,i.top),it=Xh(We.fixed-Me,De,We.stretch,F),Wt=new Z(Ve,Pt),si=new Z(Bt,Pt),Yi=new Z(Bt,ut),bi=new Z(Ve,ut),Xi=new Z(qe/d,jt/d),ai=new Z(Nt/d,it/d),Yt=e*Math.PI/180;if(Yt){const Fi=Math.sin(Yt),Qi=Math.cos(Yt),Ji=[Qi,-Fi,Fi,Qi];Wt._matMult(Ji),si._matMult(Ji),bi._matMult(Ji),Yi._matMult(Ji)}const mi=be.stretch+be.fixed,Pi=Ie.stretch+Ie.fixed;return{tl:Wt,tr:si,bl:bi,br:Yi,tex:{x:u.paddedRect.x+1+mi,y:u.paddedRect.y+1+Pi,w:Oe.stretch+Oe.fixed-mi,h:We.stretch+We.fixed-Pi},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Xi,pixelOffsetBR:ai,minFontScaleX:Te/d/v,minFontScaleY:De/d/w,isSDF:n}};if(r&&(u.stretchX||u.stretchY)){const be=rg(E,j,L),Ie=rg(M,H,F);for(let Oe=0;Oe<be.length-1;Oe++){const We=be[Oe],Ve=be[Oe+1];for(let qe=0;qe<Ie.length-1;qe++)a.push(Be(We,Ie[qe],Ve,Ie[qe+1]))}}else a.push(Be({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:f+1},{fixed:0,stretch:g+1}));return a}function Hh(i,e,n){let r=0;for(const a of i)r+=Math.max(e,Math.min(n,a[1]))-Math.max(e,Math.min(n,a[0]));return r}function rg(i,e,n){const r=[{fixed:-1,stretch:0}];for(const[a,u]of i){const d=r[r.length-1];r.push({fixed:a-d.stretch,stretch:d.stretch}),r.push({fixed:a-d.stretch,stretch:d.stretch+(u-a)})}return r.push({fixed:e+1,stretch:n}),r}function Yh(i,e,n,r){return i/e*n+r}function Xh(i,e,n,r){return i-e*n/r}function jv(i,e,n,r){const a=e+i.positionedLines[r].lineOffset;return r===0?n+a/2:n+(a+(e+i.positionedLines[r-1].lineOffset))/2}yl.loadGlyphRange=function(i,e,n,r,a){const u=256*e,d=u+255,f=r.transformRequest(r.normalizeGlyphsURL(n).replace("{fontstack}",i).replace("{range}",`${u}-${d}`),Y.Glyphs);J(f,(g,v)=>{if(g)a(g);else if(v){const w={},E=function(M){return new Yc(M).readFields(Bv,{})}(v);for(const M of E.glyphs)w[M.id]=M;a(null,{glyphs:w,ascender:E.ascender,descender:E.descender})}})},yl.TinySDF=class{constructor({fontSize:i=24,buffer:e=3,radius:n=8,cutoff:r=.25,fontFamily:a="sans-serif",fontWeight:u="normal",fontStyle:d="normal"}){this.buffer=e,this.cutoff=r,this.radius=n;const f=this.size=i+4*e,g=this._createCanvas(f),v=this.ctx=g.getContext("2d",{willReadFrequently:!0});v.font=`${d} ${u} ${i}px ${a}`,v.textBaseline="alphabetic",v.textAlign="left",v.fillStyle="black",this.gridOuter=new Float64Array(f*f),this.gridInner=new Float64Array(f*f),this.f=new Float64Array(f),this.z=new Float64Array(f+1),this.v=new Uint16Array(f)}_createCanvas(i){const e=document.createElement("canvas");return e.width=e.height=i,e}draw(i){const{width:e,actualBoundingBoxAscent:n,actualBoundingBoxDescent:r,actualBoundingBoxLeft:a,actualBoundingBoxRight:u}=this.ctx.measureText(i),d=Math.floor(n),f=Math.min(this.size-this.buffer,Math.ceil(u-a)),g=Math.min(this.size-this.buffer,Math.ceil(n)+Math.ceil(r)),v=f+2*this.buffer,w=g+2*this.buffer,E=v*w,M=new Uint8ClampedArray(E),k={data:M,width:v,height:w,glyphWidth:f,glyphHeight:g,glyphTop:d,glyphLeft:0,glyphAdvance:e};if(f===0||g===0)return k;const{ctx:L,buffer:F,gridInner:j,gridOuter:H}=this;L.clearRect(F,F,f,g),L.fillText(i,F,F+d+1);const ne=L.getImageData(F,F,f,g);H.fill(Qc,0,E),j.fill(0,0,E);for(let le=0;le<g;le++)for(let ue=0;ue<f;ue++){const he=ne.data[4*(le*f+ue)+3]/255;if(he===0)continue;const de=(le+F)*v+ue+F;if(he===1)H[de]=0,j[de]=Qc;else{const Te=.5-he;H[de]=Te>0?Te*Te:0,j[de]=Te<0?Te*Te:0}}tg(H,0,0,v,w,v,this.f,this.v,this.z),tg(j,F,F,f,g,v,this.f,this.v,this.z);for(let le=0;le<E;le++){const ue=Math.sqrt(H[le])-Math.sqrt(j[le]);M[le]=Math.round(255-255*(ue/this.radius+this.cutoff))}return k}};class Gv{constructor(e=[],n=Zv){if(this.data=e,this.length=this.data.length,this.compare=n,this.length>0)for(let r=(this.length>>1)-1;r>=0;r--)this._down(r)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],n=this.data.pop();return this.length--,this.length>0&&(this.data[0]=n,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:n,compare:r}=this,a=n[e];for(;e>0;){const u=e-1>>1,d=n[u];if(r(a,d)>=0)break;n[e]=d,e=u}n[e]=a}_down(e){const{data:n,compare:r}=this,a=this.length>>1,u=n[e];for(;e<a;){let d=1+(e<<1),f=n[d];const g=d+1;if(g<this.length&&r(n[g],f)<0&&(d=g,f=n[g]),r(f,u)>=0)break;n[e]=f,e=d}n[e]=u}}function Zv(i,e){return i<e?-1:i>e?1:0}function qv(i,e=1,n=!1){let r=1/0,a=1/0,u=-1/0,d=-1/0;const f=i[0];for(let k=0;k<f.length;k++){const L=f[k];(!k||L.x<r)&&(r=L.x),(!k||L.y<a)&&(a=L.y),(!k||L.x>u)&&(u=L.x),(!k||L.y>d)&&(d=L.y)}const g=Math.min(u-r,d-a);let v=g/2;const w=new Gv([],Wv);if(g===0)return new Z(r,a);for(let k=r;k<u;k+=g)for(let L=a;L<d;L+=g)w.push(new xl(k+v,L+v,v,i));let E=function(k){let L=0,F=0,j=0;const H=k[0];for(let ne=0,le=H.length,ue=le-1;ne<le;ue=ne++){const he=H[ne],de=H[ue],Te=he.x*de.y-de.x*he.y;F+=(he.x+de.x)*Te,j+=(he.y+de.y)*Te,L+=3*Te}return new xl(F/L,j/L,0,k)}(i),M=w.length;for(;w.length;){const k=w.pop();(k.d>E.d||!E.d)&&(E=k,n&&console.log("found best %d after %d probes",Math.round(1e4*k.d)/1e4,M)),k.max-E.d<=e||(v=k.h/2,w.push(new xl(k.p.x-v,k.p.y-v,v,i)),w.push(new xl(k.p.x+v,k.p.y-v,v,i)),w.push(new xl(k.p.x-v,k.p.y+v,v,i)),w.push(new xl(k.p.x+v,k.p.y+v,v,i)),M+=4)}return n&&(console.log(`num probes: ${M}`),console.log(`best distance: ${E.d}`)),E.p}function Wv(i,e){return e.max-i.max}function xl(i,e,n,r){this.p=new Z(i,e),this.h=n,this.d=function(a,u){let d=!1,f=1/0;for(let g=0;g<u.length;g++){const v=u[g];for(let w=0,E=v.length,M=E-1;w<E;M=w++){const k=v[w],L=v[M];k.y>a.y!=L.y>a.y&&a.x<(L.x-k.x)*(a.y-k.y)/(L.y-k.y)+k.x&&(d=!d),f=Math.min(f,e_(a,k,L))}}return(d?1:-1)*Math.sqrt(f)}(this.p,r),this.max=this.d+this.h*Math.SQRT2}const Yp=Number.POSITIVE_INFINITY,Hv=Math.sqrt(2);function og(i,e){return e[1]!==Yp?function(n,r,a){let u=0,d=0;switch(r=Math.abs(r),a=Math.abs(a),n){case"top-right":case"top-left":case"top":d=a-7;break;case"bottom-right":case"bottom-left":case"bottom":d=7-a}switch(n){case"top-right":case"bottom-right":case"right":u=-r;break;case"top-left":case"bottom-left":case"left":u=r}return[u,d]}(i,e[0],e[1]):function(n,r){let a=0,u=0;r<0&&(r=0);const d=r/Hv;switch(n){case"top-right":case"top-left":u=d-7;break;case"bottom-right":case"bottom-left":u=7-d;break;case"bottom":u=7-r;break;case"top":u=r-7}switch(n){case"top-right":case"bottom-right":a=-d;break;case"top-left":case"bottom-left":a=d;break;case"left":a=r;break;case"right":a=-r}return[a,u]}(i,e[0])}function Yv(i,e,n,r,a,u,d,f,g,v){i.createArrays(),i.tilePixelRatio=Rt/(512*i.overscaling),i.compareText={},i.iconsNeedLinear=!1;const w=i.layers[0].layout,E=i.layers[0]._unevaluatedLayout._values,M={};if(i.textSizeData.kind==="composite"){const{minZoom:F,maxZoom:j}=i.textSizeData;M.compositeTextSizes=[E["text-size"].possiblyEvaluate(new vi(F),f),E["text-size"].possiblyEvaluate(new vi(j),f)]}if(i.iconSizeData.kind==="composite"){const{minZoom:F,maxZoom:j}=i.iconSizeData;M.compositeIconSizes=[E["icon-size"].possiblyEvaluate(new vi(F),f),E["icon-size"].possiblyEvaluate(new vi(j),f)]}M.layoutTextSize=E["text-size"].possiblyEvaluate(new vi(g+1),f),M.layoutIconSize=E["icon-size"].possiblyEvaluate(new vi(g+1),f),M.textMaxSize=E["text-size"].possiblyEvaluate(new vi(18),f);const k=w.get("text-rotation-alignment")==="map"&&w.get("symbol-placement")!=="point",L=w.get("text-size");for(const F of i.features){const j=w.get("text-font").evaluate(F,{},f).join(","),H=L.evaluate(F,{},f),ne=M.layoutTextSize.evaluate(F,{},f),le=(M.layoutIconSize.evaluate(F,{},f),{horizontal:{},vertical:void 0}),ue=F.text;let he,de=[0,0];if(ue){const De=ue.toString(),Be=w.get("text-letter-spacing").evaluate(F,{},f)*un,be=w.get("text-line-height").evaluate(F,{},f)*un,Ie=Eh(De)?Be:0,Oe=w.get("text-anchor").evaluate(F,{},f),We=w.get("text-variable-anchor");if(!We){const Nt=w.get("text-radial-offset").evaluate(F,{},f);de=Nt?og(Oe,[Nt*un,Yp]):w.get("text-offset").evaluate(F,{},f).map(ut=>ut*un)}let Ve=k?"center":w.get("text-justify").evaluate(F,{},f);const qe=w.get("symbol-placement"),Pt=qe==="point",jt=qe==="point"?w.get("text-max-width").evaluate(F,{},f)*un:0,Bt=Nt=>{i.allowVerticalPlacement&&el(De)&&(le.vertical=Zp(ue,e,n,a,j,jt,be,Oe,Nt,Ie,de,lr.vertical,!0,qe,ne,H))};if(!k&&We){const Nt=Ve==="auto"?We.map(it=>Xp(it)):[Ve];let ut=!1;for(let it=0;it<Nt.length;it++){const Wt=Nt[it];if(!le.horizontal[Wt])if(ut)le.horizontal[Wt]=le.horizontal[0];else{const si=Zp(ue,e,n,a,j,jt,be,"center",Wt,Ie,de,lr.horizontal,!1,qe,ne,H);si&&(le.horizontal[Wt]=si,ut=si.positionedLines.length===1)}}Bt("left")}else{if(Ve==="auto"&&(Ve=Xp(Oe)),Pt||w.get("text-writing-mode").indexOf("horizontal")>=0||!el(De)){const Nt=Zp(ue,e,n,a,j,jt,be,Oe,Ve,Ie,de,lr.horizontal,!1,qe,ne,H);Nt&&(le.horizontal[Ve]=Nt)}Bt(qe==="point"?"left":Ve)}}let Te=!1;if(F.icon&&F.icon.name){const De=r[F.icon.name];De&&(he=Nv(a[F.icon.name],w.get("icon-offset").evaluate(F,{},f),w.get("icon-anchor").evaluate(F,{},f)),Te=De.sdf,i.sdfIcons===void 0?i.sdfIcons=De.sdf:i.sdfIcons!==De.sdf&&Gt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(De.pixelRatio!==i.pixelRatio||w.get("icon-rotate").constantOr(1)!==0)&&(i.iconsNeedLinear=!0))}const Me=ag(le.horizontal)||le.vertical;i.iconsInText||(i.iconsInText=!!Me&&Me.iconsInText),(Me||he)&&Xv(i,F,le,he,r,M,ne,0,de,Te,d,f,v)}u&&i.generateCollisionDebugBuffers(g,i.collisionBoxArray)}function Xp(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Xv(i,e,n,r,a,u,d,f,g,v,w,E,M){let k=u.textMaxSize.evaluate(e,{},E);k===void 0&&(k=d);const L=i.layers[0].layout,F=L.get("icon-offset").evaluate(e,{},E),j=ag(n.horizontal)||n.vertical,H=d/24,ne=i.tilePixelRatio*k/24,le=(be=i.overscaling,i.zoom>18&&be>2&&(be>>=1),Math.max(Rt/(512*be),1)*L.get("symbol-spacing")),ue=L.get("text-padding")*i.tilePixelRatio,he=L.get("icon-padding")*i.tilePixelRatio,de=Fe(L.get("text-max-angle")),Te=L.get("text-rotation-alignment")==="map"&&L.get("symbol-placement")!=="point",Me=L.get("icon-rotation-alignment")==="map"&&L.get("symbol-placement")!=="point",De=L.get("symbol-placement"),Be=le/2;var be;const Ie=L.get("icon-text-fit");let Oe;r&&Ie!=="none"&&(i.allowVerticalPlacement&&n.vertical&&(Oe=Y_(r,n.vertical,Ie,L.get("icon-text-fit-padding"),F,H)),j&&(r=Y_(r,j,Ie,L.get("icon-text-fit-padding"),F,H)));const We=(Ve,qe,Pt)=>{if(qe.x<0||qe.x>=Rt||qe.y<0||qe.y>=Rt)return;const{x:jt,y:Bt,z:Nt}=M.projectTilePoint(qe.x,qe.y,Pt),ut=new Po(jt,Bt,Nt,0,void 0);(function(it,Wt,si,Yi,bi,Xi,ai,Yt,mi,Pi,Fi,Qi,Ji,Xn,Rn,_i,Tn,Qn,sn,en,Ei,Ai,On,En,qi){const Cn=it.addToLineVertexArray(Wt,Yi);let mn,tn,vr,gs,ou,su,Gg,Zg=0,qg=0,Wg=0,Hg=0,pf=-1,ff=-1;const to={};let Yg=Yr(""),mf=0,_f=0;if(mi._unevaluatedLayout.getValue("text-radial-offset")===void 0?[mf,_f]=mi.layout.get("text-offset").evaluate(Ei,{},qi).map(Kn=>Kn*un):(mf=mi.layout.get("text-radial-offset").evaluate(Ei,{},qi)*un,_f=Yp),it.allowVerticalPlacement&&bi.vertical){const Kn=bi.vertical;if(Rn)su=Qp(Kn),Yt&&(Gg=Qp(Yt));else{const $n=mi.layout.get("text-rotate").evaluate(Ei,{},qi)+90;vr=Qh(Pi,si,Wt,Fi,Qi,Ji,Kn,Xn,$n,_i),Yt&&(gs=Qh(Pi,si,Wt,Fi,Qi,Ji,Yt,Qn,$n))}}if(Xi){const Kn=mi.layout.get("icon-rotate").evaluate(Ei,{},qi),$n=mi.layout.get("icon-text-fit")!=="none",au=ng(Xi,Kn,On,$n),yf=Yt?ng(Yt,Kn,On,$n):void 0;tn=Qh(Pi,si,Wt,Fi,Qi,Ji,Xi,Qn,Kn),Zg=4*au.length;const Xg=it.iconSizeData;let pa=null;Xg.kind==="source"?(pa=[Kr*mi.layout.get("icon-size").evaluate(Ei,{},qi)],pa[0]>hs&&Gt(`${it.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):Xg.kind==="composite"&&(pa=[Kr*Ai.compositeIconSizes[0].evaluate(Ei,{},qi),Kr*Ai.compositeIconSizes[1].evaluate(Ei,{},qi)],(pa[0]>hs||pa[1]>hs)&&Gt(`${it.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),it.addSymbols(it.icon,au,pa,en,sn,Ei,!1,si,Wt,Cn.lineStartIndex,Cn.lineLength,-1,En,qi),pf=it.icon.placedSymbolArray.length-1,yf&&(qg=4*yf.length,it.addSymbols(it.icon,yf,pa,en,sn,Ei,lr.vertical,si,Wt,Cn.lineStartIndex,Cn.lineLength,-1,En,qi),ff=it.icon.placedSymbolArray.length-1)}for(const Kn in bi.horizontal){const $n=bi.horizontal[Kn];mn||(Yg=Yr($n.text),Rn?ou=Qp($n):mn=Qh(Pi,si,Wt,Fi,Qi,Ji,$n,Xn,mi.layout.get("text-rotate").evaluate(Ei,{},qi),_i));const au=$n.positionedLines.length===1;if(Wg+=sg(it,si,Wt,$n,ai,mi,Rn,Ei,_i,Cn,bi.vertical?lr.horizontal:lr.horizontalOnly,au?Object.keys(bi.horizontal):[Kn],to,pf,Ai,En,qi),au)break}bi.vertical&&(Hg+=sg(it,si,Wt,bi.vertical,ai,mi,Rn,Ei,_i,Cn,lr.vertical,["vertical"],to,ff,Ai,En,qi));let ys=-1;const gf=(Kn,$n)=>Kn?Math.max(Kn,$n):$n;ys=gf(ou,ys),ys=gf(su,ys),ys=gf(Gg,ys);const Ib=ys>-1?1:0;it.glyphOffsetArray.length>=ds.MAX_GLYPHS&&Gt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Ei.sortKey!==void 0&&it.addToSortKeyRanges(it.symbolInstances.length,Ei.sortKey),it.symbolInstances.emplaceBack(si.x,si.y,si.z,Wt.x,Wt.y,to.right>=0?to.right:-1,to.center>=0?to.center:-1,to.left>=0?to.left:-1,to.vertical>=0?to.vertical:-1,pf,ff,Yg,mn!==void 0?mn:it.collisionBoxArray.length,mn!==void 0?mn+1:it.collisionBoxArray.length,vr!==void 0?vr:it.collisionBoxArray.length,vr!==void 0?vr+1:it.collisionBoxArray.length,tn!==void 0?tn:it.collisionBoxArray.length,tn!==void 0?tn+1:it.collisionBoxArray.length,gs||it.collisionBoxArray.length,gs?gs+1:it.collisionBoxArray.length,Fi,Wg,Hg,Zg,qg,Ib,0,mf,_f,ys)})(i,qe,ut,Ve,n,r,a,Oe,i.layers[0],i.collisionBoxArray,e.index,e.sourceLayerIndex,i.index,ue,Te,g,0,he,Me,F,e,u,v,w,E)};if(De==="line")for(const Ve of eg(e.geometry,0,0,Rt,Rt)){const qe=Vv(Ve,le,de,n.vertical||j,r,24,ne,i.overscaling,Rt);for(const Pt of qe){const jt=j;jt&&Qv(i,jt.text,Be,Pt)||We(Ve,Pt,E)}}else if(De==="line-center"){for(const Ve of e.geometry)if(Ve.length>1){const qe=Uv(Ve,de,n.vertical||j,r,24,ne);qe&&We(Ve,qe,E)}}else if(e.type==="Polygon")for(const Ve of Op(e.geometry,0)){const qe=qv(Ve,16);We(Ve[0],new Po(qe.x,qe.y,0,0,void 0),E)}else if(e.type==="LineString")for(const Ve of e.geometry)We(Ve,new Po(Ve[0].x,Ve[0].y,0,0,void 0),E);else if(e.type==="Point")for(const Ve of e.geometry)for(const qe of Ve)We([qe],new Po(qe.x,qe.y,0,0,void 0),E)}const hs=32640;function sg(i,e,n,r,a,u,d,f,g,v,w,E,M,k,L,F,j){const H=function(ue,he,de,Te,Me,De,Be,be){const Ie=[];if(he.positionedLines.length===0)return Ie;const Oe=Te.layout.get("text-rotate").evaluate(De,{})*Math.PI/180,We=function(Bt){const Nt=Bt[0],ut=Bt[1],it=Nt*ut;return it>0?[Nt,-ut]:it<0?[-Nt,ut]:Nt===0?[ut,Nt]:[ut,-Nt]}(de);let Ve=Math.abs(he.top-he.bottom);for(const Bt of he.positionedLines)Ve-=Bt.lineOffset;const qe=he.positionedLines.length,Pt=Ve/qe;let jt=he.top-de[1];for(let Bt=0;Bt<qe;++Bt){const Nt=he.positionedLines[Bt];jt=jv(he,Pt,jt,Bt);for(const ut of Nt.positionedGlyphs){if(!ut.rect)continue;const it=ut.rect||{};let Wt=4,si=!0,Yi=1,bi=0;if(ut.imageName){const Ai=Be[ut.imageName];if(!Ai)continue;if(Ai.sdf){Gt("SDF images are not supported in formatted text and will be ignored.");continue}si=!1,Yi=Ai.pixelRatio,Wt=1/Yi}const Xi=(Me||be)&&ut.vertical,ai=ut.metrics.advance*ut.scale/2,Yt=ut.metrics,mi=ut.rect;if(mi===null)continue;be&&he.verticalizable&&(bi=ut.imageName?ai-ut.metrics.width*ut.scale/2:0);const Pi=Me?[ut.x+ai,ut.y]:[0,0];let Fi=[0,0],Qi=[0,0],Ji=!1;Me||(Xi?(Qi=[ut.x+ai+We[0],ut.y+We[1]-bi],Ji=!0):Fi=[ut.x+ai+de[0],ut.y+de[1]-bi]);const Xn=mi.w*ut.scale/(Yi*(ut.localGlyph?2:1)),Rn=mi.h*ut.scale/(Yi*(ut.localGlyph?2:1));let _i,Tn,Qn,sn;if(Xi){const Ai=ut.y-jt,On=new Z(-ai,ai-Ai),En=-Math.PI/2,qi=new Z(...Qi);_i=new Z(-ai+Fi[0],Fi[1]),_i._rotateAround(En,On)._add(qi),_i.x+=-Ai+ai,_i.y-=(Yt.left-Wt)*ut.scale;const Cn=ut.imageName?Yt.advance*ut.scale:un*ut.scale,mn=String.fromCharCode(ut.glyph);wv(mn)?_i.x+=(1-Wt)*ut.scale:Tv(mn)?_i.x+=Cn-Yt.height*ut.scale+(-Wt-1)*ut.scale:_i.x+=ut.imageName||Yt.width+2*Wt===mi.w&&Yt.height+2*Wt===mi.h?(Cn-Rn)/2:(Cn-(Yt.height+2*Wt)*ut.scale)/2,Tn=new Z(_i.x,_i.y-Xn),Qn=new Z(_i.x+Rn,_i.y),sn=new Z(_i.x+Rn,_i.y-Xn)}else{const Ai=(Yt.left-Wt)*ut.scale-ai+Fi[0],On=(-Yt.top-Wt)*ut.scale+Fi[1],En=Ai+Xn,qi=On+Rn;_i=new Z(Ai,On),Tn=new Z(En,On),Qn=new Z(Ai,qi),sn=new Z(En,qi)}if(Oe){let Ai;Ai=Me?new Z(0,0):Ji?new Z(We[0],We[1]):new Z(de[0],de[1]),_i._rotateAround(Oe,Ai),Tn._rotateAround(Oe,Ai),Qn._rotateAround(Oe,Ai),sn._rotateAround(Oe,Ai)}const en=new Z(0,0),Ei=new Z(0,0);Ie.push({tl:_i,tr:Tn,bl:Qn,br:sn,tex:it,writingMode:he.writingMode,glyphOffset:Pi,sectionIndex:ut.sectionIndex,isSDF:si,pixelOffsetTL:en,pixelOffsetBR:Ei,minFontScaleX:0,minFontScaleY:0})}}return Ie}(0,r,g,u,d,f,a,i.allowVerticalPlacement),ne=i.textSizeData;let le=null;ne.kind==="source"?(le=[Kr*u.layout.get("text-size").evaluate(f,{},j)],le[0]>hs&&Gt(`${i.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):ne.kind==="composite"&&(le=[Kr*L.compositeTextSizes[0].evaluate(f,{},j),Kr*L.compositeTextSizes[1].evaluate(f,{},j)],(le[0]>hs||le[1]>hs)&&Gt(`${i.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),i.addSymbols(i.text,H,le,g,d,f,w,e,n,v.lineStartIndex,v.lineLength,k,F,j);for(const ue of E)M[ue]=i.text.placedSymbolArray.length-1;return 4*H.length}function ag(i){for(const e in i)return i[e];return null}function Qh(i,e,n,r,a,u,d,f,g,v){let w=d.top,E=d.bottom,M=d.left,k=d.right;const L=d.collisionPadding;if(L&&(M-=L[0],w-=L[1],k+=L[2],E+=L[3]),g){const F=new Z(M,w),j=new Z(k,w),H=new Z(M,E),ne=new Z(k,E),le=Fe(g);let ue=new Z(0,0);v&&(ue=new Z(v[0],v[1])),F._rotateAround(le,ue),j._rotateAround(le,ue),H._rotateAround(le,ue),ne._rotateAround(le,ue),M=Math.min(F.x,j.x,H.x,ne.x),k=Math.max(F.x,j.x,H.x,ne.x),w=Math.min(F.y,j.y,H.y,ne.y),E=Math.max(F.y,j.y,H.y,ne.y)}return i.emplaceBack(e.x,e.y,e.z,n.x,n.y,M,w,k,E,f,r,a,u),i.length-1}function Qp(i){i.collisionPadding&&(i.top-=i.collisionPadding[1],i.bottom+=i.collisionPadding[3]);const e=i.bottom-i.top;return e>0?Math.max(10,e):null}function Qv(i,e,n,r){const a=i.compareText;if(e in a){const u=a[e];for(let d=u.length-1;d>=0;d--)if(r.dist(u[d])<n)return!0}else a[e]=[];return a[e].push(r),!1}const Kv=ua.VectorTileFeature.types,$v=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Kh(i,e,n,r,a,u,d,f,g,v,w,E,M,k,L,F){const j=w?Math.min(hs,Math.round(w[0])):0,H=w?Math.min(hs,Math.round(w[1])):0;i.emplaceBack(e,n,Math.round(32*d),Math.round(32*f),g,v,(j<<1)+(E?1:0),H,16*M,16*k,256*L,256*F,r,a,u,0)}function Kp(i,e,n){i.emplaceBack(e.x,e.y,n),i.emplaceBack(e.x,e.y,n),i.emplaceBack(e.x,e.y,n),i.emplaceBack(e.x,e.y,n)}function Jv(i){for(const e of i.sections)if(dp(e.text))return!0;return!1}class $p{constructor(e){this.layoutVertexArray=new Ce,this.indexArray=new we,this.programConfigurations=e,this.segments=new Oi,this.dynamicLayoutVertexArray=new re,this.opacityVertexArray=new Ze,this.placedSymbolArray=new zr}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,n,r,a){this.isEmpty()||(r&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,_v.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,n),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,gv.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,$v,!0),this.opacityVertexBuffer.itemSize=1),(r||a)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}nt($p);class Jp{constructor(e,n,r){this.layoutVertexArray=new e,this.layoutAttributes=n,this.indexArray=new r,this.segments=new Oi,this.collisionVertexArray=new lt,this.collisionVertexArrayExt=new re}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,yv.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,xv.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}nt(Jp);class ds{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(d=>d.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Qr([]),this.placementViewportMatrix=Qr([]);const n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Up(this.zoom,n["text-size"]),this.iconSizeData=Up(this.zoom,n["icon-size"]);const r=this.layers[0].layout,a=r.get("symbol-sort-key"),u=r.get("symbol-z-order");this.canOverlap=r.get("text-allow-overlap")||r.get("icon-allow-overlap")||r.get("text-ignore-placement")||r.get("icon-ignore-placement"),this.sortFeaturesByKey=u!=="viewport-y"&&a.constantOr(1)!==void 0,this.sortFeaturesByY=(u==="viewport-y"||u==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=r.get("text-writing-mode").map(d=>lr[d]),this.stateDependentLayerIds=this.layers.filter(d=>d.isStateDependent()).map(d=>d.id),this.sourceID=e.sourceID,this.projection=e.projection}createArrays(){this.text=new $p(new sa(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new $p(new sa(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new oi,this.lineVertexArray=new Gi,this.symbolInstances=new Ri}calculateGlyphDependencies(e,n,r,a,u){for(let d=0;d<e.length;d++)if(n[e.charCodeAt(d)]=!0,a&&u){const f=Hc[e.charAt(d)];f&&(n[f.charCodeAt(0)]=!0)}}populate(e,n,r,a){const u=this.layers[0],d=u.layout,f=d.get("text-font"),g=d.get("text-field"),v=d.get("icon-image"),w=(g.value.kind!=="constant"||g.value.value instanceof Hi&&!g.value.value.isEmpty()||g.value.value.toString().length>0)&&(f.value.kind!=="constant"||f.value.value.length>0),E=v.value.kind!=="constant"||!!v.value.value||Object.keys(v.parameters).length>0,M=d.get("symbol-sort-key");if(this.features=[],!w&&!E)return;const k=n.iconDependencies,L=n.glyphDependencies,F=n.availableImages,j=new vi(this.zoom);for(const{feature:H,id:ne,index:le,sourceLayerIndex:ue}of e){const he=u._featureFilter.needGeometry,de=aa(H,he);if(!u._featureFilter.filter(j,de,r))continue;let Te,Me;if(he||(de.geometry=zo(H,r,a)),w){const Be=u.getValueAndResolveTokens("text-field",de,r,F),be=Hi.factory(Be);Jv(be)&&(this.hasRTLText=!0),(!this.hasRTLText||rl()==="unavailable"||this.hasRTLText&&Gn.isParsed())&&(Te=Av(be,u,de))}if(E){const Be=u.getValueAndResolveTokens("icon-image",de,r,F);Me=Be instanceof Sn?Be:Sn.fromString(Be)}if(!Te&&!Me)continue;const De=this.sortFeaturesByKey?M.evaluate(de,{},r):void 0;if(this.features.push({id:ne,text:Te,icon:Me,index:le,sourceLayerIndex:ue,geometry:de.geometry,properties:H.properties,type:Kv[H.type],sortKey:De}),Me&&(k[Me.name]=!0),Te){const Be=f.evaluate(de,{},r).join(","),be=d.get("text-rotation-alignment")==="map"&&d.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(lr.vertical)>=0;for(const Ie of Te.sections)if(Ie.image)k[Ie.image.name]=!0;else{const Oe=el(Te.toString()),We=Ie.fontStack||Be,Ve=L[We]=L[We]||{};this.calculateGlyphDependencies(Ie.text,Ve,be,this.allowVerticalPlacement,Oe)}}}d.get("symbol-placement")==="line"&&(this.features=function(H){const ne={},le={},ue=[];let he=0;function de(Be){ue.push(H[Be]),he++}function Te(Be,be,Ie){const Oe=le[Be];return delete le[Be],le[be]=Oe,ue[Oe].geometry[0].pop(),ue[Oe].geometry[0]=ue[Oe].geometry[0].concat(Ie[0]),Oe}function Me(Be,be,Ie){const Oe=ne[be];return delete ne[be],ne[Be]=Oe,ue[Oe].geometry[0].shift(),ue[Oe].geometry[0]=Ie[0].concat(ue[Oe].geometry[0]),Oe}function De(Be,be,Ie){const Oe=Ie?be[0][be[0].length-1]:be[0][0];return`${Be}:${Oe.x}:${Oe.y}`}for(let Be=0;Be<H.length;Be++){const be=H[Be],Ie=be.geometry,Oe=be.text?be.text.toString():null;if(!Oe){de(Be);continue}const We=De(Oe,Ie),Ve=De(Oe,Ie,!0);if(We in le&&Ve in ne&&le[We]!==ne[Ve]){const qe=Me(We,Ve,Ie),Pt=Te(We,Ve,ue[qe].geometry);delete ne[We],delete le[Ve],le[De(Oe,ue[Pt].geometry,!0)]=Pt,ue[qe].geometry=null}else We in le?Te(We,Ve,Ie):Ve in ne?Me(We,Ve,Ie):(de(Be),ne[We]=he-1,le[Ve]=he-1)}return ue.filter(Be=>Be.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((H,ne)=>H.sortKey-ne.sortKey)}update(e,n,r,a){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,n,this.layers,r,a),this.icon.programConfigurations.updatePaintArrays(e,n,this.layers,r,a))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,n){const r=this.lineVertexArray.length,a=e.segment;if(a!==void 0){let u=e.dist(n[a+1]),d=e.dist(n[a]);const f={};for(let g=a+1;g<n.length;g++)f[g]={x:n[g].x,y:n[g].y,tileUnitDistanceFromAnchor:u},g<n.length-1&&(u+=n[g+1].dist(n[g]));for(let g=a||0;g>=0;g--)f[g]={x:n[g].x,y:n[g].y,tileUnitDistanceFromAnchor:d},g>0&&(d+=n[g-1].dist(n[g]));for(let g=0;g<n.length;g++){const v=f[g];this.lineVertexArray.emplaceBack(v.x,v.y,v.tileUnitDistanceFromAnchor)}}return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}}addSymbols(e,n,r,a,u,d,f,g,v,w,E,M,k,L){const F=e.indexArray,j=e.layoutVertexArray,H=e.segments.prepareSegment(4*n.length,j,F,this.canOverlap?d.sortKey:void 0),ne=this.glyphOffsetArray.length,le=H.vertexLength,ue=this.allowVerticalPlacement&&f===lr.vertical?Math.PI/2:0,he=d.text&&d.text.sections;for(let de=0;de<n.length;de++){const{tl:Te,tr:Me,bl:De,br:Be,tex:be,pixelOffsetTL:Ie,pixelOffsetBR:Oe,minFontScaleX:We,minFontScaleY:Ve,glyphOffset:qe,isSDF:Pt,sectionIndex:jt}=n[de],Bt=H.vertexLength,Nt=qe[1];Kh(j,g.x,g.y,g.z,v.x,v.y,Te.x,Nt+Te.y,be.x,be.y,r,Pt,Ie.x,Ie.y,We,Ve),Kh(j,g.x,g.y,g.z,v.x,v.y,Me.x,Nt+Me.y,be.x+be.w,be.y,r,Pt,Oe.x,Ie.y,We,Ve),Kh(j,g.x,g.y,g.z,v.x,v.y,De.x,Nt+De.y,be.x,be.y+be.h,r,Pt,Ie.x,Oe.y,We,Ve),Kh(j,g.x,g.y,g.z,v.x,v.y,Be.x,Nt+Be.y,be.x+be.w,be.y+be.h,r,Pt,Oe.x,Oe.y,We,Ve),Kp(e.dynamicLayoutVertexArray,g,ue),F.emplaceBack(Bt,Bt+1,Bt+2),F.emplaceBack(Bt+1,Bt+2,Bt+3),H.vertexLength+=4,H.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(qe[0]),de!==n.length-1&&jt===n[de+1].sectionIndex||e.programConfigurations.populatePaintArrays(j.length,d,d.index,{},k,L,he&&he[jt])}e.placedSymbolArray.emplaceBack(g.x,g.y,g.z,v.x,v.y,ne,this.glyphOffsetArray.length-ne,le,w,E,v.segment,r?r[0]:0,r?r[1]:0,a[0],a[1],f,0,!1,0,M,0)}_commitLayoutVertex(e,n,r,a,u,d,f){e.emplaceBack(n,r,a,u,d,Math.round(f.x),Math.round(f.y))}_addCollisionDebugVertices(e,n,r,a,u,d,f){const g=r.segments.prepareSegment(4,r.layoutVertexArray,r.indexArray),v=g.vertexLength,w=f.tileAnchorX,E=f.tileAnchorY;for(let k=0;k<4;k++)r.collisionVertexArray.emplaceBack(0,0,0,0);r.collisionVertexArrayExt.emplaceBack(n,-e.padding,-e.padding),r.collisionVertexArrayExt.emplaceBack(n,e.padding,-e.padding),r.collisionVertexArrayExt.emplaceBack(n,e.padding,e.padding),r.collisionVertexArrayExt.emplaceBack(n,-e.padding,e.padding),this._commitLayoutVertex(r.layoutVertexArray,a,u,d,w,E,new Z(e.x1,e.y1)),this._commitLayoutVertex(r.layoutVertexArray,a,u,d,w,E,new Z(e.x2,e.y1)),this._commitLayoutVertex(r.layoutVertexArray,a,u,d,w,E,new Z(e.x2,e.y2)),this._commitLayoutVertex(r.layoutVertexArray,a,u,d,w,E,new Z(e.x1,e.y2)),g.vertexLength+=4;const M=r.indexArray;M.emplaceBack(v,v+1),M.emplaceBack(v+1,v+2),M.emplaceBack(v+2,v+3),M.emplaceBack(v+3,v),g.primitiveLength+=4}_addTextDebugCollisionBoxes(e,n,r,a,u,d){for(let f=a;f<u;f++){const g=r.get(f),v=this.getSymbolInstanceTextSize(e,d,n,f);this._addCollisionDebugVertices(g,v,this.textCollisionBox,g.projectedAnchorX,g.projectedAnchorY,g.projectedAnchorZ,d)}}_addIconDebugCollisionBoxes(e,n,r,a,u,d){for(let f=a;f<u;f++){const g=r.get(f),v=this.getSymbolInstanceIconSize(e,n,f);this._addCollisionDebugVertices(g,v,this.iconCollisionBox,g.projectedAnchorX,g.projectedAnchorY,g.projectedAnchorZ,d)}}generateCollisionDebugBuffers(e,n){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Jp(je,L_.members,ht),this.iconCollisionBox=new Jp(je,L_.members,ht);const r=fl(this.iconSizeData,e),a=fl(this.textSizeData,e);for(let u=0;u<this.symbolInstances.length;u++){const d=this.symbolInstances.get(u);this._addTextDebugCollisionBoxes(a,e,n,d.textBoxStartIndex,d.textBoxEndIndex,d),this._addTextDebugCollisionBoxes(a,e,n,d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d),this._addIconDebugCollisionBoxes(r,e,n,d.iconBoxStartIndex,d.iconBoxEndIndex,d),this._addIconDebugCollisionBoxes(r,e,n,d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex,d)}}getSymbolInstanceTextSize(e,n,r,a){const u=this.text.placedSymbolArray.get(n.rightJustifiedTextSymbolIndex>=0?n.rightJustifiedTextSymbolIndex:n.centerJustifiedTextSymbolIndex>=0?n.centerJustifiedTextSymbolIndex:n.leftJustifiedTextSymbolIndex>=0?n.leftJustifiedTextSymbolIndex:n.verticalPlacedTextSymbolIndex>=0?n.verticalPlacedTextSymbolIndex:a),d=Zh(this.textSizeData,e,u)/un;return this.tilePixelRatio*d}getSymbolInstanceIconSize(e,n,r){const a=this.icon.placedSymbolArray.get(r),u=Zh(this.iconSizeData,e,a);return this.tilePixelRatio*u}_commitDebugCollisionVertexUpdate(e,n,r){e.emplaceBack(n,-r,-r),e.emplaceBack(n,r,-r),e.emplaceBack(n,r,r),e.emplaceBack(n,-r,r)}_updateTextDebugCollisionBoxes(e,n,r,a,u,d){for(let f=a;f<u;f++){const g=r.get(f),v=this.getSymbolInstanceTextSize(e,d,n,f);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,v,g.padding)}}_updateIconDebugCollisionBoxes(e,n,r,a,u){for(let d=a;d<u;d++){const f=r.get(d),g=this.getSymbolInstanceIconSize(e,n,d);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,g,f.padding)}}updateCollisionDebugBuffers(e,n){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const r=fl(this.iconSizeData,e),a=fl(this.textSizeData,e);for(let u=0;u<this.symbolInstances.length;u++){const d=this.symbolInstances.get(u);this._updateTextDebugCollisionBoxes(a,e,n,d.textBoxStartIndex,d.textBoxEndIndex,d),this._updateTextDebugCollisionBoxes(a,e,n,d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d),this._updateIconDebugCollisionBoxes(r,e,n,d.iconBoxStartIndex,d.iconBoxEndIndex),this._updateIconDebugCollisionBoxes(r,e,n,d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,n,r,a,u,d,f,g,v){const w={};for(let E=n;E<r;E++){const M=e.get(E);w.textBox={x1:M.x1,y1:M.y1,x2:M.x2,y2:M.y2,padding:M.padding,projectedAnchorX:M.projectedAnchorX,projectedAnchorY:M.projectedAnchorY,projectedAnchorZ:M.projectedAnchorZ,tileAnchorX:M.tileAnchorX,tileAnchorY:M.tileAnchorY},w.textFeatureIndex=M.featureIndex;break}for(let E=a;E<u;E++){const M=e.get(E);w.verticalTextBox={x1:M.x1,y1:M.y1,x2:M.x2,y2:M.y2,padding:M.padding,projectedAnchorX:M.projectedAnchorX,projectedAnchorY:M.projectedAnchorY,projectedAnchorZ:M.projectedAnchorZ,tileAnchorX:M.tileAnchorX,tileAnchorY:M.tileAnchorY},w.verticalTextFeatureIndex=M.featureIndex;break}for(let E=d;E<f;E++){const M=e.get(E);w.iconBox={x1:M.x1,y1:M.y1,x2:M.x2,y2:M.y2,padding:M.padding,projectedAnchorX:M.projectedAnchorX,projectedAnchorY:M.projectedAnchorY,projectedAnchorZ:M.projectedAnchorZ,tileAnchorX:M.tileAnchorX,tileAnchorY:M.tileAnchorY},w.iconFeatureIndex=M.featureIndex;break}for(let E=g;E<v;E++){const M=e.get(E);w.verticalIconBox={x1:M.x1,y1:M.y1,x2:M.x2,y2:M.y2,padding:M.padding,projectedAnchorX:M.projectedAnchorX,projectedAnchorY:M.projectedAnchorY,projectedAnchorZ:M.projectedAnchorZ,tileAnchorX:M.tileAnchorX,tileAnchorY:M.tileAnchorY},w.verticalIconFeatureIndex=M.featureIndex;break}return w}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let n=0;n<this.symbolInstances.length;n++){const r=this.symbolInstances.get(n);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,r.textBoxStartIndex,r.textBoxEndIndex,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex,r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,n){const r=e.placedSymbolArray.get(n),a=r.vertexStartIndex+4*r.numGlyphs;for(let u=r.vertexStartIndex;u<a;u+=4)e.indexArray.emplaceBack(u,u+1,u+2),e.indexArray.emplaceBack(u+1,u+2,u+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const n=Math.sin(e),r=Math.cos(e),a=[],u=[],d=[];for(let f=0;f<this.symbolInstances.length;++f){d.push(f);const g=this.symbolInstances.get(f);a.push(0|Math.round(n*g.tileAnchorX+r*g.tileAnchorY)),u.push(g.featureIndex)}return d.sort((f,g)=>a[f]-a[g]||u[g]-u[f]),d}addToSortKeyRanges(e,n){const r=this.sortKeyRanges[this.sortKeyRanges.length-1];r&&r.sortKey===n?r.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:n,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const n of this.symbolInstanceIndexes){const r=this.symbolInstances.get(n);this.featureSortOrder.push(r.featureIndex),[r.rightJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.leftJustifiedTextSymbolIndex].forEach((a,u,d)=>{a>=0&&d.indexOf(a)===u&&this.addIndicesForPlacedSymbol(this.text,a)}),r.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,r.verticalPlacedTextSymbolIndex),r.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,r.placedIconSymbolIndex),r.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,r.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}nt(ds,{omit:["layers","collisionBoxArray","features","compareText"]}),ds.MAX_GLYPHS=65535,ds.addDynamicAttributes=Kp;const eb=new B({"symbol-placement":new x(ve.layout_symbol["symbol-placement"]),"symbol-spacing":new x(ve.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new x(ve.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new A(ve.layout_symbol["symbol-sort-key"]),"symbol-z-order":new x(ve.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new x(ve.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new x(ve.layout_symbol["icon-ignore-placement"]),"icon-optional":new x(ve.layout_symbol["icon-optional"]),"icon-rotation-alignment":new x(ve.layout_symbol["icon-rotation-alignment"]),"icon-size":new A(ve.layout_symbol["icon-size"]),"icon-text-fit":new x(ve.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new x(ve.layout_symbol["icon-text-fit-padding"]),"icon-image":new A(ve.layout_symbol["icon-image"]),"icon-rotate":new A(ve.layout_symbol["icon-rotate"]),"icon-padding":new x(ve.layout_symbol["icon-padding"]),"icon-keep-upright":new x(ve.layout_symbol["icon-keep-upright"]),"icon-offset":new A(ve.layout_symbol["icon-offset"]),"icon-anchor":new A(ve.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new x(ve.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new x(ve.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new x(ve.layout_symbol["text-rotation-alignment"]),"text-field":new A(ve.layout_symbol["text-field"]),"text-font":new A(ve.layout_symbol["text-font"]),"text-size":new A(ve.layout_symbol["text-size"]),"text-max-width":new A(ve.layout_symbol["text-max-width"]),"text-line-height":new A(ve.layout_symbol["text-line-height"]),"text-letter-spacing":new A(ve.layout_symbol["text-letter-spacing"]),"text-justify":new A(ve.layout_symbol["text-justify"]),"text-radial-offset":new A(ve.layout_symbol["text-radial-offset"]),"text-variable-anchor":new x(ve.layout_symbol["text-variable-anchor"]),"text-anchor":new A(ve.layout_symbol["text-anchor"]),"text-max-angle":new x(ve.layout_symbol["text-max-angle"]),"text-writing-mode":new x(ve.layout_symbol["text-writing-mode"]),"text-rotate":new A(ve.layout_symbol["text-rotate"]),"text-padding":new x(ve.layout_symbol["text-padding"]),"text-keep-upright":new x(ve.layout_symbol["text-keep-upright"]),"text-transform":new A(ve.layout_symbol["text-transform"]),"text-offset":new A(ve.layout_symbol["text-offset"]),"text-allow-overlap":new x(ve.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new x(ve.layout_symbol["text-ignore-placement"]),"text-optional":new x(ve.layout_symbol["text-optional"])});var ef={paint:new B({"icon-opacity":new A(ve.paint_symbol["icon-opacity"]),"icon-color":new A(ve.paint_symbol["icon-color"]),"icon-halo-color":new A(ve.paint_symbol["icon-halo-color"]),"icon-halo-width":new A(ve.paint_symbol["icon-halo-width"]),"icon-halo-blur":new A(ve.paint_symbol["icon-halo-blur"]),"icon-translate":new x(ve.paint_symbol["icon-translate"]),"icon-translate-anchor":new x(ve.paint_symbol["icon-translate-anchor"]),"text-opacity":new A(ve.paint_symbol["text-opacity"]),"text-color":new A(ve.paint_symbol["text-color"],{runtimeType:_r,getOverride:i=>i.textColor,hasOverride:i=>!!i.textColor}),"text-halo-color":new A(ve.paint_symbol["text-halo-color"]),"text-halo-width":new A(ve.paint_symbol["text-halo-width"]),"text-halo-blur":new A(ve.paint_symbol["text-halo-blur"]),"text-translate":new x(ve.paint_symbol["text-translate"]),"text-translate-anchor":new x(ve.paint_symbol["text-translate-anchor"])}),layout:eb};class lg{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:wr,this.defaultValue=e}evaluate(e){if(e.formattedSection){const n=this.defaultValue.property.overrides;if(n&&n.hasOverride(e.formattedSection))return n.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}nt(lg,{omit:["defaultValue"]});class $h extends Dr{constructor(e){super(e,ef)}recalculate(e,n){super.recalculate(e,n),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const r=this.layout.get("text-writing-mode");if(r){const a=[];for(const u of r)a.indexOf(u)<0&&a.push(u);this.layout._values["text-writing-mode"]=a}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,n,r,a){const u=this.layout.get(e).evaluate(n,{},r,a),d=this._unevaluatedLayout._values[e];return d.isDataDriven()||Jo(d.value)||!u?u:function(f,g){return g.replace(/{([^{}]+)}/g,(v,w)=>w in f?String(f[w]):"")}(n.properties,u)}createBucket(e){return new ds(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of ef.paint.overridableProperties){if(!$h.hasPaintOverride(this.layout,e))continue;const n=this.paint.get(e),r=new lg(n),a=new Za(r,n.property.specification);let u=null;u=n.value.kind==="constant"||n.value.kind==="source"?new uc("source",a):new hc("composite",a,n.value.zoomStops,n.value._interpolationType),this.paint._values[e]=new m(n.property,u,n.parameters)}}_handleOverridablePaintPropertyUpdate(e,n,r){return!(!this.layout||n.isDataDriven()||r.isDataDriven())&&$h.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,n){const r=e.get("text-field"),a=ef.paint.properties[n];let u=!1;const d=f=>{for(const g of f)if(a.overrides&&a.overrides.hasOverride(g))return void(u=!0)};if(r.value.kind==="constant"&&r.value.value instanceof Hi)d(r.value.value.sections);else if(r.value.kind==="source"){const f=v=>{u||(v instanceof Er&&ji(v.value)===qo?d(v.value.sections):v instanceof Yo?d(v.sections):v.eachChild(f))},g=r.value;g._styleExpression&&f(g._styleExpression.expression)}return u}getProgramConfiguration(e){return new as(this,e)}}var tb={paint:new B({"background-color":new x(ve.paint_background["background-color"]),"background-pattern":new S(ve.paint_background["background-pattern"]),"background-opacity":new x(ve.paint_background["background-opacity"])})},ib={paint:new B({"raster-opacity":new x(ve.paint_raster["raster-opacity"]),"raster-hue-rotate":new x(ve.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new x(ve.paint_raster["raster-brightness-min"]),"raster-brightness-max":new x(ve.paint_raster["raster-brightness-max"]),"raster-saturation":new x(ve.paint_raster["raster-saturation"]),"raster-contrast":new x(ve.paint_raster["raster-contrast"]),"raster-resampling":new x(ve.paint_raster["raster-resampling"]),"raster-fade-duration":new x(ve.paint_raster["raster-fade-duration"])})};class nb extends Dr{constructor(e){super(e,{}),this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}var rb={paint:new B({"sky-type":new x(ve.paint_sky["sky-type"]),"sky-atmosphere-sun":new x(ve.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new x(ve.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new x(ve.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new x(ve.paint_sky["sky-gradient-radius"]),"sky-gradient":new z(ve.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new x(ve.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new x(ve.paint_sky["sky-atmosphere-color"]),"sky-opacity":new x(ve.paint_sky["sky-opacity"])})};function tf(i,e,n){const r=[0,0,1],a=f_([]);return function(u,d,f){f*=.5;var g=d[0],v=d[1],w=d[2],E=d[3],M=Math.sin(f),k=Math.cos(f);u[0]=g*k-w*M,u[1]=v*k+E*M,u[2]=w*k+g*M,u[3]=E*k-v*M}(a,a,n?-Fe(i)+Math.PI:Fe(i)),m_(a,a,-Fe(e)),d_(r,r,a),Rc(r,r)}const ob={circle:class extends Dr{constructor(i){super(i,Tx)}createBucket(i){return new vp(i)}queryRadius(i){const e=i;return cl("circle-radius",this,e)+cl("circle-stroke-width",this,e)+Lh(this.paint.get("circle-translate"))}queryIntersectsFeature(i,e,n,r,a,u,d,f){const g=r_(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),u.angle,i.pixelToTileUnitsFactor),v=this.paint.get("circle-radius").evaluate(e,n)+this.paint.get("circle-stroke-width").evaluate(e,n);return __(i,r,u,d,f,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",g,v)}getProgramIds(){return["circle"]}getProgramConfiguration(i){return new as(this,i)}},heatmap:class extends Dr{createBucket(i){return new y_(i)}constructor(i){super(i,kx),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){i==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Pp({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(i){return cl("heatmap-radius",this,i)}queryIntersectsFeature(i,e,n,r,a,u,d,f){const g=this.paint.get("heatmap-radius").evaluate(e,n);return __(i,r,u,d,f,!0,!0,new Z(0,0),g)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(i){return new as(this,i)}},hillshade:class extends Dr{constructor(i){super(i,Dx)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends Dr{constructor(i){super(i,Xx)}getProgramIds(){const i=this.paint.get("fill-pattern"),e=i&&i.constantOr(1),n=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&n.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),n}getProgramConfiguration(i){return new as(this,i)}recalculate(i,e){super.recalculate(i,e);const n=this.paint._values["fill-outline-color"];n.value.kind==="constant"&&n.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(i){return new Vh(i)}queryRadius(){return Lh(this.paint.get("fill-translate"))}queryIntersectsFeature(i,e,n,r,a,u){return!i.queryGeometry.isAboveHorizon&&Jm(n_(i.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),u.angle,i.pixelToTileUnitsFactor),r)}isTileClipped(){return!0}},"fill-extrusion":class extends Dr{constructor(i){super(i,av)}createBucket(i){return new qc(i)}queryRadius(){return Lh(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(i){return new as(this,i)}queryIntersectsFeature(i,e,n,r,a,u,d,f,g){const v=r_(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),u.angle,i.pixelToTileUnitsFactor),w=this.paint.get("fill-extrusion-height").evaluate(e,n),E=this.paint.get("fill-extrusion-base").evaluate(e,n),M=[0,0],k=f&&u.elevation,L=u.elevation?u.elevation.exaggeration():1,F=i.tile.getBucket(this);if(k&&F instanceof qc){const ne=F.centroidVertexArray,le=g+1;if(le<ne.length){const ue=ne.get(le);M[0]=ue.a_centroid_pos0,M[1]=ue.a_centroid_pos1}}if(M[0]===0&&M[1]===1)return!1;const j=function(ne,le,ue,he,de,Te,Me,De,Be){return Te?function(be,Ie,Oe,We,Ve,qe,Pt,jt,Bt){const Nt=[],ut=[],it=[0,0,0,1];for(const Wt of be){const si=[],Yi=[];for(const bi of Wt){const Xi=bi.x+We.x,ai=bi.y+We.y,Yt=lv(Xi,ai,Ie,Oe,qe,Pt,jt,Bt);it[0]=Xi,it[1]=ai,it[2]=Yt.base,it[3]=1,hl(it,it,Ve),it[3]=Math.max(it[3],1e-5);const mi=k_([it[0]/it[3],it[1]/it[3],it[2]/it[3]]);it[0]=Xi,it[1]=ai,it[2]=Yt.top,it[3]=1,hl(it,it,Ve),it[3]=Math.max(it[3],1e-5);const Pi=k_([it[0]/it[3],it[1]/it[3],it[2]/it[3]]);si.push(mi),Yi.push(Pi)}Nt.push(si),ut.push(Yi)}return[Nt,ut]}(ne,le,ue,he,de,Te,Me,De,Be):function(be,Ie,Oe,We,Ve){const qe=[],Pt=[],jt=Ve[8]*Ie,Bt=Ve[9]*Ie,Nt=Ve[10]*Ie,ut=Ve[11]*Ie,it=Ve[8]*Oe,Wt=Ve[9]*Oe,si=Ve[10]*Oe,Yi=Ve[11]*Oe;for(const bi of be){const Xi=[],ai=[];for(const Yt of bi){const mi=Yt.x+We.x,Pi=Yt.y+We.y,Fi=Ve[0]*mi+Ve[4]*Pi+Ve[12],Qi=Ve[1]*mi+Ve[5]*Pi+Ve[13],Ji=Ve[2]*mi+Ve[6]*Pi+Ve[14],Xn=Ve[3]*mi+Ve[7]*Pi+Ve[15],Rn=Fi+jt,_i=Qi+Bt,Tn=Ji+Nt,Qn=Math.max(Xn+ut,1e-5),sn=Fi+it,en=Qi+Wt,Ei=Ji+si,Ai=Math.max(Xn+Yi,1e-5),On=new Z(Rn/Qn,_i/Qn);On.z=Tn/Qn,Xi.push(On);const En=new Z(sn/Ai,en/Ai);En.z=Ei/Ai,ai.push(En)}qe.push(Xi),Pt.push(ai)}return[qe,Pt]}(ne,le,ue,he,de)}(r,E,w,v,d,k?f:null,M,L,u.center.lat),H=i.queryGeometry;return function(ne,le,ue){let he=1/0;Jm(ue,le)&&(he=z_(ue,le[0]));for(let de=0;de<le.length;de++){const Te=le[de],Me=ne[de];for(let De=0;De<Te.length-1;De++){const Be=Te[De],be=[Be,Te[De+1],Me[De+1],Me[De],Be];$m(ue,be)&&(he=Math.min(he,z_(ue,be)))}}return he!==1/0&&he}(j[0],j[1],H.isPointQuery()?H.screenBounds:H.screenGeometry)}},line:class extends Dr{constructor(i){super(i,D_),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(i){if(i==="line-gradient"){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof Fs,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(i,e){super.recalculate(i,e),this.paint._values["line-floorwidth"]=P_.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)}createBucket(i){return new Gh(i)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(i){return new as(this,i)}queryRadius(i){const e=i,n=B_(cl("line-width",this,e),cl("line-gap-width",this,e)),r=cl("line-offset",this,e);return n/2+Math.abs(r)+Lh(this.paint.get("line-translate"))}queryIntersectsFeature(i,e,n,r,a,u){if(i.queryGeometry.isAboveHorizon)return!1;const d=n_(i.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),u.angle,i.pixelToTileUnitsFactor),f=i.pixelToTileUnitsFactor/2*B_(this.paint.get("line-width").evaluate(e,n),this.paint.get("line-gap-width").evaluate(e,n)),g=this.paint.get("line-offset").evaluate(e,n);return g&&(r=function(v,w){const E=[],M=new Z(0,0);for(let k=0;k<v.length;k++){const L=v[k],F=[];for(let j=0;j<L.length;j++){const H=L[j-1],ne=L[j],le=L[j+1],ue=j===0?M:ne.sub(H)._unit()._perp(),he=j===L.length-1?M:le.sub(ne)._unit()._perp(),de=ue._add(he)._unit();de._mult(1/(de.x*he.x+de.y*he.y)),F.push(de._mult(w)._add(ne))}E.push(F)}return E}(r,g*i.pixelToTileUnitsFactor)),function(v,w,E){for(let M=0;M<w.length;M++){const k=w[M];if(v.length>=3){for(let L=0;L<k.length;L++)if(ll(v,k[L]))return!0}if(vx(v,k,E))return!0}return!1}(d,r,f)}isTileClipped(){return!0}},symbol:$h,background:class extends Dr{constructor(i){super(i,tb)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Dr{constructor(i){super(i,ib)}getProgramIds(){return["raster"]}},sky:class extends Dr{constructor(i){super(i,rb),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){i==="sky-gradient"?this._updateColorRamp():i!=="sky-atmosphere-sun"&&i!=="sky-atmosphere-halo-color"&&i!=="sky-atmosphere-color"&&i!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Pp({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(i){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=i.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}return!1}getCenter(i,e){if(this.paint.get("sky-type")==="atmosphere"){const r=this.paint.get("sky-atmosphere-sun"),a=!r,u=i.style.light,d=u.properties.get("position");return a&&u.properties.get("anchor")==="viewport"&&Gt("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),a?tf(d.azimuthal,90-d.polar,e):tf(r[0],90-r[1],e)}const n=this.paint.get("sky-gradient-center");return tf(n[0],90-n[1],e)}is3D(){return!1}isSky(){return!0}markSkyboxValid(i){this._skyboxInvalidated=!1,this._lightPosition=i.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const i=this.paint.get("sky-type");return i==="atmosphere"?["skyboxCapture","skybox"]:i==="gradient"?["skyboxGradient"]:null}}};class Kc{constructor(e,n,r,a){this.context=e,this.format=r,this.texture=e.gl.createTexture(),this.update(n,a)}update(e,n,r){const{width:a,height:u}=e,{context:d}=this,{gl:f}=d,{HTMLImageElement:g,HTMLCanvasElement:v,HTMLVideoElement:w,ImageData:E,ImageBitmap:M}=me;if(f.bindTexture(f.TEXTURE_2D,this.texture),d.pixelStoreUnpackFlipY.set(!1),d.pixelStoreUnpack.set(1),d.pixelStoreUnpackPremultiplyAlpha.set(this.format===f.RGBA&&(!n||n.premultiply!==!1)),r||this.size&&this.size[0]===a&&this.size[1]===u){const{x:k,y:L}=r||{x:0,y:0};e instanceof g||e instanceof v||e instanceof w||e instanceof E||M&&e instanceof M?f.texSubImage2D(f.TEXTURE_2D,0,k,L,f.RGBA,f.UNSIGNED_BYTE,e):f.texSubImage2D(f.TEXTURE_2D,0,k,L,a,u,f.RGBA,f.UNSIGNED_BYTE,e.data)}else this.size=[a,u],e instanceof g||e instanceof v||e instanceof w||e instanceof E||M&&e instanceof M?f.texImage2D(f.TEXTURE_2D,0,this.format,this.format,f.UNSIGNED_BYTE,e):f.texImage2D(f.TEXTURE_2D,0,this.format,a,u,0,this.format,f.UNSIGNED_BYTE,e.data);this.useMipmap=Boolean(n&&n.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&f.generateMipmap(f.TEXTURE_2D)}bind(e,n){const{context:r}=this,{gl:a}=r;a.bindTexture(a.TEXTURE_2D,this.texture),e!==this.filter&&(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,e),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,this.useMipmap?e===a.NEAREST?a.NEAREST_MIPMAP_NEAREST:a.LINEAR_MIPMAP_NEAREST:e),this.filter=e),n!==this.wrap&&(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,n),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,n),this.wrap=n)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class nf{constructor(e,n){this.width=e,this.height=n,this.nextRow=0,this.image=new ko({width:e,height:n}),this.positions={},this.uploaded=!1}getDash(e,n){const r=this.getKey(e,n);return this.positions[r]}trim(){const e=this.width,n=this.height=tr(this.nextRow);this.image.resize({width:e,height:n})}getKey(e,n){return e.join(",")+n}getDashRanges(e,n,r){const a=[];let u=e.length%2==1?-e[e.length-1]*r:0,d=e[0]*r,f=!0;a.push({left:u,right:d,isDash:f,zeroLength:e[0]===0});let g=e[0];for(let v=1;v<e.length;v++){f=!f;const w=e[v];u=g*r,g+=w,d=g*r,a.push({left:u,right:d,isDash:f,zeroLength:w===0})}return a}addRoundDash(e,n,r){const a=n/2;for(let u=-r;u<=r;u++){const d=this.width*(this.nextRow+r+u);let f=0,g=e[f];for(let v=0;v<this.width;v++){v/g.right>1&&(g=e[++f]);const w=Math.abs(v-g.left),E=Math.abs(v-g.right),M=Math.min(w,E);let k;const L=u/r*(a+1);if(g.isDash){const F=a-Math.abs(L);k=Math.sqrt(M*M+F*F)}else k=a-Math.sqrt(M*M+L*L);this.image.data[d+v]=Math.max(0,Math.min(255,k+128))}}}addRegularDash(e,n){for(let g=e.length-1;g>=0;--g){const v=e[g],w=e[g+1];v.zeroLength?e.splice(g,1):w&&w.isDash===v.isDash&&(w.left=v.left,e.splice(g,1))}const r=e[0],a=e[e.length-1];r.isDash===a.isDash&&(r.left=a.left-this.width,a.right=r.right+this.width);const u=this.width*this.nextRow;let d=0,f=e[d];for(let g=0;g<this.width;g++){g/f.right>1&&(f=e[++d]);const v=Math.abs(g-f.left),w=Math.abs(g-f.right),E=Math.min(v,w);this.image.data[u+g]=Math.max(0,Math.min(255,(f.isDash?E:-E)+n+128))}}addDash(e,n){const r=this.getKey(e,n);if(this.positions[r])return this.positions[r];const a=n==="round",u=a?7:0,d=2*u+1;if(this.nextRow+d>this.height)return Gt("LineAtlas out of space"),null;e.length===0&&e.push(1);let f=0;for(let w=0;w<e.length;w++)e[w]<0&&(Gt("Negative value is found in line dasharray, replacing values with 0"),e[w]=0),f+=e[w];if(f!==0){const w=this.width/f,E=this.getDashRanges(e,this.width,w);a?this.addRoundDash(E,w,u):this.addRegularDash(E,n==="square"?.5*w:0)}const g=this.nextRow+u;this.nextRow+=d;const v={tl:[g,u],br:[f,0]};return this.positions[r]=v,v}}nt(nf);class sb{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}const ab=me.performance;function cg(i){const e=i?i.url.toString():void 0;return ab.getEntriesByName(e)}class lb{constructor(){this.tasks={},this.taskQueue=[],hi(["process"],this),this.invoker=new sb(this.process),this.nextId=0}add(e,n){const r=this.nextId++,a=function({type:u,isSymbolTile:d,zoom:f}){return f=f||0,u==="message"?0:u!=="maybePrepare"||d?u!=="parseTile"||d?u==="parseTile"&&d?300-f:u==="maybePrepare"&&d?400-f:500:200-f:100-f}(n);if(a===0){dt();try{e()}finally{}return{cancel:()=>{}}}return this.tasks[r]={fn:e,metadata:n,priority:a,id:r},this.taskQueue.push(r),this.invoker.trigger(),{cancel:()=>{delete this.tasks[r]}}}process(){dt();try{if(this.taskQueue=this.taskQueue.filter(r=>!!this.tasks[r]),!this.taskQueue.length)return;const e=this.pick();if(e===null)return;const n=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!n)return;n.fn()}finally{}}pick(){let e=null,n=1/0;for(let a=0;a<this.taskQueue.length;a++){const u=this.tasks[this.taskQueue[a]];u.priority<n&&(n=u.priority,e=a)}if(e===null)return null;const r=this.taskQueue[e];return this.taskQueue.splice(e,1),r}remove(){this.invoker.remove()}}const cb=$([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_merc_pos",components:2},{type:"Float32",name:"a_uv",components:2}]),ub=$([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:ug}=cb,hg=$([{name:"a_pos_3",components:3,type:"Int16"}]);var $c=$([{name:"a_pos",type:"Int16",components:2}]);const vl=Rt/Math.PI/2,Hn=-vl,Yn=vl,hb=[new ar([Hn,Hn,Hn],[Yn,Yn,Yn]),new ar([Hn,Hn,Hn],[0,0,Yn]),new ar([0,Hn,Hn],[Yn,0,Yn]),new ar([Hn,0,Hn],[0,Yn,Yn]),new ar([0,0,Hn],[Yn,Yn,Yn])];class db{constructor(e,n,r){this.a=ul([],e,r),this.b=ul([],n,r),this.center=r;const a=Rc([],this.a),u=Rc([],this.b);this.angle=Math.acos(Oc(a,u))}}function rf(i,e){if(i.angle===0)return null;let n;return n=i.a[e]===0?1/i.angle*.5*Math.PI:1/i.angle*Math.atan(i.b[e]/i.a[e]/Math.sin(i.angle)-1/Math.tan(i.angle)),n<0||n>1?null:function(r,a,u,d){const f=Math.sin(u);return r*(Math.sin((1-d)*u)/f)+a*(Math.sin(d*u)/f)}(i.a[e],i.b[e],i.angle,At(n,0,1))+i.center[e]}function Jc(i){if(i.z<=1)return hb[i.z+2*i.y+i.x];const[e,n]=of(i),r=[Bo(e[0],e[1]),Bo(e[0],n[1]),Bo(n[0],e[1]),Bo(n[0],n[1])],a=[Yn,Yn,Yn],u=[Hn,Hn,Hn];for(const d of r)a[0]=Math.min(a[0],d[0]),a[1]=Math.min(a[1],d[1]),a[2]=Math.min(a[2],d[2]),u[0]=Math.max(u[0],d[0]),u[1]=Math.max(u[1],d[1]),u[2]=Math.max(u[2],d[2]);return new ar(a,u)}function pb(i,e,n){const r=e/i.worldSize,a=(Ie,Oe)=>{Lc(Ie,Ie,r),Lc(Oe,Oe,r)},u=Number.MAX_VALUE,d=[-u,-u,-u],f=[u,u,u],g=_g(i);if(n.z<=1){const Ie=Jc(n).getCorners();for(let Oe=0;Oe<Ie.length;Oe++)ca(Ie[Oe],Ie[Oe],g),Sp(f,f,Ie[Oe]),Ip(d,d,Ie[Oe]);return a(f,d),new ar(f,d)}const[v,w]=of(n),E=new ls;E.setSouthWest([v[1],w[0]]),E.setNorthEast([w[1],v[0]]);const M=[Bo(E.getSouth(),E.getWest()),Bo(E.getSouth(),E.getEast()),Bo(E.getNorth(),E.getEast()),Bo(E.getNorth(),E.getWest())];for(let Ie=0;Ie<M.length;Ie++)ca(M[Ie],M[Ie],g),Sp(f,f,M[Ie]),Ip(d,d,M[Ie]);if(E.contains(i.center))return d[2]=0,a(f,d),new ar(f,d);const k=[g[12],g[13],g[14]],L=i.center.lng,F=At(i.center.lat,-85.051129,Xr),j=[Pc(L),sl(F)],H=E.getCenter().lng,ne=At(E.getCenter().lat,-85.051129,Xr),le=[Pc(H),sl(ne)];let ue=new Array(3),he=0;const de=j[0]-le[0],Te=j[1]-le[1];if(Math.abs(de)>Math.abs(Te))he=de>=0?1:3,ue=k;else{he=Te>=0?0:2;const Ie=[g[4],g[5],g[6]];let Oe;Oe=Te>=0?-Math.sin(Fe(E.getSouth()))*vl:-Math.sin(Fe(E.getNorth()))*vl,ue=zp(ue,k,Ie,Oe)}const Me=M[he],De=M[(he+1)%4],Be=new db(Me,De,ue),be=[rf(Be,0)||Me[0],rf(Be,1)||Me[1],rf(Be,2)||Me[2]];return f[2]=Math.min(Me[2],De[2]),Sp(f,f,be),Ip(d,d,be),a(f,d),new ar(f,d)}function of(i){const e=1<<i.z,n=i.x/e,r=(i.x+1)/e,a=(i.y+1)/e;return[[cn(i.y/e),yr(n)],[cn(a),yr(r)]]}function dg(i,e,n,r=vl){return n=Fe(n),[i*Math.sin(n)*r,-e*r,i*Math.cos(n)*r]}function Bo(i,e,n){return dg(Math.cos(Fe(i)),Math.sin(Fe(i)),e,n)}function pg(i,e,n){const r=Math.pow(2,n.z),a=(i/Rt+n.x)/r;return Bo(cn((e/Rt+n.y)/r),yr(a))}function sf(i){return 16383/Math.max(...ul([],i.max,i.min))}function fg(i){const e=Qr(new Float64Array(16)),n=sf(i);var r,a;return cs(e,e,[n,n,n]),la(e,e,((r=[])[0]=-(a=i.min)[0],r[1]=-a[1],r[2]=-a[2],r)),e}function mg(i,e,n,r,a){const u=function(g){const v=Rt/(2*Math.PI);return g/(2*Math.PI)/v}(n),d=[i,e,-n/(2*Math.PI)],f=Qr(new Float64Array(16));return la(f,f,d),cs(f,f,[u,u,u]),Ep(f,f,Fe(-a)),Cp(f,f,Fe(-r)),f}function _g(i){const{x:e,y:n}=i.point,{lng:r,lat:a}=i._center;return mg(e,n,i.worldSize,r,a)}const gg=Fe(85),fb=Math.cos(gg),mb=Math.sin(gg);function yg(i,e,n){var r=2*Math.PI*6378137/256/Math.pow(2,n);return[i*r-2*Math.PI*6378137/2,e*r-2*Math.PI*6378137/2]}class Jh{constructor(e,n,r){this.z=e,this.x=n,this.y=r,this.key=eu(0,e,e,n,r)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,n){const r=function(u,d,f){var g=yg(256*u,256*(d=Math.pow(2,f)-d-1),f),v=yg(256*(u+1),256*(d+1),f);return g[0]+","+g[1]+","+v[0]+","+v[1]}(this.x,this.y,this.z),a=function(u,d,f){let g,v="";for(let w=u;w>0;w--)g=1<<w-1,v+=(d&g?1:0)+(f&g?2:0);return v}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(n==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",a).replace("{bbox-epsg-3857}",r)}toString(){return`${this.z}/${this.x}/${this.y}`}}class xg{constructor(e,n){this.wrap=e,this.canonical=n,this.key=eu(e,n.z,n.z,n.x,n.y)}}class wn{constructor(e,n,r,a,u){this.overscaledZ=e,this.wrap=n,this.canonical=new Jh(r,+a,+u),this.key=n===0&&e===r?this.canonical.key:eu(n,e,r,a,u)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const n=this.canonical.z-e;return e>this.canonical.z?new wn(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new wn(e,this.wrap,e,this.canonical.x>>n,this.canonical.y>>n)}calculateScaledKey(e,n=!0){if(this.overscaledZ===e&&n)return this.key;if(e>this.canonical.z)return eu(this.wrap*+n,e,this.canonical.z,this.canonical.x,this.canonical.y);{const r=this.canonical.z-e;return eu(this.wrap*+n,e,e,this.canonical.x>>r,this.canonical.y>>r)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const n=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>n&&e.canonical.y===this.canonical.y>>n}children(e){if(this.overscaledZ>=e)return[new wn(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const n=this.canonical.z+1,r=2*this.canonical.x,a=2*this.canonical.y;return[new wn(n,this.wrap,n,r,a),new wn(n,this.wrap,n,r+1,a),new wn(n,this.wrap,n,r,a+1),new wn(n,this.wrap,n,r+1,a+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new wn(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new wn(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new xg(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function eu(i,e,n,r,a){const u=1<<Math.min(n,22);let d=u*(a%u)+r%u;return i&&n<22&&(d+=u*u*((i<0?-2*i-1:2*i)%(1<<2*(22-n)))),16*(32*d+n)+(e-n)}function ha(i,e){if(!e.isReprojectedInTileSpace)return{scale:1<<i.z,x:i.x,y:i.y,x2:i.x+1,y2:i.y+1,projection:e};const n=Math.pow(2,-i.z),r=i.x*n,a=(i.x+1)*n,u=i.y*n,d=(i.y+1)*n,f=yr(r),g=yr(a),v=cn(u),w=cn(d),E=e.project(f,v),M=e.project(g,v),k=e.project(g,w),L=e.project(f,w);let F=Math.min(E.x,M.x,k.x,L.x),j=Math.min(E.y,M.y,k.y,L.y),H=Math.max(E.x,M.x,k.x,L.x),ne=Math.max(E.y,M.y,k.y,L.y);const le=n/16;function ue(de,Te,Me,De,Be,be){const Ie=(Me+Be)/2,Oe=(De+be)/2,We=e.project(yr(Ie),cn(Oe)),Ve=Math.max(0,F-We.x,j-We.y,We.x-H,We.y-ne);F=Math.min(F,We.x),H=Math.max(H,We.x),j=Math.min(j,We.y),ne=Math.max(ne,We.y),Ve>le&&(ue(de,We,Me,De,Ie,Oe),ue(We,Te,Ie,Oe,Be,be))}ue(E,M,r,u,a,u),ue(M,k,a,u,a,d),ue(k,L,a,d,r,d),ue(L,E,r,d,r,u),F-=le,j-=le,H+=le,ne+=le;const he=1/Math.max(H-F,ne-j);return{scale:he,x:F*he,y:j*he,x2:H*he,y2:ne*he,projection:e}}nt(Jh),nt(wn,{omit:["projMatrix"]});class vg{constructor(e){this._stringToNumber={},this._numberToString=[];for(let n=0;n<e.length;n++){const r=e[n];this._stringToNumber[r]=n,this._numberToString[n]=r}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}const _b=["tile","layer","source","sourceLayer","state"];class bg{constructor(e,n,r,a,u){this.type="Feature",this._vectorTileFeature=e,this._z=n,this._x=r,this._y=a,this.properties=e.properties,this.id=u}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={type:"Feature",geometry:this.geometry,properties:this.properties};this.id!==void 0&&(e.id=this.id);for(const n of _b)this[n]!==void 0&&(e[n]=this[n]);return e}}const xr=32,$r=33,ps=new Uint16Array(8184);for(let i=0;i<2046;i++){let e=i+2,n=0,r=0,a=0,u=0,d=0,f=0;for(1&e?a=u=d=xr:n=r=f=xr;(e>>=1)>1;){const v=n+a>>1,w=r+u>>1;1&e?(a=n,u=r,n=d,r=f):(n=a,r=u,a=d,u=f),d=v,f=w}const g=4*i;ps[g+0]=n,ps[g+1]=r,ps[g+2]=a,ps[g+3]=u}const Jr=new Uint16Array(2178),fs=new Uint8Array(1089),ed=new Uint16Array(1089);function Ag(i){return i===0?-.03125:i===32?.03125:0}var wg=$([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const Tg={type:2,extent:Rt,loadGeometry:()=>[[new Z(0,0),new Z(8193,0),new Z(8193,8193),new Z(0,8193),new Z(0,0)]]};class af{constructor(e,n,r,a,u){this.tileID=e,this.uid=Mn(),this.uses=0,this.tileSize=n,this.tileZoom=r,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=u,this.expiredRequestCount=0,this.state="loading",a&&a.transform&&(this.projection=a.transform.projection)}registerFadeDuration(e){const n=e+this.timeAdded;n<Ee.now()||this.fadeEndTime&&n<this.fadeEndTime||(this.fadeEndTime=n)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=ha(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(e,n,r){if(this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(a,u){const d={};if(!u)return d;for(const f of a){const g=f.layerIds.map(v=>u.getLayer(v)).filter(Boolean);if(g.length!==0){f.layers=g,f.stateDependentLayerIds&&(f.stateDependentLayers=f.stateDependentLayerIds.map(v=>g.filter(w=>w.id===v)[0]));for(const v of g)d[v.id]=f}}return d}(e.buckets,n.style),this.hasSymbolBuckets=!1;for(const a in this.buckets){const u=this.buckets[a];if(u instanceof ds){if(this.hasSymbolBuckets=!0,!r)break;u.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const a in this.buckets){const u=this.buckets[a];if(u instanceof ds&&u.hasRTLText){this.hasRTLText=!0,Gn.isLoading()||Gn.isLoaded()||rl()!=="deferred"||ns();break}}this.queryPadding=0;for(const a in this.buckets){const u=this.buckets[a];this.queryPadding=Math.max(this.queryPadding,n.style.getLayer(a).queryRadius(u))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas)}else this.collisionBoxArray=new Ir}unloadVectorData(){if(this.hasData()){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugIndexBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(e){return this.buckets[e.id]}upload(e){for(const r in this.buckets){const a=this.buckets[r];a.uploadPending()&&a.upload(e)}const n=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Kc(e,this.imageAtlas.image,n.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Kc(e,this.glyphAtlasImage,n.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Kc(e,this.lineAtlas.image,n.ALPHA),this.lineAtlas.uploaded=!0)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,n,r,a,u,d,f,g){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:a,pixelPosMatrix:f,transform:d,params:u,tileTransform:this.tileTransform},e,n,r):{}}querySourceFeatures(e,n){const r=this.latestFeatureIndex;if(!r||!r.rawTileData)return;const a=r.loadVTLayers(),u=n?n.sourceLayer:"",d=a._geojsonTileLayer||a[u];if(!d)return;const f=Gr(n&&n.filter),{z:g,x:v,y:w}=this.tileID.canonical,E={z:g,x:v,y:w};for(let M=0;M<d.length;M++){const k=d.feature(M);if(f.needGeometry){const j=aa(k,!0);if(!f.filter(new vi(this.tileID.overscaledZ),j,this.tileID.canonical))continue}else if(!f.filter(new vi(this.tileID.overscaledZ),k))continue;const L=r.getId(k,u),F=new bg(k,g,v,w,L);F.tile=E,e.push(F)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const n=this.expirationTime;if(e.cacheControl){const r=tt(e.cacheControl);r["max-age"]&&(this.expirationTime=Date.now()+1e3*r["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const r=Date.now();let a=!1;if(this.expirationTime>r)a=!1;else if(n)if(this.expirationTime<n)a=!0;else{const u=this.expirationTime-n;u?this.expirationTime=r+Math.max(u,3e4):a=!0}else a=!0;a?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,n){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0||!n)return;const r=this.latestFeatureIndex.loadVTLayers(),a=n.style.listImages();for(const u in this.buckets){if(!n.style.hasLayer(u))continue;const d=this.buckets[u],f=d.layers[0].sourceLayer||"_geojsonTileLayer",g=r[f],v=e[f];if(!g||!v||Object.keys(v).length===0)continue;if(d.update(v,g,a,this.imageAtlas&&this.imageAtlas.patternPositions||{}),d instanceof Gh||d instanceof Vh){const E=n.style._getSourceCache(d.layers[0].source);n._terrain&&n._terrain.enabled&&E&&d.programConfigurations.needsUpload&&n._terrain._clearRenderCacheForTile(E.id,this.tileID)}const w=n&&n.style&&n.style.getLayer(u);w&&(this.queryPadding=Math.max(this.queryPadding,w.queryRadius(d)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Ee.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=Ee.now()+e}setTexture(e,n){const r=n.context,a=r.gl;this.texture=n.getTileTexture(e.width),this.texture?this.texture.update(e,{useMipmap:!0}):(this.texture=new Kc(r,e,a.RGBA,{useMipmap:!0}),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE),r.extTextureFilterAnisotropic&&a.texParameterf(a.TEXTURE_2D,r.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,r.extTextureFilterAnisotropicMax))}setDependencies(e,n){const r={};for(const a of n)r[a]=!0;this.dependencies[e]=r}hasDependency(e,n){for(const r of e){const a=this.dependencies[r];if(a){for(const u of n)if(a[u])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(e,n){if(!n||n.name==="mercator"||this._tileDebugBuffer)return;const r=zo(Tg,this.tileID.canonical,this.tileTransform)[0],a=new Q,u=new kt;for(let d=0;d<r.length;d++){const{x:f,y:g}=r[d];a.emplaceBack(f,g),u.emplaceBack(d)}u.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(u),this._tileDebugBuffer=e.createVertexBuffer(a,$c.members),this._tileDebugSegments=Oi.simpleSegment(0,0,a.length,u.length)}_makeTileBoundsBuffers(e,n){if(this._tileBoundsBuffer||!n||n.name==="mercator")return;const r=zo(Tg,this.tileID.canonical,this.tileTransform)[0];let a,u;if(this.isRaster){const d=function(f,g){const v=ha(f,g),w=Math.pow(2,f.z);for(let j=0;j<$r;j++)for(let H=0;H<$r;H++){const ne=yr((f.x+(H+Ag(H))/xr)/w),le=cn((f.y+(j+Ag(j))/xr)/w),ue=g.project(ne,le),he=j*$r+H;Jr[2*he+0]=Math.round((ue.x*v.scale-v.x)*Rt),Jr[2*he+1]=Math.round((ue.y*v.scale-v.y)*Rt)}fs.fill(0),ed.fill(0);for(let j=2045;j>=0;j--){const H=4*j,ne=ps[H+0],le=ps[H+1],ue=ps[H+2],he=ps[H+3],de=ne+ue>>1,Te=le+he>>1,Me=de+Te-le,De=Te+ne-de,Be=le*$r+ne,be=he*$r+ue,Ie=Te*$r+de,Oe=Math.hypot((Jr[2*Be+0]+Jr[2*be+0])/2-Jr[2*Ie+0],(Jr[2*Be+1]+Jr[2*be+1])/2-Jr[2*Ie+1])>=16;if(fs[Ie]=fs[Ie]||(Oe?1:0),j<1022){const We=(le+De>>1)*$r+(ne+Me>>1),Ve=(he+De>>1)*$r+(ue+Me>>1);fs[Ie]=fs[Ie]||fs[We]||fs[Ve]}}const E=new ee,M=new we;let k=0;function L(j,H){const ne=H*$r+j;return ed[ne]===0&&(E.emplaceBack(Jr[2*ne+0],Jr[2*ne+1],j*Rt/xr,H*Rt/xr),ed[ne]=++k),ed[ne]-1}function F(j,H,ne,le,ue,he){const de=j+ne>>1,Te=H+le>>1;if(Math.abs(j-ue)+Math.abs(H-he)>1&&fs[Te*$r+de])F(ue,he,j,H,de,Te),F(ne,le,ue,he,de,Te);else{const Me=L(j,H),De=L(ne,le),Be=L(ue,he);M.emplaceBack(Me,De,Be)}}return F(0,0,xr,xr,xr,0),F(xr,xr,0,0,0,xr),{vertices:E,indices:M}}(this.tileID.canonical,n);a=d.vertices,u=d.indices}else{a=new ee,u=new we;for(const{x:f,y:g}of r)a.emplaceBack(f,g,0,0);const d=Rh(a.int16,void 0,4);for(let f=0;f<d.length;f+=3)u.emplaceBack(d[f],d[f+1],d[f+2])}this._tileBoundsBuffer=e.createVertexBuffer(a,wg.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(u),this._tileBoundsSegments=Oi.simpleSegment(0,0,a.length,u.length)}_makeGlobeTileDebugBuffers(e,n){if(this._globeTileDebugBorderBuffer||this._globeTileDebugTextBuffer||!n||n.name!=="globe")return;const r=this.tileID.canonical,a=fg(Jc(r));this._makeGlobeTileDebugBorderBuffer(e,r,a),this._makeGlobeTileDebugTextBuffer(e,r,a)}_makeGlobeTileDebugBorderBuffer(e,n,r){const a=new Q,u=new kt,d=new K,f=(v,w,E,M,k)=>{const L=(E-v)/(k-1),F=(M-w)/(k-1),j=a.length;for(let H=0;H<k;H++){const ne=v+H*L,le=w+H*F;a.emplaceBack(ne,le);const ue=pg(ne,le,n),he=ca(ue,ue,r);d.emplaceBack(he[0],he[1],he[2]),u.emplaceBack(j+H)}},g=Rt;f(0,0,g,0,16),f(g,0,g,g,16),f(g,g,0,g,16),f(0,g,0,0,16),this._tileDebugIndexBuffer=e.createIndexBuffer(u),this._tileDebugBuffer=e.createVertexBuffer(a,$c.members),this._globeTileDebugBorderBuffer=e.createVertexBuffer(d,hg.members),this._tileDebugSegments=Oi.simpleSegment(0,0,a.length,u.length)}_makeGlobeTileDebugTextBuffer(e,n,r){const a=new Q,u=new we,d=new K,f=25;u.reserve(32),a.reserve(f),d.reserve(f);const g=(v,w)=>f*v+w;for(let v=0;v<f;v++){const w=2048*v;for(let E=0;E<f;E++){const M=2048*E;a.emplaceBack(M,w);const k=pg(M,w,n),L=ca(k,k,r);d.emplaceBack(L[0],L[1],L[2])}}for(let v=0;v<4;v++)for(let w=0;w<4;w++){const E=g(v,w),M=g(v,w+1),k=g(v+1,w),L=g(v+1,w+1);u.emplaceBack(E,M,k),u.emplaceBack(k,M,L)}this._tileDebugTextIndexBuffer=e.createIndexBuffer(u),this._tileDebugTextBuffer=e.createVertexBuffer(a,$c.members),this._globeTileDebugTextBuffer=e.createVertexBuffer(d,hg.members),this._tileDebugTextSegments=Oi.simpleSegment(0,0,f,32)}}class gb{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,n,r){const a=String(n);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][a]=this.stateChanges[e][a]||{},yi(this.stateChanges[e][a],r),this.deletedStates[e]===null){this.deletedStates[e]={};for(const u in this.state[e])u!==a&&(this.deletedStates[e][u]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][a]===null){this.deletedStates[e][a]={};for(const u in this.state[e][a])r[u]||(this.deletedStates[e][a][u]=null)}else for(const u in r)this.deletedStates[e]&&this.deletedStates[e][a]&&this.deletedStates[e][a][u]===null&&delete this.deletedStates[e][a][u]}removeFeatureState(e,n,r){if(this.deletedStates[e]===null)return;const a=String(n);if(this.deletedStates[e]=this.deletedStates[e]||{},r&&n!==void 0)this.deletedStates[e][a]!==null&&(this.deletedStates[e][a]=this.deletedStates[e][a]||{},this.deletedStates[e][a][r]=null);else if(n!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][a])for(r in this.deletedStates[e][a]={},this.stateChanges[e][a])this.deletedStates[e][a][r]=null;else this.deletedStates[e][a]=null;else this.deletedStates[e]=null}getState(e,n){const r=String(n),a=yi({},(this.state[e]||{})[r],(this.stateChanges[e]||{})[r]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const u=this.deletedStates[e][n];if(u===null)return{};for(const d in u)delete a[d]}return a}initializeTileState(e,n){e.setFeatureState(this.state,n)}coalesceChanges(e,n){const r={};for(const a in this.stateChanges){this.state[a]=this.state[a]||{};const u={};for(const d in this.stateChanges[a])this.state[a][d]||(this.state[a][d]={}),yi(this.state[a][d],this.stateChanges[a][d]),u[d]=this.state[a][d];r[a]=u}for(const a in this.deletedStates){this.state[a]=this.state[a]||{};const u={};if(this.deletedStates[a]===null)for(const d in this.state[a])u[d]={},this.state[a][d]={};else for(const d in this.deletedStates[a]){if(this.deletedStates[a][d]===null)this.state[a][d]={};else for(const f of Object.keys(this.deletedStates[a][d]))delete this.state[a][d][f];u[d]=this.state[a][d]}r[a]=r[a]||{},yi(r[a],u)}if(this.stateChanges={},this.deletedStates={},Object.keys(r).length!==0)for(const a in e)e[a].setFeatureState(r,n)}}class Eg{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,n){const r=this.toIdx(e,n);return{min:this.minimums[r],max:this.maximums[r]}}isLeaf(e,n){return this.leaves[this.toIdx(e,n)]}toIdx(e,n){return n*this.size+e}}function Cg(i,e,n,r){let a=0,u=Number.MAX_VALUE;for(let d=0;d<3;d++)if(Math.abs(r[d])<1e-15){if(n[d]<i[d]||n[d]>e[d])return null}else{const f=1/r[d];let g=(i[d]-n[d])*f,v=(e[d]-n[d])*f;if(g>v){const w=g;g=v,v=w}if(g>a&&(a=g),v<u&&(u=v),a>u)return null}return a}function Mg(i,e,n,r,a,u,d,f,g,v,w){const E=r-i,M=a-e,k=u-n,L=d-i,F=f-e,j=g-n,H=w[1]*j-w[2]*F,ne=w[2]*L-w[0]*j,le=w[0]*F-w[1]*L,ue=E*H+M*ne+k*le;if(Math.abs(ue)<1e-15)return null;const he=1/ue,de=v[0]-i,Te=v[1]-e,Me=v[2]-n,De=(de*H+Te*ne+Me*le)*he;if(De<0||De>1)return null;const Be=Te*k-Me*M,be=Me*E-de*k,Ie=de*M-Te*E,Oe=(w[0]*Be+w[1]*be+w[2]*Ie)*he;return Oe<0||De+Oe>1?null:(L*Be+F*be+j*Ie)*he}function Sg(i,e,n){return(i-e)/(n-e)}function Ig(i,e,n,r,a,u,d,f,g){const v=1<<n,w=u-r,E=d-a,M=(i+1)/v*w+r,k=(e+0)/v*E+a,L=(e+1)/v*E+a;f[0]=(i+0)/v*w+r,f[1]=k,g[0]=M,g[1]=L}class zg{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const n=function(u){const d=Math.ceil(Math.log2(u.dim/8)),f=[];let g=Math.ceil(Math.pow(2,d));const v=1/g,w=(k,L,F,j,H)=>{const ne=j?1:0,le=(k+1)*F-ne,ue=L*F,he=(L+1)*F-ne;H[0]=k*F,H[1]=ue,H[2]=le,H[3]=he};let E=new Eg(g);const M=[];for(let k=0;k<g*g;k++){w(k%g,Math.floor(k/g),v,!1,M);const L=ms(M[0],M[1],u),F=ms(M[2],M[1],u),j=ms(M[2],M[3],u),H=ms(M[0],M[3],u);E.minimums.push(Math.min(L,F,j,H)),E.maximums.push(Math.max(L,F,j,H)),E.leaves.push(1)}for(f.push(E),g/=2;g>=1;g/=2){const k=f[f.length-1];E=new Eg(g);for(let L=0;L<g*g;L++){w(L%g,Math.floor(L/g),2,!0,M);const F=k.getElevation(M[0],M[1]),j=k.getElevation(M[2],M[1]),H=k.getElevation(M[2],M[3]),ne=k.getElevation(M[0],M[3]),le=k.isLeaf(M[0],M[1]),ue=k.isLeaf(M[2],M[1]),he=k.isLeaf(M[2],M[3]),de=k.isLeaf(M[0],M[3]),Te=Math.min(F.min,j.min,H.min,ne.min),Me=Math.max(F.max,j.max,H.max,ne.max),De=le&&ue&&he&&de;E.maximums.push(Me),E.minimums.push(Te),E.leaves.push(Me-Te<=5&&De?1:0)}f.push(E)}return f}(this.dem),r=n.length-1,a=n[r];this._addNode(a.minimums[0],a.maximums[0],a.leaves[0]),this._construct(n,0,0,r,0)}raycastRoot(e,n,r,a,u,d,f=1){return Cg([e,n,-100],[r,a,this.maximums[0]*f],u,d)}raycast(e,n,r,a,u,d,f=1){if(!this.nodeCount)return null;const g=this.raycastRoot(e,n,r,a,u,d,f);if(g==null)return null;const v=[],w=[],E=[],M=[],k=[{idx:0,t:g,nodex:0,nodey:0,depth:0}];for(;k.length>0;){const{idx:L,t:F,nodex:j,nodey:H,depth:ne}=k.pop();if(this.leaves[L]){Ig(j,H,ne,e,n,r,a,E,M);const ue=1<<ne,he=(j+0)/ue,de=(j+1)/ue,Te=(H+0)/ue,Me=(H+1)/ue,De=ms(he,Te,this.dem)*f,Be=ms(de,Te,this.dem)*f,be=ms(de,Me,this.dem)*f,Ie=ms(he,Me,this.dem)*f,Oe=Mg(E[0],E[1],De,M[0],E[1],Be,M[0],M[1],be,u,d),We=Mg(M[0],M[1],be,E[0],M[1],Ie,E[0],E[1],De,u,d),Ve=Math.min(Oe!==null?Oe:Number.MAX_VALUE,We!==null?We:Number.MAX_VALUE);if(Ve!==Number.MAX_VALUE)return Ve;{const qe=zp([],u,d,F);if(kg(De,Be,Ie,be,Sg(qe[0],E[0],M[0]),Sg(qe[1],E[1],M[1]))>=qe[2])return F}continue}let le=0;for(let ue=0;ue<this._siblingOffset.length;ue++){Ig((j<<1)+this._siblingOffset[ue][0],(H<<1)+this._siblingOffset[ue][1],ne+1,e,n,r,a,E,M),E[2]=-100,M[2]=this.maximums[this.childOffsets[L]+ue]*f;const he=Cg(E,M,u,d);if(he!=null){const de=he;v[ue]=de;let Te=!1;for(let Me=0;Me<le&&!Te;Me++)de>=v[w[Me]]&&(w.splice(Me,0,ue),Te=!0);Te||(w[le]=ue),le++}}for(let ue=0;ue<le;ue++){const he=w[ue];k.push({idx:this.childOffsets[L]+he,t:v[he],nodex:(j<<1)+this._siblingOffset[he][0],nodey:(H<<1)+this._siblingOffset[he][1],depth:ne+1})}}return null}_addNode(e,n,r){return this.minimums.push(e),this.maximums.push(n),this.leaves.push(r),this.childOffsets.push(0),this.nodeCount++}_construct(e,n,r,a,u){if(e[a].isLeaf(n,r)===1)return;this.childOffsets[u]||(this.childOffsets[u]=this.nodeCount);const d=a-1,f=e[d];let g=0,v=0;for(let w=0;w<this._siblingOffset.length;w++){const E=2*n+this._siblingOffset[w][0],M=2*r+this._siblingOffset[w][1],k=f.getElevation(E,M),L=f.isLeaf(E,M),F=this._addNode(k.min,k.max,L);L&&(g|=1<<w),v||(v=F)}for(let w=0;w<this._siblingOffset.length;w++)g&1<<w||this._construct(e,2*n+this._siblingOffset[w][0],2*r+this._siblingOffset[w][1],d,v+w)}}function kg(i,e,n,r,a,u){return xt(xt(i,n,u),xt(e,r,u),a)}function ms(i,e,n){const r=n.dim,a=At(i*r-.5,0,r-1),u=At(e*r-.5,0,r-1),d=Math.floor(a),f=Math.floor(u),g=Math.min(d+1,r-1),v=Math.min(f+1,r-1);return kg(n.get(d,f),n.get(g,f),n.get(d,v),n.get(g,v),a-d,u-f)}const Dg={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class td{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,n,r,a=!1,u=!1){if(this.uid=e,n.height!==n.width)throw new RangeError("DEM tiles must be square");if(r&&r!=="mapbox"&&r!=="terrarium")return Gt(`"${r}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=n.height;const d=this.dim=n.height-2,f=new Uint32Array(n.data.buffer);if(this.pixels=new Uint8Array(n.data.buffer),this.encoding=r||"mapbox",this.borderReady=a,!a){for(let g=0;g<d;g++)f[this._idx(-1,g)]=f[this._idx(0,g)],f[this._idx(d,g)]=f[this._idx(d-1,g)],f[this._idx(g,-1)]=f[this._idx(g,0)],f[this._idx(g,d)]=f[this._idx(g,d-1)];f[this._idx(-1,-1)]=f[this._idx(0,0)],f[this._idx(d,-1)]=f[this._idx(d-1,0)],f[this._idx(-1,d)]=f[this._idx(0,d-1)],f[this._idx(d,d)]=f[this._idx(d-1,d-1)],u&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new zg(this)}get(e,n,r=!1){r&&(e=At(e,-1,this.dim),n=At(n,-1,this.dim));const a=4*this._idx(e,n);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(this.pixels[a],this.pixels[a+1],this.pixels[a+2])}static getUnpackVector(e){return Dg[e]}get unpackVector(){return Dg[this.encoding]}_idx(e,n){if(e<-1||e>=this.dim+1||n<-1||n>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(n+1)*this.stride+(e+1)}_unpackMapbox(e,n,r){return(256*e*256+256*n+r)/10-1e4}_unpackTerrarium(e,n,r){return 256*e+n+r/256-32768}static pack(e,n){const r=[0,0,0,0],a=td.getUnpackVector(n);let u=Math.floor((e+a[3])/a[2]);return r[2]=u%256,u=Math.floor(u/256),r[1]=u%256,u=Math.floor(u/256),r[0]=u,r}getPixels(){return new Wn({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,n,r){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let a=n*this.dim,u=n*this.dim+this.dim,d=r*this.dim,f=r*this.dim+this.dim;switch(n){case-1:a=u-1;break;case 1:u=a+1}switch(r){case-1:d=f-1;break;case 1:f=d+1}const g=-n*this.dim,v=-r*this.dim;for(let w=d;w<f;w++)for(let E=a;E<u;E++){const M=4*this._idx(E,w),k=4*this._idx(E+g,w+v);this.pixels[M+0]=e.pixels[k+0],this.pixels[M+1]=e.pixels[k+1],this.pixels[M+2]=e.pixels[k+2],this.pixels[M+3]=e.pixels[k+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}nt(td),nt(zg,{omit:["dem"]});class yb{constructor(e,n){this.max=e,this.onRemove=n,this.reset()}reset(){for(const e in this.data)for(const n of this.data[e])n.timeout&&clearTimeout(n.timeout),this.onRemove(n.value);return this.data={},this.order=[],this}add(e,n,r){const a=e.wrapped().key;this.data[a]===void 0&&(this.data[a]=[]);const u={value:n,timeout:void 0};if(r!==void 0&&(u.timeout=setTimeout(()=>{this.remove(e,u)},r)),this.data[a].push(u),this.order.push(a),this.order.length>this.max){const d=this._getAndRemoveByKey(this.order[0]);d&&this.onRemove(d)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const n=this.data[e].shift();return n.timeout&&clearTimeout(n.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),n.value}getByKey(e){const n=this.data[e];return n?n[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,n){if(!this.has(e))return this;const r=e.wrapped().key,a=n===void 0?0:this.data[r].indexOf(n),u=this.data[r][a];return this.data[r].splice(a,1),u.timeout&&clearTimeout(u.timeout),this.data[r].length===0&&delete this.data[r],this.onRemove(u.value),this.order.splice(this.order.indexOf(r),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const n=this._getAndRemoveByKey(this.order[0]);n&&this.onRemove(n)}return this}filter(e){const n=[];for(const r in this.data)for(const a of this.data[r])e(a.value)||n.push(a);for(const r of n)this.remove(r.value.tileID,r)}}class bl{constructor(e,n,r){this.func=e,this.mask=n,this.range=r}}bl.ReadOnly=!1,bl.ReadWrite=!0,bl.disabled=new bl(519,bl.ReadOnly,[0,1]);const lf=7680;class cf{constructor(e,n,r,a,u,d){this.test=e,this.ref=n,this.mask=r,this.fail=a,this.depthFail=u,this.pass=d}}cf.disabled=new cf({func:519,mask:0},0,0,lf,lf,lf);class eo{constructor(e,n,r){this.blendFunction=e,this.blendColor=n,this.mask=r}}eo.Replace=[1,0],eo.disabled=new eo(eo.Replace,ii.transparent,[!1,!1,!1,!1]),eo.unblended=new eo(eo.Replace,ii.transparent,[!0,!0,!0,!0]),eo.alphaBlended=new eo([1,771],ii.transparent,[!0,!0,!0,!0]);const uf=1029,hf=2305;class Pr{constructor(e,n,r){this.enable=e,this.mode=n,this.frontFace=r}}Pr.disabled=new Pr(!1,uf,hf),Pr.backCCW=new Pr(!0,uf,hf),Pr.backCW=new Pr(!0,uf,2304),Pr.frontCW=new Pr(!0,1028,2304),Pr.frontCCW=new Pr(!0,1028,hf);class da extends St{constructor(e,n,r){super(),this.id=e,this._onlySymbols=r,n.on("data",a=>{a.dataType==="source"&&a.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&a.dataType==="source"&&a.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),n.on("error",()=>{this._sourceErrored=!0}),this._source=n,this._tiles={},this._cache=new yb(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=n.minTileCacheSize,this._maxTileCacheSize=n.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new gb,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(e){this.map=e,this._minTileCacheSize=this._minTileCacheSize===void 0&&e?e._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&e?e._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const e in this._tiles){const n=this._tiles[e];if(n.state!=="loaded"&&n.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,n){return e.isSymbolTile=this._onlySymbols,this._source.loadTile(e,n)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e,()=>{})}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e,()=>{})}serialize(){return this._source.serialize()}prepare(e){if(this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._source.prepareTile)for(const n in this._tiles){const r=this._tiles[n];this._source.prepareTile(r)&&this.map.painter.terrain&&this.map.painter.terrain._clearRenderCacheForTile(this.id,r.tileID),r.upload(e),r.prepare(this.map.style.imageManager)}else for(const n in this._tiles){const r=this._tiles[n];r.upload(e),r.prepare(this.map.style.imageManager)}}getIds(){return xn(this._tiles).map(e=>e.tileID).sort(Pg).map(e=>e.key)}getRenderableIds(e){const n=[];for(const r in this._tiles)this._isIdRenderable(+r,e)&&n.push(this._tiles[r]);return e?n.sort((r,a)=>{const u=r.tileID,d=a.tileID,f=new Z(u.canonical.x,u.canonical.y)._rotate(this.transform.angle),g=new Z(d.canonical.x,d.canonical.y)._rotate(this.transform.angle);return u.overscaledZ-d.overscaledZ||g.y-f.y||g.x-f.x}).map(r=>r.tileID.key):n.map(r=>r.tileID).sort(Pg).map(r=>r.key)}hasRenderableParent(e){const n=this.findLoadedParent(e,0);return!!n&&this._isIdRenderable(n.tileID.key)}_isIdRenderable(e,n){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(n||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)this._tiles[e].state!=="errored"&&this._reloadTile(+e,"reloading")}}_reloadTile(e,n){const r=this._tiles[e];r&&(r.state!=="loading"&&(r.state=n),this._loadTile(r,this._tileLoaded.bind(this,r,e,n)))}_tileLoaded(e,n,r,a){if(a)if(e.state="errored",a.status!==404)this._source.fire(new gt(a,{tile:e}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const u=this.map.painter.terrain;this.update(this.transform,u.getScaledDemTileSize(),!0),u.resetTileLookupCache(this.id)}else this.update(this.transform);else e.timeAdded=Ee.now(),r==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(n,e),this._source.type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new _t("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const n=this.getRenderableIds();for(let a=0;a<n.length;a++){const u=n[a];if(e.neighboringTiles&&e.neighboringTiles[u]){const d=this.getTileByID(u);r(e,d),r(d,e)}}function r(a,u){if(!a.dem||a.dem.borderReady)return;a.needsHillshadePrepare=!0,a.needsDEMTextureUpload=!0;let d=u.tileID.canonical.x-a.tileID.canonical.x;const f=u.tileID.canonical.y-a.tileID.canonical.y,g=Math.pow(2,a.tileID.canonical.z),v=u.tileID.key;d===0&&f===0||Math.abs(f)>1||(Math.abs(d)>1&&(Math.abs(d+g)===1?d+=g:Math.abs(d-g)===1&&(d-=g)),u.dem&&a.dem&&(a.dem.backfillBorder(u.dem,d,f),a.neighboringTiles&&a.neighboringTiles[v]&&(a.neighboringTiles[v].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,n,r,a){for(const u in this._tiles){let d=this._tiles[u];if(a[u]||!d.hasData()||d.tileID.overscaledZ<=n||d.tileID.overscaledZ>r)continue;let f=d.tileID;for(;d&&d.tileID.overscaledZ>n+1;){const v=d.tileID.scaledTo(d.tileID.overscaledZ-1);d=this._tiles[v.key],d&&d.hasData()&&(f=v)}let g=f;for(;g.overscaledZ>n;)if(g=g.scaledTo(g.overscaledZ-1),e[g.key]){a[f.key]=f;break}}}findLoadedParent(e,n){if(e.key in this._loadedParentTiles){const r=this._loadedParentTiles[e.key];return r&&r.tileID.overscaledZ>=n?r:null}for(let r=e.overscaledZ-1;r>=n;r--){const a=e.scaledTo(r),u=this._getLoadedTile(a);if(u)return u}}_getLoadedTile(e){const n=this._tiles[e.key];return n&&n.hasData()?n:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,n){n=n||this._source.tileSize;const r=Math.ceil(e.width/n)+1,a=Math.ceil(e.height/n)+1,u=Math.floor(r*a*5),d=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,u):u,f=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,d):d;this._cache.setMaxSize(f)}handleWrapJump(e){const n=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,n){const r={};for(const a in this._tiles){const u=this._tiles[a];u.tileID=u.tileID.unwrapTo(u.tileID.wrap+n),r[u.tileID.key]=u}this._tiles=r;for(const a in this._timers)clearTimeout(this._timers[a]),delete this._timers[a];for(const a in this._tiles)this._setTileReloadTimer(+a,this._tiles[a])}}update(e,n,r){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!r)return;let a;this.updateCacheSize(e,n),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?a=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(f=>new wn(f.canonical.z,f.wrap,f.canonical.z,f.canonical.x,f.canonical.y)):(a=e.coveringTiles({tileSize:n||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!r,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(a=a.filter(f=>this._source.hasTile(f)))):a=[];const u=this._updateRetainedTiles(a);if(Bg(this._source.type)&&a.length!==0){const f={},g={},v=Object.keys(u);for(const E of v){const M=u[E],k=this._tiles[E];if(!k||k.fadeEndTime&&k.fadeEndTime<=Ee.now())continue;const L=this.findLoadedParent(M,Math.max(M.overscaledZ-da.maxOverzooming,this._source.minzoom));L&&(this._addTile(L.tileID),f[L.tileID.key]=L.tileID),g[E]=M}const w=a[a.length-1].overscaledZ;for(const E in this._tiles){const M=this._tiles[E];if(u[E]||!M.hasData())continue;let k=M.tileID;for(;k.overscaledZ>w;){k=k.scaledTo(k.overscaledZ-1);const L=this._tiles[k.key];if(L&&L.hasData()&&g[k.key]){u[E]=M.tileID;break}}}for(const E in f)u[E]||(this._coveredTiles[E]=!0,u[E]=f[E])}for(const f in u)this._tiles[f].clearFadeHold();const d=function(f,g){const v=[];for(const w in f)w in g||v.push(w);return v}(this._tiles,u);for(const f of d){const g=this._tiles[f];g.hasSymbolBuckets&&!g.holdingForFade()?g.setHoldDuration(this.map._fadeDuration):g.hasSymbolBuckets&&!g.symbolFadeFinished()||this._removeTile(+f)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const n={};if(e.length===0)return n;const r={},a=e.reduce((v,w)=>Math.min(v,w.overscaledZ),1/0),u=e[0].overscaledZ,d=Math.max(u-da.maxOverzooming,this._source.minzoom),f=Math.max(u+da.maxUnderzooming,this._source.minzoom),g={};for(const v of e){const w=this._addTile(v);n[v.key]=v,w.hasData()||a<this._source.maxzoom&&(g[v.key]=v)}this._retainLoadedChildren(g,a,f,n);for(const v of e){let w=this._tiles[v.key];if(w.hasData())continue;if(v.canonical.z>=this._source.maxzoom){const M=v.children(this._source.maxzoom)[0],k=this.getTile(M);if(k&&k.hasData()){n[M.key]=M;continue}}else{const M=v.children(this._source.maxzoom);if(n[M[0].key]&&n[M[1].key]&&n[M[2].key]&&n[M[3].key])continue}let E=w.wasRequested();for(let M=v.overscaledZ-1;M>=d;--M){const k=v.scaledTo(M);if(r[k.key]||(r[k.key]=!0,w=this.getTile(k),!w&&E&&(w=this._addTile(k)),w&&(n[k.key]=k,E=w.wasRequested(),w.hasData())))break}}return n}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const n=[];let r,a=this._tiles[e].tileID;for(;a.overscaledZ>0;){if(a.key in this._loadedParentTiles){r=this._loadedParentTiles[a.key];break}n.push(a.key);const u=a.scaledTo(a.overscaledZ-1);if(r=this._getLoadedTile(u),r)break;a=u}for(const u of n)this._loadedParentTiles[u]=r}}_addTile(e){let n=this._tiles[e.key];if(n)return this._source.prepareTile&&this._source.prepareTile(n),n;n=this._cache.getAndRemove(e),n&&(this._setTileReloadTimer(e.key,n),n.tileID=e,this._state.initializeTileState(n,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,n)));const r=Boolean(n);if(!r){const a=this.map?this.map.painter:null;n=new af(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,a,this._isRaster),this._source.prepareTile&&this._source.prepareTile(n)||this._loadTile(n,this._tileLoaded.bind(this,n,e.key,n.state))}return n?(n.uses++,this._tiles[e.key]=n,r||this._source.fire(new _t("dataloading",{tile:n,coord:n.tileID,dataType:"source"})),n):null}_setTileReloadTimer(e,n){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const r=n.getExpiryTimeout();r&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},r))}_removeTile(e){const n=this._tiles[e];n&&(n.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),n.uses>0||(n.hasData()&&n.state!=="reloading"?this._cache.add(n.tileID,n,n.getExpiryTimeout()):(n.aborted=!0,this._abortTile(n),this._unloadTile(n))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(e,n,r){const a=[],u=this.transform;if(!u)return a;for(const d in this._tiles){const f=this._tiles[d];if(r&&f.clearQueryDebugViz(),f.holdingForFade())continue;const g=e.containsTile(f,u,n);g&&a.push(g)}return a}getVisibleCoordinates(e){const n=this.getRenderableIds(e).map(r=>this._tiles[r].tileID);for(const r of n)r.projMatrix=this.transform.calculateProjMatrix(r.toUnwrapped());return n}hasTransition(){if(this._source.hasTransition())return!0;if(Bg(this._source.type))for(const e in this._tiles){const n=this._tiles[e];if(n.fadeEndTime!==void 0&&n.fadeEndTime>=Ee.now())return!0}return!1}setFeatureState(e,n,r){this._state.updateState(e=e||"_geojsonTileLayer",n,r)}removeFeatureState(e,n,r){this._state.removeFeatureState(e=e||"_geojsonTileLayer",n,r)}getFeatureState(e,n){return this._state.getState(e=e||"_geojsonTileLayer",n)}setDependencies(e,n,r){const a=this._tiles[e];a&&a.setDependencies(n,r)}reloadTilesForDependencies(e,n){for(const r in this._tiles)this._tiles[r].hasDependency(e,n)&&this._reloadTile(+r,"reloading");this._cache.filter(r=>!r.hasDependency(e,n))}_preloadTiles(e,n){const r=new Map,a=Array.isArray(e)?e:[e],u=this.map.painter.terrain,d=this.usedForTerrain&&u?u.getScaledDemTileSize():this._source.tileSize;for(const f of a){const g=f.coveringTiles({tileSize:d,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const v of g)r.set(v.key,v);this.usedForTerrain&&f.updateElevation(!1)}zi(Array.from(r.values()),(f,g)=>{const v=new af(f,this._source.tileSize*f.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(v,w=>{this._source.type==="raster-dem"&&v.dem&&this._backfillDEM(v),g(w,v)})},n)}}function Pg(i,e){const n=Math.abs(2*i.wrap)-+(i.wrap<0),r=Math.abs(2*e.wrap)-+(e.wrap<0);return i.overscaledZ-e.overscaledZ||r-n||e.canonical.y-i.canonical.y||e.canonical.x-i.canonical.x}function Bg(i){return i==="raster"||i==="image"||i==="video"}da.maxOverzooming=10,da.maxUnderzooming=3;class id{constructor(e,n,r){this._demTile=e,this._dem=this._demTile.dem,this._scale=n,this._offset=r}static create(e,n,r){const a=r||e.findDEMTileFor(n);if(!a||!a.dem)return;const u=a.dem,d=a.tileID,f=1<<n.canonical.z-d.canonical.z;return new id(a,a.tileSize/Rt/f,[(n.canonical.x/f-d.canonical.x)*u.dim,(n.canonical.y/f-d.canonical.y)*u.dim])}tileCoordToPixel(e,n){const r=n*this._scale+this._offset[1],a=Math.floor(e*this._scale+this._offset[0]),u=Math.floor(r);return new Z(a,u)}getElevationAt(e,n,r,a){const u=e*this._scale+this._offset[0],d=n*this._scale+this._offset[1],f=Math.floor(u),g=Math.floor(d),v=this._dem;return a=!!a,r?xt(xt(v.get(f,g,a),v.get(f,g+1,a),d-g),xt(v.get(f+1,g,a),v.get(f+1,g+1,a),d-g),u-f):v.get(f,g,a)}getElevationAtPixel(e,n,r){return this._dem.get(e,n,!!r)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*al(1,e)*this._dem.stride}}class Lg{constructor(e,n){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Wr(Rt,16,0),this.featureIndexArray=new Si,this.promoteId=n}insert(e,n,r,a,u,d=0){const f=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,a,u,d);const g=this.grid;for(let v=0;v<n.length;v++){const w=n[v],E=[1/0,1/0,-1/0,-1/0];for(let M=0;M<w.length;M++){const k=w[M];E[0]=Math.min(E[0],k.x),E[1]=Math.min(E[1],k.y),E[2]=Math.max(E[2],k.x),E[3]=Math.max(E[3],k.y)}E[0]<Rt&&E[1]<Rt&&E[2]>=0&&E[3]>=0&&g.insert(f,E[0],E[1],E[2],E[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new ua.VectorTile(new Yc(this.rawTileData)).layers,this.sourceLayerCoder=new vg(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,n,r,a){this.loadVTLayers();const u=e.params||{},d=Gr(u.filter),f=e.tileResult,g=e.transform,v=f.bufferedTilespaceBounds,w=this.grid.query(v.min.x,v.min.y,v.max.x,v.max.y,(L,F,j,H)=>i_(f.bufferedTilespaceGeometry,L,F,j,H));w.sort(xb);let E=null;g.elevation&&w.length>0&&(E=id.create(g.elevation,this.tileID));const M={};let k;for(let L=0;L<w.length;L++){const F=w[L];if(F===k)continue;k=F;const j=this.featureIndexArray.get(F);let H=null;this.loadMatchingFeature(M,j,d,u.layers,u.availableImages,n,r,a,(ne,le,ue,he=0)=>(H||(H=zo(ne,this.tileID.canonical,e.tileTransform)),le.queryIntersectsFeature(f,ne,ue,H,this.z,e.transform,e.pixelPosMatrix,E,he)))}return M}loadMatchingFeature(e,n,r,a,u,d,f,g,v){const{featureIndex:w,bucketIndex:E,sourceLayerIndex:M,layoutVertexArrayOffset:k}=n,L=this.bucketLayerIDs[E];if(a&&!function(ne,le){for(let ue=0;ue<ne.length;ue++)if(le.indexOf(ne[ue])>=0)return!0;return!1}(a,L))return;const F=this.sourceLayerCoder.decode(M),j=this.vtLayers[F].feature(w);if(r.needGeometry){const ne=aa(j,!0);if(!r.filter(new vi(this.tileID.overscaledZ),ne,this.tileID.canonical))return}else if(!r.filter(new vi(this.tileID.overscaledZ),j))return;const H=this.getId(j,F);for(let ne=0;ne<L.length;ne++){const le=L[ne];if(a&&a.indexOf(le)<0)continue;const ue=d[le];if(!ue)continue;let he={};H!==void 0&&g&&(he=g.getState(ue.sourceLayer||"_geojsonTileLayer",H));const de=yi({},f[le]);de.paint=Rg(de.paint,ue.paint,j,he,u),de.layout=Rg(de.layout,ue.layout,j,he,u);const Te=!v||v(j,ue,he,k);if(!Te)continue;const Me=new bg(j,this.z,this.x,this.y,H);Me.layer=de;let De=e[le];De===void 0&&(De=e[le]=[]),De.push({featureIndex:w,feature:Me,intersectionZ:Te})}}lookupSymbolFeatures(e,n,r,a,u,d,f,g){const v={};this.loadVTLayers();const w=Gr(u);for(const E of e)this.loadMatchingFeature(v,{bucketIndex:r,sourceLayerIndex:a,featureIndex:E,layoutVertexArrayOffset:0},w,d,f,g,n);return v}loadFeature(e){const{featureIndex:n,sourceLayerIndex:r}=e;this.loadVTLayers();const a=this.sourceLayerCoder.decode(r),u=this.vtFeatures[a];if(u[n])return u[n];const d=this.vtLayers[a].feature(n);return u[n]=d,d}hasLayer(e){for(const n of this.bucketLayerIDs)for(const r of n)if(e===r)return!0;return!1}getId(e,n){let r=e.id;return this.promoteId&&(r=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[n]],typeof r=="boolean"&&(r=Number(r))),r}}function Rg(i,e,n,r,a){return Ui(i,(u,d)=>{const f=e instanceof _?e.get(d):null;return f&&f.evaluate?f.evaluate(n,r,a):f})}function xb(i,e){return e-i}nt(Lg,{omit:["rawTileData","sourceLayerCoder"]});class Og{constructor(e){const n={},r=[];for(const f in e){const g=e[f],v=n[f]={};for(const w in g.glyphs){const E=g.glyphs[+w];if(!E||E.bitmap.width===0||E.bitmap.height===0)continue;const M=E.metrics.localGlyph?2:1,k={x:0,y:0,w:E.bitmap.width+2*M,h:E.bitmap.height+2*M};r.push(k),v[w]=k}}const{w:a,h:u}=jp(r),d=new ko({width:a||1,height:u||1});for(const f in e){const g=e[f];for(const v in g.glyphs){const w=g.glyphs[+v];if(!w||w.bitmap.width===0||w.bitmap.height===0)continue;const E=n[f][v],M=w.metrics.localGlyph?2:1;ko.copy(w.bitmap,d,{x:0,y:0},{x:E.x+M,y:E.y+M},w.bitmap)}}this.image=d,this.positions=n}}nt(Og);class vb{constructor(e){this.tileID=new wn(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.enableTerrain=!!e.enableTerrain,this.isSymbolTile=e.isSymbolTile,this.tileTransform=ha(e.tileID.canonical,e.projection),this.projection=e.projection}parse(e,n,r,a,u){this.status="parsing",this.data=e,this.collisionBoxArray=new Ir;const d=new vg(Object.keys(e.layers).sort()),f=new Lg(this.tileID,this.promoteId);f.bucketLayerIDs=[];const g={},v=new nf(256,256),w={featureIndex:f,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:v,availableImages:r},E=n.familiesBySource[this.source];for(const he in E){const de=e.layers[he];if(!de)continue;let Te=!1,Me=!1;for(const be of E[he])be[0].type==="symbol"?Te=!0:Me=!0;if(this.isSymbolTile===!0&&!Te||this.isSymbolTile===!1&&!Me)continue;de.version===1&&Gt(`Vector tile source "${this.source}" layer "${he}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const De=d.encode(he),Be=[];for(let be=0;be<de.length;be++){const Ie=de.feature(be),Oe=f.getId(Ie,he);Be.push({feature:Ie,id:Oe,index:be,sourceLayerIndex:De})}for(const be of E[he]){const Ie=be[0];this.isSymbolTile!==void 0&&Ie.type==="symbol"!==this.isSymbolTile||Ie.minzoom&&this.zoom<Math.floor(Ie.minzoom)||Ie.maxzoom&&this.zoom>=Ie.maxzoom||Ie.visibility!=="none"&&(df(be,this.zoom,r),(g[Ie.id]=Ie.createBucket({index:f.bucketLayerIDs.length,layers:be,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:De,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.name,availableImages:r})).populate(Be,w,this.tileID.canonical,this.tileTransform),f.bucketLayerIDs.push(be.map(Oe=>Oe.id)))}}let M,k,L,F;v.trim();const j={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},H=Ui(w.glyphDependencies,he=>Object.keys(he).map(Number));Object.keys(H).length?a.send("getGlyphs",{uid:this.uid,stacks:H},(he,de)=>{M||(M=he,k=de,ue.call(this))},void 0,!1,j):k={};const ne=Object.keys(w.iconDependencies);ne.length?a.send("getImages",{icons:ne,source:this.source,tileID:this.tileID,type:"icons"},(he,de)=>{M||(M=he,L=de,ue.call(this))},void 0,!1,j):L={};const le=Object.keys(w.patternDependencies);function ue(){if(M)return u(M);if(k&&L&&F){const he=new Og(k),de=new j_(L,F);for(const Te in g){const Me=g[Te];Me instanceof ds?(df(Me.layers,this.zoom,r),Yv(Me,k,he.positions,L,de.iconPositions,this.showCollisionBoxes,r,this.tileID.canonical,this.tileZoom,this.projection)):Me.hasPattern&&(Me instanceof Gh||Me instanceof Vh||Me instanceof qc)&&(df(Me.layers,this.zoom,r),Me.addFeatures(w,this.tileID.canonical,de.patternPositions,r,this.tileTransform))}this.status="done",u(null,{buckets:xn(g).filter(Te=>!Te.isEmpty()),featureIndex:f,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:he.image,lineAtlas:v,imageAtlas:de,glyphMap:this.returnDependencies?k:null,iconMap:this.returnDependencies?L:null,glyphPositions:this.returnDependencies?he.positions:null})}}le.length?a.send("getImages",{icons:le,source:this.source,tileID:this.tileID,type:"patterns"},(he,de)=>{M||(M=he,F=de,ue.call(this))},void 0,!1,j):F={},ue.call(this)}}function df(i,e,n){const r=new vi(e);for(const a of i)a.recalculate(r,n)}class Fg{constructor(e){this.entries={},this.scheduler=e}request(e,n,r,a){const u=this.entries[e]=this.entries[e]||{callbacks:[]};if(u.result){const[d,f]=u.result;return this.scheduler?this.scheduler.add(()=>{a(d,f)},n):a(d,f),()=>{}}return u.callbacks.push(a),u.cancel||(u.cancel=r((d,f)=>{u.result=[d,f];for(const g of u.callbacks)this.scheduler?this.scheduler.add(()=>{g(d,f)},n):g(d,f);setTimeout(()=>delete this.entries[e],3e3)})),()=>{u.result||(u.callbacks=u.callbacks.filter(d=>d!==a),u.callbacks.length||(u.cancel(),delete this.entries[e]))}}}function Ng(i,e,n){const r=JSON.stringify(i.request);return i.data&&(this.deduped.entries[r]={result:[null,i.data]}),this.deduped.request(r,{type:"parseTile",isSymbolTile:i.isSymbolTile,zoom:i.tileZoom},a=>{const u=J(i.request,(d,f,g,v)=>{d?a(d):f&&a(null,{vectorTile:n?void 0:new ua.VectorTile(new Yc(f)),rawData:f,cacheControl:g,expires:v})});return()=>{u.cancel(),a()}},e)}const bb=Qr(new Float32Array(16));class _s{constructor(e){this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,n){return{x:0,y:0,z:0}}unproject(e,n){return new fi(0,0)}projectTilePoint(e,n,r){return{x:e,y:n,z:0}}locationPoint(e,n){return e._coordinatePoint(e.locationCoordinate(n),!1)}pixelsPerMeter(e,n){return al(1,e)*n}farthestPixelDistance(e){return function(n,r){const a=n.fovAboveCenter,u=n.elevation?n.elevation.getMinElevationBelowMSL()*r:0,d=(n._camera.position[2]*n.worldSize-u)/Math.cos(n._pitch),f=Math.sin(a)*d/Math.sin(Math.max(Math.PI/2-n._pitch-a,.01)),g=Math.sin(n._pitch)*f+d;return Math.min(1.01*g,d*(1/n._horizonShift))}(e,e.pixelsPerMeter)}pointCoordinate(e,n,r,a){const u=e.horizonLineFromTop(!1),d=new Z(n,Math.max(u,r));return e.rayIntersectionCoordinate(e.pointRayIntersection(d,a))}createInversionMatrix(e,n){return bb}createTileMatrix(e,n,r){let a,u,d;const f=r.canonical,g=Qr(new Float64Array(16));if(this.isReprojectedInTileSpace){const v=ha(f,this);a=1,u=v.x+r.wrap*v.scale,d=v.y,cs(g,g,[a/v.scale,a/v.scale,e.pixelsPerMeter/n])}else a=n/e.zoomScale(f.z),u=(f.x+Math.pow(2,f.z)*r.wrap)*a,d=f.y*a;return la(g,g,[u,d,0]),cs(g,g,[a/Rt,a/Rt,1]),g}upVector(e,n,r){return[0,0,1]}upVectorScale(e,n,r){return{metersToTile:1,metersToLabelSpace:1}}}class Ab extends _s{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,n){return{x:Pc(e),y:sl(n),z:0}}unproject(e,n){const r=yr(e),a=cn(n);return new fi(r,a)}}class wb extends _s{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];const[n,r]=this.parallels=e.parallels||[29.5,45.5],a=Math.sin(Fe(n));this.n=(a+Math.sin(Fe(r)))/2,this.c=1+a*(2*this.n-a),this.r0=Math.sqrt(this.c)/this.n}project(e,n){const{n:r,c:a,r0:u}=this,d=Fe(e-this.center[0]),f=Fe(n),g=Math.sqrt(a-2*r*Math.sin(f))/r;return{x:g*Math.sin(d*r),y:g*Math.cos(d*r)-u,z:0}}unproject(e,n){const{n:r,c:a,r0:u}=this,d=u+n;let f=Math.atan2(e,Math.abs(d))*Math.sign(d);d*r<0&&(f-=Math.PI*Math.sign(e)*Math.sign(d));const g=Fe(this.center[0])*r;f=Li(f,-Math.PI-g,Math.PI-g);const v=ke(f/r)+this.center[0],w=Math.asin(At((a-(e*e+d*d)*r*r)/(2*r),-1,1)),E=At(ke(w),-85.051129,Xr);return new fi(v,E)}}const tu=1.340264,iu=-.081106,nu=893e-6,ru=.003796,nd=Math.sqrt(3)/2;class Tb extends _s{project(e,n){n=n/180*Math.PI,e=e/180*Math.PI;const r=Math.asin(nd*Math.sin(n)),a=r*r,u=a*a*a;return{x:.5*(e*Math.cos(r)/(nd*(tu+3*iu*a+u*(7*nu+9*ru*a)))/Math.PI+.5),y:1-.5*(r*(tu+iu*a+u*(nu+ru*a))/Math.PI+1),z:0}}unproject(e,n){e=(2*e-.5)*Math.PI;let r=n=(2*(1-n)-1)*Math.PI,a=r*r,u=a*a*a;for(let w,E,M,k=0;k<12&&(E=r*(tu+iu*a+u*(nu+ru*a))-n,M=tu+3*iu*a+u*(7*nu+9*ru*a),w=E/M,r=At(r-w,-Math.PI/3,Math.PI/3),a=r*r,u=a*a*a,!(Math.abs(w)<1e-12));++k);const d=nd*e*(tu+3*iu*a+u*(7*nu+9*ru*a))/Math.cos(r),f=Math.asin(Math.sin(r)/nd),g=At(180*d/Math.PI,-180,180),v=At(180*f/Math.PI,-85.051129,Xr);return new fi(g,v)}}class Eb extends _s{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,n){return{x:.5+e/360,y:.5-n/360,z:0}}unproject(e,n){const r=360*(e-.5),a=At(360*(.5-n),-85.051129,Xr);return new fi(r,a)}}const Al=Math.PI/2;function rd(i){return Math.tan((Al+i)/2)}class Cb extends _s{constructor(e){super(e),this.center=e.center||[0,30];const[n,r]=this.parallels=e.parallels||[30,30],a=Fe(n),u=Fe(r),d=Math.cos(a);this.n=a===u?Math.sin(a):Math.log(d/Math.cos(u))/Math.log(rd(u)/rd(a)),this.f=d*Math.pow(rd(a),this.n)/this.n}project(e,n){n=Fe(n),e=Fe(e-this.center[0]);const r=1e-6,{n:a,f:u}=this;u>0?n<-Al+r&&(n=-Al+r):n>Al-r&&(n=Al-r);const d=u/Math.pow(rd(n),a),f=d*Math.sin(a*e),g=u-d*Math.cos(a*e);return{x:.5*(f/Math.PI+.5),y:1-.5*(g/Math.PI+.5),z:0}}unproject(e,n){e=(2*e-.5)*Math.PI,n=(2*(1-n)-.5)*Math.PI;const{n:r,f:a}=this,u=a-n,d=Math.sign(u),f=Math.sign(r)*Math.sqrt(e*e+u*u);let g=Math.atan2(e,Math.abs(u))*d;u*r<0&&(g-=Math.PI*Math.sign(e)*d);const v=At(ke(g/r)+this.center[0],-180,180),w=At(ke(2*Math.atan(Math.pow(a/f,1/r))-Al),-85.051129,Xr);return new fi(v,w)}}const Ug=Fe(Xr);class Mb extends _s{project(e,n){const r=(n=Fe(n))*n,a=r*r;return{x:.5*((e=Fe(e))*(.8707-.131979*r+a*(a*(.003971*r-.001529*a)-.013791))/Math.PI+.5),y:1-.5*(n*(1.007226+r*(.015085+a*(.028874*r-.044475-.005916*a)))/Math.PI+1),z:0}}unproject(e,n){e=(2*e-.5)*Math.PI;let r=n=(2*(1-n)-1)*Math.PI,a=25,u=0,d=r*r;do{d=r*r;const v=d*d;u=(r*(1.007226+d*(.015085+v*(.028874*d-.044475-.005916*v)))-n)/(1.007226+d*(.045255+v*(.259866*d-.311325-.005916*11*v))),r=At(r-u,-Ug,Ug)}while(Math.abs(u)>1e-6&&--a>0);d=r*r;const f=At(ke(e/(.8707+d*(d*(d*d*d*(.003971-.001529*d)-.013791)-.131979))),-180,180),g=ke(r);return new fi(f,g)}}const Vg=Fe(Xr);class Sb extends _s{project(e,n){n=Fe(n),e=Fe(e);const r=Math.cos(n),a=2/Math.PI,u=Math.acos(r*Math.cos(e/2)),d=Math.sin(u)/u,f=.5*(e*a+2*r*Math.sin(e/2)/d)||0,g=.5*(n+Math.sin(n)/d)||0;return{x:.5*(f/Math.PI+.5),y:1-.5*(g/Math.PI+1),z:0}}unproject(e,n){let r=e=(2*e-.5)*Math.PI,a=n=(2*(1-n)-1)*Math.PI,u=25;const d=1e-6;let f=0,g=0;do{const v=Math.cos(a),w=Math.sin(a),E=2*w*v,M=w*w,k=v*v,L=Math.cos(r/2),F=Math.sin(r/2),j=2*L*F,H=F*F,ne=1-k*L*L,le=ne?1/ne:0,ue=ne?Math.acos(v*L)*Math.sqrt(1/ne):0,he=.5*(2*ue*v*F+2*r/Math.PI)-e,de=.5*(ue*w+a)-n,Te=.5*le*(k*H+ue*v*L*M)+1/Math.PI,Me=le*(j*E/4-ue*w*F),De=.125*le*(E*F-ue*w*k*j),Be=.5*le*(M*L+ue*H*v)+.5,be=Me*De-Be*Te;f=(de*Me-he*Be)/be,g=(he*De-de*Te)/be,r=At(r-f,-Math.PI,Math.PI),a=At(a-g,-Vg,Vg)}while((Math.abs(f)>d||Math.abs(g)>d)&&--u>0);return new fi(ke(r),ke(a))}}class jg extends _s{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Fe(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,n){const{scale:r,cosPhi:a}=this;return{x:Fe(e)*a*r+.5,y:-Math.sin(Fe(n))/a*r+.5,z:0}}unproject(e,n){const{scale:r,cosPhi:a}=this,u=-(n-.5)/r,d=At(ke((e-.5)/r)/a,-180,180),f=Math.asin(At(u*a,-1,1)),g=At(ke(f),-85.051129,Xr);return new fi(d,g)}}o.ARRAY_TYPE=qn,o.AUTH_ERR_MSG=Ct,o.Aabb=ar,o.Actor=class{constructor(i,e,n){this.target=i,this.parent=e,this.mapId=n,this.callbacks={},this.cancelCallbacks={},hi(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=dt()?i:me,this.scheduler=new lb}send(i,e,n,r,a=!1,u){const d=Math.round(1e18*Math.random()).toString(36).substring(0,10);n&&(n.metadata=u,this.callbacks[d]=n);const f=ie(this.globalScope)?void 0:[];return this.target.postMessage({id:d,type:i,hasCallback:!!n,targetMapId:r,mustQueue:a,sourceMapId:this.mapId,data:$s(e,f)},f),{cancel:()=>{n&&delete this.callbacks[d],this.target.postMessage({id:d,type:"<cancel>",targetMapId:r,sourceMapId:this.mapId})}}}receive(i){const e=i.data,n=e.id;if(n&&(!e.targetMapId||this.mapId===e.targetMapId))if(e.type==="<cancel>"){const r=this.cancelCallbacks[n];delete this.cancelCallbacks[n],r&&r.cancel()}else if(e.mustQueue||dt()){const r=this.callbacks[n];this.cancelCallbacks[n]=this.scheduler.add(()=>this.processTask(n,e),r&&r.metadata||{type:"message"})}else this.processTask(n,e)}processTask(i,e){if(e.type==="<response>"){const n=this.callbacks[i];delete this.callbacks[i],n&&(e.error?n(ts(e.error)):n(null,ts(e.data)))}else{const n=ie(this.globalScope)?void 0:[],r=e.hasCallback?(u,d)=>{delete this.cancelCallbacks[i],this.target.postMessage({id:i,type:"<response>",sourceMapId:this.mapId,error:u?$s(u):null,data:$s(d,n)},n)}:u=>{},a=ts(e.data);if(this.parent[e.type])this.parent[e.type](e.sourceMapId,a,r);else if(this.parent.getWorkerSource){const u=e.type.split(".");this.parent.getWorkerSource(e.sourceMapId,u[0],a.source)[u[1]](a,r)}else r(new Error(`Could not find function ${e.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},o.CanonicalTileID=Jh,o.Color=ii,o.ColorMode=eo,o.CullFaceMode=Pr,o.DEMData=td,o.DataConstantProperty=x,o.DedupedRequest=Fg,o.DepthMode=bl,o.EXTENT=Rt,o.Elevation=class{isDataAvailableAtPoint(i){const e=this._source();if(!e||i.y<0||i.y>1)return!1;const n=e.getSource().maxzoom,r=1<<n,a=Math.floor(i.x),u=Math.floor((i.x-a)*r),d=Math.floor(i.y*r),f=this.findDEMTileFor(new wn(n,a,n,u,d));return!(!f||!f.dem)}getAtPointOrZero(i,e=0){return this.getAtPoint(i,e)||0}getAtPoint(i,e,n=!0){e==null&&(e=null);const r=this._source();if(!r||i.y<0||i.y>1)return e;const a=r.getSource().maxzoom,u=1<<a,d=Math.floor(i.x),f=i.x-d,g=new wn(a,d,a,Math.floor(f*u),Math.floor(i.y*u)),v=this.findDEMTileFor(g);if(!v||!v.dem)return e;const w=v.dem,E=1<<v.tileID.canonical.z,M=(f*E-v.tileID.canonical.x)*w.dim,k=(i.y*E-v.tileID.canonical.y)*w.dim,L=Math.floor(M),F=Math.floor(k);return(n?this.exaggeration():1)*xt(xt(w.get(L,F),w.get(L,F+1),k-F),xt(w.get(L+1,F),w.get(L+1,F+1),k-F),M-L)}getAtTileOffset(i,e,n){const r=1<<i.canonical.z;return this.getAtPointOrZero(new Dh(i.wrap+(i.canonical.x+e/Rt)/r,(i.canonical.y+n/Rt)/r))}getAtTileOffsetFunc(i,e,n,r){return a=>{const u=this.getAtTileOffset(i,a.x,a.y),d=r.upVector(i.canonical,a.x,a.y);return Lc(d,d,u*r.upVectorScale(i.canonical,e,n).metersToTile),d}}getForTilePoints(i,e,n,r){const a=id.create(this,i,r);return!!a&&(e.forEach(u=>{u[2]=this.exaggeration()*a.getElevationAt(u[0],u[1],n)}),!0)}getMinMaxForTile(i){const e=this.findDEMTileFor(i);if(!e||!e.dem)return null;const n=e.dem.tree,r=e.tileID,a=1<<i.canonical.z-r.canonical.z;let u=i.canonical.x/a-r.canonical.x,d=i.canonical.y/a-r.canonical.y,f=0;for(let g=0;g<i.canonical.z-r.canonical.z&&!n.leaves[f];g++){u*=2,d*=2;const v=2*Math.floor(d)+Math.floor(u);f=n.childOffsets[f]+v,u%=1,d%=1}return{min:this.exaggeration()*n.minimums[f],max:this.exaggeration()*n.maximums[f]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(i,e,n){throw new Error("Pure virtual method called.")}pointCoordinate(i){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(i){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},o.ErrorEvent=gt,o.EvaluationParameters=vi,o.Event=_t,o.Evented=St,o.FillExtrusionBucket=qc,o.Frustum=kp,o.GLOBE_RADIUS=vl,o.GlobeSharedBuffers=class{constructor(i){this._createGrid(i),this._createPoles(i),this._createAtmosphere(i)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const i of this._poleSegments)i.destroy();this._gridSegments.destroy(),this.atmosphereVertexBuffer.destroy(),this.atmosphereIndexBuffer.destroy(),this.atmosphereSegments.destroy(),this._wireframeIndexBuffer&&(this._wireframeIndexBuffer.destroy(),this._wireframeSegments.destroy())}_createGrid(i){const e=new Q,n=new we,r=65;for(let a=0;a<r;a++)for(let u=0;u<r;u++)e.emplaceBack(u,a);for(let a=0;a<64;a++)for(let u=0;u<64;u++){const d=a*r+u;n.emplaceBack(d+1,d,d+r),n.emplaceBack(d+r,d+r+1,d+1)}this._gridBuffer=i.createVertexBuffer(e,$c.members),this._gridIndexBuffer=i.createIndexBuffer(n,!0),this._gridSegments=Oi.simpleSegment(0,0,4225,8192)}_createPoles(i){const e=new we;for(let a=0;a<=64;a++)e.emplaceBack(0,a+1,a+2);this._poleIndexBuffer=i.createIndexBuffer(e,!0);const n=new st,r=new st;this._poleSegments=[];for(let a=0,u=0;a<5;a++){const d=1<<a,f=512*d/Math.PI/2,g=360/d;n.emplaceBack(0,-f,0,0,0,.5,0),r.emplaceBack(0,-f,0,0,0,.5,1);for(let v=0;v<=64;v++){const w=v/64,E=xt(0,g,w),[M,k,L]=dg(fb,mb,E,f);n.emplaceBack(M,k,L,0,0,w,0),r.emplaceBack(M,k,L,0,0,w,1)}this._poleSegments.push(Oi.simpleSegment(u,0,66,64)),u+=66}this._poleNorthVertexBuffer=i.createVertexBuffer(n,ug,!1),this._poleSouthVertexBuffer=i.createVertexBuffer(r,ug,!1)}_createAtmosphere(i){const e=new Et;e.emplaceBack(-1,1,1,0,0),e.emplaceBack(1,1,1,1,0),e.emplaceBack(1,-1,1,1,1),e.emplaceBack(-1,-1,1,0,1);const n=new we;n.emplaceBack(0,1,2),n.emplaceBack(2,3,0),this.atmosphereVertexBuffer=i.createVertexBuffer(e,ub.members),this.atmosphereIndexBuffer=i.createIndexBuffer(n),this.atmosphereSegments=Oi.simpleSegment(0,0,4,2)}getGridBuffers(){return[this._gridBuffer,this._gridIndexBuffer,this._gridSegments]}getPoleBuffers(i){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[i]]}getWirefameBuffers(i){if(!this._wireframeSegments){const e=new ht,n=64,r=n+1;for(let a=0;a<n;a++)for(let u=0;u<n;u++){const d=a*r+u;e.emplaceBack(d,d+1),e.emplaceBack(d,d+r),e.emplaceBack(d,d+r+1)}this._wireframeIndexBuffer=i.createIndexBuffer(e),this._wireframeSegments=Oi.simpleSegment(0,0,n*n,e.length)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments]}},o.GlyphManager=yl,o.ImagePosition=Gp,o.LineAtlas=nf,o.LngLat=fi,o.LngLatBounds=ls,o.LocalGlyphMode=Hp,o.MAX_MERCATOR_LATITUDE=Xr,o.MercatorCoordinate=Dh,o.ONE_EM=un,o.OverscaledTileID=wn,o.Properties=B,o.RGBAImage=Wn,o.Ray=class{constructor(i,e){this.pos=i,this.dir=e}intersectsPlane(i,e,n){const r=Oc(e,this.dir);if(Math.abs(r)<1e-6)return!1;const a=((i[0]-this.pos[0])*e[0]+(i[1]-this.pos[1])*e[1]+(i[2]-this.pos[2])*e[2])/r;return n[0]=this.pos[0]+this.dir[0]*a,n[1]=this.pos[1]+this.dir[1]*a,n[2]=this.pos[2]+this.dir[2]*a,!0}closestPointOnSphere(i,e,n){if(function(M,k){var L=M[0],F=M[1],j=M[2],H=k[0],ne=k[1],le=k[2];return Math.abs(L-H)<=wp*Math.max(1,Math.abs(L),Math.abs(H))&&Math.abs(F-ne)<=wp*Math.max(1,Math.abs(F),Math.abs(ne))&&Math.abs(j-le)<=wp*Math.max(1,Math.abs(j),Math.abs(le))}(this.pos,i)||e===0)return n[0]=n[1]=n[2]=0,!1;const[r,a,u]=this.dir,d=this.pos[0]-i[0],f=this.pos[1]-i[1],g=this.pos[2]-i[2],v=r*r+a*a+u*u,w=2*(d*r+f*a+g*u),E=w*w-4*v*(d*d+f*f+g*g-e*e);if(E<0){const M=Math.max(-w/2,0),k=d+r*M,L=f+a*M,F=g+u*M,j=Math.hypot(k,L,F);return n[0]=k*e/j,n[1]=L*e/j,n[2]=F*e/j,!1}{const M=(-w-Math.sqrt(E))/(2*v);if(M<0){const k=Math.hypot(d,f,g);return n[0]=d*e/k,n[1]=f*e/k,n[2]=g*e/k,!1}return n[0]=d+r*M,n[1]=f+a*M,n[2]=g+u*M,!0}}},o.RequestManager=class{constructor(i,e,n){this._transformRequestFn=i,this._customAccessToken=e,this._silenceAuthErrors=!!n,this._createSkuToken()}_createSkuToken(){const i=function(){let e="";for(let n=0;n<10;n++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",mt,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=i.token,this._skuTokenExpiresAt=i.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(i,e){return this._transformRequestFn&&this._transformRequestFn(i,e)||{url:i}}normalizeStyleURL(i,e){if(!It(i))return i;const n=Xt(i);return n.path=`/styles/v1${n.path}`,this._makeAPIURL(n,this._customAccessToken||e)}normalizeGlyphsURL(i,e){if(!It(i))return i;const n=Xt(i);return n.path=`/fonts/v1${n.path}`,this._makeAPIURL(n,this._customAccessToken||e)}normalizeSourceURL(i,e){if(!It(i))return i;const n=Xt(i);return n.path=`/v4/${n.authority}.json`,n.params.push("secure"),this._makeAPIURL(n,this._customAccessToken||e)}normalizeSpriteURL(i,e,n,r){const a=Xt(i);return It(i)?(a.path=`/styles/v1${a.path}/sprite${e}${n}`,this._makeAPIURL(a,this._customAccessToken||r)):(a.path+=`${e}${n}`,ci(a))}normalizeTileURL(i,e,n){if(this._isSkuTokenExpired()&&this._createSkuToken(),i&&!It(i))return i;const r=Xt(i);r.path=r.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||n&&r.authority!=="raster"&&n===512?"@2x":""}${Ke.supported?".webp":"$1"}`),r.authority==="raster"?r.path=`/${ze.RASTER_URL_PREFIX}${r.path}`:(r.path=r.path.replace(/^.+\/v4\//,"/"),r.path=`/${ze.TILE_URL_VERSION}${r.path}`);const a=this._customAccessToken||function(u){for(const d of u){const f=d.match(/^access_token=(.*)$/);if(f)return f[1]}return null}(r.params)||ze.ACCESS_TOKEN;return ze.REQUIRE_ACCESS_TOKEN&&a&&this._skuToken&&r.params.push(`sku=${this._skuToken}`),this._makeAPIURL(r,a)}canonicalizeTileURL(i,e){const n=Xt(i);if(!n.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!n.path.match(/\.[\w]+$/))return i;let r="mapbox://";n.path.match(/^\/raster\/v1\//)?r+=`raster/${n.path.replace(`/${ze.RASTER_URL_PREFIX}/`,"")}`:r+=`tiles/${n.path.replace(`/${ze.TILE_URL_VERSION}/`,"")}`;let a=n.params;return e&&(a=a.filter(u=>!u.match(/^access_token=/))),a.length&&(r+=`?${a.join("&")}`),r}canonicalizeTileset(i,e){const n=!!e&&It(e),r=[];for(const a of i.tiles||[])qt(a)?r.push(this.canonicalizeTileURL(a,n)):r.push(a);return r}_makeAPIURL(i,e){const n="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",r=Xt(ze.API_URL);if(i.protocol=r.protocol,i.authority=r.authority,i.protocol==="http"){const a=i.params.indexOf("secure");a>=0&&i.params.splice(a,1)}if(r.path!=="/"&&(i.path=`${r.path}${i.path}`),!ze.REQUIRE_ACCESS_TOKEN)return ci(i);if(e=e||ze.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${n}`);if(e[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${n}`)}return i.params=i.params.filter(a=>a.indexOf("access_token")===-1),i.params.push(`access_token=${e||""}`),ci(i)}},o.ResourceType=Y,o.SegmentVector=Oi,o.SourceCache=da,o.StencilMode=cf,o.StructArrayLayout1ui2=kt,o.StructArrayLayout2f1f2i16=Ue,o.StructArrayLayout2i4=Q,o.StructArrayLayout2ui4=ht,o.StructArrayLayout3f12=re,o.StructArrayLayout3ui6=we,o.StructArrayLayout4i8=ee,o.Texture=Kc,o.Tile=af,o.Transitionable=l,o.Uniform1f=zh,o.Uniform1i=class extends So{constructor(i,e){super(i,e),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}},o.Uniform2f=class extends So{constructor(i,e){super(i,e),this.current=[0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))}},o.Uniform3f=class extends So{constructor(i,e){super(i,e),this.current=[0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))}},o.Uniform4f=Wm,o.UniformColor=Hm,o.UniformMatrix2f=class extends So{constructor(i,e){super(i,e),this.current=ux}set(i){for(let e=0;e<4;e++)if(i[e]!==this.current[e]){this.current=i,this.gl.uniformMatrix2fv(this.location,!1,i);break}}},o.UniformMatrix3f=class extends So{constructor(i,e){super(i,e),this.current=cx}set(i){for(let e=0;e<9;e++)if(i[e]!==this.current[e]){this.current=i,this.gl.uniformMatrix3fv(this.location,!1,i);break}}},o.UniformMatrix4f=class extends So{constructor(i,e){super(i,e),this.current=lx}set(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let e=1;e<16;e++)if(i[e]!==this.current[e]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}},o.UnwrappedTileID=xg,o.ValidationError=et,o.VectorTileWorkerSource=class extends St{constructor(i,e,n,r,a){super(),this.actor=i,this.layerIndex=e,this.availableImages=n,this.loadVectorData=a||Ng,this.loading={},this.loaded={},this.deduped=new Fg(i.scheduler),this.isSpriteLoaded=r,this.scheduler=i.scheduler}loadTile(i,e){const n=i.uid,r=i&&i.request,a=r&&r.collectResourceTiming,u=this.loading[n]=new vb(i);u.abort=this.loadVectorData(i,(d,f)=>{const g=!this.loading[n];if(delete this.loading[n],g||d||!f)return u.status="done",g||(this.loaded[n]=u),e(d);const v=f.rawData,w={};f.expires&&(w.expires=f.expires),f.cacheControl&&(w.cacheControl=f.cacheControl),u.vectorTile=f.vectorTile||new ua.VectorTile(new Yc(v));const E=()=>{u.parse(u.vectorTile,this.layerIndex,this.availableImages,this.actor,(M,k)=>{if(M||!k)return e(M);const L={};if(a){const F=cg(r);F.length>0&&(L.resourceTiming=JSON.parse(JSON.stringify(F)))}e(null,yi({rawTileData:v.slice(0)},k,w,L))})};this.isSpriteLoaded?E():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(E,{type:"parseTile",isSymbolTile:i.isSymbolTile,zoom:i.tileZoom}):E()}),this.loaded=this.loaded||{},this.loaded[n]=u})}reloadTile(i,e){const n=this.loaded,r=i.uid,a=this;if(n&&n[r]){const u=n[r];u.showCollisionBoxes=i.showCollisionBoxes,u.enableTerrain=!!i.enableTerrain,u.projection=i.projection,u.tileTransform=ha(i.tileID.canonical,i.projection);const d=(f,g)=>{const v=u.reloadCallback;v&&(delete u.reloadCallback,u.parse(u.vectorTile,a.layerIndex,this.availableImages,a.actor,v)),e(f,g)};u.status==="parsing"?u.reloadCallback=d:u.status==="done"&&(u.vectorTile?u.parse(u.vectorTile,this.layerIndex,this.availableImages,this.actor,d):d())}}abortTile(i,e){const n=i.uid,r=this.loading[n];r&&(r.abort&&r.abort(),delete this.loading[n]),e()}removeTile(i,e){const n=this.loaded,r=i.uid;n&&n[r]&&delete n[r],e()}},o.WritingMode=lr,o.ZoomHistory=xc,o.add=l_,o.addDynamicAttributes=Kp,o.adjoint=function(i,e){var n=e[0],r=e[1],a=e[2],u=e[3],d=e[4],f=e[5],g=e[6],v=e[7],w=e[8];return i[0]=d*w-f*v,i[1]=a*v-r*w,i[2]=r*f-a*d,i[3]=f*g-u*w,i[4]=n*w-a*g,i[5]=a*u-n*f,i[6]=u*v-d*g,i[7]=r*g-n*v,i[8]=n*d-r*u,i},o.asyncAll=zi,o.bezier=Dt,o.bindAll=hi,o.boundsAttributes=wg,o.bufferConvexPolygon=function(i,e){const n=[];for(let r=0;r<i.length;r++){const a=Li(r-1,-1,i.length-1),u=Li(r+1,-1,i.length-1),d=i[r],f=i[u],g=i[a].sub(d).unit(),v=f.sub(d).unit(),w=v.angleWithSep(g.x,g.y),E=g.add(v).unit().mult(-1*e/Math.sin(w/2));n.push(d.add(E))}return n},o.cacheEntryPossiblyAdded=function(i){Zo++,Zo>_o&&(i.getActor().send("enforceCacheSizeLimit",mo),Zo=0)},o.calculateGlobeLabelMatrix=function(i,e){const{lng:n,lat:r}=i._center,a=mg(0,0,i.worldSize/i._projectionScaler,n,r);return Tp(a,a,function(u){const d=Qr(new Float64Array(16)),f=1/sf(u);return la(d,d,u.min),cs(d,d,[f,f,f]),d}(Jc(e)))},o.calculateGlobeMatrix=_g,o.calculateGlobeMercatorMatrix=function(i){const e=i.worldSize,n=i.point,r=al(1,i.center.lat)*e,a=i.pixelsPerMeter,u=e/(r/i.pixelsPerMeter),d=Qr(new Float64Array(16));return la(d,d,[n.x,n.y,0]),cs(d,d,[u,u,a]),Float32Array.from(d)},o.circumferenceAtLatitude=gp,o.clamp=At,o.clearTileCache=function(i){const e=me.caches.delete(Ea);i&&e.catch(i).then(()=>i())},o.clipLine=eg,o.clone=function(i){var e=new qn(16);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],e},o.clone$1=Vi,o.collisionCircleLayout=vv,o.config=ze,o.conjugate=function(i,e){return i[0]=-e[0],i[1]=-e[1],i[2]=-e[2],i[3]=e[3],i},o.create=function(){var i=new qn(16);return qn!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i},o.create$1=o_,o.createExpression=Zs,o.createLayout=$,o.createStyleLayer=function(i){return i.type==="custom"?new nb(i):new ob[i.type](i)},o.cross=h_,o.degToRad=Fe,o.div=function(i,e,n){return i[0]=e[0]/n[0],i[1]=e[1]/n[1],i[2]=e[2]/n[2],i},o.dot=Oc,o.earthRadius=_p,o.ease=Ut,o.easeCubicInOut=vt,o.emitValidationErrors=uh,o.endsWith=Kt,o.enforceCacheSizeLimit=function(i){Go(),ir&&ir.then(e=>{e.keys().then(n=>{for(let r=0;r<n.length-i;r++)e.delete(n[r])})})},o.evaluateSizeForFeature=Zh,o.evaluateSizeForZoom=fl,o.evaluateVariableOffset=og,o.evented=Ic,o.exactEquals=function(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]&&i[3]===e[3]},o.exactEquals$1=function(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]},o.exported=Ee,o.exported$1=Ke,o.extend=yi,o.extend$1=ni,o.filterObject=Un,o.fromMat4=function(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[4],i[4]=e[5],i[5]=e[6],i[6]=e[8],i[7]=e[9],i[8]=e[10],i},o.fromQuat=function(i,e){var n=e[0],r=e[1],a=e[2],u=e[3],d=n+n,f=r+r,g=a+a,v=n*d,w=r*d,E=r*f,M=a*d,k=a*f,L=a*g,F=u*d,j=u*f,H=u*g;return i[0]=1-E-L,i[1]=w+H,i[2]=M-j,i[3]=0,i[4]=w-H,i[5]=1-v-L,i[6]=k+F,i[7]=0,i[8]=M+j,i[9]=k-F,i[10]=1-v-E,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},o.fromRotation=function(i,e){var n=Math.sin(e),r=Math.cos(e);return i[0]=r,i[1]=n,i[2]=0,i[3]=-n,i[4]=r,i[5]=0,i[6]=0,i[7]=0,i[8]=1,i},o.fromScaling=function(i,e){return i[0]=e[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=e[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=e[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},o.furthestTileCorner=function(i){const e=Math.round((i+45+360)%360/90)%4;return Xe[e]},o.getAABBPointSquareDist=function(i,e,n){let r=0;for(let a=0;a<2;++a){const u=n?n[a]:0;i[a]>u&&(r+=(i[a]-u)*(i[a]-u)),e[a]<u&&(r+=(u-e[a])*(u-e[a]))}return r},o.getAnchorAlignment=Wp,o.getAnchorJustification=Xp,o.getBounds=function(i){let e=1/0,n=1/0,r=-1/0,a=-1/0;for(const u of i)e=Math.min(e,u.x),n=Math.min(n,u.y),r=Math.max(r,u.x),a=Math.max(a,u.y);return{min:new Z(e,n),max:new Z(r,a)}},o.getColumn=function(i,e){return[i[4*e],i[4*e+1],i[4*e+2],i[4*e+3]]},o.getGridMatrix=function(i,e){const[n,r]=e,a=.015625;return[0,(r[1]-n[1])*a,1<<i.z,(r[0]-n[0])*a,0,i.y,n[0],n[1],a]},o.getImage=Je,o.getJSON=function(i,e){return q(yi(i,{type:"json"}),e)},o.getMapSessionAPI=po,o.getPerformanceMeasurement=cg,o.getProjection=function(i){const e=i.parallels,n=!!e&&Math.abs(e[0]+e[1])<.01;switch(i.name){case"mercator":return new Ab(i);case"equirectangular":return new Eb(i);case"naturalEarth":return new Mb(i);case"equalEarth":return new Tb(i);case"winkelTripel":return new Sb(i);case"albers":return n?new jg(i):new wb(i);case"lambertConformalConic":return n?new jg(i):new Cb(i)}throw new Error(`Invalid projection name: ${i.name}`)},o.getRTLTextPluginStatus=rl,o.getReferrer=R,o.getTilePoint=function(i,{x:e,y:n},r=0){return new Z(((e-r)*i.scale-i.x)*Rt,(n*i.scale-i.y)*Rt)},o.getTileVec3=function(i,e,n=0){return Bc(((e.x-n)*i.scale-i.x)*Rt,(e.y*i.scale-i.y)*Rt,Qm(e.z,e.y))},o.getVideo=function(i,e){const n=me.document.createElement("video");n.muted=!0,n.onloadstart=function(){e(null,n)};for(let r=0;r<i.length;r++){const a=me.document.createElement("source");fe(i[r])||(n.crossOrigin="Anonymous"),a.src=i[r],n.appendChild(a)}return{cancel:()=>{}}},o.globeECEFOrigin=function(i,e){const n=[0,0,0];return ca(n,n,fg(Jc(e.canonical))),ca(n,n,i),n},o.globePixelsToTileUnits=function(i,e){return Rt/(512*Math.pow(2,i))*sf(Jc(e))},o.globePoleMatrixForTile=function(i,e,n){const r=Qr(new Float64Array(16)),a=1<<i,u=360*(e/a-.5),d=n.point,f=n.worldSize/(n.tileSize*a);return la(r,r,[d.x,d.y,-n.worldSize/Math.PI/2]),cs(r,r,[f,f,f]),Ep(r,r,Fe(-n._center.lat)),Cp(r,r,Fe(-n._center.lng+u)),Float32Array.from(r)},o.globeTileLatLngCorners=of,o.globeToMercatorTransition=function(i){return Ci(5,6,i)},o.identity=Qr,o.identity$1=f_,o.invert=function(i,e){var n=e[0],r=e[1],a=e[2],u=e[3],d=e[4],f=e[5],g=e[6],v=e[7],w=e[8],E=e[9],M=e[10],k=e[11],L=e[12],F=e[13],j=e[14],H=e[15],ne=n*f-r*d,le=n*g-a*d,ue=n*v-u*d,he=r*g-a*f,de=r*v-u*f,Te=a*v-u*g,Me=w*F-E*L,De=w*j-M*L,Be=w*H-k*L,be=E*j-M*F,Ie=E*H-k*F,Oe=M*H-k*j,We=ne*Oe-le*Ie+ue*be+he*Be-de*De+Te*Me;return We?(i[0]=(f*Oe-g*Ie+v*be)*(We=1/We),i[1]=(a*Ie-r*Oe-u*be)*We,i[2]=(F*Te-j*de+H*he)*We,i[3]=(M*de-E*Te-k*he)*We,i[4]=(g*Be-d*Oe-v*De)*We,i[5]=(n*Oe-a*Be+u*De)*We,i[6]=(j*ue-L*Te-H*le)*We,i[7]=(w*Te-M*ue+k*le)*We,i[8]=(d*Ie-f*Be+v*Me)*We,i[9]=(r*Be-n*Ie-u*Me)*We,i[10]=(L*de-F*ue+H*ne)*We,i[11]=(E*ue-w*de-k*ne)*We,i[12]=(f*De-d*be-g*Me)*We,i[13]=(n*be-r*De+a*Me)*We,i[14]=(F*le-L*he-j*ne)*We,i[15]=(w*he-E*le+M*ne)*We,i):null},o.isMapAuthenticated=function(i){return fo.has(i)},o.isMapboxURL=It,o.isSafariWithAntialiasingBug=function(i){const e=i.navigator?i.navigator.userAgent:null;return!!ie(i)&&e&&(e.match("Version/15.4")||e.match("Version/15.5")||e.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},o.latFromMercatorY=cn,o.len=Mx,o.length=a_,o.length$1=function(i){return Math.hypot(i[0],i[1],i[2],i[3])},o.loadVectorTile=Ng,o.makeRequest=q,o.mercatorXfromLng=Pc,o.mercatorYfromLat=sl,o.mercatorZfromAltitude=al,o.mul=Ex,o.mul$1=Cx,o.multiply=function(i,e,n){var r=e[0],a=e[1],u=e[2],d=e[3],f=e[4],g=e[5],v=e[6],w=e[7],E=e[8],M=n[0],k=n[1],L=n[2],F=n[3],j=n[4],H=n[5],ne=n[6],le=n[7],ue=n[8];return i[0]=M*r+k*d+L*v,i[1]=M*a+k*f+L*w,i[2]=M*u+k*g+L*E,i[3]=F*r+j*d+H*v,i[4]=F*a+j*f+H*w,i[5]=F*u+j*g+H*E,i[6]=ne*r+le*d+ue*v,i[7]=ne*a+le*f+ue*w,i[8]=ne*u+le*g+ue*E,i},o.multiply$1=Tp,o.multiply$2=u_,o.nextPowerOfTwo=tr,o.normalize=Rc,o.normalize$1=function(i,e){var n=e[0],r=e[1],a=e[2],u=e[3],d=n*n+r*r+a*a+u*u;return d>0&&(d=1/Math.sqrt(d)),i[0]=n*d,i[1]=r*d,i[2]=a*d,i[3]=u*d,i},o.number=xt,o.ortho=function(i,e,n,r,a,u,d){var f=1/(e-n),g=1/(r-a),v=1/(u-d);return i[0]=-2*f,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*g,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*v,i[11]=0,i[12]=(e+n)*f,i[13]=(a+r)*g,i[14]=(d+u)*v,i[15]=1,i},o.pbf=Yc,o.perspective=function(i,e,n,r,a){var u,d=1/Math.tan(e/2);return i[0]=d/n,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=d,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,a!=null&&a!==1/0?(i[10]=(a+r)*(u=1/(r-a)),i[14]=2*a*r*u):(i[10]=-1,i[14]=-2*r),i},o.pick=function(i,e){const n={};for(let r=0;r<e.length;r++){const a=e[r];a in i&&(n[a]=i[a])}return n},o.plugin=Gn,o.pointGeometry=Z,o.polygonIntersectsBox=i_,o.polygonIntersectsPolygon=$m,o.polygonizeBounds=function(i,e,n=0,r=!0){const a=new Z(n,n),u=i.sub(a),d=e.add(a),f=[u,new Z(d.x,u.y),d,new Z(u.x,d.y)];return r&&f.push(u),f},o.posAttributes=$c,o.postMapLoadEvent=$i,o.postTurnstileEvent=Ar,o.potpack=jp,o.prevPowerOfTwo=function(i){return i<=1?1:Math.pow(2,Math.floor(Math.log(i)/Math.LN2))},o.radToDeg=ke,o.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],o.registerForPluginStateChange=function(i){return i({pluginStatus:An,pluginURL:Dn}),Ic.on("pluginStateChange",i),i},o.removeAuthState=function(i){fo.delete(i)},o.renderColorRamp=Pp,o.rotateX=Ep,o.rotateX$1=m_,o.rotateY=Cp,o.rotateZ=function(i,e,n){var r=Math.sin(n),a=Math.cos(n),u=e[0],d=e[1],f=e[2],g=e[3],v=e[4],w=e[5],E=e[6],M=e[7];return e!==i&&(i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[0]=u*a+v*r,i[1]=d*a+w*r,i[2]=f*a+E*r,i[3]=g*a+M*r,i[4]=v*a-u*r,i[5]=w*a-d*r,i[6]=E*a-f*r,i[7]=M*a-g*r,i},o.rotateZ$1=function(i,e,n){n*=.5;var r=e[0],a=e[1],u=e[2],d=e[3],f=Math.sin(n),g=Math.cos(n);return i[0]=r*g+a*f,i[1]=a*g-r*f,i[2]=u*g+d*f,i[3]=d*g-u*f,i},o.scale=cs,o.scale$1=function(i,e,n){return i[0]=e[0]*n,i[1]=e[1]*n,i[2]=e[2]*n,i[3]=e[3]*n,i},o.scale$2=Lc,o.scaleAndAdd=zp,o.setCacheLimits=function(i,e){mo=i,_o=e},o.setColumn=function(i,e,n){i[4*e+0]=n[0],i[4*e+1]=n[1],i[4*e+2]=n[2],i[4*e+3]=n[3]},o.setRTLTextPlugin=function(i,e,n=!1){if(An===Cc||An===ia||An===Mc)throw new Error("setRTLTextPlugin cannot be called multiple times.");Dn=Ee.resolveURL(i),An=Cc,Sc=e,Co(),n||ns()},o.smoothstep=Ci,o.spec=ve,o.storeAuthState=function(i,e){e?fo.add(i):fo.delete(i)},o.sub=ul,o.subtract=c_,o.symbolSize=bv,o.tileAABB=function(i,e,n,r,a,u,d,f,g){if(g.name==="globe")return pb(i,e,new Jh(n,r,a));const v=ha({z:n,x:r,y:a},g);return new ar([(u+v.x/v.scale)*e,e*(v.y/v.scale),d],[(u+v.x2/v.scale)*e,e*(v.y2/v.scale),f])},o.tileTransform=ha,o.transformMat3=function(i,e,n){var r=e[0],a=e[1],u=e[2];return i[0]=r*n[0]+a*n[3]+u*n[6],i[1]=r*n[1]+a*n[4]+u*n[7],i[2]=r*n[2]+a*n[5]+u*n[8],i},o.transformMat4=ca,o.transformMat4$1=hl,o.transformQuat=d_,o.translate=la,o.transpose=function(i,e){if(i===e){var n=e[1],r=e[2],a=e[5];i[1]=e[3],i[2]=e[6],i[3]=n,i[5]=e[7],i[6]=r,i[7]=a}else i[0]=e[0],i[1]=e[3],i[2]=e[6],i[3]=e[1],i[4]=e[4],i[5]=e[7],i[6]=e[2],i[7]=e[5],i[8]=e[8];return i},o.triggerPluginCompletionEvent=na,o.uniqueId=Mn,o.validateCustomStyleLayer=function(i){const e=[],n=i.id;return n===void 0&&e.push({message:`layers.${n}: missing required property "id"`}),i.render===void 0&&e.push({message:`layers.${n}: missing required method "render"`}),i.renderingMode&&i.renderingMode!=="2d"&&i.renderingMode!=="3d"&&e.push({message:`layers.${n}: property "renderingMode" must be either "2d" or "3d"`}),e},o.validateFilter=i=>Sr(qr(i)),o.validateFog=i=>Sr(ch(i)),o.validateLayer=i=>Sr(rh(i)),o.validateLight=i=>Sr(ah(i)),o.validateSource=i=>Sr(sh(i)),o.validateStyle=Ks,o.validateTerrain=i=>Sr(lh(i)),o.values=xn,o.vectorTile=ua,o.version=U,o.warnOnce=Gt,o.window=me,o.wrap=Li}),I(["./shared"],function(o){function U(Y){if(typeof Y=="number"||typeof Y=="boolean"||typeof Y=="string"||Y==null)return JSON.stringify(Y);if(Array.isArray(Y)){let R="[";for(const q of Y)R+=`${U(q)},`;return`${R}]`}let P="{";for(const R of Object.keys(Y).sort())P+=`${R}:${U(Y[R])},`;return`${P}}`}function oe(Y){let P="";for(const R of o.refProperties)P+=`/${U(Y[R])}`;return P}class te{constructor(P){this.keyCache={},P&&this.replace(P)}replace(P){this._layerConfigs={},this._layers={},this.update(P,[])}update(P,R){for(const J of P)this._layerConfigs[J.id]=J,(this._layers[J.id]=o.createStyleLayer(J)).compileFilter(),this.keyCache[J.id]&&delete this.keyCache[J.id];for(const J of R)delete this.keyCache[J],delete this._layerConfigs[J],delete this._layers[J];this.familiesBySource={};const q=function(J,ae){const _e={};for(let ce=0;ce<J.length;ce++){const xe=ae&&ae[J[ce].id]||oe(J[ce]);ae&&(ae[J[ce].id]=xe);let Pe=_e[xe];Pe||(Pe=_e[xe]=[]),Pe.push(J[ce])}const fe=[];for(const ce in _e)fe.push(_e[ce]);return fe}(o.values(this._layerConfigs),this.keyCache);for(const J of q){const ae=J.map(Je=>this._layers[Je.id]),_e=ae[0];if(_e.visibility==="none")continue;const fe=_e.source||"";let ce=this.familiesBySource[fe];ce||(ce=this.familiesBySource[fe]={});const xe=_e.sourceLayer||"_geojsonTileLayer";let Pe=ce[xe];Pe||(Pe=ce[xe]=[]),Pe.push(ae)}}}class Z{loadTile(P,R){const{uid:q,encoding:J,rawImageData:ae,padding:_e,buildQuadTree:fe}=P,ce=o.window.ImageBitmap&&ae instanceof o.window.ImageBitmap?this.getImageData(ae,_e):ae;R(null,new o.DEMData(q,ce,J,_e<1,fe))}getImageData(P,R){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(P.width,P.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=P.width,this.offscreenCanvas.height=P.height,this.offscreenCanvasContext.drawImage(P,0,0,P.width,P.height);const q=this.offscreenCanvasContext.getImageData(-R,-R,P.width+2*R,P.height+2*R);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),q}}var se=function Y(P,R){var q,J=P&&P.type;if(J==="FeatureCollection")for(q=0;q<P.features.length;q++)Y(P.features[q],R);else if(J==="GeometryCollection")for(q=0;q<P.geometries.length;q++)Y(P.geometries[q],R);else if(J==="Feature")Y(P.geometry,R);else if(J==="Polygon")me(P.coordinates,R);else if(J==="MultiPolygon")for(q=0;q<P.coordinates.length;q++)me(P.coordinates[q],R);return P};function me(Y,P){if(Y.length!==0){Ye(Y[0],P);for(var R=1;R<Y.length;R++)Ye(Y[R],!P)}}function Ye(Y,P){for(var R=0,q=0,J=0,ae=Y.length,_e=ae-1;J<ae;_e=J++){var fe=(Y[J][0]-Y[_e][0])*(Y[_e][1]+Y[J][1]),ce=R+fe;q+=Math.abs(R)>=Math.abs(fe)?R-ce+fe:fe-ce+R,R=ce}R+q>=0!=!!P&&Y.reverse()}const ft=o.vectorTile.VectorTileFeature.prototype.toGeoJSON;class Fe{constructor(P){this._feature=P,this.extent=o.EXTENT,this.type=P.type,this.properties=P.tags,"id"in P&&!isNaN(P.id)&&(this.id=parseInt(P.id,10))}loadGeometry(){if(this._feature.type===1){const P=[];for(const R of this._feature.geometry)P.push([new o.pointGeometry(R[0],R[1])]);return P}{const P=[];for(const R of this._feature.geometry){const q=[];for(const J of R)q.push(new o.pointGeometry(J[0],J[1]));P.push(q)}return P}}toGeoJSON(P,R,q){return ft.call(this,P,R,q)}}class ke{constructor(P){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=o.EXTENT,this.length=P.length,this._features=P}feature(P){return new Fe(this._features[P])}}var Xe=o.vectorTile.VectorTileFeature,vt=Dt;function Dt(Y,P){this.options=P||{},this.features=Y,this.length=Y.length}function Ut(Y,P){this.id=typeof Y.id=="number"?Y.id:void 0,this.type=Y.type,this.rawGeometry=Y.type===1?[Y.geometry]:Y.geometry,this.properties=Y.tags,this.extent=P||4096}Dt.prototype.feature=function(Y){return new Ut(this.features[Y],this.options.extent)},Ut.prototype.loadGeometry=function(){var Y=this.rawGeometry;this.geometry=[];for(var P=0;P<Y.length;P++){for(var R=Y[P],q=[],J=0;J<R.length;J++)q.push(new o.pointGeometry(R[J][0],R[J][1]));this.geometry.push(q)}return this.geometry},Ut.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Y=this.geometry,P=1/0,R=-1/0,q=1/0,J=-1/0,ae=0;ae<Y.length;ae++)for(var _e=Y[ae],fe=0;fe<_e.length;fe++){var ce=_e[fe];P=Math.min(P,ce.x),R=Math.max(R,ce.x),q=Math.min(q,ce.y),J=Math.max(J,ce.y)}return[P,q,R,J]},Ut.prototype.toGeoJSON=Xe.prototype.toGeoJSON;var At=Li,Ci=vt;function Li(Y){var P=new o.pbf;return function(R,q){for(var J in R.layers)q.writeMessage(3,zi,R.layers[J])}(Y,P),P.finish()}function zi(Y,P){var R;P.writeVarintField(15,Y.version||1),P.writeStringField(1,Y.name||""),P.writeVarintField(5,Y.extent||4096);var q={keys:[],values:[],keycache:{},valuecache:{}};for(R=0;R<Y.length;R++)q.feature=Y.feature(R),P.writeMessage(2,xn,q);var J=q.keys;for(R=0;R<J.length;R++)P.writeStringField(3,J[R]);var ae=q.values;for(R=0;R<ae.length;R++)P.writeMessage(4,tr,ae[R])}function xn(Y,P){var R=Y.feature;R.id!==void 0&&P.writeVarintField(1,R.id),P.writeMessage(2,yi,Y),P.writeVarintField(3,R.type),P.writeMessage(4,er,R)}function yi(Y,P){var R=Y.feature,q=Y.keys,J=Y.values,ae=Y.keycache,_e=Y.valuecache;for(var fe in R.properties){var ce=R.properties[fe],xe=ae[fe];if(ce!==null){xe===void 0&&(q.push(fe),ae[fe]=xe=q.length-1),P.writeVarint(xe);var Pe=typeof ce;Pe!=="string"&&Pe!=="boolean"&&Pe!=="number"&&(ce=JSON.stringify(ce));var Je=Pe+":"+ce,Re=_e[Je];Re===void 0&&(J.push(ce),_e[Je]=Re=J.length-1),P.writeVarint(Re)}}}function dn(Y,P){return(P<<3)+(7&Y)}function Mn(Y){return Y<<1^Y>>31}function er(Y,P){for(var R=Y.loadGeometry(),q=Y.type,J=0,ae=0,_e=R.length,fe=0;fe<_e;fe++){var ce=R[fe],xe=1;q===1&&(xe=ce.length),P.writeVarint(dn(1,xe));for(var Pe=q===3?ce.length-1:ce.length,Je=0;Je<Pe;Je++){Je===1&&q!==1&&P.writeVarint(dn(2,Pe-1));var Re=ce[Je].x-J,Tt=ce[Je].y-ae;P.writeVarint(Mn(Re)),P.writeVarint(Mn(Tt)),J+=Re,ae+=Tt}q===3&&P.writeVarint(dn(7,1))}}function tr(Y,P){var R=typeof Y;R==="string"?P.writeStringField(1,Y):R==="boolean"?P.writeBooleanField(7,Y):R==="number"&&(Y%1!=0?P.writeDoubleField(3,Y):Y<0?P.writeSVarintField(6,Y):P.writeVarintField(5,Y))}function Ti(Y,P,R,q,J,ae){if(J-q<=R)return;const _e=q+J>>1;hi(Y,P,_e,q,J,ae%2),Ti(Y,P,R,q,_e-1,ae+1),Ti(Y,P,R,_e+1,J,ae+1)}function hi(Y,P,R,q,J,ae){for(;J>q;){if(J-q>600){const xe=J-q+1,Pe=R-q+1,Je=Math.log(xe),Re=.5*Math.exp(2*Je/3),Tt=.5*Math.sqrt(Je*Re*(xe-Re)/xe)*(Pe-xe/2<0?-1:1);hi(Y,P,R,Math.max(q,Math.floor(R-Pe*Re/xe+Tt)),Math.min(J,Math.floor(R+(xe-Pe)*Re/xe+Tt)),ae)}const _e=P[2*R+ae];let fe=q,ce=J;for(Kt(Y,P,q,R),P[2*J+ae]>_e&&Kt(Y,P,q,J);fe<ce;){for(Kt(Y,P,fe,ce),fe++,ce--;P[2*fe+ae]<_e;)fe++;for(;P[2*ce+ae]>_e;)ce--}P[2*q+ae]===_e?Kt(Y,P,q,ce):(ce++,Kt(Y,P,ce,J)),ce<=R&&(q=ce+1),R<=ce&&(J=ce-1)}}function Kt(Y,P,R,q){Ui(Y,R,q),Ui(P,2*R,2*q),Ui(P,2*R+1,2*q+1)}function Ui(Y,P,R){const q=Y[P];Y[P]=Y[R],Y[R]=q}function Un(Y,P,R,q){const J=Y-R,ae=P-q;return J*J+ae*ae}At.fromVectorTileJs=Li,At.fromGeojsonVt=function(Y,P){P=P||{};var R={};for(var q in Y)R[q]=new vt(Y[q].features,P),R[q].name=q,R[q].version=P.version,R[q].extent=P.extent;return Li({layers:R})},At.GeoJSONWrapper=Ci;const Vi=Y=>Y[0],pn=Y=>Y[1];class Gt{constructor(P,R=Vi,q=pn,J=64,ae=Float64Array){this.nodeSize=J,this.points=P;const _e=P.length<65536?Uint16Array:Uint32Array,fe=this.ids=new _e(P.length),ce=this.coords=new ae(2*P.length);for(let xe=0;xe<P.length;xe++)fe[xe]=xe,ce[2*xe]=R(P[xe]),ce[2*xe+1]=q(P[xe]);Ti(fe,ce,J,0,fe.length-1,0)}range(P,R,q,J){return function(ae,_e,fe,ce,xe,Pe,Je){const Re=[0,ae.length-1,0],Tt=[];let _t,gt;for(;Re.length;){const St=Re.pop(),ve=Re.pop(),ni=Re.pop();if(ve-ni<=Je){for(let ri=ni;ri<=ve;ri++)_t=_e[2*ri],gt=_e[2*ri+1],_t>=fe&&_t<=xe&&gt>=ce&&gt<=Pe&&Tt.push(ae[ri]);continue}const ct=Math.floor((ni+ve)/2);_t=_e[2*ct],gt=_e[2*ct+1],_t>=fe&&_t<=xe&&gt>=ce&&gt<=Pe&&Tt.push(ae[ct]);const ti=(St+1)%2;(St===0?fe<=_t:ce<=gt)&&(Re.push(ni),Re.push(ct-1),Re.push(ti)),(St===0?xe>=_t:Pe>=gt)&&(Re.push(ct+1),Re.push(ve),Re.push(ti))}return Tt}(this.ids,this.coords,P,R,q,J,this.nodeSize)}within(P,R,q){return function(J,ae,_e,fe,ce,xe){const Pe=[0,J.length-1,0],Je=[],Re=ce*ce;for(;Pe.length;){const Tt=Pe.pop(),_t=Pe.pop(),gt=Pe.pop();if(_t-gt<=xe){for(let ti=gt;ti<=_t;ti++)Un(ae[2*ti],ae[2*ti+1],_e,fe)<=Re&&Je.push(J[ti]);continue}const St=Math.floor((gt+_t)/2),ve=ae[2*St],ni=ae[2*St+1];Un(ve,ni,_e,fe)<=Re&&Je.push(J[St]);const ct=(Tt+1)%2;(Tt===0?_e-ce<=ve:fe-ce<=ni)&&(Pe.push(gt),Pe.push(St-1),Pe.push(ct)),(Tt===0?_e+ce>=ve:fe+ce>=ni)&&(Pe.push(St+1),Pe.push(_t),Pe.push(ct))}return Je}(this.ids,this.coords,P,R,q,this.nodeSize)}}const Wi={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Y=>Y},Le=Math.fround||(dt=new Float32Array(1),Y=>(dt[0]=+Y,dt[0]));var dt;class tt{constructor(P){this.options=Ee(Object.create(Wi),P),this.trees=new Array(this.options.maxZoom+1)}load(P){const{log:R,minZoom:q,maxZoom:J,nodeSize:ae}=this.options;R&&console.time("total time");const _e=`prepare ${P.length} points`;R&&console.time(_e),this.points=P;let fe=[];for(let ce=0;ce<P.length;ce++)P[ce].geometry&&fe.push(di(P[ce],ce));this.trees[J+1]=new Gt(fe,Ne,ze,ae,Float32Array),R&&console.timeEnd(_e);for(let ce=J;ce>=q;ce--){const xe=+Date.now();fe=this._cluster(fe,ce),this.trees[ce]=new Gt(fe,Ne,ze,ae,Float32Array),R&&console.log("z%d: %d clusters in %dms",ce,fe.length,+Date.now()-xe)}return R&&console.timeEnd("total time"),this}getClusters(P,R){let q=((P[0]+180)%360+360)%360-180;const J=Math.max(-90,Math.min(90,P[1]));let ae=P[2]===180?180:((P[2]+180)%360+360)%360-180;const _e=Math.max(-90,Math.min(90,P[3]));if(P[2]-P[0]>=360)q=-180,ae=180;else if(q>ae){const Pe=this.getClusters([q,J,180,_e],R),Je=this.getClusters([-180,J,ae,_e],R);return Pe.concat(Je)}const fe=this.trees[this._limitZoom(R)],ce=fe.range(rt(q),ie(_e),rt(ae),ie(J)),xe=[];for(const Pe of ce){const Je=fe.points[Pe];xe.push(Je.numPoints?li(Je):this.points[Je.index])}return xe}getChildren(P){const R=this._getOriginId(P),q=this._getOriginZoom(P),J="No cluster with the specified id.",ae=this.trees[q];if(!ae)throw new Error(J);const _e=ae.points[R];if(!_e)throw new Error(J);const fe=this.options.radius/(this.options.extent*Math.pow(2,q-1)),ce=ae.within(_e.x,_e.y,fe),xe=[];for(const Pe of ce){const Je=ae.points[Pe];Je.parentId===P&&xe.push(Je.numPoints?li(Je):this.points[Je.index])}if(xe.length===0)throw new Error(J);return xe}getLeaves(P,R,q){const J=[];return this._appendLeaves(J,P,R=R||10,q=q||0,0),J}getTile(P,R,q){const J=this.trees[this._limitZoom(P)],ae=Math.pow(2,P),{extent:_e,radius:fe}=this.options,ce=fe/_e,xe=(q-ce)/ae,Pe=(q+1+ce)/ae,Je={features:[]};return this._addTileFeatures(J.range((R-ce)/ae,xe,(R+1+ce)/ae,Pe),J.points,R,q,ae,Je),R===0&&this._addTileFeatures(J.range(1-ce/ae,xe,1,Pe),J.points,ae,q,ae,Je),R===ae-1&&this._addTileFeatures(J.range(0,xe,ce/ae,Pe),J.points,-1,q,ae,Je),Je.features.length?Je:null}getClusterExpansionZoom(P){let R=this._getOriginZoom(P)-1;for(;R<=this.options.maxZoom;){const q=this.getChildren(P);if(R++,q.length!==1)break;P=q[0].properties.cluster_id}return R}_appendLeaves(P,R,q,J,ae){const _e=this.getChildren(R);for(const fe of _e){const ce=fe.properties;if(ce&&ce.cluster?ae+ce.point_count<=J?ae+=ce.point_count:ae=this._appendLeaves(P,ce.cluster_id,q,J,ae):ae<J?ae++:P.push(fe),P.length===q)break}return ae}_addTileFeatures(P,R,q,J,ae,_e){for(const fe of P){const ce=R[fe],xe=ce.numPoints;let Pe,Je,Re;if(xe)Pe=Ot(ce),Je=ce.x,Re=ce.y;else{const gt=this.points[ce.index];Pe=gt.properties,Je=rt(gt.geometry.coordinates[0]),Re=ie(gt.geometry.coordinates[1])}const Tt={type:1,geometry:[[Math.round(this.options.extent*(Je*ae-q)),Math.round(this.options.extent*(Re*ae-J))]],tags:Pe};let _t;xe?_t=ce.id:this.options.generateId?_t=ce.index:this.points[ce.index].id&&(_t=this.points[ce.index].id),_t!==void 0&&(Tt.id=_t),_e.features.push(Tt)}}_limitZoom(P){return Math.max(this.options.minZoom,Math.min(+P,this.options.maxZoom+1))}_cluster(P,R){const q=[],{radius:J,extent:ae,reduce:_e,minPoints:fe}=this.options,ce=J/(ae*Math.pow(2,R));for(let xe=0;xe<P.length;xe++){const Pe=P[xe];if(Pe.zoom<=R)continue;Pe.zoom=R;const Je=this.trees[R+1],Re=Je.within(Pe.x,Pe.y,ce),Tt=Pe.numPoints||1;let _t=Tt;for(const gt of Re){const St=Je.points[gt];St.zoom>R&&(_t+=St.numPoints||1)}if(_t>Tt&&_t>=fe){let gt=Pe.x*Tt,St=Pe.y*Tt,ve=_e&&Tt>1?this._map(Pe,!0):null;const ni=(xe<<5)+(R+1)+this.points.length;for(const ct of Re){const ti=Je.points[ct];if(ti.zoom<=R)continue;ti.zoom=R;const ri=ti.numPoints||1;gt+=ti.x*ri,St+=ti.y*ri,ti.parentId=ni,_e&&(ve||(ve=this._map(Pe,!0)),_e(ve,this._map(ti)))}Pe.parentId=ni,q.push(wt(gt/_t,St/_t,ni,_t,ve))}else if(q.push(Pe),_t>1)for(const gt of Re){const St=Je.points[gt];St.zoom<=R||(St.zoom=R,q.push(St))}}return q}_getOriginId(P){return P-this.points.length>>5}_getOriginZoom(P){return(P-this.points.length)%32}_map(P,R){if(P.numPoints)return R?Ee({},P.properties):P.properties;const q=this.points[P.index].properties,J=this.options.map(q);return R&&J===q?Ee({},J):J}}function wt(Y,P,R,q,J){return{x:Le(Y),y:Le(P),zoom:1/0,id:R,parentId:-1,numPoints:q,properties:J}}function di(Y,P){const[R,q]=Y.geometry.coordinates;return{x:Le(rt(R)),y:Le(ie(q)),zoom:1/0,index:P,parentId:-1}}function li(Y){return{type:"Feature",id:Y.id,properties:Ot(Y),geometry:{type:"Point",coordinates:[(P=Y.x,360*(P-.5)),pe(Y.y)]}};var P}function Ot(Y){const P=Y.numPoints,R=P>=1e4?`${Math.round(P/1e3)}k`:P>=1e3?Math.round(P/100)/10+"k":P;return Ee(Ee({},Y.properties),{cluster:!0,cluster_id:Y.id,point_count:P,point_count_abbreviated:R})}function rt(Y){return Y/360+.5}function ie(Y){const P=Math.sin(Y*Math.PI/180),R=.5-.25*Math.log((1+P)/(1-P))/Math.PI;return R<0?0:R>1?1:R}function pe(Y){const P=(180-360*Y)*Math.PI/180;return 360*Math.atan(Math.exp(P))/Math.PI-90}function Ee(Y,P){for(const R in P)Y[R]=P[R];return Y}function Ne(Y){return Y.x}function ze(Y){return Y.y}function Ke(Y,P,R,q){for(var J,ae=q,_e=R-P>>1,fe=R-P,ce=Y[P],xe=Y[P+1],Pe=Y[R],Je=Y[R+1],Re=P+3;Re<R;Re+=3){var Tt=at(Y[Re],Y[Re+1],ce,xe,Pe,Je);if(Tt>ae)J=Re,ae=Tt;else if(Tt===ae){var _t=Math.abs(Re-_e);_t<fe&&(J=Re,fe=_t)}}ae>q&&(J-P>3&&Ke(Y,P,J,q),Y[J+2]=ae,R-J>3&&Ke(Y,J,R,q))}function at(Y,P,R,q,J,ae){var _e=J-R,fe=ae-q;if(_e!==0||fe!==0){var ce=((Y-R)*_e+(P-q)*fe)/(_e*_e+fe*fe);ce>1?(R=J,q=ae):ce>0&&(R+=_e*ce,q+=fe*ce)}return(_e=Y-R)*_e+(fe=P-q)*fe}function He(Y,P,R,q){var J={id:Y===void 0?null:Y,type:P,geometry:R,tags:q,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ae){var _e=ae.geometry,fe=ae.type;if(fe==="Point"||fe==="MultiPoint"||fe==="LineString")$e(ae,_e);else if(fe==="Polygon"||fe==="MultiLineString")for(var ce=0;ce<_e.length;ce++)$e(ae,_e[ce]);else if(fe==="MultiPolygon")for(ce=0;ce<_e.length;ce++)for(var xe=0;xe<_e[ce].length;xe++)$e(ae,_e[ce][xe])}(J),J}function $e(Y,P){for(var R=0;R<P.length;R+=3)Y.minX=Math.min(Y.minX,P[R]),Y.minY=Math.min(Y.minY,P[R+1]),Y.maxX=Math.max(Y.maxX,P[R]),Y.maxY=Math.max(Y.maxY,P[R+1])}function Ge(Y,P,R,q){if(P.geometry){var J=P.geometry.coordinates,ae=P.geometry.type,_e=Math.pow(R.tolerance/((1<<R.maxZoom)*R.extent),2),fe=[],ce=P.id;if(R.promoteId?ce=P.properties[R.promoteId]:R.generateId&&(ce=q||0),ae==="Point")Mt(J,fe);else if(ae==="MultiPoint")for(var xe=0;xe<J.length;xe++)Mt(J[xe],fe);else if(ae==="LineString")mt(J,fe,_e,!1);else if(ae==="MultiLineString"){if(R.lineMetrics){for(xe=0;xe<J.length;xe++)mt(J[xe],fe=[],_e,!1),Y.push(He(ce,"LineString",fe,P.properties));return}Ct(J,fe,_e,!1)}else if(ae==="Polygon")Ct(J,fe,_e,!0);else{if(ae!=="MultiPolygon"){if(ae==="GeometryCollection"){for(xe=0;xe<P.geometry.geometries.length;xe++)Ge(Y,{id:ce,geometry:P.geometry.geometries[xe],properties:P.properties},R,q);return}throw new Error("Input data is not a valid GeoJSON object.")}for(xe=0;xe<J.length;xe++){var Pe=[];Ct(J[xe],Pe,_e,!0),fe.push(Pe)}}Y.push(He(ce,ae,fe,P.properties))}}function Mt(Y,P){P.push(It(Y[0])),P.push(qt(Y[1])),P.push(0)}function mt(Y,P,R,q){for(var J,ae,_e=0,fe=0;fe<Y.length;fe++){var ce=It(Y[fe][0]),xe=qt(Y[fe][1]);P.push(ce),P.push(xe),P.push(0),fe>0&&(_e+=q?(J*xe-ce*ae)/2:Math.sqrt(Math.pow(ce-J,2)+Math.pow(xe-ae,2))),J=ce,ae=xe}var Pe=P.length-3;P[2]=1,Ke(P,0,Pe,R),P[Pe+2]=1,P.size=Math.abs(_e),P.start=0,P.end=P.size}function Ct(Y,P,R,q){for(var J=0;J<Y.length;J++){var ae=[];mt(Y[J],ae,R,q),P.push(ae)}}function It(Y){return Y/360+.5}function qt(Y){var P=Math.sin(Y*Math.PI/180),R=.5-.25*Math.log((1+P)/(1-P))/Math.PI;return R<0?0:R>1?1:R}function ei(Y,P,R,q,J,ae,_e,fe){if(q/=P,ae>=(R/=P)&&_e<q)return Y;if(_e<R||ae>=q)return null;for(var ce=[],xe=0;xe<Y.length;xe++){var Pe=Y[xe],Je=Pe.geometry,Re=Pe.type,Tt=J===0?Pe.minX:Pe.minY,_t=J===0?Pe.maxX:Pe.maxY;if(Tt>=R&&_t<q)ce.push(Pe);else if(!(_t<R||Tt>=q)){var gt=[];if(Re==="Point"||Re==="MultiPoint")Xt(Je,gt,R,q,J);else if(Re==="LineString")ci(Je,gt,R,q,J,!1,fe.lineMetrics);else if(Re==="MultiLineString")vn(Je,gt,R,q,J,!1);else if(Re==="Polygon")vn(Je,gt,R,q,J,!0);else if(Re==="MultiPolygon")for(var St=0;St<Je.length;St++){var ve=[];vn(Je[St],ve,R,q,J,!0),ve.length&&gt.push(ve)}if(gt.length){if(fe.lineMetrics&&Re==="LineString"){for(St=0;St<gt.length;St++)ce.push(He(Pe.id,Re,gt[St],Pe.tags));continue}Re!=="LineString"&&Re!=="MultiLineString"||(gt.length===1?(Re="LineString",gt=gt[0]):Re="MultiLineString"),Re!=="Point"&&Re!=="MultiPoint"||(Re=gt.length===3?"Point":"MultiPoint"),ce.push(He(Pe.id,Re,gt,Pe.tags))}}}return ce.length?ce:null}function Xt(Y,P,R,q,J){for(var ae=0;ae<Y.length;ae+=3){var _e=Y[ae+J];_e>=R&&_e<=q&&(P.push(Y[ae]),P.push(Y[ae+1]),P.push(Y[ae+2]))}}function ci(Y,P,R,q,J,ae,_e){for(var fe,ce,xe=nn(Y),Pe=J===0?Ar:ho,Je=Y.start,Re=0;Re<Y.length-3;Re+=3){var Tt=Y[Re],_t=Y[Re+1],gt=Y[Re+2],St=Y[Re+3],ve=Y[Re+4],ni=J===0?Tt:_t,ct=J===0?St:ve,ti=!1;_e&&(fe=Math.sqrt(Math.pow(Tt-St,2)+Math.pow(_t-ve,2))),ni<R?ct>R&&(ce=Pe(xe,Tt,_t,St,ve,R),_e&&(xe.start=Je+fe*ce)):ni>q?ct<q&&(ce=Pe(xe,Tt,_t,St,ve,q),_e&&(xe.start=Je+fe*ce)):br(xe,Tt,_t,gt),ct<R&&ni>=R&&(ce=Pe(xe,Tt,_t,St,ve,R),ti=!0),ct>q&&ni<=q&&(ce=Pe(xe,Tt,_t,St,ve,q),ti=!0),!ae&&ti&&(_e&&(xe.end=Je+fe*ce),P.push(xe),xe=nn(Y)),_e&&(Je+=fe)}var ri=Y.length-3;Tt=Y[ri],_t=Y[ri+1],gt=Y[ri+2],(ni=J===0?Tt:_t)>=R&&ni<=q&&br(xe,Tt,_t,gt),ri=xe.length-3,ae&&ri>=3&&(xe[ri]!==xe[0]||xe[ri+1]!==xe[1])&&br(xe,xe[0],xe[1],xe[2]),xe.length&&P.push(xe)}function nn(Y){var P=[];return P.size=Y.size,P.start=Y.start,P.end=Y.end,P}function vn(Y,P,R,q,J,ae){for(var _e=0;_e<Y.length;_e++)ci(Y[_e],P,R,q,J,ae,!1)}function br(Y,P,R,q){Y.push(P),Y.push(R),Y.push(q)}function Ar(Y,P,R,q,J,ae){var _e=(ae-P)/(q-P);return Y.push(ae),Y.push(R+(J-R)*_e),Y.push(1),_e}function ho(Y,P,R,q,J,ae){var _e=(ae-R)/(J-R);return Y.push(P+(q-P)*_e),Y.push(ae),Y.push(1),_e}function $i(Y,P){for(var R=[],q=0;q<Y.length;q++){var J,ae=Y[q],_e=ae.type;if(_e==="Point"||_e==="MultiPoint"||_e==="LineString")J=rn(ae.geometry,P);else if(_e==="MultiLineString"||_e==="Polygon"){J=[];for(var fe=0;fe<ae.geometry.length;fe++)J.push(rn(ae.geometry[fe],P))}else if(_e==="MultiPolygon")for(J=[],fe=0;fe<ae.geometry.length;fe++){for(var ce=[],xe=0;xe<ae.geometry[fe].length;xe++)ce.push(rn(ae.geometry[fe][xe],P));J.push(ce)}R.push(He(ae.id,_e,J,ae.tags))}return R}function rn(Y,P){var R=[];R.size=Y.size,Y.start!==void 0&&(R.start=Y.start,R.end=Y.end);for(var q=0;q<Y.length;q+=3)R.push(Y[q]+P,Y[q+1],Y[q+2]);return R}function po(Y,P){if(Y.transformed)return Y;var R,q,J,ae=1<<Y.z,_e=Y.x,fe=Y.y;for(R=0;R<Y.features.length;R++){var ce=Y.features[R],xe=ce.geometry,Pe=ce.type;if(ce.geometry=[],Pe===1)for(q=0;q<xe.length;q+=2)ce.geometry.push(fo(xe[q],xe[q+1],P,ae,_e,fe));else for(q=0;q<xe.length;q++){var Je=[];for(J=0;J<xe[q].length;J+=2)Je.push(fo(xe[q][J],xe[q][J+1],P,ae,_e,fe));ce.geometry.push(Je)}}return Y.transformed=!0,Y}function fo(Y,P,R,q,J,ae){return[Math.round(R*(Y*q-J)),Math.round(R*(P*q-ae))]}function Ea(Y,P,R,q,J){for(var ae=P===J.maxZoom?0:J.tolerance/((1<<P)*J.extent),_e={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:R,y:q,z:P,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},fe=0;fe<Y.length;fe++){_e.numFeatures++,ir(_e,Y[fe],ae,J);var ce=Y[fe].minX,xe=Y[fe].minY,Pe=Y[fe].maxX,Je=Y[fe].maxY;ce<_e.minX&&(_e.minX=ce),xe<_e.minY&&(_e.minY=xe),Pe>_e.maxX&&(_e.maxX=Pe),Je>_e.maxY&&(_e.maxY=Je)}return _e}function ir(Y,P,R,q){var J=P.geometry,ae=P.type,_e=[];if(ae==="Point"||ae==="MultiPoint")for(var fe=0;fe<J.length;fe+=3)_e.push(J[fe]),_e.push(J[fe+1]),Y.numPoints++,Y.numSimplified++;else if(ae==="LineString")Or(_e,J,Y,R,!1,!1);else if(ae==="MultiLineString"||ae==="Polygon")for(fe=0;fe<J.length;fe++)Or(_e,J[fe],Y,R,ae==="Polygon",fe===0);else if(ae==="MultiPolygon")for(var ce=0;ce<J.length;ce++){var xe=J[ce];for(fe=0;fe<xe.length;fe++)Or(_e,xe[fe],Y,R,!0,fe===0)}if(_e.length){var Pe=P.tags||null;if(ae==="LineString"&&q.lineMetrics){for(var Je in Pe={},P.tags)Pe[Je]=P.tags[Je];Pe.mapbox_clip_start=J.start/J.size,Pe.mapbox_clip_end=J.end/J.size}var Re={geometry:_e,type:ae==="Polygon"||ae==="MultiPolygon"?3:ae==="LineString"||ae==="MultiLineString"?2:1,tags:Pe};P.id!==null&&(Re.id=P.id),Y.features.push(Re)}}function Or(Y,P,R,q,J,ae){var _e=q*q;if(q>0&&P.size<(J?_e:q))R.numPoints+=P.length/3;else{for(var fe=[],ce=0;ce<P.length;ce+=3)(q===0||P[ce+2]>_e)&&(R.numSimplified++,fe.push(P[ce]),fe.push(P[ce+1])),R.numPoints++;J&&function(xe,Pe){for(var Je=0,Re=0,Tt=xe.length,_t=Tt-2;Re<Tt;_t=Re,Re+=2)Je+=(xe[Re]-xe[_t])*(xe[Re+1]+xe[_t+1]);if(Je>0===Pe)for(Re=0,Tt=xe.length;Re<Tt/2;Re+=2){var gt=xe[Re],St=xe[Re+1];xe[Re]=xe[Tt-2-Re],xe[Re+1]=xe[Tt-1-Re],xe[Tt-2-Re]=gt,xe[Tt-1-Re]=St}}(fe,ae),Y.push(fe)}}function mo(Y,P){var R=(P=this.options=function(J,ae){for(var _e in ae)J[_e]=ae[_e];return J}(Object.create(this.options),P)).debug;if(R&&console.time("preprocess data"),P.maxZoom<0||P.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(P.promoteId&&P.generateId)throw new Error("promoteId and generateId cannot be used together.");var q=function(J,ae){var _e=[];if(J.type==="FeatureCollection")for(var fe=0;fe<J.features.length;fe++)Ge(_e,J.features[fe],ae,fe);else Ge(_e,J.type==="Feature"?J:{geometry:J},ae);return _e}(Y,P);this.tiles={},this.tileCoords=[],R&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",P.indexMaxZoom,P.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(q=function(J,ae){var _e=ae.buffer/ae.extent,fe=J,ce=ei(J,1,-1-_e,_e,0,-1,2,ae),xe=ei(J,1,1-_e,2+_e,0,-1,2,ae);return(ce||xe)&&(fe=ei(J,1,-_e,1+_e,0,-1,2,ae)||[],ce&&(fe=$i(ce,1).concat(fe)),xe&&(fe=fe.concat($i(xe,-1)))),fe}(q,P)).length&&this.splitTile(q,0,0,0),R&&(q.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function _o(Y,P,R){return 32*((1<<Y)*R+P)+Y}function Go(Y,P){const R=Y.tileID.canonical;if(!this._geoJSONIndex)return P(null,null);const q=this._geoJSONIndex.getTile(R.z,R.x,R.y);if(!q)return P(null,null);const J=new ke(q.features);let ae=At(J);ae.byteOffset===0&&ae.byteLength===ae.buffer.byteLength||(ae=new Uint8Array(ae)),P(null,{vectorTile:J,rawData:ae.buffer})}mo.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},mo.prototype.splitTile=function(Y,P,R,q,J,ae,_e){for(var fe=[Y,P,R,q],ce=this.options,xe=ce.debug;fe.length;){q=fe.pop(),R=fe.pop(),P=fe.pop(),Y=fe.pop();var Pe=1<<P,Je=_o(P,R,q),Re=this.tiles[Je];if(!Re&&(xe>1&&console.time("creation"),Re=this.tiles[Je]=Ea(Y,P,R,q,ce),this.tileCoords.push({z:P,x:R,y:q}),xe)){xe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",P,R,q,Re.numFeatures,Re.numPoints,Re.numSimplified),console.timeEnd("creation"));var Tt="z"+P;this.stats[Tt]=(this.stats[Tt]||0)+1,this.total++}if(Re.source=Y,J){if(P===ce.maxZoom||P===J)continue;var _t=1<<J-P;if(R!==Math.floor(ae/_t)||q!==Math.floor(_e/_t))continue}else if(P===ce.indexMaxZoom||Re.numPoints<=ce.indexMaxPoints)continue;if(Re.source=null,Y.length!==0){xe>1&&console.time("clipping");var gt,St,ve,ni,ct,ti,ri=.5*ce.buffer/ce.extent,go=.5-ri,wr=.5+ri,Qe=1+ri;gt=St=ve=ni=null,ct=ei(Y,Pe,R-ri,R+wr,0,Re.minX,Re.maxX,ce),ti=ei(Y,Pe,R+go,R+Qe,0,Re.minX,Re.maxX,ce),Y=null,ct&&(gt=ei(ct,Pe,q-ri,q+wr,1,Re.minY,Re.maxY,ce),St=ei(ct,Pe,q+go,q+Qe,1,Re.minY,Re.maxY,ce),ct=null),ti&&(ve=ei(ti,Pe,q-ri,q+wr,1,Re.minY,Re.maxY,ce),ni=ei(ti,Pe,q+go,q+Qe,1,Re.minY,Re.maxY,ce),ti=null),xe>1&&console.timeEnd("clipping"),fe.push(gt||[],P+1,2*R,2*q),fe.push(St||[],P+1,2*R,2*q+1),fe.push(ve||[],P+1,2*R+1,2*q),fe.push(ni||[],P+1,2*R+1,2*q+1)}}},mo.prototype.getTile=function(Y,P,R){var q=this.options,J=q.extent,ae=q.debug;if(Y<0||Y>24)return null;var _e=1<<Y,fe=_o(Y,P=(P%_e+_e)%_e,R);if(this.tiles[fe])return po(this.tiles[fe],J);ae>1&&console.log("drilling down to z%d-%d-%d",Y,P,R);for(var ce,xe=Y,Pe=P,Je=R;!ce&&xe>0;)xe--,Pe=Math.floor(Pe/2),Je=Math.floor(Je/2),ce=this.tiles[_o(xe,Pe,Je)];return ce&&ce.source?(ae>1&&console.log("found parent tile z%d-%d-%d",xe,Pe,Je),ae>1&&console.time("drilling down"),this.splitTile(ce.source,xe,Pe,Je,Y,P,R),ae>1&&console.timeEnd("drilling down"),this.tiles[fe]?po(this.tiles[fe],J):null):null};class Ds extends o.VectorTileWorkerSource{constructor(P,R,q,J,ae){super(P,R,q,J,Go),ae&&(this.loadGeoJSON=ae)}loadData(P,R){const q=P&&P.request,J=q&&q.collectResourceTiming;this.loadGeoJSON(P,(ae,_e)=>{if(ae||!_e)return R(ae);if(typeof _e!="object")return R(new Error(`Input data given to '${P.source}' is not a valid GeoJSON object.`));{se(_e,!0);try{if(P.filter){const ce=o.createExpression(P.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ce.result==="error")throw new Error(ce.value.map(Pe=>`${Pe.key}: ${Pe.message}`).join(", "));const xe=_e.features.filter(Pe=>ce.value.evaluate({zoom:0},Pe));_e={type:"FeatureCollection",features:xe}}this._geoJSONIndex=P.cluster?new tt(function({superclusterOptions:ce,clusterProperties:xe}){if(!xe||!ce)return ce;const Pe={},Je={},Re={accumulated:null,zoom:0},Tt={properties:null},_t=Object.keys(xe);for(const gt of _t){const[St,ve]=xe[gt],ni=o.createExpression(ve),ct=o.createExpression(typeof St=="string"?[St,["accumulated"],["get",gt]]:St);Pe[gt]=ni.value,Je[gt]=ct.value}return ce.map=gt=>{Tt.properties=gt;const St={};for(const ve of _t)St[ve]=Pe[ve].evaluate(Re,Tt);return St},ce.reduce=(gt,St)=>{Tt.properties=St;for(const ve of _t)Re.accumulated=gt[ve],gt[ve]=Je[ve].evaluate(Re,Tt)},ce}(P)).load(_e.features):function(ce,xe){return new mo(ce,xe)}(_e,P.geojsonVtOptions)}catch(ce){return R(ce)}this.loaded={};const fe={};if(J){const ce=o.getPerformanceMeasurement(q);ce&&(fe.resourceTiming={},fe.resourceTiming[P.source]=JSON.parse(JSON.stringify(ce)))}R(null,fe)}})}reloadTile(P,R){const q=this.loaded;return q&&q[P.uid]?super.reloadTile(P,R):this.loadTile(P,R)}loadGeoJSON(P,R){if(P.request)o.getJSON(P.request,R);else{if(typeof P.data!="string")return R(new Error(`Input data given to '${P.source}' is not a valid GeoJSON object.`));try{return R(null,JSON.parse(P.data))}catch{return R(new Error(`Input data given to '${P.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(P,R){try{R(null,this._geoJSONIndex.getClusterExpansionZoom(P.clusterId))}catch(q){R(q)}}getClusterChildren(P,R){try{R(null,this._geoJSONIndex.getChildren(P.clusterId))}catch(q){R(q)}}getClusterLeaves(P,R){try{R(null,this._geoJSONIndex.getLeaves(P.clusterId,P.limit,P.offset))}catch(q){R(q)}}}class Zo{constructor(P){this.self=P,this.actor=new o.Actor(P,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=o.getProjection({name:"mercator"}),this.workerSourceTypes={vector:o.VectorTileWorkerSource,geojson:Ds},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(R,q)=>{if(this.workerSourceTypes[R])throw new Error(`Worker source with name "${R}" already registered.`);this.workerSourceTypes[R]=q},this.self.registerRTLTextPlugin=R=>{if(o.plugin.isParsed())throw new Error("RTL text plugin already registered.");o.plugin.applyArabicShaping=R.applyArabicShaping,o.plugin.processBidirectionalText=R.processBidirectionalText,o.plugin.processStyledBidirectionalText=R.processStyledBidirectionalText}}clearCaches(P,R,q){delete this.layerIndexes[P],delete this.availableImages[P],delete this.workerSources[P],delete this.demWorkerSources[P],q()}checkIfReady(P,R,q){q()}setReferrer(P,R){this.referrer=R}spriteLoaded(P,R){this.isSpriteLoaded[P]=R;for(const q in this.workerSources[P]){const J=this.workerSources[P][q];for(const ae in J)J[ae]instanceof o.VectorTileWorkerSource&&(J[ae].isSpriteLoaded=R,J[ae].fire(new o.Event("isSpriteLoaded")))}}setImages(P,R,q){this.availableImages[P]=R;for(const J in this.workerSources[P]){const ae=this.workerSources[P][J];for(const _e in ae)ae[_e].availableImages=R}q()}enableTerrain(P,R,q){this.terrain=R,q()}setProjection(P,R){this.projections[P]=o.getProjection(R)}setLayers(P,R,q){this.getLayerIndex(P).replace(R),q()}updateLayers(P,R,q){this.getLayerIndex(P).update(R.layers,R.removedIds),q()}loadTile(P,R,q){const J=this.enableTerrain?o.extend({enableTerrain:this.terrain},R):R;J.projection=this.projections[P]||this.defaultProjection,this.getWorkerSource(P,R.type,R.source).loadTile(J,q)}loadDEMTile(P,R,q){const J=this.enableTerrain?o.extend({buildQuadTree:this.terrain},R):R;this.getDEMWorkerSource(P,R.source).loadTile(J,q)}reloadTile(P,R,q){const J=this.enableTerrain?o.extend({enableTerrain:this.terrain},R):R;J.projection=this.projections[P]||this.defaultProjection,this.getWorkerSource(P,R.type,R.source).reloadTile(J,q)}abortTile(P,R,q){this.getWorkerSource(P,R.type,R.source).abortTile(R,q)}removeTile(P,R,q){this.getWorkerSource(P,R.type,R.source).removeTile(R,q)}removeSource(P,R,q){if(!this.workerSources[P]||!this.workerSources[P][R.type]||!this.workerSources[P][R.type][R.source])return;const J=this.workerSources[P][R.type][R.source];delete this.workerSources[P][R.type][R.source],J.removeSource!==void 0?J.removeSource(R,q):q()}loadWorkerSource(P,R,q){try{this.self.importScripts(R.url),q()}catch(J){q(J.toString())}}syncRTLPluginState(P,R,q){try{o.plugin.setState(R);const J=o.plugin.getPluginURL();if(o.plugin.isLoaded()&&!o.plugin.isParsed()&&J!=null){this.self.importScripts(J);const ae=o.plugin.isParsed();q(ae?void 0:new Error(`RTL Text Plugin failed to import scripts from ${J}`),ae)}}catch(J){q(J.toString())}}getAvailableImages(P){let R=this.availableImages[P];return R||(R=[]),R}getLayerIndex(P){let R=this.layerIndexes[P];return R||(R=this.layerIndexes[P]=new te),R}getWorkerSource(P,R,q){return this.workerSources[P]||(this.workerSources[P]={}),this.workerSources[P][R]||(this.workerSources[P][R]={}),this.workerSources[P][R][q]||(this.workerSources[P][R][q]=new this.workerSourceTypes[R]({send:(J,ae,_e,fe,ce,xe)=>{this.actor.send(J,ae,_e,P,ce,xe)},scheduler:this.actor.scheduler},this.getLayerIndex(P),this.getAvailableImages(P),this.isSpriteLoaded[P])),this.workerSources[P][R][q]}getDEMWorkerSource(P,R){return this.demWorkerSources[P]||(this.demWorkerSources[P]={}),this.demWorkerSources[P][R]||(this.demWorkerSources[P][R]=new Z),this.demWorkerSources[P][R]}enforceCacheSizeLimit(P,R){o.enforceCacheSizeLimit(R)}getWorkerPerformanceMetrics(P,R,q){q(void 0,void 0)}}return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new Zo(self)),Zo}),I(["./shared"],function(o){var U=oe;function oe(l){return!function(t){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var h,m,_=new Blob([""],{type:"text/javascript"}),x=URL.createObjectURL(_);try{m=new Worker(x),h=!0}catch{h=!1}return m&&m.terminate(),URL.revokeObjectURL(x),h}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var h=document.createElement("canvas");h.width=h.height=1;var m=h.getContext("2d");if(!m)return!1;var _=m.getImageData(0,0,1,1);return _&&_.width===h.width}()?(te[s=t&&t.failIfMajorPerformanceCaveat]===void 0&&(te[s]=function(h){var m,_=function(x){var A=document.createElement("canvas"),C=Object.create(oe.webGLContextAttributes);return C.failIfMajorPerformanceCaveat=x,A.getContext("webgl",C)||A.getContext("experimental-webgl",C)}(h);if(!_)return!1;try{m=_.createShader(_.VERTEX_SHADER)}catch{return!1}return!(!m||_.isContextLost())&&(_.shaderSource(m,"void main() {}"),_.compileShader(m),_.getShaderParameter(m,_.COMPILE_STATUS)===!0)}(s)),te[s]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var s}(l)}var te={};function Z(l,t){if(Array.isArray(l)){if(!Array.isArray(t)||l.length!==t.length)return!1;for(let s=0;s<l.length;s++)if(!Z(l[s],t[s]))return!1;return!0}if(typeof l=="object"&&l!==null&&t!==null){if(typeof t!="object"||Object.keys(l).length!==Object.keys(t).length)return!1;for(const s in l)if(!Z(l[s],t[s]))return!1;return!0}return l===t}function se(l,t,s){const h=o.window.document.createElement(l);return t!==void 0&&(h.className=t),s&&s.appendChild(h),h}function me(l,t,s){const h=o.window.document.createElementNS("http://www.w3.org/2000/svg",l);for(const m of Object.keys(t))h.setAttributeNS(null,m,t[m]);return s&&s.appendChild(h),h}oe.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const Ye=o.window.document&&o.window.document.documentElement.style,ft=Ye&&Ye.userSelect!==void 0?"userSelect":"WebkitUserSelect";let Fe;function ke(){Ye&&ft&&(Fe=Ye[ft],Ye[ft]="none")}function Xe(){Ye&&ft&&(Ye[ft]=Fe)}function vt(l){l.preventDefault(),l.stopPropagation(),o.window.removeEventListener("click",vt,!0)}function Dt(){o.window.addEventListener("click",vt,!0),o.window.setTimeout(()=>{o.window.removeEventListener("click",vt,!0)},0)}function Ut(l,t){const s=l.getBoundingClientRect();return Li(l,s,t)}function At(l,t){const s=l.getBoundingClientRect(),h=[];for(let m=0;m<t.length;m++)h.push(Li(l,s,t[m]));return h}function Ci(l){return o.window.InstallTrigger!==void 0&&l.button===2&&l.ctrlKey&&o.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:l.button}function Li(l,t,s){const h=l.offsetWidth===t.width?1:l.offsetWidth/t.width;return new o.pointGeometry((s.clientX-t.left)*h,(s.clientY-t.top)*h)}function zi(l,t){var s=t[0],h=t[1],m=t[2],_=t[3],x=s*_-m*h;return x?(l[0]=_*(x=1/x),l[1]=-h*x,l[2]=-m*x,l[3]=s*x,l):null}function xn(l){const{userImage:t}=l;return!!(t&&t.render&&t.render())&&(l.data.replace(new Uint8Array(t.data.buffer)),!0)}class yi extends o.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:s,callback:h}of this.requestors)this._notify(s,h);this.requestors=[]}}hasImage(t){return!!this.getImage(t)}getImage(t){return this.images[t]}addImage(t,s){this._validate(t,s)&&(this.images[t]=s)}_validate(t,s){let h=!0;return this._validateStretch(s.stretchX,s.data&&s.data.width)||(this.fire(new o.ErrorEvent(new Error(`Image "${t}" has invalid "stretchX" value`))),h=!1),this._validateStretch(s.stretchY,s.data&&s.data.height)||(this.fire(new o.ErrorEvent(new Error(`Image "${t}" has invalid "stretchY" value`))),h=!1),this._validateContent(s.content,s)||(this.fire(new o.ErrorEvent(new Error(`Image "${t}" has invalid "content" value`))),h=!1),h}_validateStretch(t,s){if(!t)return!0;let h=0;for(const m of t){if(m[0]<h||m[1]<m[0]||s<m[1])return!1;h=m[1]}return!0}_validateContent(t,s){return!(t&&(t.length!==4||t[0]<0||s.data.width<t[0]||t[1]<0||s.data.height<t[1]||t[2]<0||s.data.width<t[2]||t[3]<0||s.data.height<t[3]||t[2]<t[0]||t[3]<t[1]))}updateImage(t,s){s.version=this.images[t].version+1,this.images[t]=s,this.updatedImages[t]=!0}removeImage(t){const s=this.images[t];delete this.images[t],delete this.patterns[t],s.userImage&&s.userImage.onRemove&&s.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t,s){let h=!0;if(!this.isLoaded())for(const m of t)this.images[m]||(h=!1);this.isLoaded()||h?this._notify(t,s):this.requestors.push({ids:t,callback:s})}_notify(t,s){const h={};for(const m of t){this.images[m]||this.fire(new o.Event("styleimagemissing",{id:m}));const _=this.images[m];_?h[m]={data:_.data.clone(),pixelRatio:_.pixelRatio,sdf:_.sdf,version:_.version,stretchX:_.stretchX,stretchY:_.stretchY,content:_.content,hasRenderCallback:Boolean(_.userImage&&_.userImage.render)}:o.warnOnce(`Image "${m}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}s(null,h)}getPixelSize(){const{width:t,height:s}=this.atlasImage;return{width:t,height:s}}getPattern(t){const s=this.patterns[t],h=this.getImage(t);if(!h)return null;if(s&&s.position.version===h.version)return s.position;if(s)s.position.version=h.version;else{const m={w:h.data.width+2,h:h.data.height+2,x:0,y:0},_=new o.ImagePosition(m,h);this.patterns[t]={bin:m,position:_}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const s=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new o.Texture(t,this.atlasImage,s.RGBA),this.atlasTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const _ in this.patterns)t.push(this.patterns[_].bin);const{w:s,h}=o.potpack(t),m=this.atlasImage;m.resize({width:s||1,height:h||1});for(const _ in this.patterns){const{bin:x}=this.patterns[_],A=x.x+1,C=x.y+1,S=this.images[_].data,z=S.width,B=S.height;o.RGBAImage.copy(S,m,{x:0,y:0},{x:A,y:C},{width:z,height:B}),o.RGBAImage.copy(S,m,{x:0,y:B-1},{x:A,y:C-1},{width:z,height:1}),o.RGBAImage.copy(S,m,{x:0,y:0},{x:A,y:C+B},{width:z,height:1}),o.RGBAImage.copy(S,m,{x:z-1,y:0},{x:A-1,y:C},{width:1,height:B}),o.RGBAImage.copy(S,m,{x:0,y:0},{x:A+z,y:C},{width:1,height:B})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const s of t){if(this.callbackDispatchedThisFrame[s])continue;this.callbackDispatchedThisFrame[s]=!0;const h=this.images[s];xn(h)&&this.updateImage(s,h)}}}const dn=new o.Properties({anchor:new o.DataConstantProperty(o.spec.light.anchor),position:new class{constructor(){this.specification=o.spec.light.position}possiblyEvaluate(l,t){return function([s,h,m]){const _=o.degToRad(h+90),x=o.degToRad(m);return{x:s*Math.cos(_)*Math.sin(x),y:s*Math.sin(_)*Math.sin(x),z:s*Math.cos(x),azimuthal:h,polar:m}}(l.expression.evaluate(t))}interpolate(l,t,s){return{x:o.number(l.x,t.x,s),y:o.number(l.y,t.y,s),z:o.number(l.z,t.z,s),azimuthal:o.number(l.azimuthal,t.azimuthal,s),polar:o.number(l.polar,t.polar,s)}}},color:new o.DataConstantProperty(o.spec.light.color),intensity:new o.DataConstantProperty(o.spec.light.intensity)}),Mn="-transition";class er extends o.Evented{constructor(t){super(),this._transitionable=new o.Transitionable(dn),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,s={}){if(!this._validate(o.validateLight,t,s))for(const h in t){const m=t[h];o.endsWith(h,Mn)?this._transitionable.setTransition(h.slice(0,-Mn.length),m):this._transitionable.setValue(h,m)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,s,h){return(!h||h.validate!==!1)&&o.emitValidationErrors(this,t.call(o.validateStyle,o.extend({value:s,style:{glyphs:!0,sprite:!0},styleSpec:o.spec})))}}const tr=new o.Properties({source:new o.DataConstantProperty(o.spec.terrain.source),exaggeration:new o.DataConstantProperty(o.spec.terrain.exaggeration)}),Ti="-transition";class hi extends o.Evented{constructor(t,s){super(),this._transitionable=new o.Transitionable(tr),this.set(t),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=s}get(){return this._transitionable.serialize()}set(t){for(const s in t){const h=t[s];o.endsWith(s,Ti)?this._transitionable.setTransition(s.slice(0,-Ti.length),h):this._transitionable.setValue(s,h)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}}function Kt(l,t,s,h){const m=o.smoothstep(45,65,s),[_,x]=Ui(l,h),A=o.length(t);let C=1-Math.min(1,Math.exp((A-_)/(x-_)*-6));return C*=C*C,C=Math.min(1,1.00747*C),C*m*l.alpha}function Ui(l,t){const s=.5/Math.tan(.5*t);return[l.range[0]+s,l.range[1]+s]}const Un=new o.Properties({range:new o.DataConstantProperty(o.spec.fog.range),color:new o.DataConstantProperty(o.spec.fog.color),"horizon-blend":new o.DataConstantProperty(o.spec.fog["horizon-blend"])}),Vi="-transition";class pn extends o.Evented{constructor(t,s){super(),this._transitionable=new o.Transitionable(Un),this.set(t),this._transitioning=this._transitionable.untransitioned(),this._transform=s}get state(){return{range:this.properties.get("range"),horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(t,s={}){if(!this._validate(o.validateFog,t,s))for(const h in t){const m=t[h];o.endsWith(h,Vi)?this._transitionable.setTransition(h.slice(0,-Vi.length),m):this._transitionable.setValue(h,m)}}getOpacity(t){if(!this._transform.projection.supportsFog)return 0;const s=this.properties&&this.properties.get("color")||1;return o.smoothstep(45,65,t)*s.a}getOpacityAtLatLng(t,s){return this._transform.projection.supportsFog?function(h,m,_){const x=o.MercatorCoordinate.fromLngLat(m),A=_.elevation?_.elevation.getAtPointOrZero(x):0,C=[x.x,x.y,A];return o.transformMat4(C,C,_.mercatorFogMatrix),Kt(h,C,_.pitch,_._fov)}(this.state,t,s):0}getFovAdjustedRange(t){return this._transform.projection.supportsFog?Ui(this.state,t):[0,1]}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,s,h){return(!h||h.validate!==!1)&&o.emitValidationErrors(this,t.call(o.validateStyle,o.extend({value:s,style:{glyphs:!0,sprite:!0},styleSpec:o.spec})))}}class Gt{constructor(t,s){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=o.uniqueId();const h=this.workerPool.acquire(this.id);for(let m=0;m<h.length;m++){const _=new Gt.Actor(h[m],s,this.id);_.name=`Worker ${m}`,this.actors.push(_)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(t,s,h){o.asyncAll(this.actors,(m,_)=>{m.send(t,s,_)},h=h||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(t=>{t.remove()}),this.actors=[],this.workerPool.release(this.id)}}function Wi(l,t,s){return t*(o.EXTENT/(l.tileSize*Math.pow(2,s-l.tileID.overscaledZ)))}Gt.Actor=o.Actor;class Le{constructor(t,s,h,m){this.screenBounds=t,this.cameraPoint=s,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=h,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this.screenGeometry.map(_=>m.pointCoordinate3D(_)),this.cameraGeometry=this.bufferedCameraGeometry(0)}static createFromScreenPoints(t,s){let h,m;if(t instanceof o.pointGeometry||typeof t[0]=="number"){const _=o.pointGeometry.convert(t);h=[o.pointGeometry.convert(t)],m=s.isPointAboveHorizon(_)}else{const _=o.pointGeometry.convert(t[0]),x=o.pointGeometry.convert(t[1]);h=[_,x],m=o.polygonizeBounds(_,x).every(A=>s.isPointAboveHorizon(A))}return new Le(h,s.getCameraPoint(),m,s)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(t){return o.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],t)}bufferedCameraGeometry(t){const s=this.screenBounds[0],h=this.screenBounds.length===1?this.screenBounds[0].add(new o.pointGeometry(1,1)):this.screenBounds[1],m=o.polygonizeBounds(s,h,0,!1);return this.cameraPoint.y>h.y&&(this.cameraPoint.x>s.x&&this.cameraPoint.x<h.x?m.splice(3,0,this.cameraPoint):this.cameraPoint.x>=h.x?m[2]=this.cameraPoint:this.cameraPoint.x<=s.x&&(m[3]=this.cameraPoint)),o.bufferConvexPolygon(m,t)}containsTile(t,s,h){const m=t.queryPadding+1,_=t.tileID.wrap,x=h?this._bufferedCameraMercator(m,s).map(V=>o.getTilePoint(t.tileTransform,V,_)):this._bufferedScreenMercator(m,s).map(V=>o.getTilePoint(t.tileTransform,V,_)),A=this.screenGeometryMercator.map(V=>o.getTileVec3(t.tileTransform,V,_)),C=A.map(V=>new o.pointGeometry(V[0],V[1])),S=s.getFreeCameraOptions().position||new o.MercatorCoordinate(0,0,0),z=o.getTileVec3(t.tileTransform,S,_),B=A.map(V=>{const O=o.sub(V,V,z);return o.normalize(O,O),new o.Ray(z,O)}),N=Wi(t,1,s.zoom);if(o.polygonIntersectsBox(x,0,0,o.EXTENT,o.EXTENT))return{queryGeometry:this,tilespaceGeometry:C,tilespaceRays:B,bufferedTilespaceGeometry:x,bufferedTilespaceBounds:(G=o.getBounds(x),G.min.x=o.clamp(G.min.x,0,o.EXTENT),G.min.y=o.clamp(G.min.y,0,o.EXTENT),G.max.x=o.clamp(G.max.x,0,o.EXTENT),G.max.y=o.clamp(G.max.y,0,o.EXTENT),G),tile:t,tileID:t.tileID,pixelToTileUnitsFactor:N};var G}_bufferedScreenMercator(t,s){const h=dt(t);if(this._screenRaycastCache[h])return this._screenRaycastCache[h];{const m=this.bufferedScreenGeometry(t).map(_=>s.pointCoordinate3D(_));return this._screenRaycastCache[h]=m,m}}_bufferedCameraMercator(t,s){const h=dt(t);if(this._cameraRaycastCache[h])return this._cameraRaycastCache[h];{const m=this.bufferedCameraGeometry(t).map(_=>s.pointCoordinate3D(_));return this._cameraRaycastCache[h]=m,m}}}function dt(l){return 100*l|0}function tt(l,t,s){const h=function(m,_){if(m)return s(m);if(_){const x=o.pick(o.extend(_,l),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);_.vector_layers&&(x.vectorLayers=_.vector_layers,x.vectorLayerIds=x.vectorLayers.map(A=>A.id)),x.tiles=t.canonicalizeTileset(x,l.url),s(null,x)}};return l.url?o.getJSON(t.transformRequest(t.normalizeSourceURL(l.url),o.ResourceType.Source),h):o.exported.frame(()=>h(null,l))}class wt{constructor(t,s,h){this.bounds=o.LngLatBounds.convert(this.validateBounds(t)),this.minzoom=s||0,this.maxzoom=h||24}validateBounds(t){return Array.isArray(t)&&t.length===4?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const s=Math.pow(2,t.z),h=Math.floor(o.mercatorXfromLng(this.bounds.getWest())*s),m=Math.floor(o.mercatorYfromLat(this.bounds.getNorth())*s),_=Math.ceil(o.mercatorXfromLng(this.bounds.getEast())*s),x=Math.ceil(o.mercatorYfromLat(this.bounds.getSouth())*s);return t.x>=h&&t.x<_&&t.y>=m&&t.y<x}}class di{constructor(t,s,h){this.context=t;const m=t.gl;this.buffer=m.createBuffer(),this.dynamicDraw=Boolean(h),this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),m.bufferData(m.ELEMENT_ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?m.DYNAMIC_DRAW:m.STATIC_DRAW),this.dynamicDraw||s.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const s=this.context.gl;this.context.unbindVAO(),this.bind(),s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const li={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Ot{constructor(t,s,h,m){this.length=s.length,this.attributes=h,this.itemSize=s.bytesPerElement,this.dynamicDraw=m,this.context=t;const _=t.gl;this.buffer=_.createBuffer(),t.bindVertexBuffer.set(this.buffer),_.bufferData(_.ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||s.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){const s=this.context.gl;this.bind(),s.bufferSubData(s.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,s){for(let h=0;h<this.attributes.length;h++){const m=s.attributes[this.attributes[h].name];m!==void 0&&t.enableVertexAttribArray(m)}}setVertexAttribPointers(t,s,h){for(let m=0;m<this.attributes.length;m++){const _=this.attributes[m],x=s.attributes[_.name];x!==void 0&&t.vertexAttribPointer(x,_.components,t[li[_.type]],!1,this.itemSize,_.offset+this.itemSize*(h||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class rt{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class ie extends rt{getDefault(){return o.Color.transparent}set(t){const s=this.current;(t.r!==s.r||t.g!==s.g||t.b!==s.b||t.a!==s.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class pe extends rt{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class Ee extends rt{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class Ne extends rt{getDefault(){return[!0,!0,!0,!0]}set(t){const s=this.current;(t[0]!==s[0]||t[1]!==s[1]||t[2]!==s[2]||t[3]!==s[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class ze extends rt{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class Ke extends rt{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class at extends rt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const s=this.current;(t.func!==s.func||t.ref!==s.ref||t.mask!==s.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class He extends rt{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const s=this.current;(t[0]!==s[0]||t[1]!==s[1]||t[2]!==s[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class $e extends rt{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;t?s.enable(s.STENCIL_TEST):s.disable(s.STENCIL_TEST),this.current=t,this.dirty=!1}}class Ge extends rt{getDefault(){return[0,1]}set(t){const s=this.current;(t[0]!==s[0]||t[1]!==s[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class Mt extends rt{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;t?s.enable(s.DEPTH_TEST):s.disable(s.DEPTH_TEST),this.current=t,this.dirty=!1}}class mt extends rt{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class Ct extends rt{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;t?s.enable(s.BLEND):s.disable(s.BLEND),this.current=t,this.dirty=!1}}class It extends rt{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const s=this.current;(t[0]!==s[0]||t[1]!==s[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class qt extends rt{getDefault(){return o.Color.transparent}set(t){const s=this.current;(t.r!==s.r||t.g!==s.g||t.b!==s.b||t.a!==s.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class ei extends rt{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class Xt extends rt{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;t?s.enable(s.CULL_FACE):s.disable(s.CULL_FACE),this.current=t,this.dirty=!1}}class ci extends rt{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class nn extends rt{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class vn extends rt{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class br extends rt{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class Ar extends rt{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const s=this.current;(t[0]!==s[0]||t[1]!==s[1]||t[2]!==s[2]||t[3]!==s[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class ho extends rt{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.bindFramebuffer(s.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class $i extends rt{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.bindRenderbuffer(s.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class rn extends rt{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.bindTexture(s.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class po extends rt{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.bindBuffer(s.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class fo extends rt{getDefault(){return null}set(t){const s=this.gl;s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Ea extends rt{constructor(t){super(t),this.vao=t.extVertexArrayObject}getDefault(){return null}set(t){this.vao&&(t!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(t),this.current=t,this.dirty=!1)}}class ir extends rt{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class Or extends rt{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class mo extends rt{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class _o extends rt{constructor(t,s){super(t),this.context=t,this.parent=s}getDefault(){return null}}class Go extends _o{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class Ds extends _o{attachment(){return this.gl.DEPTH_ATTACHMENT}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferRenderbuffer(s.FRAMEBUFFER,this.attachment(),s.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Zo extends Ds{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Y{constructor(t,s,h,m){this.context=t,this.width=s,this.height=h;const _=this.framebuffer=t.gl.createFramebuffer();this.colorAttachment=new Go(t,_),m&&(this.depthAttachment=new Ds(t,_))}destroy(){const t=this.context.gl,s=this.colorAttachment.get();if(s&&t.deleteTexture(s),this.depthAttachment){const h=this.depthAttachment.get();h&&t.deleteRenderbuffer(h)}t.deleteFramebuffer(this.framebuffer)}}class P{constructor(t){this.gl=t,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new ie(this),this.clearDepth=new pe(this),this.clearStencil=new Ee(this),this.colorMask=new Ne(this),this.depthMask=new ze(this),this.stencilMask=new Ke(this),this.stencilFunc=new at(this),this.stencilOp=new He(this),this.stencilTest=new $e(this),this.depthRange=new Ge(this),this.depthTest=new Mt(this),this.depthFunc=new mt(this),this.blend=new Ct(this),this.blendFunc=new It(this),this.blendColor=new qt(this),this.blendEquation=new ei(this),this.cullFace=new Xt(this),this.cullFaceSide=new ci(this),this.frontFace=new nn(this),this.program=new vn(this),this.activeTexture=new br(this),this.viewport=new Ar(this),this.bindFramebuffer=new ho(this),this.bindRenderbuffer=new $i(this),this.bindTexture=new rn(this),this.bindVertexBuffer=new po(this),this.bindElementBuffer=new fo(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Ea(this),this.pixelStoreUnpack=new ir(this),this.pixelStoreUnpackPremultiplyAlpha=new Or(this),this.pixelStoreUnpackFlipY=new mo(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extTextureHalfFloat=t.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(t.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=t.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=t.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,s){return new di(this,t,s)}createVertexBuffer(t,s,h){return new Ot(this,t,s,h)}createRenderbuffer(t,s,h){const m=this.gl,_=m.createRenderbuffer();return this.bindRenderbuffer.set(_),m.renderbufferStorage(m.RENDERBUFFER,t,s,h),this.bindRenderbuffer.set(null),_}createFramebuffer(t,s,h){return new Y(this,t,s,h)}clear({color:t,depth:s,stencil:h}){const m=this.gl;let _=0;t&&(_|=m.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),s!==void 0&&(_|=m.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(s),this.depthMask.set(!0)),h!==void 0&&(_|=m.STENCIL_BUFFER_BIT,this.clearStencil.set(h),this.stencilMask.set(255)),m.clear(_)}setCullFace(t){t.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){Z(t.blendFunction,o.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class R extends o.Evented{constructor(t,s,h,m){super(),this.id=t,this.dispatcher=h,this.setEventedParent(m),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.extend({type:"raster"},s),o.extend(this,o.pick(s,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=tt(this._options,this.map._requestManager,(t,s)=>{this._tileJSONRequest=null,this._loaded=!0,t?this.fire(new o.ErrorEvent(t)):s&&(o.extend(this,s),s.bounds&&(this.tileBounds=new wt(s.bounds,this.minzoom,this.maxzoom)),o.postTurnstileEvent(s.tiles),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return o.extend({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t,s){const h=o.exported.devicePixelRatio>=2,m=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),h,this.tileSize);t.request=o.getImage(this.map._requestManager.transformRequest(m,o.ResourceType.Tile),(_,x,A,C)=>(delete t.request,t.aborted?(t.state="unloaded",s(null)):_?(t.state="errored",s(_)):x?(this.map._refreshExpiredTiles&&t.setExpiryData({cacheControl:A,expires:C}),t.setTexture(x,this.map.painter),t.state="loaded",o.cacheEntryPossiblyAdded(this.dispatcher),void s(null)):s(null)))}static loadTileData(t,s,h){t.setTexture(s,h)}static unloadTileData(t,s){t.texture&&s.saveTileTexture(t.texture)}abortTile(t,s){t.request&&(t.request.cancel(),delete t.request),s()}unloadTile(t,s){t.texture&&this.map.painter.saveTileTexture(t.texture),s()}hasTransition(){return!1}}let q;function J(l,t,s,h,m,_,x,A){const C=[l,s,m,t,h,_,1,1,1],S=[x,A,1],z=o.adjoint([],C),[B,N,G]=o.transformMat3(S,S,o.transpose(z,z));return o.multiply(C,[B,0,0,0,N,0,0,0,G],C)}class ae extends o.Evented{constructor(t,s,h,m){super(),this.id=t,this.dispatcher=h,this.coordinates=s.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(m),this.options=s}load(t){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this.url=this.options.url,o.getImage(this.map._requestManager.transformRequest(this.url,o.ResourceType.Image),(s,h)=>{if(this._loaded=!0,s)this.fire(new o.ErrorEvent(s));else if(h){const{HTMLImageElement:m}=o.window;this.image=h instanceof m?o.exported.getImageData(h):h,this.width=this.image.width,this.height=this.image.height,t&&(this.coordinates=t),this._finishLoading()}})}loaded(){return this._loaded}updateImage(t){return this.image&&t.url?(this.options.url=t.url,this.load(t.coordinates),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this.texture&&this.texture.destroy()}setCoordinates(t){this.coordinates=t,this._boundsArray=void 0;const s=t.map(o.MercatorCoordinate.fromLngLat);return this.tileID=function(h){let m=1/0,_=1/0,x=-1/0,A=-1/0;for(const B of h)m=Math.min(m,B.x),_=Math.min(_,B.y),x=Math.max(x,B.x),A=Math.max(A,B.y);const C=Math.max(x-m,A-_),S=Math.max(0,Math.floor(-Math.log(C)/Math.LN2)),z=Math.pow(2,S);return new o.CanonicalTileID(S,Math.floor((m+x)/2*z),Math.floor((_+A)/2*z))}(s),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(t){for(const C in this.tiles){const S=this.tiles[C];S.state!=="loaded"&&(S.state="loaded",S.texture=this.texture)}if(this._boundsArray)return;const s=o.tileTransform(this.tileID,this.map.transform.projection),[h,m,_,x]=this.coordinates.map(C=>{const S=s.projection.project(C[0],C[1]);return o.getTilePoint(s,S)._round()});this.perspectiveTransform=function(C,S,z,B,N,G,V,O,$,W){const Q=J(0,0,C,0,0,S,C,S),K=J(z,B,N,G,V,O,$,W);return o.multiply(K,o.adjoint(Q,Q),K),[K[6]/K[8]*C/o.EXTENT,K[7]/K[8]*S/o.EXTENT]}(this.width,this.height,h.x,h.y,m.x,m.y,x.x,x.y,_.x,_.y);const A=this._boundsArray=new o.StructArrayLayout4i8;A.emplaceBack(h.x,h.y,0,0),A.emplaceBack(m.x,m.y,o.EXTENT,0),A.emplaceBack(x.x,x.y,0,o.EXTENT),A.emplaceBack(_.x,_.y,o.EXTENT,o.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=t.createVertexBuffer(A,o.boundsAttributes.members),this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const t=this.map.painter.context,s=t.gl;this.texture?this.texture.update(this.image):(this.texture=new o.Texture(t,this.image,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE)),this._prepareData(t)}loadTile(t,s){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},s(null)):(t.state="errored",s(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const _e={vector:class extends o.Evented{constructor(l,t,s,h){if(super(),this.id=l,this.dispatcher=s,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.extend(this,o.pick(t,["url","scheme","tileSize","promoteId"])),this._options=o.extend({type:"vector"},t),this._collectResourceTiming=t.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(h),this._tileWorkers={},this._deduped=new o.DedupedRequest}load(){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=tt(this._options,this.map._requestManager,(l,t)=>{this._tileJSONRequest=null,this._loaded=!0,l?this.fire(new o.ErrorEvent(l)):t&&(o.extend(this,t),t.bounds&&(this.tileBounds=new wt(t.bounds,this.minzoom,this.maxzoom)),o.postTurnstileEvent(t.tiles,this.map._requestManager._customAccessToken),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}onAdd(l){this.map=l,this.load()}setSourceProperty(l){this._tileJSONRequest&&this._tileJSONRequest.cancel(),l();const t=this.map.style._getSourceCaches(this.id);for(const s of t)s.clearTiles();this.load()}setTiles(l){return this.setSourceProperty(()=>{this._options.tiles=l}),this}setUrl(l){return this.setSourceProperty(()=>{this.url=l,this._options.url=l}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return o.extend({},this._options)}loadTile(l,t){const s=this.map._requestManager.normalizeTileURL(l.tileID.canonical.url(this.tiles,this.scheme)),h={request:this.map._requestManager.transformRequest(s,o.ResourceType.Tile),data:void 0,uid:l.uid,tileID:l.tileID,tileZoom:l.tileZoom,zoom:l.tileID.overscaledZ,tileSize:this.tileSize*l.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:o.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:l.isSymbolTile};if(h.request.collectResourceTiming=this._collectResourceTiming,l.actor&&l.state!=="expired")l.state==="loading"?l.reloadCallback=t:l.request=l.actor.send("reloadTile",h,m.bind(this));else if(l.actor=this._tileWorkers[s]=this._tileWorkers[s]||this.dispatcher.getActor(),this.dispatcher.ready)l.request=l.actor.send("loadTile",h,m.bind(this),void 0,!0);else{const _=o.loadVectorTile.call({deduped:this._deduped},h,(x,A)=>{x||!A?m.call(this,x):(h.data={cacheControl:A.cacheControl,expires:A.expires,rawData:A.rawData.slice(0)},l.actor&&l.actor.send("loadTile",h,m.bind(this),void 0,!0))},!0);l.request={cancel:_}}function m(_,x){return delete l.request,l.aborted?t(null):_&&_.status!==404?t(_):(x&&x.resourceTiming&&(l.resourceTiming=x.resourceTiming),this.map._refreshExpiredTiles&&x&&l.setExpiryData(x),l.loadVectorData(x,this.map.painter),o.cacheEntryPossiblyAdded(this.dispatcher),t(null),void(l.reloadCallback&&(this.loadTile(l,l.reloadCallback),l.reloadCallback=null)))}}abortTile(l){l.request&&(l.request.cancel(),delete l.request),l.actor&&l.actor.send("abortTile",{uid:l.uid,type:this.type,source:this.id})}unloadTile(l){l.unloadVectorData(),l.actor&&l.actor.send("removeTile",{uid:l.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}},raster:R,"raster-dem":class extends R{constructor(l,t,s,h){super(l,t,s,h),this.type="raster-dem",this.maxzoom=22,this._options=o.extend({type:"raster-dem"},t),this.encoding=t.encoding||"mapbox"}loadTile(l,t){const s=this.map._requestManager.normalizeTileURL(l.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function h(m,_){m&&(l.state="errored",t(m)),_&&(l.dem=_,l.dem.onDeserialize(),l.needsHillshadePrepare=!0,l.needsDEMTextureUpload=!0,l.state="loaded",t(null))}l.request=o.getImage(this.map._requestManager.transformRequest(s,o.ResourceType.Tile),function(m,_,x,A){if(delete l.request,l.aborted)l.state="unloaded",t(null);else if(m)l.state="errored",t(m);else if(_){this.map._refreshExpiredTiles&&l.setExpiryData({cacheControl:x,expires:A});const C=o.window.ImageBitmap&&_ instanceof o.window.ImageBitmap&&(q==null&&(q=o.window.OffscreenCanvas&&new o.window.OffscreenCanvas(1,1).getContext("2d")&&typeof o.window.createImageBitmap=="function"),q),S=1-(_.width-o.prevPowerOfTwo(_.width))/2;S<1||l.neighboringTiles||(l.neighboringTiles=this._getNeighboringTiles(l.tileID));const z=C?_:o.exported.getImageData(_,S),B={uid:l.uid,coord:l.tileID,source:this.id,rawImageData:z,encoding:this.encoding,padding:S};l.actor&&l.state!=="expired"||(l.actor=this.dispatcher.getActor(),l.actor.send("loadDEMTile",B,h.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(l){const t=l.canonical,s=Math.pow(2,t.z),h=(t.x-1+s)%s,m=t.x===0?l.wrap-1:l.wrap,_=(t.x+1+s)%s,x=t.x+1===s?l.wrap+1:l.wrap,A={};return A[new o.OverscaledTileID(l.overscaledZ,m,t.z,h,t.y).key]={backfilled:!1},A[new o.OverscaledTileID(l.overscaledZ,x,t.z,_,t.y).key]={backfilled:!1},t.y>0&&(A[new o.OverscaledTileID(l.overscaledZ,m,t.z,h,t.y-1).key]={backfilled:!1},A[new o.OverscaledTileID(l.overscaledZ,l.wrap,t.z,t.x,t.y-1).key]={backfilled:!1},A[new o.OverscaledTileID(l.overscaledZ,x,t.z,_,t.y-1).key]={backfilled:!1}),t.y+1<s&&(A[new o.OverscaledTileID(l.overscaledZ,m,t.z,h,t.y+1).key]={backfilled:!1},A[new o.OverscaledTileID(l.overscaledZ,l.wrap,t.z,t.x,t.y+1).key]={backfilled:!1},A[new o.OverscaledTileID(l.overscaledZ,x,t.z,_,t.y+1).key]={backfilled:!1}),A}unloadTile(l){l.demTexture&&this.map.painter.saveTileTexture(l.demTexture),l.fbo&&(l.fbo.destroy(),delete l.fbo),l.dem&&delete l.dem,delete l.neighboringTiles,l.state="unloaded"}},geojson:class extends o.Evented{constructor(l,t,s,h){super(),this.id=l,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=s.getActor(),this.setEventedParent(h),this._data=t.data,this._options=o.extend({},t),this._collectResourceTiming=t.collectResourceTiming,t.maxzoom!==void 0&&(this.maxzoom=t.maxzoom),t.type&&(this.type=t.type),t.attribution&&(this.attribution=t.attribution),this.promoteId=t.promoteId;const m=o.EXTENT/this.tileSize;this.workerOptions=o.extend({source:this.id,cluster:t.cluster||!1,geojsonVtOptions:{buffer:(t.buffer!==void 0?t.buffer:128)*m,tolerance:(t.tolerance!==void 0?t.tolerance:.375)*m,extent:o.EXTENT,maxZoom:this.maxzoom,lineMetrics:t.lineMetrics||!1,generateId:t.generateId||!1},superclusterOptions:{maxZoom:t.clusterMaxZoom!==void 0?t.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,t.clusterMinPoints||2),extent:o.EXTENT,radius:(t.clusterRadius!==void 0?t.clusterRadius:50)*m,log:!1,generateId:t.generateId||!1},clusterProperties:t.clusterProperties,filter:t.filter},t.workerOptions)}onAdd(l){this.map=l,this.setData(this._data)}setData(l){return this._data=l,this._updateWorkerData(),this}getClusterExpansionZoom(l,t){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:l,source:this.id},t),this}getClusterChildren(l,t){return this.actor.send("geojson.getClusterChildren",{clusterId:l,source:this.id},t),this}getClusterLeaves(l,t,s,h){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:l,limit:t,offset:s},h),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new o.Event("dataloading",{dataType:"source"})),this._loaded=!1;const l=o.extend({},this.workerOptions),t=this._data;typeof t=="string"?(l.request=this.map._requestManager.transformRequest(o.exported.resolveURL(t),o.ResourceType.Source),l.request.collectResourceTiming=this._collectResourceTiming):l.data=JSON.stringify(t),this._pendingLoad=this.actor.send(`${this.type}.loadData`,l,(s,h)=>{if(this._loaded=!0,this._pendingLoad=null,s)this.fire(new o.ErrorEvent(s));else{const m={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&h&&h.resourceTiming&&h.resourceTiming[this.id]&&(m.resourceTiming=h.resourceTiming[this.id]),this.fire(new o.Event("data",m)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(l,t){const s=l.actor?"reloadTile":"loadTile";l.actor=this.actor,l.request=this.actor.send(s,{type:this.type,uid:l.uid,tileID:l.tileID,tileZoom:l.tileZoom,zoom:l.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:o.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(h,m)=>(delete l.request,l.unloadVectorData(),l.aborted?t(null):h?t(h):(l.loadVectorData(m,this.map.painter,s==="reloadTile"),t(null))),void 0,s==="loadTile")}abortTile(l){l.request&&(l.request.cancel(),delete l.request),l.aborted=!0}unloadTile(l){l.unloadVectorData(),this.actor.send("removeTile",{uid:l.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return o.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends ae{constructor(l,t,s,h){super(l,t,s,h),this.roundZoom=!0,this.type="video",this.options=t}load(){this._loaded=!1;const l=this.options;this.urls=[];for(const t of l.urls)this.urls.push(this.map._requestManager.transformRequest(t,o.ResourceType.Source).url);o.getVideo(this.urls,(t,s)=>{this._loaded=!0,t?this.fire(new o.ErrorEvent(t)):s&&(this.video=s,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(l){if(this.video){const t=this.video.seekable;l<t.start(0)||l>t.end(0)?this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${t.start(0)} and ${t.end(0)}-second mark.`))):this.video.currentTime=l}}getVideo(){return this.video}onAdd(l){this.map||(this.map=l,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const l=this.map.painter.context,t=l.gl;this.texture?this.video.paused||(this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE),t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,this.video)):(this.texture=new o.Texture(l,this.video,t.RGBA),this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(l)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:ae,canvas:class extends ae{constructor(l,t,s,h){super(l,t,s,h),t.coordinates?Array.isArray(t.coordinates)&&t.coordinates.length===4&&!t.coordinates.some(m=>!Array.isArray(m)||m.length!==2||m.some(_=>typeof _!="number"))||this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${l}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${l}`,null,'missing required property "coordinates"'))),t.animate&&typeof t.animate!="boolean"&&this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${l}`,null,'optional "animate" property must be a boolean value'))),t.canvas?typeof t.canvas=="string"||t.canvas instanceof o.window.HTMLCanvasElement||this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${l}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${l}`,null,'missing required property "canvas"'))),this.options=t,this.animate=t.animate===void 0||t.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof o.window.HTMLCanvasElement?this.options.canvas:o.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(l){this.map=l,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let l=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,l=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,l=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const t=this.map.painter.context;this.texture?(l||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new o.Texture(t,this.canvas,t.gl.RGBA,{premultiply:!0}),this._prepareData(t)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const l of[this.canvas.width,this.canvas.height])if(isNaN(l)||l<=0)return!0;return!1}},custom:class extends o.Evented{constructor(l,t,s,h){super(),this.id=l,this.type="custom",this._dataType="raster",this._dispatcher=s,this._implementation=t,this.setEventedParent(h),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new o.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new o.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new wt(this._implementation.bounds,this.minzoom,this.maxzoom)),t.update=this._update.bind(this),t.coveringTiles=this._coveringTiles.bind(this),o.extend(this,o.pick(t,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return o.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(l){this._map=l,this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(l),this.load()}onRemove(l){this._implementation.onRemove&&this._implementation.onRemove(l)}hasTile(l){if(this._implementation.hasTile){const{x:t,y:s,z:h}=l.canonical;return this._implementation.hasTile({x:t,y:s,z:h})}return!this.tileBounds||this.tileBounds.contains(l.canonical)}loadTile(l,t){const{x:s,y:h,z:m}=l.tileID.canonical,_=new o.window.AbortController,x=this._implementation.loadTile({x:s,y:h,z:m},{signal:_.signal});if(!x)return this.loadTileData(l,{width:this.tileSize,height:this.tileSize,data:null}),l.state="loaded",t(null);x.cancel=()=>_.abort(),l.request=x.then(function(A){return delete l.request,l.aborted?(l.state="unloaded",t(null)):A?function(C){return C instanceof o.window.ImageData||C instanceof o.window.ImageBitmap||C instanceof o.window.HTMLCanvasElement}(A)?(this.loadTileData(l,A),l.state="loaded",void t(null)):(l.state="errored",t(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`))):(this.loadTileData(l,{width:this.tileSize,height:this.tileSize,data:null}),l.state="loaded",t(null))}.bind(this)).catch(A=>{A.code!==20&&(l.state="errored",t(A))})}loadTileData(l,t){R.loadTileData(l,t,this._map.painter)}unloadTileData(l){R.unloadTileData(l,this._map.painter)}prepareTile(l){if(!this._implementation.prepareTile)return null;const{x:t,y:s,z:h}=l.tileID.canonical,m=this._implementation.prepareTile({x:t,y:s,z:h});return m?(this.loadTileData(l,m),l.state="loaded",m):null}unloadTile(l,t){if(this.unloadTileData(l),this._implementation.unloadTile){const{x:s,y:h,z:m}=l.tileID.canonical;this._implementation.unloadTile({x:s,y:h,z:m})}t()}abortTile(l,t){l.request&&l.request.cancel&&(l.request.cancel(),delete l.request),t()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(l=>({x:l.canonical.x,y:l.canonical.y,z:l.canonical.z}))}_update(){this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"}))}}},fe=function(l,t,s,h){const m=new _e[t.type](l,t,s,h);if(m.id!==l)throw new Error(`Expected Source id to be ${l} instead of ${m.id}`);return o.bindAll(["load","abort","unload","serialize","prepare"],m),m};function ce(l,t){const s=o.identity([]);return o.scale(s,s,[.5*l.width,.5*-l.height,1]),o.translate(s,s,[1,-1,0]),o.multiply$1(s,s,l.calculateProjMatrix(t.toUnwrapped())),Float32Array.from(s)}function xe(l,t,s,h,m,_,x,A=!1){const C=l.tilesIn(h,x,A);C.sort(Je);const S=[];for(const B of C)S.push({wrappedTileID:B.tile.tileID.wrapped().key,queryResults:B.tile.queryRenderedFeatures(t,s,l._state,B,m,_,ce(l.transform,B.tile.tileID),A)});const z=function(B){const N={},G={};for(const V of B){const O=V.queryResults,$=V.wrappedTileID,W=G[$]=G[$]||{};for(const Q in O){const K=O[Q],ee=W[Q]=W[Q]||{},X=N[Q]=N[Q]||[];for(const re of K)ee[re.featureIndex]||(ee[re.featureIndex]=!0,X.push(re))}}return N}(S);for(const B in z)z[B].forEach(N=>{const G=N.feature,V=G.layer;V&&V.type!=="background"&&V.type!=="sky"&&(G.source=V.source,V["source-layer"]&&(G.sourceLayer=V["source-layer"]),G.state=G.id!==void 0?l.getFeatureState(V["source-layer"],G.id):{})});return z}function Pe(l,t){const s=l.getRenderableIds().map(_=>l.getTileByID(_)),h=[],m={};for(let _=0;_<s.length;_++){const x=s[_],A=x.tileID.canonical.key;m[A]||(m[A]=!0,x.querySourceFeatures(h,t))}return h}function Je(l,t){const s=l.tileID,h=t.tileID;return s.overscaledZ-h.overscaledZ||s.canonical.y-h.canonical.y||s.wrap-h.wrap||s.canonical.x-h.canonical.x}function Re(){return rs.workerClass!=null?new rs.workerClass:new o.window.Worker(rs.workerUrl)}const Tt="mapboxgl_preloaded_worker_pool";class _t{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<_t.workerCount;)this.workers.push(new Re);return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.numActive()===0&&(this.workers.forEach(s=>{s.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Tt]}numActive(){return Object.keys(this.active).length}}let gt;function St(){return gt||(gt=new _t),gt}function ve(l,t){const s={};for(const h in l)h!=="ref"&&(s[h]=l[h]);return o.refProperties.forEach(h=>{h in t&&(s[h]=t[h])}),s}function ni(l){l=l.slice();const t=Object.create(null);for(let s=0;s<l.length;s++)t[l[s].id]=l[s];for(let s=0;s<l.length;s++)"ref"in l[s]&&(l[s]=ve(l[s],t[l[s].ref]));return l}_t.workerCount=2;const ct={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function ti(l,t,s){s.push({command:ct.addSource,args:[l,t[l]]})}function ri(l,t,s){t.push({command:ct.removeSource,args:[l]}),s[l]=!0}function go(l,t,s,h){ri(l,s,h),ti(l,t,s)}function wr(l,t,s){let h;for(h in l[s])if(l[s].hasOwnProperty(h)&&h!=="data"&&!Z(l[s][h],t[s][h]))return!1;for(h in t[s])if(t[s].hasOwnProperty(h)&&h!=="data"&&!Z(l[s][h],t[s][h]))return!1;return!0}function Qe(l,t,s,h,m,_){let x;for(x in t=t||{},l=l||{})l.hasOwnProperty(x)&&(Z(l[x],t[x])||s.push({command:_,args:[h,x,t[x],m]}));for(x in t)t.hasOwnProperty(x)&&!l.hasOwnProperty(x)&&(Z(l[x],t[x])||s.push({command:_,args:[h,x,t[x],m]}))}function Ht(l){return l.id}function Vt(l,t){return l[t.id]=t,l}class _r{constructor(t,s){this.reset(t,s)}reset(t,s){this.points=t||[],this._distances=[0];for(let h=1;h<this.points.length;h++)this._distances[h]=this._distances[h-1]+this.points[h].dist(this.points[h-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(s||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(this.points.length===1)return this.points[0];t=o.clamp(t,0,1);let s=1,h=this._distances[s];const m=t*this.paddedLength+this.padding;for(;h<m&&s<this._distances.length;)h=this._distances[++s];const _=s-1,x=this._distances[_],A=h-x,C=A>0?(m-x)/A:0;return this.points[_].mult(1-C).add(this.points[s].mult(C))}}class yo{constructor(t,s,h){const m=this.boxCells=[],_=this.circleCells=[];this.xCellCount=Math.ceil(t/h),this.yCellCount=Math.ceil(s/h);for(let x=0;x<this.xCellCount*this.yCellCount;x++)m.push([]),_.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=s,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/s,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,s,h,m,_){this._forEachCell(s,h,m,_,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(s),this.bboxes.push(h),this.bboxes.push(m),this.bboxes.push(_)}insertCircle(t,s,h,m){this._forEachCell(s-m,h-m,s+m,h+m,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(s),this.circles.push(h),this.circles.push(m)}_insertBoxCell(t,s,h,m,_,x){this.boxCells[_].push(x)}_insertCircleCell(t,s,h,m,_,x){this.circleCells[_].push(x)}_query(t,s,h,m,_,x){if(h<0||t>this.width||m<0||s>this.height)return!_&&[];const A=[];if(t<=0&&s<=0&&this.width<=h&&this.height<=m){if(_)return!0;for(let C=0;C<this.boxKeys.length;C++)A.push({key:this.boxKeys[C],x1:this.bboxes[4*C],y1:this.bboxes[4*C+1],x2:this.bboxes[4*C+2],y2:this.bboxes[4*C+3]});for(let C=0;C<this.circleKeys.length;C++){const S=this.circles[3*C],z=this.circles[3*C+1],B=this.circles[3*C+2];A.push({key:this.circleKeys[C],x1:S-B,y1:z-B,x2:S+B,y2:z+B})}return x?A.filter(x):A}return this._forEachCell(t,s,h,m,this._queryCell,A,{hitTest:_,seenUids:{box:{},circle:{}}},x),_?A.length>0:A}_queryCircle(t,s,h,m,_){const x=t-h,A=t+h,C=s-h,S=s+h;if(A<0||x>this.width||S<0||C>this.height)return!m&&[];const z=[];return this._forEachCell(x,C,A,S,this._queryCellCircle,z,{hitTest:m,circle:{x:t,y:s,radius:h},seenUids:{box:{},circle:{}}},_),m?z.length>0:z}query(t,s,h,m,_){return this._query(t,s,h,m,!1,_)}hitTest(t,s,h,m,_){return this._query(t,s,h,m,!0,_)}hitTestCircle(t,s,h,m){return this._queryCircle(t,s,h,!0,m)}_queryCell(t,s,h,m,_,x,A,C){const S=A.seenUids,z=this.boxCells[_];if(z!==null){const N=this.bboxes;for(const G of z)if(!S.box[G]){S.box[G]=!0;const V=4*G;if(t<=N[V+2]&&s<=N[V+3]&&h>=N[V+0]&&m>=N[V+1]&&(!C||C(this.boxKeys[G]))){if(A.hitTest)return x.push(!0),!0;x.push({key:this.boxKeys[G],x1:N[V],y1:N[V+1],x2:N[V+2],y2:N[V+3]})}}}const B=this.circleCells[_];if(B!==null){const N=this.circles;for(const G of B)if(!S.circle[G]){S.circle[G]=!0;const V=3*G;if(this._circleAndRectCollide(N[V],N[V+1],N[V+2],t,s,h,m)&&(!C||C(this.circleKeys[G]))){if(A.hitTest)return x.push(!0),!0;{const O=N[V],$=N[V+1],W=N[V+2];x.push({key:this.circleKeys[G],x1:O-W,y1:$-W,x2:O+W,y2:$+W})}}}}}_queryCellCircle(t,s,h,m,_,x,A,C){const S=A.circle,z=A.seenUids,B=this.boxCells[_];if(B!==null){const G=this.bboxes;for(const V of B)if(!z.box[V]){z.box[V]=!0;const O=4*V;if(this._circleAndRectCollide(S.x,S.y,S.radius,G[O+0],G[O+1],G[O+2],G[O+3])&&(!C||C(this.boxKeys[V])))return x.push(!0),!0}}const N=this.circleCells[_];if(N!==null){const G=this.circles;for(const V of N)if(!z.circle[V]){z.circle[V]=!0;const O=3*V;if(this._circlesCollide(G[O],G[O+1],G[O+2],S.x,S.y,S.radius)&&(!C||C(this.circleKeys[V])))return x.push(!0),!0}}}_forEachCell(t,s,h,m,_,x,A,C){const S=this._convertToXCellCoord(t),z=this._convertToYCellCoord(s),B=this._convertToXCellCoord(h),N=this._convertToYCellCoord(m);for(let G=S;G<=B;G++)for(let V=z;V<=N;V++)if(_.call(this,t,s,h,m,this.xCellCount*V+G,x,A,C))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,s,h,m,_,x){const A=m-t,C=_-s,S=h+x;return S*S>A*A+C*C}_circleAndRectCollide(t,s,h,m,_,x,A){const C=(x-m)/2,S=Math.abs(t-(m+C));if(S>C+h)return!1;const z=(A-_)/2,B=Math.abs(s-(_+z));if(B>z+h)return!1;if(S<=C||B<=z)return!0;const N=S-C,G=B-z;return N*N+G*G<=h*h}}const Zt=Math.tan(85*Math.PI/180);function xo(l,t,s,h,m,_){const x=o.create();if(s){if(m.projection.name==="globe")o.multiply$1(x,x,o.calculateGlobeLabelMatrix(m,t));else{const A=zi([],_);x[0]=A[0],x[1]=A[1],x[4]=A[2],x[5]=A[3]}h||o.rotateZ(x,x,m.angle)}else o.multiply$1(x,m.labelPlaneMatrix,l);return x}function qo(l,t,s,h,m,_){if(s){if(m.projection.name==="globe"){const x=xo(l,t,s,h,m,_);return o.invert(x,x),o.multiply$1(x,l,x),x}{const x=o.clone(l),A=o.identity([]);return A[0]=_[0],A[1]=_[1],A[4]=_[2],A[5]=_[3],o.multiply$1(x,x,A),h||o.rotateZ(x,x,-m.angle),x}}return m.glCoordMatrix}function fn(l,t,s=0){const h=[l.x,l.y,s,1];s?o.transformMat4$1(h,h,t):Sn(h,h,t);const m=h[3];return{point:new o.pointGeometry(h[0]/m,h[1]/m),signedDistanceFromCamera:m}}function Vn(l,t){const s=[l[0],l[1],l[2],1];o.transformMat4$1(s,s,t);const h=s[3];return{point:new o.pointGeometry(s[0]/h,s[1]/h),signedDistanceFromCamera:h}}function Mi(l,t){return Math.min(.5+l/t*.5,1.5)}function Xd(l,t){const s=l[0]/l[3],h=l[1]/l[3];return s>=-t[0]&&s<=t[0]&&h>=-t[1]&&h<=t[1]}function Ps(l,t,s,h,m,_,x,A,C,S){const z=s.transform,B=h?l.textSizeData:l.iconSizeData,N=o.evaluateSizeForZoom(B,s.transform.zoom),G=[256/s.width*2+1,256/s.height*2+1],V=h?l.text.dynamicLayoutVertexArray:l.icon.dynamicLayoutVertexArray;V.clear();const O=l.lineVertexArray,$=h?l.text.placedSymbolArray:l.icon.placedSymbolArray,W=s.transform.width/s.transform.height;let Q=!1;for(let K=0;K<$.length;K++){const ee=$.get(K);if(ee.writingMode!==o.WritingMode.vertical||Q||K!==0&&$.get(K-1).writingMode===o.WritingMode.horizontal||(Q=!0),(ee.hidden||ee.writingMode===o.WritingMode.vertical)&&!Q){Hi(ee.numGlyphs,V);continue}Q=!1;const X=new o.pointGeometry(ee.tileAnchorX,ee.tileAnchorY),re=C?C(X):[0,0,0],ge=z.projection.projectTilePoint(X.x,X.y,S.canonical),Ae=[ge.x+re[0],ge.y+re[1],ge.z+re[2]],Se=[...Ae,1];if(o.transformMat4$1(Se,Se,t),!Xd(Se,G)){Hi(ee.numGlyphs,V);continue}const Ce=Mi(s.transform.cameraToCenterDistance,Se[3]),Ze=o.evaluateSizeForFeature(B,N,ee),ye=x?Ze/Ce:Ze*Ce,je=fn(new o.pointGeometry(Ae[0],Ae[1]),m,Ae[2]);if(je.signedDistanceFromCamera<=0){Hi(ee.numGlyphs,V);continue}let Ue={};const lt=x?null:C,we=Ma(ee,ye,!1,A,t,m,_,l.glyphOffsetArray,O,V,je.point,X,Ue,W,lt,z.projection,S);Q=we.useVertical,lt&&we.needsFlipping&&(Ue={}),(we.notEnoughRoom||Q||we.needsFlipping&&Ma(ee,ye,!0,A,t,m,_,l.glyphOffsetArray,O,V,je.point,X,Ue,W,lt,z.projection,S).notEnoughRoom)&&Hi(ee.numGlyphs,V)}h?l.text.dynamicLayoutVertexBuffer.updateData(V):l.icon.dynamicLayoutVertexBuffer.updateData(V)}function Ca(l,t,s,h,m,_,x,A,C,S,z,B,N,G,V){const O=A.glyphStartIndex+A.numGlyphs,$=A.lineStartIndex,W=A.lineStartIndex+A.lineLength,Q=t.getoffsetX(A.glyphStartIndex),K=t.getoffsetX(O-1),ee=Ho(l*Q,s,h,m,_,x,A.segment,$,W,C,S,z,B,N,!0,G,V);if(!ee)return null;const X=Ho(l*K,s,h,m,_,x,A.segment,$,W,C,S,z,B,N,!0,G,V);return X?{first:ee,last:X}:null}function Wo(l,t,s,h){return l.writingMode===o.WritingMode.horizontal&&Math.abs(s.y-t.y)>Math.abs(s.x-t.x)*h?{useVertical:!0}:l.writingMode===o.WritingMode.vertical?t.y<s.y?{needsFlipping:!0}:null:l.flipState!==0&&function(m,_,x){const A=(_.x-m.x)*x;return A===0||Math.abs((_.y-m.y)/A)>Zt}(t,s,h)?l.flipState===1?{needsFlipping:!0}:null:t.x>s.x?{needsFlipping:!0}:null}function Ma(l,t,s,h,m,_,x,A,C,S,z,B,N,G,V,O,$){const W=t/24,Q=l.lineOffsetX*W,K=l.lineOffsetY*W;let ee;if(l.numGlyphs>1){const X=l.glyphStartIndex+l.numGlyphs,re=l.lineStartIndex,ge=l.lineStartIndex+l.lineLength,Ae=Ca(W,A,Q,K,s,z,B,l,C,_,N,V,!1,O,$);if(!Ae)return{notEnoughRoom:!0};const Se=fn(Ae.first.point,x).point,Ce=fn(Ae.last.point,x).point;if(h&&!s){const Ze=Wo(l,Se,Ce,G);if(l.flipState=Ze&&Ze.needsFlipping?1:2,Ze)return Ze}ee=[Ae.first];for(let Ze=l.glyphStartIndex+1;Ze<X-1;Ze++)ee.push(Ho(W*A.getoffsetX(Ze),Q,K,s,z,B,l.segment,re,ge,C,_,N,V,!1,!1,O,$));ee.push(Ae.last)}else{if(h&&!s){const re=fn(B,m).point,ge=l.lineStartIndex+l.segment+1,Ae=new o.pointGeometry(C.getx(ge),C.gety(ge)),Se=fn(Ae,m),Ce=Wo(l,re,Se.signedDistanceFromCamera>0?Se.point:ii(B,Ae,re,1,m,void 0,O,$.canonical),G);if(l.flipState=Ce&&Ce.needsFlipping?1:2,Ce)return Ce}const X=Ho(W*A.getoffsetX(l.glyphStartIndex),Q,K,s,z,B,l.segment,l.lineStartIndex,l.lineStartIndex+l.lineLength,C,_,N,V,!1,!1,O,$);if(!X)return{notEnoughRoom:!0};ee=[X]}for(const X of ee)o.addDynamicAttributes(S,X.point,X.angle);return{}}function ql(l,t,s,h,m){const _=h.projectTilePoint(l.x,l.y,t);if(!m)return fn(_,s,_.z);const x=m(l);return fn(new o.pointGeometry(_.x+x[0],_.y+x[1]),s,_.z+x[2])}function ii(l,t,s,h,m,_,x,A){const C=ql(l.add(l.sub(t)._unit()),A,m,x,_).point,S=s.sub(C);return s.add(S._mult(h/S.mag()))}function Ho(l,t,s,h,m,_,x,A,C,S,z,B,N,G,V,O,$){const W=h?l-t:l+t;let Q=W>0?1:-1,K=0;h&&(Q*=-1,K=Math.PI),Q<0&&(K+=Math.PI);let ee=Q>0?A+x:A+x+1,X=m,re=m,ge=0,Ae=0;const Se=Math.abs(W),Ce=[],Ze=[];let ye=_;const je=()=>{const ot=ee-Q;return ge===0?_:new o.pointGeometry(S.getx(ot),S.gety(ot))},Ue=()=>ii(je(),ye,re,Se-ge+1,z,N,O,$.canonical);for(;ge+Ae<=Se;){if(ee+=Q,ee<A||ee>=C)return null;if(re=X,Ce.push(X),G&&Ze.push(ye||je()),X=B[ee],X===void 0){ye=new o.pointGeometry(S.getx(ee),S.gety(ee));const ot=ql(ye,$.canonical,z,O,N);X=ot.signedDistanceFromCamera>0?B[ee]=ot.point:Ue()}else ye=null;ge+=Ae,Ae=re.dist(X)}V&&N&&(ye=ye||new o.pointGeometry(S.getx(ee),S.gety(ee)),B[ee]=X=B[ee]===void 0?X:Ue(),Ae=re.dist(X));const lt=(Se-ge)/Ae,we=X.sub(re),pt=we.mult(lt)._add(re);s&&pt._add(we._unit()._perp()._mult(s*Q));const yt=K+Math.atan2(X.y-re.y,X.x-re.x);return Ce.push(pt),G&&(ye=ye||new o.pointGeometry(S.getx(ee),S.gety(ee)),Ze.push(function(ot,st,Et){const Ft=1-Et;return new o.pointGeometry(ot.x*Ft+st.x*Et,ot.y*Ft+st.y*Et)}(Ze.length>0?Ze[Ze.length-1]:ye,ye,lt))),{point:pt,angle:yt,path:Ce,tilePath:Ze}}const Wl=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Hi(l,t){for(let s=0;s<l;s++){const h=t.length;t.resize(h+4),t.float32.set(Wl,3*h)}}function Sn(l,t,s){const h=t[0],m=t[1];return l[0]=s[0]*h+s[4]*m+s[12],l[1]=s[1]*h+s[5]*m+s[13],l[3]=s[3]*h+s[7]*m+s[15],l}const nr=100;class Sa{constructor(t,s,h=new yo(t.width+200,t.height+200,25),m=new yo(t.width+200,t.height+200,25)){this.transform=t,this.grid=h,this.ignoredGrid=m,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+nr,this.screenBottomBoundary=t.height+nr,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.fogState=s}placeCollisionBox(t,s,h,m,_,x,A){let C=s.projectedAnchorX,S=s.projectedAnchorY,z=s.projectedAnchorZ;const B=s.elevation,N=s.tileID;if(B&&N){const ee=this.transform.projection.upVector(N.canonical,s.tileAnchorX,s.tileAnchorY),X=this.transform.projection.upVectorScale(N.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;C+=ee[0]*B*X,S+=ee[1]*B*X,z+=ee[2]*B*X}const G=this.projectAndGetPerspectiveRatio(x,[C,S,z],s.tileID,this.transform.projection.name==="globe"||!!B||this.transform.pitch>0),V=_*G.perspectiveRatio,O=(s.x1*t+h.x-s.padding)*V+G.point.x,$=(s.y1*t+h.y-s.padding)*V+G.point.y,W=(s.x2*t+h.x+s.padding)*V+G.point.x,Q=(s.y2*t+h.y+s.padding)*V+G.point.y,K=G.perspectiveRatio<=.55||G.occluded;return!this.isInsideGrid(O,$,W,Q)||!m&&this.grid.hitTest(O,$,W,Q,A)||K?{box:[],offscreen:!1,occluded:G.occluded}:{box:[O,$,W,Q],offscreen:this.isOffscreen(O,$,W,Q),occluded:!1}}placeCollisionCircles(t,s,h,m,_,x,A,C,S,z,B,N,G,V){const O=[],$=this.transform.elevation,W=$?$.getAtTileOffsetFunc(V,this.transform.center.lat,this.transform.worldSize,this.transform.projection):Ue=>[0,0,0],Q=new o.pointGeometry(s.tileAnchorX,s.tileAnchorY),K=this.transform.projection.projectTilePoint(s.tileAnchorX,s.tileAnchorY,V.canonical),ee=W(Q),X=[K.x+ee[0],K.y+ee[1],K.z+ee[2]],re=this.projectAndGetPerspectiveRatio(x,[X[0],X[1],X[2]],V,this.transform.projection.name==="globe"||!!$||this.transform.pitch>0),{perspectiveRatio:ge}=re,Ae=(z?_/ge:_*ge)/o.ONE_EM,Se=fn(new o.pointGeometry(X[0],X[1]),A,X[2]).point,Ce=re.signedDistanceFromCamera>0?Ca(Ae,m,s.lineOffsetX*Ae,s.lineOffsetY*Ae,!1,Se,Q,s,h,A,{},$&&!z?W:null,z&&!!$,this.transform.projection,V):null;let Ze=!1,ye=!1,je=!0;if(Ce&&!re.occluded){const Ue=.5*N*ge+G,lt=new o.pointGeometry(-100,-100),we=new o.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),pt=new _r,yt=Ce.first,ot=Ce.last;let st=[];for(let ht=yt.path.length-1;ht>=1;ht--)st.push(yt.path[ht]);for(let ht=1;ht<ot.path.length;ht++)st.push(ot.path[ht]);const Et=2.5*Ue;if(C){const ht=st.map($?(kt,$t)=>{const ki=W($t<yt.path.length-1?yt.tilePath[yt.path.length-1-$t]:ot.tilePath[$t-yt.path.length+2]);return fn(kt,C,ki[2])}:kt=>fn(kt,C));st=ht.some(kt=>kt.signedDistanceFromCamera<=0)?[]:ht.map(kt=>kt.point)}let Ft=[];if(st.length>0){const ht=st[0].clone(),kt=st[0].clone();for(let $t=1;$t<st.length;$t++)ht.x=Math.min(ht.x,st[$t].x),ht.y=Math.min(ht.y,st[$t].y),kt.x=Math.max(kt.x,st[$t].x),kt.y=Math.max(kt.y,st[$t].y);Ft=ht.x>=lt.x&&kt.x<=we.x&&ht.y>=lt.y&&kt.y<=we.y?[st]:kt.x<lt.x||ht.x>we.x||kt.y<lt.y||ht.y>we.y?[]:o.clipLine([st],lt.x,lt.y,we.x,we.y)}for(const ht of Ft){pt.reset(ht,.25*Ue);let kt=0;kt=pt.length<=.5*Ue?1:Math.ceil(pt.paddedLength/Et)+1;for(let $t=0;$t<kt;$t++){const ki=$t/Math.max(kt-1,1),an=pt.lerp(ki),ln=an.x+nr,Pn=an.y+nr;O.push(ln,Pn,Ue,0);const sr=ln-Ue,Ir=Pn-Ue,Hr=ln+Ue,zr=Pn+Ue;if(je=je&&this.isOffscreen(sr,Ir,Hr,zr),ye=ye||this.isInsideGrid(sr,Ir,Hr,zr),!t&&this.grid.hitTestCircle(ln,Pn,Ue,B)&&(Ze=!0,!S))return{circles:[],offscreen:!1,collisionDetected:Ze,occluded:!1}}}}return{circles:!S&&Ze||!ye?[]:O,offscreen:je,collisionDetected:Ze,occluded:re.occluded}}queryRenderedSymbols(t){if(t.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const s=[];let h=1/0,m=1/0,_=-1/0,x=-1/0;for(const z of t){const B=new o.pointGeometry(z.x+nr,z.y+nr);h=Math.min(h,B.x),m=Math.min(m,B.y),_=Math.max(_,B.x),x=Math.max(x,B.y),s.push(B)}const A=this.grid.query(h,m,_,x).concat(this.ignoredGrid.query(h,m,_,x)),C={},S={};for(const z of A){const B=z.key;if(C[B.bucketInstanceId]===void 0&&(C[B.bucketInstanceId]={}),C[B.bucketInstanceId][B.featureIndex])continue;const N=[new o.pointGeometry(z.x1,z.y1),new o.pointGeometry(z.x2,z.y1),new o.pointGeometry(z.x2,z.y2),new o.pointGeometry(z.x1,z.y2)];o.polygonIntersectsPolygon(s,N)&&(C[B.bucketInstanceId][B.featureIndex]=!0,S[B.bucketInstanceId]===void 0&&(S[B.bucketInstanceId]=[]),S[B.bucketInstanceId].push(B.featureIndex))}return S}insertCollisionBox(t,s,h,m,_){(s?this.ignoredGrid:this.grid).insert({bucketInstanceId:h,featureIndex:m,collisionGroupID:_},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,s,h,m,_){const x=s?this.ignoredGrid:this.grid,A={bucketInstanceId:h,featureIndex:m,collisionGroupID:_};for(let C=0;C<t.length;C+=4)x.insertCircle(A,t[C],t[C+1],t[C+2])}projectAndGetPerspectiveRatio(t,s,h,m){const _=[s[0],s[1],s[2],1];let x=!1;return s[2]||this.transform.pitch>0?(o.transformMat4$1(_,_,t),this.fogState&&h&&(x=function(A,C,S,z,B,N){const G=N.calculateFogTileMatrix(B),V=[C,S,z];return o.transformMat4(V,V,G),Kt(A,V,N.pitch,N._fov)}(this.fogState,s[0],s[1],s[2],h.toUnwrapped(),this.transform)>.9)):Sn(_,_,t),{point:new o.pointGeometry((_[0]/_[3]+1)/2*this.transform.width+nr,(-_[1]/_[3]+1)/2*this.transform.height+nr),perspectiveRatio:Math.min(.5+this.transform.cameraToCenterDistance/_[3]*.5,1.5),signedDistanceFromCamera:_[3],occluded:m&&_[2]>_[3]||x}}isOffscreen(t,s,h,m){return h<nr||t>=this.screenRightBoundary||m<nr||s>this.screenBottomBoundary}isInsideGrid(t,s,h,m){return h>=0&&t<this.gridRightBoundary&&m>=0&&s<this.gridBottomBoundary}getViewportMatrix(){const t=o.identity([]);return o.translate(t,t,[-100,-100,0]),t}}class ji{constructor(t,s,h,m){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?s:-s))):m&&h?1:0,this.placed=h}isHidden(){return this.opacity===0&&!this.placed}}class Tr{constructor(t,s,h,m,_,x=!1){this.text=new ji(t?t.text:null,s,h,_),this.icon=new ji(t?t.icon:null,s,m,_),this.clipped=x}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Er{constructor(t,s,h,m=!1){this.text=t,this.icon=s,this.skipFade=h,this.clipped=m}}class on{constructor(){this.invProjMatrix=o.create(),this.viewportMatrix=o.create(),this.circles=[]}}class Hl{constructor(t,s,h,m,_){this.bucketInstanceId=t,this.featureIndex=s,this.sourceLayerIndex=h,this.bucketIndex=m,this.tileID=_}}class rr{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const s=++this.maxGroupID;this.collisionGroups[t]={ID:s,predicate:h=>h.collisionGroupID===s}}return this.collisionGroups[t]}}function Yo(l,t,s,h,m){const{horizontalAlign:_,verticalAlign:x}=o.getAnchorAlignment(l),A=-(_-.5)*t,C=-(x-.5)*s,S=o.evaluateVariableOffset(l,h);return new o.pointGeometry(A+S[0]*m,C+S[1]*m)}function Xo(l,t,s,h,m){const _=new o.pointGeometry(l,t);return s&&_._rotate(h?m:-m),_}class Qd{constructor(t,s,h,m,_){this.transform=t.clone(),this.collisionIndex=new Sa(this.transform,_),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=s,this.retainedQueryData={},this.collisionGroups=new rr(h),this.collisionCircleArrays={},this.prevPlacement=m,m&&(m.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(t,s,h,m){const _=h.getBucket(s),x=h.latestFeatureIndex;if(!_||!x||s.id!==_.layerIds[0])return;const A=_.layers[0].layout,C=h.collisionBoxArray,S=Math.pow(2,this.transform.zoom-h.tileID.overscaledZ),z=h.tileSize/o.EXTENT,B=h.tileID.toUnwrapped(),N=this.transform.calculateProjMatrix(B),G=A.get("text-pitch-alignment")==="map",V=A.get("text-rotation-alignment")==="map";s.compileFilter();const O=s.dynamicFilter(),$=s.dynamicFilterNeedsFeature(),W=this.transform.calculatePixelsToTileUnitsMatrix(h),Q=xo(N,h.tileID.canonical,G,V,this.transform,W);let K=null;if(G){const re=qo(N,h.tileID.canonical,G,V,this.transform,W);K=o.multiply$1([],this.transform.labelPlaneMatrix,re)}let ee=null;O&&h.latestFeatureIndex&&(ee={unwrappedTileID:B,dynamicFilter:O,dynamicFilterNeedsFeature:$,featureIndex:h.latestFeatureIndex}),this.retainedQueryData[_.bucketInstanceId]=new Hl(_.bucketInstanceId,x,_.sourceLayerIndex,_.index,h.tileID);const X={bucket:_,layout:A,posMatrix:N,textLabelPlaneMatrix:Q,labelToScreenMatrix:K,clippingData:ee,scale:S,textPixelRatio:z,holdingForFade:h.holdingForFade(),collisionBoxArray:C,partiallyEvaluatedTextSize:o.evaluateSizeForZoom(_.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:o.evaluateSizeForZoom(_.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(_.sourceID)};if(m)for(const re of _.sortKeyRanges){const{sortKey:ge,symbolInstanceStart:Ae,symbolInstanceEnd:Se}=re;t.push({sortKey:ge,symbolInstanceStart:Ae,symbolInstanceEnd:Se,parameters:X})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:_.symbolInstances.length,parameters:X})}attemptAnchorPlacement(t,s,h,m,_,x,A,C,S,z,B,N,G,V,O,$,W,Q){const K=[N.textOffset0,N.textOffset1],ee=Yo(t,h,m,K,_),X=this.collisionIndex.placeCollisionBox(_,s,Xo(ee.x,ee.y,x,A,this.transform.angle),B,C,S,z.predicate);if((!$||this.collisionIndex.placeCollisionBox(V.getSymbolInstanceIconSize(Q,this.transform.zoom,G),$,Xo(ee.x,ee.y,x,A,this.transform.angle),B,C,S,z.predicate).box.length!==0)&&X.box.length>0){let re;return this.prevPlacement&&this.prevPlacement.variableOffsets[N.crossTileID]&&this.prevPlacement.placements[N.crossTileID]&&this.prevPlacement.placements[N.crossTileID].text&&(re=this.prevPlacement.variableOffsets[N.crossTileID].anchor),this.variableOffsets[N.crossTileID]={textOffset:K,width:h,height:m,anchor:t,textScale:_,prevAnchor:re},this.markUsedJustification(V,t,N,O),V.allowVerticalPlacement&&(this.markUsedOrientation(V,O,N),this.placedOrientations[N.crossTileID]=O),{shift:ee,placedGlyphBoxes:X}}}placeLayerBucketPart(t,s,h,m){const{bucket:_,layout:x,posMatrix:A,textLabelPlaneMatrix:C,labelToScreenMatrix:S,clippingData:z,textPixelRatio:B,holdingForFade:N,collisionBoxArray:G,partiallyEvaluatedTextSize:V,partiallyEvaluatedIconSize:O,collisionGroup:$}=t.parameters,W=x.get("text-optional"),Q=x.get("icon-optional"),K=x.get("text-allow-overlap"),ee=x.get("icon-allow-overlap"),X=x.get("text-rotation-alignment")==="map",re=x.get("text-pitch-alignment")==="map",ge=x.get("icon-text-fit")!=="none",Ae=x.get("symbol-z-order")==="viewport-y";let Se=K&&(ee||!_.hasIconData()||Q),Ce=ee&&(K||!_.hasTextData()||W);!_.collisionArrays&&G&&_.deserializeCollisionBoxes(G),h&&m&&_.updateCollisionDebugBuffers(this.transform.zoom,G);const Ze=(ye,je,Ue)=>{if(z){const Di={zoom:this.transform.zoom,pitch:this.transform.pitch};let Ri=null;if(z.dynamicFilterNeedsFeature){const oi=this.retainedQueryData[_.bucketInstanceId];Ri=z.featureIndex.loadFeature({featureIndex:ye.featureIndex,bucketIndex:oi.bucketIndex,sourceLayerIndex:oi.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,z.dynamicFilter)(Di,Ri,this.retainedQueryData[_.bucketInstanceId].tileID.canonical,new o.pointGeometry(ye.tileAnchorX,ye.tileAnchorY),this.transform.calculateDistanceTileData(z.unwrappedTileID)))return this.placements[ye.crossTileID]=new Er(!1,!1,!1,!0),void(s[ye.crossTileID]=!0)}if(s[ye.crossTileID])return;if(N)return void(this.placements[ye.crossTileID]=new Er(!1,!1,!1));let lt=!1,we=!1,pt=!0,yt=!1,ot=!1,st=null,Et={box:null,offscreen:null,occluded:null},Ft={box:null,offscreen:null,occluded:null},ht=null,kt=null,$t=null,ki=0,an=0,ln=0;Ue.textFeatureIndex?ki=Ue.textFeatureIndex:ye.useRuntimeCollisionCircles&&(ki=ye.featureIndex),Ue.verticalTextFeatureIndex&&(an=Ue.verticalTextFeatureIndex);const Pn=Di=>{Di.tileID=this.retainedQueryData[_.bucketInstanceId].tileID,(this.transform.elevation||Di.elevation)&&(Di.elevation=this.transform.elevation?this.transform.elevation.getAtTileOffset(this.retainedQueryData[_.bucketInstanceId].tileID,Di.tileAnchorX,Di.tileAnchorY):0)},sr=Ue.textBox;if(sr){Pn(sr);const Di=oi=>{let Gi=o.WritingMode.horizontal;if(_.allowVerticalPlacement&&!oi&&this.prevPlacement){const Bn=this.prevPlacement.placedOrientations[ye.crossTileID];Bn&&(this.placedOrientations[ye.crossTileID]=Bn,Gi=Bn,this.markUsedOrientation(_,Gi,ye))}return Gi},Ri=(oi,Gi)=>{if(_.allowVerticalPlacement&&ye.numVerticalGlyphVertices>0&&Ue.verticalTextBox){for(const Bn of _.writingModes)if(Bn===o.WritingMode.vertical?(Et=Gi(),Ft=Et):Et=oi(),Et&&Et.box&&Et.box.length)break}else Et=oi()};if(x.get("text-variable-anchor")){let oi=x.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[ye.crossTileID]){const Si=this.prevPlacement.variableOffsets[ye.crossTileID];oi.indexOf(Si.anchor)>0&&(oi=oi.filter(Zn=>Zn!==Si.anchor),oi.unshift(Si.anchor))}const Gi=(Si,Zn,oa)=>{const Ln=_.getSymbolInstanceTextSize(V,ye,this.transform.zoom,je),Mo=(Si.x2-Si.x1)*Ln+2*Si.padding,Mh=(Si.y2-Si.y1)*Ln+2*Si.padding,zc=ge&&!ee?Zn:null;zc&&Pn(zc);let os={box:[],offscreen:!1,occluded:!1};const pp=K?2*oi.length:oi.length;for(let Yr=0;Yr<pp;++Yr){const kc=this.attemptAnchorPlacement(oi[Yr%oi.length],Si,Mo,Mh,Ln,X,re,B,A,$,Yr>=oi.length,ye,je,_,oa,zc,V,O);if(kc&&(os=kc.placedGlyphBoxes,os&&os.box&&os.box.length)){lt=!0,st=kc.shift;break}}return os};Ri(()=>Gi(sr,Ue.iconBox,o.WritingMode.horizontal),()=>{const Si=Ue.verticalTextBox;return Si&&Pn(Si),_.allowVerticalPlacement&&!(Et&&Et.box&&Et.box.length)&&ye.numVerticalGlyphVertices>0&&Si?Gi(Si,Ue.verticalIconBox,o.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),Et&&(lt=Et.box,pt=Et.offscreen,yt=Et.occluded);const Bn=Di(Et&&Et.box);if(!lt&&this.prevPlacement){const Si=this.prevPlacement.variableOffsets[ye.crossTileID];Si&&(this.variableOffsets[ye.crossTileID]=Si,this.markUsedJustification(_,Si.anchor,ye,Bn))}}else{const oi=(Gi,Bn)=>{const Si=_.getSymbolInstanceTextSize(V,ye,this.transform.zoom,je),Zn=this.collisionIndex.placeCollisionBox(Si,Gi,new o.pointGeometry(0,0),K,B,A,$.predicate);return Zn&&Zn.box&&Zn.box.length&&(this.markUsedOrientation(_,Bn,ye),this.placedOrientations[ye.crossTileID]=Bn),Zn};Ri(()=>oi(sr,o.WritingMode.horizontal),()=>{const Gi=Ue.verticalTextBox;return _.allowVerticalPlacement&&ye.numVerticalGlyphVertices>0&&Gi?(Pn(Gi),oi(Gi,o.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),Di(Et&&Et.box&&Et.box.length)}}if(ht=Et,lt=ht&&ht.box&&ht.box.length>0,pt=ht&&ht.offscreen,yt=ht&&ht.occluded,ye.useRuntimeCollisionCircles){const Di=_.text.placedSymbolArray.get(ye.centerJustifiedTextSymbolIndex>=0?ye.centerJustifiedTextSymbolIndex:ye.verticalPlacedTextSymbolIndex),Ri=o.evaluateSizeForFeature(_.textSizeData,V,Di),oi=x.get("text-padding");kt=this.collisionIndex.placeCollisionCircles(K,Di,_.lineVertexArray,_.glyphOffsetArray,Ri,A,C,S,h,re,$.predicate,ye.collisionCircleDiameter*Ri/o.ONE_EM,oi,this.retainedQueryData[_.bucketInstanceId].tileID),lt=K||kt.circles.length>0&&!kt.collisionDetected,pt=pt&&kt.offscreen,yt=kt.occluded}if(Ue.iconFeatureIndex&&(ln=Ue.iconFeatureIndex),Ue.iconBox){const Di=Ri=>{Pn(Ri);const oi=ge&&st?Xo(st.x,st.y,X,re,this.transform.angle):new o.pointGeometry(0,0),Gi=_.getSymbolInstanceIconSize(O,this.transform.zoom,je);return this.collisionIndex.placeCollisionBox(Gi,Ri,oi,ee,B,A,$.predicate)};Ft&&Ft.box&&Ft.box.length&&Ue.verticalIconBox?($t=Di(Ue.verticalIconBox),we=$t.box.length>0):($t=Di(Ue.iconBox),we=$t.box.length>0),pt=pt&&$t.offscreen,ot=$t.occluded}const Ir=W||ye.numHorizontalGlyphVertices===0&&ye.numVerticalGlyphVertices===0,Hr=Q||ye.numIconVertices===0;if(Ir||Hr?Hr?Ir||(we=we&&lt):lt=we&&lt:we=lt=we&&lt,lt&&ht&&ht.box&&this.collisionIndex.insertCollisionBox(ht.box,x.get("text-ignore-placement"),_.bucketInstanceId,Ft&&Ft.box&&an?an:ki,$.ID),we&&$t&&this.collisionIndex.insertCollisionBox($t.box,x.get("icon-ignore-placement"),_.bucketInstanceId,ln,$.ID),kt&&(lt&&this.collisionIndex.insertCollisionCircles(kt.circles,x.get("text-ignore-placement"),_.bucketInstanceId,ki,$.ID),h)){const Di=_.bucketInstanceId;let Ri=this.collisionCircleArrays[Di];Ri===void 0&&(Ri=this.collisionCircleArrays[Di]=new on);for(let oi=0;oi<kt.circles.length;oi+=4)Ri.circles.push(kt.circles[oi+0]),Ri.circles.push(kt.circles[oi+1]),Ri.circles.push(kt.circles[oi+2]),Ri.circles.push(kt.collisionDetected?1:0)}const zr=this.transform.projection.name!=="globe";Se=Se&&(zr||!yt),Ce=Ce&&(zr||!ot),this.placements[ye.crossTileID]=new Er(lt||Se,we||Ce,pt||_.justReloaded),s[ye.crossTileID]=!0};if(Ae){const ye=_.getSortedSymbolIndexes(this.transform.angle);for(let je=ye.length-1;je>=0;--je){const Ue=ye[je];Ze(_.symbolInstances.get(Ue),Ue,_.collisionArrays[Ue])}}else for(let ye=t.symbolInstanceStart;ye<t.symbolInstanceEnd;ye++)Ze(_.symbolInstances.get(ye),ye,_.collisionArrays[ye]);if(h&&_.bucketInstanceId in this.collisionCircleArrays){const ye=this.collisionCircleArrays[_.bucketInstanceId];o.invert(ye.invProjMatrix,A),ye.viewportMatrix=this.collisionIndex.getViewportMatrix()}_.justReloaded=!1}markUsedJustification(t,s,h,m){let _;_=m===o.WritingMode.vertical?h.verticalPlacedTextSymbolIndex:{left:h.leftJustifiedTextSymbolIndex,center:h.centerJustifiedTextSymbolIndex,right:h.rightJustifiedTextSymbolIndex}[o.getAnchorJustification(s)];const x=[h.leftJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.rightJustifiedTextSymbolIndex,h.verticalPlacedTextSymbolIndex];for(const A of x)A>=0&&(t.text.placedSymbolArray.get(A).crossTileID=_>=0&&A!==_?0:h.crossTileID)}markUsedOrientation(t,s,h){const m=s===o.WritingMode.horizontal||s===o.WritingMode.horizontalOnly?s:0,_=s===o.WritingMode.vertical?s:0,x=[h.leftJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.rightJustifiedTextSymbolIndex];for(const A of x)t.text.placedSymbolArray.get(A).placedOrientation=m;h.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(h.verticalPlacedTextSymbolIndex).placedOrientation=_)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const s=this.prevPlacement;let h=!1;this.prevZoomAdjustment=s?s.zoomAdjustment(this.transform.zoom):0;const m=s?s.symbolFadeChange(t):1,_=s?s.opacities:{},x=s?s.variableOffsets:{},A=s?s.placedOrientations:{};for(const C in this.placements){const S=this.placements[C],z=_[C];z?(this.opacities[C]=new Tr(z,m,S.text,S.icon,null,S.clipped),h=h||S.text!==z.text.placed||S.icon!==z.icon.placed):(this.opacities[C]=new Tr(null,m,S.text,S.icon,S.skipFade,S.clipped),h=h||S.text||S.icon)}for(const C in _){const S=_[C];if(!this.opacities[C]){const z=new Tr(S,m,!1,!1);z.isHidden()||(this.opacities[C]=z,h=h||S.text.placed||S.icon.placed)}}for(const C in x)this.variableOffsets[C]||!this.opacities[C]||this.opacities[C].isHidden()||(this.variableOffsets[C]=x[C]);for(const C in A)this.placedOrientations[C]||!this.opacities[C]||this.opacities[C].isHidden()||(this.placedOrientations[C]=A[C]);h?this.lastPlacementChangeTime=t:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=s?s.lastPlacementChangeTime:t)}updateLayerOpacities(t,s){const h={};for(const m of s){const _=m.getBucket(t);_&&m.latestFeatureIndex&&t.id===_.layerIds[0]&&this.updateBucketOpacities(_,h,m.collisionBoxArray)}}updateBucketOpacities(t,s,h){t.hasTextData()&&t.text.opacityVertexArray.clear(),t.hasIconData()&&t.icon.opacityVertexArray.clear(),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const m=t.layers[0].layout,_=!!t.layers[0].dynamicFilter(),x=new Tr(null,0,!1,!1,!0),A=m.get("text-allow-overlap"),C=m.get("icon-allow-overlap"),S=m.get("text-variable-anchor"),z=m.get("text-rotation-alignment")==="map",B=m.get("text-pitch-alignment")==="map",N=m.get("icon-text-fit")!=="none",G=new Tr(null,0,A&&(C||!t.hasIconData()||m.get("icon-optional")),C&&(A||!t.hasTextData()||m.get("text-optional")),!0);!t.collisionArrays&&h&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(h);const V=($,W,Q)=>{for(let K=0;K<W/4;K++)$.opacityVertexArray.emplaceBack(Q)};let O=0;for(let $=0;$<t.symbolInstances.length;$++){const W=t.symbolInstances.get($),{numHorizontalGlyphVertices:Q,numVerticalGlyphVertices:K,crossTileID:ee}=W;let X=this.opacities[ee];s[ee]?X=x:X||(X=G,this.opacities[ee]=X),s[ee]=!0;const re=Q>0||K>0,ge=W.numIconVertices>0,Ae=this.placedOrientations[W.crossTileID],Se=Ae===o.WritingMode.vertical,Ce=Ae===o.WritingMode.horizontal||Ae===o.WritingMode.horizontalOnly;if(!re&&!ge||X.isHidden()||O++,re){const Ze=Ru(X.text);V(t.text,Q,Se?ka:Ze),V(t.text,K,Ce?ka:Ze);const ye=X.text.isHidden();[W.rightJustifiedTextSymbolIndex,W.centerJustifiedTextSymbolIndex,W.leftJustifiedTextSymbolIndex].forEach(lt=>{lt>=0&&(t.text.placedSymbolArray.get(lt).hidden=ye||Se?1:0)}),W.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(W.verticalPlacedTextSymbolIndex).hidden=ye||Ce?1:0);const je=this.variableOffsets[W.crossTileID];je&&this.markUsedJustification(t,je.anchor,W,Ae);const Ue=this.placedOrientations[W.crossTileID];Ue&&(this.markUsedJustification(t,"left",W,Ue),this.markUsedOrientation(t,Ue,W))}if(ge){const Ze=Ru(X.icon);W.placedIconSymbolIndex>=0&&(V(t.icon,W.numIconVertices,Se?ka:Ze),t.icon.placedSymbolArray.get(W.placedIconSymbolIndex).hidden=X.icon.isHidden()),W.verticalPlacedIconSymbolIndex>=0&&(V(t.icon,W.numVerticalIconVertices,Ce?ka:Ze),t.icon.placedSymbolArray.get(W.verticalPlacedIconSymbolIndex).hidden=X.icon.isHidden())}if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const Ze=t.collisionArrays[$];if(Ze){let ye=new o.pointGeometry(0,0),je=!0;if(Ze.textBox||Ze.verticalTextBox){if(S){const lt=this.variableOffsets[ee];lt?(ye=Yo(lt.anchor,lt.width,lt.height,lt.textOffset,lt.textScale),z&&ye._rotate(B?this.transform.angle:-this.transform.angle)):je=!1}_&&(je=!X.clipped),Ze.textBox&&or(t.textCollisionBox.collisionVertexArray,X.text.placed,!je||Se,ye.x,ye.y),Ze.verticalTextBox&&or(t.textCollisionBox.collisionVertexArray,X.text.placed,!je||Ce,ye.x,ye.y)}const Ue=je&&Boolean(!Ce&&Ze.verticalIconBox);Ze.iconBox&&or(t.iconCollisionBox.collisionVertexArray,X.icon.placed,Ue,N?ye.x:0,N?ye.y:0),Ze.verticalIconBox&&or(t.iconCollisionBox.collisionVertexArray,X.icon.placed,!Ue,N?ye.x:0,N?ye.y:0)}}}if(t.fullyClipped=O===0,t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.bucketInstanceId in this.collisionCircleArrays){const $=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=$.invProjMatrix,t.placementViewportMatrix=$.viewportMatrix,t.collisionCircleArray=$.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}}symbolFadeChange(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,s){const h=this.zoomAtLastRecencyCheck===s?1-this.zoomAdjustment(s):1;return this.zoomAtLastRecencyCheck=s,this.commitTime+this.fadeDuration*h>t}setStale(){this.stale=!0}}function or(l,t,s,h,m){l.emplaceBack(t?1:0,s?1:0,h||0,m||0),l.emplaceBack(t?1:0,s?1:0,h||0,m||0),l.emplaceBack(t?1:0,s?1:0,h||0,m||0),l.emplaceBack(t?1:0,s?1:0,h||0,m||0)}const Kd=Math.pow(2,25),Lu=Math.pow(2,24),In=Math.pow(2,17),Ia=Math.pow(2,16),Fr=Math.pow(2,9),Yl=Math.pow(2,8),za=Math.pow(2,1);function Ru(l){if(l.opacity===0&&!l.placed)return 0;if(l.opacity===1&&l.placed)return 4294967295;const t=l.placed?1:0,s=Math.floor(127*l.opacity);return s*Kd+t*Lu+s*In+t*Ia+s*Fr+t*Yl+s*za+t}const ka=0;class Xl{constructor(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&t.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,s,h,m,_){const x=this._bucketParts;for(;this._currentTileIndex<t.length;)if(s.getBucketParts(x,m,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,_())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,x.sort((A,C)=>A.sortKey-C.sortKey));this._currentPartIndex<x.length;){const A=x[this._currentPartIndex];if(s.placeLayerBucketPart(A,this._seenCrossTileIDs,h,A.symbolInstanceStart===0),this._currentPartIndex++,_())return!0}return!1}}class $d{constructor(t,s,h,m,_,x,A,C){this.placement=new Qd(t,_,x,A,C),this._currentPlacementIndex=s.length-1,this._forceFullPlacement=h,this._showCollisionBoxes=m,this._done=!1}isDone(){return this._done}continuePlacement(t,s,h){const m=o.exported.now(),_=()=>{const x=o.exported.now()-m;return!this._forceFullPlacement&&x>2};for(;this._currentPlacementIndex>=0;){const x=s[t[this._currentPlacementIndex]],A=this.placement.collisionIndex.transform.zoom;if(x.type==="symbol"&&(!x.minzoom||x.minzoom<=A)&&(!x.maxzoom||x.maxzoom>A)){if(this._inProgressLayer||(this._inProgressLayer=new Xl(x)),this._inProgressLayer.continuePlacement(h[x.source],this.placement,this._showCollisionBoxes,x,_))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const Ou=512/o.EXTENT/2;class Jd{constructor(t,s,h){this.tileID=t,this.indexedSymbolInstances={},this.bucketInstanceId=h;for(let m=0;m<s.length;m++){const _=s.get(m),x=_.key;this.indexedSymbolInstances[x]||(this.indexedSymbolInstances[x]=[]),this.indexedSymbolInstances[x].push({crossTileID:_.crossTileID,coord:this.getScaledCoordinates(_,t)})}}getScaledCoordinates(t,s){const h=Ou/Math.pow(2,s.canonical.z-this.tileID.canonical.z);return{x:Math.floor((s.canonical.x*o.EXTENT+t.tileAnchorX)*h),y:Math.floor((s.canonical.y*o.EXTENT+t.tileAnchorY)*h)}}findMatches(t,s,h){const m=this.tileID.canonical.z<s.canonical.z?1:Math.pow(2,this.tileID.canonical.z-s.canonical.z);for(let _=0;_<t.length;_++){const x=t.get(_);if(x.crossTileID)continue;const A=this.indexedSymbolInstances[x.key];if(!A)continue;const C=this.getScaledCoordinates(x,s);for(const S of A)if(Math.abs(S.coord.x-C.x)<=m&&Math.abs(S.coord.y-C.y)<=m&&!h[S.crossTileID]){h[S.crossTileID]=!0,x.crossTileID=S.crossTileID;break}}}}class Fu{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ep{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const s=Math.round((t-this.lng)/360);if(s!==0)for(const h in this.indexes){const m=this.indexes[h],_={};for(const x in m){const A=m[x];A.tileID=A.tileID.unwrapTo(A.tileID.wrap+s),_[A.tileID.key]=A}this.indexes[h]=_}this.lng=t}addBucket(t,s,h){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===s.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let _=0;_<s.symbolInstances.length;_++)s.symbolInstances.get(_).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const m=this.usedCrossTileIDs[t.overscaledZ];for(const _ in this.indexes){const x=this.indexes[_];if(Number(_)>t.overscaledZ)for(const A in x){const C=x[A];C.tileID.isChildOf(t)&&C.findMatches(s.symbolInstances,t,m)}else{const A=x[t.scaledTo(Number(_)).key];A&&A.findMatches(s.symbolInstances,t,m)}}for(let _=0;_<s.symbolInstances.length;_++){const x=s.symbolInstances.get(_);x.crossTileID||(x.crossTileID=h.generate(),m[x.crossTileID]=!0)}return this.indexes[t.overscaledZ]===void 0&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new Jd(t,s.symbolInstances,s.bucketInstanceId),!0}removeBucketCrossTileIDs(t,s){for(const h in s.indexedSymbolInstances)for(const m of s.indexedSymbolInstances[h])delete this.usedCrossTileIDs[t][m.crossTileID]}removeStaleBuckets(t){let s=!1;for(const h in this.indexes){const m=this.indexes[h];for(const _ in m)t[m[_].bucketInstanceId]||(this.removeBucketCrossTileIDs(h,m[_]),delete m[_],s=!0)}return s}}class Da{constructor(){this.layerIndexes={},this.crossTileIDs=new Fu,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,s,h,m){let _=this.layerIndexes[t.id];_===void 0&&(_=this.layerIndexes[t.id]=new ep);let x=!1;const A={};m.name!=="globe"&&_.handleWrapJump(h);for(const C of s){const S=C.getBucket(t);S&&t.id===S.layerIds[0]&&(S.bucketInstanceId||(S.bucketInstanceId=++this.maxBucketInstanceId),_.addBucket(C.tileID,S,this.crossTileIDs)&&(x=!0),A[S.bucketInstanceId]=!0)}return _.removeStaleBuckets(A)&&(x=!0),x}pruneUnusedLayers(t){const s={};t.forEach(h=>{s[h]=!0});for(const h in this.layerIndexes)s[h]||delete this.layerIndexes[h]}}const Bs=(l,t)=>o.emitValidationErrors(l,t&&t.filter(s=>s.identifier!=="source.canvas")),Nu=o.pick(ct,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Uu=o.pick(ct,["setCenter","setZoom","setBearing","setPitch"]),Vu={version:8,layers:[],sources:{}},vo={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class bn extends o.Evented{constructor(t,s={}){super(),this.map=t,this.dispatcher=new Gt(St(),this),this.imageManager=new yi,this.imageManager.setEventedParent(this),this.glyphManager=new o.GlyphManager(t._requestManager,s.localFontFamily?o.LocalGlyphMode.all:s.localIdeographFontFamily?o.LocalGlyphMode.ideographs:o.LocalGlyphMode.none,s.localFontFamily||s.localIdeographFontFamily),this.lineAtlas=new o.LineAtlas(256,512),this.crossTileSymbolIndex=new Da,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this.zoomHistory=new o.ZoomHistory,this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",o.getReferrer());const h=this;this._rtlTextPluginCallback=bn.registerForPluginStateChange(m=>{h.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:m.pluginStatus,pluginURL:m.pluginURL},(_,x)=>{if(o.triggerPluginCompletionEvent(_),x&&x.every(A=>A))for(const A in h._sourceCaches){const C=h._sourceCaches[A],S=C.getSource().type;S!=="vector"&&S!=="geojson"||C.reload()}})}),this.on("data",m=>{if(m.dataType!=="source"||m.sourceDataType!=="metadata")return;const _=this.getSource(m.sourceId);if(_&&_.vectorLayerIds)for(const x in this._layers){const A=this._layers[x];A.source===_.id&&this._validateLayer(A)}})}loadURL(t,s={}){this.fire(new o.Event("dataloading",{dataType:"style"}));const h=typeof s.validate=="boolean"?s.validate:!o.isMapboxURL(t);t=this.map._requestManager.normalizeStyleURL(t,s.accessToken);const m=this.map._requestManager.transformRequest(t,o.ResourceType.Style);this._request=o.getJSON(m,(_,x)=>{this._request=null,_?this.fire(new o.ErrorEvent(_)):x&&this._load(x,h)})}loadJSON(t,s={}){this.fire(new o.Event("dataloading",{dataType:"style"})),this._request=o.exported.frame(()=>{this._request=null,this._load(t,s.validate!==!1)})}loadEmpty(){this.fire(new o.Event("dataloading",{dataType:"style"})),this._load(Vu,!1)}_updateLayerCount(t,s){const h=s?1:-1;t.is3D()&&(this._num3DLayers+=h),t.type==="circle"&&(this._numCircleLayers+=h),t.type==="symbol"&&(this._numSymbolLayers+=h)}_load(t,s){if(s&&Bs(this,o.validateStyle(t)))return;this._loaded=!0,this.stylesheet=t,this._updateMapProjection();for(const m in t.sources)this.addSource(m,t.sources[m],{validate:!1});this._changed=!1,t.sprite?this._loadSprite(t.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(t.glyphs);const h=ni(this.stylesheet.layers);this._order=h.map(m=>m.id),this._layers={},this._serializedLayers={};for(let m of h)m=o.createStyleLayer(m),m.setEventedParent(this,{layer:{id:m.id}}),this._layers[m.id]=m,this._serializedLayers[m.id]=m.serialize(),this._updateLayerCount(m,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new er(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new o.Event("data",{dataType:"style"})),this.fire(new o.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(t){t?this.stylesheet.projection=t:delete this.stylesheet.projection,this.map._explicitProjection||this.map._updateProjection()}_updateMapProjection(){this.map._explicitProjection?this.applyProjectionUpdate():this.map._updateProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_loadSprite(t){this._spriteRequest=function(s,h,m){let _,x,A;const C=o.exported.devicePixelRatio>1?"@2x":"";let S=o.getJSON(h.transformRequest(h.normalizeSpriteURL(s,C,".json"),o.ResourceType.SpriteJSON),(N,G)=>{S=null,A||(A=N,_=G,B())}),z=o.getImage(h.transformRequest(h.normalizeSpriteURL(s,C,".png"),o.ResourceType.SpriteImage),(N,G)=>{z=null,A||(A=N,x=G,B())});function B(){if(A)m(A);else if(_&&x){const N=o.exported.getImageData(x),G={};for(const V in _){const{width:O,height:$,x:W,y:Q,sdf:K,pixelRatio:ee,stretchX:X,stretchY:re,content:ge}=_[V],Ae=new o.RGBAImage({width:O,height:$});o.RGBAImage.copy(N,Ae,{x:W,y:Q},{x:0,y:0},{width:O,height:$}),G[V]={data:Ae,pixelRatio:ee,sdf:K,stretchX:X,stretchY:re,content:ge}}m(null,G)}}return{cancel(){S&&(S.cancel(),S=null),z&&(z.cancel(),z=null)}}}(t,this.map._requestManager,(s,h)=>{if(this._spriteRequest=null,s)this.fire(new o.ErrorEvent(s));else if(h)for(const m in h)this.imageManager.addImage(m,h[m]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new o.Event("data",{dataType:"style"}))})}_validateLayer(t){const s=this.getSource(t.source);if(!s)return;const h=t.sourceLayer;h&&(s.type==="geojson"||s.vectorLayerIds&&s.vectorLayerIds.indexOf(h)===-1)&&this.fire(new o.ErrorEvent(new Error(`Source layer "${h}" does not exist on source "${s.id}" as specified by style layer "${t.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const t in this._sourceCaches)if(!this._sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(t){const s=[];for(const h of t){const m=this._layers[h];m.type!=="custom"&&s.push(m.serialize())}return s}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const t in this._sourceCaches)if(this._sourceCaches[t].hasTransition())return!0;for(const t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(t){return!!this.terrain&&vo[t.type]}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(t){if(!this._loaded)return;const s=this._changed;if(this._changed){const m=Object.keys(this._updatedLayers),_=Object.keys(this._removedLayers);(m.length||_.length)&&this._updateWorkerLayers(m,_);for(const x in this._updatedSources){const A=this._updatedSources[x];A==="reload"?this._reloadSource(x):A==="clear"&&this._clearSource(x)}this._updateTilesForChangedImages();for(const x in this._updatedPaintProps)this._layers[x].updateTransitions(t);this.light.updateTransitions(t),this.fog&&this.fog.updateTransitions(t),this._resetUpdates()}const h={};for(const m in this._sourceCaches){const _=this._sourceCaches[m];h[m]=_.used,_.used=!1}for(const m of this._order){const _=this._layers[m];if(_.recalculate(t,this._availableImages),!_.isHidden(t.zoom)){const A=this._getLayerSourceCache(_);A&&(A.used=!0)}const x=this.map.painter;if(x){const A=_.getProgramIds();if(!A)continue;const C=_.getProgramConfiguration(t.zoom);for(const S of A)x.useProgram(S,C)}}for(const m in h){const _=this._sourceCaches[m];h[m]!==_.used&&_.getSource().fire(new o.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:_.getSource().id}))}this.light.recalculate(t),this.terrain&&this.terrain.recalculate(t),this.fog&&this.fog.recalculate(t),this.z=t.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),s&&this.fire(new o.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const s in this._sourceCaches)this._sourceCaches[s].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateWorkerLayers(t,s){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(t),removedIds:s})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(t){if(this._checkLoaded(),Bs(this,o.validateStyle(t)))return!1;(t=o.clone$1(t)).layers=ni(t.layers);const s=function(m,_){if(!m)return[{command:ct.setStyle,args:[_]}];let x=[];try{if(!Z(m.version,_.version))return[{command:ct.setStyle,args:[_]}];Z(m.center,_.center)||x.push({command:ct.setCenter,args:[_.center]}),Z(m.zoom,_.zoom)||x.push({command:ct.setZoom,args:[_.zoom]}),Z(m.bearing,_.bearing)||x.push({command:ct.setBearing,args:[_.bearing]}),Z(m.pitch,_.pitch)||x.push({command:ct.setPitch,args:[_.pitch]}),Z(m.sprite,_.sprite)||x.push({command:ct.setSprite,args:[_.sprite]}),Z(m.glyphs,_.glyphs)||x.push({command:ct.setGlyphs,args:[_.glyphs]}),Z(m.transition,_.transition)||x.push({command:ct.setTransition,args:[_.transition]}),Z(m.light,_.light)||x.push({command:ct.setLight,args:[_.light]}),Z(m.fog,_.fog)||x.push({command:ct.setFog,args:[_.fog]}),Z(m.projection,_.projection)||x.push({command:ct.setProjection,args:[_.projection]});const A={},C=[];(function(B,N,G,V){let O;for(O in N=N||{},B=B||{})B.hasOwnProperty(O)&&(N.hasOwnProperty(O)||ri(O,G,V));for(O in N)N.hasOwnProperty(O)&&(B.hasOwnProperty(O)?Z(B[O],N[O])||(B[O].type==="geojson"&&N[O].type==="geojson"&&wr(B,N,O)?G.push({command:ct.setGeoJSONSourceData,args:[O,N[O].data]}):go(O,N,G,V)):ti(O,N,G))})(m.sources,_.sources,C,A);const S=[];m.layers&&m.layers.forEach(B=>{B.source&&A[B.source]?x.push({command:ct.removeLayer,args:[B.id]}):S.push(B)});let z=m.terrain;z&&A[z.source]&&(x.push({command:ct.setTerrain,args:[void 0]}),z=void 0),x=x.concat(C),Z(z,_.terrain)||x.push({command:ct.setTerrain,args:[_.terrain]}),function(B,N,G){N=N||[];const V=(B=B||[]).map(Ht),O=N.map(Ht),$=B.reduce(Vt,{}),W=N.reduce(Vt,{}),Q=V.slice(),K=Object.create(null);let ee,X,re,ge,Ae,Se,Ce;for(ee=0,X=0;ee<V.length;ee++)re=V[ee],W.hasOwnProperty(re)?X++:(G.push({command:ct.removeLayer,args:[re]}),Q.splice(Q.indexOf(re,X),1));for(ee=0,X=0;ee<O.length;ee++)re=O[O.length-1-ee],Q[Q.length-1-ee]!==re&&($.hasOwnProperty(re)?(G.push({command:ct.removeLayer,args:[re]}),Q.splice(Q.lastIndexOf(re,Q.length-X),1)):X++,Se=Q[Q.length-ee],G.push({command:ct.addLayer,args:[W[re],Se]}),Q.splice(Q.length-ee,0,re),K[re]=!0);for(ee=0;ee<O.length;ee++)if(re=O[ee],ge=$[re],Ae=W[re],!K[re]&&!Z(ge,Ae))if(Z(ge.source,Ae.source)&&Z(ge["source-layer"],Ae["source-layer"])&&Z(ge.type,Ae.type)){for(Ce in Qe(ge.layout,Ae.layout,G,re,null,ct.setLayoutProperty),Qe(ge.paint,Ae.paint,G,re,null,ct.setPaintProperty),Z(ge.filter,Ae.filter)||G.push({command:ct.setFilter,args:[re,Ae.filter]}),Z(ge.minzoom,Ae.minzoom)&&Z(ge.maxzoom,Ae.maxzoom)||G.push({command:ct.setLayerZoomRange,args:[re,Ae.minzoom,Ae.maxzoom]}),ge)ge.hasOwnProperty(Ce)&&Ce!=="layout"&&Ce!=="paint"&&Ce!=="filter"&&Ce!=="metadata"&&Ce!=="minzoom"&&Ce!=="maxzoom"&&(Ce.indexOf("paint.")===0?Qe(ge[Ce],Ae[Ce],G,re,Ce.slice(6),ct.setPaintProperty):Z(ge[Ce],Ae[Ce])||G.push({command:ct.setLayerProperty,args:[re,Ce,Ae[Ce]]}));for(Ce in Ae)Ae.hasOwnProperty(Ce)&&!ge.hasOwnProperty(Ce)&&Ce!=="layout"&&Ce!=="paint"&&Ce!=="filter"&&Ce!=="metadata"&&Ce!=="minzoom"&&Ce!=="maxzoom"&&(Ce.indexOf("paint.")===0?Qe(ge[Ce],Ae[Ce],G,re,Ce.slice(6),ct.setPaintProperty):Z(ge[Ce],Ae[Ce])||G.push({command:ct.setLayerProperty,args:[re,Ce,Ae[Ce]]}))}else G.push({command:ct.removeLayer,args:[re]}),Se=Q[Q.lastIndexOf(re)+1],G.push({command:ct.addLayer,args:[Ae,Se]})}(S,_.layers,x)}catch(A){console.warn("Unable to compute style diff:",A),x=[{command:ct.setStyle,args:[_]}]}return x}(this.serialize(),t).filter(m=>!(m.command in Uu));if(s.length===0)return!1;const h=s.filter(m=>!(m.command in Nu));if(h.length>0)throw new Error(`Unimplemented: ${h.map(m=>m.command).join(", ")}.`);return s.forEach(m=>{m.command!=="setTransition"&&this[m.command].apply(this,m.args)}),this.stylesheet=t,this._updateMapProjection(),!0}addImage(t,s){return this.getImage(t)?this.fire(new o.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(t,s),this._afterImageUpdated(t),this)}updateImage(t,s){this.imageManager.updateImage(t,s)}getImage(t){return this.imageManager.getImage(t)}removeImage(t){return this.getImage(t)?(this.imageManager.removeImage(t),this._afterImageUpdated(t),this):this.fire(new o.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(t,s,h={}){if(this._checkLoaded(),this.getSource(t)!==void 0)throw new Error("There is already a source with this ID");if(!s.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(s).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(s.type)>=0&&this._validate(o.validateSource,`sources.${t}`,s,null,h))return;this.map&&this.map._collectResourceTiming&&(s.collectResourceTiming=!0);const m=fe(t,s,this.dispatcher,this);m.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(t),source:m.serialize(),sourceId:t}));const _=x=>{const A=(x?"symbol:":"other:")+t,C=this._sourceCaches[A]=new o.SourceCache(A,m,x);(x?this._symbolSourceCaches:this._otherSourceCaches)[t]=C,C.style=this,C.onAdd(this.map)};_(!1),s.type!=="vector"&&s.type!=="geojson"||_(!0),m.onAdd&&m.onAdd(this.map),this._changed=!0}removeSource(t){this._checkLoaded();const s=this.getSource(t);if(!s)throw new Error("There is no source with this ID");for(const m in this._layers)if(this._layers[m].source===t)return this.fire(new o.ErrorEvent(new Error(`Source "${t}" cannot be removed while layer "${m}" is using it.`)));if(this.terrain&&this.terrain.get().source===t)return this.fire(new o.ErrorEvent(new Error(`Source "${t}" cannot be removed while terrain is using it.`)));const h=this._getSourceCaches(t);for(const m of h)delete this._sourceCaches[m.id],delete this._updatedSources[m.id],m.fire(new o.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:m.getSource().id})),m.setEventedParent(null),m.clearTiles();return delete this._otherSourceCaches[t],delete this._symbolSourceCaches[t],s.setEventedParent(null),s.onRemove&&s.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(t,s){this._checkLoaded(),this.getSource(t).setData(s),this._changed=!0}getSource(t){const s=this._getSourceCache(t);return s&&s.getSource()}addLayer(t,s,h={}){this._checkLoaded();const m=t.id;if(this.getLayer(m))return void this.fire(new o.ErrorEvent(new Error(`Layer with id "${m}" already exists on this map`)));let _;if(t.type==="custom"){if(Bs(this,o.validateCustomStyleLayer(t)))return;_=o.createStyleLayer(t)}else{if(typeof t.source=="object"&&(this.addSource(m,t.source),t=o.clone$1(t),t=o.extend(t,{source:m})),this._validate(o.validateLayer,`layers.${m}`,t,{arrayIndex:-1},h))return;_=o.createStyleLayer(t),this._validateLayer(_),_.setEventedParent(this,{layer:{id:m}}),this._serializedLayers[_.id]=_.serialize(),this._updateLayerCount(_,!0)}const x=s?this._order.indexOf(s):this._order.length;if(s&&x===-1)return void this.fire(new o.ErrorEvent(new Error(`Layer with id "${s}" does not exist on this map.`)));this._order.splice(x,0,m),this._layerOrderChanged=!0,this._layers[m]=_;const A=this._getLayerSourceCache(_);if(this._removedLayers[m]&&_.source&&A&&_.type!=="custom"){const C=this._removedLayers[m];delete this._removedLayers[m],C.type!==_.type?this._updatedSources[_.source]="clear":(this._updatedSources[_.source]="reload",A.pause())}this._updateLayer(_),_.onAdd&&_.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(t,s){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new o.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===s)return;const h=this._order.indexOf(t);this._order.splice(h,1);const m=s?this._order.indexOf(s):this._order.length;s&&m===-1?this.fire(new o.ErrorEvent(new Error(`Layer with id "${s}" does not exist on this map.`))):(this._order.splice(m,0,t),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(t){this._checkLoaded();const s=this._layers[t];if(!s)return void this.fire(new o.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be removed.`)));s.setEventedParent(null),this._updateLayerCount(s,!1);const h=this._order.indexOf(t);this._order.splice(h,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=s,delete this._layers[t],delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],s.onRemove&&s.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(t){return this._layers[t]}hasLayer(t){return t in this._layers}hasLayerType(t){for(const s in this._layers)if(this._layers[s].type===t)return!0;return!1}setLayerZoomRange(t,s,h){this._checkLoaded();const m=this.getLayer(t);m?m.minzoom===s&&m.maxzoom===h||(s!=null&&(m.minzoom=s),h!=null&&(m.maxzoom=h),this._updateLayer(m)):this.fire(new o.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(t,s,h={}){this._checkLoaded();const m=this.getLayer(t);if(m){if(!Z(m.filter,s))return s==null?(m.filter=void 0,void this._updateLayer(m)):void(this._validate(o.validateFilter,`layers.${m.id}.filter`,s,{layerType:m.type},h)||(m.filter=o.clone$1(s),this._updateLayer(m)))}else this.fire(new o.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be filtered.`)))}getFilter(t){const s=this.getLayer(t);return s&&o.clone$1(s.filter)}setLayoutProperty(t,s,h,m={}){this._checkLoaded();const _=this.getLayer(t);_?Z(_.getLayoutProperty(s),h)||(_.setLayoutProperty(s,h,m),this._updateLayer(_)):this.fire(new o.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(t,s){const h=this.getLayer(t);if(h)return h.getLayoutProperty(s);this.fire(new o.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style.`)))}setPaintProperty(t,s,h,m={}){this._checkLoaded();const _=this.getLayer(t);_?Z(_.getPaintProperty(s),h)||(_.setPaintProperty(s,h,m)&&this._updateLayer(_),this._changed=!0,this._updatedPaintProps[t]=!0):this.fire(new o.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(t,s){const h=this.getLayer(t);return h&&h.getPaintProperty(s)}setFeatureState(t,s){this._checkLoaded();const h=t.source,m=t.sourceLayer,_=this.getSource(h);if(!_)return void this.fire(new o.ErrorEvent(new Error(`The source '${h}' does not exist in the map's style.`)));const x=_.type;if(x==="geojson"&&m)return void this.fire(new o.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(x==="vector"&&!m)return void this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));t.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided.")));const A=this._getSourceCaches(h);for(const C of A)C.setFeatureState(m,t.id,s)}removeFeatureState(t,s){this._checkLoaded();const h=t.source,m=this.getSource(h);if(!m)return void this.fire(new o.ErrorEvent(new Error(`The source '${h}' does not exist in the map's style.`)));const _=m.type,x=_==="vector"?t.sourceLayer:void 0;if(_==="vector"&&!x)return void this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(s&&typeof t.id!="string"&&typeof t.id!="number")return void this.fire(new o.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const A=this._getSourceCaches(h);for(const C of A)C.removeFeatureState(x,t.id,s)}getFeatureState(t){this._checkLoaded();const s=t.source,h=t.sourceLayer,m=this.getSource(s);if(m){if(m.type!=="vector"||h)return t.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(s)[0].getFeatureState(h,t.id);this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new o.ErrorEvent(new Error(`The source '${s}' does not exist in the map's style.`)))}getTransition(){return o.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const t={};for(const s in this._sourceCaches){const h=this._sourceCaches[s].getSource();t[h.id]||(t[h.id]=h.serialize())}return o.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.stylesheet.terrain,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:t,layers:this._serializeLayers(this._order)},s=>s!==void 0)}_updateLayer(t){this._updatedLayers[t.id]=!0;const s=this._getLayerSourceCache(t);t.source&&!this._updatedSources[t.source]&&s&&s.getSource().type!=="raster"&&(this._updatedSources[t.source]="reload",s.pause()),this._changed=!0,t.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(t){const s=x=>this._layers[x].type==="fill-extrusion",h={},m=[];for(let x=this._order.length-1;x>=0;x--){const A=this._order[x];if(s(A)){h[A]=x;for(const C of t){const S=C[A];if(S)for(const z of S)m.push(z)}}}m.sort((x,A)=>A.intersectionZ-x.intersectionZ);const _=[];for(let x=this._order.length-1;x>=0;x--){const A=this._order[x];if(s(A))for(let C=m.length-1;C>=0;C--){const S=m[C].feature;if(h[S.layer.id]<x)break;_.push(S),m.pop()}else for(const C of t){const S=C[A];if(S)for(const z of S)_.push(z.feature)}}return _}queryRenderedFeatures(t,s,h){s&&s.filter&&this._validate(o.validateFilter,"queryRenderedFeatures.filter",s.filter,null,s);const m={};if(s&&s.layers){if(!Array.isArray(s.layers))return this.fire(new o.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const C of s.layers){const S=this._layers[C];if(!S)return this.fire(new o.ErrorEvent(new Error(`The layer '${C}' does not exist in the map's style and cannot be queried for features.`))),[];m[S.source]=!0}}const _=[];s.availableImages=this._availableImages;const x=s&&s.layers?s.layers.some(C=>{const S=this.getLayer(C);return S&&S.is3D()}):this.has3DLayers(),A=Le.createFromScreenPoints(t,h);for(const C in this._sourceCaches){const S=this._sourceCaches[C].getSource().id;s.layers&&!m[S]||_.push(xe(this._sourceCaches[C],this._layers,this._serializedLayers,A,s,h,x,!!this.map._showQueryGeometry))}return this.placement&&_.push(function(C,S,z,B,N,G,V){const O={},$=G.queryRenderedSymbols(B),W=[];for(const Q of Object.keys($).map(Number))W.push(V[Q]);W.sort(Je);for(const Q of W){const K=Q.featureIndex.lookupSymbolFeatures($[Q.bucketInstanceId],S,Q.bucketIndex,Q.sourceLayerIndex,N.filter,N.layers,N.availableImages,C);for(const ee in K){const X=O[ee]=O[ee]||[],re=K[ee];re.sort((ge,Ae)=>{const Se=Q.featureSortOrder;if(Se){const Ce=Se.indexOf(ge.featureIndex);return Se.indexOf(Ae.featureIndex)-Ce}return Ae.featureIndex-ge.featureIndex});for(const ge of re)X.push(ge)}}for(const Q in O)O[Q].forEach(K=>{const ee=K.feature,X=z(C[Q]).getFeatureState(ee.layer["source-layer"],ee.id);ee.source=ee.layer.source,ee.layer["source-layer"]&&(ee.sourceLayer=ee.layer["source-layer"]),ee.state=X});return O}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),A.screenGeometry,s,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(_)}querySourceFeatures(t,s){s&&s.filter&&this._validate(o.validateFilter,"querySourceFeatures.filter",s.filter,null,s);const h=this._getSourceCaches(t);let m=[];for(const _ of h)m=m.concat(Pe(_,s));return m}addSourceType(t,s,h){return bn.getSourceType(t)?h(new Error(`A source type called "${t}" already exists.`)):(bn.setSourceType(t,s),s.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:s.workerSourceURL},h):h(null,null))}getLight(){return this.light.getLight()}setLight(t,s={}){this._checkLoaded();const h=this.light.getLight();let m=!1;for(const x in t)if(!Z(t[x],h[x])){m=!0;break}if(!m)return;const _={now:o.exported.now(),transition:o.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,s),this.light.updateTransitions(_)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(t,s=1){if(this._checkLoaded(),!t)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if(s===1){if(typeof t.source=="object"){const h="terrain-dem-src";this.addSource(h,t.source),t=o.clone$1(t),t=o.extend(t,{source:h})}if(this._validate(o.validateTerrain,"terrain",t))return}if(!this.terrain||this.terrain&&s!==this.terrain.drapeRenderMode)this._createTerrain(t,s);else{const h=this.terrain,m=h.get();for(const _ in t)if(!Z(t[_],m[_])){h.set(t),this.stylesheet.terrain=t;const x={now:o.exported.now(),transition:o.extend({duration:0},this.stylesheet.transition)};h.updateTransitions(x);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(t){const s=this.fog=new pn(t,this.map.transform);this.stylesheet.fog=t;const h={now:o.exported.now(),transition:o.extend({duration:0},this.stylesheet.transition)};s.updateTransitions(h)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const t of this.map._markers)t._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(t){if(this._checkLoaded(),!t)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const s=this.fog,h=s.get();for(const m in t)if(!Z(t[m],h[m])){s.set(t),this.stylesheet.fog=t;const _={now:o.exported.now(),transition:o.extend({duration:0},this.stylesheet.transition)};s.updateTransitions(_);break}}else this._createFog(t);this._markersNeedUpdate=!0}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const t=this._order.filter(h=>this.isLayerDraped(this._layers[h])),s=this._order.filter(h=>!this.isLayerDraped(this._layers[h]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...t),this._drapedFirstOrder.push(...s)}_createTerrain(t,s){const h=this.terrain=new hi(t,s);this.stylesheet.terrain=t,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const m={now:o.exported.now(),transition:o.extend({duration:0},this.stylesheet.transition)};h.updateTransitions(m)}_force3DLayerUpdate(){for(const t in this._layers){const s=this._layers[t];s.type==="fill-extrusion"&&this._updateLayer(s)}}_forceSymbolLayerUpdate(){for(const t in this._layers){const s=this._layers[t];s.type==="symbol"&&this._updateLayer(s)}}_validate(t,s,h,m,_={}){return(!_||_.validate!==!1)&&Bs(this,t.call(o.validateStyle,o.extend({key:s,style:this.serialize(),value:h,styleSpec:o.spec},m)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),o.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const t in this._layers)this._layers[t].setEventedParent(null);for(const t in this._sourceCaches)this._sourceCaches[t].clearTiles(),this._sourceCaches[t].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(t){const s=this._getSourceCaches(t);for(const h of s)h.clearTiles()}_reloadSource(t){const s=this._getSourceCaches(t);for(const h of s)h.resume(),h.reload()}_updateSources(t){for(const s in this._sourceCaches)this._sourceCaches[s].update(t)}_generateCollisionBoxes(){for(const t in this._sourceCaches){const s=this._sourceCaches[t];s.resume(),s.reload()}}_updatePlacement(t,s,h,m,_=!1){let x=!1,A=!1;const C={};for(const S of this._order){const z=this._layers[S];if(z.type!=="symbol")continue;if(!C[z.source]){const N=this._getLayerSourceCache(z);if(!N)continue;C[z.source]=N.getRenderableIds(!0).map(G=>N.getTileByID(G)).sort((G,V)=>V.tileID.overscaledZ-G.tileID.overscaledZ||(G.tileID.isLessThan(V.tileID)?-1:1))}const B=this.crossTileSymbolIndex.addLayer(z,C[z.source],t.center.lng,t.projection);x=x||B}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),_=_||this._layerOrderChanged||h===0,this._layerOrderChanged&&this.fire(new o.Event("neworder")),(_||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(o.exported.now(),t.zoom))&&(this.pauseablePlacement=new $d(t,this._order,_,s,h,m,this.placement,this.fog&&t.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,C),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(o.exported.now()),A=!0),x&&this.pauseablePlacement.placement.setStale()),A||x)for(const S of this._order){const z=this._layers[S];z.type==="symbol"&&this.placement.updateLayerOpacities(z,C[z.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(o.exported.now())}_releaseSymbolFadeTiles(){for(const t in this._sourceCaches)this._sourceCaches[t].releaseSymbolFadeTiles()}getImages(t,s,h){this.imageManager.getImages(s.icons,h),this._updateTilesForChangedImages();const m=_=>{_&&_.setDependencies(s.tileID.key,s.type,s.icons)};m(this._otherSourceCaches[s.source]),m(this._symbolSourceCaches[s.source])}getGlyphs(t,s,h){this.glyphManager.getGlyphs(s.stacks,h)}getResource(t,s,h){return o.makeRequest(s,h)}_getSourceCache(t){return this._otherSourceCaches[t]}_getLayerSourceCache(t){return t.type==="symbol"?this._symbolSourceCaches[t.source]:this._otherSourceCaches[t.source]}_getSourceCaches(t){const s=[];return this._otherSourceCaches[t]&&s.push(this._otherSourceCaches[t]),this._symbolSourceCaches[t]&&s.push(this._symbolSourceCaches[t]),s}_isSourceCacheLoaded(t){const s=this._getSourceCaches(t);return s.length===0?(this.fire(new o.ErrorEvent(new Error(`There is no source with ID '${t}'`))),!1):s.every(h=>h.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}bn.getSourceType=function(l){return _e[l]},bn.setSourceType=function(l,t){_e[l]=t},bn.registerForPluginStateChange=o.registerForPluginStateChange;var Ls=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}
#endif`,Rs="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}";let bo={},Nr={};bo=xt("",`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {return currentElevation(apos);}
#endif
float unpack_depth(vec4 rgba_depth)
{const vec4 bit_shift=vec4(1.0/(256.0*256.0*256.0),1.0/(256.0*256.0),1.0/256.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;vec4 bounds=vec4(d,vec2(1.0)-d);h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,!0),Nr=xt(`#ifdef FOG
uniform float u_fog_temporal_offset;float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,`#ifdef FOG
uniform mat4 u_fog_matrix;vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,!0);const Pa=xt(`
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}
#ifdef TERRAIN
highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(256.0*256.0*256.0,256.0*256.0,256.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/256.0,1.0/256.0,1.0/256.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#endif`,`
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),Os=Ls;var Fs={background:xt(`uniform vec4 u_color;uniform float u_opacity;void main() {vec4 out_color=u_color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:xt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_mix);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:xt(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;attribute float a_scale;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);
#ifdef PROJECTION_GLOBE_VIEW
vec2 scaled_extrude=extrude*a_scale;vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=scaled_extrude.x*surface_vectors[0]+scaled_extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);vec4 world_center=vec4(pos,1);
#else 
mat3 surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);vec4 world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
#if defined(SCALE_WITH_MAP) && defined(PROJECTION_GLOBE_VIEW)
view_scale*=a_scale;
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);vec4 occlusion_world_center=vec4(circle_center,cantilevered_height,1);vec4 occlusion_projected_center=u_matrix*occlusion_world_center;
#else
vec4 occlusion_world_center=world_center;vec4 occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:xt("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:xt(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;attribute float a_scale;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);
#ifdef PROJECTION_GLOBE_VIEW
extrude*=a_scale;vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
vec3 pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:xt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:xt("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:xt("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:xt("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:xt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:xt(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:xt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=mix(color1,color2,u_fade);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:xt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:xt(`varying vec4 v_color;void main() {vec4 color=v_color;
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 pos=vec3(pos_nx.xy,h);
#else
vec3 pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(pos.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.rgb+=clamp(color.rgb*directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:xt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);out_color=out_color*v_lighting;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 p=vec3(pos_nx.xy,h);
#else
vec3 p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:xt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos);float f=getElevation(v_pos+vec2(epsilon.x,0));float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float h=getElevation(v_pos+vec2(0,epsilon.y));float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:xt(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:xt(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;uniform float u_mix;uniform vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;varying highp vec2 v_uv;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash_from
#pragma mapbox: define lowp vec4 dash_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash_from
#pragma mapbox: initialize lowp vec4 dash_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist_a=texture2D(u_dash_image,v_tex_a).a;float sdfdist_b=texture2D(u_dash_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfwidth=min(dash_from.z*u_scale.y,dash_to.z*u_scale.z);float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/sdfwidth;alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
#ifdef RENDER_LINE_GRADIENT
vec4 out_color=texture2D(u_gradient_image,v_uv);
#else
vec4 out_color=color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#ifdef RENDER_LINE_GRADIENT
attribute vec3 a_packed;
#else
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform mediump vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;varying highp vec2 v_uv;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash_from
#pragma mapbox: define lowp vec4 dash_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash_from
#pragma mapbox: initialize lowp vec4 dash_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_GRADIENT
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];float a_linesofar=a_packed[2];highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);
#endif
#ifdef RENDER_LINE_DASH
float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;float scaleA=dash_from.z==0.0 ? 0.0 : tileZoomRatio/(dash_from.z*fromScale);float scaleB=dash_to.z==0.0 ? 0.0 : tileZoomRatio/(dash_to.z*toScale);float heightA=dash_from.y;float heightB=dash_to.y;v_tex_a=vec2(a_linesofar*scaleA/floorwidth,(-normal.y*heightA+dash_from.x+0.5)/u_texsize.y);v_tex_b=vec2(a_linesofar*scaleB/floorwidth,(-normal.y*heightB+dash_to.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:xt(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:xt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:xt(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchor_z=a_z_tile_anchor.x;vec2 tile_anchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(vec3(a_pos,anchor_z)+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;float globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
vec3 world_pos=vec3(a_pos,anchor_z)+h;float globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point=u_matrix*vec4(a_pos+vec2(1,0),anchor_z,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(vec3(a_projected_pos.xy,anchor_z),mercator_pos,u_zoom_transition);
#else
vec3 proj_pos=vec3(a_projected_pos.xy,anchor_z);
#endif
#ifdef PROJECTED_POS_ON_VIEWPORT
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xy,0.0,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xyz+h,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:xt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchor_z=a_z_tile_anchor.x;vec2 tile_anchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(vec3(a_pos,anchor_z)+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;float globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
vec3 world_pos=vec3(a_pos,anchor_z)+h;float globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point=u_matrix*vec4(a_pos+vec2(1,0),anchor_z,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(vec3(a_projected_pos.xy,anchor_z),mercator_pos,u_zoom_transition);
#else
vec3 proj_pos=vec3(a_projected_pos.xy,anchor_z);
#endif
#ifdef PROJECTED_POS_ON_VIEWPORT
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xy,0.0,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xyz+h,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:xt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchor_z=a_z_tile_anchor.x;vec2 tile_anchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(vec3(a_pos,anchor_z)+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;float globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
vec3 world_pos=vec3(a_pos,anchor_z)+h;float globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),anchor_z,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(vec3(a_projected_pos.xy,anchor_z),mercator_pos,u_zoom_transition);
#else
vec3 proj_pos=vec3(a_projected_pos.xy,anchor_z);
#endif
#ifdef PROJECTED_POS_ON_VIEWPORT
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xy,0.0,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xyz+h,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:xt(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef FOG
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
const float skirtOffset=24575.0;const float wireframeOffset=0.00015;void main() {v_pos0=a_texture_pos/8192.0;float skirt=float(a_pos.x >=skirtOffset);float elevation=elevation(a_texture_pos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=u_skirt_height*u_skirt_height*wireframeOffset;
#endif
vec2 decodedPos=a_pos-vec2(skirt*skirtOffset,0.0);gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
}`),terrainDepth:xt(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying float v_depth;void main() {float elevation=elevation(a_texture_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:xt(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Rs),skyboxGradient:xt(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Rs),skyboxCapture:xt(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:xt(`uniform sampler2D u_image0;varying vec2 v_pos0;void main() {gl_FragColor=texture2D(u_image0,v_pos0);
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_merc_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 merc_pos=a_merc_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idy=u_grid_matrix[1][2];float S=u_grid_matrix[2][2];vec3 latLng=u_grid_matrix*vec3(a_pos,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=a_pos[0]*S;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;uv=uv*EXTENT;vec4 up_vector=vec4(elevationVector(uv),1.0);float height=elevation(uv);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
vec4 globe=u_globe_matrix*vec4(globe_pos+up_vector.xyz*height,1.0);vec4 mercator=vec4(0.0);if (u_zoom_transition > 0.0) {mercator=vec4(merc_pos,height,1.0);mercator.xy-=u_merc_center;mercator.x=wrap(mercator.x,-0.5,0.5);mercator=u_merc_matrix*mercator;}vec3 position=mix(globe.xyz,mercator.xyz,u_zoom_transition);gl_Position=u_proj_matrix*vec4(position,1.0);}`),globeAtmosphere:xt(`uniform float u_opacity;uniform highp float u_fadeout_range;uniform vec3 u_start_color;uniform vec3 u_end_color;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;varying highp vec3 v_ray_dir;void main() {highp vec3 dir=normalize(v_ray_dir);highp vec3 closest_point=abs(dot(u_globe_pos,dir))*dir;float norm_dist_from_center=length(closest_point-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 1.0)
discard;float t=clamp(1.0-sqrt(norm_dist_from_center-1.0)/u_fadeout_range,0.0,1.0);vec3 color=mix(u_start_color,u_end_color,1.0-t);gl_FragColor=vec4(color*t*u_opacity,u_opacity);}`,"attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;varying highp vec3 v_ray_dir;void main() {v_ray_dir=mix(mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);gl_Position=vec4(a_pos,1.0);}")};function xt(l,t,s){const h=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,m=/uniform (highp |mediump |lowp )?([\w]+) ([\w]+)([\s]*)([\w]*)/g,_=t.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),x=l.match(m),A=t.match(m),C=Ls.match(m);let S=A?A.concat(x):x;s||(bo.staticUniforms&&(S=bo.staticUniforms.concat(S)),Nr.staticUniforms&&(S=Nr.staticUniforms.concat(S))),S&&(S=S.concat(C));const z={};return{fragmentSource:l=l.replace(h,(B,N,G,V,O)=>(z[O]=!0,N==="define"?`
#ifndef HAS_UNIFORM_u_${O}
varying ${G} ${V} ${O};
#else
uniform ${G} ${V} u_${O};
#endif
`:`
#ifdef HAS_UNIFORM_u_${O}
    ${G} ${V} ${O} = u_${O};
#endif
`)),vertexSource:t=t.replace(h,(B,N,G,V,O)=>{const $=V==="float"?"vec2":"vec4",W=O.match(/color/)?"color":$;return z[O]?N==="define"?`
#ifndef HAS_UNIFORM_u_${O}
uniform lowp float u_${O}_t;
attribute ${G} ${$} a_${O};
varying ${G} ${V} ${O};
#else
uniform ${G} ${V} u_${O};
#endif
`:W==="vec4"?`
#ifndef HAS_UNIFORM_u_${O}
    ${O} = a_${O};
#else
    ${G} ${V} ${O} = u_${O};
#endif
`:`
#ifndef HAS_UNIFORM_u_${O}
    ${O} = unpack_mix_${W}(a_${O}, u_${O}_t);
#else
    ${G} ${V} ${O} = u_${O};
#endif
`:N==="define"?`
#ifndef HAS_UNIFORM_u_${O}
uniform lowp float u_${O}_t;
attribute ${G} ${$} a_${O};
#else
uniform ${G} ${V} u_${O};
#endif
`:W==="vec4"?`
#ifndef HAS_UNIFORM_u_${O}
    ${G} ${V} ${O} = a_${O};
#else
    ${G} ${V} ${O} = u_${O};
#endif
`:`
#ifndef HAS_UNIFORM_u_${O}
    ${G} ${V} ${O} = unpack_mix_${W}(a_${O}, u_${O}_t);
#else
    ${G} ${V} ${O} = u_${O};
#endif
`}),staticAttributes:_,staticUniforms:S}}class Ba{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,s,h,m,_,x,A,C){this.context=t;let S=this.boundPaintVertexBuffers.length!==m.length;for(let z=0;!S&&z<m.length;z++)this.boundPaintVertexBuffers[z]!==m[z]&&(S=!0);t.extVertexArrayObject&&this.vao&&this.boundProgram===s&&this.boundLayoutVertexBuffer===h&&!S&&this.boundIndexBuffer===_&&this.boundVertexOffset===x&&this.boundDynamicVertexBuffer===A&&this.boundDynamicVertexBuffer2===C?(t.bindVertexArrayOES.set(this.vao),A&&A.bind(),_&&_.dynamicDraw&&_.bind(),C&&C.bind()):this.freshBind(s,h,m,_,x,A,C)}freshBind(t,s,h,m,_,x,A){let C;const S=t.numAttributes,z=this.context,B=z.gl;if(z.extVertexArrayObject)this.vao&&this.destroy(),this.vao=z.extVertexArrayObject.createVertexArrayOES(),z.bindVertexArrayOES.set(this.vao),C=0,this.boundProgram=t,this.boundLayoutVertexBuffer=s,this.boundPaintVertexBuffers=h,this.boundIndexBuffer=m,this.boundVertexOffset=_,this.boundDynamicVertexBuffer=x,this.boundDynamicVertexBuffer2=A;else{C=z.currentNumAttributes||0;for(let N=S;N<C;N++)B.disableVertexAttribArray(N)}s.enableAttributes(B,t);for(const N of h)N.enableAttributes(B,t);x&&x.enableAttributes(B,t),A&&A.enableAttributes(B,t),s.bind(),s.setVertexAttribPointers(B,t,_);for(const N of h)N.bind(),N.setVertexAttribPointers(B,t,_);x&&(x.bind(),x.setVertexAttribPointers(B,t,_)),m&&m.bind(),A&&(A.bind(),A.setVertexAttribPointers(B,t,_)),z.currentNumAttributes=S}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function ju(l,t){const s=Math.pow(2,t.canonical.z),h=t.canonical.y;return[new o.MercatorCoordinate(0,h/s).toLngLat().lat,new o.MercatorCoordinate(0,(h+1)/s).toLngLat().lat]}function Gu(l,t,s,h,m,_,x){const A=l.context,C=A.gl,S=s.fbo;if(!S)return;l.prepareDrawTile();const z=l.useProgram("hillshade");A.activeTexture.set(C.TEXTURE0),C.bindTexture(C.TEXTURE_2D,S.colorAttachment.get());const B=((O,$,W,Q)=>{const K=W.paint.get("hillshade-shadow-color"),ee=W.paint.get("hillshade-highlight-color"),X=W.paint.get("hillshade-accent-color");let re=W.paint.get("hillshade-illumination-direction")*(Math.PI/180);W.paint.get("hillshade-illumination-anchor")==="viewport"&&(re-=O.transform.angle);const ge=!O.options.moving;return{u_matrix:Q||O.transform.calculateProjMatrix($.tileID.toUnwrapped(),ge),u_image:0,u_latrange:ju(0,$.tileID),u_light:[W.paint.get("hillshade-exaggeration"),re],u_shadow:K,u_highlight:ee,u_accent:X}})(l,s,h,l.terrain?t.projMatrix:null);l.prepareDrawProgram(A,z,t.toUnwrapped());const{tileBoundsBuffer:N,tileBoundsIndexBuffer:G,tileBoundsSegments:V}=l.getTileBoundsBuffers(s);z.draw(A,C.TRIANGLES,m,_,x,o.CullFaceMode.disabled,B,h.id,N,G,V)}function Ql(l,t,s){if(!t.needsDEMTextureUpload)return;const h=l.context,m=h.gl;h.pixelStoreUnpackPremultiplyAlpha.set(!1),t.demTexture=t.demTexture||l.getTileTexture(s.stride);const _=s.getPixels();t.demTexture?t.demTexture.update(_,{premultiply:!1}):t.demTexture=new o.Texture(h,_,m.RGBA,{premultiply:!1}),t.needsDEMTextureUpload=!1}function Kl(l,t,s,h,m,_){const x=l.context,A=x.gl;if(!t.dem)return;const C=t.dem;if(x.activeTexture.set(A.TEXTURE1),Ql(l,t,C),!t.demTexture)return;t.demTexture.bind(A.NEAREST,A.CLAMP_TO_EDGE);const S=C.dim;x.activeTexture.set(A.TEXTURE0);let z=t.fbo;if(!z){const V=new o.Texture(x,{width:S,height:S,data:null},A.RGBA);V.bind(A.LINEAR,A.CLAMP_TO_EDGE),z=t.fbo=x.createFramebuffer(S,S,!0),z.colorAttachment.set(V.texture)}x.bindFramebuffer.set(z.framebuffer),x.viewport.set([0,0,S,S]);const{tileBoundsBuffer:B,tileBoundsIndexBuffer:N,tileBoundsSegments:G}=l.getMercatorTileBoundsBuffers();l.useProgram("hillshadePrepare").draw(x,A.TRIANGLES,h,m,_,o.CullFaceMode.disabled,((V,O)=>{const $=O.stride,W=o.create();return o.ortho(W,0,o.EXTENT,-o.EXTENT,0,0,1),o.translate(W,W,[0,-o.EXTENT,0]),{u_matrix:W,u_image:1,u_dimension:[$,$],u_zoom:V.overscaledZ,u_unpack:O.unpackVector}})(t.tileID,C),s.id,B,N,G),t.needsHillshadePrepare=!1}const $l=(l,t)=>({u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_image0:new o.Uniform1i(l,t.u_image0),u_skirt_height:new o.Uniform1f(l,t.u_skirt_height)}),Zu=(l,t)=>({u_matrix:l,u_image0:0,u_skirt_height:t}),qu=(l,t,s,h,m,_)=>({u_proj_matrix:Float32Array.from(l),u_globe_matrix:t,u_merc_matrix:s,u_zoom_transition:h,u_merc_center:m,u_image0:0,u_grid_matrix:_?Float32Array.from(_):new Float32Array(9)});function La(l,t){return l!=null&&t!=null&&!(!l.hasData()||!t.hasData())&&l.demTexture!=null&&t.demTexture!=null&&l.tileID.key!==t.tileID.key}const Ur=new class{constructor(){this.operations={}}newMorphing(l,t,s,h,m){if(l in this.operations){const _=this.operations[l];_.to.tileID.key!==s.tileID.key&&(_.queued=s)}else this.operations[l]={startTime:h,phase:0,duration:m,from:t,to:s,queued:null}}getMorphValuesForProxy(l){if(!(l in this.operations))return null;const t=this.operations[l];return{from:t.from,to:t.to,phase:t.phase}}update(l){for(const t in this.operations){const s=this.operations[t];for(s.phase=(l-s.startTime)/s.duration;s.phase>=1||!this._validOp(s);)if(!this._nextOp(s,l)){delete this.operations[t];break}}}_nextOp(l,t){return!!l.queued&&(l.from=l.to,l.to=l.queued,l.queued=null,l.phase=0,l.startTime=t,!0)}_validOp(l){return l.from.hasData()&&l.to.hasData()}},Qo={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Jl(l,t){const s=1<<l.z;return!t&&(l.x===0||l.x===s-1)||l.y===0||l.y===s-1}const Ra=l=>({u_matrix:l});function ec(l,t,s,h,m){if(m>0){const _=o.exported.now(),x=(_-l.timeAdded)/m,A=t?(_-t.timeAdded)/m:-1,C=s.getSource(),S=h.coveringZoomLevel({tileSize:C.tileSize,roundZoom:C.roundZoom}),z=!t||Math.abs(t.tileID.overscaledZ-S)>Math.abs(l.tileID.overscaledZ-S),B=z&&l.refreshedUponExpiration?1:o.clamp(z?x:1-A,0,1);return l.refreshedUponExpiration&&x>=1&&(l.refreshedUponExpiration=!1),t?{opacity:1,mix:1-B}:{opacity:B,mix:0}}return{opacity:1,mix:0}}const tp=2*o.mercatorZfromAltitude(1,0)*o.GLOBE_RADIUS*Math.PI;class Ns extends o.SourceCache{constructor(t){const s={type:"raster-dem",maxzoom:t.transform.maxZoom},h=new Gt(St(),null),m=fe("mock-dem",s,h,t.style);super("mock-dem",m,!1),m.setEventedParent(this),this._sourceLoaded=!0}_loadTile(t,s){t.state="loaded",s(null)}}class Us extends o.SourceCache{constructor(t){const s=fe("proxy",{type:"geojson",maxzoom:t.transform.maxZoom},new Gt(St(),null),t.style);super("proxy",s,!1),s.setEventedParent(this),this.map=this.getSource().map=t,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(t,s,h){if(t.freezeTileCoverage)return;this.transform=t;const m=t.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((_,x)=>{if(_[x.key]="",!this._tiles[x.key]){const A=new o.Tile(x,this._source.tileSize*x.overscaleFactor(),t.tileZoom);A.state="loaded",this._tiles[x.key]=A}return _},{});for(const _ in this._tiles)_ in m||(this.freeFBO(_),this._tiles[_].unloadVectorData(),delete this._tiles[_])}freeFBO(t){const s=this.proxyCachedFBO[t];if(s!==void 0){const h=Object.values(s);this.renderCachePool.push(...h),delete this.proxyCachedFBO[t]}}deallocRenderCache(){this.renderCache.forEach(t=>t.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class tc extends o.OverscaledTileID{constructor(t,s,h){super(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y),this.proxyTileKey=s,this.projMatrix=h}}class zn extends o.Elevation{constructor(t,s){super(),this.painter=t,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[h,m,_]=function(C){const S=new o.StructArrayLayout4i8,z=new o.StructArrayLayout3ui6,B=131;S.reserve(17161),z.reserve(33800);const N=o.EXTENT/128,G=o.EXTENT+N/2,V=G+N;for(let $=-N;$<V;$+=N)for(let W=-N;W<V;W+=N){const Q=W<0||W>G||$<0||$>G?24575:0,K=o.clamp(Math.round(W),0,o.EXTENT),ee=o.clamp(Math.round($),0,o.EXTENT);S.emplaceBack(K+Q,ee,K,ee)}const O=($,W)=>{const Q=W*B+$;z.emplaceBack(Q+1,Q,Q+B),z.emplaceBack(Q+B,Q+B+1,Q+1)};for(let $=1;$<129;$++)for(let W=1;W<129;W++)O(W,$);return[0,129].forEach($=>{for(let W=0;W<130;W++)O(W,$),O($,W)}),[S,z,32768]}(),x=t.context;this.gridBuffer=x.createVertexBuffer(h,o.boundsAttributes.members),this.gridIndexBuffer=x.createIndexBuffer(m),this.gridSegments=o.SegmentVector.simpleSegment(0,0,h.length,m.length),this.gridNoSkirtSegments=o.SegmentVector.simpleSegment(0,0,h.length,_),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Us(s.map),this.orthoMatrix=o.create(),o.ortho(this.orthoMatrix,0,o.EXTENT,0,o.EXTENT,0,1);const A=x.gl;this._overlapStencilMode=new o.StencilMode({func:A.GEQUAL,mask:255},0,255,A.KEEP,A.KEEP,A.REPLACE),this._previousZoom=t.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=s,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Ns(s.map)}set style(t){t.on("data",this._onStyleDataEvent.bind(this)),t.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=t,this._checkRenderCacheEfficiency()}update(t,s,h){if(t&&t.terrain){this._style!==t&&(this.style=t),this.enabled=!0;const m=t.terrain.properties;this.sourceCache=t.terrain.drapeRenderMode===0?this._mockSourceCache:t._getSourceCache(m.get("source")),this._exaggeration=m.get("exaggeration");const _=()=>{this.sourceCache.used&&o.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const x=this.getScaledDemTileSize();this.sourceCache.update(s,x,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,_(),this._initializing=!0),_(),s.updateElevation(!h),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(s),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(t){this._findCoveringTileCache[t]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const t=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||t.efficiency!==100&&o.warnOnce(`Terrain render cache efficiency is not optimal (${t.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${t.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(t){t.coord&&t.dataType==="source"?this._clearRenderCacheForTile(t.sourceCacheId,t.coord):t.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const t in this._style._sourceCaches)this._style._sourceCaches[t].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(t=>t.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const t=2*this.proxySourceCache.getSource().tileSize;return[t,t]}set useVertexMorphing(t){this._useVertexMorphing=t}updateTileBinding(t){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const s=this.proxySourceCache,h=this.painter.transform;this._initializing&&(this._initializing=h._centerAltitude===0&&this.getAtPointOrZero(o.MercatorCoordinate.fromLngLat(h.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const m=this.proxyCoords=s.getIds().map(C=>{const S=s.getTileByID(C).tileID;return S.projMatrix=h.calculateProjMatrix(S.toUnwrapped()),S});(function(C,S){const z=S.transform.pointCoordinate(S.transform.getCameraPoint()),B=new o.pointGeometry(z.x,z.y);C.sort((N,G)=>{if(G.overscaledZ-N.overscaledZ)return G.overscaledZ-N.overscaledZ;const V=new o.pointGeometry(N.canonical.x+(1<<N.canonical.z)*N.wrap,N.canonical.y),O=new o.pointGeometry(G.canonical.x+(1<<G.canonical.z)*G.wrap,G.canonical.y),$=B.mult(1<<N.canonical.z);return $.x-=.5,$.y-=.5,$.distSqr(V)-$.distSqr(O)})})(m,this.painter),this._previousZoom=h.zoom;const _=this.proxyToSource||{};this.proxyToSource={},m.forEach(C=>{this.proxyToSource[C.key]={}}),this.terrainTileForTile={};const x=this._style._sourceCaches;for(const C in x){const S=x[C];if(!S.used||(S!==this.sourceCache&&this.resetTileLookupCache(S.id),this._setupProxiedCoordsForOrtho(S,t[C],_),S.usedForTerrain))continue;const z=t[C];S.getSource().reparseOverscaled&&this._assignTerrainTiles(z)}this.proxiedCoords[s.id]=m.map(C=>new tc(C,C.key,this.orthoMatrix)),this._assignTerrainTiles(m),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(_),this.renderingToTexture=!1,this._updateTimestamp=o.exported.now();const A={};this._visibleDemTiles=[];for(const C of this.proxyCoords){const S=this.terrainTileForTile[C.key];if(!S)continue;const z=S.tileID.key;z in A||(this._visibleDemTiles.push(S),A[z]=z)}}_assignTerrainTiles(t){this._initializing||t.forEach(s=>{if(this.terrainTileForTile[s.key])return;const h=this._findTileCoveringTileID(s,this.sourceCache);h&&(this.terrainTileForTile[s.key]=h)})}_prepareDEMTextures(){const t=this.painter.context,s=t.gl;for(const h in this.terrainTileForTile){const m=this.terrainTileForTile[h],_=m.dem;!_||m.demTexture&&!m.needsDEMTextureUpload||(t.activeTexture.set(s.TEXTURE1),Ql(this.painter,m,_))}}_prepareDemTileUniforms(t,s,h,m){if(!s||s.demTexture==null)return!1;const _=t.tileID.canonical,x=Math.pow(2,s.tileID.canonical.z-_.z),A=m||"";return h[`u_dem_tl${A}`]=[_.x*x%1,_.y*x%1],h[`u_dem_scale${A}`]=x,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const t=this.painter.context,s=t.gl;if(!this._emptyDepthBufferTexture){const h=new o.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new o.Texture(t,h,s.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let t=0;const s=this._visibleDemTiles.reduce((h,m)=>{if(!m.dem)return h;const _=m.dem.tree.minimums[0];return _>0&&t++,h+_},0);return t?s/t:0}_updateEmptyDEMTexture(){const t=this.painter.context,s=t.gl;t.activeTexture.set(s.TEXTURE2);const h=this._getLoadedAreaMinimum(),m=new o.RGBAImage({width:1,height:1},new Uint8Array(o.DEMData.pack(h,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let _=this._emptyDEMTexture;return _?_.update(m,{premultiply:!1}):_=this._emptyDEMTexture=new o.Texture(t,m,s.RGBA,{premultiply:!1}),_}setupElevationDraw(t,s,h){const m=this.painter.context,_=m.gl,x=(A=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:o.DEMData.getUnpackVector(A),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0,u_tile_tl_up:[0,0,1],u_tile_tr_up:[0,0,1],u_tile_br_up:[0,0,1],u_tile_bl_up:[0,0,1],u_tile_up_scale:1});var A;x.u_dem_size=this.sourceCache.getSource().tileSize,x.u_exaggeration=this.exaggeration();const C=this.painter.transform,S=C.projection,z=t.tileID.canonical;x.u_tile_tl_up=S.upVector(z,0,0),x.u_tile_tr_up=S.upVector(z,o.EXTENT,0),x.u_tile_br_up=S.upVector(z,o.EXTENT,o.EXTENT),x.u_tile_bl_up=S.upVector(z,0,o.EXTENT),x.u_tile_up_scale=h&&h.useDenormalizedUpVectorScale?tp:S.upVectorScale(z,C.center.lat,C.worldSize).metersToTile;let B=null,N=null,G=1;if(h&&h.morphing&&this._useVertexMorphing){const V=h.morphing.srcDemTile,O=h.morphing.dstDemTile;G=h.morphing.phase,V&&O&&(this._prepareDemTileUniforms(t,V,x,"_prev")&&(N=V),this._prepareDemTileUniforms(t,O,x)&&(B=O))}if(N&&B?(m.activeTexture.set(_.TEXTURE2),B.demTexture.bind(_.NEAREST,_.CLAMP_TO_EDGE,_.NEAREST),m.activeTexture.set(_.TEXTURE4),N.demTexture.bind(_.NEAREST,_.CLAMP_TO_EDGE,_.NEAREST),x.u_dem_lerp=G):(B=this.terrainTileForTile[t.tileID.key],m.activeTexture.set(_.TEXTURE2),(this._prepareDemTileUniforms(t,B,x)?B.demTexture:this.emptyDEMTexture).bind(_.NEAREST,_.CLAMP_TO_EDGE)),m.activeTexture.set(_.TEXTURE3),h&&h.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(_.NEAREST,_.CLAMP_TO_EDGE),this._depthFBO&&(x.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(_.NEAREST,_.CLAMP_TO_EDGE),x.u_depth_size_inv=[1,1]),h&&h.useMeterToDem&&B){const V=(1<<B.tileID.canonical.z)*o.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;x.u_meter_to_dem=V}h&&h.labelPlaneMatrixInv&&(x.u_label_plane_matrix_inv=h.labelPlaneMatrixInv),s.setTerrainUniformValues(m,x)}renderToBackBuffer(t){const s=this.painter,h=this.painter.context;t.length!==0&&(h.bindFramebuffer.set(null),h.viewport.set([0,0,s.width,s.height]),this.renderingToTexture=!1,function(m,_,x,A,C){if(m.transform.projection.name==="globe")(function(S,z,B,N,G){const V=S.context,O=V.gl;let $,W;const Q=S.options.showTerrainWireframe?2:0,K=(Ce,Ze)=>{if(W===Ce)return;const ye=[Qo[Ce],"PROJECTION_GLOBE_VIEW"];Ze&&ye.push(Qo[Q]),$=S.useProgram("globeRaster",null,ye),W=Ce},ee=S.colorModeForRenderPass(),X=new o.DepthMode(O.LEQUAL,o.DepthMode.ReadWrite,S.depthRangeFor3D);Ur.update(G);const re=S.transform,ge=o.calculateGlobeMercatorMatrix(re),Ae=[o.mercatorXfromLng(re.center.lng),o.mercatorYfromLat(re.center.lat)],Se=S.globeSharedBuffers;if((Q?[!1,!0]:[!1]).forEach(Ce=>{W=-1;const Ze=Ce?O.LINES:O.TRIANGLES;for(const ye of N){const je=B.getTile(ye),Ue=o.StencilMode.disabled,lt=z.prevTerrainTileForTile[ye.key],we=z.terrainTileForTile[ye.key];La(lt,we)&&Ur.newMorphing(ye.key,lt,we,G,250),V.activeTexture.set(O.TEXTURE0),je.texture.bind(O.LINEAR,O.CLAMP_TO_EDGE);const pt=Ur.getMorphValuesForProxy(ye.key),yt=pt?1:0,ot={useDenormalizedUpVectorScale:!0};pt&&o.extend$1(ot,{morphing:{srcDemTile:pt.from,dstDemTile:pt.to,phase:o.easeCubicInOut(pt.phase)}});const st=Float32Array.from(re.globeMatrix),Et=o.globeTileLatLngCorners(ye.canonical),Ft=o.getGridMatrix(ye.canonical,Et),ht=qu(re.projMatrix,st,ge,o.globeToMercatorTransition(re.zoom),Ae,Ft);if(K(yt,Ce),z.setupElevationDraw(je,$,ot),S.prepareDrawProgram(V,$,ye.toUnwrapped()),Se){const[kt,$t,ki]=Ce?Se.getWirefameBuffers(S.context):Se.getGridBuffers();$.draw(V,Ze,X,Ue,ee,o.CullFaceMode.backCCW,ht,"globe_raster",kt,$t,ki)}}}),Se){$=S.useProgram("globeRaster",null,["GLOBE_POLES","PROJECTION_GLOBE_VIEW"]);for(const Ce of N){const{x:Ze,y:ye,z:je}=Ce.canonical,Ue=ye===0,lt=ye===(1<<je)-1,[we,pt,yt,ot]=Se.getPoleBuffers(je);if(ot&&(Ue||lt)){const st=B.getTile(Ce);V.activeTexture.set(O.TEXTURE0),st.texture.bind(O.LINEAR,O.CLAMP_TO_EDGE);let Et=o.globePoleMatrixForTile(je,Ze,re);const Ft=(ht,kt)=>ht.draw(V,O.TRIANGLES,X,o.StencilMode.disabled,ee,o.CullFaceMode.disabled,qu(re.projMatrix,Et,Et,0,Ae),"globe_pole_raster",kt,yt,ot);z.setupElevationDraw(st,$,{}),S.prepareDrawProgram(V,$,Ce.toUnwrapped()),Ue&&Ft($,we),lt&&(Et=o.scale(o.create(),Et,[1,-1,1]),Ft($,pt))}}}})(m,_,x,A,C);else{const S=m.context,z=S.gl;let B,N;const G=m.options.showTerrainWireframe?2:0,V=(K,ee)=>{if(N===K)return;const X=[Qo[K]];ee&&X.push(Qo[G]),B=m.useProgram("terrainRaster",null,X),N=K},O=m.colorModeForRenderPass(),$=new o.DepthMode(z.LEQUAL,o.DepthMode.ReadWrite,m.depthRangeFor3D);Ur.update(C);const W=m.transform,Q=6*Math.pow(1.5,22-W.zoom)*_.exaggeration();(G?[!1,!0]:[!1]).forEach(K=>{N=-1;const ee=K?z.LINES:z.TRIANGLES,[X,re]=K?_.getWirefameBuffer():[_.gridIndexBuffer,_.gridSegments];for(const ge of A){const Ae=x.getTile(ge),Se=o.StencilMode.disabled,Ce=_.prevTerrainTileForTile[ge.key],Ze=_.terrainTileForTile[ge.key];La(Ce,Ze)&&Ur.newMorphing(ge.key,Ce,Ze,C,250),S.activeTexture.set(z.TEXTURE0),Ae.texture.bind(z.LINEAR,z.CLAMP_TO_EDGE,z.LINEAR_MIPMAP_NEAREST);const ye=Ur.getMorphValuesForProxy(ge.key),je=ye?1:0;let Ue;ye&&(Ue={morphing:{srcDemTile:ye.from,dstDemTile:ye.to,phase:o.easeCubicInOut(ye.phase)}});const lt=Zu(ge.projMatrix,Jl(ge.canonical,W.renderWorldCopies)?Q/10:Q);V(je,K),_.setupElevationDraw(Ae,B,Ue),m.prepareDrawProgram(S,B,ge.toUnwrapped()),B.draw(S,ee,$,Se,O,o.CullFaceMode.backCCW,lt,"terrain_raster",_.gridBuffer,X,re)}})}}(s,this,this.proxySourceCache,t,this._updateTimestamp),this.renderingToTexture=!0,t.splice(0,t.length))}renderBatch(t){if(this._drapedRenderBatches.length===0)return t+1;this.renderingToTexture=!0;const s=this.painter,h=this.painter.context,m=this.proxySourceCache,_=this.proxiedCoords[m.id],x=this._drapedRenderBatches.shift(),A=[],C=s.style.order;let S=0;for(const z of _){const B=m.getTileByID(z.proxyTileKey),N=m.proxyCachedFBO[z.key]?m.proxyCachedFBO[z.key][t]:void 0,G=N!==void 0?m.renderCache[N]:this.pool[S++],V=N!==void 0;if(B.texture=G.tex,V&&!G.dirty){A.push(B.tileID);continue}let O;h.bindFramebuffer.set(G.fb.framebuffer),this.renderedToTile=!1,G.dirty&&(h.clear({color:o.Color.transparent,stencil:0}),G.dirty=!1);for(let $=x.start;$<=x.end;++$){const W=s.style._layers[C[$]];if(W.isHidden(s.transform.zoom))continue;const Q=s.style._getLayerSourceCache(W),K=Q?this.proxyToSource[z.key][Q.id]:[z];if(!K)continue;const ee=K;h.viewport.set([0,0,G.fb.width,G.fb.height]),O!==(Q?Q.id:null)&&(this._setupStencil(G,K,W,Q),O=Q?Q.id:null),s.renderLayer(s,Q,W,ee)}this.renderedToTile?(G.dirty=!0,A.push(B.tileID)):V||--S,S===5&&(S=0,this.renderToBackBuffer(A))}return this.renderToBackBuffer(A),this.renderingToTexture=!1,h.bindFramebuffer.set(null),h.viewport.set([0,0,s.width,s.height]),x.end+1}postRender(){}renderCacheEfficiency(t){const s=t.order.length;if(s===0)return{efficiency:100};let h,m=0,_=0,x=!1;for(let A=0;A<s;++A){const C=t._layers[t.order[A]];this._style.isLayerDraped(C)?(x&&++m,++_):x||(x=!0,h=C.id)}return _===0?{efficiency:100}:{efficiency:100*(1-m/_),firstUndrapedLayer:h}}getMinElevationBelowMSL(){let t=0;return this._visibleDemTiles.filter(s=>s.dem).forEach(s=>{t=Math.min(t,s.dem.tree.minimums[0])}),t===0?t:(t-30)*this._exaggeration}raycast(t,s,h){if(!this._visibleDemTiles)return null;const m=this._visibleDemTiles.filter(_=>_.dem).map(_=>{const x=_.tileID,A=Math.pow(2,x.overscaledZ),{x:C,y:S}=x.canonical,z=C/A,B=(C+1)/A,N=S/A,G=(S+1)/A;return{minx:z,miny:N,maxx:B,maxy:G,t:_.dem.tree.raycastRoot(z,N,B,G,t,s,h),tile:_}});m.sort((_,x)=>(_.t!==null?_.t:Number.MAX_VALUE)-(x.t!==null?x.t:Number.MAX_VALUE));for(const _ of m){if(_.t==null)return null;const x=_.tile.dem.tree.raycast(_.minx,_.miny,_.maxx,_.maxy,t,s,h);if(x!=null)return x}return null}_createFBO(){const t=this.painter.context,s=t.gl,h=this.drapeBufferSize;t.activeTexture.set(s.TEXTURE0);const m=new o.Texture(t,{width:h[0],height:h[1],data:null},s.RGBA);m.bind(s.LINEAR,s.CLAMP_TO_EDGE);const _=t.createFramebuffer(h[0],h[1],!1);return _.colorAttachment.set(m.texture),_.depthAttachment=new Zo(t,_.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=t.createRenderbuffer(t.gl.DEPTH_STENCIL,h[0],h[1]),this._stencilRef=0,_.depthAttachment.set(this._sharedDepthStencil),t.clear({stencil:0})):_.depthAttachment.set(this._sharedDepthStencil),t.extTextureFilterAnisotropic&&!t.extTextureFilterAnisotropicForceOff&&s.texParameterf(s.TEXTURE_2D,t.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,t.extTextureFilterAnisotropicMax),{fb:_,tex:m,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const t in this._style._sourceCaches)if(this._style._sourceCaches[t].hasTransition())return!0;return this._style.order.some(t=>{const s=this._style._layers[t],h=s.isHidden(this.painter.transform.zoom),m=s.getCrossfadeParameters(),_=!!m&&m.t!==1,x=s.hasTransition();return s.type!=="custom"&&!h&&(_||x)})}_clearRasterFadeFromRenderCache(){let t=!1;for(const s in this._style._sourceCaches)if(this._style._sourceCaches[s]._source instanceof R){t=!0;break}if(t)for(let s=0;s<this._style.order.length;++s){const h=this._style._layers[this._style.order[s]],m=h.isHidden(this.painter.transform.zoom),_=this._style._getLayerSourceCache(h);if(h.type!=="raster"||m||!_)continue;const x=h.paint.get("raster-fade-duration");for(const A of this.proxyCoords){const C=this.proxyToSource[A.key][_.id];if(C)for(const S of C){const z=ec(_.getTile(S),_.findLoadedParent(S,0),_,this.painter.transform,x);(z.opacity!==1||z.mix!==0)&&this._clearRenderCacheForTile(_.id,S)}}}}_setupDrapedRenderBatches(){const t=this._style.order,s=t.length;if(s===0)return;const h=[];let m,_=0,x=this._style._layers[t[_]];for(;!this._style.isLayerDraped(x)&&x.isHidden(this.painter.transform.zoom)&&++_<s;)x=this._style._layers[t[_]];for(;_<s;++_){const A=this._style._layers[t[_]];A.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(A)?m===void 0&&(m=_):m!==void 0&&(h.push({start:m,end:_-1}),m=void 0))}m!==void 0&&h.push({start:m,end:_-1}),this._drapedRenderBatches=h}_setupRenderCache(t){const s=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,s.renderCache.length>s.renderCachePool.length){const x=Object.values(s.proxyCachedFBO);s.proxyCachedFBO={};for(let A=0;A<x.length;++A){const C=Object.values(x[A]);s.renderCachePool.push(...C)}}return}this._clearRasterFadeFromRenderCache();const h=this.proxyCoords,m=this._tilesDirty;for(let x=h.length-1;x>=0;x--){const A=h[x];if(s.getTileByID(A.key),s.proxyCachedFBO[A.key]!==void 0){const C=t[A.key],S=this.proxyToSource[A.key];let z=0;for(const B in S){const N=S[B],G=C[B];if(!G||G.length!==N.length||N.some((V,O)=>V!==G[O]||m[B]&&m[B].hasOwnProperty(V.key))){z=-1;break}++z}for(const B in s.proxyCachedFBO[A.key])s.renderCache[s.proxyCachedFBO[A.key][B]].dirty=z<0||z!==Object.values(C).length}}const _=[...this._drapedRenderBatches];_.sort((x,A)=>A.end-A.start-(x.end-x.start));for(const x of _)for(const A of h){if(s.proxyCachedFBO[A.key])continue;let C=s.renderCachePool.pop();C===void 0&&s.renderCache.length<50&&(C=s.renderCache.length,s.renderCache.push(this._createFBO())),C!==void 0&&(s.proxyCachedFBO[A.key]={},s.proxyCachedFBO[A.key][x.start]=C,s.renderCache[C].dirty=!0)}this._tilesDirty={}}_setupStencil(t,s,h,m){if(!m||!this._sourceTilesOverlap[m.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const _=this.painter.context,x=_.gl;if(s.length<=1)return void(this._overlapStencilType=!1);let A;if(h.isTileClipped())A=s.length,this._overlapStencilMode.test={func:x.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(s[0].overscaledZ>s[s.length-1].overscaledZ))return void(this._overlapStencilType=!1);A=1,this._overlapStencilMode.test={func:x.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+A>255&&(_.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=A,this._overlapStencilMode.ref=this._stencilRef,h.isTileClipped()&&this._renderTileClippingMasks(s,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(t){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs.get(t.key)||0),this._overlapStencilMode):o.StencilMode.disabled}_renderTileClippingMasks(t,s){const h=this.painter,m=this.painter.context,_=m.gl;h._tileClippingMaskIDs.clear(),m.setColorMode(o.ColorMode.disabled),m.setDepthMode(o.DepthMode.disabled);const x=h.useProgram("clippingMask");for(const A of t){const C=--s;h._tileClippingMaskIDs.set(A.key,C),x.draw(m,_.TRIANGLES,o.DepthMode.disabled,new o.StencilMode({func:_.ALWAYS,mask:0},C,255,_.KEEP,_.KEEP,_.REPLACE),o.ColorMode.disabled,o.CullFaceMode.disabled,Ra(A.projMatrix),"$clipping",h.tileExtentBuffer,h.quadTriangleIndexBuffer,h.tileExtentSegments)}}pointCoordinate(t){const s=this.painter.transform;if(t.x<0||t.x>s.width||t.y<0||t.y>s.height)return null;const h=[t.x,t.y,1,1];o.transformMat4$1(h,h,s.pixelMatrixInverse),o.scale$1(h,h,1/h[3]),h[0]/=s.worldSize,h[1]/=s.worldSize;const m=s._camera.position,_=o.mercatorZfromAltitude(1,s.center.lat),x=[m[0],m[1],m[2]/_,0],A=o.subtract([],h.slice(0,3),x);o.normalize(A,A);const C=this.raycast(x,A,this._exaggeration);return C!==null&&C?(o.scaleAndAdd(x,x,A,C),x[3]=x[2],x[2]*=_,x):null}drawDepth(){const t=this.painter,s=t.context,h=this.proxySourceCache,m=Math.ceil(t.width),_=Math.ceil(t.height);if(!this._depthFBO||this._depthFBO.width===m&&this._depthFBO.height===_||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const x=s.gl,A=s.createFramebuffer(m,_,!0);s.activeTexture.set(x.TEXTURE0);const C=new o.Texture(s,{width:m,height:_,data:null},x.RGBA);C.bind(x.NEAREST,x.CLAMP_TO_EDGE),A.colorAttachment.set(C.texture);const S=s.createRenderbuffer(s.gl.DEPTH_COMPONENT16,m,_);A.depthAttachment.set(S),this._depthFBO=A,this._depthTexture=C}s.bindFramebuffer.set(this._depthFBO.framebuffer),s.viewport.set([0,0,m,_]),function(x,A,C,S){if(x.transform.projection.name==="globe")return;const z=x.context,B=z.gl;z.clear({depth:1});const N=x.useProgram("terrainDepth"),G=new o.DepthMode(B.LESS,o.DepthMode.ReadWrite,x.depthRangeFor3D);for(const V of S){const O=C.getTile(V),$=Zu(V.projMatrix,0);A.setupElevationDraw(O,N),N.draw(z,B.TRIANGLES,G,o.StencilMode.disabled,o.ColorMode.unblended,o.CullFaceMode.backCCW,$,"terrain_depth",A.gridBuffer,A.gridIndexBuffer,A.gridNoSkirtSegments)}}(t,this,h,this.proxyCoords)}_setupProxiedCoordsForOrtho(t,s,h){if(t.getSource()instanceof ae)return this._setupProxiedCoordsForImageSource(t,s,h);this._findCoveringTileCache[t.id]=this._findCoveringTileCache[t.id]||{};const m=this.proxiedCoords[t.id]=[],_=this.proxyCoords;for(let A=0;A<_.length;A++){const C=_[A],S=this._findTileCoveringTileID(C,t);if(S){const z=this._createProxiedId(C,S,h[C.key]&&h[C.key][t.id]);m.push(z),this.proxyToSource[C.key][t.id]=[z]}}let x=!1;for(let A=0;A<s.length;A++){const C=t.getTile(s[A]);if(!C||!C.hasData())continue;const S=this._findTileCoveringTileID(C.tileID,this.proxySourceCache);if(S&&S.tileID.canonical.z!==C.tileID.canonical.z){const z=this.proxyToSource[S.tileID.key][t.id],B=this._createProxiedId(S.tileID,C,h[S.tileID.key]&&h[S.tileID.key][t.id]);z?z.splice(z.length-1,0,B):this.proxyToSource[S.tileID.key][t.id]=[B],m.push(B),x=!0}}this._sourceTilesOverlap[t.id]=x}_setupProxiedCoordsForImageSource(t,s,h){if(!t.getSource().loaded())return;const m=this.proxiedCoords[t.id]=[],_=this.proxyCoords,x=t.getSource(),A=new o.pointGeometry(x.tileID.x,x.tileID.y)._div(1<<x.tileID.z),C=x.coordinates.map(o.MercatorCoordinate.fromLngLat).reduce((z,B)=>(z.min.x=Math.min(z.min.x,B.x-A.x),z.min.y=Math.min(z.min.y,B.y-A.y),z.max.x=Math.max(z.max.x,B.x-A.x),z.max.y=Math.max(z.max.y,B.y-A.y),z),{min:new o.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new o.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),S=(z,B)=>{const N=z.wrap+z.canonical.x/(1<<z.canonical.z),G=z.canonical.y/(1<<z.canonical.z),V=o.EXTENT/(1<<z.canonical.z),O=B.wrap+B.canonical.x/(1<<B.canonical.z),$=B.canonical.y/(1<<B.canonical.z);return N+V<O+C.min.x||N>O+C.max.x||G+V<$+C.min.y||G>$+C.max.y};for(let z=0;z<_.length;z++){const B=_[z];for(let N=0;N<s.length;N++){const G=t.getTile(s[N]);if(!G||!G.hasData()||S(B,G.tileID))continue;const V=this._createProxiedId(B,G,h[B.key]&&h[B.key][t.id]),O=this.proxyToSource[B.key][t.id];O?O.push(V):this.proxyToSource[B.key][t.id]=[V],m.push(V)}}}_createProxiedId(t,s,h){let m=this.orthoMatrix;if(h){const _=h.find(x=>x.key===s.tileID.key);if(_)return _}if(s.tileID.key!==t.key){const _=t.canonical.z-s.tileID.canonical.z;let x,A,C;m=o.create();const S=s.tileID.wrap-t.wrap<<t.overscaledZ;_>0?(x=o.EXTENT>>_,A=x*((s.tileID.canonical.x<<_)-t.canonical.x+S),C=x*((s.tileID.canonical.y<<_)-t.canonical.y)):(x=o.EXTENT<<-_,A=o.EXTENT*(s.tileID.canonical.x-(t.canonical.x+S<<-_)),C=o.EXTENT*(s.tileID.canonical.y-(t.canonical.y<<-_))),o.ortho(m,0,x,0,x,0,1),o.translate(m,m,[A,C,0])}return new tc(s.tileID,t.key,m)}_findTileCoveringTileID(t,s){let h=s.getTile(t);if(h&&h.hasData())return h;const m=this._findCoveringTileCache[s.id],_=m[t.key];if(h=_?s.getTileByID(_):null,h&&h.hasData()||_===null)return h;let x=h?h.tileID:t,A=x.overscaledZ;const C=s.getSource().minzoom,S=[];if(!_){const B=s.getSource().maxzoom;if(t.canonical.z>=B){const N=t.canonical.z-B;s.getSource().reparseOverscaled?(A=Math.max(t.canonical.z+2,s.transform.tileZoom),x=new o.OverscaledTileID(A,t.wrap,B,t.canonical.x>>N,t.canonical.y>>N)):N!==0&&(A=B,x=new o.OverscaledTileID(A,t.wrap,B,t.canonical.x>>N,t.canonical.y>>N))}x.key!==t.key&&(S.push(x.key),h=s.getTile(x))}const z=B=>{S.forEach(N=>{m[N]=B}),S.length=0};for(A-=1;A>=C&&(!h||!h.hasData());A--){h&&z(h.tileID.key);const B=x.calculateScaledKey(A);if(h=s.getTileByID(B),h&&h.hasData())break;const N=m[B];if(N===null)break;N===void 0?S.push(B):h=s.getTileByID(N)}return z(h?h.tileID.key:null),h&&h.hasData()?h:null}findDEMTileFor(t){return this.enabled?this._findTileCoveringTileID(t,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(t,s){let h=this._tilesDirty[t];h||(h=this._tilesDirty[t]={}),h[s.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const t=function(s){let h=0;const m=new o.StructArrayLayout2ui4,_=131;for(let x=1;x<129;x++){for(let A=1;A<129;A++)h=x*_+A,m.emplaceBack(h,h+1),m.emplaceBack(h,h+_),m.emplaceBack(h+1,h+_),x===128&&m.emplaceBack(h+_,h+_+1);m.emplaceBack(h+1,h+1+_)}return m}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(t),this.wireframeSegments=o.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,t.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}function Oa(l){const t=[];for(let s=0;s<l.length;s++){if(l[s]===null)continue;const h=l[s].split(" ");t.push(h.pop())}return t}class Vs{static cacheKey(t,s,h){let m=`${t}${h?h.cacheKey:""}`;for(const _ of s)m+=`/${_}`;return m}constructor(t,s,h,m,_,x){const A=t.gl;this.program=A.createProgram();const C=Oa(h.staticAttributes),S=m?m.getBinderAttributes():[],z=C.concat(S),B=h.staticUniforms?Oa(h.staticUniforms):[],N=m?m.getBinderUniforms():[],G=B.concat(N),V=[];for(const X of G)V.indexOf(X)<0&&V.push(X);let O=m?m.defines():[];O=O.concat(x.map(X=>`#define ${X}`));const $=O.concat(`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,Os,Pa.fragmentSource,Nr.fragmentSource,h.fragmentSource).join(`
`),W=O.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,Os,Pa.vertexSource,Nr.vertexSource,bo.vertexSource,h.vertexSource).join(`
`),Q=A.createShader(A.FRAGMENT_SHADER);if(A.isContextLost())return void(this.failedToCreate=!0);A.shaderSource(Q,$),A.compileShader(Q),A.attachShader(this.program,Q);const K=A.createShader(A.VERTEX_SHADER);if(A.isContextLost())return void(this.failedToCreate=!0);A.shaderSource(K,W),A.compileShader(K),A.attachShader(this.program,K),this.attributes={};const ee={};this.numAttributes=z.length;for(let X=0;X<this.numAttributes;X++)z[X]&&(A.bindAttribLocation(this.program,X,z[X]),this.attributes[z[X]]=X);A.linkProgram(this.program),A.deleteShader(K),A.deleteShader(Q);for(let X=0;X<V.length;X++){const re=V[X];if(re&&!ee[re]){const ge=A.getUniformLocation(this.program,re);ge&&(ee[re]=ge)}}this.fixedUniforms=_(t,ee),this.binderUniforms=m?m.getUniforms(t,ee):[],x.indexOf("TERRAIN")!==-1&&(this.terrainUniforms=((X,re)=>({u_dem:new o.Uniform1i(X,re.u_dem),u_dem_prev:new o.Uniform1i(X,re.u_dem_prev),u_dem_unpack:new o.Uniform4f(X,re.u_dem_unpack),u_dem_tl:new o.Uniform2f(X,re.u_dem_tl),u_dem_scale:new o.Uniform1f(X,re.u_dem_scale),u_dem_tl_prev:new o.Uniform2f(X,re.u_dem_tl_prev),u_dem_scale_prev:new o.Uniform1f(X,re.u_dem_scale_prev),u_dem_size:new o.Uniform1f(X,re.u_dem_size),u_dem_lerp:new o.Uniform1f(X,re.u_dem_lerp),u_exaggeration:new o.Uniform1f(X,re.u_exaggeration),u_depth:new o.Uniform1i(X,re.u_depth),u_depth_size_inv:new o.Uniform2f(X,re.u_depth_size_inv),u_meter_to_dem:new o.Uniform1f(X,re.u_meter_to_dem),u_label_plane_matrix_inv:new o.UniformMatrix4f(X,re.u_label_plane_matrix_inv),u_tile_tl_up:new o.Uniform3f(X,re.u_tile_tl_up),u_tile_tr_up:new o.Uniform3f(X,re.u_tile_tr_up),u_tile_br_up:new o.Uniform3f(X,re.u_tile_br_up),u_tile_bl_up:new o.Uniform3f(X,re.u_tile_bl_up),u_tile_up_scale:new o.Uniform1f(X,re.u_tile_up_scale)}))(t,ee)),x.indexOf("FOG")!==-1&&(this.fogUniforms=((X,re)=>({u_fog_matrix:new o.UniformMatrix4f(X,re.u_fog_matrix),u_fog_range:new o.Uniform2f(X,re.u_fog_range),u_fog_color:new o.Uniform4f(X,re.u_fog_color),u_fog_horizon_blend:new o.Uniform1f(X,re.u_fog_horizon_blend),u_fog_temporal_offset:new o.Uniform1f(X,re.u_fog_temporal_offset)}))(t,ee))}setTerrainUniformValues(t,s){if(!this.terrainUniforms)return;const h=this.terrainUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const m in s)h[m].set(s[m])}}setFogUniformValues(t,s){if(!this.fogUniforms)return;const h=this.fogUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const m in s)h[m].location&&h[m].set(s[m])}}draw(t,s,h,m,_,x,A,C,S,z,B,N,G,V,O,$){const W=t.gl;if(this.failedToCreate)return;t.program.set(this.program),t.setDepthMode(h),t.setStencilMode(m),t.setColorMode(_),t.setCullFace(x);for(const K of Object.keys(this.fixedUniforms))this.fixedUniforms[K].set(A[K]);V&&V.setUniforms(t,this.binderUniforms,N,{zoom:G});const Q={[W.LINES]:2,[W.TRIANGLES]:3,[W.LINE_STRIP]:1}[s];for(const K of B.get()){const ee=K.vaos||(K.vaos={});(ee[C]||(ee[C]=new Ba)).bind(t,this,S,V?V.getPaintVertexBuffers():[],z,K.vertexOffset,O,$),W.drawElements(s,K.primitiveLength*Q,W.UNSIGNED_SHORT,K.primitiveOffset*Q*2)}}}function js(l,t,s){const h=1/Wi(s,1,t.transform.tileZoom),m=Math.pow(2,s.tileID.overscaledZ),_=s.tileSize*Math.pow(2,t.transform.tileZoom)/m,x=_*(s.tileID.canonical.x+s.tileID.wrap*m),A=_*s.tileID.canonical.y;return{u_image:0,u_texsize:s.imageAtlasTexture.size,u_scale:[h,l.fromScale,l.toScale],u_fade:l.t,u_pixel_coord_upper:[x>>16,A>>16],u_pixel_coord_lower:[65535&x,65535&A]}}const ic=o.create(),Fa=(l,t,s,h,m,_,x,A,C)=>{const S=t.style.light,z=S.properties.get("position"),B=[z.x,z.y,z.z],N=o.create$1();S.properties.get("anchor")==="viewport"&&(o.fromRotation(N,-t.transform.angle),o.transformMat3(B,B,N));const G=S.properties.get("color"),V=t.transform,O={u_matrix:l,u_lightpos:B,u_lightintensity:S.properties.get("intensity"),u_lightcolor:[G.r,G.g,G.b],u_vertical_gradient:+s,u_opacity:h,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:ic,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0};return V.projection.name==="globe"&&(O.u_tile_id=[m.canonical.x,m.canonical.y,1<<m.canonical.z],O.u_zoom_transition=x,O.u_inv_rot_matrix=C,O.u_merc_center=A,O.u_up_dir=V.projection.upVector(new o.CanonicalTileID(0,0,0),A[0]*o.EXTENT,A[1]*o.EXTENT),O.u_height_lift=_),O},Na=(l,t,s,h,m,_,x,A,C,S,z)=>{const B=Fa(l,t,s,h,m,A,C,S,z),N={u_height_factor:-Math.pow(2,m.overscaledZ)/x.tileSize/8};return o.extend(B,js(_,t,x),N)},Ua=l=>({u_matrix:l}),Va=(l,t,s,h)=>o.extend(Ua(l),js(s,t,h)),ja=(l,t)=>({u_matrix:l,u_world:t}),Wu=(l,t,s,h,m)=>o.extend(Va(l,t,s,h),{u_world:m}),Hu=o.create(),Ko=(l,t,s,h,m,_)=>{const x=l.transform,A=x.projection.name==="globe";let C;if(_.paint.get("circle-pitch-alignment")==="map")if(A){const z=o.globePixelsToTileUnits(x.zoom,t.canonical);C=Float32Array.from([z,0,0,z])}else C=x.calculatePixelsToTileUnitsMatrix(s);else C=new Float32Array([x.pixelsToGLUnits[0],0,0,x.pixelsToGLUnits[1]]);const S={u_camera_to_center_distance:x.cameraToCenterDistance,u_matrix:l.translatePosMatrix(t.projMatrix,s,_.paint.get("circle-translate"),_.paint.get("circle-translate-anchor")),u_device_pixel_ratio:o.exported.devicePixelRatio,u_extrude_scale:C,u_inv_rot_matrix:Hu,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};return A&&(S.u_inv_rot_matrix=h,S.u_merc_center=m,S.u_tile_id=[t.canonical.x,t.canonical.y,1<<t.canonical.z],S.u_zoom_transition=o.globeToMercatorTransition(x.zoom),S.u_up_dir=x.projection.upVector(t.canonical,m[0],m[1])),S},ip=l=>{const t=[];return l.paint.get("circle-pitch-alignment")==="map"&&t.push("PITCH_WITH_MAP"),l.paint.get("circle-pitch-scale")==="map"&&t.push("SCALE_WITH_MAP"),t},np=(l,t,s)=>{const h=o.EXTENT/s.tileSize;return{u_matrix:l,u_camera_to_center_distance:t.cameraToCenterDistance,u_extrude_scale:[t.pixelsToGLUnits[0]/h,t.pixelsToGLUnits[1]/h]}},Yu=(l,t,s=1)=>({u_matrix:l,u_color:t,u_overlay:0,u_overlay_scale:s}),rp=o.create(),op=(l,t,s,h,m,_,x)=>{const A=l.transform,C=A.projection.name==="globe",S=C?o.globePixelsToTileUnits(A.zoom,t.canonical):Wi(s,1,_),z={u_matrix:t.projMatrix,u_extrude_scale:S,u_intensity:x,u_inv_rot_matrix:rp,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};return C&&(z.u_inv_rot_matrix=h,z.u_merc_center=m,z.u_tile_id=[t.canonical.x,t.canonical.y,1<<t.canonical.z],z.u_zoom_transition=o.globeToMercatorTransition(A.zoom),z.u_up_dir=A.projection.upVector(t.canonical,m[0],m[1])),z},sp=(l,t,s,h,m,_,x)=>{const A=l.transform,C=A.calculatePixelsToTileUnitsMatrix(t),S={u_matrix:Ao(l,t,s,m),u_pixels_to_tile_units:C,u_device_pixel_ratio:x,u_units_to_pixels:[1/A.pixelsToGLUnits[0],1/A.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:_,u_texsize:[0,0],u_scale:[0,0,0],u_mix:0,u_alpha_discard_threshold:0};if(rc(s)){const z=Ga(t,l.transform);S.u_texsize=t.lineAtlasTexture.size,S.u_scale=[z,h.fromScale,h.toScale],S.u_mix=h.t}return S},nc=(l,t,s,h,m,_)=>{const x=l.transform,A=Ga(t,x);return{u_matrix:Ao(l,t,s,m),u_texsize:t.imageAtlasTexture.size,u_pixels_to_tile_units:x.calculatePixelsToTileUnitsMatrix(t),u_device_pixel_ratio:_,u_image:0,u_scale:[A,h.fromScale,h.toScale],u_fade:h.t,u_units_to_pixels:[1/x.pixelsToGLUnits[0],1/x.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function Ga(l,t){return 1/Wi(l,1,t.tileZoom)}function Ao(l,t,s,h){return l.translatePosMatrix(h||t.tileID.projMatrix,t,s.paint.get("line-translate"),s.paint.get("line-translate-anchor"))}function rc(l){const t=l.paint.get("line-dasharray").value;return t.value||t.kind!=="constant"}const Xu=(l,t,s,h,m,_)=>{return{u_matrix:l,u_tl_parent:t,u_scale_parent:s,u_fade_t:h.mix,u_opacity:h.opacity*m.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:m.paint.get("raster-brightness-min"),u_brightness_high:m.paint.get("raster-brightness-max"),u_saturation_factor:(A=m.paint.get("raster-saturation"),A>0?1-1/(1.001-A):-A),u_contrast_factor:(x=m.paint.get("raster-contrast"),x>0?1/(1-x):1+x),u_spin_weights:oc(m.paint.get("raster-hue-rotate")),u_perspective_transform:_};var x,A};function oc(l){l*=Math.PI/180;const t=Math.sin(l),s=Math.cos(l);return[(2*s+1)/3,(-Math.sqrt(3)*t-s+1)/3,(Math.sqrt(3)*t-s+1)/3]}const Vr=o.create(),sc=(l,t,s,h,m,_,x,A,C,S,z,B,N,G)=>{const V=m.transform,O={u_is_size_zoom_constant:+(l==="constant"||l==="source"),u_is_size_feature_constant:+(l==="constant"||l==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:V.cameraToCenterDistance,u_rotate_symbol:+s,u_aspect_ratio:V.width/V.height,u_fade_change:m.options.fadeDuration?m.symbolFadeChange:1,u_matrix:_,u_label_plane_matrix:x,u_coord_matrix:A,u_is_text:+C,u_pitch_with_map:+h,u_texsize:S,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Vr,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Vr};return V.projection.name==="globe"&&(O.u_tile_id=[z.canonical.x,z.canonical.y,1<<z.canonical.z],O.u_zoom_transition=B,O.u_inv_rot_matrix=G,O.u_merc_center=N,O.u_camera_forward=V._camera.forward(),O.u_ecef_origin=o.globeECEFOrigin(V.globeMatrix,z.toUnwrapped()),O.u_tile_matrix=Float32Array.from(V.globeMatrix)),O},wo=(l,t,s,h,m,_,x,A,C,S,z,B,N,G,V)=>{const{cameraToCenterDistance:O,_pitch:$}=m.transform;return o.extend(sc(l,t,s,h,m,_,x,A,C,S,B,N,G,V),{u_gamma_scale:h?O*Math.cos(m.terrain?0:$):1,u_device_pixel_ratio:o.exported.devicePixelRatio,u_is_halo:+z})},$o=(l,t,s,h,m,_,x,A,C,S,z,B,N,G)=>o.extend(wo(l,t,s,h,m,_,x,A,!0,C,!0,z,B,N,G),{u_texsize_icon:S,u_texture_icon:1}),Qu=(l,t,s)=>({u_matrix:l,u_opacity:t,u_color:s}),ac=(l,t,s,h,m,_)=>o.extend(function(x,A,C,S){const z=C.imageManager.getPattern(x.from.toString()),B=C.imageManager.getPattern(x.to.toString()),{width:N,height:G}=C.imageManager.getPixelSize(),V=Math.pow(2,S.tileID.overscaledZ),O=S.tileSize*Math.pow(2,C.transform.tileZoom)/V,$=O*(S.tileID.canonical.x+S.tileID.wrap*V),W=O*S.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:z.tl,u_pattern_br_a:z.br,u_pattern_tl_b:B.tl,u_pattern_br_b:B.br,u_texsize:[N,G],u_mix:A.t,u_pattern_size_a:z.displaySize,u_pattern_size_b:B.displaySize,u_scale_a:A.fromScale,u_scale_b:A.toScale,u_tile_units_to_pixels:1/Wi(S,1,C.transform.tileZoom),u_pixel_coord_upper:[$>>16,W>>16],u_pixel_coord_lower:[65535&$,65535&W]}}(h,_,s,m),{u_matrix:l,u_opacity:t}),ui={fillExtrusion:(l,t)=>({u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_lightpos:new o.Uniform3f(l,t.u_lightpos),u_lightintensity:new o.Uniform1f(l,t.u_lightintensity),u_lightcolor:new o.Uniform3f(l,t.u_lightcolor),u_vertical_gradient:new o.Uniform1f(l,t.u_vertical_gradient),u_opacity:new o.Uniform1f(l,t.u_opacity),u_tile_id:new o.Uniform3f(l,t.u_tile_id),u_zoom_transition:new o.Uniform1f(l,t.u_zoom_transition),u_inv_rot_matrix:new o.UniformMatrix4f(l,t.u_inv_rot_matrix),u_merc_center:new o.Uniform2f(l,t.u_merc_center),u_up_dir:new o.Uniform3f(l,t.u_up_dir),u_height_lift:new o.Uniform1f(l,t.u_height_lift)}),fillExtrusionPattern:(l,t)=>({u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_lightpos:new o.Uniform3f(l,t.u_lightpos),u_lightintensity:new o.Uniform1f(l,t.u_lightintensity),u_lightcolor:new o.Uniform3f(l,t.u_lightcolor),u_vertical_gradient:new o.Uniform1f(l,t.u_vertical_gradient),u_height_factor:new o.Uniform1f(l,t.u_height_factor),u_tile_id:new o.Uniform3f(l,t.u_tile_id),u_zoom_transition:new o.Uniform1f(l,t.u_zoom_transition),u_inv_rot_matrix:new o.UniformMatrix4f(l,t.u_inv_rot_matrix),u_merc_center:new o.Uniform2f(l,t.u_merc_center),u_up_dir:new o.Uniform3f(l,t.u_up_dir),u_height_lift:new o.Uniform1f(l,t.u_height_lift),u_image:new o.Uniform1i(l,t.u_image),u_texsize:new o.Uniform2f(l,t.u_texsize),u_pixel_coord_upper:new o.Uniform2f(l,t.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(l,t.u_pixel_coord_lower),u_scale:new o.Uniform3f(l,t.u_scale),u_fade:new o.Uniform1f(l,t.u_fade),u_opacity:new o.Uniform1f(l,t.u_opacity)}),fill:(l,t)=>({u_matrix:new o.UniformMatrix4f(l,t.u_matrix)}),fillPattern:(l,t)=>({u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_image:new o.Uniform1i(l,t.u_image),u_texsize:new o.Uniform2f(l,t.u_texsize),u_pixel_coord_upper:new o.Uniform2f(l,t.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(l,t.u_pixel_coord_lower),u_scale:new o.Uniform3f(l,t.u_scale),u_fade:new o.Uniform1f(l,t.u_fade)}),fillOutline:(l,t)=>({u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_world:new o.Uniform2f(l,t.u_world)}),fillOutlinePattern:(l,t)=>({u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_world:new o.Uniform2f(l,t.u_world),u_image:new o.Uniform1i(l,t.u_image),u_texsize:new o.Uniform2f(l,t.u_texsize),u_pixel_coord_upper:new o.Uniform2f(l,t.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(l,t.u_pixel_coord_lower),u_scale:new o.Uniform3f(l,t.u_scale),u_fade:new o.Uniform1f(l,t.u_fade)}),circle:(l,t)=>({u_camera_to_center_distance:new o.Uniform1f(l,t.u_camera_to_center_distance),u_extrude_scale:new o.UniformMatrix2f(l,t.u_extrude_scale),u_device_pixel_ratio:new o.Uniform1f(l,t.u_device_pixel_ratio),u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_inv_rot_matrix:new o.UniformMatrix4f(l,t.u_inv_rot_matrix),u_merc_center:new o.Uniform2f(l,t.u_merc_center),u_tile_id:new o.Uniform3f(l,t.u_tile_id),u_zoom_transition:new o.Uniform1f(l,t.u_zoom_transition),u_up_dir:new o.Uniform3f(l,t.u_up_dir)}),collisionBox:(l,t)=>({u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_camera_to_center_distance:new o.Uniform1f(l,t.u_camera_to_center_distance),u_extrude_scale:new o.Uniform2f(l,t.u_extrude_scale)}),collisionCircle:(l,t)=>({u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_inv_matrix:new o.UniformMatrix4f(l,t.u_inv_matrix),u_camera_to_center_distance:new o.Uniform1f(l,t.u_camera_to_center_distance),u_viewport_size:new o.Uniform2f(l,t.u_viewport_size)}),debug:(l,t)=>({u_color:new o.UniformColor(l,t.u_color),u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_overlay:new o.Uniform1i(l,t.u_overlay),u_overlay_scale:new o.Uniform1f(l,t.u_overlay_scale)}),clippingMask:(l,t)=>({u_matrix:new o.UniformMatrix4f(l,t.u_matrix)}),heatmap:(l,t)=>({u_extrude_scale:new o.Uniform1f(l,t.u_extrude_scale),u_intensity:new o.Uniform1f(l,t.u_intensity),u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_inv_rot_matrix:new o.UniformMatrix4f(l,t.u_inv_rot_matrix),u_merc_center:new o.Uniform2f(l,t.u_merc_center),u_tile_id:new o.Uniform3f(l,t.u_tile_id),u_zoom_transition:new o.Uniform1f(l,t.u_zoom_transition),u_up_dir:new o.Uniform3f(l,t.u_up_dir)}),heatmapTexture:(l,t)=>({u_image:new o.Uniform1i(l,t.u_image),u_color_ramp:new o.Uniform1i(l,t.u_color_ramp),u_opacity:new o.Uniform1f(l,t.u_opacity)}),hillshade:(l,t)=>({u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_image:new o.Uniform1i(l,t.u_image),u_latrange:new o.Uniform2f(l,t.u_latrange),u_light:new o.Uniform2f(l,t.u_light),u_shadow:new o.UniformColor(l,t.u_shadow),u_highlight:new o.UniformColor(l,t.u_highlight),u_accent:new o.UniformColor(l,t.u_accent)}),hillshadePrepare:(l,t)=>({u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_image:new o.Uniform1i(l,t.u_image),u_dimension:new o.Uniform2f(l,t.u_dimension),u_zoom:new o.Uniform1f(l,t.u_zoom),u_unpack:new o.Uniform4f(l,t.u_unpack)}),line:(l,t)=>({u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_pixels_to_tile_units:new o.UniformMatrix2f(l,t.u_pixels_to_tile_units),u_device_pixel_ratio:new o.Uniform1f(l,t.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(l,t.u_units_to_pixels),u_dash_image:new o.Uniform1i(l,t.u_dash_image),u_gradient_image:new o.Uniform1i(l,t.u_gradient_image),u_image_height:new o.Uniform1f(l,t.u_image_height),u_texsize:new o.Uniform2f(l,t.u_texsize),u_scale:new o.Uniform3f(l,t.u_scale),u_mix:new o.Uniform1f(l,t.u_mix),u_alpha_discard_threshold:new o.Uniform1f(l,t.u_alpha_discard_threshold)}),linePattern:(l,t)=>({u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_texsize:new o.Uniform2f(l,t.u_texsize),u_pixels_to_tile_units:new o.UniformMatrix2f(l,t.u_pixels_to_tile_units),u_device_pixel_ratio:new o.Uniform1f(l,t.u_device_pixel_ratio),u_image:new o.Uniform1i(l,t.u_image),u_units_to_pixels:new o.Uniform2f(l,t.u_units_to_pixels),u_scale:new o.Uniform3f(l,t.u_scale),u_fade:new o.Uniform1f(l,t.u_fade),u_alpha_discard_threshold:new o.Uniform1f(l,t.u_alpha_discard_threshold)}),raster:(l,t)=>({u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_tl_parent:new o.Uniform2f(l,t.u_tl_parent),u_scale_parent:new o.Uniform1f(l,t.u_scale_parent),u_fade_t:new o.Uniform1f(l,t.u_fade_t),u_opacity:new o.Uniform1f(l,t.u_opacity),u_image0:new o.Uniform1i(l,t.u_image0),u_image1:new o.Uniform1i(l,t.u_image1),u_brightness_low:new o.Uniform1f(l,t.u_brightness_low),u_brightness_high:new o.Uniform1f(l,t.u_brightness_high),u_saturation_factor:new o.Uniform1f(l,t.u_saturation_factor),u_contrast_factor:new o.Uniform1f(l,t.u_contrast_factor),u_spin_weights:new o.Uniform3f(l,t.u_spin_weights),u_perspective_transform:new o.Uniform2f(l,t.u_perspective_transform)}),symbolIcon:(l,t)=>({u_is_size_zoom_constant:new o.Uniform1i(l,t.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(l,t.u_is_size_feature_constant),u_size_t:new o.Uniform1f(l,t.u_size_t),u_size:new o.Uniform1f(l,t.u_size),u_camera_to_center_distance:new o.Uniform1f(l,t.u_camera_to_center_distance),u_rotate_symbol:new o.Uniform1i(l,t.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(l,t.u_aspect_ratio),u_fade_change:new o.Uniform1f(l,t.u_fade_change),u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(l,t.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(l,t.u_coord_matrix),u_is_text:new o.Uniform1i(l,t.u_is_text),u_pitch_with_map:new o.Uniform1i(l,t.u_pitch_with_map),u_texsize:new o.Uniform2f(l,t.u_texsize),u_tile_id:new o.Uniform3f(l,t.u_tile_id),u_zoom_transition:new o.Uniform1f(l,t.u_zoom_transition),u_inv_rot_matrix:new o.UniformMatrix4f(l,t.u_inv_rot_matrix),u_merc_center:new o.Uniform2f(l,t.u_merc_center),u_camera_forward:new o.Uniform3f(l,t.u_camera_forward),u_tile_matrix:new o.UniformMatrix4f(l,t.u_tile_matrix),u_ecef_origin:new o.Uniform3f(l,t.u_ecef_origin),u_texture:new o.Uniform1i(l,t.u_texture)}),symbolSDF:(l,t)=>({u_is_size_zoom_constant:new o.Uniform1i(l,t.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(l,t.u_is_size_feature_constant),u_size_t:new o.Uniform1f(l,t.u_size_t),u_size:new o.Uniform1f(l,t.u_size),u_camera_to_center_distance:new o.Uniform1f(l,t.u_camera_to_center_distance),u_rotate_symbol:new o.Uniform1i(l,t.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(l,t.u_aspect_ratio),u_fade_change:new o.Uniform1f(l,t.u_fade_change),u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(l,t.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(l,t.u_coord_matrix),u_is_text:new o.Uniform1i(l,t.u_is_text),u_pitch_with_map:new o.Uniform1i(l,t.u_pitch_with_map),u_texsize:new o.Uniform2f(l,t.u_texsize),u_texture:new o.Uniform1i(l,t.u_texture),u_gamma_scale:new o.Uniform1f(l,t.u_gamma_scale),u_device_pixel_ratio:new o.Uniform1f(l,t.u_device_pixel_ratio),u_tile_id:new o.Uniform3f(l,t.u_tile_id),u_zoom_transition:new o.Uniform1f(l,t.u_zoom_transition),u_inv_rot_matrix:new o.UniformMatrix4f(l,t.u_inv_rot_matrix),u_merc_center:new o.Uniform2f(l,t.u_merc_center),u_camera_forward:new o.Uniform3f(l,t.u_camera_forward),u_tile_matrix:new o.UniformMatrix4f(l,t.u_tile_matrix),u_ecef_origin:new o.Uniform3f(l,t.u_ecef_origin),u_is_halo:new o.Uniform1i(l,t.u_is_halo)}),symbolTextAndIcon:(l,t)=>({u_is_size_zoom_constant:new o.Uniform1i(l,t.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(l,t.u_is_size_feature_constant),u_size_t:new o.Uniform1f(l,t.u_size_t),u_size:new o.Uniform1f(l,t.u_size),u_camera_to_center_distance:new o.Uniform1f(l,t.u_camera_to_center_distance),u_rotate_symbol:new o.Uniform1i(l,t.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(l,t.u_aspect_ratio),u_fade_change:new o.Uniform1f(l,t.u_fade_change),u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(l,t.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(l,t.u_coord_matrix),u_is_text:new o.Uniform1i(l,t.u_is_text),u_pitch_with_map:new o.Uniform1i(l,t.u_pitch_with_map),u_texsize:new o.Uniform2f(l,t.u_texsize),u_texsize_icon:new o.Uniform2f(l,t.u_texsize_icon),u_texture:new o.Uniform1i(l,t.u_texture),u_texture_icon:new o.Uniform1i(l,t.u_texture_icon),u_gamma_scale:new o.Uniform1f(l,t.u_gamma_scale),u_device_pixel_ratio:new o.Uniform1f(l,t.u_device_pixel_ratio),u_is_halo:new o.Uniform1i(l,t.u_is_halo)}),background:(l,t)=>({u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_opacity:new o.Uniform1f(l,t.u_opacity),u_color:new o.UniformColor(l,t.u_color)}),backgroundPattern:(l,t)=>({u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_opacity:new o.Uniform1f(l,t.u_opacity),u_image:new o.Uniform1i(l,t.u_image),u_pattern_tl_a:new o.Uniform2f(l,t.u_pattern_tl_a),u_pattern_br_a:new o.Uniform2f(l,t.u_pattern_br_a),u_pattern_tl_b:new o.Uniform2f(l,t.u_pattern_tl_b),u_pattern_br_b:new o.Uniform2f(l,t.u_pattern_br_b),u_texsize:new o.Uniform2f(l,t.u_texsize),u_mix:new o.Uniform1f(l,t.u_mix),u_pattern_size_a:new o.Uniform2f(l,t.u_pattern_size_a),u_pattern_size_b:new o.Uniform2f(l,t.u_pattern_size_b),u_scale_a:new o.Uniform1f(l,t.u_scale_a),u_scale_b:new o.Uniform1f(l,t.u_scale_b),u_pixel_coord_upper:new o.Uniform2f(l,t.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(l,t.u_pixel_coord_lower),u_tile_units_to_pixels:new o.Uniform1f(l,t.u_tile_units_to_pixels)}),terrainRaster:$l,terrainDepth:$l,skybox:(l,t)=>({u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_sun_direction:new o.Uniform3f(l,t.u_sun_direction),u_cubemap:new o.Uniform1i(l,t.u_cubemap),u_opacity:new o.Uniform1f(l,t.u_opacity),u_temporal_offset:new o.Uniform1f(l,t.u_temporal_offset)}),skyboxGradient:(l,t)=>({u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_color_ramp:new o.Uniform1i(l,t.u_color_ramp),u_center_direction:new o.Uniform3f(l,t.u_center_direction),u_radius:new o.Uniform1f(l,t.u_radius),u_opacity:new o.Uniform1f(l,t.u_opacity),u_temporal_offset:new o.Uniform1f(l,t.u_temporal_offset)}),skyboxCapture:(l,t)=>({u_matrix_3f:new o.UniformMatrix3f(l,t.u_matrix_3f),u_sun_direction:new o.Uniform3f(l,t.u_sun_direction),u_sun_intensity:new o.Uniform1f(l,t.u_sun_intensity),u_color_tint_r:new o.Uniform4f(l,t.u_color_tint_r),u_color_tint_m:new o.Uniform4f(l,t.u_color_tint_m),u_luminance:new o.Uniform1f(l,t.u_luminance)}),globeRaster:(l,t)=>({u_proj_matrix:new o.UniformMatrix4f(l,t.u_proj_matrix),u_globe_matrix:new o.UniformMatrix4f(l,t.u_globe_matrix),u_merc_matrix:new o.UniformMatrix4f(l,t.u_merc_matrix),u_zoom_transition:new o.Uniform1f(l,t.u_zoom_transition),u_merc_center:new o.Uniform2f(l,t.u_merc_center),u_image0:new o.Uniform1i(l,t.u_image0),u_grid_matrix:new o.UniformMatrix3f(l,t.u_grid_matrix)}),globeAtmosphere:(l,t)=>({u_frustum_tl:new o.Uniform3f(l,t.u_frustum_tl),u_frustum_tr:new o.Uniform3f(l,t.u_frustum_tr),u_frustum_br:new o.Uniform3f(l,t.u_frustum_br),u_frustum_bl:new o.Uniform3f(l,t.u_frustum_bl),u_globe_pos:new o.Uniform3f(l,t.u_globe_pos),u_globe_radius:new o.Uniform1f(l,t.u_globe_radius),u_opacity:new o.Uniform1f(l,t.u_opacity),u_fadeout_range:new o.Uniform1f(l,t.u_fadeout_range),u_start_color:new o.Uniform3f(l,t.u_start_color),u_end_color:new o.Uniform3f(l,t.u_end_color)})};let To;function Ku(l,t,s,h,m,_,x){const A=l.context,C=A.gl,S=l.useProgram("collisionBox"),z=[];let B=0,N=0;for(let K=0;K<h.length;K++){const ee=h[K],X=t.getTile(ee),re=X.getBucket(s);if(!re)continue;let ge=ee.projMatrix;m[0]===0&&m[1]===0||(ge=l.translatePosMatrix(ee.projMatrix,X,m,_));const Ae=x?re.textCollisionBox:re.iconCollisionBox,Se=re.collisionCircleArray;if(Se.length>0){const Ce=o.create(),Ze=ge;o.mul(Ce,re.placementInvProjMatrix,l.transform.glCoordMatrix),o.mul(Ce,Ce,re.placementViewportMatrix),z.push({circleArray:Se,circleOffset:N,transform:Ze,invTransform:Ce}),B+=Se.length/4,N=B}Ae&&(l.terrain&&l.terrain.setupElevationDraw(X,S),S.draw(A,C.LINES,o.DepthMode.disabled,o.StencilMode.disabled,l.colorModeForRenderPass(),o.CullFaceMode.disabled,np(ge,l.transform,X),s.id,Ae.layoutVertexBuffer,Ae.indexBuffer,Ae.segments,null,l.transform.zoom,null,Ae.collisionVertexBuffer,Ae.collisionVertexBufferExt))}if(!x||!z.length)return;const G=l.useProgram("collisionCircle"),V=new o.StructArrayLayout2f1f2i16;V.resize(4*B),V._trim();let O=0;for(const K of z)for(let ee=0;ee<K.circleArray.length/4;ee++){const X=4*ee,re=K.circleArray[X+0],ge=K.circleArray[X+1],Ae=K.circleArray[X+2],Se=K.circleArray[X+3];V.emplace(O++,re,ge,Ae,Se,0),V.emplace(O++,re,ge,Ae,Se,1),V.emplace(O++,re,ge,Ae,Se,2),V.emplace(O++,re,ge,Ae,Se,3)}(!To||To.length<2*B)&&(To=function(K){const ee=2*K,X=new o.StructArrayLayout3ui6;X.resize(ee),X._trim();for(let re=0;re<ee;re++){const ge=6*re;X.uint16[ge+0]=4*re+0,X.uint16[ge+1]=4*re+1,X.uint16[ge+2]=4*re+2,X.uint16[ge+3]=4*re+2,X.uint16[ge+4]=4*re+3,X.uint16[ge+5]=4*re+0}return X}(B));const $=A.createIndexBuffer(To,!0),W=A.createVertexBuffer(V,o.collisionCircleLayout.members,!0);for(const K of z){const ee={u_matrix:K.transform,u_inv_matrix:K.invTransform,u_camera_to_center_distance:(Q=l.transform).cameraToCenterDistance,u_viewport_size:[Q.width,Q.height]};G.draw(A,C.TRIANGLES,o.DepthMode.disabled,o.StencilMode.disabled,l.colorModeForRenderPass(),o.CullFaceMode.disabled,ee,s.id,W,$,o.SegmentVector.simpleSegment(0,2*K.circleOffset,K.circleArray.length,K.circleArray.length/2),null,l.transform.zoom,null,null,null)}var Q;W.destroy(),$.destroy()}const lc=o.create();function Gs(l,t,s,h,m,_){const{horizontalAlign:x,verticalAlign:A}=o.getAnchorAlignment(l),C=-(x-.5)*t,S=-(A-.5)*s,z=o.evaluateVariableOffset(l,h);return new o.pointGeometry((C/m+z[0])*_,(S/m+z[1])*_)}function ap(l,t,s,h,m,_,x,A,C,S,z,B){const N=l.text.placedSymbolArray,G=l.text.dynamicLayoutVertexArray,V=l.icon.dynamicLayoutVertexArray,O={},$=A.projMatrix,W=_.elevation,Q=B.upVectorScale(A.canonical,_.center.lat,_.worldSize);G.clear();for(let K=0;K<N.length;K++){const ee=N.get(K),X=l.allowVerticalPlacement&&!ee.placedOrientation,re=ee.hidden||!ee.crossTileID||X?null:h[ee.crossTileID];if(re){const ge=new o.pointGeometry(ee.tileAnchorX,ee.tileAnchorY),Ae=B.upVector(A.canonical,ge.x,ge.y),Se=W?W.getAtTileOffset(A,ge.x,ge.y):0,Ce=Vn([ee.projectedAnchorX+Se*Ae[0]*Q.metersToTile,ee.projectedAnchorY+Se*Ae[1]*Q.metersToTile,ee.projectedAnchorZ+Se*Ae[2]*Q.metersToTile],s?$:x),Ze=Mi(_.cameraToCenterDistance,Ce.signedDistanceFromCamera);let ye=m.evaluateSizeForFeature(l.textSizeData,S,ee)*Ze/o.ONE_EM;s&&(ye*=l.tilePixelRatio/C);const{width:je,height:Ue,anchor:lt,textOffset:we,textScale:pt}=re,yt=Gs(lt,je,Ue,we,pt,ye),ot=s?fn(ge.add(yt),x,Se*Q.metersToLabelSpace).point:Ce.point.add(t?yt.rotate(-_.angle):yt),st=l.allowVerticalPlacement&&ee.placedOrientation===o.WritingMode.vertical?Math.PI/2:0;for(let Et=0;Et<ee.numGlyphs;Et++)o.addDynamicAttributes(G,ot,st);z&&ee.associatedIconIndex>=0&&(O[ee.associatedIconIndex]={shiftedAnchor:ot,angle:st})}else Hi(ee.numGlyphs,G)}if(z){V.clear();const K=l.icon.placedSymbolArray;for(let ee=0;ee<K.length;ee++){const X=K.get(ee);if(X.hidden)Hi(X.numGlyphs,V);else{const re=O[ee];if(re)for(let ge=0;ge<X.numGlyphs;ge++)o.addDynamicAttributes(V,re.shiftedAnchor,re.angle);else Hi(X.numGlyphs,V)}}l.icon.dynamicLayoutVertexBuffer.updateData(V)}l.text.dynamicLayoutVertexBuffer.updateData(G)}function lp(l,t,s){return s.iconsInText&&t?"symbolTextAndIcon":l?"symbolSDF":"symbolIcon"}function cc(l,t,s,h,m,_,x,A,C,S,z,B){const N=l.context,G=N.gl,V=l.transform,O=A==="map",$=C==="map",W=O&&s.layout.get("symbol-placement")!=="point",Q=O&&!$&&!W,K=s.layout.get("symbol-sort-key").constantOr(1)!==void 0;let ee=!1;const X=l.depthModeForSublayer(0,o.DepthMode.ReadOnly),re=[o.mercatorXfromLng(V.center.lng),o.mercatorYfromLat(V.center.lat)],ge=s.layout.get("text-variable-anchor"),Ae=V.projection.name==="globe",Se=Ae?o.globeToMercatorTransition(V.zoom):0,Ce=[],Ze=[];l.terrain&&$&&Ze.push("PITCH_WITH_MAP_TERRAIN"),Ae&&Ze.push("PROJECTION_GLOBE_VIEW");for(const ye of h){const je=t.getTile(ye),Ue=je.getBucket(s);if(!Ue||Ue.projection!==V.projection.name)continue;const lt=m?Ue.text:Ue.icon;if(!lt||Ue.fullyClipped||!lt.segments.get().length)continue;const we=lt.programConfigurations.get(s.id),pt=m||Ue.sdfIcons,yt=m?Ue.textSizeData:Ue.iconSizeData,ot=$||V.pitch!==0,st=o.evaluateSizeForZoom(yt,V.zoom);let Et,Ft,ht,kt,$t=[0,0],ki=null;if(m){if(Ft=je.glyphAtlasTexture,ht=G.LINEAR,Et=je.glyphAtlasTexture.size,Ue.iconsInText){$t=je.imageAtlasTexture.size,ki=je.imageAtlasTexture;const Ln=yt.kind==="composite"||yt.kind==="camera";kt=ot||l.options.rotating||l.options.zooming||Ln?G.LINEAR:G.NEAREST}}else{const Ln=s.layout.get("icon-size").constantOr(0)!==1||Ue.iconsNeedLinear;Ft=je.imageAtlasTexture,ht=pt||l.options.rotating||l.options.zooming||Ln||ot?G.LINEAR:G.NEAREST,Et=je.imageAtlasTexture.size}const an=l.transform.calculatePixelsToTileUnitsMatrix(je),ln=xo(ye.projMatrix,je.tileID.canonical,$,O,l.transform,an),Pn=l.terrain&&$&&W?o.invert(o.create(),ln):lc,sr=qo(ye.projMatrix,je.tileID.canonical,$,O,l.transform,an),Ir=ge&&Ue.hasTextData(),Hr=s.layout.get("icon-text-fit")!=="none"&&Ir&&Ue.hasIconData();if(W){const Ln=V.elevation,Mo=Ln?Ln.getAtTileOffsetFunc(ye,V.center.lat,V.worldSize,V.projection):Mh=>[0,0,0];Ps(Ue,ye.projMatrix,l,m,ln,sr,$,S,Mo,ye)}const zr=W||m&&ge||Hr,Di=l.translatePosMatrix(ye.projMatrix,je,_,x),Ri=zr?lc:ln,oi=l.translatePosMatrix(sr,je,_,x,!0),Gi=V.projection.createInversionMatrix(V,ye.canonical),Bn=zr?Ze.concat(["PROJECTED_POS_ON_VIEWPORT"]):Ze,Si=pt&&s.paint.get(m?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Zn;Zn=pt?Ue.iconsInText?$o(yt.kind,st,Q,$,l,Di,Ri,oi,Et,$t,ye,Se,re,Gi):wo(yt.kind,st,Q,$,l,Di,Ri,oi,m,Et,!0,ye,Se,re,Gi):sc(yt.kind,st,Q,$,l,Di,Ri,oi,m,Et,ye,Se,re,Gi);const oa={program:l.useProgram(lp(pt,m,Ue),we,Bn),buffers:lt,uniformValues:Zn,atlasTexture:Ft,atlasTextureIcon:ki,atlasInterpolation:ht,atlasInterpolationIcon:kt,isSDF:pt,hasHalo:Si,tile:je,labelPlaneMatrixInv:Pn};if(K&&Ue.canOverlap){ee=!0;const Ln=lt.segments.get();for(const Mo of Ln)Ce.push({segments:new o.SegmentVector([Mo]),sortKey:Mo.sortKey,state:oa})}else Ce.push({segments:lt.segments,sortKey:0,state:oa})}ee&&Ce.sort((ye,je)=>ye.sortKey-je.sortKey);for(const ye of Ce){const je=ye.state;if(l.terrain&&l.terrain.setupElevationDraw(je.tile,je.program,{useDepthForOcclusion:!Ae,labelPlaneMatrixInv:je.labelPlaneMatrixInv}),N.activeTexture.set(G.TEXTURE0),je.atlasTexture.bind(je.atlasInterpolation,G.CLAMP_TO_EDGE),je.atlasTextureIcon&&(N.activeTexture.set(G.TEXTURE1),je.atlasTextureIcon&&je.atlasTextureIcon.bind(je.atlasInterpolationIcon,G.CLAMP_TO_EDGE)),je.isSDF){const Ue=je.uniformValues;je.hasHalo&&(Ue.u_is_halo=1,$u(je.buffers,ye.segments,s,l,je.program,X,z,B,Ue)),Ue.u_is_halo=0}$u(je.buffers,ye.segments,s,l,je.program,X,z,B,je.uniformValues)}}function $u(l,t,s,h,m,_,x,A,C){const S=h.context;m.draw(S,S.gl.TRIANGLES,_,x,A,o.CullFaceMode.disabled,C,s.id,l.layoutVertexBuffer,l.indexBuffer,t,s.paint,h.transform.zoom,l.programConfigurations.get(s.id),l.dynamicLayoutVertexBuffer,l.opacityVertexBuffer)}function Za(l,t,s,h,m,_,x){const A=l.context.gl,C=s.paint.get("fill-pattern"),S=C&&C.constantOr(1),z=s.getCrossfadeParameters();let B,N,G,V,O;x?(N=S&&!s.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",B=A.LINES):(N=S?"fillPattern":"fill",B=A.TRIANGLES);for(const $ of h){const W=t.getTile($);if(S&&!W.patternsLoaded())continue;const Q=W.getBucket(s);if(!Q)continue;l.prepareDrawTile();const K=Q.programConfigurations.get(s.id),ee=l.useProgram(N,K);S&&(l.context.activeTexture.set(A.TEXTURE0),W.imageAtlasTexture.bind(A.LINEAR,A.CLAMP_TO_EDGE),K.updatePaintBuffers(z));const X=C.constantOr(null);if(X&&W.imageAtlas){const ge=W.imageAtlas,Ae=ge.patternPositions[X.to.toString()],Se=ge.patternPositions[X.from.toString()];Ae&&Se&&K.setConstantPatternPositions(Ae,Se)}const re=l.translatePosMatrix($.projMatrix,W,s.paint.get("fill-translate"),s.paint.get("fill-translate-anchor"));if(x){V=Q.indexBuffer2,O=Q.segments2;const ge=l.terrain&&l.terrain.renderingToTexture?l.terrain.drapeBufferSize:[A.drawingBufferWidth,A.drawingBufferHeight];G=N==="fillOutlinePattern"&&S?Wu(re,l,z,W,ge):ja(re,ge)}else V=Q.indexBuffer,O=Q.segments,G=S?Va(re,l,z,W):Ua(re);l.prepareDrawProgram(l.context,ee,$.toUnwrapped()),ee.draw(l.context,B,m,l.stencilModeForClipping($),_,o.CullFaceMode.disabled,G,s.id,Q.layoutVertexBuffer,V,O,s.paint,l.transform.zoom,K)}}function Jo(l,t,s,h,m,_,x){const A=l.context,C=A.gl,S=l.transform,z=s.paint.get("fill-extrusion-pattern"),B=z.constantOr(1),N=s.getCrossfadeParameters(),G=s.paint.get("fill-extrusion-opacity"),V=function(K){if(K.projection.name!=="globe")return 0;const ee=Math.PI/32,X=Math.tan(ee),re=o.earthRadius;return re*Math.sqrt(1+2*X*X)-re}(S),O=S.projection.name==="globe",$=O?o.globeToMercatorTransition(S.zoom):0,W=[o.mercatorXfromLng(S.center.lng),o.mercatorYfromLat(S.center.lat)],Q=[];O&&Q.push("PROJECTION_GLOBE_VIEW");for(const K of h){const ee=t.getTile(K),X=ee.getBucket(s);if(!X||X.projection!==S.projection.name)continue;const re=X.programConfigurations.get(s.id),ge=l.useProgram(B?"fillExtrusionPattern":"fillExtrusion",re,Q);if(l.terrain){const je=l.terrain;if(l.style.terrainSetForDrapingOnly())je.setupElevationDraw(ee,ge,{useMeterToDem:!0});else{if(!X.enableTerrain)continue;if(je.setupElevationDraw(ee,ge,{useMeterToDem:!0}),Zs(A,t,K,X,s,je),!X.centroidVertexBuffer){const Ue=ge.attributes.a_centroid_pos;Ue!==void 0&&C.vertexAttrib2f(Ue,0,0)}}}B&&(l.context.activeTexture.set(C.TEXTURE0),ee.imageAtlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),re.updatePaintBuffers(N));const Ae=z.constantOr(null);if(Ae&&ee.imageAtlas){const je=ee.imageAtlas,Ue=je.patternPositions[Ae.to.toString()],lt=je.patternPositions[Ae.from.toString()];Ue&&lt&&re.setConstantPatternPositions(Ue,lt)}const Se=l.translatePosMatrix(K.projMatrix,ee,s.paint.get("fill-extrusion-translate"),s.paint.get("fill-extrusion-translate-anchor")),Ce=S.projection.createInversionMatrix(S,K.canonical),Ze=s.paint.get("fill-extrusion-vertical-gradient"),ye=B?Na(Se,l,Ze,G,K,N,ee,V,$,W,Ce):Fa(Se,l,Ze,G,K,V,$,W,Ce);l.prepareDrawProgram(A,ge,K.toUnwrapped()),ge.draw(A,A.gl.TRIANGLES,m,_,x,o.CullFaceMode.backCCW,ye,s.id,X.layoutVertexBuffer,X.indexBuffer,X.segments,s.paint,l.transform.zoom,re,l.terrain?X.centroidVertexBuffer:null,O?X.layoutVertexExtBuffer:null)}}function Zs(l,t,s,h,m,_){const x=[W=>{let Q=W.canonical.x-1,K=W.wrap;return Q<0&&(Q=(1<<W.canonical.z)-1,K--),new o.OverscaledTileID(W.overscaledZ,K,W.canonical.z,Q,W.canonical.y)},W=>{let Q=W.canonical.x+1,K=W.wrap;return Q===1<<W.canonical.z&&(Q=0,K++),new o.OverscaledTileID(W.overscaledZ,K,W.canonical.z,Q,W.canonical.y)},W=>new o.OverscaledTileID(W.overscaledZ,W.wrap,W.canonical.z,W.canonical.x,(W.canonical.y===0?1<<W.canonical.z:W.canonical.y)-1),W=>new o.OverscaledTileID(W.overscaledZ,W.wrap,W.canonical.z,W.canonical.x,W.canonical.y===(1<<W.canonical.z)-1?0:W.canonical.y+1)],A=W=>{const Q=t.getSource().minzoom,K=X=>{const re=t.getTileByID(X);if(re&&re.hasData())return re.getBucket(m)},ee=[0,-1,1];for(const X of ee){if(W.overscaledZ+X<Q)continue;const re=K(W.calculateScaledKey(W.overscaledZ+X));if(re)return re}},C=[0,0,0],S=(W,Q)=>(C[0]=Math.min(W.min.y,Q.min.y),C[1]=Math.max(W.max.y,Q.max.y),C[2]=o.EXTENT-Q.min.x>W.max.x?Q.min.x-o.EXTENT:W.max.x,C),z=(W,Q)=>(C[0]=Math.min(W.min.x,Q.min.x),C[1]=Math.max(W.max.x,Q.max.x),C[2]=o.EXTENT-Q.min.y>W.max.y?Q.min.y-o.EXTENT:W.max.y,C),B=[(W,Q)=>S(W,Q),(W,Q)=>S(Q,W),(W,Q)=>z(W,Q),(W,Q)=>z(Q,W)],N=new o.pointGeometry(0,0);let G,V,O;const $=(W,Q,K,ee,X)=>{const re=[[ee?K:W,ee?W:K,0],[ee?K:Q,ee?Q:K,0]],ge=X<0?o.EXTENT+X:X,Ae=[ee?ge:(W+Q)/2,ee?(W+Q)/2:ge,0];return K===0&&X<0||K!==0&&X>0?_.getForTilePoints(O,[Ae],!0,V):re.push(Ae),_.getForTilePoints(s,re,!0,G),Math.max(re[0][2],re[1][2],Ae[2])/_.exaggeration()};for(let W=0;W<4;W++){const Q=(W<2?1:5)-W,K=h.borders[W];if(K.length===0)continue;const ee=O=x[W](s),X=A(ee);if(!(X&&X instanceof o.FillExtrusionBucket&&X.enableTerrain)||h.borderDoneWithNeighborZ[W]===X.canonical.z&&X.borderDoneWithNeighborZ[Q]===h.canonical.z||(V=_.findDEMTileFor(ee),!V||!V.dem))continue;if(!G){const Se=_.findDEMTileFor(s);if(!Se||!Se.dem)return;G=Se}const re=X.borders[Q];let ge=0;const Ae=X.borderDoneWithNeighborZ[Q]!==h.canonical.z;if(h.canonical.z===X.canonical.z){for(let Se=0;Se<K.length;Se++){const Ce=h.featuresOnBorder[K[Se]],Ze=Ce.borders[W];let ye;for(;ge<re.length&&(ye=X.featuresOnBorder[re[ge]],!(ye.borders[Q][1]>Ze[0]+3));)Ae&&X.encodeCentroid(void 0,ye,!1),ge++;if(ye&&ge<re.length){const je=ge;let Ue=0;for(;!(ye.borders[Q][0]>Ze[1]-3)&&(Ue++,++ge!==re.length);)ye=X.featuresOnBorder[re[ge]];if(ye=X.featuresOnBorder[re[je]],Ce.intersectsCount()>1||ye.intersectsCount()>1||Ue!==1){Ue!==1&&(ge=je),h.encodeCentroid(void 0,Ce,!1),Ae&&X.encodeCentroid(void 0,ye,!1);continue}const lt=B[W](Ce,ye),we=W%2?o.EXTENT-1:0;N.x=$(lt[0],Math.min(o.EXTENT-1,lt[1]),we,W<2,lt[2]),N.y=0,h.encodeCentroid(N,Ce,!1),Ae&&X.encodeCentroid(N,ye,!1)}else h.encodeCentroid(void 0,Ce,!1)}h.borderDoneWithNeighborZ[W]=X.canonical.z,h.needsCentroidUpdate=!0,Ae&&(X.borderDoneWithNeighborZ[Q]=h.canonical.z,X.needsCentroidUpdate=!0)}else{for(const Se of K)h.encodeCentroid(void 0,h.featuresOnBorder[Se],!1);if(Ae){for(const Se of re)X.encodeCentroid(void 0,X.featuresOnBorder[Se],!1);X.borderDoneWithNeighborZ[Q]=h.canonical.z,X.needsCentroidUpdate=!0}h.borderDoneWithNeighborZ[W]=X.canonical.z,h.needsCentroidUpdate=!0}}(h.needsCentroidUpdate||!h.centroidVertexBuffer&&h.centroidVertexArray.length!==0)&&h.uploadCentroid(l)}const uc=new o.Color(1,0,0,1),hc=new o.Color(0,1,0,1),Ju=new o.Color(0,0,1,1),qa=new o.Color(1,0,1,1),Wa=new o.Color(0,1,1,1);function et(l,t,s,h){qs(l,0,t+s/2,l.transform.width,s,h)}function jn(l,t,s,h){qs(l,t-s/2,0,s,l.transform.height,h)}function qs(l,t,s,h,m,_){const x=l.context,A=x.gl;A.enable(A.SCISSOR_TEST),A.scissor(t*o.exported.devicePixelRatio,s*o.exported.devicePixelRatio,h*o.exported.devicePixelRatio,m*o.exported.devicePixelRatio),x.clear({color:_}),A.disable(A.SCISSOR_TEST)}function eh(l,t,s){const h=l.context,m=h.gl,_=l.transform.projection.name==="globe",x=s.projMatrix,A=l.useProgram("debug",null,_?["PROJECTION_GLOBE_VIEW"]:null),C=t.getTileByID(s.key);l.terrain&&l.terrain.setupElevationDraw(C,A);const S=o.DepthMode.disabled,z=o.StencilMode.disabled,B=l.colorModeForRenderPass(),N="$debug";h.activeTexture.set(m.TEXTURE0),l.emptyTexture.bind(m.LINEAR,m.CLAMP_TO_EDGE),_?C._makeGlobeTileDebugBuffers(l.context,l.transform.projection):C._makeDebugTileBoundsBuffers(l.context,l.transform.projection);const G=C._tileDebugBuffer||l.debugBuffer,V=C._tileDebugIndexBuffer||l.debugIndexBuffer,O=C._tileDebugSegments||l.debugSegments;A.draw(h,m.LINE_STRIP,S,z,B,o.CullFaceMode.disabled,Yu(x,o.Color.red),N,G,V,O,null,null,null,C._globeTileDebugBorderBuffer);const $=C.latestRawTileData,W=Math.floor(($&&$.byteLength||0)/1024),Q=t.getTile(s).tileSize,K=512/Math.min(Q,512)*(s.overscaledZ/l.transform.zoom)*.5;let ee=s.canonical.toString();s.overscaledZ!==s.canonical.z&&(ee+=` => ${s.overscaledZ}`),function(Ae,Se){Ae.initDebugOverlayCanvas();const Ce=Ae.debugOverlayCanvas,Ze=Ae.context.gl,ye=Ae.debugOverlayCanvas.getContext("2d");ye.clearRect(0,0,Ce.width,Ce.height),ye.shadowColor="white",ye.shadowBlur=2,ye.lineWidth=1.5,ye.strokeStyle="white",ye.textBaseline="top",ye.font="bold 36px Open Sans, sans-serif",ye.fillText(Se,5,5),ye.strokeText(Se,5,5),Ae.debugOverlayTexture.update(Ce),Ae.debugOverlayTexture.bind(Ze.LINEAR,Ze.CLAMP_TO_EDGE)}(l,`${ee} ${W}kb`);const X=C._tileDebugTextBuffer||l.debugBuffer,re=C._tileDebugTextIndexBuffer||l.quadTriangleIndexBuffer,ge=C._tileDebugTextSegments||l.debugSegments;A.draw(h,m.TRIANGLES,S,z,o.ColorMode.alphaBlended,o.CullFaceMode.disabled,Yu(x,o.Color.transparent,K),N,X,re,ge,null,null,null,C._globeTileDebugTextBuffer)}const th=o.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:es}=th;function Cr(l,t,s,h){l.emplaceBack(t,s,h)}class Ws{constructor(t){this.vertexArray=new o.StructArrayLayout3f12,this.indices=new o.StructArrayLayout3ui6,Cr(this.vertexArray,-1,-1,1),Cr(this.vertexArray,1,-1,1),Cr(this.vertexArray,-1,1,1),Cr(this.vertexArray,1,1,1),Cr(this.vertexArray,-1,-1,-1),Cr(this.vertexArray,1,-1,-1),Cr(this.vertexArray,-1,1,-1),Cr(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=t.createVertexBuffer(this.vertexArray,es),this.indexBuffer=t.createIndexBuffer(this.indices),this.segment=o.SegmentVector.simpleSegment(0,0,36,12)}}function jr(l,t,s,h,m,_){const x=l.gl,A=t.paint.get("sky-atmosphere-color"),C=t.paint.get("sky-atmosphere-halo-color"),S=t.paint.get("sky-atmosphere-sun-intensity"),z=((B,N,G,V,O)=>({u_matrix_3f:B,u_sun_direction:N,u_sun_intensity:G,u_color_tint_r:[V.r,V.g,V.b,V.a],u_color_tint_m:[O.r,O.g,O.b,O.a],u_luminance:5e-5}))(o.fromMat4(o.create$1(),h),m,S,A,C);x.framebufferTexture2D(x.FRAMEBUFFER,x.COLOR_ATTACHMENT0,x.TEXTURE_CUBE_MAP_POSITIVE_X+_,t.skyboxTexture,0),s.draw(l,x.TRIANGLES,o.DepthMode.disabled,o.StencilMode.disabled,o.ColorMode.unblended,o.CullFaceMode.frontCW,z,"skyboxCapture",t.skyboxGeometry.vertexBuffer,t.skyboxGeometry.indexBuffer,t.skyboxGeometry.segment)}function Gr(l,t){return o.transformMat4(l,l,t)}const dc={symbol:function(l,t,s,h,m){if(l.renderPass!=="translucent")return;const _=o.StencilMode.disabled,x=l.colorModeForRenderPass();s.layout.get("text-variable-anchor")&&function(A,C,S,z,B,N,G){const V=C.transform,O=B==="map",$=N==="map";for(const W of A){const Q=z.getTile(W),K=Q.getBucket(S);if(!K||K.projection!==V.projection.name||!K.text||!K.text.segments.get().length)continue;const ee=o.evaluateSizeForZoom(K.textSizeData,V.zoom),X=C.transform.calculatePixelsToTileUnitsMatrix(Q),re=xo(W.projMatrix,Q.tileID.canonical,$,O,C.transform,X),ge=S.layout.get("icon-text-fit")!=="none"&&K.hasIconData();if(ee){const Ae=Math.pow(2,V.zoom-Q.tileID.overscaledZ);ap(K,O,$,G,o.symbolSize,V,re,W,Ae,ee,ge,V.projection)}}}(h,l,s,t,s.layout.get("text-rotation-alignment"),s.layout.get("text-pitch-alignment"),m),s.paint.get("icon-opacity").constantOr(1)!==0&&cc(l,t,s,h,!1,s.paint.get("icon-translate"),s.paint.get("icon-translate-anchor"),s.layout.get("icon-rotation-alignment"),s.layout.get("icon-pitch-alignment"),s.layout.get("icon-keep-upright"),_,x),s.paint.get("text-opacity").constantOr(1)!==0&&cc(l,t,s,h,!0,s.paint.get("text-translate"),s.paint.get("text-translate-anchor"),s.layout.get("text-rotation-alignment"),s.layout.get("text-pitch-alignment"),s.layout.get("text-keep-upright"),_,x),t.map.showCollisionBoxes&&(Ku(l,t,s,h,s.paint.get("text-translate"),s.paint.get("text-translate-anchor"),!0),Ku(l,t,s,h,s.paint.get("icon-translate"),s.paint.get("icon-translate-anchor"),!1))},circle:function(l,t,s,h){if(l.renderPass!=="translucent")return;const m=s.paint.get("circle-opacity"),_=s.paint.get("circle-stroke-width"),x=s.paint.get("circle-stroke-opacity"),A=s.layout.get("circle-sort-key").constantOr(1)!==void 0;if(m.constantOr(1)===0&&(_.constantOr(1)===0||x.constantOr(1)===0))return;const C=l.context,S=C.gl,z=l.transform,B=l.depthModeForSublayer(0,o.DepthMode.ReadOnly),N=o.StencilMode.disabled,G=l.colorModeForRenderPass(),V=z.projection.name==="globe",O=[o.mercatorXfromLng(z.center.lng),o.mercatorYfromLat(z.center.lat)],$=[];for(let Q=0;Q<h.length;Q++){const K=h[Q],ee=t.getTile(K),X=ee.getBucket(s);if(!X)continue;const re=X.programConfigurations.get(s.id),ge=ip(s);V&&ge.push("PROJECTION_GLOBE_VIEW");const Ae=l.useProgram("circle",re,ge),Se=X.layoutVertexBuffer,Ce=X.globeExtVertexBuffer,Ze=X.indexBuffer,ye=z.projection.createInversionMatrix(z,K.canonical),je={programConfiguration:re,program:Ae,layoutVertexBuffer:Se,globeExtVertexBuffer:Ce,indexBuffer:Ze,uniformValues:Ko(l,K,ee,ye,O,s),tile:ee};if(A){const Ue=X.segments.get();for(const lt of Ue)$.push({segments:new o.SegmentVector([lt]),sortKey:lt.sortKey,state:je})}else $.push({segments:X.segments,sortKey:0,state:je})}A&&$.sort((Q,K)=>Q.sortKey-K.sortKey);const W={useDepthForOcclusion:!V};for(const Q of $){const{programConfiguration:K,program:ee,layoutVertexBuffer:X,globeExtVertexBuffer:re,indexBuffer:ge,uniformValues:Ae,tile:Se}=Q.state,Ce=Q.segments;l.terrain&&l.terrain.setupElevationDraw(Se,ee,W),l.prepareDrawProgram(C,ee,Se.tileID.toUnwrapped()),ee.draw(C,S.TRIANGLES,B,N,G,o.CullFaceMode.disabled,Ae,s.id,X,ge,Ce,s.paint,z.zoom,K,V?re:null)}},heatmap:function(l,t,s,h){if(s.paint.get("heatmap-opacity")!==0)if(l.renderPass==="offscreen"){const m=l.context,_=m.gl,x=o.StencilMode.disabled,A=new o.ColorMode([_.ONE,_.ONE],o.Color.transparent,[!0,!0,!0,!0]);(function(N,G,V){const O=N.gl;N.activeTexture.set(O.TEXTURE1),N.viewport.set([0,0,G.width/4,G.height/4]);let $=V.heatmapFbo;if($)O.bindTexture(O.TEXTURE_2D,$.colorAttachment.get()),N.bindFramebuffer.set($.framebuffer);else{const W=O.createTexture();O.bindTexture(O.TEXTURE_2D,W),O.texParameteri(O.TEXTURE_2D,O.TEXTURE_WRAP_S,O.CLAMP_TO_EDGE),O.texParameteri(O.TEXTURE_2D,O.TEXTURE_WRAP_T,O.CLAMP_TO_EDGE),O.texParameteri(O.TEXTURE_2D,O.TEXTURE_MIN_FILTER,O.LINEAR),O.texParameteri(O.TEXTURE_2D,O.TEXTURE_MAG_FILTER,O.LINEAR),$=V.heatmapFbo=N.createFramebuffer(G.width/4,G.height/4,!1),function(Q,K,ee,X){const re=Q.gl;re.texImage2D(re.TEXTURE_2D,0,re.RGBA,K.width/4,K.height/4,0,re.RGBA,Q.extRenderToTextureHalfFloat?Q.extTextureHalfFloat.HALF_FLOAT_OES:re.UNSIGNED_BYTE,null),X.colorAttachment.set(ee)}(N,G,W,$)}})(m,l,s),m.clear({color:o.Color.transparent});const C=l.transform,S=C.projection.name==="globe",z=S?["PROJECTION_GLOBE_VIEW"]:null,B=[o.mercatorXfromLng(C.center.lng),o.mercatorYfromLat(C.center.lat)];for(let N=0;N<h.length;N++){const G=h[N];if(t.hasRenderableParent(G))continue;const V=t.getTile(G),O=V.getBucket(s);if(!O)continue;const $=O.programConfigurations.get(s.id),W=l.useProgram("heatmap",$,z),{zoom:Q}=l.transform;l.terrain&&l.terrain.setupElevationDraw(V,W),l.prepareDrawProgram(m,W,G.toUnwrapped());const K=C.projection.createInversionMatrix(C,G.canonical);W.draw(m,_.TRIANGLES,o.DepthMode.disabled,x,A,o.CullFaceMode.disabled,op(l,G,V,K,B,Q,s.paint.get("heatmap-intensity")),s.id,O.layoutVertexBuffer,O.indexBuffer,O.segments,s.paint,l.transform.zoom,$,S?O.globeExtVertexBuffer:null)}m.viewport.set([0,0,l.width,l.height])}else l.renderPass==="translucent"&&(l.context.setColorMode(l.colorModeForRenderPass()),function(m,_){const x=m.context,A=x.gl,C=_.heatmapFbo;if(!C)return;x.activeTexture.set(A.TEXTURE0),A.bindTexture(A.TEXTURE_2D,C.colorAttachment.get()),x.activeTexture.set(A.TEXTURE1);let S=_.colorRampTexture;S||(S=_.colorRampTexture=new o.Texture(x,_.colorRamp,A.RGBA)),S.bind(A.LINEAR,A.CLAMP_TO_EDGE),m.useProgram("heatmapTexture").draw(x,A.TRIANGLES,o.DepthMode.disabled,o.StencilMode.disabled,m.colorModeForRenderPass(),o.CullFaceMode.disabled,((z,B,N,G)=>({u_image:0,u_color_ramp:1,u_opacity:B.paint.get("heatmap-opacity")}))(0,_),_.id,m.viewportBuffer,m.quadTriangleIndexBuffer,m.viewportSegments,_.paint,m.transform.zoom)}(l,s))},line:function(l,t,s,h){if(l.renderPass!=="translucent")return;const m=s.paint.get("line-opacity"),_=s.paint.get("line-width");if(m.constantOr(1)===0||_.constantOr(1)===0)return;const x=l.depthModeForSublayer(0,o.DepthMode.ReadOnly),A=l.colorModeForRenderPass(),C=l.terrain&&l.terrain.renderingToTexture?1:o.exported.devicePixelRatio,S=s.paint.get("line-dasharray"),z=S.constantOr(1),B=s.layout.get("line-cap"),N=s.paint.get("line-pattern"),G=N.constantOr(1),V=s.paint.get("line-gradient"),O=s.getCrossfadeParameters(),$=G?"linePattern":"line",W=l.context,Q=W.gl,K=(X=>{const re=[];rc(X)&&re.push("RENDER_LINE_DASH"),X.paint.get("line-gradient")&&re.push("RENDER_LINE_GRADIENT");const ge=X.paint.get("line-pattern").constantOr(1),Ae=X.paint.get("line-opacity").constantOr(1)!==1;return!ge&&Ae&&re.push("RENDER_LINE_ALPHA_DISCARD"),re})(s);let ee=K.includes("RENDER_LINE_ALPHA_DISCARD");l.terrain&&l.terrain.clipOrMaskOverlapStencilType()&&(ee=!1);for(const X of h){const re=t.getTile(X);if(G&&!re.patternsLoaded())continue;const ge=re.getBucket(s);if(!ge)continue;l.prepareDrawTile();const Ae=ge.programConfigurations.get(s.id),Se=l.useProgram($,Ae,K),Ce=N.constantOr(null);if(Ce&&re.imageAtlas){const we=re.imageAtlas,pt=we.patternPositions[Ce.to.toString()],yt=we.patternPositions[Ce.from.toString()];pt&&yt&&Ae.setConstantPatternPositions(pt,yt)}const Ze=S.constantOr(null),ye=B.constantOr(null);if(!G&&Ze&&ye&&re.lineAtlas){const we=re.lineAtlas,pt=we.getDash(Ze.to,ye),yt=we.getDash(Ze.from,ye);pt&&yt&&Ae.setConstantPatternPositions(pt,yt)}const je=l.terrain?X.projMatrix:null,Ue=G?nc(l,re,s,O,je,C):sp(l,re,s,O,je,ge.lineClipsArray.length,C);if(V){const we=ge.gradients[s.id];let pt=we.texture;if(s.gradientVersion!==we.version){let yt=256;if(s.stepInterpolant){const ot=t.getSource().maxzoom,st=X.canonical.z===ot?Math.ceil(1<<l.transform.maxZoom-X.canonical.z):1;yt=o.clamp(o.nextPowerOfTwo(ge.maxLineLength/o.EXTENT*1024*st),256,W.maxTextureSize)}we.gradient=o.renderColorRamp({expression:s.gradientExpression(),evaluationKey:"lineProgress",resolution:yt,image:we.gradient||void 0,clips:ge.lineClipsArray}),we.texture?we.texture.update(we.gradient):we.texture=new o.Texture(W,we.gradient,Q.RGBA),we.version=s.gradientVersion,pt=we.texture}W.activeTexture.set(Q.TEXTURE1),pt.bind(s.stepInterpolant?Q.NEAREST:Q.LINEAR,Q.CLAMP_TO_EDGE)}z&&(W.activeTexture.set(Q.TEXTURE0),re.lineAtlasTexture.bind(Q.LINEAR,Q.REPEAT),Ae.updatePaintBuffers(O)),G&&(W.activeTexture.set(Q.TEXTURE0),re.imageAtlasTexture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE),Ae.updatePaintBuffers(O)),l.prepareDrawProgram(W,Se,X.toUnwrapped());const lt=we=>{Se.draw(W,Q.TRIANGLES,x,we,A,o.CullFaceMode.disabled,Ue,s.id,ge.layoutVertexBuffer,ge.indexBuffer,ge.segments,s.paint,l.transform.zoom,Ae,ge.layoutVertexBuffer2)};if(ee){const we=l.stencilModeForClipping(X).ref;we===0&&l.terrain&&W.clear({stencil:0});const pt={func:Q.EQUAL,mask:255};Ue.u_alpha_discard_threshold=.8,lt(new o.StencilMode(pt,we,255,Q.KEEP,Q.KEEP,Q.INVERT)),Ue.u_alpha_discard_threshold=0,lt(new o.StencilMode(pt,we,255,Q.KEEP,Q.KEEP,Q.KEEP))}else lt(l.stencilModeForClipping(X))}ee&&(l.resetStencilClippingMasks(),l.terrain&&W.clear({stencil:0}))},fill:function(l,t,s,h){const m=s.paint.get("fill-color"),_=s.paint.get("fill-opacity");if(_.constantOr(1)===0)return;const x=l.colorModeForRenderPass(),A=s.paint.get("fill-pattern"),C=l.opaquePassEnabledForLayer()&&!A.constantOr(1)&&m.constantOr(o.Color.transparent).a===1&&_.constantOr(0)===1?"opaque":"translucent";if(l.renderPass===C){const S=l.depthModeForSublayer(1,l.renderPass==="opaque"?o.DepthMode.ReadWrite:o.DepthMode.ReadOnly);Za(l,t,s,h,S,x,!1)}if(l.renderPass==="translucent"&&s.paint.get("fill-antialias")){const S=l.depthModeForSublayer(s.getPaintProperty("fill-outline-color")?2:0,o.DepthMode.ReadOnly);Za(l,t,s,h,S,x,!0)}},"fill-extrusion":function(l,t,s,h){const m=s.paint.get("fill-extrusion-opacity");if(m!==0&&l.renderPass==="translucent"){const _=new o.DepthMode(l.context.gl.LEQUAL,o.DepthMode.ReadWrite,l.depthRangeFor3D);if(m!==1||s.paint.get("fill-extrusion-pattern").constantOr(1))Jo(l,t,s,h,_,o.StencilMode.disabled,o.ColorMode.disabled),Jo(l,t,s,h,_,l.stencilModeFor3D(),l.colorModeForRenderPass()),l.resetStencilClippingMasks();else{const x=l.colorModeForRenderPass();Jo(l,t,s,h,_,o.StencilMode.disabled,x)}}},hillshade:function(l,t,s,h){if(l.renderPass!=="offscreen"&&l.renderPass!=="translucent")return;const m=l.context,_=l.depthModeForSublayer(0,o.DepthMode.ReadOnly),x=l.colorModeForRenderPass(),A=l.terrain&&l.terrain.renderingToTexture,[C,S]=l.renderPass!=="translucent"||A?[{},h]:l.stencilConfigForOverlap(h);for(const z of S){const B=t.getTile(z);if(B.needsHillshadePrepare&&l.renderPass==="offscreen")Kl(l,B,s,_,o.StencilMode.disabled,x);else if(l.renderPass==="translucent"){const N=A&&l.terrain?l.terrain.stencilModeForRTTOverlap(z):C[z.overscaledZ];Gu(l,z,B,s,_,N,x)}}m.viewport.set([0,0,l.width,l.height]),l.resetStencilClippingMasks()},raster:function(l,t,s,h,m,_){if(l.renderPass!=="translucent"||s.paint.get("raster-opacity")===0||!h.length)return;const x=l.context,A=x.gl,C=t.getSource(),S=l.useProgram("raster"),z=l.colorModeForRenderPass(),B=l.terrain&&l.terrain.renderingToTexture,[N,G]=C instanceof ae||B?[{},h]:l.stencilConfigForOverlap(h),V=G[G.length-1].overscaledZ,O=!l.options.moving;for(const $ of G){const W=B?o.DepthMode.disabled:l.depthModeForSublayer($.overscaledZ-V,s.paint.get("raster-opacity")===1?o.DepthMode.ReadWrite:o.DepthMode.ReadOnly,A.LESS),Q=$.toUnwrapped(),K=t.getTile($);if(B&&(!K||!K.hasData()))continue;const ee=B?$.projMatrix:l.transform.calculateProjMatrix(Q,O),X=l.terrain&&B?l.terrain.stencilModeForRTTOverlap($):N[$.overscaledZ],re=_?0:s.paint.get("raster-fade-duration");K.registerFadeDuration(re);const ge=t.findLoadedParent($,0),Ae=ec(K,ge,t,l.transform,re);let Se,Ce;l.terrain&&l.terrain.prepareDrawTile();const Ze=s.paint.get("raster-resampling")==="nearest"?A.NEAREST:A.LINEAR;x.activeTexture.set(A.TEXTURE0),K.texture.bind(Ze,A.CLAMP_TO_EDGE),x.activeTexture.set(A.TEXTURE1),ge?(ge.texture.bind(Ze,A.CLAMP_TO_EDGE),Se=Math.pow(2,ge.tileID.overscaledZ-K.tileID.overscaledZ),Ce=[K.tileID.canonical.x*Se%1,K.tileID.canonical.y*Se%1]):K.texture.bind(Ze,A.CLAMP_TO_EDGE);const ye=Xu(ee,Ce||[0,0],Se||1,Ae,s,C instanceof ae?C.perspectiveTransform:[0,0]);if(l.prepareDrawProgram(x,S,Q),C instanceof ae)C.boundsBuffer&&C.boundsSegments&&S.draw(x,A.TRIANGLES,W,o.StencilMode.disabled,z,o.CullFaceMode.disabled,ye,s.id,C.boundsBuffer,l.quadTriangleIndexBuffer,C.boundsSegments);else{const{tileBoundsBuffer:je,tileBoundsIndexBuffer:Ue,tileBoundsSegments:lt}=l.getTileBoundsBuffers(K);S.draw(x,A.TRIANGLES,W,X,z,o.CullFaceMode.disabled,ye,s.id,je,Ue,lt)}}l.resetStencilClippingMasks()},background:function(l,t,s,h){const m=s.paint.get("background-color"),_=s.paint.get("background-opacity");if(_===0)return;const x=l.context,A=x.gl,C=l.transform,S=C.tileSize,z=s.paint.get("background-pattern");if(l.isPatternMissing(z))return;const B=!z&&m.a===1&&_===1&&l.opaquePassEnabledForLayer()?"opaque":"translucent";if(l.renderPass!==B)return;const N=o.StencilMode.disabled,G=l.depthModeForSublayer(0,B==="opaque"?o.DepthMode.ReadWrite:o.DepthMode.ReadOnly),V=l.colorModeForRenderPass(),O=l.useProgram(z?"backgroundPattern":"background");let $,W=h;W||($=l.getBackgroundTiles(),W=Object.values($).map(K=>K.tileID)),z&&(x.activeTexture.set(A.TEXTURE0),l.imageManager.bind(l.context));const Q=s.getCrossfadeParameters();for(const K of W){const ee=K.toUnwrapped(),X=h?K.projMatrix:l.transform.calculateProjMatrix(ee);l.prepareDrawTile();const re=t?t.getTile(K):$?$[K.key]:new o.Tile(K,S,C.zoom,l),ge=z?ac(X,_,l,z,{tileID:K,tileSize:S},Q):Qu(X,_,m);l.prepareDrawProgram(x,O,ee);const{tileBoundsBuffer:Ae,tileBoundsIndexBuffer:Se,tileBoundsSegments:Ce}=l.getTileBoundsBuffers(re);O.draw(x,A.TRIANGLES,G,N,V,o.CullFaceMode.disabled,ge,s.id,Ae,Se,Ce)}},sky:function(l,t,s){const h=l.transform,m=h.projection.name==="mercator"||h.projection.name==="globe"?1:o.smoothstep(7,8,h.zoom),_=s.paint.get("sky-opacity")*m;if(_===0)return;const x=l.context,A=s.paint.get("sky-type"),C=new o.DepthMode(x.gl.LEQUAL,o.DepthMode.ReadOnly,[0,1]),S=l.frameCounter/1e3%1;A==="atmosphere"?l.renderPass==="offscreen"?s.needsSkyboxCapture(l)&&(function(z,B,N,G){const V=z.context,O=V.gl;let $=B.skyboxFbo;if(!$){$=B.skyboxFbo=V.createFramebuffer(32,32,!1),B.skyboxGeometry=new Ws(V),B.skyboxTexture=V.gl.createTexture(),O.bindTexture(O.TEXTURE_CUBE_MAP,B.skyboxTexture),O.texParameteri(O.TEXTURE_CUBE_MAP,O.TEXTURE_WRAP_S,O.CLAMP_TO_EDGE),O.texParameteri(O.TEXTURE_CUBE_MAP,O.TEXTURE_WRAP_T,O.CLAMP_TO_EDGE),O.texParameteri(O.TEXTURE_CUBE_MAP,O.TEXTURE_MIN_FILTER,O.LINEAR),O.texParameteri(O.TEXTURE_CUBE_MAP,O.TEXTURE_MAG_FILTER,O.LINEAR);for(let ee=0;ee<6;++ee)O.texImage2D(O.TEXTURE_CUBE_MAP_POSITIVE_X+ee,0,O.RGBA,32,32,0,O.RGBA,O.UNSIGNED_BYTE,null)}V.bindFramebuffer.set($.framebuffer),V.viewport.set([0,0,32,32]);const W=B.getCenter(z,!0),Q=z.useProgram("skyboxCapture"),K=new Float64Array(16);o.identity(K),o.rotateY(K,K,.5*-Math.PI),jr(V,B,Q,K,W,0),o.identity(K),o.rotateY(K,K,.5*Math.PI),jr(V,B,Q,K,W,1),o.identity(K),o.rotateX(K,K,.5*-Math.PI),jr(V,B,Q,K,W,2),o.identity(K),o.rotateX(K,K,.5*Math.PI),jr(V,B,Q,K,W,3),o.identity(K),jr(V,B,Q,K,W,4),o.identity(K),o.rotateY(K,K,Math.PI),jr(V,B,Q,K,W,5),V.viewport.set([0,0,z.width,z.height])}(l,s),s.markSkyboxValid(l)):l.renderPass==="sky"&&function(z,B,N,G,V){const O=z.context,$=O.gl,W=z.transform,Q=z.useProgram("skybox");O.activeTexture.set($.TEXTURE0),$.bindTexture($.TEXTURE_CUBE_MAP,B.skyboxTexture);const K=((ee,X,re,ge,Ae)=>({u_matrix:ee,u_sun_direction:X,u_cubemap:0,u_opacity:ge,u_temporal_offset:Ae}))(W.skyboxMatrix,B.getCenter(z,!1),0,G,V);z.prepareDrawProgram(O,Q),Q.draw(O,$.TRIANGLES,N,o.StencilMode.disabled,z.colorModeForRenderPass(),o.CullFaceMode.backCW,K,"skybox",B.skyboxGeometry.vertexBuffer,B.skyboxGeometry.indexBuffer,B.skyboxGeometry.segment)}(l,s,C,_,S):A==="gradient"&&l.renderPass==="sky"&&function(z,B,N,G,V){const O=z.context,$=O.gl,W=z.transform,Q=z.useProgram("skyboxGradient");B.skyboxGeometry||(B.skyboxGeometry=new Ws(O)),O.activeTexture.set($.TEXTURE0);let K=B.colorRampTexture;K||(K=B.colorRampTexture=new o.Texture(O,B.colorRamp,$.RGBA)),K.bind($.LINEAR,$.CLAMP_TO_EDGE);const ee=((X,re,ge,Ae,Se)=>({u_matrix:X,u_color_ramp:0,u_center_direction:re,u_radius:o.degToRad(ge),u_opacity:Ae,u_temporal_offset:Se}))(W.skyboxMatrix,B.getCenter(z,!1),B.paint.get("sky-gradient-radius"),G,V);z.prepareDrawProgram(O,Q),Q.draw(O,$.TRIANGLES,N,o.StencilMode.disabled,z.colorModeForRenderPass(),o.CullFaceMode.backCW,ee,"skyboxGradient",B.skyboxGeometry.vertexBuffer,B.skyboxGeometry.indexBuffer,B.skyboxGeometry.segment)}(l,s,C,_,S)},debug:function(l,t,s){for(let h=0;h<s.length;h++)eh(l,t,s[h])},custom:function(l,t,s){const h=l.context,m=s.implementation;if(l.transform.projection.unsupportedLayers&&l.transform.projection.unsupportedLayers.includes("custom"))o.warnOnce("Custom layers are not yet supported with non-mercator projections. Use mercator to enable custom layers.");else if(l.renderPass==="offscreen"){const _=m.prerender;_&&(l.setCustomLayerDefaults(),h.setColorMode(l.colorModeForRenderPass()),_.call(m,h.gl,l.transform.customLayerMatrix()),h.setDirty(),l.setBaseState())}else if(l.renderPass==="translucent"){l.setCustomLayerDefaults(),h.setColorMode(l.colorModeForRenderPass()),h.setStencilMode(o.StencilMode.disabled);const _=m.renderingMode==="3d"?new o.DepthMode(l.context.gl.LEQUAL,o.DepthMode.ReadWrite,l.depthRangeFor3D):l.depthModeForSublayer(0,o.DepthMode.ReadOnly);h.setDepthMode(_),m.render(h.gl,l.transform.customLayerMatrix()),h.setDirty(),l.setBaseState(),h.bindFramebuffer.set(null)}}};class ih{constructor(t,s){this.context=new P(t),this.transform=s,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=o.SourceCache.maxUnderzooming+o.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Da,this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this._tileClippingMaskIDs=new Map,this._skippedStencilTileIDs=new Set}updateTerrain(t,s){const h=!!t&&!!t.terrain&&this.transform.projection.supportsTerrain;if(!(h||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new zn(this,t));const m=this._terrain;this.transform.elevation=h?m:null,m.update(t,this.transform,s)}_updateFog(t){const s=t.fog;if(!s||s.getOpacity(this.transform.pitch)<1||s.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[h,m]=s.getFovAdjustedRange(this.transform._fov);if(h>m)return void(this.transform.fogCullDistSq=null);const _=h+.78*(m-h);this.transform.fogCullDistSq=_*_}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(t,s){if(this.width=t*o.exported.devicePixelRatio,this.height=s*o.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const h of this.style.order)this.style._layers[h].resize()}setup(){const t=this.context,s=new o.StructArrayLayout2i4;s.emplaceBack(0,0),s.emplaceBack(o.EXTENT,0),s.emplaceBack(0,o.EXTENT),s.emplaceBack(o.EXTENT,o.EXTENT),this.tileExtentBuffer=t.createVertexBuffer(s,o.posAttributes.members),this.tileExtentSegments=o.SegmentVector.simpleSegment(0,0,4,2);const h=new o.StructArrayLayout2i4;h.emplaceBack(0,0),h.emplaceBack(o.EXTENT,0),h.emplaceBack(0,o.EXTENT),h.emplaceBack(o.EXTENT,o.EXTENT),this.debugBuffer=t.createVertexBuffer(h,o.posAttributes.members),this.debugSegments=o.SegmentVector.simpleSegment(0,0,4,5);const m=new o.StructArrayLayout2i4;m.emplaceBack(-1,-1),m.emplaceBack(1,-1),m.emplaceBack(-1,1),m.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(m,o.posAttributes.members),this.viewportSegments=o.SegmentVector.simpleSegment(0,0,4,2);const _=new o.StructArrayLayout4i8;_.emplaceBack(0,0,0,0),_.emplaceBack(o.EXTENT,0,o.EXTENT,0),_.emplaceBack(0,o.EXTENT,0,o.EXTENT),_.emplaceBack(o.EXTENT,o.EXTENT,o.EXTENT,o.EXTENT),this.mercatorBoundsBuffer=t.createVertexBuffer(_,o.boundsAttributes.members),this.mercatorBoundsSegments=o.SegmentVector.simpleSegment(0,0,4,2);const x=new o.StructArrayLayout3ui6;x.emplaceBack(0,1,2),x.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(x);const A=new o.StructArrayLayout1ui2;for(const S of[0,1,3,2,0])A.emplaceBack(S);this.debugIndexBuffer=t.createIndexBuffer(A),this.emptyTexture=new o.Texture(t,new o.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),t.gl.RGBA),this.identityMat=o.create();const C=this.context.gl;this.stencilClearMode=new o.StencilMode({func:C.ALWAYS,mask:0},0,255,C.ZERO,C.ZERO,C.ZERO),this.loadTimeStamps.push(o.window.performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(t){return t._makeTileBoundsBuffers(this.context,this.transform.projection),t._tileBoundsBuffer?{tileBoundsBuffer:t._tileBoundsBuffer,tileBoundsIndexBuffer:t._tileBoundsIndexBuffer,tileBoundsSegments:t._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const t=this.context,s=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs.clear(),this._skippedStencilTileIDs.clear(),this.useProgram("clippingMask").draw(t,s.TRIANGLES,o.DepthMode.disabled,this.stencilClearMode,o.ColorMode.disabled,o.CullFaceMode.disabled,Ra(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs.clear(),this._skippedStencilTileIDs.clear())}_renderTileClippingMasks(t,s,h){if(!s||this.currentStencilSource===s.id||!t.isTileClipped()||!h||h.length===0)return;const m=[];let _=!1;if(this._tileClippingMaskIDs&&!this.terrain){for(const z of h)if(this._tileClippingMaskIDs.has(z.key)||(_=!0),this._skippedStencilTileIDs.has(z.key)){if(!s.getTile(z).getBucket(t))continue;this._skippedStencilTileIDs.delete(z.key),m.push(z)}if(!_&&m.length===0)return}const x=this.context,A=x.gl;x.setColorMode(o.ColorMode.disabled),x.setDepthMode(o.DepthMode.disabled);const C=this.useProgram("clippingMask"),S=z=>{const B=s.getTile(z),{tileBoundsBuffer:N,tileBoundsIndexBuffer:G,tileBoundsSegments:V}=this.getTileBoundsBuffers(B);C.draw(x,A.TRIANGLES,o.DepthMode.disabled,new o.StencilMode({func:A.GREATER,mask:255},this._tileClippingMaskIDs.get(z.key)||0,255,A.KEEP,A.KEEP,A.REPLACE),o.ColorMode.disabled,o.CullFaceMode.disabled,Ra(z.projMatrix),"$clipping",N,G,V)};if(!_&&m.length>0)for(const z of m)S(z);else{(this._tileClippingMaskIDs.size===0||this.nextStencilID+h.length>256)&&this.clearStencil(),this._tileClippingMaskIDs.clear(),this._skippedStencilTileIDs.clear();for(const z of h)this._tileClippingMaskIDs.set(z.key,this.nextStencilID++),s.getTile(z).getBucket(t)?S(z):this._skippedStencilTileIDs.add(z.key)}this._skippedStencilTileIDs.size===0&&(this.currentStencilSource=s.id)}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,s=this.context.gl;return new o.StencilMode({func:s.NOTEQUAL,mask:255},t,255,s.KEEP,s.KEEP,s.REPLACE)}stencilModeForClipping(t){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(t);const s=this.context.gl;return new o.StencilMode({func:s.EQUAL,mask:255},this._tileClippingMaskIDs.get(t.key)||0,0,s.KEEP,s.KEEP,s.REPLACE)}stencilConfigForOverlap(t){const s=this.context.gl,h=t.sort((x,A)=>A.overscaledZ-x.overscaledZ),m=h[h.length-1].overscaledZ,_=h[0].overscaledZ-m+1;if(_>1){this.currentStencilSource=void 0,this.nextStencilID+_>256&&this.clearStencil();const x={};for(let A=0;A<_;A++)x[A+m]=new o.StencilMode({func:s.GEQUAL,mask:255},A+this.nextStencilID,255,s.KEEP,s.KEEP,s.REPLACE);return this.nextStencilID+=_,[x,h]}return[{[m]:o.StencilMode.disabled},h]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new o.ColorMode([t.CONSTANT_COLOR,t.ONE],new o.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?o.ColorMode.unblended:o.ColorMode.alphaBlended}depthModeForSublayer(t,s,h){if(!this.opaquePassEnabledForLayer())return o.DepthMode.disabled;const m=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new o.DepthMode(h||this.context.gl.LEQUAL,s,[m,m])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,s){this.style=t,this.options=s,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(o.exported.now()),this.imageManager.beginFrame();const h=this.style.order,m=this.style._sourceCaches;for(const S in m){const z=m[S];z.used&&z.prepare(this.context)}const _={},x={},A={};for(const S in m){const z=m[S];_[S]=z.getVisibleCoordinates(),x[S]=_[S].slice().reverse(),A[S]=z.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let S=0;S<h.length;S++)if(this.style._layers[h[S]].is3D()){this.opaquePassCutoff=S;break}if(this.terrain&&(this.terrain.updateTileBinding(A),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new o.GlobeSharedBuffers(this.context)),!o.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const S of h){const z=this.style._layers[S],B=t._getLayerSourceCache(z);if(!z.hasOffscreenPass()||z.isHidden(this.transform.zoom))continue;const N=B?x[B.id]:void 0;(z.type==="custom"||z.isSky()||N&&N.length)&&this.renderLayer(this,B,z,N)}this.depthRangeFor3D=[0,1-(t.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);let C=o.Color.transparent;if(this.style.fog&&this.style.fog.getOpacity(this.transform.pitch)&&(C=this.style.fog.properties.get("color")),this.context.clear({color:s.showOverdrawInspector?o.Color.black:C,depth:1}),this.clearStencil(),this._showOverdrawInspector=s.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=h.length-1;this.currentLayer>=0;this.currentLayer--){const S=this.style._layers[h[this.currentLayer]],z=t._getLayerSourceCache(S);if(S.isSky())continue;const B=z?x[z.id]:void 0;this._renderTileClippingMasks(S,z,B),this.renderLayer(this,z,S,B)}if(this.renderPass="sky",(o.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<h.length;this.currentLayer++){const S=this.style._layers[h[this.currentLayer]],z=t._getLayerSourceCache(S);S.isSky()&&this.renderLayer(this,z,S,z?x[z.id]:void 0)}for(this.transform.projection.name==="globe"&&function(S){const z=S.context,B=z.gl,N=S.transform,G=new o.DepthMode(B.LEQUAL,o.DepthMode.ReadOnly,[0,1]),V=S.useProgram("globeAtmosphere"),O=N.centerOffset,$=N._camera.getCameraToClipPerspective(N._fov,N.width/N.height,N._nearZ,N._farZ);$[8]=2*-O.x/N.width,$[9]=2*O.y/N.height;const W=o.invert([],$),Q=o.mul([],W,N.projMatrix),K={u_frustum_tl:Gr([-1,1,1],W),u_frustum_tr:Gr([1,1,1],W),u_frustum_br:Gr([1,-1,1],W),u_frustum_bl:Gr([-1,-1,1],W),u_globe_pos:Gr([N.globeMatrix[12],N.globeMatrix[13],N.globeMatrix[14]],Q),u_globe_radius:N.worldSize/2/Math.PI-1,u_opacity:1-o.globeToMercatorTransition(N.zoom),u_fadeout_range:2,u_start_color:[1,1,1],u_end_color:[.0118,.7451,.9882]};S.prepareDrawProgram(z,V);const ee=S.globeSharedBuffers;ee&&V.draw(z,B.TRIANGLES,G,o.StencilMode.disabled,o.ColorMode.alphaBlended,o.CullFaceMode.backCW,K,"skybox",ee.atmosphereVertexBuffer,ee.atmosphereIndexBuffer,ee.atmosphereSegments)}(this),this.renderPass="translucent",this.currentLayer=0;this.currentLayer<h.length;){const S=this.style._layers[h[this.currentLayer]],z=t._getLayerSourceCache(S);if(S.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(S)){if(S.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const B=z?(S.type==="symbol"?A:x)[z.id]:void 0;this._renderTileClippingMasks(S,z,z?_[z.id]:void 0),this.renderLayer(this,z,S,B),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry){let S=null;o.values(this.style._layers).forEach(z=>{const B=t._getLayerSourceCache(z);B&&!z.isHidden(this.transform.zoom)&&(!S||S.getSource().maxzoom<B.getSource().maxzoom)&&(S=B)}),S&&this.options.showTileBoundaries&&dc.debug(this,S,S.getVisibleCoordinates())}this.options.showPadding&&function(S){const z=S.transform.padding;et(S,S.transform.height-(z.top||0),3,uc),et(S,z.bottom||0,3,hc),jn(S,z.left||0,3,Ju),jn(S,S.transform.width-(z.right||0),3,qa);const B=S.transform.centerPoint;(function(N,G,V,O){qs(N,G-1,V-10,2,20,O),qs(N,G-10,V-1,20,2,O)})(S,B.x,S.transform.height-B.y,Wa)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(o.window.performance.now()),this.saveCanvasCopy())}renderLayer(t,s,h,m){h.isHidden(this.transform.zoom)||(h.type==="background"||h.type==="sky"||h.type==="custom"||m&&m.length)&&(this.id=h.id,this.gpuTimingStart(h),t.transform.projection.unsupportedLayers&&t.transform.projection.unsupportedLayers.includes(h.type)||dc[h.type](t,s,h,m,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(t){if(!this.options.gpuTiming)return;const s=this.context.extTimerQuery;let h=this.gpuTimers[t.id];h||(h=this.gpuTimers[t.id]={calls:0,cpuTime:0,query:s.createQueryEXT()}),h.calls++,s.beginQueryEXT(s.TIME_ELAPSED_EXT,h.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const t=this.context.extTimerQuery;t.endQueryEXT(t.TIME_ELAPSED_EXT)}collectGpuTimers(){const t=this.gpuTimers;return this.gpuTimers={},t}queryGpuTimers(t){const s={};for(const h in t){const m=t[h],_=this.context.extTimerQuery,x=_.getQueryObjectEXT(m.query,_.QUERY_RESULT_EXT)/1e6;_.deleteQueryEXT(m.query),s[h]=x}return s}translatePosMatrix(t,s,h,m,_){if(!h[0]&&!h[1])return t;const x=_?m==="map"?this.transform.angle:0:m==="viewport"?-this.transform.angle:0;if(x){const S=Math.sin(x),z=Math.cos(x);h=[h[0]*z-h[1]*S,h[0]*S+h[1]*z]}const A=[_?h[0]:Wi(s,h[0],this.transform.zoom),_?h[1]:Wi(s,h[1],this.transform.zoom),0],C=new Float32Array(16);return o.translate(C,t,A),C}saveTileTexture(t){const s=this._tileTextures[t.size[0]];s?s.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const s=this._tileTextures[t];return s&&s.length>0?s.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const s=this.imageManager.getPattern(t.from.toString()),h=this.imageManager.getPattern(t.to.toString());return!s||!h}currentGlobalDefines(){const t=this.terrain&&this.terrain.renderingToTexture,s=this.style&&this.style.fog,h=[];return this.terrain&&!this.terrain.renderingToTexture&&h.push("TERRAIN"),s&&!t&&s.getOpacity(this.transform.pitch)!==0&&h.push("FOG"),t&&h.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&h.push("OVERDRAW_INSPECTOR"),h}useProgram(t,s,h){this.cache=this.cache||{};const m=h||[],_=this.currentGlobalDefines().concat(m),x=Vs.cacheKey(t,_,s);return this.cache[x]||(this.cache[x]=new Vs(this.context,t,Fs[t],s,ui[t],_)),this.cache[x]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=o.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new o.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(t,s,h){if(this.terrain&&this.terrain.renderingToTexture)return;const m=this.style.fog;if(m){const _=m.getOpacity(this.transform.pitch);_!==0&&s.setFogUniformValues(t,((x,A,C,S)=>{const z=A.properties.get("color"),B=x.frameCounter/1e3%1,N=[z.r/z.a,z.g/z.a,z.b/z.a,S];return{u_fog_matrix:C?x.transform.calculateFogTileMatrix(C):x.identityMat,u_fog_range:A.getFovAdjustedRange(x.transform._fov),u_fog_color:N,u_fog_horizon_blend:A.properties.get("horizon-blend"),u_fog_temporal_offset:B}})(this,m,h,_))}}setTileLoadedFlag(t){this.tileLoaded=t}saveCanvasCopy(){this.frameCopies.push(this.canvasCopy()),this.tileLoaded=!1}canvasCopy(){const t=this.context.gl,s=t.createTexture();return t.bindTexture(t.TEXTURE_2D,s),t.copyTexImage2D(t.TEXTURE_2D,0,t.RGBA,0,0,t.drawingBufferWidth,t.drawingBufferHeight,0),s}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const t=this.style&&this.style.fog;return!!t&&t.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const t=this._backgroundTiles,s=this._backgroundTiles={},h=this.transform.coveringTiles({tileSize:512});for(const m of h)s[m.key]=t[m.key]||new o.Tile(m,512,this.transform.tileZoom,this);return s}clearBackgroundTiles(){this._backgroundTiles={}}}class Zr{constructor(t=0,s=0,h=0,m=0){if(isNaN(t)||t<0||isNaN(s)||s<0||isNaN(h)||h<0||isNaN(m)||m<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=s,this.left=h,this.right=m}interpolate(t,s,h){return s.top!=null&&t.top!=null&&(this.top=o.number(t.top,s.top,h)),s.bottom!=null&&t.bottom!=null&&(this.bottom=o.number(t.bottom,s.bottom,h)),s.left!=null&&t.left!=null&&(this.left=o.number(t.left,s.left,h)),s.right!=null&&t.right!=null&&(this.right=o.number(t.right,s.right,h)),this}getCenter(t,s){const h=o.clamp((this.left+t-this.right)/2,0,t),m=o.clamp((this.top+s-this.bottom)/2,0,s);return new o.pointGeometry(h,m)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new Zr(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function nh(l,t){const s=o.getColumn(l,3);o.fromQuat(l,t),o.setColumn(l,3,s)}function pc(l,t){const s=o.identity$1([]);return o.rotateZ$1(s,s,-t),o.rotateX$1(s,s,-l),s}function Ha(l,t){const s=[l[0],l[1],0],h=[t[0],t[1],0];if(o.length(s)>=1e-15){const x=o.normalize([],s);o.scale$2(h,x,o.dot(h,x)),t[0]=h[0],t[1]=h[1]}const m=o.cross([],t,l);if(o.len(m)<1e-15)return null;const _=Math.atan2(-m[1],m[0]);return pc(Math.atan2(Math.sqrt(l[0]*l[0]+l[1]*l[1]),-l[2]),_)}class Hs{constructor(t,s){this.position=t,this.orientation=s}get position(){return this._position}set position(t){if(t){const s=t instanceof o.MercatorCoordinate?t:new o.MercatorCoordinate(t[0],t[1],t[2]);this._renderWorldCopies&&(s.x=o.wrap(s.x,0,1)),this._position=s}else this._position=null}lookAtPoint(t,s){if(this.orientation=null,!this.position)return;const h=this._elevation?this._elevation.getAtPointOrZero(o.MercatorCoordinate.fromLngLat(t)):0,m=this.position,_=o.MercatorCoordinate.fromLngLat(t,h),x=[_.x-m.x,_.y-m.y,_.z-m.z];s||(s=[0,0,1]),s[2]=Math.abs(s[2]),this.orientation=Ha(x,s)}setPitchBearing(t,s){this.orientation=pc(o.degToRad(t),o.degToRad(-s))}}class Ys{constructor(t,s){this._transform=o.identity([]),this.orientation=s,this.position=t}get mercatorPosition(){const t=this.position;return new o.MercatorCoordinate(t[0],t[1],t[2])}get position(){const t=o.getColumn(this._transform,3);return[t[0],t[1],t[2]]}set position(t){var s;t&&o.setColumn(this._transform,3,[(s=t)[0],s[1],s[2],1])}get orientation(){return this._orientation}set orientation(t){this._orientation=t||o.identity$1([]),t&&nh(this._transform,this._orientation)}getPitchBearing(){const t=this.forward(),s=this.right();return{bearing:Math.atan2(-s[1],s[0]),pitch:Math.atan2(Math.sqrt(t[0]*t[0]+t[1]*t[1]),-t[2])}}setPitchBearing(t,s){this._orientation=pc(t,s),nh(this._transform,this._orientation)}forward(){const t=o.getColumn(this._transform,2);return[-t[0],-t[1],-t[2]]}up(){const t=o.getColumn(this._transform,1);return[-t[0],-t[1],-t[2]]}right(){const t=o.getColumn(this._transform,0);return[t[0],t[1],t[2]]}getCameraToWorld(t,s){const h=new Float64Array(16);return o.invert(h,this.getWorldToCamera(t,s)),h}getWorldToCameraPosition(t,s,h){const m=this.position;o.scale$2(m,m,-t);const _=new Float64Array(16);return o.fromScaling(_,[h,h,h]),o.translate(_,_,m),_[10]*=s,_}getWorldToCamera(t,s){const h=new Float64Array(16),m=new Float64Array(4),_=this.position;return o.conjugate(m,this._orientation),o.scale$2(_,_,-t),o.fromQuat(h,m),o.translate(h,h,_),h[1]*=-1,h[5]*=-1,h[9]*=-1,h[13]*=-1,h[8]*=s,h[9]*=s,h[10]*=s,h[11]*=s,h}getCameraToClipPerspective(t,s,h,m){const _=new Float64Array(16);return o.perspective(_,t,s,h,m),_}getDistanceToElevation(t){const s=t===0?0:o.mercatorZfromAltitude(t,this.position[1]),h=this.forward();return(s-this.position[2])/h[2]}clone(){return new Ys([...this.position],[...this.orientation])}}function fc(l,t){const s=Xs(l),h=function(_,x,A,C,S){const z=new o.LngLat(A.lng-180*qr,A.lat),B=new o.LngLat(A.lng+180*qr,A.lat),N=_.project(z.lng,z.lat),G=_.project(B.lng,B.lat),V=-Math.atan2(G.y-N.y,G.x-N.x),O=o.MercatorCoordinate.fromLngLat(A);O.y=o.clamp(O.y,-.999975,.999975);const $=O.toLngLat(),W=_.project($.lng,$.lat),Q=o.MercatorCoordinate.fromLngLat($);Q.x+=qr;const K=Q.toLngLat(),ee=_.project(K.lng,K.lat),X=gc(ee.x-W.x,ee.y-W.y,V),re=o.MercatorCoordinate.fromLngLat($);re.y+=qr;const ge=re.toLngLat(),Ae=_.project(ge.lng,ge.lat),Se=gc(Ae.x-W.x,Ae.y-W.y,V),Ce=Math.abs(X.x)/Math.abs(Se.y),Ze=o.identity([]);o.rotateZ(Ze,Ze,-V*(1-(S?0:C)));const ye=o.identity([]);return o.scale(ye,ye,[1,1-(1-Ce)*C,1]),ye[4]=-Se.x/Se.y*C,o.rotateZ(ye,ye,V),o.multiply$1(ye,Ze,ye),ye}(l.projection,0,l.center,s,t),m=mc(l);return o.scale(h,h,[m,m,1]),h}function mc(l){const t=l.projection,s=Xs(l),h=_c(t,l.center),m=_c(t,o.LngLat.convert(t.center));return Math.pow(2,h*s+(1-s)*m)}function Xs(l){const t=l.projection.range;if(!t)return 0;const s=Math.max(l.width,l.height),h=Math.log(s/1024)/Math.LN2;return o.smoothstep(t[0]+h,t[1]+h,l.zoom)}const qr=1/4e4;function _c(l,t){const s=o.clamp(t.lat,-o.MAX_MERCATOR_LATITUDE,o.MAX_MERCATOR_LATITUDE),h=new o.LngLat(t.lng-180*qr,s),m=new o.LngLat(t.lng+180*qr,s),_=l.project(h.lng,s),x=l.project(m.lng,s),A=o.MercatorCoordinate.fromLngLat(h),C=o.MercatorCoordinate.fromLngLat(m),S=x.x-_.x,z=x.y-_.y,B=C.x-A.x,N=C.y-A.y,G=Math.sqrt((B*B+N*N)/(S*S+z*z));return Math.log(G)/Math.LN2}function gc(l,t,s){const h=Math.cos(s),m=Math.sin(s);return{x:l*h-t*m,y:l*m+t*h}}class Ya{constructor(t,s,h,m,_,x,A){this.tileSize=512,this._renderWorldCopies=_===void 0||_,this._minZoom=t||0,this._maxZoom=s||22,this._minPitch=h==null?0:h,this._maxPitch=m==null?60:m,this.setProjection(x),this.setMaxBounds(A),this.width=0,this.height=0,this._center=new o.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Zr,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Ys,this._centerAltitude=0,this._centerAltitudeValidForExaggeration=0,this._averageElevation=0,this.cameraElevationReference="ground",this._projectionScaler=1,this._horizonShift=.1}clone(){const t=new Ya(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return t._elevation=this._elevation,t._centerAltitude=this._centerAltitude,t._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,t.tileSize=this.tileSize,t.width=this.width,t.height=this.height,t.cameraElevationReference=this.cameraElevationReference,t._center=this._center,t._setZoom(this.zoom),t._seaLevelZoom=this._seaLevelZoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._nearZ=this._nearZ,t._farZ=this._farZ,t._averageElevation=this._averageElevation,t._unmodified=this._unmodified,t._edgeInsets=this._edgeInsets.clone(),t._camera=this._camera.clone(),t._calcMatrices(),t.freezeTileCoverage=this.freezeTileCoverage,t}get elevation(){return this._elevation}set elevation(t){this._elevation!==t&&(this._elevation=t,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(t){const s=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||s)&&this._updateCameraOnTerrain(),(t||s)&&this._constrainCameraAltitude(),this._calcMatrices()}getProjection(){return o.pick(this.projection,["name","center","parallels"])}setProjection(t){t==null&&(t={name:"mercator"}),this.projectionOptions=t;const s=this.projection?this.getProjection():void 0;this.projection=o.getProjection(t);const h=this.getProjection();return Z(s,h)?null:(this._calcMatrices(),h)}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this.tileSize*this.scale}get cameraWorldSize(){const t=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(t))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.cameraWorldSize)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.pointGeometry(this.width,this.height)}get bearing(){return o.wrap(this.rotation,-180,180)}set bearing(t){this.rotation=t}get rotation(){return-this.angle/Math.PI*180}set rotation(t){const s=-t*Math.PI/180;var h;this.angle!==s&&(this._unmodified=!1,this.angle=s,this._calcMatrices(),this.rotationMatrix=(h=new o.ARRAY_TYPE(4),o.ARRAY_TYPE!=Float32Array&&(h[1]=0,h[2]=0),h[0]=1,h[3]=1,h),function(m,_,x){var A=_[0],C=_[1],S=_[2],z=_[3],B=Math.sin(x),N=Math.cos(x);m[0]=A*N+S*B,m[1]=C*N+z*B,m[2]=A*-B+S*N,m[3]=C*-B+z*N}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(t){const s=o.clamp(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==s&&(this._unmodified=!1,this._pitch=s,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(t){this._averageElevation=t,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(t){const s=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==s&&(this._unmodified=!1,this._setZoom(s),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(t){this._zoom=t,this.scale=this.zoomScale(t),this.tileZoom=Math.floor(t),this.zoomFraction=t-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=0);const t=this._elevation;this._centerAltitude=t.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=t.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const t=this._elevation,s=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],h=this.horizonLineFromTop();let m=0,_=0;for(let x=0;x<s.length;x++){const A=new o.pointGeometry(s[x][0]*this.width,h+s[x][1]*(this.height-h)),C=t.pointCoordinate(A);if(!C)continue;const S=1/Math.hypot(C[0]-this._camera.position[0],C[1]-this._camera.position[1]);m+=C[3]*S,_+=S}return _===0?NaN:m/_}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const t=this._seaLevelZoom,s=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),h=this.pixelsPerMeter/this.worldSize*s,m=this._mercatorZfromZoom(t),_=this._mercatorZfromZoom(this._maxZoom),x=Math.max(m-h,_);this._setZoom(this._zoomFromMercatorZ(x))}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}computeZoomRelativeTo(t){const s=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,t.toAltitude()));let h;h=t.z<this._camera.position[2]?[s.x,s.y,s.z]:[t.x,t.y,t.z];const m=o.length(o.sub([],this._camera.position,h));return o.clamp(this._zoomFromMercatorZ(m),this._minZoom,this._maxZoom)}setFreeCameraOptions(t){if(!this.height||!t.position&&!t.orientation)return;this._updateCameraState();let s=!1;if(t.orientation&&!o.exactEquals(t.orientation,this._camera.orientation)&&(s=this._setCameraOrientation(t.orientation)),t.position){const h=[t.position.x,t.position.y,t.position.z];o.exactEquals$1(h,this._camera.position)||(this._setCameraPosition(h),s=!0)}s&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const t=this._camera.position,s=new Hs;return s.position=new o.MercatorCoordinate(t[0],t[1],t[2]),s.orientation=this._camera.orientation,s._elevation=this.elevation,s._renderWorldCopies=this.renderWorldCopies,s}_setCameraOrientation(t){if(!o.length$1(t))return!1;o.normalize$1(t,t);const s=o.transformQuat([],[0,0,-1],t),h=o.transformQuat([],[0,-1,0],t);if(h[2]<0)return!1;const m=Ha(s,h);return!!m&&(this._camera.orientation=m,!0)}_setCameraPosition(t){const s=this.zoomScale(this.minZoom)*this.tileSize,h=this.zoomScale(this.maxZoom)*this.tileSize,m=this.cameraToCenterDistance;t[2]=o.clamp(t[2],m/h,m/s),this._camera.position=t}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,s,h){this._unmodified=!1,this._edgeInsets.interpolate(t,s,h),this._constrain(),this._calcMatrices()}coveringZoomLevel(t){const s=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,s)}getVisibleUnwrappedCoordinates(t){const s=[new o.UnwrappedTileID(0,t)];if(this.renderWorldCopies){const h=this.pointCoordinate(new o.pointGeometry(0,0)),m=this.pointCoordinate(new o.pointGeometry(this.width,0)),_=this.pointCoordinate(new o.pointGeometry(this.width,this.height)),x=this.pointCoordinate(new o.pointGeometry(0,this.height)),A=Math.floor(Math.min(h.x,m.x,_.x,x.x)),C=Math.floor(Math.max(h.x,m.x,_.x,x.x)),S=1;for(let z=A-S;z<=C+S;z++)z!==0&&s.push(new o.UnwrappedTileID(z,t))}return s}coveringTiles(t){let s=this.coveringZoomLevel(t);const h=s,m=this.elevation&&!t.isTerrainDEM,_=this.projection.name==="mercator";if(t.minzoom!==void 0&&s<t.minzoom)return[];t.maxzoom!==void 0&&s>t.maxzoom&&(s=t.maxzoom);const x=this.locationCoordinate(this.center),A=this.center.lat,C=1<<s,S=[C*x.x,C*x.y,0],z=this.projection.name==="globe",B=!z,N=o.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,s,B),G=z?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),V=C*o.mercatorZfromAltitude(1,this.center.lat),O=this._camera.position[2]/o.mercatorZfromAltitude(1,this.center.lat),$=[C*G.x,C*G.y,O*(B?1:V)],W=this.cameraToCenterDistance/t.tileSize*(t.roundZoom?1:.502),Q=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?s:0,K=t.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,ee=t.isTerrainDEM?-K:this._elevation?this._elevation.getMinElevationBelowMSL():0,X=this.projection.isReprojectedInTileSpace?mc(this):1,re=we=>{const yt=new o.MercatorCoordinate(we.x+25e-6,we.y,we.z),ot=new o.MercatorCoordinate(we.x,we.y+25e-6,we.z),st=we.toLngLat(),Et=yt.toLngLat(),Ft=ot.toLngLat(),ht=this.locationCoordinate(st),kt=this.locationCoordinate(Et),$t=this.locationCoordinate(Ft),ki=Math.hypot(kt.x-ht.x,kt.y-ht.y),an=Math.hypot($t.x-ht.x,$t.y-ht.y);return Math.sqrt(ki*an)*X/25e-6},ge=we=>{const pt=K,yt=ee;return{aabb:o.tileAABB(this,C,0,0,0,we,yt,pt,this.projection),zoom:0,x:0,y:0,minZ:yt,maxZ:pt,wrap:we,fullyVisible:!1}},Ae=[];let Se=[];const Ce=s,Ze=t.reparseOverscaled?h:s,ye=we=>we*we,je=ye((O-this._centerAltitude)*V),Ue=we=>{if(!this._elevation||!we.tileID||!_)return;const pt=this._elevation.getMinMaxForTile(we.tileID),yt=we.aabb;pt?(yt.min[2]=pt.min,yt.max[2]=pt.max,yt.center[2]=(yt.min[2]+yt.max[2])/2):(we.shouldSplit=lt(we),we.shouldSplit||(yt.min[2]=yt.max[2]=yt.center[2]=this._centerAltitude))},lt=we=>{if(we.zoom<Q)return!0;if(we.zoom===Ce)return!1;if(we.shouldSplit!=null)return we.shouldSplit;const pt=we.aabb.distanceX($),yt=we.aabb.distanceY($);let ot=je,st=1;if(z){ot=ye(we.aabb.distanceZ($));const Ft=Math.pow(2,we.zoom),ht=o.latFromMercatorY((we.y+1)/Ft),kt=o.latFromMercatorY(we.y/Ft),$t=Math.min(Math.max(A,ht),kt),ki=o.circumferenceAtLatitude($t)/o.circumferenceAtLatitude(A);st=Math.min(ki,1)}else if(m&&(ot=ye(we.aabb.distanceZ($)*V)),this.projection.isReprojectedInTileSpace&&h<=5){const Ft=Math.pow(2,we.zoom),ht=re(new o.MercatorCoordinate((we.x+.5)/Ft,(we.y+.5)/Ft));st=ht>.85?1:ht}const Et=pt*pt+yt*yt+ot;return Et<ye((1<<Ce-we.zoom)*W*st*((Ft,ht)=>{if(ht*ye(.707)<Ft)return 1;const kt=Math.sqrt(ht/Ft);return kt/(1.4144271570014144+(Math.pow(1.1,kt-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(ot,je),Et))};if(this.renderWorldCopies)for(let we=1;we<=3;we++)Ae.push(ge(-we)),Ae.push(ge(we));for(Ae.push(ge(0));Ae.length>0;){const we=Ae.pop(),pt=we.x,yt=we.y;let ot=we.fullyVisible;if(!ot){const st=we.aabb.intersects(N);if(st===0)continue;ot=st===2}if(we.zoom!==Ce&&lt(we))for(let st=0;st<4;st++){const Et=(pt<<1)+st%2,Ft=(yt<<1)+(st>>1),ht={aabb:_?we.aabb.quadrant(st):o.tileAABB(this,C,we.zoom+1,Et,Ft,we.wrap,we.minZ,we.maxZ,this.projection),zoom:we.zoom+1,x:Et,y:Ft,wrap:we.wrap,fullyVisible:ot,tileID:void 0,shouldSplit:void 0,minZ:we.minZ,maxZ:we.maxZ};m&&!z&&(ht.tileID=new o.OverscaledTileID(we.zoom+1===Ce?Ze:we.zoom+1,we.wrap,we.zoom+1,Et,Ft),Ue(ht)),Ae.push(ht)}else{const st=we.zoom===Ce?Ze:we.zoom;if(t.minzoom&&t.minzoom>st)continue;const Et=S[0]-(.5+pt+(we.wrap<<we.zoom))*(1<<s-we.zoom),Ft=S[1]-.5-yt,ht=we.tileID?we.tileID:new o.OverscaledTileID(st,we.wrap,we.zoom,pt,yt);Se.push({tileID:ht,distanceSq:Et*Et+Ft*Ft})}}if(this.fogCullDistSq){const we=this.fogCullDistSq,pt=this.horizonLineFromTop();Se=Se.filter(yt=>{const ot=[0,0,0,1],st=[o.EXTENT,o.EXTENT,0,1],Et=this.calculateFogTileMatrix(yt.tileID.toUnwrapped());o.transformMat4$1(ot,ot,Et),o.transformMat4$1(st,st,Et);const Ft=o.getAABBPointSquareDist(ot,st);if(Ft===0)return!0;let ht=!1;const kt=this._elevation;if(kt&&Ft>we&&pt!==0){const $t=this.calculateProjMatrix(yt.tileID.toUnwrapped());let ki;t.isTerrainDEM||(ki=kt.getMinMaxForTile(yt.tileID)),ki||(ki={min:ee,max:K});const an=o.furthestTileCorner(this.rotation),ln=[an[0]*o.EXTENT,an[1]*o.EXTENT,ki.max];o.transformMat4(ln,ln,$t),ht=(1-ln[1])*this.height*.5<pt}return Ft<we||ht})}return Se.sort((we,pt)=>we.distanceSq-pt.distanceSq).map(we=>we.tileID)}resize(t,s){this.width=t,this.height=s,this.pixelsToGLUnits=[2/t,-2/s],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(t){const s=o.clamp(t.lat,-o.MAX_MERCATOR_LATITUDE,o.MAX_MERCATOR_LATITUDE),h=this.projection.project(t.lng,s);return new o.pointGeometry(h.x*this.worldSize,h.y*this.worldSize)}unproject(t){return this.projection.unproject(t.x/this.worldSize,t.y/this.worldSize)}get point(){return this.project(this.center)}setLocationAtPoint(t,s){let h,m;const _=this.centerPoint;if(this.projection.name==="globe"){const A=this.worldSize;h=(s.x-_.x)/A,m=(s.y-_.y)/A}else{const A=this.pointCoordinate(s),C=this.pointCoordinate(_);h=A.x-C.x,m=A.y-C.y}const x=this.locationCoordinate(t);this.setLocation(new o.MercatorCoordinate(x.x-h,x.y-m))}setLocation(t){this.center=this.coordinateLocation(t),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(t){return this.projection.locationPoint(this,t)}locationPoint3D(t){return this._coordinatePoint(this.locationCoordinate(t),!0)}pointLocation(t){return this.coordinateLocation(this.pointCoordinate(t))}pointLocation3D(t){return this.coordinateLocation(this.pointCoordinate3D(t))}locationCoordinate(t,s){const h=s?o.mercatorZfromAltitude(s,t.lat):void 0,m=this.projection.project(t.lng,t.lat);return new o.MercatorCoordinate(m.x,m.y,h)}coordinateLocation(t){return this.projection.unproject(t.x,t.y)}pointRayIntersection(t,s){const h=s!=null?s:this._centerAltitude,m=[t.x,t.y,0,1],_=[t.x,t.y,1,1];o.transformMat4$1(m,m,this.pixelMatrixInverse),o.transformMat4$1(_,_,this.pixelMatrixInverse);const x=_[3];o.scale$1(m,m,1/m[3]),o.scale$1(_,_,1/x);const A=m[2],C=_[2];return{p0:m,p1:_,t:A===C?0:(h-A)/(C-A)}}screenPointToMercatorRay(t){const s=[t.x,t.y,0,1],h=[t.x,t.y,1,1];return o.transformMat4$1(s,s,this.pixelMatrixInverse),o.transformMat4$1(h,h,this.pixelMatrixInverse),o.scale$1(s,s,1/s[3]),o.scale$1(h,h,1/h[3]),s[2]=o.mercatorZfromAltitude(s[2],this._center.lat)*this.worldSize,h[2]=o.mercatorZfromAltitude(h[2],this._center.lat)*this.worldSize,o.scale$1(s,s,1/this.worldSize),o.scale$1(h,h,1/this.worldSize),new o.Ray([s[0],s[1],s[2]],o.normalize([],o.sub([],h,s)))}rayIntersectionCoordinate(t){const{p0:s,p1:h,t:m}=t,_=o.mercatorZfromAltitude(s[2],this._center.lat),x=o.mercatorZfromAltitude(h[2],this._center.lat);return new o.MercatorCoordinate(o.number(s[0],h[0],m)/this.worldSize,o.number(s[1],h[1],m)/this.worldSize,o.number(_,x,m))}pointCoordinate(t,s=this._centerAltitude){return this.projection.pointCoordinate(this,t.x,t.y,s)}pointCoordinate3D(t){if(!this.elevation)return this.pointCoordinate(t);const s=this.elevation;let h=this.elevation.pointCoordinate(t);if(h)return new o.MercatorCoordinate(h[0],h[1],h[2]);let m=0,_=this.horizonLineFromTop();if(t.y>_)return this.pointCoordinate(t);const x=.02*_,A=t.clone();for(let C=0;C<10&&_-m>x;C++){A.y=o.number(m,_,.66);const S=s.pointCoordinate(A);S?(_=A.y,h=S):m=A.y}return h?new o.MercatorCoordinate(h[0],h[1],h[2]):this.pointCoordinate(t)}isPointAboveHorizon(t){if(this.elevation)return!this.elevation.pointCoordinate(t);{const s=this.horizonLineFromTop();return t.y<s}}_coordinatePoint(t,s){const h=s&&this.elevation?this.elevation.getAtPointOrZero(t,this._centerAltitude):this._centerAltitude,m=[t.x*this.worldSize,t.y*this.worldSize,h+t.toAltitude(),1];return o.transformMat4$1(m,m,this.pixelMatrix),m[3]>0?new o.pointGeometry(m[0]/m[3],m[1]/m[3]):new o.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getBounds(t,s){const h=new o.pointGeometry(this._edgeInsets.left,this._edgeInsets.top),m=new o.pointGeometry(this.width-this._edgeInsets.right,this._edgeInsets.top),_=new o.pointGeometry(this.width-this._edgeInsets.right,this.height-this._edgeInsets.bottom),x=new o.pointGeometry(this._edgeInsets.left,this.height-this._edgeInsets.bottom);let A=this.pointCoordinate(h,t),C=this.pointCoordinate(m,t);const S=this.pointCoordinate(_,s),z=this.pointCoordinate(x,s),B=(N,G)=>(G.y-N.y)/(G.x-N.x);return A.y>1&&C.y>=0?A=new o.MercatorCoordinate((1-z.y)/B(z,A)+z.x,1):A.y<0&&C.y<=1&&(A=new o.MercatorCoordinate(-z.y/B(z,A)+z.x,0)),C.y>1&&A.y>=0?C=new o.MercatorCoordinate((1-S.y)/B(S,C)+S.x,1):C.y<0&&A.y<=1&&(C=new o.MercatorCoordinate(-S.y/B(S,C)+S.x,0)),new o.LngLatBounds().extend(this.coordinateLocation(A)).extend(this.coordinateLocation(C)).extend(this.coordinateLocation(z)).extend(this.coordinateLocation(S))}_getBounds3D(){const t=this.elevation;if(!t.visibleDemTiles.length)return this._getBounds(0,0);const s=t.visibleDemTiles.reduce((h,m)=>{if(m.dem){const _=m.dem.tree;h.min=Math.min(h.min,_.minimums[0]),h.max=Math.max(h.max,_.maximums[0])}return h},{min:Number.MAX_VALUE,max:0});return this._getBounds(s.min*t.exaggeration(),s.max*t.exaggeration())}getBounds(){return this._terrainEnabled()?this._getBounds3D():this._getBounds(0,0)}horizonLineFromTop(t=!0){const s=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,h=this.height/2-s*(1-this._horizonShift);return t?Math.max(0,h):h}getMaxBounds(){return this.maxBounds}setMaxBounds(t){this.maxBounds=t,this.minLat=-o.MAX_MERCATOR_LATITUDE,this.maxLat=o.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,t&&(this.minLat=t.getSouth(),this.maxLat=t.getNorth(),this.minLng=t.getWest(),this.maxLng=t.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=o.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=o.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=o.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=o.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(t,s){return this.projection.createTileMatrix(this,s,t)}calculateDistanceTileData(t){const s=t.key,h=this._distanceTileDataCache;if(h[s])return h[s];const m=t.canonical,_=1/this.height,x=this.cameraWorldSize/this.zoomScale(m.z),A=(m.x+Math.pow(2,m.z)*t.wrap)*x,C=m.y*x,S=this.point,z=this.angle,B=Math.sin(-z),N=-Math.cos(-z);return h[s]={bearing:[B,N],center:[(S.x-A)*_,(S.y-C)*_],scale:x/o.EXTENT*_},h[s]}calculateFogTileMatrix(t){const s=t.key,h=this._fogTileMatrixCache;if(h[s])return h[s];const m=this.calculatePosMatrix(t,this.cameraWorldSize);return o.multiply$1(m,this.worldToFogMatrix,m),h[s]=new Float32Array(m),h[s]}calculateProjMatrix(t,s=!1){const h=t.key,m=s?this._alignedProjMatrixCache:this._projMatrixCache;if(m[h])return m[h];const _=this.calculatePosMatrix(t,this.worldSize);return o.multiply$1(_,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:s?this.alignedProjMatrix:this.projMatrix,_),m[h]=new Float32Array(_),m[h]}calculatePixelsToTileUnitsMatrix(t){const s=t.tileID.key,h=this._pixelsToTileUnitsCache;if(h[s])return h[s];const m=function(_,x){const{scale:A}=_.tileTransform,C=A*o.EXTENT/(_.tileSize*Math.pow(2,x.zoom-_.tileID.overscaledZ+_.tileID.canonical.z));return S=new Float32Array(4),N=(z=x.inverseAdjustmentMatrix)[1],G=z[2],V=z[3],$=(B=[C,C])[1],S[0]=z[0]*(O=B[0]),S[1]=N*O,S[2]=G*$,S[3]=V*$,S;var S,z,B,N,G,V,O,$}(t,this);return h[s]=m,h[s]}customLayerMatrix(){return this.mercatorMatrix.slice()}recenterOnTerrain(){if(!this._elevation)return;const t=this._elevation;this._updateCameraState();const s=o.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,h=this._computeCameraPosition(s),m=this._camera.forward(),_=o.mercatorZfromAltitude(1,this._center.lat);h[2]/=_,m[2]/=_,o.normalize(m,m);const x=t.raycast(h,m,t.exaggeration());if(x){const A=o.scaleAndAdd([],h,m,x),C=new o.MercatorCoordinate(A[0],A[1],o.mercatorZfromAltitude(A[2],o.latFromMercatorY(A[1]))),S=(C.z+o.length([C.x-h[0],C.y-h[1],C.z-h[2]*_]))*this._projectionScaler;this._seaLevelZoom=this._zoomFromMercatorZ(S),this._centerAltitude=C.toAltitude(),this._center=this.coordinateLocation(C),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCameraAltitude(){if(!this._elevation)return;const t=this._elevation;this._updateCameraState();const s=o.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,h=this._computeCameraPosition(s),m=t.getAtPointOrZero(new o.MercatorCoordinate(...h)),_=this._minimumHeightOverTerrain()*Math.cos(o.degToRad(this._maxPitch)),x=this._camera.position[2]-this.pixelsPerMeter/this.worldSize*m;if(x<_){const A=this.locationCoordinate(this._center,this._centerAltitude),C=[A.x-h[0],A.y-h[1],A.z-h[2]],S=o.length(C);C[2]-=(_-x)/this._projectionScaler;const z=o.length(C);if(z===0)return;o.scale$2(C,C,S/z*this._projectionScaler),this._camera.position=[A.x-C[0],A.y-C[1],A.z*this._projectionScaler-C[2]],this._camera.orientation=Ha(C,this._camera.up()),this._updateStateFromCamera()}}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;if(this._constraining=!0,this.projection.isReprojectedInTileSpace){const B=this.center;return B.lat=o.clamp(B.lat,this.minLat,this.maxLat),!this.maxBounds&&this.renderWorldCopies||(B.lng=o.clamp(B.lng,this.minLng,this.maxLng)),this.center=B,void(this._constraining=!1)}const t=this._unmodified,{x:s,y:h}=this.point;let m=0,_=s,x=h;const A=this.width/2,C=this.height/2,S=this.worldMinY*this.scale,z=this.worldMaxY*this.scale;if(h-C<S&&(x=S+C),h+C>z&&(x=z-C),z-S<this.height&&(m=Math.max(m,this.height/(z-S)),x=(z+S)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const B=this.worldMinX*this.scale,N=this.worldMaxX*this.scale,G=this.worldSize/2-(B+N)/2;_=(s+G+this.worldSize)%this.worldSize-G,_-A<B&&(_=B+A),_+A>N&&(_=N-A),N-B<this.width&&(m=Math.max(m,this.width/(N-B)),_=(N+B)/2)}_===s&&x===h||(this.center=this.unproject(new o.pointGeometry(_,x))),m&&(this.zoom+=this.scaleZoom(m)),this._constrainCameraAltitude(),this._unmodified=t,this._constraining=!1}_minZoomForBounds(){let t=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(t=Math.max(t,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),t}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const t=this._fov/2,s=this.centerOffset,h=this.pixelsPerMeter;this._projectionScaler=h/(o.mercatorZfromAltitude(1,this.center.lat)*this.worldSize),this.cameraToCenterDistance=.5/Math.tan(t)*this.height*this._projectionScaler,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const m=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?h:1),_=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);_[8]=2*-s.x/this.width,_[9]=2*s.y/this.height;let x=o.mul([],_,m);if(this.projection.isReprojectedInTileSpace){const ee=this.locationCoordinate(this.center),X=o.identity([]);o.translate(X,X,[ee.x*this.worldSize,ee.y*this.worldSize,0]),o.multiply$1(X,X,fc(this)),o.translate(X,X,[-ee.x*this.worldSize,-ee.y*this.worldSize,0]),o.multiply$1(x,x,X),this.inverseAdjustmentMatrix=function(re){const ge=fc(re,!0);return zi([],[ge[0],ge[1],ge[4],ge[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=o.scale([],x,[this.worldSize,this.worldSize,this.worldSize/h,1]),this.projMatrix=x,this.invProjMatrix=o.invert(new Float64Array(16),this.projMatrix);const A=new Float32Array(16);o.identity(A),o.scale(A,A,[1,-1,1]),o.rotateX(A,A,this._pitch),o.rotateZ(A,A,this.angle);const C=o.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),S=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;C[8]=2*-s.x/this.width,C[9]=2*(s.y+S)/this.height,this.skyboxMatrix=o.multiply$1(A,C,A);const z=this.point,B=z.x,N=z.y,G=this.width%2/2,V=this.height%2/2,O=Math.cos(this.angle),$=Math.sin(this.angle),W=B-Math.round(B)+O*G+$*V,Q=N-Math.round(N)+O*V+$*G,K=new Float64Array(x);if(o.translate(K,K,[W>.5?W-1:W,Q>.5?Q-1:Q,0]),this.alignedProjMatrix=K,x=o.create(),o.scale(x,x,[this.width/2,-this.height/2,1]),o.translate(x,x,[1,-1,0]),this.labelPlaneMatrix=x,x=o.create(),o.scale(x,x,[1,-1,1]),o.translate(x,x,[-1,-1,0]),o.scale(x,x,[2/this.width,2/this.height,1]),this.glCoordMatrix=x,this.pixelMatrix=o.multiply$1(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},x=o.invert(new Float64Array(16),this.pixelMatrix),!x)throw new Error("failed to invert matrix");this.pixelMatrixInverse=x,this.globeMatrix=this.projection.name==="globe"?o.calculateGlobeMatrix(this):x,this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const t=this.cameraWorldSize,s=this.cameraPixelsPerMeter,h=this._camera.position,m=1/this.height,_=[t,t,s];o.scale$2(_,_,m),o.scale$2(h,h,-1),o.multiply$2(h,h,_);const x=o.create();o.translate(x,x,h),o.scale(x,x,_),this.mercatorFogMatrix=x,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(t,s,m)}_computeCameraPosition(t){const s=(t=t||this.pixelsPerMeter)/this.pixelsPerMeter,h=this._camera.forward(),m=this.point,_=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*s-t/this.worldSize*this._centerAltitude;return[m.x/this.worldSize-h[0]*_,m.y/this.worldSize-h[1]*_,t/this.worldSize*this._centerAltitude-h[2]*_]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(t){const s=this._maxCameraBoundsDistance()*Math.cos(this._pitch),h=t[2];let m=1;h>0&&(m=Math.min((s-this._camera.position[2])/h,1)),this._camera.position=o.scaleAndAdd([],this._camera.position,t,m),this._updateStateFromCamera(),this.projection.wrap&&(this.center=this.center.wrap())}_updateStateFromCamera(){const t=this._camera.position,s=this._camera.forward(),{pitch:h,bearing:m}=this._camera.getPitchBearing(),_=o.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._projectionScaler,x=this._mercatorZfromZoom(this._maxZoom)*Math.cos(o.degToRad(this._maxPitch)),A=Math.max((t[2]-_)/Math.cos(h),x),C=this._zoomFromMercatorZ(A);o.scaleAndAdd(t,t,s,A),this._pitch=o.clamp(h,o.degToRad(this.minPitch),o.degToRad(this.maxPitch)),this.angle=o.wrap(m,-Math.PI,Math.PI),this._setZoom(o.clamp(C,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new o.MercatorCoordinate(t[0],t[1],t[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(t){return Math.pow(2,t)*this.tileSize}_mercatorZfromZoom(t){return this.cameraToCenterDistance/this._worldSizeFromZoom(t)}_minimumHeightOverTerrain(){const t=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+2,this._maxZoom);return this._mercatorZfromZoom(t)}_zoomFromMercatorZ(t){return this.scaleZoom(this.cameraToCenterDistance/(t*this.tileSize))}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(o.warnOnce("Terrain is not yet supported with alternate projections. Use mercator to enable terrain."),1))}anyCornerOffEdge(t,s){const h=Math.min(t.x,s.x),m=Math.max(t.x,s.x),_=Math.min(t.y,s.y),x=Math.max(t.y,s.y);if(_<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const A=[new o.pointGeometry(h,_),new o.pointGeometry(m,x),new o.pointGeometry(h,x),new o.pointGeometry(m,_)],C=this.renderWorldCopies?-3:0,S=this.renderWorldCopies?4:1;for(const z of A){const B=this.pointRayIntersection(z);if(B.t<0)return!0;const N=this.rayIntersectionCoordinate(B);if(N.x<C||N.y<0||N.x>S||N.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+o.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new o.pointGeometry(0,0),new o.pointGeometry(this.width,this.height))}zoomDeltaToMovement(t,s){const h=o.length(o.sub([],this._camera.position,t)),m=this._zoomFromMercatorZ(h)+s;return h-this._mercatorZfromZoom(m)}getCameraPoint(){const t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.pointGeometry(0,t))}}function yc(l,t){let s=!1,h=null;const m=()=>{h=null,s&&(l(),h=setTimeout(m,t),s=!1)};return()=>(s=!0,h||m(),h)}class rh{constructor(t){this._hashName=t&&encodeURIComponent(t),o.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=yc(this._updateHashUnthrottled.bind(this),300)}addTo(t){return this._map=t,o.window.addEventListener("hashchange",this._onHashChange,!1),t.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),o.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(t){const s=this._map;if(!s)return"";const h=s.getCenter(),m=Math.round(100*s.getZoom())/100,_=Math.ceil((m*Math.LN2+Math.log(512/360/.5))/Math.LN10),x=Math.pow(10,_),A=Math.round(h.lng*x)/x,C=Math.round(h.lat*x)/x,S=s.getBearing(),z=s.getPitch();let B="";if(B+=t?`/${A}/${C}/${m}`:`${m}/${C}/${A}`,(S||z)&&(B+="/"+Math.round(10*S)/10),z&&(B+=`/${Math.round(z)}`),this._hashName){const N=this._hashName;let G=!1;const V=o.window.location.hash.slice(1).split("&").map(O=>{const $=O.split("=")[0];return $===N?(G=!0,`${$}=${B}`):O}).filter(O=>O);return G||V.push(`${N}=${B}`),`#${V.join("&")}`}return`#${B}`}_getCurrentHash(){const t=o.window.location.hash.replace("#","");if(this._hashName){let s;return t.split("&").map(h=>h.split("=")).forEach(h=>{h[0]===this._hashName&&(s=h)}),(s&&s[1]||"").split("/")}return t.split("/")}_onHashChange(){const t=this._map;if(!t)return!1;const s=this._getCurrentHash();if(s.length>=3&&!s.some(h=>isNaN(h))){const h=t.dragRotate.isEnabled()&&t.touchZoomRotate.isEnabled()?+(s[3]||0):t.getBearing();return t.jumpTo({center:[+s[2],+s[1]],zoom:+s[0],bearing:h,pitch:+(s[4]||0)}),!0}return!1}_updateHashUnthrottled(){const t=o.window.location.href.replace(/(#.+)?$/,this.getHashString());o.window.history.replaceState(o.window.history.state,null,t)}}const Mr={linearity:.3,easing:o.bezier(0,0,.3,1)},oh=o.extend({deceleration:2500,maxSpeed:1400},Mr),sh=o.extend({deceleration:20,maxSpeed:1400},Mr),ah=o.extend({deceleration:1e3,maxSpeed:360},Mr),lh=o.extend({deceleration:1e3,maxSpeed:90},Mr);class ch{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:o.exported.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,s=o.exported.now();for(;t.length>0&&s-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const s={zoom:0,bearing:0,pitch:0,pan:new o.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:_}of this._inertiaBuffer)s.zoom+=_.zoomDelta||0,s.bearing+=_.bearingDelta||0,s.pitch+=_.pitchDelta||0,_.panDelta&&s.pan._add(_.panDelta),_.around&&(s.around=_.around),_.pinchAround&&(s.pinchAround=_.pinchAround);const h=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,m={};if(s.pan.mag()){const _=Ki(s.pan.mag(),h,o.extend({},oh,t||{}));m.offset=s.pan.mult(_.amount/s.pan.mag()),m.center=this._map.transform.center,Qs(m,_)}if(s.zoom){const _=Ki(s.zoom,h,sh);m.zoom=this._map.transform.zoom+_.amount,Qs(m,_)}if(s.bearing){const _=Ki(s.bearing,h,ah);m.bearing=this._map.transform.bearing+o.clamp(_.amount,-179,179),Qs(m,_)}if(s.pitch){const _=Ki(s.pitch,h,lh);m.pitch=this._map.transform.pitch+_.amount,Qs(m,_)}if(m.zoom||m.bearing){const _=s.pinchAround===void 0?s.around:s.pinchAround;m.around=_?this._map.unproject(_):this._map.getCenter()}return this.clear(),m.noMoveStart=!0,m}}function Qs(l,t){(!l.duration||l.duration<t.duration)&&(l.duration=t.duration,l.easing=t.easing)}function Ki(l,t,s){const{maxSpeed:h,linearity:m,deceleration:_}=s,x=o.clamp(l*m/(t/1e3),-h,h),A=Math.abs(x)/(_*m);return{easing:s.easing,duration:1e3*A,amount:x*(A/2)}}class kn extends o.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,s,h,m={}){const _=Ut(s.getCanvasContainer(),h),x=s.unproject(_);super(t,o.extend({point:_,lngLat:x,originalEvent:h},m)),this._defaultPrevented=!1,this.target=s}}class Ks extends o.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,s,h){const m=t==="touchend"?h.changedTouches:h.touches,_=At(s.getCanvasContainer(),m),x=_.map(C=>s.unproject(C)),A=_.reduce((C,S,z,B)=>C.add(S.div(B.length)),new o.pointGeometry(0,0));super(t,{points:_,point:A,lngLats:x,lngLat:s.unproject(A),originalEvent:h}),this._defaultPrevented=!1}}class cp extends o.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,s,h){super(t,{originalEvent:h}),this._defaultPrevented=!1}}class up{constructor(t,s){this._map=t,this._clickTolerance=s.clickTolerance}reset(){this._mousedownPos=void 0}wheel(t){return this._firePreventable(new cp(t.type,this._map,t))}mousedown(t,s){return this._mousedownPos=s,this._firePreventable(new kn(t.type,this._map,t))}mouseup(t){this._map.fire(new kn(t.type,this._map,t))}preclick(t){const s=o.extend({},t);s.type="preclick",this._map.fire(new kn(s.type,this._map,s))}click(t,s){this._mousedownPos&&this._mousedownPos.dist(s)>=this._clickTolerance||(this.preclick(t),this._map.fire(new kn(t.type,this._map,t)))}dblclick(t){return this._firePreventable(new kn(t.type,this._map,t))}mouseover(t){this._map.fire(new kn(t.type,this._map,t))}mouseout(t){this._map.fire(new kn(t.type,this._map,t))}touchstart(t){return this._firePreventable(new Ks(t.type,this._map,t))}touchmove(t){this._map.fire(new Ks(t.type,this._map,t))}touchend(t){this._map.fire(new Ks(t.type,this._map,t))}touchcancel(t){this._map.fire(new Ks(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Sr{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(t){this._map.fire(new kn(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new kn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._map.fire(new kn(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class uh{constructor(t,s){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=s.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,s){this.isEnabled()&&t.shiftKey&&t.button===0&&(ke(),this._startPos=this._lastPos=s,this._active=!0)}mousemoveWindow(t,s){if(!this._active)return;const h=s;if(this._lastPos.equals(h)||!this._box&&h.dist(this._startPos)<this._clickTolerance)return;const m=this._startPos;this._lastPos=h,this._box||(this._box=se("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));const _=Math.min(m.x,h.x),x=Math.max(m.x,h.x),A=Math.min(m.y,h.y),C=Math.max(m.y,h.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${_}px,${A}px)`,this._box.style.width=x-_+"px",this._box.style.height=C-A+"px")})}mouseupWindow(t,s){if(!this._active||t.button!==0)return;const h=this._startPos,m=s;if(this.reset(),Dt(),h.x!==m.x||h.y!==m.y)return this._map.fire(new o.Event("boxzoomend",{originalEvent:t})),{cameraAnimation:_=>_.fitScreenCoordinates(h,m,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",t)}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),Xe(),delete this._startPos,delete this._lastPos}_fireEvent(t,s){return this._map.fire(new o.Event(t,{originalEvent:s}))}}function Wr(l,t){const s={};for(let h=0;h<l.length;h++)s[l[h].identifier]=t[h];return s}class gr{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(t,s,h){(this.centroid||h.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=t.timeStamp),h.length===this.numTouches&&(this.centroid=function(m){const _=new o.pointGeometry(0,0);for(const x of m)_._add(x);return _.div(m.length)}(s),this.touches=Wr(h,s)))}touchmove(t,s,h){if(this.aborted||!this.centroid)return;const m=Wr(h,s);for(const _ in this.touches){const x=this.touches[_],A=m[_];(!A||A.dist(x)>30)&&(this.aborted=!0)}}touchend(t,s,h){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),h.length===0){const m=!this.aborted&&this.centroid;if(this.reset(),m)return m}}}class Eo{constructor(t){this.singleTap=new gr(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(t,s,h){this.singleTap.touchstart(t,s,h)}touchmove(t,s,h){this.singleTap.touchmove(t,s,h)}touchend(t,s,h){const m=this.singleTap.touchend(t,s,h);if(m){const _=t.timeStamp-this.lastTime<500,x=!this.lastTap||this.lastTap.dist(m)<30;if(_&&x||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=m,this.count===this.numTaps)return this.reset(),m}}}class nt{constructor(){this._zoomIn=new Eo({numTouches:1,numTaps:2}),this._zoomOut=new Eo({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,s,h){this._zoomIn.touchstart(t,s,h),this._zoomOut.touchstart(t,s,h)}touchmove(t,s,h){this._zoomIn.touchmove(t,s,h),this._zoomOut.touchmove(t,s,h)}touchend(t,s,h){const m=this._zoomIn.touchend(t,s,h),_=this._zoomOut.touchend(t,s,h);return m?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:x=>x.easeTo({duration:300,zoom:x.getZoom()+1,around:x.unproject(m)},{originalEvent:t})}):_?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:x=>x.easeTo({duration:300,zoom:x.getZoom()-1,around:x.unproject(_)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const hh={0:1,2:2};class Xa{constructor(t){this.reset(),this._clickTolerance=t.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(t,s){return!1}_move(t,s){return{}}mousedown(t,s){if(this._lastPoint)return;const h=Ci(t);this._correctButton(t,h)&&(this._lastPoint=s,this._eventButton=h)}mousemoveWindow(t,s){const h=this._lastPoint;if(h){if(t.preventDefault(),this._eventButton!=null&&function(m,_){const x=hh[_];return m.buttons===void 0||(m.buttons&x)!==x}(t,this._eventButton))this.reset();else if(this._moved||!(s.dist(h)<this._clickTolerance))return this._moved=!0,this._lastPoint=s,this._move(h,s)}}mouseupWindow(t){this._lastPoint&&Ci(t)===this._eventButton&&(this._moved&&Dt(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class $s extends Xa{mousedown(t,s){super.mousedown(t,s),this._lastPoint&&(this._active=!0)}_correctButton(t,s){return s===0&&!t.ctrlKey}_move(t,s){return{around:s,panDelta:s.sub(t)}}}class ts extends Xa{_correctButton(t,s){return s===0&&t.ctrlKey||s===2}_move(t,s){const h=.8*(s.x-t.x);if(h)return this._active=!0,{bearingDelta:h}}contextmenu(t){t.preventDefault()}}class xc extends Xa{_correctButton(t,s){return s===0&&t.ctrlKey||s===2}_move(t,s){const h=-.5*(s.y-t.y);if(h)return this._active=!0,{pitchDelta:h}}contextmenu(t){t.preventDefault()}}class dh{constructor(t,s){this._map=t,this._el=t.getCanvasContainer(),this._minTouches=1,this._clickTolerance=s.clickTolerance||1,this.reset(),o.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new o.pointGeometry(0,0)}touchstart(t,s,h){return this._calculateTransform(t,s,h)}touchmove(t,s,h){if(this._active&&!(h.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(h.length===1)return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return t.preventDefault(),this._calculateTransform(t,s,h)}}touchend(t,s,h){this._calculateTransform(t,s,h),this._active&&h.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,s,h){h.length>0&&(this._active=!0);const m=Wr(h,s),_=new o.pointGeometry(0,0),x=new o.pointGeometry(0,0);let A=0;for(const S in m){const z=m[S],B=this._touches[S];B&&(_._add(z),x._add(z.sub(B)),A++,m[S]=z)}if(this._touches=m,A<this._minTouches||!x.mag())return;const C=x.div(A);return this._sum._add(C),this._sum.mag()<this._clickTolerance?void 0:{around:_.div(A),panDelta:C}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=se("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility==="hidden"&&(this._alertContainer.style.visibility="visible"),this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show")},500)}}class Qa{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(t){}_move(t,s,h){return{}}touchstart(t,s,h){this._firstTwoTouches||h.length<2||(this._firstTwoTouches=[h[0].identifier,h[1].identifier],this._start([s[0],s[1]]))}touchmove(t,s,h){const m=this._firstTwoTouches;if(!m)return;t.preventDefault();const[_,x]=m,A=Js(h,s,_),C=Js(h,s,x);if(!A||!C)return;const S=this._aroundCenter?null:A.add(C).div(2);return this._move([A,C],S,t)}touchend(t,s,h){if(!this._firstTwoTouches)return;const[m,_]=this._firstTwoTouches,x=Js(h,s,m),A=Js(h,s,_);x&&A||(this._active&&Dt(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Js(l,t,s){for(let h=0;h<l.length;h++)if(l[h].identifier===s)return t[h]}function vc(l,t){return Math.log(l/t)/Math.LN2}class ph extends Qa{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,s){const h=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(vc(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:vc(this._distance,h),pinchAround:s}}}function bc(l,t){return 180*l.angleWith(t)/Math.PI}class Ka extends Qa{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,s){const h=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:bc(this._vector,h),pinchAround:s}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const s=25/(Math.PI*this._minDiameter)*360,h=bc(t,this._startVector);return Math.abs(h)<s}}function ea(l){return Math.abs(l.y)>Math.abs(l.x)}class $a extends Qa{constructor(t){super(),this._map=t}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(t){this._lastPoints=t,ea(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,s,h){const m=this._lastPoints;if(!m)return;const _=t[0].sub(m[0]),x=t[1].sub(m[1]);return this._map._cooperativeGestures&&h.touches.length<3||(this._valid=this.gestureBeginsVertically(_,x,h.timeStamp),!this._valid)?void 0:(this._lastPoints=t,this._active=!0,{pitchDelta:(_.y+x.y)/2*-.5})}gestureBeginsVertically(t,s,h){if(this._valid!==void 0)return this._valid;const m=t.mag()>=2,_=s.mag()>=2;if(!m&&!_)return;if(!m||!_)return this._firstMove==null&&(this._firstMove=h),h-this._firstMove<100&&void 0;const x=t.y>0==s.y>0;return ea(t)&&ea(s)&&x}}const fh={panStep:100,bearingStep:15,pitchStep:10};class mh{constructor(){const t=fh;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let s=0,h=0,m=0,_=0,x=0;switch(t.keyCode){case 61:case 107:case 171:case 187:s=1;break;case 189:case 109:case 173:s=-1;break;case 37:t.shiftKey?h=-1:(t.preventDefault(),_=-1);break;case 39:t.shiftKey?h=1:(t.preventDefault(),_=1);break;case 38:t.shiftKey?m=1:(t.preventDefault(),x=-1);break;case 40:t.shiftKey?m=-1:(t.preventDefault(),x=1);break;default:return}return this._rotationDisabled&&(h=0,m=0),{cameraAnimation:A=>{const C=A.getZoom();A.easeTo({duration:300,easeId:"keyboardHandler",easing:_h,zoom:s?Math.round(C)+s*(t.shiftKey?2:1):C,bearing:A.getBearing()+h*this._bearingStep,pitch:A.getPitch()+m*this._pitchStep,offset:[-_*this._panStep,-x*this._panStep],center:A.getCenter()},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function _h(l){return l*(2-l)}const Ac=4.000244140625;class gh{constructor(t,s){this._map=t,this._el=t.getCanvasContainer(),this._handler=s,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,o.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert","_isFullscreen"],this)}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&t.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(t){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(t.ctrlKey||t.metaKey||this.isZooming()||this._isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let s=t.deltaMode===o.window.WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const h=o.exported.now(),m=h-(this._lastWheelEventTime||0);this._lastWheelEventTime=h,s!==0&&s%Ac==0?this._type="wheel":s!==0&&Math.abs(s)<4?this._type="trackpad":m>400?(this._type=null,this._lastValue=s,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(m*s)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,s+=this._lastValue)),t.shiftKey&&s&&(s/=4),this._type&&(this._lastWheelEvent=t,this._delta-=s,this._active||this._start(t)),t.preventDefault()}_onTimeout(t){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(t)}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const s=Ut(this._el,t);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:s,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._map.transform,s=()=>t._terrainEnabled()&&this._aroundCoord?t.computeZoomRelativeTo(this._aroundCoord):t.zoom;if(this._delta!==0){const C=this._type==="wheel"&&Math.abs(this._delta)>Ac?this._wheelZoomRate:this._defaultZoomRate;let S=2/(1+Math.exp(-Math.abs(this._delta*C)));this._delta<0&&S!==0&&(S=1/S);const z=s(),B=Math.pow(2,z),N=typeof this._targetZoom=="number"?t.zoomScale(this._targetZoom):B;this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(N*S))),this._type==="wheel"&&(this._startZoom=s(),this._easing=this._smoothOutEasing(200)),this._delta=0}const h=typeof this._targetZoom=="number"?this._targetZoom:s(),m=this._startZoom,_=this._easing;let x,A=!1;if(this._type==="wheel"&&m&&_){const C=Math.min((o.exported.now()-this._lastWheelEventTime)/200,1),S=_(C);x=o.number(m,h,S),C<1?this._frameId||(this._frameId=!0):A=!0}else x=h,A=!0;return this._active=!0,A&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!A,zoomDelta:x-s(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let s=o.ease;if(this._prevEase){const h=this._prevEase,m=(o.exported.now()-h.start)/h.duration,_=h.easing(m+.01)-h.easing(m),x=.27/Math.sqrt(_*_+1e-4)*.01,A=Math.sqrt(.0729-x*x);s=o.bezier(x,A,.25,1)}return this._prevEase={start:o.exported.now(),duration:t,easing:s},s}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=se("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(o.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_isFullscreen(){return!!o.window.document.fullscreenElement||!!o.window.document.webkitFullscreenElement}_showBlockerAlert(){this._alertContainer.style.visibility==="hidden"&&(this._alertContainer.style.visibility="visible"),this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show")},200)}}class yh{constructor(t,s){this._clickZoom=t,this._tapZoom=s}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class xh{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(t,s){return t.preventDefault(),{cameraAnimation:h=>{h.easeTo({duration:300,zoom:h.getZoom()+(t.shiftKey?-1:1),around:h.unproject(s)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class wc{constructor(){this._tap=new Eo({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(t,s,h){this._swipePoint||(this._tapTime&&t.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?h.length>0&&(this._swipePoint=s[0],this._swipeTouch=h[0].identifier):this._tap.touchstart(t,s,h))}touchmove(t,s,h){if(this._tapTime){if(this._swipePoint){if(h[0].identifier!==this._swipeTouch)return;const m=s[0],_=m.y-this._swipePoint.y;return this._swipePoint=m,t.preventDefault(),this._active=!0,{zoomDelta:_/128}}}else this._tap.touchmove(t,s,h)}touchend(t,s,h){this._tapTime?this._swipePoint&&h.length===0&&this.reset():this._tap.touchend(t,s,h)&&(this._tapTime=t.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class vh{constructor(t,s,h){this._el=t,this._mousePan=s,this._touchPan=h}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class bh{constructor(t,s,h){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=s,this._mousePitch=h}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Ah{constructor(t,s,h,m){this._el=t,this._touchZoom=s,this._touchRotate=h,this._tapDragZoom=m,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const ta=l=>l.zoom||l.drag||l.pitch||l.rotate;class Tc extends o.Event{}class wh{constructor(){this.constants=[1,1,.01],this.radius=0}setup(t,s){const h=o.sub([],s,t);this.radius=o.length(h[2]<0?o.div([],h,this.constants):[h[0],h[1],0])}projectRay(t){o.div(t,t,this.constants),o.normalize(t,t),o.mul$1(t,t,this.constants);const s=o.scale$2([],t,this.radius);if(s[2]>0){const h=o.scale$2([],[0,0,1],o.dot(s,[0,0,1])),m=o.scale$2([],o.normalize([],[s[0],s[1],0]),this.radius),_=o.add([],s,o.scale$2([],o.sub([],o.add([],m,h),s),2));s[0]=_[0],s[1]=_[1]}return s}}function is(l){return l.panDelta&&l.panDelta.mag()||l.zoomDelta||l.bearingDelta||l.pitchDelta}class Th{constructor(t,s){this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ch(t),this._bearingSnap=s.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new wh,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(s),o.bindAll(["handleEvent","handleWindowEvent"],this);const h=this._el;this._listeners=[[h,"touchstart",{passive:!0}],[h,"touchmove",{passive:!1}],[h,"touchend",void 0],[h,"touchcancel",void 0],[h,"mousedown",void 0],[h,"mousemove",void 0],[h,"mouseup",void 0],[o.window.document,"mousemove",{capture:!0}],[o.window.document,"mouseup",void 0],[h,"mouseover",void 0],[h,"mouseout",void 0],[h,"dblclick",void 0],[h,"click",void 0],[h,"keydown",{capture:!1}],[h,"keyup",void 0],[h,"wheel",{passive:!1}],[h,"contextmenu",void 0],[o.window,"blur",void 0]];for(const[m,_,x]of this._listeners)m.addEventListener(_,m===o.window.document?this.handleWindowEvent:this.handleEvent,x)}destroy(){for(const[t,s,h]of this._listeners)t.removeEventListener(s,t===o.window.document?this.handleWindowEvent:this.handleEvent,h)}_addDefaultHandlers(t){const s=this._map,h=s.getCanvasContainer();this._add("mapEvent",new up(s,t));const m=s.boxZoom=new uh(s,t);this._add("boxZoom",m);const _=new nt,x=new xh;s.doubleClickZoom=new yh(x,_),this._add("tapZoom",_),this._add("clickZoom",x);const A=new wc;this._add("tapDragZoom",A);const C=s.touchPitch=new $a(s);this._add("touchPitch",C);const S=new ts(t),z=new xc(t);s.dragRotate=new bh(t,S,z),this._add("mouseRotate",S,["mousePitch"]),this._add("mousePitch",z,["mouseRotate"]);const B=new $s(t),N=new dh(s,t);s.dragPan=new vh(h,B,N),this._add("mousePan",B),this._add("touchPan",N,["touchZoom","touchRotate"]);const G=new Ka,V=new ph;s.touchZoomRotate=new Ah(h,V,G,A),this._add("touchRotate",G,["touchPan","touchZoom"]),this._add("touchZoom",V,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Sr(s));const O=s.scrollZoom=new gh(s,this);this._add("scrollZoom",O,["mousePan"]);const $=s.keyboard=new mh;this._add("keyboard",$);for(const W of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])t.interactive&&t[W]&&s[W].enable(t[W])}_add(t,s,h){this._handlers.push({handlerName:t,handler:s,allowed:h}),this._handlersById[t]=s}stop(t){if(!this._updatingCamera){for(const{handler:s}of this._handlers)s.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!ta(this._eventsInProgress)||this.isZooming()}_blockedByActive(t,s,h){for(const m in t)if(m!==h&&(!s||s.indexOf(m)<0))return!0;return!1}handleWindowEvent(t){this.handleEvent(t,`${t.type}Window`)}_getMapTouches(t){const s=[];for(const h of t)this._el.contains(h.target)&&s.push(h);return s}handleEvent(t,s){this._updatingCamera=!0;const h=t.type==="renderFrame",m=h?void 0:t,_={needsRenderFrame:!1},x={},A={},C=t.touches?this._getMapTouches(t.touches):void 0,S=C?At(this._el,C):h?void 0:Ut(this._el,t);for(const{handlerName:N,handler:G,allowed:V}of this._handlers){if(!G.isEnabled())continue;let O;this._blockedByActive(A,V,N)?G.reset():G[s||t.type]&&(O=G[s||t.type](t,S,C),this.mergeHandlerResult(_,x,O,N,m),O&&O.needsRenderFrame&&this._triggerRenderFrame()),(O||G.isActive())&&(A[N]=G)}const z={};for(const N in this._previousActiveHandlers)A[N]||(z[N]=m);this._previousActiveHandlers=A,(Object.keys(z).length||is(_))&&(this._changes.push([_,x,z]),this._triggerRenderFrame()),(Object.keys(A).length||is(_))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:B}=_;B&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],B(this._map))}mergeHandlerResult(t,s,h,m,_){if(!h)return;o.extend(t,h);const x={handlerName:m,originalEvent:h.originalEvent||_};h.zoomDelta!==void 0&&(s.zoom=x),h.panDelta!==void 0&&(s.drag=x),h.pitchDelta!==void 0&&(s.pitch=x),h.bearingDelta!==void 0&&(s.rotate=x)}_applyChanges(){const t={},s={},h={};for(const[m,_,x]of this._changes)m.panDelta&&(t.panDelta=(t.panDelta||new o.pointGeometry(0,0))._add(m.panDelta)),m.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+m.zoomDelta),m.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+m.bearingDelta),m.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+m.pitchDelta),m.around!==void 0&&(t.around=m.around),m.aroundCoord!==void 0&&(t.aroundCoord=m.aroundCoord),m.pinchAround!==void 0&&(t.pinchAround=m.pinchAround),m.noInertia&&(t.noInertia=m.noInertia),o.extend(s,_),o.extend(h,x);this._updateMapTransform(t,s,h),this._changes=[]}_updateMapTransform(t,s,h){const m=this._map,_=m.transform,x=Q=>[Q.x,Q.y,Q.z];if((Q=>{const K=this._eventsInProgress.drag;return K&&!this._handlersById[K.handlerName].isActive()})()&&!is(t)){const Q=_.zoom;_.cameraElevationReference="sea",_.recenterOnTerrain(),_.cameraElevationReference="ground",Q!==_.zoom&&this._map._update(!0)}if(!is(t))return void this._fireEvents(s,h,!0);let{panDelta:A,zoomDelta:C,bearingDelta:S,pitchDelta:z,around:B,aroundCoord:N,pinchAround:G}=t;G!==void 0&&(B=G),(Q=>s.drag&&!this._eventsInProgress.drag)()&&B&&(this._dragOrigin=x(_.pointCoordinate3D(B)),this._trackingEllipsoid.setup(_._camera.position,this._dragOrigin)),_.cameraElevationReference="sea",m._stop(!0),B=B||m.transform.centerPoint,S&&(_.bearing+=S),z&&(_.pitch+=z),_._updateCameraState();const V=[0,0,0];if(A){const Q=_.pointCoordinate(B);if(_.projection.name==="globe"){const K=o.latFromMercatorY(Q.y),ee=_.center.lat,X=Math.min(o.mercatorZfromAltitude(1,K)/o.mercatorZfromAltitude(1,ee),2);A=A.rotate(-_.angle),V[0]=-A.x/_.worldSize*X,V[1]=-A.y/_.worldSize*X}else{const K=_.pointCoordinate(B.sub(A));Q&&K&&(V[0]=K.x-Q.x,V[1]=K.y-Q.y)}}const O=_.zoom,$=[0,0,0];if(C){const Q=x(N||_.pointCoordinate3D(B)),K={dir:o.normalize([],o.sub([],Q,_._camera.position))};if(K.dir[2]<0){const ee=_.zoomDeltaToMovement(Q,C);o.scale$2($,K.dir,ee)}}const W=o.add(V,V,$);_._translateCameraConstrained(W),C&&Math.abs(_.zoom-O)>1e-4&&_.recenterOnTerrain(),_.cameraElevationReference="ground",this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(s,h,!0)}_fireEvents(t,s,h){const m=ta(this._eventsInProgress),_=ta(t),x={};for(const z in t){const{originalEvent:B}=t[z];this._eventsInProgress[z]||(x[`${z}start`]=B),this._eventsInProgress[z]=t[z]}!m&&_&&this._fireEvent("movestart",_.originalEvent);for(const z in x)this._fireEvent(z,x[z]);_&&this._fireEvent("move",_.originalEvent);for(const z in t){const{originalEvent:B}=t[z];this._fireEvent(z,B)}const A={};let C;for(const z in this._eventsInProgress){const{handlerName:B,originalEvent:N}=this._eventsInProgress[z];this._handlersById[B].isActive()||(delete this._eventsInProgress[z],C=s[B]||N,A[`${z}end`]=C)}for(const z in A)this._fireEvent(z,A[z]);const S=ta(this._eventsInProgress);if(h&&(m||_)&&!S){this._updatingCamera=!0;const z=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),B=N=>N!==0&&-this._bearingSnap<N&&N<this._bearingSnap;z?(B(z.bearing||this._map.getBearing())&&(z.bearing=0),this._map.easeTo(z,{originalEvent:C})):(this._map.fire(new o.Event("moveend",{originalEvent:C})),B(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(t,s){this._map.fire(new o.Event(t,s?{originalEvent:s}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(t=>{this._frameId=void 0,this.handleEvent(new Tc("renderFrame",{timeStamp:t})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Ja="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Ec extends o.Evented{constructor(t,s){super(),this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=s.bearingSnap,o.bindAll(["_renderFrameCallback"],this)}getCenter(){return new o.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(t,s){return this.jumpTo({center:t},s)}panBy(t,s,h){return t=o.pointGeometry.convert(t).mult(-1),this.panTo(this.transform.center,o.extend({offset:t},s),h)}panTo(t,s,h){return this.easeTo(o.extend({center:t},s),h)}getZoom(){return this.transform.zoom}setZoom(t,s){return this.jumpTo({zoom:t},s),this}zoomTo(t,s,h){return this.easeTo(o.extend({zoom:t},s),h)}zoomIn(t,s){return this.zoomTo(this.getZoom()+1,t,s),this}zoomOut(t,s){return this.zoomTo(this.getZoom()-1,t,s),this}getBearing(){return this.transform.bearing}setBearing(t,s){return this.jumpTo({bearing:t},s),this}getPadding(){return this.transform.padding}setPadding(t,s){return this.jumpTo({padding:t},s),this}rotateTo(t,s,h){return this.easeTo(o.extend({bearing:t},s),h)}resetNorth(t,s){return this.rotateTo(0,o.extend({duration:1e3},t),s),this}resetNorthPitch(t,s){return this.easeTo(o.extend({bearing:0,pitch:0,duration:1e3},t),s),this}snapToNorth(t,s){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,s):this}getPitch(){return this.transform.pitch}setPitch(t,s){return this.jumpTo({pitch:t},s),this}cameraForBounds(t,s){t=o.LngLatBounds.convert(t);const h=s&&s.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),h,s)}_extendCameraOptions(t){const s={top:0,bottom:0,right:0,left:0};if(typeof(t=o.extend({padding:s,offset:[0,0],maxZoom:this.transform.maxZoom},t)).padding=="number"){const h=t.padding;t.padding={top:h,bottom:h,right:h,left:h}}return t.padding=o.extend(s,t.padding),t}_cameraForBoxAndBearing(t,s,h,m){const _=this._extendCameraOptions(m),x=this.transform,A=x.padding,C=x.project(o.LngLat.convert(t)),S=x.project(o.LngLat.convert(s)),z=new o.pointGeometry(C.x,S.y),B=new o.pointGeometry(S.x,C.y),N=-o.degToRad(h),G=C.rotate(N),V=S.rotate(N),O=z.rotate(N),$=B.rotate(N),W=new o.pointGeometry(Math.max(G.x,V.x,O.x,$.x),Math.max(G.y,V.y,O.y,$.y)),Q=new o.pointGeometry(Math.min(G.x,V.x,O.x,$.x),Math.min(G.y,V.y,O.y,$.y)),K=W.sub(Q),ee=(x.width-((A.left||0)+(A.right||0)+_.padding.left+_.padding.right))/K.x,X=(x.height-((A.top||0)+(A.bottom||0)+_.padding.top+_.padding.bottom))/K.y;if(X<0||ee<0)return void o.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const re=Math.min(x.scaleZoom(x.scale*Math.min(ee,X)),_.maxZoom),ge=typeof _.offset.x=="number"&&typeof _.offset.y=="number"?new o.pointGeometry(_.offset.x,_.offset.y):o.pointGeometry.convert(_.offset),Ae=new o.pointGeometry((_.padding.left-_.padding.right)/2,(_.padding.top-_.padding.bottom)/2).rotate(h*Math.PI/180),Se=ge.add(Ae).mult(x.scale/x.zoomScale(re));return{center:x.unproject(C.add(S).div(2).sub(Se)),zoom:re,bearing:h}}_cameraForBox(t,s,h,m,_){const x=this._extendCameraOptions(_);h=h||0,m=m||0,t=o.LngLat.convert(t),s=o.LngLat.convert(s);const A=this.transform.clone();A.padding=x.padding;const C=this.getFreeCameraOptions(),S=new o.LngLat(.5*(t.lng+s.lng),.5*(t.lat+s.lat)),z=.5*(h+m);if(A._camera.position[2]<o.mercatorZfromAltitude(z,S.lat))return void o.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");C.lookAtPoint(S),A.setFreeCameraOptions(C);const B=o.MercatorCoordinate.fromLngLat(t),N=o.MercatorCoordinate.fromLngLat(s),G=A.pointRayIntersection(A.centerPoint,z),V=[(O=A.rayIntersectionCoordinate(G)).x,O.y,O.z];var O;const $=A.screenPointToMercatorRay(A.centerPoint),W=A.projection.name!=="globe";let Q,K=0;do{const ee=Math.floor(A.zoom),X=1<<ee,re=Math.min(X*B.x,X*N.x),ge=Math.min(X*B.y,X*N.y),Ae=Math.max(X*B.x,X*N.x),Se=Math.max(X*B.y,X*N.y),Ce=new o.Aabb([re,ge,h],[Ae,Se,m]),Ze=o.Frustum.fromInvProjectionMatrix(A.invProjMatrix,A.worldSize,ee,W);if(Ce.intersects(Ze)!==2){Q&&(A._camera.position=o.scaleAndAdd([],A._camera.position,$.dir,-Q),A._updateStateFromCamera());break}const ye=o.sub([],A._camera.position,V);Q=.5*o.length(ye),A._camera.position=o.scaleAndAdd([],A._camera.position,$.dir,Q);try{A._updateStateFromCamera()}catch{return void o.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}}while(++K<10);return{center:A.center,zoom:A.zoom,bearing:A.bearing,pitch:A.pitch}}fitBounds(t,s,h){return this._fitInternal(this.cameraForBounds(t,s),s,h)}_raycastElevationBox(t,s){const h=this.transform.elevation;if(!h)return;const m=new o.pointGeometry(t.x,s.y),_=new o.pointGeometry(s.x,t.y),x=h.pointCoordinate(t);if(!x)return;const A=h.pointCoordinate(s);if(!A)return;const C=h.pointCoordinate(m);if(!C)return;const S=h.pointCoordinate(_);if(!S)return;const z=new o.MercatorCoordinate(x[0],x[1]).toLngLat(),B=new o.MercatorCoordinate(A[0],A[1]).toLngLat(),N=new o.MercatorCoordinate(C[0],C[1]).toLngLat(),G=new o.MercatorCoordinate(S[0],S[1]).toLngLat(),V=Math.min(z.lng,Math.min(B.lng,Math.min(N.lng,G.lng))),O=Math.min(z.lat,Math.min(B.lat,Math.min(N.lat,G.lat))),$=Math.max(z.lng,Math.max(B.lng,Math.max(N.lng,G.lng))),W=Math.max(z.lat,Math.max(B.lat,Math.max(N.lat,G.lat))),Q=Math.min(x[3],Math.min(A[3],Math.min(C[3],S[3]))),K=Math.max(x[3],Math.max(A[3],Math.max(C[3],S[3])));return{minLngLat:new o.LngLat(V,O),maxLngLat:new o.LngLat($,W),minAltitude:Q,maxAltitude:K}}fitScreenCoordinates(t,s,h,m,_){let x,A,C,S;const z=o.pointGeometry.convert(t),B=o.pointGeometry.convert(s),N=this._raycastElevationBox(z,B);if(N)x=N.minLngLat,A=N.maxLngLat,C=N.minAltitude,S=N.maxAltitude;else{if(this.transform.anyCornerOffEdge(z,B))return this;x=this.transform.pointLocation(z),A=this.transform.pointLocation(B)}return this._fitInternal(this.transform.pitch===0?this._cameraForBoxAndBearing(this.transform.pointLocation(o.pointGeometry.convert(t)),this.transform.pointLocation(o.pointGeometry.convert(s)),h,m):this._cameraForBox(x,A,C,S,m),m,_)}_fitInternal(t,s,h){return t?(delete(s=o.extend(t,s)).padding,s.linear?this.easeTo(s,h):this.flyTo(s,h)):this}jumpTo(t,s){this.stop();const h=t.preloadOnly?this.transform.clone():this.transform;let m=!1,_=!1,x=!1;return"zoom"in t&&h.zoom!==+t.zoom&&(m=!0,h.zoom=+t.zoom),t.center!==void 0&&(h.center=o.LngLat.convert(t.center)),"bearing"in t&&h.bearing!==+t.bearing&&(_=!0,h.bearing=+t.bearing),"pitch"in t&&h.pitch!==+t.pitch&&(x=!0,h.pitch=+t.pitch),t.padding==null||h.isPaddingEqual(t.padding)||(h.padding=t.padding),t.preloadOnly?(this._preloadTiles(h),this):(this.fire(new o.Event("movestart",s)).fire(new o.Event("move",s)),m&&this.fire(new o.Event("zoomstart",s)).fire(new o.Event("zoom",s)).fire(new o.Event("zoomend",s)),_&&this.fire(new o.Event("rotatestart",s)).fire(new o.Event("rotate",s)).fire(new o.Event("rotateend",s)),x&&this.fire(new o.Event("pitchstart",s)).fire(new o.Event("pitch",s)).fire(new o.Event("pitchend",s)),this.fire(new o.Event("moveend",s)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||o.warnOnce(Ja),this.transform.getFreeCameraOptions()}setFreeCameraOptions(t,s){const h=this.transform;if(!h.projection.supportsFreeCamera)return o.warnOnce(Ja),this;this.stop();const m=h.zoom,_=h.pitch,x=h.bearing;h.setFreeCameraOptions(t);const A=m!==h.zoom,C=_!==h.pitch,S=x!==h.bearing;return this.fire(new o.Event("movestart",s)).fire(new o.Event("move",s)),A&&this.fire(new o.Event("zoomstart",s)).fire(new o.Event("zoom",s)).fire(new o.Event("zoomend",s)),S&&this.fire(new o.Event("rotatestart",s)).fire(new o.Event("rotate",s)).fire(new o.Event("rotateend",s)),C&&this.fire(new o.Event("pitchstart",s)).fire(new o.Event("pitch",s)).fire(new o.Event("pitchend",s)),this.fire(new o.Event("moveend",s)),this}easeTo(t,s){this._stop(!1,t.easeId),((t=o.extend({offset:[0,0],duration:500,easing:o.ease},t)).animate===!1||!t.essential&&o.exported.prefersReducedMotion)&&(t.duration=0);const h=this.transform,m=this.getZoom(),_=this.getBearing(),x=this.getPitch(),A=this.getPadding(),C="zoom"in t?+t.zoom:m,S="bearing"in t?this._normalizeBearing(t.bearing,_):_,z="pitch"in t?+t.pitch:x,B="padding"in t?t.padding:h.padding,N=o.pointGeometry.convert(t.offset);let G,V,O;if(h.projection.name==="globe"){const Se=o.MercatorCoordinate.fromLngLat(h.center),Ce=N.rotate(-h.angle);Se.x+=Ce.x/h.worldSize,Se.y+=Ce.y/h.worldSize;const Ze=Se.toLngLat(),ye=o.LngLat.convert(t.center||Ze);this._normalizeCenter(ye),G=h.centerPoint.add(Ce),V=new o.pointGeometry(Se.x,Se.y).mult(h.worldSize),O=new o.pointGeometry(o.mercatorXfromLng(ye.lng),o.mercatorYfromLat(ye.lat)).mult(h.worldSize).sub(V)}else{G=h.centerPoint.add(N);const Se=h.pointLocation(G),Ce=o.LngLat.convert(t.center||Se);this._normalizeCenter(Ce),V=h.project(Se),O=h.project(Ce).sub(V)}const $=h.zoomScale(C-m);let W,Q;t.around&&(W=o.LngLat.convert(t.around),Q=h.locationPoint(W));const K=this._zooming||C!==m,ee=this._rotating||_!==S,X=this._pitching||z!==x,re=!h.isPaddingEqual(B),ge=Se=>Ce=>{if(K&&(Se.zoom=o.number(m,C,Ce)),ee&&(Se.bearing=o.number(_,S,Ce)),X&&(Se.pitch=o.number(x,z,Ce)),re&&(Se.interpolatePadding(A,B,Ce),G=Se.centerPoint.add(N)),W)Se.setLocationAtPoint(W,Q);else{const Ze=Se.zoomScale(Se.zoom-m),ye=C>m?Math.min(2,$):Math.max(.5,$),je=Math.pow(ye,1-Ce),Ue=Se.unproject(V.add(O.mult(Ce*je)).mult(Ze));Se.setLocationAtPoint(Se.renderWorldCopies?Ue.wrap():Ue,G)}return t.preloadOnly||this._fireMoveEvents(s),Se};if(t.preloadOnly){const Se=this._emulate(ge,t.duration,h);return this._preloadTiles(Se),this}const Ae={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=K,this._rotating=ee,this._pitching=X,this._padding=re,this._easeId=t.easeId,this._prepareEase(s,t.noMoveStart,Ae),this._ease(ge(h),Se=>{h.recenterOnTerrain(),this._afterEase(s,Se)},t),this}_prepareEase(t,s,h={}){this._moving=!0,this.transform.cameraElevationReference="sea",s||h.moving||this.fire(new o.Event("movestart",t)),this._zooming&&!h.zooming&&this.fire(new o.Event("zoomstart",t)),this._rotating&&!h.rotating&&this.fire(new o.Event("rotatestart",t)),this._pitching&&!h.pitching&&this.fire(new o.Event("pitchstart",t))}_fireMoveEvents(t){this.fire(new o.Event("move",t)),this._zooming&&this.fire(new o.Event("zoom",t)),this._rotating&&this.fire(new o.Event("rotate",t)),this._pitching&&this.fire(new o.Event("pitch",t))}_afterEase(t,s){if(this._easeId&&s&&this._easeId===s)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const h=this._zooming,m=this._rotating,_=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,h&&this.fire(new o.Event("zoomend",t)),m&&this.fire(new o.Event("rotateend",t)),_&&this.fire(new o.Event("pitchend",t)),this.fire(new o.Event("moveend",t))}flyTo(t,s){if(!t.essential&&o.exported.prefersReducedMotion){const ot=o.pick(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(ot,s)}this.stop(),t=o.extend({offset:[0,0],speed:1.2,curve:1.42,easing:o.ease},t);const h=this.transform,m=this.getZoom(),_=this.getBearing(),x=this.getPitch(),A=this.getPadding(),C="zoom"in t?o.clamp(+t.zoom,h.minZoom,h.maxZoom):m,S="bearing"in t?this._normalizeBearing(t.bearing,_):_,z="pitch"in t?+t.pitch:x,B="padding"in t?t.padding:h.padding,N=h.zoomScale(C-m),G=o.pointGeometry.convert(t.offset);let V=h.centerPoint.add(G);const O=h.pointLocation(V),$=o.LngLat.convert(t.center||O);this._normalizeCenter($);const W=h.project(O),Q=h.project($).sub(W);let K=t.curve;const ee=Math.max(h.width,h.height),X=ee/N,re=Q.mag();if("minZoom"in t){const ot=o.clamp(Math.min(t.minZoom,m,C),h.minZoom,h.maxZoom),st=ee/h.zoomScale(ot-m);K=Math.sqrt(st/re*2)}const ge=K*K;function Ae(ot){const st=(X*X-ee*ee+(ot?-1:1)*ge*ge*re*re)/(2*(ot?X:ee)*ge*re);return Math.log(Math.sqrt(st*st+1)-st)}function Se(ot){return(Math.exp(ot)-Math.exp(-ot))/2}function Ce(ot){return(Math.exp(ot)+Math.exp(-ot))/2}const Ze=Ae(0);let ye=function(ot){return Ce(Ze)/Ce(Ze+K*ot)},je=function(ot){return ee*((Ce(Ze)*(Se(st=Ze+K*ot)/Ce(st))-Se(Ze))/ge)/re;var st},Ue=(Ae(1)-Ze)/K;if(Math.abs(re)<1e-6||!isFinite(Ue)){if(Math.abs(ee-X)<1e-6)return this.easeTo(t,s);const ot=X<ee?-1:1;Ue=Math.abs(Math.log(X/ee))/K,je=function(){return 0},ye=function(st){return Math.exp(ot*K*st)}}t.duration="duration"in t?+t.duration:1e3*Ue/("screenSpeed"in t?+t.screenSpeed/K:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0);const lt=_!==S,we=z!==x,pt=!h.isPaddingEqual(B),yt=ot=>st=>{const Et=st*Ue,Ft=1/ye(Et);ot.zoom=st===1?C:m+ot.scaleZoom(Ft),lt&&(ot.bearing=o.number(_,S,st)),we&&(ot.pitch=o.number(x,z,st)),pt&&(ot.interpolatePadding(A,B,st),V=ot.centerPoint.add(G));const ht=st===1?$:ot.unproject(W.add(Q.mult(je(Et))).mult(Ft));return ot.setLocationAtPoint(ot.renderWorldCopies?ht.wrap():ht,V),ot._updateCameraOnTerrain(),t.preloadOnly||this._fireMoveEvents(s),ot};if(t.preloadOnly){const ot=this._emulate(yt,t.duration,h);return this._preloadTiles(ot),this}return this._zooming=!0,this._rotating=lt,this._pitching=we,this._padding=pt,this._prepareEase(s,!1),this._ease(yt(h),()=>this._afterEase(s),t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,s){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const h=this._onEaseEnd;this._onEaseEnd=void 0,h.call(this,s)}if(!t){const h=this.handlers;h&&h.stop(!1)}return this}_ease(t,s,h){h.animate===!1||h.duration===0?(t(1),s()):(this._easeStart=o.exported.now(),this._easeOptions=h,this._onEaseFrame=t,this._onEaseEnd=s,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const t=Math.min((o.exported.now()-this._easeStart)/this._easeOptions.duration,1),s=this._onEaseFrame;s&&s(this._easeOptions.easing(t)),t<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(t,s){t=o.wrap(t,-180,180);const h=Math.abs(t-s);return Math.abs(t-360-s)<h&&(t-=360),Math.abs(t+360-s)<h&&(t+=360),t}_normalizeCenter(t){const s=this.transform;if(!s.renderWorldCopies||s.maxBounds)return;const h=t.lng-s.center.lng;t.lng+=h>180?-360:h<-180?360:0}_emulate(t,s,h){const m=Math.ceil(15*s/1e3),_=[],x=t(h.clone());for(let A=0;A<=m;A++){const C=x(A/m);_.push(C.clone())}return _}}class el{constructor(t={}){this.options=t,o.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(t){const s=this.options&&this.options.compact;return this._map=t,this._container=se("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=se("button","mapboxgl-ctrl-attrib-button",this._container),se("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=se("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),s&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),s===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(t,s){const h=this._map._getUIString(`AttributionControl.${s}`);t.setAttribute("aria-label",h),t.removeAttribute("title"),t.firstElementChild&&t.firstElementChild.setAttribute("title",h)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let t=this._editLink;t||(t=this._editLink=this._container.querySelector(".mapbox-improve-map"));const s=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||o.config.ACCESS_TOKEN}];if(t){const h=s.reduce((m,_,x)=>(_.value&&(m+=`${_.key}=${_.value}${x<s.length-1?"&":""}`),m),"?");t.href=`${o.config.FEEDBACK_URL}/${h}${this._map._hash?this._map._hash.getHashString(!0):""}`,t.rel="noopener nofollow",this._setElementTitle(t,"MapFeedback")}}_updateData(t){!t||t.sourceDataType!=="metadata"&&t.sourceDataType!=="visibility"&&t.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let t=[];if(this._map.style.stylesheet){const m=this._map.style.stylesheet;this.styleOwner=m.owner,this.styleId=m.id}const s=this._map.style._sourceCaches;for(const m in s){const _=s[m];if(_.used){const x=_.getSource();x.attribution&&t.indexOf(x.attribution)<0&&t.push(x.attribution)}}t.sort((m,_)=>m.length-_.length),t=t.filter((m,_)=>{for(let x=_+1;x<t.length;x++)if(t[x].indexOf(m)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=[...this.options.customAttribution,...t]:t.unshift(this.options.customAttribution));const h=t.join(" | ");h!==this._attribHTML&&(this._attribHTML=h,t.length?(this._innerContainer.innerHTML=h,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Eh{constructor(){o.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(t){this._map=t,this._container=se("div","mapboxgl-ctrl");const s=se("a","mapboxgl-ctrl-logo");return s.target="_blank",s.rel="noopener nofollow",s.href="https://www.mapbox.com/",s.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),s.setAttribute("rel","noopener nofollow"),this._container.appendChild(s),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(t){t&&t.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const t=this._map.style._sourceCaches;if(Object.entries(t).length===0)return!0;for(const s in t){const h=t[s].getSource();if(h.hasOwnProperty("mapbox_logo")&&!h.mapbox_logo)return!1}return!0}_updateCompact(){const t=this._container.children;if(t.length){const s=t[0];this._map.getCanvasContainer().offsetWidth<250?s.classList.add("mapboxgl-compact"):s.classList.remove("mapboxgl-compact")}}}class Ch{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const s=++this._id;return this._queue.push({callback:t,id:s,cancelled:!1}),s}remove(t){const s=this._currentlyRunning,h=s?this._queue.concat(s):this._queue;for(const m of h)if(m.id===t)return void(m.cancelled=!0)}run(t=0){const s=this._currentlyRunning=this._queue;this._queue=[];for(const h of s)if(!h.cancelled&&(h.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function tl(l,t,s){if(l=new o.LngLat(l.lng,l.lat),t){const h=new o.LngLat(l.lng-360,l.lat),m=new o.LngLat(l.lng+360,l.lat),_=360*Math.ceil(Math.abs(l.lng-s.center.lng)/360),x=s.locationPoint(l).distSqr(t),A=t.x<0||t.y<0||t.x>s.width||t.y>s.height;s.locationPoint(h).distSqr(t)<x&&(A||Math.abs(h.lng-s.center.lng)<_)?l=h:s.locationPoint(m).distSqr(t)<x&&(A||Math.abs(m.lng-s.center.lng)<_)&&(l=m)}for(;Math.abs(l.lng-s.center.lng)>180;){const h=s.locationPoint(l);if(h.x>=0&&h.y>=0&&h.x<=s.width&&h.y<=s.height)break;l.lng>s.center.lng?l.lng-=360:l.lng+=360}return l}const il={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class nl extends o.Evented{constructor(t,s){if(super(),(t instanceof o.window.HTMLElement||s)&&(t=o.extend({element:t},s)),o.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment!=="auto"?t.pitchAlignment:this._rotationAlignment,this._updateMoving=()=>this._update(!0),t&&t.element)this._element=t.element,this._offset=o.pointGeometry.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=se("div");const m=41,_=27,x=me("svg",{display:"block",height:m*this._scale+"px",width:_*this._scale+"px",viewBox:`0 0 ${_} ${m}`},this._element),A=me("radialGradient",{id:"shadowGradient"},me("defs",{},x));me("stop",{offset:"10%","stop-opacity":.4},A),me("stop",{offset:"100%","stop-opacity":.05},A),me("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},x),me("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},x),me("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},x),me("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},x),this._offset=o.pointGeometry.convert(t&&t.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",m=>{m.preventDefault()}),this._element.addEventListener("mousedown",m=>{m.preventDefault()});const h=this._element.classList;for(const m in il)h.remove(`mapboxgl-marker-anchor-${m}`);h.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(t){return t===this._map||(this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._updateMoving),t.on("moveend",this._update),t.on("remove",this._clearFadeTimer),t._addMarker(this),this.setDraggable(this._draggable),this._update(),t.on("click",this._onMapClick)),this}remove(){const t=this._map;return t&&(t.off("click",this._onMapClick),t.off("move",this._updateMoving),t.off("moveend",this._update),t.off("mousedown",this._addDragHandler),t.off("touchstart",this._addDragHandler),t.off("mouseup",this._onUp),t.off("touchend",this._onUp),t.off("mousemove",this._onMove),t.off("touchmove",this._onMove),t.off("remove",this._clearFadeTimer),t._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=o.LngLat.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const m=Math.sqrt(Math.pow(13.5,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[m,-1*(38.1-13.5+m)],"bottom-right":[-m,-1*(38.1-13.5+m)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=t,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(t){const s=t.code,h=t.charCode||t.keyCode;s!=="Space"&&s!=="Enter"&&h!==32&&h!==13||this.togglePopup()}_onMapClick(t){const s=t.originalEvent.target,h=this._element;this._popup&&(s===h||h.contains(s))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const t=this._popup;return t?(t.isOpen()?(t.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(t.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_evaluateOpacity(){const t=this._map;if(!t)return;const s=this._pos;if(!s||s.x<0||s.x>t.transform.width||s.y<0||s.y>t.transform.height)return void this._clearFadeTimer();const h=t.unproject(s);let m=!1;if(t.transform._terrainEnabled()&&t.getTerrain()){const x=t.getFreeCameraOptions();if(x.position){const A=x.position.toLngLat();m=A.distanceTo(h)<.9*A.distanceTo(this._lngLat)}}const _=(1-t._queryFogOpacity(h))*(m?.2:1);this._element.style.opacity=`${_}`,this._popup&&this._popup._setOpacity(`${_}`),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const t=this._pos;if(!t)return;const s=this._offset.mult(this._scale),h=this._calculatePitch(),m=this._calculateRotation();this._element.style.transform=`
            translate(${t.x}px, ${t.y}px) ${il[this._anchor]}
            rotateX(${h}deg) rotateZ(${m}deg)
            translate(${s.x}px, ${s.y}px)
        `}_calculatePitch(){return this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?0:this._map&&this._pitchAlignment==="map"?this._map.getPitch():0}_calculateRotation(){return this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?this._rotation:this._map&&this._rotationAlignment==="map"?this._rotation-this._map.getBearing():0}_update(t){o.window.cancelAnimationFrame(this._updateFrameId);const s=this._map;s&&(s.transform.renderWorldCopies&&(this._lngLat=tl(this._lngLat,this._pos,s.transform)),this._pos=s.project(this._lngLat),t===!0?this._updateFrameId=o.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),s._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),!s.getTerrain()&&!s.getFog()||this._fadeTimer||(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(t){return this._offset=o.pointGeometry.convert(t),this._update(),this}_onMove(t){const s=this._map;if(s){if(!this._isDragging){const h=this._clickTolerance||s._clickTolerance;this._isDragging=t.point.dist(this._pointerdownPos)>=h}this._isDragging&&(this._pos=t.point.sub(this._positionDelta),this._lngLat=s.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.Event("dragstart"))),this.fire(new o.Event("drag")))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const t=this._map;t&&(t.off("mousemove",this._onMove),t.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new o.Event("dragend")),this._state="inactive"}_addDragHandler(t){const s=this._map;s&&this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(this._pos),this._pointerdownPos=t.point,this._state="pending",s.on("mousemove",this._onMove),s.on("touchmove",this._onMove),s.once("mouseup",this._onUp),s.once("touchend",this._onUp))}setDraggable(t){this._draggable=!!t;const s=this._map;return s&&(t?(s.on("mousedown",this._addDragHandler),s.on("touchstart",this._addDragHandler)):(s.off("mousedown",this._addDragHandler),s.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&t!=="auto"?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}class hp{constructor(t){this.jumpTo(t)}getValue(t){if(t<=this._startTime)return this._start;if(t>=this._endTime)return this._end;const s=o.easeCubicInOut((t-this._startTime)/(this._endTime-this._startTime));return this._start*(1-s)+this._end*s}isEasing(t){return t>=this._startTime&&t<=this._endTime}jumpTo(t){this._startTime=-1/0,this._endTime=-1/0,this._start=t,this._end=t}easeTo(t,s,h){this._start=this.getValue(s),this._end=t,this._startTime=s,this._endTime=s+h}}const dp={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},Cc={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0};function ia(l){l.parentNode&&l.parentNode.removeChild(l)}const Mc={showCompass:!0,showZoom:!0,visualizePitch:!1};class Sc{constructor(t,s,h=!1){this._clickTolerance=10,this.element=s,this.mouseRotate=new ts({clickTolerance:t.dragRotate._mouseRotate._clickTolerance}),this.map=t,h&&(this.mousePitch=new xc({clickTolerance:t.dragRotate._mousePitch._clickTolerance})),o.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),s.addEventListener("mousedown",this.mousedown),s.addEventListener("touchstart",this.touchstart,{passive:!1}),s.addEventListener("touchmove",this.touchmove),s.addEventListener("touchend",this.touchend),s.addEventListener("touchcancel",this.reset)}down(t,s){this.mouseRotate.mousedown(t,s),this.mousePitch&&this.mousePitch.mousedown(t,s),ke()}move(t,s){const h=this.map,m=this.mouseRotate.mousemoveWindow(t,s),_=m&&m.bearingDelta;if(_&&h.setBearing(h.getBearing()+_),this.mousePitch){const x=this.mousePitch.mousemoveWindow(t,s),A=x&&x.pitchDelta;A&&h.setPitch(h.getPitch()+A)}}off(){const t=this.element;t.removeEventListener("mousedown",this.mousedown),t.removeEventListener("touchstart",this.touchstart,{passive:!1}),t.removeEventListener("touchmove",this.touchmove),t.removeEventListener("touchend",this.touchend),t.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){Xe(),o.window.removeEventListener("mousemove",this.mousemove),o.window.removeEventListener("mouseup",this.mouseup)}mousedown(t){this.down(o.extend({},t,{ctrlKey:!0,preventDefault:()=>t.preventDefault()}),Ut(this.element,t)),o.window.addEventListener("mousemove",this.mousemove),o.window.addEventListener("mouseup",this.mouseup)}mousemove(t){this.move(t,Ut(this.element,t))}mouseup(t){this.mouseRotate.mouseupWindow(t),this.mousePitch&&this.mousePitch.mouseupWindow(t),this.offTemp()}touchstart(t){t.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=At(this.element,t.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>t.preventDefault()},this._startPos))}touchmove(t){t.targetTouches.length!==1?this.reset():(this._lastPos=At(this.element,t.targetTouches)[0],this.move({preventDefault:()=>t.preventDefault()},this._lastPos))}touchend(t){t.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const An={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1};let Dn,na=0,Co=!1;const Ic={maxWidth:100,unit:"metric"};function rl(l,t,s){const h=s&&s.maxWidth||100,m=l._containerHeight/2,_=l._containerWidth/2-h/2,x=l.unproject([_,m]),A=l.unproject([_+h,m]),C=x.distanceTo(A);if(s&&s.unit==="imperial"){const S=3.2808*C;S>5280?ns(t,h,S/5280,l._getUIString("ScaleControl.Miles"),l):ns(t,h,S,l._getUIString("ScaleControl.Feet"),l)}else s&&s.unit==="nautical"?ns(t,h,C/1852,l._getUIString("ScaleControl.NauticalMiles"),l):C>=1e3?ns(t,h,C/1e3,l._getUIString("ScaleControl.Kilometers"),l):ns(t,h,C,l._getUIString("ScaleControl.Meters"),l)}function ns(l,t,s,h,m){const _=function(A){const C=Math.pow(10,`${Math.floor(A)}`.length-1);let S=A/C;return S=S>=10?10:S>=5?5:S>=3?3:S>=2?2:S>=1?1:function(z){const B=Math.pow(10,Math.ceil(-Math.log(z)/Math.LN10));return Math.round(z*B)/B}(S),C*S}(s),x=_/s;m._requestDomTask(()=>{l.style.width=t*x+"px",l.innerHTML=`${_}&nbsp;${h}`})}const Gn={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},vi=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function ra(l=new o.pointGeometry(0,0),t="bottom"){if(typeof l=="number"){const s=Math.round(Math.sqrt(.5*Math.pow(l,2)));switch(t){case"top":return new o.pointGeometry(0,l);case"top-left":return new o.pointGeometry(s,s);case"top-right":return new o.pointGeometry(-s,s);case"bottom":return new o.pointGeometry(0,-l);case"bottom-left":return new o.pointGeometry(s,-s);case"bottom-right":return new o.pointGeometry(-s,-s);case"left":return new o.pointGeometry(l,0);case"right":return new o.pointGeometry(-l,0)}return new o.pointGeometry(0,0)}return l instanceof o.pointGeometry||Array.isArray(l)?o.pointGeometry.convert(l):o.pointGeometry.convert(l[t]||[0,0])}const rs={version:o.version,supported:U,setRTLTextPlugin:o.setRTLTextPlugin,getRTLTextPluginStatus:o.getRTLTextPluginStatus,Map:class extends Ec{constructor(l){if((l=o.extend({},Cc,l)).minZoom!=null&&l.maxZoom!=null&&l.minZoom>l.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(l.minPitch!=null&&l.maxPitch!=null&&l.minPitch>l.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(l.minPitch!=null&&l.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(l.maxPitch!=null&&l.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(l.antialias&&o.isSafariWithAntialiasingBug(o.window)&&(l.antialias=!1,o.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Ya(l.minZoom,l.maxZoom,l.minPitch,l.maxPitch,l.renderWorldCopies),l),this._interactive=l.interactive,this._minTileCacheSize=l.minTileCacheSize,this._maxTileCacheSize=l.maxTileCacheSize,this._failIfMajorPerformanceCaveat=l.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=l.preserveDrawingBuffer,this._antialias=l.antialias,this._trackResize=l.trackResize,this._bearingSnap=l.bearingSnap,this._refreshExpiredTiles=l.refreshExpiredTiles,this._fadeDuration=l.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=l.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=l.collectResourceTiming,this._optimizeForTerrain=l.optimizeForTerrain,this._renderTaskQueue=new Ch,this._domRenderTaskQueue=new Ch,this._controls=[],this._markers=[],this._mapId=o.uniqueId(),this._locale=o.extend({},dp,l.locale),this._clickTolerance=l.clickTolerance,this._cooperativeGestures=l.cooperativeGestures,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new hp(0),this._explicitProjection=null,this._requestManager=new o.RequestManager(l.transformRequest,l.accessToken,l.testMode),this._silenceAuthErrors=!!l.testMode,typeof l.container=="string"){if(this._container=o.window.document.getElementById(l.container),!this._container)throw new Error(`Container '${l.container}' not found.`)}else{if(!(l.container instanceof o.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=l.container}if(this._container.childNodes.length>0&&o.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),l.maxBounds&&this.setMaxBounds(l.maxBounds),o.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),o.window!==void 0&&(o.window.addEventListener("online",this._onWindowOnline,!1),o.window.addEventListener("resize",this._onWindowResize,!1),o.window.addEventListener("orientationchange",this._onWindowResize,!1),o.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1)),this.handlers=new Th(this,l),this._localFontFamily=l.localFontFamily,this._localIdeographFontFamily=l.localIdeographFontFamily,l.style&&this.setStyle(l.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),l.projection&&this.setProjection(l.projection),this._hash=l.hash&&new rh(typeof l.hash=="string"&&l.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:l.center,zoom:l.zoom,bearing:l.bearing,pitch:l.pitch}),l.bounds&&(this.resize(),this.fitBounds(l.bounds,o.extend({},l.fitBoundsOptions,{duration:0})))),this.resize(),l.attributionControl&&this.addControl(new el({customAttribution:l.customAttribution})),this._logoControl=new Eh,this.addControl(this._logoControl,l.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",t=>{this._update(t.dataType==="style"),this.fire(new o.Event(`${t.dataType}data`,t))}),this.on("dataloading",t=>{this.fire(new o.Event(`${t.dataType}dataloading`,t))})}_getMapId(){return this._mapId}addControl(l,t){if(t===void 0&&(t=l.getDefaultPosition?l.getDefaultPosition():"top-right"),!l||!l.onAdd)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const s=l.onAdd(this);this._controls.push(l);const h=this._controlPositions[t];return t.indexOf("bottom")!==-1?h.insertBefore(s,h.firstChild):h.appendChild(s),this}removeControl(l){if(!l||!l.onRemove)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(l);return t>-1&&this._controls.splice(t,1),l.onRemove(this),this}hasControl(l){return this._controls.indexOf(l)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(l){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const t=!this._moving;return t&&this.fire(new o.Event("movestart",l)).fire(new o.Event("move",l)),this.fire(new o.Event("resize",l)),t&&this.fire(new o.Event("moveend",l)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(l){return this.transform.setMaxBounds(o.LngLatBounds.convert(l)),this._update()}setMinZoom(l){if((l=l==null?-2:l)>=-2&&l<=this.transform.maxZoom)return this.transform.minZoom=l,this._update(),this.getZoom()<l?this.setZoom(l):this.fire(new o.Event("zoomstart")).fire(new o.Event("zoom")).fire(new o.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(l){if((l=l==null?22:l)>=this.transform.minZoom)return this.transform.maxZoom=l,this._update(),this.getZoom()>l?this.setZoom(l):this.fire(new o.Event("zoomstart")).fire(new o.Event("zoom")).fire(new o.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(l){if((l=l==null?0:l)<0)throw new Error("minPitch must be greater than or equal to 0");if(l>=0&&l<=this.transform.maxPitch)return this.transform.minPitch=l,this._update(),this.getPitch()<l?this.setPitch(l):this.fire(new o.Event("pitchstart")).fire(new o.Event("pitch")).fire(new o.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(l){if((l=l==null?85:l)>85)throw new Error("maxPitch must be less than or equal to 85");if(l>=this.transform.minPitch)return this.transform.maxPitch=l,this._update(),this.getPitch()>l?this.setPitch(l):this.fire(new o.Event("pitchstart")).fire(new o.Event("pitch")).fire(new o.Event("pitchend")),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(l){return this.transform.renderWorldCopies=l,this._update()}getProjection(){return this._explicitProjection?this._explicitProjection:this.style&&this.style.stylesheet&&this.style.stylesheet.projection?this.style.stylesheet.projection:{name:"mercator",center:[0,0]}}setProjection(l){return this._lazyInitEmptyStyle(),l?typeof l=="string"&&(l={name:l}):l=null,this._updateProjection(l)}_updateProjection(l){l===null&&(this._explicitProjection=null);const t=l||this.getProjection(),s=this.transform.setProjection(t);if(l&&(this._explicitProjection=this.transform.getProjection()),s){this.painter.clearBackgroundTiles();for(const h in this.style._sourceCaches)this.style._sourceCaches[h].clearTiles();this.style.applyProjectionUpdate(),this._update(!0)}return this}project(l){return this.transform.locationPoint3D(o.LngLat.convert(l))}unproject(l){return this.transform.pointLocation3D(o.pointGeometry.convert(l))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_createDelegatedListener(l,t,s){if(l==="mouseenter"||l==="mouseover"){let h=!1;const m=x=>{const A=t.filter(S=>this.getLayer(S)),C=A.length?this.queryRenderedFeatures(x.point,{layers:A}):[];C.length?h||(h=!0,s.call(this,new kn(l,this,x.originalEvent,{features:C}))):h=!1},_=()=>{h=!1};return{layers:new Set(t),listener:s,delegates:{mousemove:m,mouseout:_}}}if(l==="mouseleave"||l==="mouseout"){let h=!1;const m=x=>{const A=t.filter(C=>this.getLayer(C));(A.length?this.queryRenderedFeatures(x.point,{layers:A}):[]).length?h=!0:h&&(h=!1,s.call(this,new kn(l,this,x.originalEvent)))},_=x=>{h&&(h=!1,s.call(this,new kn(l,this,x.originalEvent)))};return{layers:new Set(t),listener:s,delegates:{mousemove:m,mouseout:_}}}{const h=m=>{const _=t.filter(A=>this.getLayer(A)),x=_.length?this.queryRenderedFeatures(m.point,{layers:_}):[];x.length&&(m.features=x,s.call(this,m),delete m.features)};return{layers:new Set(t),listener:s,delegates:{[l]:h}}}}on(l,t,s){if(s===void 0)return super.on(l,t);Array.isArray(t)||(t=[t]);const h=this._createDelegatedListener(l,t,s);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[l]=this._delegatedListeners[l]||[],this._delegatedListeners[l].push(h);for(const m in h.delegates)this.on(m,h.delegates[m]);return this}once(l,t,s){if(s===void 0)return super.once(l,t);Array.isArray(t)||(t=[t]);const h=this._createDelegatedListener(l,t,s);for(const m in h.delegates)this.once(m,h.delegates[m]);return this}off(l,t,s){if(s===void 0)return super.off(l,t);t=new Set(Array.isArray(t)?t:[t]);const h=(_,x)=>{if(_.size!==x.size)return!1;for(const A of _)if(!x.has(A))return!1;return!0},m=this._delegatedListeners?this._delegatedListeners[l]:void 0;return m&&(_=>{for(let x=0;x<_.length;x++){const A=_[x];if(A.listener===s&&h(A.layers,t)){for(const C in A.delegates)this.off(C,A.delegates[C]);return _.splice(x,1),this}}})(m),this}queryRenderedFeatures(l,t){return this.style?(t!==void 0||l===void 0||l instanceof o.pointGeometry||Array.isArray(l)||(t=l,l=void 0),this.style.queryRenderedFeatures(l=l||[[0,0],[this.transform.width,this.transform.height]],t=t||{},this.transform)):[]}querySourceFeatures(l,t){return this.style.querySourceFeatures(l,t)}queryTerrainElevation(l,t){const s=this.transform.elevation;return s?(t=o.extend({},{exaggerated:!0},t),s.getAtPoint(o.MercatorCoordinate.fromLngLat(l),null,t.exaggerated)):null}setStyle(l,t){return(t=o.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},t)).diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&t.localFontFamily===this._localFontFamily&&this.style&&l?(this._diffStyle(l,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._localFontFamily=t.localFontFamily,this._updateStyle(l,t))}_getUIString(l){const t=this._locale[l];if(t==null)throw new Error(`Missing UI string '${l}'`);return t}_updateStyle(l,t){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),l&&(this.style=new bn(this,t||{}),this.style.setEventedParent(this,{style:this.style}),typeof l=="string"?this.style.loadURL(l):this.style.loadJSON(l)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new bn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(l,t){if(typeof l=="string"){const s=this._requestManager.normalizeStyleURL(l),h=this._requestManager.transformRequest(s,o.ResourceType.Style);o.getJSON(h,(m,_)=>{m?this.fire(new o.ErrorEvent(m)):_&&this._updateDiff(_,t)})}else typeof l=="object"&&this._updateDiff(l,t)}_updateDiff(l,t){try{this.style.setState(l)&&this._update(!0)}catch(s){o.warnOnce(`Unable to perform style diff: ${s.message||s.error||s}.  Rebuilding the style from scratch.`),this._updateStyle(l,t)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(o.warnOnce("There is no style added to the map."),!1)}addSource(l,t){return this._lazyInitEmptyStyle(),this.style.addSource(l,t),this._update(!0)}isSourceLoaded(l){return!!this.style&&this.style._isSourceCacheLoaded(l)}areTilesLoaded(){const l=this.style&&this.style._sourceCaches;for(const t in l){const s=l[t]._tiles;for(const h in s){const m=s[h];if(m.state!=="loaded"&&m.state!=="errored")return!1}}return!0}addSourceType(l,t,s){this._lazyInitEmptyStyle(),this.style.addSourceType(l,t,s)}removeSource(l){return this.style.removeSource(l),this._updateTerrain(),this._update(!0)}getSource(l){return this.style.getSource(l)}addImage(l,t,{pixelRatio:s=1,sdf:h=!1,stretchX:m,stretchY:_,content:x}={}){if(this._lazyInitEmptyStyle(),t instanceof o.window.HTMLImageElement||o.window.ImageBitmap&&t instanceof o.window.ImageBitmap){const{width:A,height:C,data:S}=o.exported.getImageData(t);this.style.addImage(l,{data:new o.RGBAImage({width:A,height:C},S),pixelRatio:s,stretchX:m,stretchY:_,content:x,sdf:h,version:0})}else if(t.width===void 0||t.height===void 0)this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:A,height:C}=t,S=t;this.style.addImage(l,{data:new o.RGBAImage({width:A,height:C},new Uint8Array(S.data)),pixelRatio:s,stretchX:m,stretchY:_,content:x,sdf:h,version:0,userImage:S}),S.onAdd&&S.onAdd(this,l)}}updateImage(l,t){const s=this.style.getImage(l);if(!s)return void this.fire(new o.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const h=t instanceof o.window.HTMLImageElement||o.window.ImageBitmap&&t instanceof o.window.ImageBitmap?o.exported.getImageData(t):t,{width:m,height:_}=h;m!==void 0&&_!==void 0?m===s.data.width&&_===s.data.height?(s.data.replace(h.data,!(t instanceof o.window.HTMLImageElement||o.window.ImageBitmap&&t instanceof o.window.ImageBitmap)),this.style.updateImage(l,s)):this.fire(new o.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(l){return l?!!this.style.getImage(l):(this.fire(new o.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(l){this.style.removeImage(l)}loadImage(l,t){o.getImage(this._requestManager.transformRequest(l,o.ResourceType.Image),(s,h)=>{t(s,h instanceof o.window.HTMLImageElement?o.exported.getImageData(h):h)})}listImages(){return this.style.listImages()}addLayer(l,t){return this._lazyInitEmptyStyle(),this.style.addLayer(l,t),this._update(!0)}moveLayer(l,t){return this.style.moveLayer(l,t),this._update(!0)}removeLayer(l){return this.style.removeLayer(l),this._update(!0)}getLayer(l){return this.style.getLayer(l)}setLayerZoomRange(l,t,s){return this.style.setLayerZoomRange(l,t,s),this._update(!0)}setFilter(l,t,s={}){return this.style.setFilter(l,t,s),this._update(!0)}getFilter(l){return this.style.getFilter(l)}setPaintProperty(l,t,s,h={}){return this.style.setPaintProperty(l,t,s,h),this._update(!0)}getPaintProperty(l,t){return this.style.getPaintProperty(l,t)}setLayoutProperty(l,t,s,h={}){return this.style.setLayoutProperty(l,t,s,h),this._update(!0)}getLayoutProperty(l,t){return this.style.getLayoutProperty(l,t)}setLight(l,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(l,t),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(l){return this._lazyInitEmptyStyle(),!l&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(l),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(l){return this._lazyInitEmptyStyle(),this.style.setFog(l),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(l){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(o.LngLat.convert(l),this.transform):0}setFeatureState(l,t){return this.style.setFeatureState(l,t),this._update()}removeFeatureState(l,t){return this.style.removeFeatureState(l,t),this._update()}getFeatureState(l){return this.style.getFeatureState(l)}_updateContainerDimensions(){if(!this._container)return;const l=this._container.getBoundingClientRect().width||400,t=this._container.getBoundingClientRect().height||300;let s,h,m,_=this._container;for(;_&&(!h||!m);){const x=o.window.getComputedStyle(_).transform;x&&x!=="none"&&(s=x.match(/matrix.*\((.+)\)/)[1].split(", "),s[0]&&s[0]!=="0"&&s[0]!=="1"&&(h=s[0]),s[3]&&s[3]!=="0"&&s[3]!=="1"&&(m=s[3])),_=_.parentElement}this._containerWidth=h?Math.abs(l/h):l,this._containerHeight=m?Math.abs(t/m):t}_detectMissingCSS(){o.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&o.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const l=this._container;l.classList.add("mapboxgl-map"),(this._missingCSSCanary=se("div","mapboxgl-canary",l)).style.visibility="hidden",this._detectMissingCSS();const t=this._canvasContainer=se("div","mapboxgl-canvas-container",l);this._interactive&&t.classList.add("mapboxgl-interactive"),this._canvas=se("canvas","mapboxgl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const s=this._controlContainer=se("div","mapboxgl-control-container",l),h=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(m=>{h[m]=se("div",`mapboxgl-ctrl-${m}`,s)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(l,t){const s=o.exported.devicePixelRatio||1;this._canvas.width=s*Math.ceil(l),this._canvas.height=s*Math.ceil(t),this._canvas.style.width=`${l}px`,this._canvas.style.height=`${t}px`}_addMarker(l){this._markers.push(l)}_removeMarker(l){const t=this._markers.indexOf(l);t!==-1&&this._markers.splice(t,1)}_setupPainter(){const l=o.extend({},U.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),t=this._canvas.getContext("webgl",l)||this._canvas.getContext("experimental-webgl",l);t?(o.storeAuthState(t,!0),this.painter=new ih(t,this.transform),this.on("data",s=>{s.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),o.exported$1.testSupport(t)):this.fire(new o.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(l){l.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new o.Event("webglcontextlost",{originalEvent:l}))}_contextRestored(l){this._setupPainter(),this.resize(),this._update(),this.fire(new o.Event("webglcontextrestored",{originalEvent:l}))}_onMapScroll(l){if(l.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(l){return this.style?(this._styleDirty=this._styleDirty||l,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(l){return this._update(),this._renderTaskQueue.add(l)}_cancelRenderFrame(l){this._renderTaskQueue.remove(l)}_requestDomTask(l){!this.loaded()||this.loaded()&&!this.isMoving()?l():this._domRenderTaskQueue.add(l)}_render(l){let t;const s=this.painter.context.extTimerQuery,h=o.exported.now();if(this.listens("gpu-timing-frame")&&(t=s.createQueryEXT(),s.beginQueryEXT(s.TIME_ELAPSED_EXT,t)),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(l),this._domRenderTaskQueue.run(l),this._removed)return;let m=!1;const _=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const C=this.transform.zoom,S=this.transform.pitch,z=o.exported.now();this.style.zoomHistory.update(C,z);const B=new o.EvaluationParameters(C,{now:z,fadeDuration:_,pitch:S,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),N=B.crossFadingFactor();N===1&&N===this._crossFadingFactor||(m=!0,this._crossFadingFactor=N),this.style.update(B)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let x=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),x=this._updateAverageElevation(h),this.style._updateSources(this.transform),this._forceMarkerUpdate()):x=this._updateAverageElevation(h),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,_,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:_,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),speedIndexTiming:this.speedIndexTiming}),this.fire(new o.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new o.Event("load"))),this.style&&(this.style.hasTransitions()||m)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const C=o.exported.now()-h;s.endQueryEXT(s.TIME_ELAPSED_EXT,t),setTimeout(()=>{const S=s.getQueryObjectEXT(t,s.QUERY_RESULT_EXT)/1e6;s.deleteQueryEXT(t),this.fire(new o.Event("gpu-timing-frame",{cpuTime:C,gpuTime:S}))},50)}if(this.listens("gpu-timing-layer")){const C=this.painter.collectGpuTimers();setTimeout(()=>{const S=this.painter.queryGpuTimers(C);this.fire(new o.Event("gpu-timing-layer",{layerTimes:S}))},50)}const A=this._sourcesDirty||this._styleDirty||this._placementDirty||x;if(A||this._repaint)this.triggerRepaint();else{const C=!this.isMoving()&&this.loaded();if(C&&(x=this._updateAverageElevation(h,!0)),x)this.triggerRepaint();else if(this._triggerFrame(!1),C&&(this.fire(new o.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const S=this._calculateSpeedIndex();this.fire(new o.Event("speedindexcompleted",{speedIndex:S})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||A||(this._fullyLoaded=!0,this._authenticate())}_forceMarkerUpdate(){for(const l of this._markers)l._update()}_updateAverageElevation(l,t=!1){const s=h=>(this.transform.averageElevation=h,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&s(0);if((t||l-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(l)){const h=this.transform.averageElevation;let m=this.transform.sampleAverageElevation(),_=!1;this.transform.elevation&&(_=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(m)?m=0:this._averageElevationLastSampledAt=l;const x=Math.abs(h-m);if(x>1){if(this._isInitialLoad||_)return this._averageElevation.jumpTo(m),s(m);this._averageElevation.easeTo(m,l,300)}else if(x>1e-4)return this._averageElevation.jumpTo(m),s(m)}return!!this._averageElevation.isEasing(l)&&s(this._averageElevation.getValue(l))}_authenticate(){o.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,l=>{if(l&&(l.message===o.AUTH_ERR_MSG||l.status===401)){const t=this.painter.context.gl;o.storeAuthState(t,!1),this._logoControl instanceof Eh&&this._logoControl._updateLogo(),t&&t.clear(t.DEPTH_BUFFER_BIT|t.COLOR_BUFFER_BIT|t.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new o.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),o.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){this.painter.updateTerrain(this.style,this.isMoving()||this.isRotating()||this.isZooming())}_calculateSpeedIndex(){const l=this.painter.canvasCopy(),t=this.painter.getCanvasCopiesAndTimestamps();t.timeStamps.push(performance.now());const s=this.painter.context.gl,h=s.createFramebuffer();function m(_){s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,_,0);const x=new Uint8Array(s.drawingBufferWidth*s.drawingBufferHeight*4);return s.readPixels(0,0,s.drawingBufferWidth,s.drawingBufferHeight,s.RGBA,s.UNSIGNED_BYTE,x),x}return s.bindFramebuffer(s.FRAMEBUFFER,h),this._canvasPixelComparison(m(l),t.canvasCopies.map(m),t.timeStamps)}_canvasPixelComparison(l,t,s){let h=s[1]-s[0];const m=l.length/4;for(let _=0;_<t.length;_++){const x=t[_];let A=0;for(let C=0;C<x.length;C+=4)x[C]===l[C]&&x[C+1]===l[C+1]&&x[C+2]===l[C+2]&&x[C+3]===l[C+3]&&(A+=1);h+=(s[_+2]-s[_+1])*(1-A/m)}return h}remove(){this._hash&&this._hash.remove();for(const t of this._controls)t.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),o.window!==void 0&&(o.window.removeEventListener("resize",this._onWindowResize,!1),o.window.removeEventListener("orientationchange",this._onWindowResize,!1),o.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),o.window.removeEventListener("online",this._onWindowOnline,!1));const l=this.painter.context.gl.getExtension("WEBGL_lose_context");l&&l.loseContext(),ia(this._canvasContainer),ia(this._controlContainer),ia(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),o.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new o.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(l){this._renderNextFrame=this._renderNextFrame||l,this.style&&!this._frame&&(this._frame=o.exported.frame(t=>{const s=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,s&&this._render(t)}))}_preloadTiles(l){const t=this.style?Object.values(this.style._sourceCaches):[];return o.asyncAll(t,(s,h)=>s._preloadTiles(l,h),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(l){this._trackResize&&this.resize({originalEvent:l})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(l){this._showTileBoundaries!==l&&(this._showTileBoundaries=l,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(l){this._showTerrainWireframe!==l&&(this._showTerrainWireframe=l,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(l){this._speedIndexTiming!==l&&(this._speedIndexTiming=l,this._update())}get showPadding(){return!!this._showPadding}set showPadding(l){this._showPadding!==l&&(this._showPadding=l,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(l){this._showCollisionBoxes!==l&&(this._showCollisionBoxes=l,l?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(l){this._showOverdrawInspector!==l&&(this._showOverdrawInspector=l,this._update())}get repaint(){return!!this._repaint}set repaint(l){this._repaint!==l&&(this._repaint=l,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(l){this._vertices=l,this._update()}_setCacheLimits(l,t){o.setCacheLimits(l,t)}get version(){return o.version}},NavigationControl:class{constructor(l){this.options=o.extend({},Mc,l),this._container=se("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(o.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",t=>{this._map&&this._map.zoomIn({},{originalEvent:t})}),se("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",t=>{this._map&&this._map.zoomOut({},{originalEvent:t})}),se("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(o.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",t=>{const s=this._map;s&&(this.options.visualizePitch?s.resetNorthPitch({},{originalEvent:t}):s.resetNorth({},{originalEvent:t}))}),this._compassIcon=se("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const l=this._map;if(!l)return;const t=l.getZoom(),s=t===l.getMaxZoom(),h=t===l.getMinZoom();this._zoomInButton.disabled=s,this._zoomOutButton.disabled=h,this._zoomInButton.setAttribute("aria-disabled",s.toString()),this._zoomOutButton.setAttribute("aria-disabled",h.toString())}_rotateCompassArrow(){const l=this._map;if(!l)return;const t=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(l.transform.pitch*(Math.PI/180)),.5)}) rotateX(${l.transform.pitch}deg) rotateZ(${l.transform.angle*(180/Math.PI)}deg)`:`rotate(${l.transform.angle*(180/Math.PI)}deg)`;l._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=t)})}onAdd(l){return this._map=l,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),l.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&l.on("pitch",this._rotateCompassArrow),l.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Sc(l,this._compass,this.options.visualizePitch)),this._container}onRemove(){const l=this._map;l&&(this._container.remove(),this.options.showZoom&&l.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&l.off("pitch",this._rotateCompassArrow),l.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(l,t){const s=se("button",l,this._container);return s.type="button",s.addEventListener("click",t),s}_setButtonTitle(l,t){if(!this._map)return;const s=this._map._getUIString(`NavigationControl.${t}`);l.setAttribute("aria-label",s),l.firstElementChild&&l.firstElementChild.setAttribute("title",s)}},GeolocateControl:class extends o.Evented{constructor(l){super(),this.options=o.extend({},An,l),o.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=yc(this._updateMarkerRotation,20)}onAdd(l){var t;return this._map=l,this._container=se("div","mapboxgl-ctrl mapboxgl-ctrl-group"),t=this._setupUI,Dn!==void 0?t(Dn):o.window.navigator.permissions!==void 0?o.window.navigator.permissions.query({name:"geolocation"}).then(s=>{Dn=s.state!=="denied",t(Dn)}):(Dn=!!o.window.navigator.geolocation,t(Dn)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(o.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,na=0,Co=!1}_isOutOfMapMaxBounds(l){const t=this._map.getMaxBounds(),s=l.coords;return!!t&&(s.longitude<t.getWest()||s.longitude>t.getEast()||s.latitude<t.getSouth()||s.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(l){if(this._map){if(this._isOutOfMapMaxBounds(l))return this._setErrorState(),this.fire(new o.Event("outofmaxbounds",l)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=l,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(l),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(l),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new o.Event("geolocate",l)),this._finish()}}_updateCamera(l){const t=new o.LngLat(l.coords.longitude,l.coords.latitude),s=l.coords.accuracy,h=this._map.getBearing(),m=o.extend({bearing:h},this.options.fitBoundsOptions);this._map.fitBounds(t.toBounds(s),m,{geolocateSource:!0})}_updateMarker(l){if(l){const t=new o.LngLat(l.coords.longitude,l.coords.latitude);this._accuracyCircleMarker.setLngLat(t).addTo(this._map),this._userLocationDotMarker.setLngLat(t).addTo(this._map),this._accuracy=l.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const l=this._map._containerHeight/2,t=this._map.unproject([0,l]),s=this._map.unproject([100,l]),h=t.distanceTo(s)/100,m=Math.ceil(2*this._accuracy/h);this._circleElement.style.width=`${m}px`,this._circleElement.style.height=`${m}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(l){if(this._map){if(this.options.trackUserLocation)if(l.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(l.code===3&&Co)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new o.Event("error",l)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(l){if(this._container.addEventListener("contextmenu",t=>t.preventDefault()),this._geolocateButton=se("button","mapboxgl-ctrl-geolocate",this._container),se("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",l===!1){o.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t)}else{const t=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=se("div","mapboxgl-user-location"),this._dotElement.appendChild(se("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(se("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new nl({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=se("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new nl({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",t=>{t.geolocateSource||this._watchState!=="ACTIVE_LOCK"||t.originalEvent&&t.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new o.Event("trackuserlocationend")))})}_onDeviceOrientation(l){this._userLocationDotMarker&&(l.webkitCompassHeading?this._heading=l.webkitCompassHeading:l.absolute===!0&&(this._heading=-1*l.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return o.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":na--,Co=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new o.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let l;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),na++,na>1?(l={maximumAge:6e5,timeout:0},Co=!0):(l=this.options.positionOptions,Co=!1),this._geolocationWatchID=o.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,l),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else o.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const l=()=>{o.window.addEventListener("ondeviceorientationabsolute"in o.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};o.window.DeviceMotionEvent!==void 0&&typeof o.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(t=>{t==="granted"&&l()}).catch(console.error):l()}_clearWatch(){o.window.navigator.geolocation.clearWatch(this._geolocationWatchID),o.window.removeEventListener("deviceorientation",this._onDeviceOrientation),o.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:el,ScaleControl:class{constructor(l){this.options=o.extend({},Ic,l),o.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){rl(this._map,this._container,this.options)}onAdd(l){return this._map=l,this._container=se("div","mapboxgl-ctrl mapboxgl-ctrl-scale",l.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._onMove),this._map=void 0}setUnit(l){this.options.unit=l,rl(this._map,this._container,this.options)}},FullscreenControl:class{constructor(l){this._fullscreen=!1,l&&l.container&&(l.container instanceof o.window.HTMLElement?this._container=l.container:o.warnOnce("Full screen control 'container' must be a DOM element.")),o.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in o.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in o.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(l){return this._map=l,this._container||(this._container=this._map.getContainer()),this._controlContainer=se("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",o.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,o.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!o.window.document.fullscreenEnabled&&!o.window.document.webkitFullscreenEnabled)}_setupUI(){const l=this._fullscreenButton=se("button","mapboxgl-ctrl-fullscreen",this._controlContainer);se("span","mapboxgl-ctrl-icon",l).setAttribute("aria-hidden","true"),l.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),o.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const l=this._getTitle();this._fullscreenButton.setAttribute("aria-label",l),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",l)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(o.window.document.fullscreenElement||o.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?o.window.document.exitFullscreen?o.window.document.exitFullscreen():o.window.document.webkitCancelFullScreen&&o.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends o.Evented{constructor(l){super(),this.options=o.extend(Object.create(Gn),l),o.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(l&&l.className?l.className.trim().split(/\s+/):[])}addTo(l){return this._map&&this.remove(),this._map=l,this.options.closeOnClick&&l.on("preclick",this._onClose),this.options.closeOnMove&&l.on("move",this._onClose),l.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(l.on("mousemove",this._onMouseEvent),l.on("mouseup",this._onMouseEvent),l._canvasContainer.classList.add("mapboxgl-track-pointer")):l.on("move",this._update),this.fire(new o.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const l=this._map;return l&&(l.off("move",this._update),l.off("move",this._onClose),l.off("preclick",this._onClose),l.off("click",this._onClose),l.off("remove",this.remove),l.off("mousemove",this._onMouseEvent),l.off("mouseup",this._onMouseEvent),l.off("drag",this._onMouseEvent),this._map=void 0),this.fire(new o.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(l){this._lngLat=o.LngLat.convert(l),this._pos=null,this._trackPointer=!1,this._update();const t=this._map;return t&&(t.on("move",this._update),t.off("mousemove",this._onMouseEvent),t._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const l=this._map;return l&&(l.off("move",this._update),l.on("mousemove",this._onMouseEvent),l.on("drag",this._onMouseEvent),l._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(l){return this.setDOMContent(o.window.document.createTextNode(l))}setHTML(l){const t=o.window.document.createDocumentFragment(),s=o.window.document.createElement("body");let h;for(s.innerHTML=l;h=s.firstChild,h;)t.appendChild(h);return this.setDOMContent(t)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(l){return this.options.maxWidth=l,this._update(),this}setDOMContent(l){let t=this._content;if(t)for(;t.hasChildNodes();)t.firstChild&&t.removeChild(t.firstChild);else t=this._content=se("div","mapboxgl-popup-content",this._container||void 0);if(t.appendChild(l),this.options.closeButton){const s=this._closeButton=se("button","mapboxgl-popup-close-button",t);s.type="button",s.setAttribute("aria-label","Close popup"),s.setAttribute("aria-hidden","true"),s.innerHTML="&#215;",s.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(l){return this._classList.add(l),this._updateClassList(),this}removeClassName(l){return this._classList.delete(l),this._updateClassList(),this}setOffset(l){return this.options.offset=l,this._update(),this}toggleClassName(l){let t;return this._classList.delete(l)?t=!1:(this._classList.add(l),t=!0),this._updateClassList(),t}_onMouseEvent(l){this._update(l.point)}_getAnchor(l){if(this.options.anchor)return this.options.anchor;const t=this._map,s=this._container,h=this._pos;if(!t||!s||!h)return"bottom";const m=s.offsetWidth,_=s.offsetHeight,x=h.x<m/2,A=h.x>t.transform.width-m/2;if(h.y+l<_)return x?"top-left":A?"top-right":"top";if(h.y>t.transform.height-_){if(x)return"bottom-left";if(A)return"bottom-right"}return x?"left":A?"right":"bottom"}_updateClassList(){const l=this._container;if(!l)return;const t=[...this._classList];t.push("mapboxgl-popup"),this._anchor&&t.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&t.push("mapboxgl-popup-track-pointer"),l.className=t.join(" ")}_update(l){const t=this._map,s=this._content;if(!t||!this._lngLat&&!this._trackPointer||!s)return;let h=this._container;if(h||(h=this._container=se("div","mapboxgl-popup",t.getContainer()),this._tip=se("div","mapboxgl-popup-tip",h),h.appendChild(s)),this.options.maxWidth&&h.style.maxWidth!==this.options.maxWidth&&(h.style.maxWidth=this.options.maxWidth),t.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=tl(this._lngLat,this._pos,t.transform)),!this._trackPointer||l){const m=this._pos=this._trackPointer&&l?l:t.project(this._lngLat),_=ra(this.options.offset),x=this._anchor=this._getAnchor(_.y),A=ra(this.options.offset,x),C=m.add(A).round();t._requestDomTask(()=>{this._container&&x&&(this._container.style.transform=`${il[x]} translate(${C.x}px,${C.y}px)`)})}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const l=this._container.querySelector(vi);l&&l.focus()}_onClose(){this.remove()}_setOpacity(l){this._content&&(this._content.style.opacity=l),this._tip&&(this._tip.style.opacity=l)}},Marker:nl,Style:bn,LngLat:o.LngLat,LngLatBounds:o.LngLatBounds,Point:o.pointGeometry,MercatorCoordinate:o.MercatorCoordinate,FreeCameraOptions:Hs,Evented:o.Evented,config:o.config,prewarm:function(){St().acquire(Tt)},clearPrewarmedResources:function(){const l=gt;l&&(l.isPreloaded()&&l.numActive()===1?(l.release(Tt),gt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return o.config.ACCESS_TOKEN},set accessToken(l){o.config.ACCESS_TOKEN=l},get baseApiUrl(){return o.config.API_URL},set baseApiUrl(l){o.config.API_URL=l},get workerCount(){return _t.workerCount},set workerCount(l){_t.workerCount=l},get maxParallelImageRequests(){return o.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(l){o.config.MAX_PARALLEL_IMAGE_REQUESTS=l},clearStorage(l){o.clearTileCache(l)},workerUrl:"",workerClass:null,setNow:o.exported.setNow,restoreNow:o.exported.restoreNow};return rs});var D=T;return D})})(I0);var Qf=I0.exports;const A3={class:"home-footer"},w3=Ta('<h1 data-v-53e806c2>\u0421\u0432\u044F\u0436\u0438\u0442\u0435\u0441\u044C \u0441 \u043D\u0430\u043C\u0438</h1><div class="contacts" data-v-53e806c2><img class="logoText" src="'+g3+'" alt="logo-text" data-v-53e806c2><div data-v-53e806c2><img src="'+y3+'" alt="" data-v-53e806c2><p data-v-53e806c2>\u0433.\u0422\u0430\u0448\u043A\u0435\u043D\u0442,<br data-v-53e806c2>\u0443\u043B\u0438\u0446\u0430 \u041E\u0441\u0438\u0451 86/32</p></div><div data-v-53e806c2><img src="'+x3+'" alt="" data-v-53e806c2><p data-v-53e806c2>\u0441 09:00 - 18:00 \u043F\u043D-\u0441\u0431 </p></div><h4 data-v-53e806c2>(998) 99 218-55-88</h4></div><div class="map-form" data-v-53e806c2><div id="map" class="map" data-v-53e806c2></div><div class="message" data-v-53e806c2><div class="img-form" data-v-53e806c2><img src="'+v3+'" alt="" data-v-53e806c2><div data-v-53e806c2><h5 data-v-53e806c2>\u0415\u0441\u0442\u044C \u0432\u043E\u043F\u0440\u043E\u0441\u044B? </h5><p data-v-53e806c2>\u0417\u0430\u0434\u0430\u0439\u0442\u0435 \u0438\u0445 \u043C\u0435\u043D\u0435\u0436\u0435\u0440\u0443!</p></div></div><form action="" data-v-53e806c2><input type="text" name="" id="" placeholder="E-mail" data-v-53e806c2><input type="submit" value="\u041F\u043E\u043B\u0443\u0447\u0438\u0442\u044C \u043A\u043E\u043D\u0441\u0443\u043B\u044C\u0442\u0430\u0446\u0438\u044E" data-v-53e806c2></form><p data-v-53e806c2> \u041D\u0430\u0436\u043C\u0438\u043C\u0430\u044F \u043A\u043D\u043E\u043F\u043A\u0443 \u201C\u041E\u0442\u043F\u0440\u0430\u0432\u0438\u0442\u201D \u0432\u044B \u0441\u043E\u0433\u043B\u0430\u0448\u0435\u0442\u0435\u0441\u044C \u0441 <span class="yellow" data-v-53e806c2>\u043F\u043E\u043B\u0438\u0442\u0438\u043A\u043E\u0439 \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u0438\u043A\u0438 \u043F\u0435\u0440\u0441\u043E\u043D\u0430\u043B\u044C\u043D\u044B\u0445 \u0434\u0430\u043D\u043D\u044B\u0445</span></p></div></div>',3),T3=[w3],E3={setup(c){return K1(()=>{const p=[69.340188,41.348679];document.getElementById("map").value;const y=new Qf.Map({container:"map",style:"mapbox://styles/mapbox/streets-v11",center:p,zoom:16});new Qf.Marker().setLngLat(p).addTo(y)}),(p,y)=>(dr(),pr("div",A3,T3))}};var C3=fr(E3,[["__scopeId","data-v-53e806c2"]]),M3="/assets/LogoGrossProfitHorizontal.3350db40.png";const S3={},I3={class:"home-bottom"},z3=Ta('<div class="text" data-v-51bc43a1><img class="logo" src="'+M3+'" alt="" data-v-51bc43a1><p data-v-51bc43a1>\u0418\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u044F \u0438 \u0444\u043E\u0442\u043E\u043A\u043E\u043D\u0442\u0435\u043D\u0442 \u043D\u0430 \u0441\u0430\u0439\u0442\u0435 \u0437\u0430\u0449\u0438\u0449\u0435\u043D\u044B. \u0418\u0445 \u043D\u0435\u043B\u044C\u0437\u044F \u0437\u0430\u043F\u0438\u0441\u044B\u0432\u0430\u0442\u044C, \u043A\u043E\u043F\u0438\u0440\u043E\u0432\u0430\u0442\u044C, \u0440\u0430\u0441\u043F\u0440\u043E\u0441\u0442\u0440\u0430\u043D\u044F\u0442\u044C, \u0438\u043D\u0430\u0447\u0435 \u0432\u043E\u0437\u043D\u0438\u043A\u043D\u0435\u0442 \u0441\u043E\u0431\u043B\u0430\u0437\u043D \u0438\u0445 \u0441\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C! </p><div class="social-links" data-v-51bc43a1><a href="https://www.instagram.com/grossprofit_uz/" data-v-51bc43a1><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" data-v-51bc43a1><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z" data-v-51bc43a1></path></svg></a><a href="https://www.facebook.com/taxandadvisetashkent/" data-v-51bc43a1><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" data-v-51bc43a1><path d="M279.14 288l14.22-92.66h-88.91v-60.13c0-25.35 12.42-50.06 52.24-50.06h40.42V6.26S260.43 0 225.36 0c-73.22 0-121.08 44.38-121.08 124.72v70.62H22.89V288h81.39v224h100.17V288z" data-v-51bc43a1></path></svg></a><a href="https://t.me/grossprofit_uzb" data-v-51bc43a1><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" data-v-51bc43a1><path d="M248,8C111.033,8,0,119.033,0,256S111.033,504,248,504,496,392.967,496,256,384.967,8,248,8ZM362.952,176.66c-3.732,39.215-19.881,134.378-28.1,178.3-3.476,18.584-10.322,24.816-16.948,25.425-14.4,1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25,5.342-39.5,3.652-3.793,67.107-61.51,68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608,69.142-14.845,10.194-26.894,9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7,18.45-13.7,108.446-47.248,144.628-62.3c68.872-28.647,83.183-33.623,92.511-33.789,2.052-.034,6.639.474,9.61,2.885a10.452,10.452,0,0,1,3.53,6.716A43.765,43.765,0,0,1,362.952,176.66Z" data-v-51bc43a1></path></svg></a></div></div><p class="copyRight" data-v-51bc43a1>\xA9 Copyright 2022 D. Q. T. \u0412\u0441\u0435 \u043F\u0440\u0430\u0432\u0430 \u0437\u0430\u0449\u0438\u0449\u0435\u043D\u044B!</p>',2),k3=[z3];function D3(c,p){return dr(),pr("div",I3,k3)}var P3=fr(S3,[["render",D3],["__scopeId","data-v-51bc43a1"]]);const B3={data(){return{showForm:f0}},methods:{sendMessage(){let c=document.getElementById("name").value,p=document.getElementById("phoneNumber").value,y=document.getElementById("description").value;if(c==""){alert("\u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u0412\u0430\u0448\u0435 \u0438\u043C\u044F!");return}if(p==""){alert("\u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u0432\u043E\u0439 \u043D\u043E\u043C\u0435\u0440 \u0442\u0435\u043B\u0435\u0444\u043E\u043D\u0430, \u0447\u0442\u043E\u0431\u044B \u0441\u0432\u044F\u0437\u0430\u0442\u044C\u0441\u044F \u0441 \u0432\u0430\u043C\u0438!");return}if(y==""){alert("\u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u043D\u0430\u043F\u0438\u0448\u0438\u0442\u0435 \u043D\u0435\u0441\u043A\u043E\u043B\u044C\u043A\u043E \u0441\u043B\u043E\u0432 \u0432 \u043A\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u043E\u0431\u044A\u044F\u0441\u043D\u0435\u043D\u0438\u044F!");return}let b=`\u0418\u043C\u044F:  ${c}%0A\u0422\u0435\u043B\u0435\u0444\u043E\u043D\u043D\u044B\u0439 \u043D\u043E\u043C\u0435\u0440:  ${p}%0A\u0414\u043E\u043F\u043E\u043B\u043D\u0438\u0442\u0435\u043B\u044C\u043D\u0430\u044F \u0438\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u044F:  ${y}`;const D=`https://api.telegram.org/bot5398248085:AAHtX4fgYmWfVzDbe4GjVxWMmXiGK0ZTOys/sendMessage?chat_id=${-633562777}&text=${b}`;let o=new XMLHttpRequest;o.open("GET",D,!0),o.send(),this.cleanMessage()},cleanMessage(){document.getElementById("name").value="",document.getElementById("phoneNumber").value="",document.getElementById("description").value=""}},computed:{},mounted(){document.getElementById("form").addEventListener("submit",this.sendMessage())}},L3=Ta('<h1 data-v-52310e57>\u0417\u0430\u043A\u0430\u0437\u0430\u0442\u044C \u0437\u0432\u043E\u043D\u043E\u043A</h1><p data-v-52310e57>\u0412\u0430\u0448\u0435 \u0438\u043C\u044F <span class="yellow" data-v-52310e57>*</span></p><input type="text" id="name" data-v-52310e57><p data-v-52310e57>\u0412\u0430\u0448 \u0442\u0435\u043B\u0435\u0444\u043E\u043D <span class="yellow" data-v-52310e57>*</span></p><input type="text" id="phoneNumber" data-v-52310e57><p data-v-52310e57>\u0414\u043E\u043F\u043E\u043B\u043D\u0438\u0442\u0435\u043B\u044C\u043D\u0430\u044F \u0438\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u044F</p><textarea name="" id="description" cols="30" rows="10" data-v-52310e57></textarea>',7),R3={class:"submit"};function O3(c,p,y,b,T,I){return dr(),pr("form",{id:"form",onSubmit:p[1]||(p[1]=HA(()=>{},["prevent"])),class:Bl(["bot-form",T.showForm.isVisible?"":"hideForm"])},[L3,zt("div",R3,[zt("input",{onClick:p[0]||(p[0]=(...D)=>I.sendMessage&&I.sendMessage(...D)),type:"submit",value:"\u0417\u0430\u043A\u0430\u0437\u0430\u0442\u044C \u0437\u0432\u043E\u043D\u043E\u043A"})])],34)}var F3=fr(B3,[["render",O3],["__scopeId","data-v-52310e57"]]);const N3={components:{HomeIntro:x5,HomeService:O5,HomeAbout:e3,HomeStakeholders:s3,HomeContactDetails:_3,HomeFooter:C3,HomeBottom:P3,Form:F3}},U3={class:"home",id:"home"};function V3(c,p,y,b,T,I){const D=cr("HomeIntro"),o=cr("HomeService"),U=cr("HomeAbout"),oe=cr("HomeStakeholders"),te=cr("HomeContactDetails"),Z=cr("HomeFooter"),se=cr("HomeBottom"),me=cr("Form");return dr(),pr("div",U3,[gi(D),gi(o),gi(U),gi(oe),gi(te),gi(Z),gi(se),gi(me)])}var k0=fr(N3,[["render",V3]]);window.addEventListener("scroll",()=>{document.querySelector("header").classList.toggle("sticky",window.scrollY>0)});const j3={components:{HomeView:k0},data(){return{showNav:!1,showForm:f0}},methods:{showNavLinks(){this.showNav=!this.showNav},showBotForm(){this.showForm.isVisible=!this.showForm.isVisible}}},Gl=c=>(Du("data-v-fbe6c276"),c=c(),Pu(),c),G3={class:"app"},Z3=Gl(()=>zt("svg",{class:"logo",width:"50",height:"42",viewBox:"0 0 50 42",fill:"none",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},[zt("rect",{width:"49.9796",height:"42",fill:"url(#pattern0)"}),zt("defs",null,[zt("pattern",{id:"pattern0",patternContentUnits:"objectBoundingBox",width:"1",height:"1"},[zt("use",{"xlink:href":"#image0_143_649",transform:"translate(0 -0.0120217) scale(0.000882613 0.0010503)"})]),zt("image",{id:"image0_143_649",width:"1133",height:"975","xlink:href":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABG0AAAPPCAYAAAB+HTasAAAACXBIWXMAAC4jAAAuIwF4pT92AAAHwmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNi4wLWMwMDYgNzkuMTY0NzUzLCAyMDIxLzAyLzE1LTExOjUyOjEzICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdGVEYXRlPSIyMDIxLTExLTI0VDEzOjIyOjAzKzA1OjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAyMS0xMS0yNFQxMzoyMzo1OCswNTowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMS0xMS0yNFQxMzoyMzo1OCswNTowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo5NGExNDNiNi1iN2UwLWJhNGQtYjliNi00MmI3NmNlMmZmNjgiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDo2NTYwMjNiZi0wZjI3LWNhNGMtYTYwZS1mYzBkMjAxMzcyMGIiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDphN2U2YzE1MS02ZTgxLTEwNDQtOWYyNi02YmFhNTQxZGFkZDMiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDphN2U2YzE1MS02ZTgxLTEwNDQtOWYyNi02YmFhNTQxZGFkZDMiIHN0RXZ0OndoZW49IjIwMjEtMTEtMjRUMTM6MjM6NTgrMDU6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCAyMi4zIChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY29udmVydGVkIiBzdEV2dDpwYXJhbWV0ZXJzPSJmcm9tIGFwcGxpY2F0aW9uL3ZuZC5hZG9iZS5waG90b3Nob3AgdG8gaW1hZ2UvcG5nIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJkZXJpdmVkIiBzdEV2dDpwYXJhbWV0ZXJzPSJjb252ZXJ0ZWQgZnJvbSBhcHBsaWNhdGlvbi92bmQuYWRvYmUucGhvdG9zaG9wIHRvIGltYWdlL3BuZyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6OTRhMTQzYjYtYjdlMC1iYTRkLWI5YjYtNDJiNzZjZTJmZjY4IiBzdEV2dDp3aGVuPSIyMDIxLTExLTI0VDEzOjIzOjU4KzA1OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgMjIuMyAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOmE3ZTZjMTUxLTZlODEtMTA0NC05ZjI2LTZiYWE1NDFkYWRkMyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDphN2U2YzE1MS02ZTgxLTEwNDQtOWYyNi02YmFhNTQxZGFkZDMiIHN0UmVmOm9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDphN2U2YzE1MS02ZTgxLTEwNDQtOWYyNi02YmFhNTQxZGFkZDMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4GfkYiAABPWElEQVR4nO3dT3aT2ZkG8Cd9wohBq1cQZQVRVlCqKZO4VhCzgsAKClYAWQHOCso9YVqqFURZQalX0OoBIwb04DMxUGBL1p/33u/7/c7RMRCgnu4q29Kj9773dx8+fAgAAAAAbfmP6gAAAAAA/JbSBgAAAKBBShsAAACABiltAAAAABqktAEAAABokNIGAAAAoEFKGwAAAIAGKW0AAAAAGqS0AQAAAGiQ0gYAAACgQUobAAAAgAYpbQAAAAAapLQBAAAAaJDSBgAAAKBBShsAAACABiltAAAAABqktAEAAABokNIGAAAAoEFKGwAAAIAGKW0AAAAAGqS0AQAAAGiQ0gYAAACgQUobAAAAgAYpbQAAAAAapLQBAAAAaJDSBgAAAKBBShsAAACABiltAAAAABqktAEAAABokNIGAAAAoEFKGwAAAIAGKW0AAAAAGqS0AQAAAGiQ0gYAAACgQUobAAAAgAYpbQAAAAAapLQBAAAAaJDSBgAAAKBBShsAAACABiltAAAAABr0++oAh3r39lF1BKDOz9UBjmSb5F/VIY5kc/MYg3WGfzcAn3n85P1Bf97zV4CHOfTrb4+6L22ASVtWBziii+oAjNY2QwE1Bpsk/1MdYg/b9PP/+1V1AADgt5Q2ADBus4yr4GS8tjl9ybVO8n+H/iXv3j5a52GTeOvHT94/5M8BMFG/+/DhQ3WGgxgvhUnr+wsYAHzbJvcfN93m7uO1d/0d6zgCCnTG8SgAAKAF85vHfS6O/M9dfeXX1vnthNKXv+9rfw6AA5m0AXrW9xcwABinbT4/6rbObemzye30z6c/BriXSRsAAIDDzPL5Lq3lV3/X59YZyp5tbo98ffy1TZQ7wEQpbQAAgGqLT3588Y3fs7l5bDMUOx9/vo79PMBIKW0AAIAezHO75+fiK//7KreFzjq3hQ5At5Q2AADAGCxvPl588evrm8f/ZCh21jGZA3TCImKgZ31/AQMAqmwylDe/3Hxc1UUBdmURMQAAwPjNbx4Xn/zaKp+XONtzBgL4GqUNAADAcLxq+cnPVxlKnFVM4gBFHI8Cetb3FzAAoBfbJNcZSpzrmMKBElM8HvUf1QEAAAAaN0tymeRNkv9N8nOSZ7m9zQrgJJQ2AAAA+1kmeZXk1yT/zFDgzOriAGOltAEAAHi4RYYC53+T/JRhIgfgKJQ2AAAAx3GR2yNUbzIUOgAPprQBAAA4rlmGiZt/3jwu4/gU8ABKGwAAgNNZZJi6+TWmb4A9KW0AAABOb5bb6ZufMxylAriT0gYAAOC8lhmWFv8aN08Bd1DaAAAA1Jjn9urwFzc/B/g3pQ0AAECtWZIfc7v3Zl4ZBmiH0gYAAKAdl1HeADeUNgAAAO25zFDe/JxhBw4wQUobAACAdi0zFDfKG5ggpQ0AAED7llHewOQobQAAAPqxjPIGJkNpAwAA0J9llDcwekobAACAfi2jvIHRUtoAAAD0bxnlDYyO0gYAAGA8llHewGgobQAAAMZnGeUNdE9pAwAAMF7LKG+gW0obAACA8VtGeQPdUdoAAABMxzLKG+iG0gYAAGB6lhmKmzdJ5qVJgG9S2gAAAEzXZZJfo7yBJiltAAAAuIzyBpqjtAEAAOCjyyhvoBlKGwAAAL50mdvyZlaaBCZMaQMAAMC3XGYob15EeQNnp7QBAADgLrMkP2Yob56VJoGJUdoAAACwi1mSVxnKm8vSJDARShsAAAD2Mc+w6+bnJMvSJDByShsAAAAeYpmhuPkpbpqCk1DaAAAAcIiLWFYMJ6G0AQAA4Bg+Liu+LM4Bo6G0AQAA4Fhmse8GjkZpAwAAwLEtMxQ3b+LIFDyY0gYAAIBTucxwZOpZbQzok9IGAACAU5oleZXkn0kWpUmgM0obAAAAzmGRobh5FUemYCdKGwAAAM7pWYYjUxe1MaB9ShsAAADObZbkp5vHvDQJNExpAwAAQJWLDEemntXGgDYpbQAAAKg0y7Dn5udYVAyfUdoAAADQgmWGqZsXtTGgHUobAAAAWvJjXA8OSZQ2AAAAtGcRUzegtAEAAKBZpm6YNKUNAAAALVvE1A0TpbQBAACgBz9muGFqXpwDzkZpAwAAQC+WGaZuLmtjwHkobQAAAOjJLMmbJD/d/BhGS2kDAABAjy6S/Jph+gZGSWkDAABAr2YZ9ty8Ks4BJ6G0AQAAoHfPMuy6mdfGgONS2gAAADAGi1hSzMgobQAAABiLWYYlxW9iSTEjoLQBAABgbC4z7LpZ1MaAwyhtAAAAGKNFhuLmsjYGPJzSBgAAgLGa5fa4FHRHaQMAAMDYXcbtUnRIaQMAAMAULDIUN8vaGLA7pQ0AAABTMcuw5+ZFbQzYjdIGAACAqfkxyU9xLTiNU9oAAAAwRRdxLTiNU9oAAAAwVYsMxc1FbQz4OqUNAAAAUzbLcFTqWW0M+C2lDQAAACSvkryJPTc0RGkDAAAAg8sMx6VmtTFgoLQBAACAW4skv8aCYhqgtAEAAIDPzWJBMQ1Q2gAAAMBvzWJBMcWUNgAAAPBtHxcUw9kpbQAAAOBulxmmbma1MZgapQ0AAADc7yJuluLMlDYAAACwm0WSf8bNUpyJ0gYAAAB2N88wcbOojcEUKG0AAABgP7MMxc1lbQzGTmkDAAAA+5tluFXqsjYGY6a0AQAAgId7k+RZdQjGSWkDAAAAh3mVobyBo1LaAAAAwOEuo7jhyJQ2AAAAcByXUdxwREobAAAAOJ7LDDdLzWpjMAZKGwAAADiuZRQ3HIHSBgAAAI5vEcUNB1LaAAAAwGksorjhAEobAAAAOJ1FFDc8kNIGAAAATmsRxQ0PoLQBAACA01tEccOelDYAAABwHosobtiD0gYAAADOZxHFDTtS2gAAAMB5LaK4YQdKGwAAADi/RRQ33ENpAwAAADUWUdxwB6UNAAAA1FlEccM3KG0AAACg1iJDcQOfUdoAAABAvUWSN9UhaIvSBgAAANpwGcUNn1DaAAAAQDsuo7jhhtIGAAAA2nKZ5EVxBhqgtAEAAID2/JihvGHClDYAAADQpjdR3Eya0gYAAADa9SbDzVJMkNIGAAAA2vZzFDeTpLQBAACAts0yFDfz2hicm9IGAAAA2jdL8tPNRyZCaQMAAAB9WGSYuGEilDYAAADQj0WG5cRMgNIGAAAA+nKZ5EVxBs5AaQMAAAD9+TFDecOIKW0AAACgT2/iKvBRU9oAAABAv1wFPmJKGwAAAOjXLK4CHy2lDQAAAPRtETdKjZLSBgAAAPp3keRVdQiOS2kDAAAA4/AsbpQaFaUNAAAAjMeruFFqNJQ2AAAAMB6zDDdKzWpjcAxKGwAAABiXWYbihs79vjoAwAG+rw4A0IBZ6sfg/5BkfqK/e37CvxtgzBYZjko9L87BAX734cOH6gwHeff2UXUEgAd5/OT9QX/e1z+AvSzysKMCs+xXiv3njr9/378X4KGeJrmqDnEMhz5/7pFJGwAApmB9wJ+9/vQnZyzd57l7ymj5jV//1uTTt34/MG6vMnwNXNfG4CGUNgAA0KbNzeNbVgf+/bP8dtpn+cmPPy1/5nFMDXo1S/JTkj8n2ZYmYW9KGwAAmKZtflv8fPnzr1l+8vEPGYqfxTECASczT/ImyQ/FOdiT0gYAANjH6ouPHy1vHn+6+Tg7TxxgRxdJniV5XZqCvShtAACAY1jl8yJnkaG8+S5KHGjFqwyfp+vaGOzqP6oDAAAAo7TO8I7+D0n+K8M+jef5YrEzcHY/RYnaDaUNAABwDuvclji/S/L9zc83VYFgouYZ9tvQAaUNAABQYZVh8uaPN4/nOfxGLGA3Fxn229A4pQ0AAFBtk2Hq5vsMR6mexjEqOLVXcfNb85Q2AABAS7ZJrnK7C0eBA6djv03jlDYAAECrtvltgbOuiwOjM4/9Nk1T2gAAAD3YZihw/pxhB87LWGIMx3CR5LI4A9+gtAEAAHqzSfIiQ3nzfYYyB3i4VxmmbmiM0gYAAOjZKsOxqf/KcAPVpjIMdGqWYb8NjVHaAAAAY7DNcAOV6Rt4mEWGCTYaorQBAADGZpVh+ubj7pttZRjoyI9xDXhTlDYAAMBYbTJMDny8eWpTmAV64RrwhihtAACAKbjK7dGpVWkSaNs8w8QNDVDaAAAAU7LKUNx8n+S6NAm061mSZXEGorQBAACmaZXkhwzTN1elSaBNb+KYVDmlDQAAMGWb3C4tvipNAm2ZxzGpckobAAAA5Q18zbM4JlVKaQMAAHBrk9vyZlWaBNrgmFQhpQ0AAMBvbXK7sHhVmgRqzeOYVBmlDQAAwLetMhQ3P2QocmCKnsUxqRJKGwAAgPtdZzgy9TzJtjQJ1HBMqoDSBgAAYHevM5Q3r2tjwNnN45jU2SltAAAA9rPNMHFjWTFT8yzJojjDpChtAAAAHmYT+26YnjfVAaZEaQMAAHCY6yR/TvKyOAecwyLJi+IMk6G0AQAAONw2wwvZP8eRKcbvbxl23HBiShsAAIDjWWc4MuWWKcZsFsekzkJpAwAAcHyvM0zdXNfGgJNZJrkozjB6ShsAAIDT2GRYUvxDTN0wTq8yTN1wIkobAACA07rOcD34dW0MOLp5kh+rQ4yZ0gYAAOD0tjF1wzg9y3CjFCegtAEAADif67hhivF5VR1grJQ2AAAA57XJ7Q1TMAbLJJfFGUZJaQMAAFDjdYapm3VtDDiKH2Mp8dH9vjoAALfevX00y7jPBC/imzmcyjrj3JOxjRe0jNs6w9TNq5hUoG/zDPttXpSmGJnfffjwoTrDQd69fVQdATi9+c3jLss9/r7vHhokSgeAsdnmsFLolyP+c1YH5GAcLuMKZfr3xwxHAI/u8ZP3p/hrm6a0AY5tns8Lli9/nny9NJll3BMmAPBQm/z2BdA2yb+++LV1Pp+2+vLn9GGR5E08L6Jf1xluSTs6pU2HlDZwcrPcPmlY3Pz8P/P5E4nl+eIAAA+wyW3xs07yf/l8+md13jjcYxbHpejb9znB1xWlTYeUNnCwWYYCZn7z+MMnP55XBAIAyqwzlDm/5LbU+fhrnN9lhqkb6M06w5Lto1LadEhpA3tZZiho/nDzcRFnpgGA+20zvAj7JbdFzqYqzMQskvwUb6bRn6dJro75FyptOqS0gW9aZChp/pTbggYA4Fg2uS1yVnHL1ynNMhQ3y9oYsJdNhmmb7bH+QqVNh5Q28G/Lm8d38Q0dADi/TYby5pcMi0i3dVFG603suaEvL3PEK8CVNh1S2jBhyyhpAIB2rZL8d4YCZ1MZZGQuY88N/dhmuAJ8e4y/TGnTIaUNE7LIbUlzURkEAGBP6wwlzj/iGNUxLJL8HLsJ6cNVhv02B1PadEhpw4jNMpQ0f7n5OK+LAgBwNJsM0zcKnMMsMkzcLGpjwE7+mCNM3CltOqS0YWTmGaZoPhY1AABjtslQ3lzFEaqHmGWYuFnUxoB7XeUI0zZKmw4pbRiBRZK/5vY6bgCAKVon+XssMX4IC4rpwfcZjkk+mNKmQ0obOrXIUNRcxLEnAIBPbXN7fGpVGaQzr5I8qw4Bd1hlKG4eTGnTIaUNHVlEUQMAsI9NhiuDr2P6ZheXcbMUbTto2maKpc1/VAeAkVtkeNfj1yT/zPDux7wuDgBAV+YZSohfbz7OK8N04CpHuqUHTuTH6gC9UdrA8c0zlDP/jKIGAOAYZhmmSH7NsHh3WZildVdJ/hyTSbRpGZ+/e1HawPFcJvkpw5OJV7FUGADgFJYZiptfY/nut6wzHEPZ1saAr3pVHaAnShs4zCLDF53/zTCye1EZBgBgQua5PTp1WZqkTesobmjTIj5nd6a0gf3NMnyR+fT406wsDQDAtM0zlDf/m+RFPC/71DqKG9pkt82OlDawu3k+X4S3qAwDAMBnZhleCP4a5c2n1hl23KxrY8Bn5jFtsxOlDdzvIp+fm54VZgEA4G6zDOXNP+NF4UebDBM369oY8BnTNjtQ2sDXzTK8Q/NrhuXCy8IsAADsbx47bz61jeKGtszjc/NeShv43Dy339x/jKu6AQB6N8/w/M5V4Yob2vO36gCtU9rAYJnb67ov4wgUAMDYLDMUNz9l2m/MbaO4oR2LKFPvpLRh6i4yfPP+Oa7rBgCYgotYVrxN8kPcKkUb7La5g9KGqbqMfTUAAFP2cVnxRXGOKpu4Dpw2LOM12TcpbZiay9xe2T0vTQIAQLV5hjfxfs40nxuuo7ihDaZtvkFpw1RcRlkDAMDXLTNM3byojVFiHcUN9ZYZ9tvwBaUNY3cZZQ0AAPeb5fbI1KI0yfmtMxQ3UMlNUl+htGGsLqOsAQBgf4tMc+pmneRpdQgm7TJeu/2G0oaxWUZZAwDA4aY4dXMVxQ217Lb5gtKGsVjm9urueWkSAADGYpHpTd1cJXldnIHpushwVJEbSht6N8/txv9laRIAAMbq49TNvDjHuTzPUN7Auc2SPCvO0BSlDb2aJXmV4SjURWkSAACmYJGhuLmsjXE2T5OsqkMwSRYSf0JpQ49eZChrntXGAABgYmYZdie+yTSOcPyQYUExnNMs0ylH76W0oSfLDGXNj5nGN0kAANp0meF4/qI2xsltMxQ329oYTJCFxDeUNvRgHkuGAQBoyyLD89PL2hgnt0nyfXUIJmceO0uTKG1o2yy3R6GWlUEAAOArZhmOSr0qznFq67gKnPOz2yZKG9p1kWHRm7E4AABa9yzDc9dZbYyTuoqrwDmvizhpobShOfMMV3j/FJ+gAAD0Y5FhQnxRG+OknseNUpzX5KdtlDa05FmGdyguamMAAMCDzDL+PTc/ZNhzA+dwWR2gmtKGFiwylDWvMu6RUgAAxm+WYc/Ni9oYJ7ONG6U4n1kmXtwobaj2IkNhs6iNAQAAR/VjhvJmjNYZjkrBOUz6iJTShirLWDQMAMC4XWa8C4qvYjEx57HIhN/kV9pQ4VWGs76L4hwAAHBqiwzPfWe1MU7ieYapGzi1yU7bKG04p0WGdxqe1cYAAICzWmS8N0vZb8M5XGScxee9lDacy4vYXQMAwHTNMs5p802Sp9UhGL1ZJnrLsNKGU5vH7hoAAEjGW9xcx34bTm+SR6SUNpzSs5iuAQCAT80yFDeXtTGOzn4bTm3x7u2jRXWIc1PacAqzJD9lWDg8K00CAADtmWW4DvyyNsbR2W/DqU1u2kZpw7EtMyxZu6iNAQAAzRtbcbPJMHEDp3Lx7u2jWXWIc1LacEwvMt7rDAEA4BTGVtxcZdhxA6cwy8QGBJQ2HMMsQ1lj2TAAAOxvbMXN0wxTN3AKf60OcE5KGw61zHAcalkbAwAAuvYm43lOvY1rwDmd5bu3j+bVIc5FacMhXsRxKAAAOJafMp6bV1dxDTinc1kd4FyUNjzELMM3FMehAADgeGYZ3hRd1MY4mpdxTIrTmMwRKaUN+1ok+WcmtvwJAADOZJbxFDfbOCbFaczfvX20qA5xDkob9nGZ4RvIvDYGAACM2izDZPusNsZRrOKYFKfxt+oA56C0YVevMixHmxXnAACAKZhnPPsjHZPiFC6qA5yD0ob7zDJ8s3hWGwMAACZnkWHipnfbOCbF8c3evX10UR3i1JQ23GWRobBZ1sYAAIDJWmaYeO/dKslVcQbG5y/VAU7tdx8+fKjOcJB3bx9VRxirZcZzjhYAAHr3PP3vhpkl+TVeY3A82yR/fPzk/bY4x8mYtOFrLjOe87MAADAGr9L/Do9thvIJjmWW/j8v7qS04UsfFw4DAABteZP+rwK/ynBUCo5l1EekHI/io1mGwuayNgYAAHCHdZLvM0yt9Gqe4ZgUHMt/jfWIlEkbktsboi5rYwAAAPdYpP/J+E2Ga8DhWC6qA5yK0oZ5hsJmURsDAADY0UWSF8UZDvU6Q3kDxzDaI1JKm2lbJPlnFDYAANCbHzPc+NqrbUzbcDwX794+mlWHOAWlzXQt4oYoAADo2U8ZJud7dRVLiTmei+oAp6C0mabLKGwAAKB3swzFTc9cAc6xjPKIlNJmei4zLC6b1cYAAACOYJHhFtherTNM3MChltUBTkFpMy2X6X/TPAAA8Lln6fsF6/P0fYU5bZi9e/voojrEsSltpuMyChsAABirn9LvNP02yd+rQzAKozsipbSZhjdR2AAAwJjN0vdz/tcxbcPhLqoDHJvSZvzeZJiyAQAAxu0i/T7338ZSYg43e/f20aI6xDEpbcZNYQMAANPyKv1eA36VZFOcgf79tTrAMSltxkthAwAA0zNL38ekXlYHoHvL6gDHpLQZJ4UNAABM1zLDjVI9ukqyKs5A3xbv3j6aV4c4FqXN+ChsAACAH9PvMSnTNhzqojrAsShtxkVhAwAAJH0fk1rFtA2H+a46wLEobcbjRRQ2AADArWX6nTgwbcMhLqoDHIvSZhwuM4w/AgAAfOpNhqmb3qxi2oYDvHv7aFmd4RiUNv27TL9jjwAAwGnN0u8bvKZtOMRfqgMcg9Kmb5dR2AAAAHd7lj6vQV7FtA0Pt6wOcAxKm35dRGEDAADsptdpm79XB6Bbo7j6W2nTp0UUNgAAwO6W6fPikuskm+IM9GtZHeBQSpv+LJL8nD6XiQEAAHVepc/XEXbb8FDdX/2ttOnLLMlP6fMLLQAAUGuWYb9Nb65i2oaHWVYHOJTSph+zDBM289oYAABAx35Mn68p7LbhIebv3j5aVIc4hNKmHz9lOBoFAABwiB6XEl8l2RZnoE/L6gCHUNr04U06/w8NAABoxmX6e32xzVDcwL663mujtGnfs/S55R0AAGhXj9M2jkjxEMvqAIdQ2rTtMsOGdwAAgGNapr8Xs5uYtmF/s5732iht2rWIwgYAADidHqdt/lEdgC4tqwM8lNKmTbMMN0XNamMAAAAjtkx/L2ZXcf03+/tTdYCHUtq0ZxaFDQAAcB49Ttu8rA5Ad5bVAR5KadOeV3G1NwAAcB7L9PeC9jqu/2Y/83dvH82rQzyE0qYtz+KmKAAA4Lx6m7bZZihuYB/L6gAPobRpxzIWDwMAAOe3TH8vaF3/zb663GujtGnDPMlP1SEAAIDJ6m3aZn3zgF0tqwM8hNKm3ixDYTOrjQEAAEzYMv29qDVtwz4W1QEeQmlTz+JhAACgBX+tDrCn6+oA9OXd20fL6gz7UtrUuozFwwAAQBsuM6xu6MU2yVVxBvqyrA6wL6VNnUUsHgYAANryt+oAe/rv6gB0pbtlxEqbGrPYYwMAALTnMn29TrlOsinOQD+W1QH2pbSp8SZ9jR0CAADTMEt/KxyuqwPQjdm7t4/m1SH2obQ5v8skF8UZAAAAvqW3I1L/qA5AVxbVAfahtDmvReyxAQAA2jZPX8dI1nFEit0tqgPsQ2lzXm/S1/lQAABgmnq7/tu0Dbv6rjrAPpQ25/MqnTV6AADAZF2mrzecr6oD0I1FdYB9KG3OY5nkWXEGAACAfVxWB9jDJsMxKbhPV8uIlTanN8twvTcAAEBPLCRmrObVAXaltDk9e2wAAIAezdPXUZJVdQC6sawOsCulzWldxvXeAABAv3qatlnHLVLs5k/VAXaltDmdeVzvDQAA9O2iOsCerqsD0IV5dYBdKW1Ox7EoAACgd7P0tZDYXht2sagOsCulzWk8S0dn5AAAAO7wl+oAe1gn2RZnoAPv3j5aVmfYhdLm+OZJfqwOAQAAcCQX6esUwXV1ALowrw6wC6XN8TkWBQAAjM1FdYA9/FIdgC7MqwPsQmlzXBdxLAoAABifno5IXVcHoAvfVQfYhdLmeGYZpmwAAADG5iL9nCjYJlkVZ6B98+oAu1DaHI9jUQAAwJhdVAfYgyNS3GdeHWAXSpvjWKavL2AAAAD7ckSKUenhBimlzeFmcSwKAAAYv2V1gD2s4+pv7jerDnAfpc3hnqWTsSoAAIADzNLXCYNVdQCat6gOcB+lzWHmSX6sDgEAAHAmXdy4c8NeG+7zh+oA91HaHMaxKAAAYEouqgPsYVUdgObNqwPcR2nzcBfp60wnAADAoebp4IXujXXsteFuy+oA91HaPMwsyavqEAAAAAUuqgPsYVUdAA6htHmYZ+mnXQYAADgme20Yjdav/Vba7G+e5G/VIQAAAIosqwPsYV0dgObNqgPcRWmzv1dp/F8qAADACc3SwVXJN1bVAWjeojrAXZQ2+1mmr/ObAAAAp3BRHWAPq+oANO0/qwPcRWmznx+rAwAAADSgp7026+oANG1RHeAuSpvdXaavs5sAAACnsqgOsId/VQegabPqAHf5fXWAjpiygc9tkry8+QgAtGWRYRcjnMosw39n69IUu1lVB6Bpi+oAd1Ha7OZFXPENH20ylDVXtTH69/jJ+4P+/Lu3j46UBIB9dPL1e5Vkm+TNOf5hTNYyfZQ2mwyfD7PSFPAAjkfdbxZXfEMyfLN7muSPUdgAQA+ukvw5w4tVOAV7bRiFd28fLaszfIvS5n7PopFl2jZR1gBAr9ZJvo/ihtNYVAfYw7o6ADyE41F3m8WUDdO1iWNQAPAbHR5PXWcobn6ONyM5rnmG/6a2pSl2Yxkxd1mk0d1HJm3u9iq+sTE9m5isAYCxWWf43r6ujcEILaoD7GhdHYCmzaoDfIvS5tvmGa75hqnYRFkDAGO2zTBxs66NwcgsqwPsaF0dgKb9oTrAtyhtvs0V30zFKsoaAJiKbRQ3HNefqgPsYV0dgGbNqwN8i9Lm6+YxZcP4rTI8afs+yhoAmJJthlulrmpjMBKL6gB72FQHgH0pbb7OlA1jtsptWbMqTQIAVHoaxQ2Hm6fhfSBfsIyYb1lUB/gWpc1vzWPKhnFaRVkDAHxOccMxLKoD7GhTHYBmzaoDfIvS5rdM2TA2qyhrAIBvU9xwqEV1gB1tqgPAvpQ2n5vHlA3jsYqyBgDYjeKGQzR7884XVtUBaNe7t4+W1Rm+RmnzOVM2jMEqyhoAYH+KGx5qUR1gD9vqALAPpc2tWZKL4gxwiE2SH6KsAQAe7nlci8z+FtUB9rCuDgD7UNrcepaGlw/BHbYZnmD9Mcl1aRIAoHfbDG8CbWtj0JlZ+nktta0OQLMW1QG+RmkzmCX5W3UIeICrDGXN69oYAMCIbDIclYJ9LKoD7Mi133zLrDrA1yhtBpdp9F8QfMM6wzGop/FuAQBwfNfxphD7mVcH2NG2OgDsQ2kzMGVDL7ZJXib5c+ytAQBO62Vckczu5tUBdrSuDkCz/rM6wNcobYYpm3lxBtjFKkNZ86I2BgAwEdsMe/NgF71c+w3fsqgO8DVKm+Sv1QHgHtsMT5i+j3e7AIDzuo7pXnYzrw6wo1V1ANjH1Eub5c0DWrXOMF3zujYGADBhpm3Yxbw6AIzR1EsbUza07OPumk1xDgBg2tYZbqyEu8yrA+xhXR0AdjXl0maeYZ8NtGaT4SjUi9oYAAD/9rI6AF2YVQfY0bY6AE1aVgf4mimXNpfVAeArruNmKACgPZt4fsL9FtUBYGymXNq45pvWPE/yQzT/AECb/l4dAI7kl+oAsKupljaX6Wd0j/HbZjgO9bo2BgDAna5j1x53W1YHgLGZamljATGtWMdxKACgH9fVAQCmZIqlzTwaYNpwlWHCZlMbAwBgZ/+oDgBHsKkOQJvevX00r87wpSmWNnbZ0IKXSZ7G/hoAoC/reP7Ct31XHWBHm+oANGteHeBLUyxtLqsDMHlP4zpvAKBf19UBAKZiaqXNZSwgps42w3Goq9oYAAAHcfMOwJn8vjrAmVlATJVthsJmXRsDAOBg6+oANGteHWBH2+oAsKspTdrMYwExNdZR2AAA47GuDkCz5tUBdrSuDgC7mlJpc1kdgElaR2EDAIzPqjoAwBRMqbRxNIpzW2cobLa1MQAAjm5bHQBgCqZS2izTz6ge47COwgYAGK9/VQcAmIKplDambDindRQ2AAAAHGgqpc1FdQAmYx2FDQAwfpvqADRrXh0AxmQKpc1FkllxBqZhHYUNADANm+oANGteHQDGZAqljaNRnMM6ChsAAACOaOylzSyORnF62yhsAAAAOLKxlzYX1QEYvW0UNgAAAJzA2Eubv1QHYNS2GQqbdW0MAICzW1QHAJiCMZc2s5i04bSeR2EDAEzTrDoAwBSMubS5qA7AqD1PclUdAgAAgPEac2njaBSncpXkdXEGAIBK31UHAJiCMZc2y+oAjNIqydPqEAAAxWbVAQCmYKylzUV8I+H4Nkl+qA4BANCARXUAmrWqDgBjMtbSxtEojm2bobDZ1sYAACi3rA4AMBVjLW0uqgMwOm6KAgAYLKoDAEzFGEubRRyN4riu4qYoAICPLCGmd4vqALCrMZY2f60OwKisY/EwAMCnltUB4ECz6gCwqzGWNsvqAIzGNhYPAwB86iJe8AKczdhKm3mMunE8zzPcGAUAwMCFH9xlVR0AxmZspc2yOgCjcR17bAAAvnRRHQCOYF4dgGatqwN8aWyljeafY9jEHhsAgC9dxtEoxmFeHYA2PX7yflud4UtjK22W1QEYhacZ9tkAAHDLhR/cZ1MdAMZmTKXNIpp/Dvc6zuICAHxpEW+Qcr//qQ6wo/+sDgC7GlNpc1EdgO5tkrysDgEA0KC/VQeAI1pUB4Bdjam0+a46AN1zLAoA4LfmGfbZwH021QHgANvqAF8zptJmWR2Arl3HsSgAgK95VR2AbmyqA+xoXh2AJq2rA3zNWEqbZXUAuraN26IAAL5mGWsIGJ95dQDYldIGkudpdBQOAKDYj9UB6MqqOgCMzVhKG/tseKhVkqviDAAALVrGm6OMz7I6AM3aVgf4mrGUNsvqAHTLbVEAAF/3pjoAXVlVB4AD/as6wNeMobRZVgegW1fxzQUA4Guexd4PxmlRHQD2obRhqrYxZQMA8DXz2GXD/n6pDrCjWXUA2McYSps/VQegS39PP1cSAgCc05t4Ycv+ttUBduT1I9+yqQ7wNWMobZbVAejONsnr4gwAAC16Ec+veZh1dYAdzaoD0KxNdYCv6bq0eff20Tw+6djf39PPOwEAAOdyEceieLhNdYAdLasDwD66Lm3iE479bTK8gwQAwK1F3BbFYTbVAXYwqw5A0zbVAb6m99LGeUT2ZfkwAMDnlkl+jhe0PNyqOsCOFtUBaNfjJ+831Rm+pvfSZlEdgK5sMlzzDQDA4FkUNhxuUx1gR4vqALCv31cHONCyOgBdMWUDADCYJ3mVYY8NHOp/qgPs6A/VAWjWpjrAt3Rb2rx7+2hRnYGubJNcF2cAAKg2yzBd87eYruF4VtUBdrSoDkCzNtUBvqXb0iY+4diPG6MAgCmbRVnD6ayrA+xoUR0A9tVzaWMJMbvaJnldnAEAoMIyyV8zHIOaVQZhtDbp483RWXwO8G2/VAf4lp5Lm0V1ALpxnT6+kQAAHMNFku9uPs4rgzAJ6+oAO1pUB4CH6Lm0WVYHoBsWEAMAYzXL8GJ0maGoWdZFYaL+VR1gR8vqADRtUx3gW7osbSwhZg/rNPwJCACwh0WGyZlFhlUBH38OlVbVAXZkvQZ32VQH+JYuS5v45sTu/l4dAABgD8svPn6X22kaaNG6OsCO5tUBaNq2OsC39FraLKoD0I3r6gAAwOQtP/nxIrfLUL+7+TiPF5T0aZ2GX+x+YVEdgHY9fvJ+XZ3hW3otbYy2sYur9PNNBABoz/IrvzbLb1/8/Smf30ozjxKGaVhVB9jRsjoATdtWB7hLr6XNvDoAXfjv6gAAwJ0WefgVvMsdf98fcvdzx/k9/zvwbZYQMwbr6gB36bW0WVQHoAvX1QE4uRfVAQ7x7u2j6giwr+/u/y2MzCyedwHftqoOsCMnNehWd6WNm6PY0XV1AM7ix+oAAAATtUnDN+58YVkdgKb9Uh3gLv9RHeAB5tUB6IKjUQAAcDqr6gA7mufhxzCZhm11gLv0WNosqgPQhVV1AAAAGLFe3iRdVgegeevqAHfpsbT5Q3UAmrdOP6OaAADQo1V1gB3Zx8Z9ttUB7tJjaTOvDkDzVtUBAABgxNZp/IXuJ5bVAWjb4yfv19UZ7tJjabOoDkDzml4kBQAAnevlaNQ83vTnbpvqAPfpsbSZVQegeavqAAAAMGLX1QF2tKwOQPM21QHu01Vp47pvdrBOP6OaAADQm20aX9z6CftsuM+6OsB9uiptYsqG+62qAwAAwIhdVwfYw0V1AJr3f9UB7tNbabOsDkDz7LMBAIDT6WWfzSLe9Od+q+oA9+mttIH7rKsDAADASG3Tz6TNsjoAXdhUB7hPb6XNn6oD0LRtOvikAwCATl1XB9jDX6oD0L7HT95vqjPcp7fSZlYdgKatqwMAAMCI9XI0ahaTNtxvXR1gF72VNvPqADTNPhsAADiNbfqZtFlWB6ALm+oAu1DaMCab6gAAADBS19UB9uBoFLv4V3WAXXRT2rx7+2hWnYHmrasDAADASPVyNCpx1Te7WVcH2EU3pU2GK9vgLuvqAAAAMELb9DNps4hdqOxmUx1gFz2VNnCXTXUAAAAYqavqAHv4a3UA+vD4yft1dYZd9FTazKsD0LRNdQAAABipf1QH2MNFdQC6sKoOsCulDWPh5igAADi+dfpZQ7CI143sZlMdYFc9lTYAAACcV09TNsvqAHSji5ujkr5Kmz9UB6Bpq+oAAAAwQlfVAfZgnw27WlcH2FVPpc28OgAAAMCEXGW4OaoH87hxmN2tqwPsqqfSBu6yqg4AAAAj8/fqAHu4qA5ANzaPn7zfVofYldIGAACAL63T0TRCkr9VB6Ab6+oA++iptFlWB6BZ6+oAAAAwMj1N2SxinQa762YJcdJXaQPfsq0OAAAAI7KNBcSM16o6wD6UNozBtjoAAACMSE9TNol9NuxnXR1gH0obxqCr8TYAAGjc6+oAe7iIo1HsrqslxEknpc27t48W1RkAAAAm4Cp9TbL/pToAXVlVB9hXF6VNkll1AAAAgAl4WR1gD7M4GsV+ujul0UtpA3dZVQcAAIARuEqyKc6wj4t4g5/9rKsD7EtpAwAAQNLXlE2S/K06AH15/OT9qjrDvpQ2AAAAXKWvKZt5kkVxBvqyqg7wEEobAAAATNkwduvqAA/RS2kzqw5A09bVAQAAoGNX6WvKJkkuqwPQnV+qAzxEL6XNojoATdtWBwAAgI71NmVzGW/ss791dYCH6KW0AQAA4Piu0t+UzV+rA9CdzeMn7zfVIR5CaQMAADBdvU3ZLJIsizPQn1V1gIdS2gAAAEzT6/Q3ZWMBMQ/R5T6bRGkDAAAwRdv0N2UziwXEPMyqOsBDKW0AAACm5+/p70KPZ9UB6FK3+2wSpQ0AAMDUbJK8KM7wEBYQ8xCr6gCHUNoAAABMy/PqAA9wmWRenIE+dbvPJlHaAAAATMkqyXVxhof4sToA3VpVBziE0gYAAGA6nlYHeIBlTNnwMF3vs0mUNgAAAFPxMv1d8Z2YsuHhVtUBDqW0AQAAGL9NktfFGR5iefOAh/jv6gCHUtoAAACM39P0d8V34sYoDrOqDnAopQ0AAMC4XafPF6/zDLdGwUOsHz95v60OcaheSpttdQAAAIAObdPn8uHELhsO0/3RqKSf0mZdHYCmLaoDAABAo3o9FjWPKRsOs6oOcAy9lDZwl1l1AAAAaND1zaNHpmw4xPbxk/er6hDHoLQBAAAYn236PRY1jykbDrOqDnAsShsAAIDx6fVYVGLKhsONYp9NorRhHObVAQAAoCHX6fdY1DymbDjcdXWAY1HaMAbz6gAAANCITfo9FpUkb6oD0L1RXPX9US+lzbo6AAAAQAd6Pha1vHnAIf5RHeCYuihtxtSScRL/WR0AAAAa8DJ9L2C1y4ZjWFUHOKYuShu4x6I6AAAAFFsleVGc4RAXMWXD4TaPn7xfV4c4JqUNAABA37ZJfqgOcaBX1QEYhevqAMfWU2mzqQ5AsxbVAQAAoNAP6XePTZI8i8tFOI7RXPX9kdKGMZhVBwAAgCK977GZxS4bjmP7+Mn7VXWIY+uptIG7zKsDAADAmV2n7z02yVDYzKpDMArX1QFOQWnDWMyrAwAAwBltMlzv3bN5hqNRcAyjOxqV9FXa/FIdgKbNqwMAAMCZbNP/HpskeVMdgNHYPn7y/ro6xCn0VNrAXebVAQAA4EyeJllXhzjQRVzxzfFcVwc4FaUNY/GH6gAAAHAGL9P/C9RZXPHNcY3yaFTSV2mzqg5A0+bVAQAA4MSu0v/i4cQV3xzXaI9GJX2VNnCXZXUAAAA4oXX6XzycDGWNK745puvqAKfUU2mzrQ5A82bVAQAA4ATWSb6vDnEklg9zbKM9GpUkv/vw4UN1hp29e/uon7BU+D6O0U2NrwkAwNhtk/w5wxXfvbuM0obj2j5+8v6/qkOcUk+TNnCfZXUAAAA4om2GNyY3tTGOYhbLhzm+q+oAp9ZbabOqDkDT3CAFAMCYfJ/+r/b+6E2sM+D4/lEd4NR6K23gLovqAAAAcCRPM57C5uLmAce0efzk/bo6xKn1VtqsqwPQtEV1AAAAOIKnGc+xj1nsseE0Rj9lk/RX2vxfdQCat6wOAAAABxhTYZM4FsXpXFUHOIfeSpt1dQCat6gOAAAADzS2wuYijkVxGuvHT95vqkOcQ2+lzbY6AM37rjoAAAA8wNgKm1kci+J0/l4d4Fx6K23W1QFo3rI6AAAA7GlshU3iWBSns01yXZzhbLoqbR4/eb+tzkDzZnFECgCAfoyxsLmMY1GczvWUuoGuSpsb6+oANG9ZHQAAAHYwxsJmnuRVdQhGbRK3Rn3UY2mzrQ5A8+y1AQCgdWMsbJLkpzgWxelsHj95v6oOcU49lja/VAegecvqAAAAcIexFjYvYlUBpzWZBcQf9VjabKoD0LxZFDcAALRprIXNMsmP1SEYvevqAOemtGGs/lIdAAAAPrFN8ueMs7CZZTgWBad0/fjJ+011iHPrsbRZVwegCxfVAQAA4MY2yfcZ72sZe2w4h0ktIP6ou9Lm5mqvbXEM2je/eQAAQKV1hgmbdW2Mk3kRqwk4vU0meDQq6bC0ubGuDkAXLqoDAAAwaesMEzab2hgns4w9NpzH5BYQf6S0Ycz+Vh0AAIDJusowYbOtjXEy89hjw/lcVQeo0mtp8z/VAejCPK4cBADg/F5muCVqrGaxx4bzucp4y8979VrarKsD0A3TNgAAnMs2Q1nzojbGyb2KN0c5n0kuIP5IacPYXcQ7AAAAnN4mw/6aq9oYJ/csyWVxBqZjnWRVnKFUl6XNzQ1Sm+IY9GEWC4kBADitVcZ9Q9RHywxTNnAuk11A/FGXpc2NdXUAuuGIFAAAp/I6w4TNtjbGyS1i8TDntc34J9fu1XNp86/qAHRjkeFdAQAAOJZtkh+SPC/OcQ6zJG9i7QDnNfkpm6Tv0mZVHYCu/FgdAACA0VhnmK65ro1xNj/H4mHO73V1gBb0XNqsqwPQlWV8owEA4HBXGQqbdW2Ms3kTz6M5v6uM/8jhTrotbSwj5gHstgEA4KG2GY5DPc10Xky+iJuiqPGyOkArui1tbqyrA9CVyyTz4gwAAPRnneF2qOvaGGd1GSsGqLGKAY1/6720sYyYffnGAwDAPl5mKGw2xTnOaZnhWBRUMGXzid5Lm1V1ALpzGdM2AADcb5OhrHlRG+PsFnG1N3XW8Tr/M12XNo+fvF9VZ6BL3jUAAOAurzMUNuvaGGe3yHBT1Kw2BhPmmu8vdF3a3FhXB6A7y5sHAAB8apPhZqjnmc6y4Y9mGSZsZrUxmLBNhluj+MQYSptVdQC6ZLcNAACfep1humZVG6PELMOEzbw2BhNnl81XjKG0sYyYh1jG9YUAAEx7uia5LWwWtTGYuG1M2XzVGEqbVXUAuvVjjH8CAEzZx5uhVsU5qsyisKENdtl8wxhKm02mdf0exzNP8qw4AwAA57fK7c1Q28oghWZR2NCGbYbjiXzFGEqbZLrNOIf7W5zdBQCYim2SpxmOQ61Lk9SaRWFDO/6e6Zan9xpLafNLdQC6NYsrwAEApuB1kj/G3oxZFDa0YxtTNncaS2mzqg5A15ZJLoozAABwGqsMR6Gmumj4U7MobGiLKZt7jKW02cReGw7zJpYSAwCMySbJD3EU6qNZFDa0ZRtTNvcaS2mTmLbhMLMMt0kBANC3bYZbof6Y5Lo0STtmUdjQHlM2OxhTaWOvDYd6luGoFAAAffpY1rwoztGSWRQ2tGcbUzY7GVNpc10dgFFwTAoAoD9XuS1rtpVBGjOLwoY2mbLZ0ZhKm22cVeVw8zgmBQDQi6sMZc3T2HH5pUWSf0ZhQ3u2MWWzszGVNom9NhzHs7hNCgCgZasMC4aVNV+3yDBhM6+NAV9lymYPYytt/rs6AKPhmBQAQHtWGcqa7+MN229ZZihsZrUx4Ku2MWWzl7GVNqto7DiOWZKfqkMAAJBkOAb15yhr7nMZhQ1texmv2fcyttIm8UWc41nGzQMAAJWucruzZl2apH0vMkyLQ6s2MWWztzGWNo5IcUw/xvI2AIBz2mZ4YWfB8O7exGUatO9ldYAe/e7Dhw/VGQ7y7u2jL39pluR/z5+EEdtmeNKwrY3BV/T9BQwA+NQmw4LSq3jetatZhiP9y9oYcK9NhtdUB3n85P3hSTozxkmbbYxOclyz2G8DAHAqqwwTNX/MMGGzLczSk0WG/TXL2hiwk6fVAXo1xtImSf5RHYDRWSZ5VR0CAGAktvl8ufBVYZYeLTMUNovaGLCTVeyefbCxljbX1QEYpWcZNvIDAPAw17mdqrFc+GGexQ1R9MUumwP8vjrAiWxuHvPSFIzRqwxPLta1MQAAurDJ8A77LxkKm21dlO7NMjwXvayNAXu5iimbg4y1tEmGbwrPijMwPrMM72z8OW4yAAD40irDm1v/uvnxpi7KqMwz7Fhc1MaAvWxjyuZgYy5t/hGlDacxy/BN8/t4twgAmJ51bi//+L/cljObmjijt8zw3HNWGwP29vf4unCwMZc26zgixeksclvcAAD0bp3bN6O2GSZlks/LmNX54nDjRZIfq0PAA2wz3AbHgcZc2iSOSHFayyRv4vo6AOD8Vt/49U2S/9nh92/iHfCWzTK8QbisjQEP9jxOJRzF2EsbR6Q4tcubj4obAOjTNoddMLDOcERoV5vsVpas4wXPVC3jOBR9W2VYQMwRjL20WccRKU7vMsONCFe1MQA4oU3ankrY5OvTFee0znlKhk3a/ncBh3gRx6Hon+XDRzT20iYZpm184ePU3tx8vKoMAWe2Sd8vnLa53dnQo20Omw5owao6AEAj5hmeTy5rY8DBruL7+1H97sOHD9UZDvLu7aP7fss8ya+nTwJJhmNSV9UhJmRZHeBA68dP3m8f+od3+PoHALTvIkNhM6uNAQfbJvljTjh1+fjJ+1P91c2awqTNJsM7kYvSFEyFiZvzWlUHOMQUv+kAAP82y/Dc8aI2BhzNy9jFdXT/UR3gTP5RHYBJeZPbBcUAAPClZZJ/RmHDeGziiu+TmEppc1UdgMlR3AAA8KVZkldJfo7LUhgXt+meyFRKm22S6+IMTI/iBgCAj5YZpmue1caAo7tK52sLWjaV0iZxRIoaihsAgGmbxXQN47VN8rw6xJhNqbS5jqVI1HiT2wXFAABMx0WGm2yf1caAk7F8+MSmVNokdttQ5zKKGwCAqZgn+enmMStNAqeziuXDJze10ubv1QGYtMsMY7Gz2hgAAJzQs7gZimlwLOoMplbabGJBErWWUdwAAIzRMkNZ8yqe6zF+L5Osq0NMwdRKm8RCYuotMpxtXtTGAADgCGYZjsH/HM/vmIZNHIs6mymWNlexKIl6swzf2C9rYwAAcIAXGd6Mu6yNAWf1NF5Tn80US5vEQmLaMMvwrsyr4hwAAOznIkNZ82MchWJaXsfKkbOaamljITEteRZ7bgAAerDM8Lztpww3RMGUbDPssuGMplrabKIdpC3LDIvrFrUxAAD4inlu99YsS5NAHceiCky1tElM29CeeYbi5lltDAAAbswyHGW3t4apu755cGZTLm2uM0zcQGtexXEpAIBKs9wuGX5WGQQasM0wZUOBKZc2iWkb2rXM8CThojYGAMCkzHJb1lgyDAPHogpNvbS5iv/4aNcsw5K7V/GEAQDglGZR1sDXXMexqFJTL222cf037XuWYdfNsjYGAMDozKKsgW/ZxLGoclMvbRJHpOjDPMOeG1M3AACHm0dZA/dxLKoBSpuhPbwqzgC7eha7bgAAHmqe4epuZQ3c7XWSVXEGorT56B/VAWAPswy7bn7O8MQDAIC7LTM8f3J1N9xvneRldQgGSpvBKlpE+rPM8MTjRbxLBADwNZcZdgP+HJPKsCvHohqitLmlSaRXP8a7RgAAH81zu6/mTZJFYRbozcsMkzY0QmlzaxX/cdKvWYYnJW6ZAgCmapnP99XMK8NAh1YZCk8aorT5nJuk6N0iw/jvz1HeAADjN8vtRQ0/x+QxPNQ2rvduktLmc1cZbpOC3i2jvAEAxusiw1TN/yZ5FVM1cKin8Vq4SUqb37LbhjFZRnkDAIzDPENB82uGm6AuK8PAiFwluS7OwDcobX7rKhpGxmcZ5Q0A0J9ZhuNP/8xQ1jyLqRo4pnWS59Uh+DalzdeZtmGsllHeAABtm2WYovkpt8efFnVxYLS2cb1385Q2X3cV0zaM2zLKGwCgLRe5vf3pzc3PgdN5HjcoN09p822mbZiCZYbi5tc4Fw4AnN8itwuFP+6pmdXFgcm4unnQOKXNt13FtA3TMc/tO1uXpUkAgLFb5Hah8D+jqIFzW8cem24obe7mP2SmZh7lDQBwfPPcLhT+ZywUhirb2GPTFaXN3a6TrIozQIV5lDcAwGFmGZ5HfDyKbaEw1LPHpjNKm/vZbcOUzaO8AQD2c5nbm5/exKUH0Iqr2GPTHaXN/VYxbQPzKG8AgG+7yO1CYTc/QXvWGY5F0RmlzW7stoHBPMobAGCwyHDkyc1P0LZtkh+qQ/Awv/vw4UN1hoO8e/voXP+oN/EiFb60iVvWAGCK5rFIGHrxfUZyeuTxk/fVEc7u99UBOvIyw5jnrDYGNGUeT9gAAKBVzzOSwmaqHI/a3SbJ36tDAAAAwA6ukrwuzsCBlDb7eR332QMAANC2dexmHQWlzX628R8+AAAA7dpmWDy8rY3BMSht9ncVZwIBAABo0w9xWchoKG0e5mV1AAAAAPjC0xgyGBWlzcOsMkzcAAAAQAuu4nXq6ChtHu55nBEEAACg3irDlA0jo7R5uG0ckwIAAKDWOsMeG0ZIaXOY1xk+QQAAAODcthkmbLa1MTgVpc3hXAEOAABAhe9jkGDUlDaHW2WYuAEAAIBzeRqFzegpbY7jZYyjAQAAcB7P46aoSVDaHMc2NnUDAABweldx2mMylDbHc33zAAAAgFO4joGBSVHaHJet3QAAAJzCOgqbyVHaHNc2w34bAAAAOJZ1hpuitrUxODelzfG9znCjFAAAABxqG6c6Jktpcxo+oQAAADjUNsOEzbo2BlWUNqexiWNSAAAAHEZhM3FKm9N5HbdJAQAA8DBPo7CZPKXNaTkmBQAAwL6eJrmqDkE9pc1pbeNKNgAAAHansOHflDandx2fcAAAANzvdbx+5BNKm/N4nmE5MQAAAHzNVYbXjvBvSpvz2Cb5oToEAAAATbqK1Rp8hdLmfNZxDTgAAACfu4rChm9Q2pzXiySr4gwAAAC04SoKG+6gtDm/H+IacAAAgKm7isKGeyhtzm8b+20AAACm7CoKG3agtKmxiv02AAAAU3QVhQ07UtrUeRH7bQAAAKbkKgob9qC0qWW/DQAAwDRcRWHDnpQ2tbax3wYAAGDsrqKw4QGUNvVWSZ5XhwAAAOAkrqKw4YGUNm14neETGQAAgPG4isKGAyht2vE8ybo6BAAAAEdxFYUNB1LatGMbi4kBAADG4CoKG45AadOWTSwmBgAA6NnTKGw4EqVNe1bxCQ4AANCjp7GvlCNS2rTpKj7RAQAAeqKw4eiUNu16mmHqBgAAgHZtk3wfhQ0noLRp2w9xoxQAAECrthkKm1VtDMZKadO2bdwoBQAA0KJNhsJmXRuDMVPatG+T4QvBtjYGAAAAN9ZJ/hyFDSemtOnDOsnz6hAAAABkHW+scyZKm35cxVXgAAAAla4yTNhsa2MwFUqbvlwleV2cAQAAYIpexxvpnNnvqwOwt+dJZkkua2MAAABMxtO40psCJm369DTJdXUIAACAkdtm2F9zVRuDqVLa9OtpbCoHAAA4lU2GwmZVG4MpU9r0a5vhC8i6NgYAAMDorONKbxqgtOnbNoobAACAY7qKG6JohNKmf9sobgAAAI7hedwQRUOUNuOwzfCFZVsbAwAAoEvbJD9kuNYbmqG0GY91hombbW0MAACArqwzvJa6ro0Bv6W0GZd1FDcAAAC7WsW6CRqmtBmfdRQ3AAAA93kdr51onNJmnNbxxQcAAOBrthl2gj4vzgH3UtqM1zqKGwAAgE+tM7xOuqqNAbtR2ozbOoobAACAZFg0bH8NXVHajN86vjABAADT9jzDld7b4hywF6XNNKyjuAEAAKZnm+G10OvaGPAwSpvp2EZxAwAATMcqyR9vPkKXlDbTso3iBgAAGL+Xsd+TEVDaTM82tqUDAADjtM3weudFbQw4DqXNNG2TPI3iBgAAGI/rOA7FyChtpu1pLOQCAAD653YoRklpw/MM5Q0AAEBv1kn+HG9GM1JKG5LhmNTTaKUBAIB+vI6LVhg5pQ0fXcV2dQAAoH3bDEehnsfrF0ZOacOn1hlGC9e1MQAAAL7qOsOy4evaGHAeShu+tMkwcbOqjQEAAPBv21g2zAQpbfiabYbi5qo2BgAAQFaxbJiJUtpwl6dxsxQAAFDneYY3lDfFOaCE0ob7XGVotbe1MQAAgAlZx3QNKG3YyToWFAMAAKe3TfIyXn9AEqUNu9vEnhsAAOB0VhnKmhe1MaAdShv2sc2w4+Z5cQ4AAGA8trG7Br5KacNDvI49NwAAwOFWsbsGvklpw0Otk/wxwxdZAACAfWyT/BDTNXAnpQ2H2Gb4IvuyOAcAANCP1xneAL6ujQHtU9pwDC8ylDfb2hgAAEDD1hleNzyP1w6wE6UNx7KK41IAAMBvbXN7jfeqNAl0RmnDMW3juBQAAHDrOq7xhgdT2nAKLzJ8Yd7UxgAAAIpsMryh+0O8LoAHU9pwKuu4ug8AAKZmm2Hy3uoEOAKlDae0zbBk7IdYNAYAAGN3laGseVEbA8ZDacM5XMeVfgAAMFarDEehnsabtXBUShvOZZth4sbUDQAAjMMmQ1HzfRyFgpNQ2nBu13HVHwAA9Gyb2701V6VJYOSUNlTY5HaT/LY0CQAAsI/XsbcGzkZpQ6Xr2HUDAAA9uM7w3P15vPEKZ6O0odo2t7tuNqVJAACAL61yOyW/KU0CE6S0oRXXGXbdvK6NAQAAJFlnKGssGYZCShtass0wbvnnDN8kAACA89pkuBHK5SHQAKUNLVpn+CbhvCwAAJzHJkNZ40YoaIjShpa9jm8aAABwSpsoa6BZShtat83wTcRZWgAAOJ5NlDXQPKUNvVhlKG6expEpAAB4qE2UNdANpQ29ucrwDeZllDcAALCrTZQ10B2lDT3aJnmRYVnxVWUQAABo3CrKGuiW0oaebeI6QgAA+JpVhvUC30dZA91S2jAG69x+Q1qVJgEAgFpXGd7U9NwYRkBpw5iscruseFOaBAAAzmeb5HWGI1BPM7ypCYyA0oYxusrtN6xNaRIAADidTZLnGZ77Po/nvjA6ShvG7CrKGwAAxmeV5IcMz3Vfx62qMFpKG6bgKsobAAD6ts3n+2quC7MAZ6K0YUquorwBAKAvm9wegbKvBiZGacMUXcU3PQAA2nadYaLGESiYMKUNU3YV1yECANCOTZKXGYqaH+I5Kkze76sDQANWN49Fkr8luayLAgDABF0l+e/YUwN8waQN3FpnODL1xwzvcGwrwwAAMGrrDLtq/ivDc9DryjBAm5Q28FubJC9y+w10XZgFAIDx2GbYT/Pnm8freKMQuIPSBu52ldu9N1elSQAA6NVVhh01/5VhumZdGQbox+8+fPhQneEg794+qo7AtMwz7Lz5682PAQDga65zu6dmWxkExuLxk/fVEc5OaQMPd5GhvLmojQEAQCPWSf6RYbJmWxkExmiKpY3bo+Dhrm8eswzTN3+L6RsAgKlZZyhqrjPsRgQ4GpM2cFyLDOXNRYYyBwCA8Vnl9ujTpjIITMkUJ22UNnA6F3F8CgBgLK5jRw2UmmJp43gUnM51bo9PXST5SxQ4AAC92Obzogbg7EzawHnNosABAGjVOrclzboyCPBbU5y0UdpAnVkUOAAAlbYZCppf4tgTNE9p0yGlDSMxS7LMbYEzq4sCADBqqwzTNKuYpoGuKG06pLRhpJYZCpxlhhupAAB4mHVuS5pVZRDgMFMsbSwihjatcvukYp7PS5zZ+eMAAHRjleG40/rmx9u6KACHMWkD/VlkOEL1XYYSBwBgqrYZyplfYpIGRs+kDdCDdT4/f728eShxAICxW+e2pPn4Y4DRUtpA/1b5/F2l5c3jT3GcCgDo1yZDKfOvmKIBJkppA+OzyudPauYZjlQtMkzjLKLIAQDass5tQfPxx9uqMACtUNrA+G1uHtef/Nost0XOLEOZ8/HXAABOYZvbMuZfuZ2kWdfEAWif0gamaZtvjxnPv3j8Z27LnEVM6QDA1G3z26JlneT/Pvn56ov/bXu6OADjpbQBvrS5edxn+Y0f/yFD2fPRLCZ4AOAc1rm7HFnn82Jllz+7yW7PCwA4AaUN8FCrb/x4F4t8fWJn+Y3f/+m0z7fM83lZBAD72OawYzq/nPCft8/vBWBElDZAhfU3fn11pn/+PIcVPIuc/pjYn87wz6i0yLj/76Nvm4xzsmDfUuGY1jnd8ZhNzvzv6/GT9wf9+XdvHx0pCQBjp7QBpmiTw57gr44RwpN+AADgLv9RHQAAAACA31LaAAAAADRIaQMAAADQIKUNAAAAQIOUNgAAAAANUtoAAAAANEhpAwAAANAgpQ0AAABAg5Q2AAAAAA1S2gAAAAA0SGkDAAAA0CClDQAAAECDlDYAAAAADVLaAAAAADRIaQMAAADQIKUNAAAAQIOUNgAAAAANUtoAAAAANEhpAwAAANAgpQ0AAABAg5Q2AAAAAA1S2gAAAAA0SGkDAAAA0CClDQAAAECDlDYAAAAADVLaAAAAADRIaQMAAADQIKUNAAAAQIOUNgAAAAANUtoAAAAANEhpAwAAANAgpQ0AAABAg5Q2AAAAAA1S2gAAAAA0SGkDAAAA0CClDQAAAECDlDYAAAAADVLaAAAAADRIaQMAAADQIKUNAAAAQIN+Xx0A4AA/Vwc4xLu3j6ojAEzF99UBAOAhlDZAz5bVAQAAAE7F8SgAAACABiltAAAAABqktAEAAABokNIGAAAAoEFKGwAAAIAGKW0AAAAAGqS0AQAAAGiQ0gYAAACgQUobAAAAgAYpbQAAAAAapLQBAAAAaJDSBgAAAKBBShsAAACABiltAAAAABqktAEAAABokNIGAAAAoEFKGwAAAIAGKW0AAAAAGqS0AQAAAGiQ0gYAAACgQUobAAAAgAYpbQAAAAAapLQBAAAAaJDSBgAAAKBBShsAAACABiltAAAAABqktAEAAABokNIGAAAAoEFKGwAAAIAGKW0AAAAAGqS0AQAAAGiQ0gYAAACgQUobAAAAgAYpbQAAAAAapLQBAAAAaJDSBgAAAKBBShsAAACABiltAAAAABqktAEAAABokNIGAAAAoEFKGwAAAIAGKW0AAAAAGqS0AQAAAGiQ0gYAAACgQUobAAAAgAYpbQAAAAAapLQBAAAAaJDSBgAAAKBBShsAAACABiltAAAAABqktAEAAABokNIGAAAAoEFKGwAAAIAGKW0AAAAAGqS0AQAAAGiQ0gYAAACgQUobAAAAgAYpbQAAAAAapLQBAAAAaJDSBgAAAKBBShsAAACABiltAAAAABqktAEAAABokNIGAAAAoEFKGwAAAIAGKW0AAAAAGqS0AQAAAGiQ0gYAAACgQUobAAAAgAYpbQAAAAAapLQBAAAAaJDSBgAAAKBBShsAAACABiltAAAAABqktAEAAABokNIGAAAAoEFKGwAAAIAGKW0AAAAAGqS0AQAAAGiQ0gYAAACgQUobAAAAgAYpbQAAAAAapLQBAAAAaJDSBgAAAKBBShsAAACABiltAAAAABqktAEAAABokNIGAAAAoEFKGwAAAIAGKW0AAAAAGqS0AQAAAGiQ0gYAAACgQUobAAAAgAYpbQAAAAAapLQBAAAAaJDSBgAAAKBBShsAAACABiltAAAAABqktAEAAABokNIGAAAAoEFKGwAAAIAGKW0AAAAAGqS0AQAAAGiQ0gYAAACgQUobAAAAgAYpbQAAAAAapLQBAAAAaJDSBgAAAKBBShsAAACABiltAAAAABqktAEAAABokNIGAAAAoEFKGwAAAIAGKW0AAAAAGqS0AQAAAGiQ0gYAAACgQUobAAAAgAYpbQAAAAAapLQBAAAAaJDSBgAAAKBBShsAAACABiltAAAAABqktAEAAABokNIGAAAAoEFKGwAAAIAGKW0AAAAAGqS0AQAAAGiQ0gYAAACgQUobAAAAgAYpbQAAAAAapLQBAAAAaJDSBgAAAKBBv/vw4UN1BgAAAAC+YNIGAAAAoEFKGwAAAIAGKW0AAAAAGqS0AQAAAGiQ0gYAAACgQUobAAAAgAYpbQAAAAAapLQBAAAAaJDSBgAAAKBBShsAAACABiltAAAAABqktAEAAABokNIGAAAAoEFKGwAAAIAGKW0AAAAAGqS0AQAAAGiQ0gYAAACgQUobAAAAgAYpbQAAAAAapLQBAAAAaJDSBgAAAKBBShsAAACABiltAAAAABqktAEAAABokNIGAAAAoEFKGwAAAIAGKW0AAAAAGqS0AQAAAGiQ0gYAAACgQUobAAAAgAYpbQAAAAAapLQBAAAAaJDSBgAAAKBBShsAAACABiltAAAAABqktAEAAABokNIGAAAAoEFKGwAAAIAGKW0AAAAAGqS0AQAAAGiQ0gYAAACgQUobAAAAgAYpbQAAAAAapLQBAAAAaJDSBgAAAKBBShsAAACABiltAAAAABqktAEAAABokNIGAAAAoEFKGwAAAIAGKW0AAAAAGqS0AQAAAGiQ0gYAAACgQf8PASlwIILbYWUAAAAASUVORK5CYII="})])],-1)),q3=Gl(()=>zt("div",{class:"logoText"},[zt("svg",{width:"163",height:"23",viewBox:"0 0 163 23",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[zt("path",{d:"M14.1751 12.52H18.9001V20.35C17.8201 21.124 16.5781 21.718 15.1741 22.132C13.7701 22.546 12.366 22.753 10.962 22.753C8.98205 22.753 7.20005 22.339 5.61605 21.511C4.03205 20.665 2.79005 19.495 1.89005 18.001C0.990048 16.507 0.540048 14.815 0.540048 12.925C0.540048 11.035 0.990048 9.343 1.89005 7.849C2.79005 6.355 4.04105 5.194 5.64305 4.366C7.24505 3.52 9.05405 3.097 11.07 3.097C12.834 3.097 14.418 3.394 15.8221 3.988C17.2261 4.582 18.3961 5.437 19.3321 6.553L15.9301 9.631C14.6521 8.227 13.1221 7.525 11.34 7.525C9.72005 7.525 8.41505 8.02 7.42505 9.01C6.43505 9.982 5.94005 11.287 5.94005 12.925C5.94005 13.969 6.16505 14.905 6.61505 15.733C7.06505 16.543 7.69505 17.182 8.50505 17.65C9.31505 18.1 10.242 18.325 11.286 18.325C12.312 18.325 13.2751 18.118 14.1751 17.704V12.52ZM26.9334 9.496C27.4554 8.83 28.1304 8.335 28.9584 8.011C29.8044 7.669 30.7674 7.498 31.8474 7.498V12.115C31.3794 12.061 30.9924 12.034 30.6864 12.034C29.5884 12.034 28.7244 12.331 28.0944 12.925C27.4824 13.519 27.1764 14.428 27.1764 15.652V22.375H22.0464V7.741H26.9334V9.496ZM41.1765 22.618C39.6105 22.618 38.1975 22.294 36.9375 21.646C35.6775 20.998 34.6875 20.098 33.9675 18.946C33.2655 17.794 32.9145 16.489 32.9145 15.031C32.9145 13.591 33.2655 12.295 33.9675 11.143C34.6875 9.991 35.6685 9.1 36.9105 8.47C38.1705 7.822 39.5925 7.498 41.1765 7.498C42.7605 7.498 44.1825 7.822 45.4425 8.47C46.7025 9.1 47.6835 9.991 48.3855 11.143C49.0875 12.277 49.4385 13.573 49.4385 15.031C49.4385 16.489 49.0875 17.794 48.3855 18.946C47.6835 20.098 46.7025 20.998 45.4425 21.646C44.1825 22.294 42.7605 22.618 41.1765 22.618ZM41.1765 18.541C42.0765 18.541 42.8145 18.235 43.3905 17.623C43.9665 16.993 44.2545 16.129 44.2545 15.031C44.2545 13.951 43.9665 13.105 43.3905 12.493C42.8145 11.881 42.0765 11.575 41.1765 11.575C40.2765 11.575 39.5385 11.881 38.9625 12.493C38.3865 13.105 38.0985 13.951 38.0985 15.031C38.0985 16.129 38.3865 16.993 38.9625 17.623C39.5385 18.235 40.2765 18.541 41.1765 18.541ZM57.134 22.618C55.91 22.618 54.704 22.483 53.516 22.213C52.328 21.925 51.374 21.556 50.654 21.106L52.193 17.596C52.859 18.01 53.651 18.343 54.569 18.595C55.487 18.829 56.396 18.946 57.296 18.946C58.124 18.946 58.709 18.865 59.051 18.703C59.411 18.523 59.591 18.271 59.591 17.947C59.591 17.623 59.375 17.398 58.943 17.272C58.529 17.128 57.863 16.993 56.945 16.867C55.775 16.723 54.776 16.534 53.948 16.3C53.138 16.066 52.436 15.634 51.842 15.004C51.248 14.374 50.951 13.492 50.951 12.358C50.951 11.422 51.23 10.594 51.788 9.874C52.346 9.136 53.156 8.56 54.218 8.146C55.298 7.714 56.585 7.498 58.079 7.498C59.141 7.498 60.194 7.606 61.238 7.822C62.282 8.038 63.155 8.344 63.857 8.74L62.318 12.223C61.022 11.503 59.618 11.143 58.106 11.143C57.296 11.143 56.702 11.242 56.324 11.44C55.946 11.62 55.757 11.863 55.757 12.169C55.757 12.511 55.964 12.754 56.378 12.898C56.792 13.024 57.476 13.159 58.43 13.303C59.636 13.483 60.635 13.69 61.427 13.924C62.219 14.158 62.903 14.59 63.479 15.22C64.073 15.832 64.37 16.696 64.37 17.812C64.37 18.73 64.091 19.558 63.533 20.296C62.975 21.016 62.147 21.583 61.049 21.997C59.969 22.411 58.664 22.618 57.134 22.618ZM71.8996 22.618C70.6756 22.618 69.4696 22.483 68.2816 22.213C67.0936 21.925 66.1396 21.556 65.4196 21.106L66.9586 17.596C67.6246 18.01 68.4166 18.343 69.3346 18.595C70.2526 18.829 71.1616 18.946 72.0616 18.946C72.8896 18.946 73.4746 18.865 73.8166 18.703C74.1766 18.523 74.3566 18.271 74.3566 17.947C74.3566 17.623 74.1406 17.398 73.7086 17.272C73.2946 17.128 72.6286 16.993 71.7106 16.867C70.5406 16.723 69.5416 16.534 68.7136 16.3C67.9036 16.066 67.2016 15.634 66.6076 15.004C66.0136 14.374 65.7166 13.492 65.7166 12.358C65.7166 11.422 65.9956 10.594 66.5536 9.874C67.1116 9.136 67.9216 8.56 68.9836 8.146C70.0636 7.714 71.3506 7.498 72.8446 7.498C73.9066 7.498 74.9596 7.606 76.0036 7.822C77.0476 8.038 77.9206 8.344 78.6226 8.74L77.0836 12.223C75.7876 11.503 74.3836 11.143 72.8716 11.143C72.0616 11.143 71.4676 11.242 71.0896 11.44C70.7116 11.62 70.5226 11.863 70.5226 12.169C70.5226 12.511 70.7296 12.754 71.1436 12.898C71.5576 13.024 72.2416 13.159 73.1956 13.303C74.4016 13.483 75.4006 13.69 76.1926 13.924C76.9846 14.158 77.6686 14.59 78.2446 15.22C78.8386 15.832 79.1356 16.696 79.1356 17.812C79.1356 18.73 78.8566 19.558 78.2986 20.296C77.7406 21.016 76.9126 21.583 75.8146 21.997C74.7346 22.411 73.4296 22.618 71.8996 22.618ZM90.2292 3.475C91.9392 3.475 93.4242 3.763 94.6842 4.339C95.9442 4.897 96.9162 5.707 97.6002 6.769C98.2842 7.813 98.6262 9.046 98.6262 10.468C98.6262 11.89 98.2842 13.123 97.6002 14.167C96.9162 15.211 95.9442 16.021 94.6842 16.597C93.4242 17.155 91.9392 17.434 90.2292 17.434H86.9352V22.375H81.5892V3.475H90.2292ZM89.9052 13.222C91.0032 13.222 91.8312 12.988 92.3892 12.52C92.9472 12.034 93.2262 11.35 93.2262 10.468C93.2262 9.586 92.9472 8.902 92.3892 8.416C91.8312 7.93 91.0032 7.687 89.9052 7.687H86.9352V13.222H89.9052ZM106.009 9.496C106.531 8.83 107.206 8.335 108.034 8.011C108.88 7.669 109.843 7.498 110.923 7.498V12.115C110.455 12.061 110.068 12.034 109.762 12.034C108.664 12.034 107.8 12.331 107.17 12.925C106.558 13.519 106.252 14.428 106.252 15.652V22.375H101.122V7.741H106.009V9.496ZM120.252 22.618C118.686 22.618 117.273 22.294 116.013 21.646C114.753 20.998 113.763 20.098 113.043 18.946C112.341 17.794 111.99 16.489 111.99 15.031C111.99 13.591 112.341 12.295 113.043 11.143C113.763 9.991 114.744 9.1 115.986 8.47C117.246 7.822 118.668 7.498 120.252 7.498C121.836 7.498 123.258 7.822 124.518 8.47C125.778 9.1 126.759 9.991 127.461 11.143C128.163 12.277 128.514 13.573 128.514 15.031C128.514 16.489 128.163 17.794 127.461 18.946C126.759 20.098 125.778 20.998 124.518 21.646C123.258 22.294 121.836 22.618 120.252 22.618ZM120.252 18.541C121.152 18.541 121.89 18.235 122.466 17.623C123.042 16.993 123.33 16.129 123.33 15.031C123.33 13.951 123.042 13.105 122.466 12.493C121.89 11.881 121.152 11.575 120.252 11.575C119.352 11.575 118.614 11.881 118.038 12.493C117.462 13.105 117.174 13.951 117.174 15.031C117.174 16.129 117.462 16.993 118.038 17.623C118.614 18.235 119.352 18.541 120.252 18.541ZM136.479 8.281H139.962V12.115H136.614V22.375H131.484V12.115H129.351V8.281H131.484V7.903C131.484 6.121 132.015 4.708 133.077 3.664C134.157 2.62 135.66 2.098 137.586 2.098C138.234 2.098 138.864 2.161 139.476 2.287C140.088 2.413 140.592 2.602 140.988 2.854L139.719 6.472C139.215 6.184 138.702 6.04 138.18 6.04C137.64 6.04 137.217 6.202 136.911 6.526C136.623 6.85 136.479 7.327 136.479 7.957V8.281ZM144.012 7.741H149.142V22.375H144.012V7.741ZM146.577 6.121C145.641 6.121 144.885 5.86 144.309 5.338C143.733 4.816 143.445 4.168 143.445 3.394C143.445 2.62 143.733 1.972 144.309 1.45C144.885 0.927996 145.641 0.666996 146.577 0.666996C147.513 0.666996 148.269 0.918996 148.845 1.423C149.421 1.909 149.709 2.539 149.709 3.313C149.709 4.123 149.421 4.798 148.845 5.338C148.269 5.86 147.513 6.121 146.577 6.121ZM162.557 21.781C162.125 22.051 161.594 22.258 160.964 22.402C160.352 22.546 159.695 22.618 158.993 22.618C157.085 22.618 155.618 22.15 154.592 21.214C153.566 20.278 153.053 18.883 153.053 17.029V12.115H150.92V8.281H153.053V4.474H158.183V8.281H161.531V12.115H158.183V16.975C158.183 17.497 158.318 17.911 158.588 18.217C158.876 18.505 159.254 18.649 159.722 18.649C160.316 18.649 160.838 18.496 161.288 18.19L162.557 21.781Z",fill:"#182061"})]),zt("svg",{width:"98",height:"6",viewBox:"0 0 98 6",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[zt("path",{d:"M2.53961 3.20825H1.45961V5.375H0.973605V0.649999H1.45961V2.7695H2.53961L4.13936 0.649999H4.67936L2.92436 2.945L4.78061 5.375H4.20686L2.53961 3.20825ZM7.06126 5.40875C6.71926 5.40875 6.41101 5.33225 6.13651 5.17925C5.86201 5.02175 5.64601 4.80575 5.48851 4.53125C5.33101 4.25675 5.25226 3.94625 5.25226 3.59975C5.25226 3.25325 5.33101 2.94275 5.48851 2.66825C5.64601 2.39375 5.86201 2.18 6.13651 2.027C6.41101 1.874 6.71926 1.7975 7.06126 1.7975C7.40326 1.7975 7.71151 1.874 7.98601 2.027C8.26051 2.18 8.47426 2.39375 8.62726 2.66825C8.78476 2.94275 8.86351 3.25325 8.86351 3.59975C8.86351 3.94625 8.78476 4.25675 8.62726 4.53125C8.47426 4.80575 8.26051 5.02175 7.98601 5.17925C7.71151 5.33225 7.40326 5.40875 7.06126 5.40875ZM7.06126 4.9835C7.31326 4.9835 7.53826 4.92725 7.73626 4.81475C7.93876 4.69775 8.09626 4.5335 8.20876 4.322C8.32126 4.1105 8.37751 3.86975 8.37751 3.59975C8.37751 3.32975 8.32126 3.089 8.20876 2.8775C8.09626 2.666 7.93876 2.504 7.73626 2.3915C7.53826 2.2745 7.31326 2.216 7.06126 2.216C6.80926 2.216 6.58201 2.2745 6.37951 2.3915C6.18151 2.504 6.02401 2.666 5.90701 2.8775C5.79451 3.089 5.73826 3.32975 5.73826 3.59975C5.73826 3.86975 5.79451 4.1105 5.90701 4.322C6.02401 4.5335 6.18151 4.69775 6.37951 4.81475C6.58201 4.92725 6.80926 4.9835 7.06126 4.9835ZM10.0903 1.8245H10.5695V3.39725H12.8038V1.8245H13.283V5.375H12.8038V3.809H10.5695V5.375H10.0903V1.8245ZM16.3327 5.40875C15.9817 5.40875 15.6667 5.33225 15.3877 5.17925C15.1132 5.02625 14.8972 4.8125 14.7397 4.538C14.5822 4.259 14.5035 3.94625 14.5035 3.59975C14.5035 3.25325 14.5822 2.94275 14.7397 2.66825C14.8972 2.39375 15.1132 2.18 15.3877 2.027C15.6667 1.874 15.9817 1.7975 16.3327 1.7975C16.6387 1.7975 16.911 1.85825 17.1495 1.97975C17.3925 2.09675 17.5837 2.27 17.7232 2.4995L17.3655 2.7425C17.2485 2.567 17.1 2.4365 16.92 2.351C16.74 2.261 16.5442 2.216 16.3327 2.216C16.0762 2.216 15.8445 2.2745 15.6375 2.3915C15.435 2.504 15.2752 2.666 15.1582 2.8775C15.0457 3.089 14.9895 3.32975 14.9895 3.59975C14.9895 3.87425 15.0457 4.11725 15.1582 4.32875C15.2752 4.53575 15.435 4.69775 15.6375 4.81475C15.8445 4.92725 16.0762 4.9835 16.3327 4.9835C16.5442 4.9835 16.74 4.94075 16.92 4.85525C17.1 4.76975 17.2485 4.63925 17.3655 4.46375L17.7232 4.70675C17.5837 4.93625 17.3925 5.11175 17.1495 5.23325C16.9065 5.35025 16.6342 5.40875 16.3327 5.40875ZM20.0754 1.7975C20.5389 1.7975 20.8944 1.9145 21.1419 2.1485C21.3894 2.378 21.5132 2.72 21.5132 3.1745V5.375H21.0542V4.8215C20.9462 5.006 20.7864 5.15 20.5749 5.2535C20.3679 5.357 20.1204 5.40875 19.8324 5.40875C19.4364 5.40875 19.1214 5.31425 18.8874 5.12525C18.6534 4.93625 18.5364 4.6865 18.5364 4.376C18.5364 4.0745 18.6444 3.8315 18.8604 3.647C19.0809 3.4625 19.4297 3.37025 19.9067 3.37025H21.0339V3.15425C21.0339 2.84825 20.9484 2.6165 20.7774 2.459C20.6064 2.297 20.3567 2.216 20.0282 2.216C19.8032 2.216 19.5872 2.25425 19.3802 2.33075C19.1732 2.40275 18.9954 2.504 18.8469 2.6345L18.6309 2.27675C18.8109 2.12375 19.0269 2.00675 19.2789 1.92575C19.5309 1.84025 19.7964 1.7975 20.0754 1.7975ZM19.9067 5.03075C20.1767 5.03075 20.4084 4.97 20.6019 4.8485C20.7954 4.7225 20.9394 4.5425 21.0339 4.3085V3.728H19.9202C19.3127 3.728 19.0089 3.9395 19.0089 4.3625C19.0089 4.5695 19.0877 4.73375 19.2452 4.85525C19.4027 4.97225 19.6232 5.03075 19.9067 5.03075ZM25.894 1.8245V5.375H25.4147V2.24975H23.7137L23.6665 3.12725C23.6305 3.86525 23.545 4.43225 23.41 4.82825C23.275 5.22425 23.0342 5.42225 22.6877 5.42225C22.5932 5.42225 22.4785 5.40425 22.3435 5.36825L22.3772 4.9565C22.4582 4.9745 22.5145 4.9835 22.546 4.9835C22.7305 4.9835 22.87 4.898 22.9645 4.727C23.059 4.556 23.122 4.3445 23.1535 4.0925C23.185 3.8405 23.212 3.5075 23.2345 3.0935L23.2952 1.8245H25.894ZM29.9564 2.24975H28.6131V5.375H28.1339V2.24975H26.7906V1.8245H29.9564V2.24975ZM30.8518 1.8245H31.331V4.646L33.7003 1.8245H34.1255V5.375H33.6463V2.5535L31.2838 5.375H30.8518V1.8245ZM35.7015 1.8245H36.1808V3.39725H38.415V1.8245H38.8943V5.375H38.415V3.809H36.1808V5.375H35.7015V1.8245ZM42.9699 2.24975H40.9382V5.375H40.4589V1.8245H42.9699V2.24975ZM45.165 5.40875C44.823 5.40875 44.5148 5.33225 44.2403 5.17925C43.9658 5.02175 43.7498 4.80575 43.5923 4.53125C43.4348 4.25675 43.356 3.94625 43.356 3.59975C43.356 3.25325 43.4348 2.94275 43.5923 2.66825C43.7498 2.39375 43.9658 2.18 44.2403 2.027C44.5148 1.874 44.823 1.7975 45.165 1.7975C45.507 1.7975 45.8153 1.874 46.0898 2.027C46.3643 2.18 46.578 2.39375 46.731 2.66825C46.8885 2.94275 46.9673 3.25325 46.9673 3.59975C46.9673 3.94625 46.8885 4.25675 46.731 4.53125C46.578 4.80575 46.3643 5.02175 46.0898 5.17925C45.8153 5.33225 45.507 5.40875 45.165 5.40875ZM45.165 4.9835C45.417 4.9835 45.642 4.92725 45.84 4.81475C46.0425 4.69775 46.2 4.5335 46.3125 4.322C46.425 4.1105 46.4813 3.86975 46.4813 3.59975C46.4813 3.32975 46.425 3.089 46.3125 2.8775C46.2 2.666 46.0425 2.504 45.84 2.3915C45.642 2.2745 45.417 2.216 45.165 2.216C44.913 2.216 44.6858 2.2745 44.4833 2.3915C44.2853 2.504 44.1278 2.666 44.0108 2.8775C43.8983 3.089 43.842 3.32975 43.842 3.59975C43.842 3.86975 43.8983 4.1105 44.0108 4.322C44.1278 4.5335 44.2853 4.69775 44.4833 4.81475C44.6858 4.92725 44.913 4.9835 45.165 4.9835ZM50.4553 3.539C50.9368 3.6515 51.1775 3.94175 51.1775 4.40975C51.1775 4.72025 51.0628 4.95875 50.8333 5.12525C50.6038 5.29175 50.2618 5.375 49.8073 5.375H48.194V1.8245H49.76C50.165 1.8245 50.4823 1.90325 50.7118 2.06075C50.9413 2.21825 51.056 2.44325 51.056 2.73575C51.056 2.92925 51.002 3.09575 50.894 3.23525C50.7905 3.37025 50.6443 3.4715 50.4553 3.539ZM48.6598 3.404H49.7263C50.0008 3.404 50.21 3.35225 50.354 3.24875C50.5025 3.14525 50.5768 2.9945 50.5768 2.7965C50.5768 2.5985 50.5025 2.45 50.354 2.351C50.21 2.252 50.0008 2.2025 49.7263 2.2025H48.6598V3.404ZM49.787 4.997C50.093 4.997 50.3225 4.9475 50.4755 4.8485C50.6285 4.7495 50.705 4.59425 50.705 4.38275C50.705 4.17125 50.6353 4.016 50.4958 3.917C50.3563 3.8135 50.1358 3.76175 49.8343 3.76175H48.6598V4.997H49.787ZM53.968 5.40875C53.626 5.40875 53.3177 5.33225 53.0432 5.17925C52.7687 5.02175 52.5527 4.80575 52.3952 4.53125C52.2377 4.25675 52.159 3.94625 52.159 3.59975C52.159 3.25325 52.2377 2.94275 52.3952 2.66825C52.5527 2.39375 52.7687 2.18 53.0432 2.027C53.3177 1.874 53.626 1.7975 53.968 1.7975C54.31 1.7975 54.6182 1.874 54.8927 2.027C55.1672 2.18 55.381 2.39375 55.534 2.66825C55.6915 2.94275 55.7702 3.25325 55.7702 3.59975C55.7702 3.94625 55.6915 4.25675 55.534 4.53125C55.381 4.80575 55.1672 5.02175 54.8927 5.17925C54.6182 5.33225 54.31 5.40875 53.968 5.40875ZM53.968 4.9835C54.22 4.9835 54.445 4.92725 54.643 4.81475C54.8455 4.69775 55.003 4.5335 55.1155 4.322C55.228 4.1105 55.2842 3.86975 55.2842 3.59975C55.2842 3.32975 55.228 3.089 55.1155 2.8775C55.003 2.666 54.8455 2.504 54.643 2.3915C54.445 2.2745 54.22 2.216 53.968 2.216C53.716 2.216 53.4887 2.2745 53.2862 2.3915C53.0882 2.504 52.9307 2.666 52.8137 2.8775C52.7012 3.089 52.645 3.32975 52.645 3.59975C52.645 3.86975 52.7012 4.1105 52.8137 4.322C52.9307 4.5335 53.0882 4.69775 53.2862 4.81475C53.4887 4.92725 53.716 4.9835 53.968 4.9835ZM60.102 3.74825H57.132C57.159 4.11725 57.3007 4.4165 57.5572 4.646C57.8137 4.871 58.1377 4.9835 58.5292 4.9835C58.7497 4.9835 58.9522 4.94525 59.1367 4.86875C59.3212 4.78775 59.481 4.67075 59.616 4.51775L59.886 4.82825C59.7285 5.01725 59.5305 5.16125 59.292 5.26025C59.058 5.35925 58.7992 5.40875 58.5157 5.40875C58.1512 5.40875 57.8272 5.33225 57.5437 5.17925C57.2647 5.02175 57.0465 4.80575 56.889 4.53125C56.7315 4.25675 56.6527 3.94625 56.6527 3.59975C56.6527 3.25325 56.727 2.94275 56.8755 2.66825C57.0285 2.39375 57.2355 2.18 57.4965 2.027C57.762 1.874 58.059 1.7975 58.3875 1.7975C58.716 1.7975 59.0107 1.874 59.2717 2.027C59.5327 2.18 59.7375 2.39375 59.886 2.66825C60.0345 2.93825 60.1087 3.24875 60.1087 3.59975L60.102 3.74825ZM58.3875 2.20925C58.0455 2.20925 57.7575 2.3195 57.5235 2.54C57.294 2.756 57.1635 3.0395 57.132 3.3905H59.6497C59.6182 3.0395 59.4855 2.756 59.2515 2.54C59.022 2.3195 58.734 2.20925 58.3875 2.20925ZM64.5629 1.7975C65.0264 1.7975 65.3819 1.9145 65.6294 2.1485C65.8769 2.378 66.0007 2.72 66.0007 3.1745V5.375H65.5417V4.8215C65.4337 5.006 65.2739 5.15 65.0624 5.2535C64.8554 5.357 64.6079 5.40875 64.3199 5.40875C63.9239 5.40875 63.6089 5.31425 63.3749 5.12525C63.1409 4.93625 63.0239 4.6865 63.0239 4.376C63.0239 4.0745 63.1319 3.8315 63.3479 3.647C63.5684 3.4625 63.9172 3.37025 64.3942 3.37025H65.5214V3.15425C65.5214 2.84825 65.4359 2.6165 65.2649 2.459C65.0939 2.297 64.8442 2.216 64.5157 2.216C64.2907 2.216 64.0747 2.25425 63.8677 2.33075C63.6607 2.40275 63.4829 2.504 63.3344 2.6345L63.1184 2.27675C63.2984 2.12375 63.5144 2.00675 63.7664 1.92575C64.0184 1.84025 64.2839 1.7975 64.5629 1.7975ZM64.3942 5.03075C64.6642 5.03075 64.8959 4.97 65.0894 4.8485C65.2829 4.7225 65.4269 4.5425 65.5214 4.3085V3.728H64.4077C63.8002 3.728 63.4964 3.9395 63.4964 4.3625C63.4964 4.5695 63.5752 4.73375 63.7327 4.85525C63.8902 4.97225 64.1107 5.03075 64.3942 5.03075ZM69.99 2.24975H67.9582V5.375H67.479V1.8245H69.99V2.24975ZM73.8253 3.74825H70.8553C70.8823 4.11725 71.0241 4.4165 71.2806 4.646C71.5371 4.871 71.8611 4.9835 72.2526 4.9835C72.4731 4.9835 72.6756 4.94525 72.8601 4.86875C73.0446 4.78775 73.2043 4.67075 73.3393 4.51775L73.6093 4.82825C73.4518 5.01725 73.2538 5.16125 73.0153 5.26025C72.7813 5.35925 72.5226 5.40875 72.2391 5.40875C71.8746 5.40875 71.5506 5.33225 71.2671 5.17925C70.9881 5.02175 70.7698 4.80575 70.6123 4.53125C70.4548 4.25675 70.3761 3.94625 70.3761 3.59975C70.3761 3.25325 70.4503 2.94275 70.5988 2.66825C70.7518 2.39375 70.9588 2.18 71.2198 2.027C71.4853 1.874 71.7823 1.7975 72.1108 1.7975C72.4393 1.7975 72.7341 1.874 72.9951 2.027C73.2561 2.18 73.4608 2.39375 73.6093 2.66825C73.7578 2.93825 73.8321 3.24875 73.8321 3.59975L73.8253 3.74825ZM72.1108 2.20925C71.7688 2.20925 71.4808 2.3195 71.2468 2.54C71.0173 2.756 70.8868 3.0395 70.8553 3.3905H73.3731C73.3416 3.0395 73.2088 2.756 72.9748 2.54C72.7453 2.3195 72.4573 2.20925 72.1108 2.20925ZM75.0954 1.8245H75.5747V3.39725H77.8089V1.8245H78.2882V5.375H77.8089V3.809H75.5747V5.375H75.0954V1.8245ZM82.3503 2.24975H81.0071V5.375H80.5278V2.24975H79.1846V1.8245H82.3503V2.24975ZM84.566 5.40875C84.215 5.40875 83.9 5.33225 83.621 5.17925C83.3465 5.02625 83.1305 4.8125 82.973 4.538C82.8155 4.259 82.7367 3.94625 82.7367 3.59975C82.7367 3.25325 82.8155 2.94275 82.973 2.66825C83.1305 2.39375 83.3465 2.18 83.621 2.027C83.9 1.874 84.215 1.7975 84.566 1.7975C84.872 1.7975 85.1442 1.85825 85.3827 1.97975C85.6257 2.09675 85.817 2.27 85.9565 2.4995L85.5987 2.7425C85.4817 2.567 85.3332 2.4365 85.1532 2.351C84.9732 2.261 84.7775 2.216 84.566 2.216C84.3095 2.216 84.0777 2.2745 83.8707 2.3915C83.6682 2.504 83.5085 2.666 83.3915 2.8775C83.279 3.089 83.2227 3.32975 83.2227 3.59975C83.2227 3.87425 83.279 4.11725 83.3915 4.32875C83.5085 4.53575 83.6682 4.69775 83.8707 4.81475C84.0777 4.92725 84.3095 4.9835 84.566 4.9835C84.7775 4.9835 84.9732 4.94075 85.1532 4.85525C85.3332 4.76975 85.4817 4.63925 85.5987 4.46375L85.9565 4.70675C85.817 4.93625 85.6257 5.11175 85.3827 5.23325C85.1397 5.35025 84.8675 5.40875 84.566 5.40875ZM89.5185 2.24975H88.1753V5.375H87.696V2.24975H86.3528V1.8245H89.5185V2.24975ZM92.6752 3.539C93.1567 3.6515 93.3975 3.94175 93.3975 4.40975C93.3975 4.72025 93.2827 4.95875 93.0532 5.12525C92.8237 5.29175 92.4817 5.375 92.0272 5.375H90.414V1.8245H91.98C92.385 1.8245 92.7022 1.90325 92.9317 2.06075C93.1612 2.21825 93.276 2.44325 93.276 2.73575C93.276 2.92925 93.222 3.09575 93.114 3.23525C93.0105 3.37025 92.8642 3.4715 92.6752 3.539ZM90.8797 3.404H91.9462C92.2207 3.404 92.43 3.35225 92.574 3.24875C92.7225 3.14525 92.7967 2.9945 92.7967 2.7965C92.7967 2.5985 92.7225 2.45 92.574 2.351C92.43 2.252 92.2207 2.2025 91.9462 2.2025H90.8797V3.404ZM92.007 4.997C92.313 4.997 92.5425 4.9475 92.6955 4.8485C92.8485 4.7495 92.925 4.59425 92.925 4.38275C92.925 4.17125 92.8552 4.016 92.7157 3.917C92.5762 3.8135 92.3557 3.76175 92.0542 3.76175H90.8797V4.997H92.007ZM96.1879 5.40875C95.8459 5.40875 95.5376 5.33225 95.2631 5.17925C94.9886 5.02175 94.7726 4.80575 94.6151 4.53125C94.4576 4.25675 94.3789 3.94625 94.3789 3.59975C94.3789 3.25325 94.4576 2.94275 94.6151 2.66825C94.7726 2.39375 94.9886 2.18 95.2631 2.027C95.5376 1.874 95.8459 1.7975 96.1879 1.7975C96.5299 1.7975 96.8381 1.874 97.1126 2.027C97.3871 2.18 97.6009 2.39375 97.7539 2.66825C97.9114 2.94275 97.9901 3.25325 97.9901 3.59975C97.9901 3.94625 97.9114 4.25675 97.7539 4.53125C97.6009 4.80575 97.3871 5.02175 97.1126 5.17925C96.8381 5.33225 96.5299 5.40875 96.1879 5.40875ZM96.1879 4.9835C96.4399 4.9835 96.6649 4.92725 96.8629 4.81475C97.0654 4.69775 97.2229 4.5335 97.3354 4.322C97.4479 4.1105 97.5041 3.86975 97.5041 3.59975C97.5041 3.32975 97.4479 3.089 97.3354 2.8775C97.2229 2.666 97.0654 2.504 96.8629 2.3915C96.6649 2.2745 96.4399 2.216 96.1879 2.216C95.9359 2.216 95.7086 2.2745 95.5061 2.3915C95.3081 2.504 95.1506 2.666 95.0336 2.8775C94.9211 3.089 94.8649 3.32975 94.8649 3.59975C94.8649 3.86975 94.9211 4.1105 95.0336 4.322C95.1506 4.5335 95.3081 4.69775 95.5061 4.81475C95.7086 4.92725 95.9359 4.9835 96.1879 4.9835Z",fill:"#182061"})])],-1)),W3=Gl(()=>zt("p",{class:"accounting"},[uo(" \u0411\u0443\u0445\u0433\u0430\u043B\u0442\u0435\u0440\u0441\u043A\u0438\u0439 "),zt("br"),uo(" \u0430\u0443\u0442\u0441\u043E\u0440\u0441\u0438\u043D\u0433 \u0443\u0441\u043B\u0443\u0433 ")],-1)),H3=uo("\u0413\u043B\u0430\u0432\u043D\u0430\u044F"),Y3=uo("\u041E \u043A\u043E\u043C\u043F\u0430\u043D\u0438\u0438"),X3=uo("\u0423\u0441\u043B\u0443\u0433\u0438"),Q3=Gl(()=>zt("p",null,"(998) 99 218-55-88",-1)),K3=uo("\u0417\u0430\u043A\u0430\u0437\u0430\u0442\u044C"),$3=Gl(()=>zt("br",null,null,-1)),J3=uo("\u0437\u0432\u043E\u043D\u043E\u043A"),eT=[K3,$3,J3],tT=Gl(()=>zt("svg",{width:"300",height:"300",viewBox:"0 0 32 42",xmlns:"http://www.w3.org/2000/svg",onclick:"this.classList.toggle('active')"},[zt("g",{transform:"matrix(1,0,0,1,-389.5,-264.004)"},[zt("g",{id:"arrow_left2"},[zt("g",{transform:"matrix(1,0,0,1,0,5)"},[zt("path",{id:"top",d:"M390,270L420,270L420,270C420,270 420.195,250.19 405,265C389.805,279.81 390,279.967 390,279.967"})]),zt("g",{transform:"matrix(1,1.22465e-16,1.22465e-16,-1,0.00024296,564.935)"},[zt("path",{id:"bottom",d:"M390,270L420,270L420,270C420,270 420.195,250.19 405,265C389.805,279.81 390,279.967 390,279.967"})]),zt("path",{id:"middle",d:"M390,284.967L420,284.967"})])])],-1)),iT=[tT];function nT(c,p,y,b,T,I){const D=cr("RouterLink"),o=cr("RouterView");return dr(),pr("div",G3,[zt("header",null,[zt("nav",null,[gi(D,{to:"/",class:"logoPart"},{default:du(()=>[Z3,q3,W3]),_:1}),zt("ul",{class:Bl(T.showNav?"showNav":"")},[zt("li",null,[gi(D,{to:"/index.html"},{default:du(()=>[H3]),_:1})]),zt("li",null,[gi(D,{to:"/about"},{default:du(()=>[Y3]),_:1})]),zt("li",null,[gi(D,{to:"/service"},{default:du(()=>[X3]),_:1})])],2),zt("div",{class:Bl(["phoneNumber",T.showNav?"showNav2":""])},[Q3,zt("button",{onClick:p[0]||(p[0]=(...U)=>I.showBotForm&&I.showBotForm(...U))},eT)],2),zt("div",{class:"icons",onClick:p[1]||(p[1]=(...U)=>I.showNavLinks&&I.showNavLinks(...U))},iT)])]),gi(o)])}var rT=fr(j3,[["render",nT],["__scopeId","data-v-fbe6c276"]]);const oT="modulepreload",Ny={},sT="/",Uy=function(p,y){return!y||y.length===0?p():Promise.all(y.map(b=>{if(b=`${sT}${b}`,b in Ny)return;Ny[b]=!0;const T=b.endsWith(".css"),I=T?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${b}"]${I}`))return;const D=document.createElement("link");if(D.rel=T?"stylesheet":oT,T||(D.as="script",D.crossOrigin=""),D.href=b,document.head.appendChild(D),T)return new Promise((o,U)=>{D.addEventListener("load",o),D.addEventListener("error",()=>U(new Error(`Unable to preload CSS for ${b}`)))})})).then(()=>p())},aT=n5({history:xw("/"),routes:[{path:"/index.html",name:"home",component:k0},{path:"/about",name:"about",component:()=>Uy(()=>import("./AboutView.b5fb04ff.js"),[])},{path:"/service",name:"service",component:()=>Uy(()=>import("./ServiceView.470e58b2.js"),[])}]});/*!
 * Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 * Copyright 2022 Fonticons, Inc.
 */function Vy(c,p){var y=Object.keys(c);if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(c);p&&(b=b.filter(function(T){return Object.getOwnPropertyDescriptor(c,T).enumerable})),y.push.apply(y,b)}return y}function bt(c){for(var p=1;p<arguments.length;p++){var y=arguments[p]!=null?arguments[p]:{};p%2?Vy(Object(y),!0).forEach(function(b){uT(c,b,y[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(c,Object.getOwnPropertyDescriptors(y)):Vy(Object(y)).forEach(function(b){Object.defineProperty(c,b,Object.getOwnPropertyDescriptor(y,b))})}return c}function Sd(c){return Sd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p},Sd(c)}function lT(c,p){if(!(c instanceof p))throw new TypeError("Cannot call a class as a function")}function jy(c,p){for(var y=0;y<p.length;y++){var b=p[y];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(c,b.key,b)}}function cT(c,p,y){return p&&jy(c.prototype,p),y&&jy(c,y),Object.defineProperty(c,"prototype",{writable:!1}),c}function uT(c,p,y){return p in c?Object.defineProperty(c,p,{value:y,enumerable:!0,configurable:!0,writable:!0}):c[p]=y,c}function Dm(c,p){return dT(c)||fT(c,p)||D0(c,p)||_T()}function Gd(c){return hT(c)||pT(c)||D0(c)||mT()}function hT(c){if(Array.isArray(c))return Kf(c)}function dT(c){if(Array.isArray(c))return c}function pT(c){if(typeof Symbol!="undefined"&&c[Symbol.iterator]!=null||c["@@iterator"]!=null)return Array.from(c)}function fT(c,p){var y=c==null?null:typeof Symbol!="undefined"&&c[Symbol.iterator]||c["@@iterator"];if(y!=null){var b=[],T=!0,I=!1,D,o;try{for(y=y.call(c);!(T=(D=y.next()).done)&&(b.push(D.value),!(p&&b.length===p));T=!0);}catch(U){I=!0,o=U}finally{try{!T&&y.return!=null&&y.return()}finally{if(I)throw o}}return b}}function D0(c,p){if(!!c){if(typeof c=="string")return Kf(c,p);var y=Object.prototype.toString.call(c).slice(8,-1);if(y==="Object"&&c.constructor&&(y=c.constructor.name),y==="Map"||y==="Set")return Array.from(c);if(y==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(y))return Kf(c,p)}}function Kf(c,p){(p==null||p>c.length)&&(p=c.length);for(var y=0,b=new Array(p);y<p;y++)b[y]=c[y];return b}function mT(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _T(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Gy=function(){},Pm={},P0={},B0=null,L0={mark:Gy,measure:Gy};try{typeof window!="undefined"&&(Pm=window),typeof document!="undefined"&&(P0=document),typeof MutationObserver!="undefined"&&(B0=MutationObserver),typeof performance!="undefined"&&(L0=performance)}catch{}var gT=Pm.navigator||{},Zy=gT.userAgent,qy=Zy===void 0?"":Zy,zs=Pm,Ni=P0,Wy=B0,ud=L0;zs.document;var jo=!!Ni.documentElement&&!!Ni.head&&typeof Ni.addEventListener=="function"&&typeof Ni.createElement=="function",R0=~qy.indexOf("MSIE")||~qy.indexOf("Trident/"),Fo="___FONT_AWESOME___",$f=16,O0="fa",F0="svg-inline--fa",Aa="data-fa-i2svg",Jf="data-fa-pseudo-element",yT="data-fa-pseudo-element-pending",Bm="data-prefix",Lm="data-icon",Hy="fontawesome-i2svg",xT="async",vT=["HTML","HEAD","STYLE","SCRIPT"],N0=function(){try{return!0}catch{return!1}}(),Rm={fas:"solid","fa-solid":"solid",far:"regular","fa-regular":"regular",fal:"light","fa-light":"light",fat:"thin","fa-thin":"thin",fad:"duotone","fa-duotone":"duotone",fab:"brands","fa-brands":"brands",fak:"kit","fa-kit":"kit",fa:"solid"},Id={solid:"fas",regular:"far",light:"fal",thin:"fat",duotone:"fad",brands:"fab",kit:"fak"},U0={fab:"fa-brands",fad:"fa-duotone",fak:"fa-kit",fal:"fa-light",far:"fa-regular",fas:"fa-solid",fat:"fa-thin"},bT={"fa-brands":"fab","fa-duotone":"fad","fa-kit":"fak","fa-light":"fal","fa-regular":"far","fa-solid":"fas","fa-thin":"fat"},AT=/fa[srltdbk\-\ ]/,V0="fa-layers-text",wT=/Font ?Awesome ?([56 ]*)(Solid|Regular|Light|Thin|Duotone|Brands|Free|Pro|Kit)?.*/i,TT={"900":"fas","400":"far",normal:"far","300":"fal","100":"fat"},j0=[1,2,3,4,5,6,7,8,9,10],ET=j0.concat([11,12,13,14,15,16,17,18,19,20]),CT=["class","data-prefix","data-icon","data-fa-transform","data-fa-mask"],ya={GROUP:"duotone-group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},MT=[].concat(Gd(Object.keys(Id)),["2xs","xs","sm","lg","xl","2xl","beat","border","fade","beat-fade","bounce","flip-both","flip-horizontal","flip-vertical","flip","fw","inverse","layers-counter","layers-text","layers","li","pull-left","pull-right","pulse","rotate-180","rotate-270","rotate-90","rotate-by","shake","spin-pulse","spin-reverse","spin","stack-1x","stack-2x","stack","ul",ya.GROUP,ya.SWAP_OPACITY,ya.PRIMARY,ya.SECONDARY]).concat(j0.map(function(c){return"".concat(c,"x")})).concat(ET.map(function(c){return"w-".concat(c)})),G0=zs.FontAwesomeConfig||{};function ST(c){var p=Ni.querySelector("script["+c+"]");if(p)return p.getAttribute(c)}function IT(c){return c===""?!0:c==="false"?!1:c==="true"?!0:c}if(Ni&&typeof Ni.querySelector=="function"){var zT=[["data-family-prefix","familyPrefix"],["data-style-default","styleDefault"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]];zT.forEach(function(c){var p=Dm(c,2),y=p[0],b=p[1],T=IT(ST(y));T!=null&&(G0[b]=T)})}var kT={familyPrefix:O0,styleDefault:"solid",replacementClass:F0,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0},bu=bt(bt({},kT),G0);bu.autoReplaceSvg||(bu.observeMutations=!1);var Lt={};Object.keys(bu).forEach(function(c){Object.defineProperty(Lt,c,{enumerable:!0,set:function(y){bu[c]=y,_d.forEach(function(b){return b(Lt)})},get:function(){return bu[c]}})});zs.FontAwesomeConfig=Lt;var _d=[];function DT(c){return _d.push(c),function(){_d.splice(_d.indexOf(c),1)}}var As=$f,lo={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function PT(c){if(!(!c||!jo)){var p=Ni.createElement("style");p.setAttribute("type","text/css"),p.innerHTML=c;for(var y=Ni.head.childNodes,b=null,T=y.length-1;T>-1;T--){var I=y[T],D=(I.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(D)>-1&&(b=I)}return Ni.head.insertBefore(p,b),c}}var BT="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";function ku(){for(var c=12,p="";c-- >0;)p+=BT[Math.random()*62|0];return p}function Zl(c){for(var p=[],y=(c||[]).length>>>0;y--;)p[y]=c[y];return p}function Om(c){return c.classList?Zl(c.classList):(c.getAttribute("class")||"").split(" ").filter(function(p){return p})}function Z0(c){return"".concat(c).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function LT(c){return Object.keys(c||{}).reduce(function(p,y){return p+"".concat(y,'="').concat(Z0(c[y]),'" ')},"").trim()}function Zd(c){return Object.keys(c||{}).reduce(function(p,y){return p+"".concat(y,": ").concat(c[y].trim(),";")},"")}function Fm(c){return c.size!==lo.size||c.x!==lo.x||c.y!==lo.y||c.rotate!==lo.rotate||c.flipX||c.flipY}function RT(c){var p=c.transform,y=c.containerWidth,b=c.iconWidth,T={transform:"translate(".concat(y/2," 256)")},I="translate(".concat(p.x*32,", ").concat(p.y*32,") "),D="scale(".concat(p.size/16*(p.flipX?-1:1),", ").concat(p.size/16*(p.flipY?-1:1),") "),o="rotate(".concat(p.rotate," 0 0)"),U={transform:"".concat(I," ").concat(D," ").concat(o)},oe={transform:"translate(".concat(b/2*-1," -256)")};return{outer:T,inner:U,path:oe}}function OT(c){var p=c.transform,y=c.width,b=y===void 0?$f:y,T=c.height,I=T===void 0?$f:T,D=c.startCentered,o=D===void 0?!1:D,U="";return o&&R0?U+="translate(".concat(p.x/As-b/2,"em, ").concat(p.y/As-I/2,"em) "):o?U+="translate(calc(-50% + ".concat(p.x/As,"em), calc(-50% + ").concat(p.y/As,"em)) "):U+="translate(".concat(p.x/As,"em, ").concat(p.y/As,"em) "),U+="scale(".concat(p.size/As*(p.flipX?-1:1),", ").concat(p.size/As*(p.flipY?-1:1),") "),U+="rotate(".concat(p.rotate,"deg) "),U}var FT=`:root, :host {
  --fa-font-solid: normal 900 1em/1 "Font Awesome 6 Solid";
  --fa-font-regular: normal 400 1em/1 "Font Awesome 6 Regular";
  --fa-font-light: normal 300 1em/1 "Font Awesome 6 Light";
  --fa-font-thin: normal 100 1em/1 "Font Awesome 6 Thin";
  --fa-font-duotone: normal 900 1em/1 "Font Awesome 6 Duotone";
  --fa-font-brands: normal 400 1em/1 "Font Awesome 6 Brands";
}

svg:not(:root).svg-inline--fa, svg:not(:host).svg-inline--fa {
  overflow: visible;
  box-sizing: content-box;
}

.svg-inline--fa {
  display: var(--fa-display, inline-block);
  height: 1em;
  overflow: visible;
  vertical-align: -0.125em;
}
.svg-inline--fa.fa-2xs {
  vertical-align: 0.1em;
}
.svg-inline--fa.fa-xs {
  vertical-align: 0em;
}
.svg-inline--fa.fa-sm {
  vertical-align: -0.0714285705em;
}
.svg-inline--fa.fa-lg {
  vertical-align: -0.2em;
}
.svg-inline--fa.fa-xl {
  vertical-align: -0.25em;
}
.svg-inline--fa.fa-2xl {
  vertical-align: -0.3125em;
}
.svg-inline--fa.fa-pull-left {
  margin-right: var(--fa-pull-margin, 0.3em);
  width: auto;
}
.svg-inline--fa.fa-pull-right {
  margin-left: var(--fa-pull-margin, 0.3em);
  width: auto;
}
.svg-inline--fa.fa-li {
  width: var(--fa-li-width, 2em);
  top: 0.25em;
}
.svg-inline--fa.fa-fw {
  width: var(--fa-fw-width, 1.25em);
}

.fa-layers svg.svg-inline--fa {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
}

.fa-layers-counter, .fa-layers-text {
  display: inline-block;
  position: absolute;
  text-align: center;
}

.fa-layers {
  display: inline-block;
  height: 1em;
  position: relative;
  text-align: center;
  vertical-align: -0.125em;
  width: 1em;
}
.fa-layers svg.svg-inline--fa {
  -webkit-transform-origin: center center;
          transform-origin: center center;
}

.fa-layers-text {
  left: 50%;
  top: 50%;
  -webkit-transform: translate(-50%, -50%);
          transform: translate(-50%, -50%);
  -webkit-transform-origin: center center;
          transform-origin: center center;
}

.fa-layers-counter {
  background-color: var(--fa-counter-background-color, #ff253a);
  border-radius: var(--fa-counter-border-radius, 1em);
  box-sizing: border-box;
  color: var(--fa-inverse, #fff);
  line-height: var(--fa-counter-line-height, 1);
  max-width: var(--fa-counter-max-width, 5em);
  min-width: var(--fa-counter-min-width, 1.5em);
  overflow: hidden;
  padding: var(--fa-counter-padding, 0.25em 0.5em);
  right: var(--fa-right, 0);
  text-overflow: ellipsis;
  top: var(--fa-top, 0);
  -webkit-transform: scale(var(--fa-counter-scale, 0.25));
          transform: scale(var(--fa-counter-scale, 0.25));
  -webkit-transform-origin: top right;
          transform-origin: top right;
}

.fa-layers-bottom-right {
  bottom: var(--fa-bottom, 0);
  right: var(--fa-right, 0);
  top: auto;
  -webkit-transform: scale(var(--fa-layers-scale, 0.25));
          transform: scale(var(--fa-layers-scale, 0.25));
  -webkit-transform-origin: bottom right;
          transform-origin: bottom right;
}

.fa-layers-bottom-left {
  bottom: var(--fa-bottom, 0);
  left: var(--fa-left, 0);
  right: auto;
  top: auto;
  -webkit-transform: scale(var(--fa-layers-scale, 0.25));
          transform: scale(var(--fa-layers-scale, 0.25));
  -webkit-transform-origin: bottom left;
          transform-origin: bottom left;
}

.fa-layers-top-right {
  top: var(--fa-top, 0);
  right: var(--fa-right, 0);
  -webkit-transform: scale(var(--fa-layers-scale, 0.25));
          transform: scale(var(--fa-layers-scale, 0.25));
  -webkit-transform-origin: top right;
          transform-origin: top right;
}

.fa-layers-top-left {
  left: var(--fa-left, 0);
  right: auto;
  top: var(--fa-top, 0);
  -webkit-transform: scale(var(--fa-layers-scale, 0.25));
          transform: scale(var(--fa-layers-scale, 0.25));
  -webkit-transform-origin: top left;
          transform-origin: top left;
}

.fa-1x {
  font-size: 1em;
}

.fa-2x {
  font-size: 2em;
}

.fa-3x {
  font-size: 3em;
}

.fa-4x {
  font-size: 4em;
}

.fa-5x {
  font-size: 5em;
}

.fa-6x {
  font-size: 6em;
}

.fa-7x {
  font-size: 7em;
}

.fa-8x {
  font-size: 8em;
}

.fa-9x {
  font-size: 9em;
}

.fa-10x {
  font-size: 10em;
}

.fa-2xs {
  font-size: 0.625em;
  line-height: 0.1em;
  vertical-align: 0.225em;
}

.fa-xs {
  font-size: 0.75em;
  line-height: 0.0833333337em;
  vertical-align: 0.125em;
}

.fa-sm {
  font-size: 0.875em;
  line-height: 0.0714285718em;
  vertical-align: 0.0535714295em;
}

.fa-lg {
  font-size: 1.25em;
  line-height: 0.05em;
  vertical-align: -0.075em;
}

.fa-xl {
  font-size: 1.5em;
  line-height: 0.0416666682em;
  vertical-align: -0.125em;
}

.fa-2xl {
  font-size: 2em;
  line-height: 0.03125em;
  vertical-align: -0.1875em;
}

.fa-fw {
  text-align: center;
  width: 1.25em;
}

.fa-ul {
  list-style-type: none;
  margin-left: var(--fa-li-margin, 2.5em);
  padding-left: 0;
}
.fa-ul > li {
  position: relative;
}

.fa-li {
  left: calc(var(--fa-li-width, 2em) * -1);
  position: absolute;
  text-align: center;
  width: var(--fa-li-width, 2em);
  line-height: inherit;
}

.fa-border {
  border-color: var(--fa-border-color, #eee);
  border-radius: var(--fa-border-radius, 0.1em);
  border-style: var(--fa-border-style, solid);
  border-width: var(--fa-border-width, 0.08em);
  padding: var(--fa-border-padding, 0.2em 0.25em 0.15em);
}

.fa-pull-left {
  float: left;
  margin-right: var(--fa-pull-margin, 0.3em);
}

.fa-pull-right {
  float: right;
  margin-left: var(--fa-pull-margin, 0.3em);
}

.fa-beat {
  -webkit-animation-name: fa-beat;
          animation-name: fa-beat;
  -webkit-animation-delay: var(--fa-animation-delay, 0);
          animation-delay: var(--fa-animation-delay, 0);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);
          animation-timing-function: var(--fa-animation-timing, ease-in-out);
}

.fa-bounce {
  -webkit-animation-name: fa-bounce;
          animation-name: fa-bounce;
  -webkit-animation-delay: var(--fa-animation-delay, 0);
          animation-delay: var(--fa-animation-delay, 0);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));
          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));
}

.fa-fade {
  -webkit-animation-name: fa-fade;
          animation-name: fa-fade;
  -webkit-animation-delay: var(--fa-animation-delay, 0);
          animation-delay: var(--fa-animation-delay, 0);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
}

.fa-beat-fade {
  -webkit-animation-name: fa-beat-fade;
          animation-name: fa-beat-fade;
  -webkit-animation-delay: var(--fa-animation-delay, 0);
          animation-delay: var(--fa-animation-delay, 0);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
}

.fa-flip {
  -webkit-animation-name: fa-flip;
          animation-name: fa-flip;
  -webkit-animation-delay: var(--fa-animation-delay, 0);
          animation-delay: var(--fa-animation-delay, 0);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);
          animation-timing-function: var(--fa-animation-timing, ease-in-out);
}

.fa-shake {
  -webkit-animation-name: fa-shake;
          animation-name: fa-shake;
  -webkit-animation-delay: var(--fa-animation-delay, 0);
          animation-delay: var(--fa-animation-delay, 0);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, linear);
          animation-timing-function: var(--fa-animation-timing, linear);
}

.fa-spin {
  -webkit-animation-name: fa-spin;
          animation-name: fa-spin;
  -webkit-animation-delay: var(--fa-animation-delay, 0);
          animation-delay: var(--fa-animation-delay, 0);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 2s);
          animation-duration: var(--fa-animation-duration, 2s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, linear);
          animation-timing-function: var(--fa-animation-timing, linear);
}

.fa-spin-reverse {
  --fa-animation-direction: reverse;
}

.fa-pulse,
.fa-spin-pulse {
  -webkit-animation-name: fa-spin;
          animation-name: fa-spin;
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, steps(8));
          animation-timing-function: var(--fa-animation-timing, steps(8));
}

@media (prefers-reduced-motion: reduce) {
  .fa-beat,
.fa-bounce,
.fa-fade,
.fa-beat-fade,
.fa-flip,
.fa-pulse,
.fa-shake,
.fa-spin,
.fa-spin-pulse {
    -webkit-animation-delay: -1ms;
            animation-delay: -1ms;
    -webkit-animation-duration: 1ms;
            animation-duration: 1ms;
    -webkit-animation-iteration-count: 1;
            animation-iteration-count: 1;
    transition-delay: 0s;
    transition-duration: 0s;
  }
}
@-webkit-keyframes fa-beat {
  0%, 90% {
    -webkit-transform: scale(1);
            transform: scale(1);
  }
  45% {
    -webkit-transform: scale(var(--fa-beat-scale, 1.25));
            transform: scale(var(--fa-beat-scale, 1.25));
  }
}
@keyframes fa-beat {
  0%, 90% {
    -webkit-transform: scale(1);
            transform: scale(1);
  }
  45% {
    -webkit-transform: scale(var(--fa-beat-scale, 1.25));
            transform: scale(var(--fa-beat-scale, 1.25));
  }
}
@-webkit-keyframes fa-bounce {
  0% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
  10% {
    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
  }
  30% {
    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
  }
  50% {
    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
  }
  57% {
    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
  }
  64% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
  100% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
}
@keyframes fa-bounce {
  0% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
  10% {
    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
  }
  30% {
    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
  }
  50% {
    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
  }
  57% {
    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
  }
  64% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
  100% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
}
@-webkit-keyframes fa-fade {
  50% {
    opacity: var(--fa-fade-opacity, 0.4);
  }
}
@keyframes fa-fade {
  50% {
    opacity: var(--fa-fade-opacity, 0.4);
  }
}
@-webkit-keyframes fa-beat-fade {
  0%, 100% {
    opacity: var(--fa-beat-fade-opacity, 0.4);
    -webkit-transform: scale(1);
            transform: scale(1);
  }
  50% {
    opacity: 1;
    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));
            transform: scale(var(--fa-beat-fade-scale, 1.125));
  }
}
@keyframes fa-beat-fade {
  0%, 100% {
    opacity: var(--fa-beat-fade-opacity, 0.4);
    -webkit-transform: scale(1);
            transform: scale(1);
  }
  50% {
    opacity: 1;
    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));
            transform: scale(var(--fa-beat-fade-scale, 1.125));
  }
}
@-webkit-keyframes fa-flip {
  50% {
    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
  }
}
@keyframes fa-flip {
  50% {
    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
  }
}
@-webkit-keyframes fa-shake {
  0% {
    -webkit-transform: rotate(-15deg);
            transform: rotate(-15deg);
  }
  4% {
    -webkit-transform: rotate(15deg);
            transform: rotate(15deg);
  }
  8%, 24% {
    -webkit-transform: rotate(-18deg);
            transform: rotate(-18deg);
  }
  12%, 28% {
    -webkit-transform: rotate(18deg);
            transform: rotate(18deg);
  }
  16% {
    -webkit-transform: rotate(-22deg);
            transform: rotate(-22deg);
  }
  20% {
    -webkit-transform: rotate(22deg);
            transform: rotate(22deg);
  }
  32% {
    -webkit-transform: rotate(-12deg);
            transform: rotate(-12deg);
  }
  36% {
    -webkit-transform: rotate(12deg);
            transform: rotate(12deg);
  }
  40%, 100% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
}
@keyframes fa-shake {
  0% {
    -webkit-transform: rotate(-15deg);
            transform: rotate(-15deg);
  }
  4% {
    -webkit-transform: rotate(15deg);
            transform: rotate(15deg);
  }
  8%, 24% {
    -webkit-transform: rotate(-18deg);
            transform: rotate(-18deg);
  }
  12%, 28% {
    -webkit-transform: rotate(18deg);
            transform: rotate(18deg);
  }
  16% {
    -webkit-transform: rotate(-22deg);
            transform: rotate(-22deg);
  }
  20% {
    -webkit-transform: rotate(22deg);
            transform: rotate(22deg);
  }
  32% {
    -webkit-transform: rotate(-12deg);
            transform: rotate(-12deg);
  }
  36% {
    -webkit-transform: rotate(12deg);
            transform: rotate(12deg);
  }
  40%, 100% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
}
@-webkit-keyframes fa-spin {
  0% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(360deg);
            transform: rotate(360deg);
  }
}
@keyframes fa-spin {
  0% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(360deg);
            transform: rotate(360deg);
  }
}
.fa-rotate-90 {
  -webkit-transform: rotate(90deg);
          transform: rotate(90deg);
}

.fa-rotate-180 {
  -webkit-transform: rotate(180deg);
          transform: rotate(180deg);
}

.fa-rotate-270 {
  -webkit-transform: rotate(270deg);
          transform: rotate(270deg);
}

.fa-flip-horizontal {
  -webkit-transform: scale(-1, 1);
          transform: scale(-1, 1);
}

.fa-flip-vertical {
  -webkit-transform: scale(1, -1);
          transform: scale(1, -1);
}

.fa-flip-both,
.fa-flip-horizontal.fa-flip-vertical {
  -webkit-transform: scale(-1, -1);
          transform: scale(-1, -1);
}

.fa-rotate-by {
  -webkit-transform: rotate(var(--fa-rotate-angle, none));
          transform: rotate(var(--fa-rotate-angle, none));
}

.fa-stack {
  display: inline-block;
  vertical-align: middle;
  height: 2em;
  position: relative;
  width: 2.5em;
}

.fa-stack-1x,
.fa-stack-2x {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
  z-index: var(--fa-stack-z-index, auto);
}

.svg-inline--fa.fa-stack-1x {
  height: 1em;
  width: 1.25em;
}
.svg-inline--fa.fa-stack-2x {
  height: 2em;
  width: 2.5em;
}

.fa-inverse {
  color: var(--fa-inverse, #fff);
}

.sr-only,
.fa-sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

.sr-only-focusable:not(:focus),
.fa-sr-only-focusable:not(:focus) {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

.svg-inline--fa .fa-primary {
  fill: var(--fa-primary-color, currentColor);
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa .fa-secondary {
  fill: var(--fa-secondary-color, currentColor);
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-primary {
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-secondary {
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa mask .fa-primary,
.svg-inline--fa mask .fa-secondary {
  fill: black;
}

.fad.fa-inverse,
.fa-duotone.fa-inverse {
  color: var(--fa-inverse, #fff);
}`;function q0(){var c=O0,p=F0,y=Lt.familyPrefix,b=Lt.replacementClass,T=FT;if(y!==c||b!==p){var I=new RegExp("\\.".concat(c,"\\-"),"g"),D=new RegExp("\\--".concat(c,"\\-"),"g"),o=new RegExp("\\.".concat(p),"g");T=T.replace(I,".".concat(y,"-")).replace(D,"--".concat(y,"-")).replace(o,".".concat(b))}return T}var Yy=!1;function Mf(){Lt.autoAddCss&&!Yy&&(PT(q0()),Yy=!0)}var NT={mixout:function(){return{dom:{css:q0,insertCss:Mf}}},hooks:function(){return{beforeDOMElementCreation:function(){Mf()},beforeI2svg:function(){Mf()}}}},No=zs||{};No[Fo]||(No[Fo]={});No[Fo].styles||(No[Fo].styles={});No[Fo].hooks||(No[Fo].hooks={});No[Fo].shims||(No[Fo].shims=[]);var Br=No[Fo],W0=[],UT=function c(){Ni.removeEventListener("DOMContentLoaded",c),zd=1,W0.map(function(p){return p()})},zd=!1;jo&&(zd=(Ni.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(Ni.readyState),zd||Ni.addEventListener("DOMContentLoaded",UT));function VT(c){!jo||(zd?setTimeout(c,0):W0.push(c))}function Bu(c){var p=c.tag,y=c.attributes,b=y===void 0?{}:y,T=c.children,I=T===void 0?[]:T;return typeof c=="string"?Z0(c):"<".concat(p," ").concat(LT(b),">").concat(I.map(Bu).join(""),"</").concat(p,">")}function Xy(c,p,y){if(c&&c[p]&&c[p][y])return{prefix:p,iconName:y,icon:c[p][y]}}var jT=function(p,y){return function(b,T,I,D){return p.call(y,b,T,I,D)}},Sf=function(p,y,b,T){var I=Object.keys(p),D=I.length,o=T!==void 0?jT(y,T):y,U,oe,te;for(b===void 0?(U=1,te=p[I[0]]):(U=0,te=b);U<D;U++)oe=I[U],te=o(te,p[oe],oe,p);return te};function GT(c){for(var p=[],y=0,b=c.length;y<b;){var T=c.charCodeAt(y++);if(T>=55296&&T<=56319&&y<b){var I=c.charCodeAt(y++);(I&64512)==56320?p.push(((T&1023)<<10)+(I&1023)+65536):(p.push(T),y--)}else p.push(T)}return p}function em(c){var p=GT(c);return p.length===1?p[0].toString(16):null}function ZT(c,p){var y=c.length,b=c.charCodeAt(p),T;return b>=55296&&b<=56319&&y>p+1&&(T=c.charCodeAt(p+1),T>=56320&&T<=57343)?(b-55296)*1024+T-56320+65536:b}function Qy(c){return Object.keys(c).reduce(function(p,y){var b=c[y],T=!!b.icon;return T?p[b.iconName]=b.icon:p[y]=b,p},{})}function tm(c,p){var y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},b=y.skipHooks,T=b===void 0?!1:b,I=Qy(p);typeof Br.hooks.addPack=="function"&&!T?Br.hooks.addPack(c,Qy(p)):Br.styles[c]=bt(bt({},Br.styles[c]||{}),I),c==="fas"&&tm("fa",p)}var Au=Br.styles,qT=Br.shims,WT=Object.values(U0),Nm=null,H0={},Y0={},X0={},Q0={},K0={},HT=Object.keys(Rm);function YT(c){return~MT.indexOf(c)}function XT(c,p){var y=p.split("-"),b=y[0],T=y.slice(1).join("-");return b===c&&T!==""&&!YT(T)?T:null}var $0=function(){var p=function(I){return Sf(Au,function(D,o,U){return D[U]=Sf(o,I,{}),D},{})};H0=p(function(T,I,D){if(I[3]&&(T[I[3]]=D),I[2]){var o=I[2].filter(function(U){return typeof U=="number"});o.forEach(function(U){T[U.toString(16)]=D})}return T}),Y0=p(function(T,I,D){if(T[D]=D,I[2]){var o=I[2].filter(function(U){return typeof U=="string"});o.forEach(function(U){T[U]=D})}return T}),K0=p(function(T,I,D){var o=I[2];return T[D]=D,o.forEach(function(U){T[U]=D}),T});var y="far"in Au||Lt.autoFetchSvg,b=Sf(qT,function(T,I){var D=I[0],o=I[1],U=I[2];return o==="far"&&!y&&(o="fas"),typeof D=="string"&&(T.names[D]={prefix:o,iconName:U}),typeof D=="number"&&(T.unicodes[D.toString(16)]={prefix:o,iconName:U}),T},{names:{},unicodes:{}});X0=b.names,Q0=b.unicodes,Nm=qd(Lt.styleDefault)};DT(function(c){Nm=qd(c.styleDefault)});$0();function Um(c,p){return(H0[c]||{})[p]}function QT(c,p){return(Y0[c]||{})[p]}function Sl(c,p){return(K0[c]||{})[p]}function J0(c){return X0[c]||{prefix:null,iconName:null}}function KT(c){var p=Q0[c],y=Um("fas",c);return p||(y?{prefix:"fas",iconName:y}:null)||{prefix:null,iconName:null}}function ks(){return Nm}var Vm=function(){return{prefix:null,iconName:null,rest:[]}};function qd(c){var p=Rm[c],y=Id[c]||Id[p],b=c in Br.styles?c:null;return y||b||null}function Wd(c){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},y=p.skipLookups,b=y===void 0?!1:y,T=null,I=c.reduce(function(D,o){var U=XT(Lt.familyPrefix,o);if(Au[o]?(o=WT.includes(o)?bT[o]:o,T=o,D.prefix=o):HT.indexOf(o)>-1?(T=o,D.prefix=qd(o)):U?D.iconName=U:o!==Lt.replacementClass&&D.rest.push(o),!b&&D.prefix&&D.iconName){var oe=T==="fa"?J0(D.iconName):{},te=Sl(D.prefix,D.iconName);oe.prefix&&(T=null),D.iconName=oe.iconName||te||D.iconName,D.prefix=oe.prefix||D.prefix,D.prefix==="far"&&!Au.far&&Au.fas&&!Lt.autoFetchSvg&&(D.prefix="fas")}return D},Vm());return(I.prefix==="fa"||T==="fa")&&(I.prefix=ks()||"fas"),I}var $T=function(){function c(){lT(this,c),this.definitions={}}return cT(c,[{key:"add",value:function(){for(var y=this,b=arguments.length,T=new Array(b),I=0;I<b;I++)T[I]=arguments[I];var D=T.reduce(this._pullDefinitions,{});Object.keys(D).forEach(function(o){y.definitions[o]=bt(bt({},y.definitions[o]||{}),D[o]),tm(o,D[o]);var U=U0[o];U&&tm(U,D[o]),$0()})}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(y,b){var T=b.prefix&&b.iconName&&b.icon?{0:b}:b;return Object.keys(T).map(function(I){var D=T[I],o=D.prefix,U=D.iconName,oe=D.icon,te=oe[2];y[o]||(y[o]={}),te.length>0&&te.forEach(function(Z){typeof Z=="string"&&(y[o][Z]=oe)}),y[o][U]=oe}),y}}]),c}(),Ky=[],Il={},Pl={},JT=Object.keys(Pl);function e4(c,p){var y=p.mixoutsTo;return Ky=c,Il={},Object.keys(Pl).forEach(function(b){JT.indexOf(b)===-1&&delete Pl[b]}),Ky.forEach(function(b){var T=b.mixout?b.mixout():{};if(Object.keys(T).forEach(function(D){typeof T[D]=="function"&&(y[D]=T[D]),Sd(T[D])==="object"&&Object.keys(T[D]).forEach(function(o){y[D]||(y[D]={}),y[D][o]=T[D][o]})}),b.hooks){var I=b.hooks();Object.keys(I).forEach(function(D){Il[D]||(Il[D]=[]),Il[D].push(I[D])})}b.provides&&b.provides(Pl)}),y}function im(c,p){for(var y=arguments.length,b=new Array(y>2?y-2:0),T=2;T<y;T++)b[T-2]=arguments[T];var I=Il[c]||[];return I.forEach(function(D){p=D.apply(null,[p].concat(b))}),p}function wa(c){for(var p=arguments.length,y=new Array(p>1?p-1:0),b=1;b<p;b++)y[b-1]=arguments[b];var T=Il[c]||[];T.forEach(function(I){I.apply(null,y)})}function Uo(){var c=arguments[0],p=Array.prototype.slice.call(arguments,1);return Pl[c]?Pl[c].apply(null,p):void 0}function nm(c){c.prefix==="fa"&&(c.prefix="fas");var p=c.iconName,y=c.prefix||ks();if(!!p)return p=Sl(y,p)||p,Xy(ex.definitions,y,p)||Xy(Br.styles,y,p)}var ex=new $T,t4=function(){Lt.autoReplaceSvg=!1,Lt.observeMutations=!1,wa("noAuto")},i4={i2svg:function(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return jo?(wa("beforeI2svg",p),Uo("pseudoElements2svg",p),Uo("i2svg",p)):Promise.reject("Operation requires a DOM of some kind.")},watch:function(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},y=p.autoReplaceSvgRoot;Lt.autoReplaceSvg===!1&&(Lt.autoReplaceSvg=!0),Lt.observeMutations=!0,VT(function(){r4({autoReplaceSvgRoot:y}),wa("watch",p)})}},n4={icon:function(p){if(p===null)return null;if(Sd(p)==="object"&&p.prefix&&p.iconName)return{prefix:p.prefix,iconName:Sl(p.prefix,p.iconName)||p.iconName};if(Array.isArray(p)&&p.length===2){var y=p[1].indexOf("fa-")===0?p[1].slice(3):p[1],b=qd(p[0]);return{prefix:b,iconName:Sl(b,y)||y}}if(typeof p=="string"&&(p.indexOf("".concat(Lt.familyPrefix,"-"))>-1||p.match(AT))){var T=Wd(p.split(" "),{skipLookups:!0});return{prefix:T.prefix||ks(),iconName:Sl(T.prefix,T.iconName)||T.iconName}}if(typeof p=="string"){var I=ks();return{prefix:I,iconName:Sl(I,p)||p}}}},mr={noAuto:t4,config:Lt,dom:i4,parse:n4,library:ex,findIconDefinition:nm,toHtml:Bu},r4=function(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},y=p.autoReplaceSvgRoot,b=y===void 0?Ni:y;(Object.keys(Br.styles).length>0||Lt.autoFetchSvg)&&jo&&Lt.autoReplaceSvg&&mr.dom.i2svg({node:b})};function Hd(c,p){return Object.defineProperty(c,"abstract",{get:p}),Object.defineProperty(c,"html",{get:function(){return c.abstract.map(function(b){return Bu(b)})}}),Object.defineProperty(c,"node",{get:function(){if(!!jo){var b=Ni.createElement("div");return b.innerHTML=c.html,b.children}}}),c}function o4(c){var p=c.children,y=c.main,b=c.mask,T=c.attributes,I=c.styles,D=c.transform;if(Fm(D)&&y.found&&!b.found){var o=y.width,U=y.height,oe={x:o/U/2,y:.5};T.style=Zd(bt(bt({},I),{},{"transform-origin":"".concat(oe.x+D.x/16,"em ").concat(oe.y+D.y/16,"em")}))}return[{tag:"svg",attributes:T,children:p}]}function s4(c){var p=c.prefix,y=c.iconName,b=c.children,T=c.attributes,I=c.symbol,D=I===!0?"".concat(p,"-").concat(Lt.familyPrefix,"-").concat(y):I;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:bt(bt({},T),{},{id:D}),children:b}]}]}function jm(c){var p=c.icons,y=p.main,b=p.mask,T=c.prefix,I=c.iconName,D=c.transform,o=c.symbol,U=c.title,oe=c.maskId,te=c.titleId,Z=c.extra,se=c.watchable,me=se===void 0?!1:se,Ye=b.found?b:y,ft=Ye.width,Fe=Ye.height,ke=T==="fak",Xe=[Lt.replacementClass,I?"".concat(Lt.familyPrefix,"-").concat(I):""].filter(function(zi){return Z.classes.indexOf(zi)===-1}).filter(function(zi){return zi!==""||!!zi}).concat(Z.classes).join(" "),vt={children:[],attributes:bt(bt({},Z.attributes),{},{"data-prefix":T,"data-icon":I,class:Xe,role:Z.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(ft," ").concat(Fe)})},Dt=ke&&!~Z.classes.indexOf("fa-fw")?{width:"".concat(ft/Fe*16*.0625,"em")}:{};me&&(vt.attributes[Aa]=""),U&&(vt.children.push({tag:"title",attributes:{id:vt.attributes["aria-labelledby"]||"title-".concat(te||ku())},children:[U]}),delete vt.attributes.title);var Ut=bt(bt({},vt),{},{prefix:T,iconName:I,main:y,mask:b,maskId:oe,transform:D,symbol:o,styles:bt(bt({},Dt),Z.styles)}),At=b.found&&y.found?Uo("generateAbstractMask",Ut)||{children:[],attributes:{}}:Uo("generateAbstractIcon",Ut)||{children:[],attributes:{}},Ci=At.children,Li=At.attributes;return Ut.children=Ci,Ut.attributes=Li,o?s4(Ut):o4(Ut)}function $y(c){var p=c.content,y=c.width,b=c.height,T=c.transform,I=c.title,D=c.extra,o=c.watchable,U=o===void 0?!1:o,oe=bt(bt(bt({},D.attributes),I?{title:I}:{}),{},{class:D.classes.join(" ")});U&&(oe[Aa]="");var te=bt({},D.styles);Fm(T)&&(te.transform=OT({transform:T,startCentered:!0,width:y,height:b}),te["-webkit-transform"]=te.transform);var Z=Zd(te);Z.length>0&&(oe.style=Z);var se=[];return se.push({tag:"span",attributes:oe,children:[p]}),I&&se.push({tag:"span",attributes:{class:"sr-only"},children:[I]}),se}function a4(c){var p=c.content,y=c.title,b=c.extra,T=bt(bt(bt({},b.attributes),y?{title:y}:{}),{},{class:b.classes.join(" ")}),I=Zd(b.styles);I.length>0&&(T.style=I);var D=[];return D.push({tag:"span",attributes:T,children:[p]}),y&&D.push({tag:"span",attributes:{class:"sr-only"},children:[y]}),D}var If=Br.styles;function rm(c){var p=c[0],y=c[1],b=c.slice(4),T=Dm(b,1),I=T[0],D=null;return Array.isArray(I)?D={tag:"g",attributes:{class:"".concat(Lt.familyPrefix,"-").concat(ya.GROUP)},children:[{tag:"path",attributes:{class:"".concat(Lt.familyPrefix,"-").concat(ya.SECONDARY),fill:"currentColor",d:I[0]}},{tag:"path",attributes:{class:"".concat(Lt.familyPrefix,"-").concat(ya.PRIMARY),fill:"currentColor",d:I[1]}}]}:D={tag:"path",attributes:{fill:"currentColor",d:I}},{found:!0,width:p,height:y,icon:D}}var l4={found:!1,width:512,height:512};function c4(c,p){!N0&&!Lt.showMissingIcons&&c&&console.error('Icon with name "'.concat(c,'" and prefix "').concat(p,'" is missing.'))}function om(c,p){var y=p;return p==="fa"&&Lt.styleDefault!==null&&(p=ks()),new Promise(function(b,T){if(Uo("missingIconAbstract"),y==="fa"){var I=J0(c)||{};c=I.iconName||c,p=I.prefix||p}if(c&&p&&If[p]&&If[p][c]){var D=If[p][c];return b(rm(D))}c4(c,p),b(bt(bt({},l4),{},{icon:Lt.showMissingIcons&&c?Uo("missingIconAbstract")||{}:{}}))})}var Jy=function(){},sm=Lt.measurePerformance&&ud&&ud.mark&&ud.measure?ud:{mark:Jy,measure:Jy},pu='FA "6.1.1"',u4=function(p){return sm.mark("".concat(pu," ").concat(p," begins")),function(){return tx(p)}},tx=function(p){sm.mark("".concat(pu," ").concat(p," ends")),sm.measure("".concat(pu," ").concat(p),"".concat(pu," ").concat(p," begins"),"".concat(pu," ").concat(p," ends"))},Gm={begin:u4,end:tx},gd=function(){};function e1(c){var p=c.getAttribute?c.getAttribute(Aa):null;return typeof p=="string"}function h4(c){var p=c.getAttribute?c.getAttribute(Bm):null,y=c.getAttribute?c.getAttribute(Lm):null;return p&&y}function d4(c){return c&&c.classList&&c.classList.contains&&c.classList.contains(Lt.replacementClass)}function p4(){if(Lt.autoReplaceSvg===!0)return yd.replace;var c=yd[Lt.autoReplaceSvg];return c||yd.replace}function f4(c){return Ni.createElementNS("http://www.w3.org/2000/svg",c)}function m4(c){return Ni.createElement(c)}function ix(c){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},y=p.ceFn,b=y===void 0?c.tag==="svg"?f4:m4:y;if(typeof c=="string")return Ni.createTextNode(c);var T=b(c.tag);Object.keys(c.attributes||[]).forEach(function(D){T.setAttribute(D,c.attributes[D])});var I=c.children||[];return I.forEach(function(D){T.appendChild(ix(D,{ceFn:b}))}),T}function _4(c){var p=" ".concat(c.outerHTML," ");return p="".concat(p,"Font Awesome fontawesome.com "),p}var yd={replace:function(p){var y=p[0];if(y.parentNode)if(p[1].forEach(function(T){y.parentNode.insertBefore(ix(T),y)}),y.getAttribute(Aa)===null&&Lt.keepOriginalSource){var b=Ni.createComment(_4(y));y.parentNode.replaceChild(b,y)}else y.remove()},nest:function(p){var y=p[0],b=p[1];if(~Om(y).indexOf(Lt.replacementClass))return yd.replace(p);var T=new RegExp("".concat(Lt.familyPrefix,"-.*"));if(delete b[0].attributes.id,b[0].attributes.class){var I=b[0].attributes.class.split(" ").reduce(function(o,U){return U===Lt.replacementClass||U.match(T)?o.toSvg.push(U):o.toNode.push(U),o},{toNode:[],toSvg:[]});b[0].attributes.class=I.toSvg.join(" "),I.toNode.length===0?y.removeAttribute("class"):y.setAttribute("class",I.toNode.join(" "))}var D=b.map(function(o){return Bu(o)}).join(`
`);y.setAttribute(Aa,""),y.innerHTML=D}};function t1(c){c()}function nx(c,p){var y=typeof p=="function"?p:gd;if(c.length===0)y();else{var b=t1;Lt.mutateApproach===xT&&(b=zs.requestAnimationFrame||t1),b(function(){var T=p4(),I=Gm.begin("mutate");c.map(T),I(),y()})}}var Zm=!1;function rx(){Zm=!0}function am(){Zm=!1}var kd=null;function i1(c){if(!!Wy&&!!Lt.observeMutations){var p=c.treeCallback,y=p===void 0?gd:p,b=c.nodeCallback,T=b===void 0?gd:b,I=c.pseudoElementsCallback,D=I===void 0?gd:I,o=c.observeMutationsRoot,U=o===void 0?Ni:o;kd=new Wy(function(oe){if(!Zm){var te=ks();Zl(oe).forEach(function(Z){if(Z.type==="childList"&&Z.addedNodes.length>0&&!e1(Z.addedNodes[0])&&(Lt.searchPseudoElements&&D(Z.target),y(Z.target)),Z.type==="attributes"&&Z.target.parentNode&&Lt.searchPseudoElements&&D(Z.target.parentNode),Z.type==="attributes"&&e1(Z.target)&&~CT.indexOf(Z.attributeName))if(Z.attributeName==="class"&&h4(Z.target)){var se=Wd(Om(Z.target)),me=se.prefix,Ye=se.iconName;Z.target.setAttribute(Bm,me||te),Ye&&Z.target.setAttribute(Lm,Ye)}else d4(Z.target)&&T(Z.target)})}}),jo&&kd.observe(U,{childList:!0,attributes:!0,characterData:!0,subtree:!0})}}function g4(){!kd||kd.disconnect()}function y4(c){var p=c.getAttribute("style"),y=[];return p&&(y=p.split(";").reduce(function(b,T){var I=T.split(":"),D=I[0],o=I.slice(1);return D&&o.length>0&&(b[D]=o.join(":").trim()),b},{})),y}function x4(c){var p=c.getAttribute("data-prefix"),y=c.getAttribute("data-icon"),b=c.innerText!==void 0?c.innerText.trim():"",T=Wd(Om(c));return T.prefix||(T.prefix=ks()),p&&y&&(T.prefix=p,T.iconName=y),T.iconName&&T.prefix||T.prefix&&b.length>0&&(T.iconName=QT(T.prefix,c.innerText)||Um(T.prefix,em(c.innerText))),T}function v4(c){var p=Zl(c.attributes).reduce(function(T,I){return T.name!=="class"&&T.name!=="style"&&(T[I.name]=I.value),T},{}),y=c.getAttribute("title"),b=c.getAttribute("data-fa-title-id");return Lt.autoA11y&&(y?p["aria-labelledby"]="".concat(Lt.replacementClass,"-title-").concat(b||ku()):(p["aria-hidden"]="true",p.focusable="false")),p}function b4(){return{iconName:null,title:null,titleId:null,prefix:null,transform:lo,symbol:!1,mask:{iconName:null,prefix:null,rest:[]},maskId:null,extra:{classes:[],styles:{},attributes:{}}}}function n1(c){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{styleParser:!0},y=x4(c),b=y.iconName,T=y.prefix,I=y.rest,D=v4(c),o=im("parseNodeAttributes",{},c),U=p.styleParser?y4(c):[];return bt({iconName:b,title:c.getAttribute("title"),titleId:c.getAttribute("data-fa-title-id"),prefix:T,transform:lo,mask:{iconName:null,prefix:null,rest:[]},maskId:null,symbol:!1,extra:{classes:I,styles:U,attributes:D}},o)}var A4=Br.styles;function ox(c){var p=Lt.autoReplaceSvg==="nest"?n1(c,{styleParser:!1}):n1(c);return~p.extra.classes.indexOf(V0)?Uo("generateLayersText",c,p):Uo("generateSvgReplacementMutation",c,p)}function r1(c){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!jo)return Promise.resolve();var y=Ni.documentElement.classList,b=function(Z){return y.add("".concat(Hy,"-").concat(Z))},T=function(Z){return y.remove("".concat(Hy,"-").concat(Z))},I=Lt.autoFetchSvg?Object.keys(Rm):Object.keys(A4),D=[".".concat(V0,":not([").concat(Aa,"])")].concat(I.map(function(te){return".".concat(te,":not([").concat(Aa,"])")})).join(", ");if(D.length===0)return Promise.resolve();var o=[];try{o=Zl(c.querySelectorAll(D))}catch{}if(o.length>0)b("pending"),T("complete");else return Promise.resolve();var U=Gm.begin("onTree"),oe=o.reduce(function(te,Z){try{var se=ox(Z);se&&te.push(se)}catch(me){N0||me.name==="MissingIcon"&&console.error(me)}return te},[]);return new Promise(function(te,Z){Promise.all(oe).then(function(se){nx(se,function(){b("active"),b("complete"),T("pending"),typeof p=="function"&&p(),U(),te()})}).catch(function(se){U(),Z(se)})})}function w4(c){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;ox(c).then(function(y){y&&nx([y],p)})}function T4(c){return function(p){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},b=(p||{}).icon?p:nm(p||{}),T=y.mask;return T&&(T=(T||{}).icon?T:nm(T||{})),c(b,bt(bt({},y),{},{mask:T}))}}var E4=function(p){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},b=y.transform,T=b===void 0?lo:b,I=y.symbol,D=I===void 0?!1:I,o=y.mask,U=o===void 0?null:o,oe=y.maskId,te=oe===void 0?null:oe,Z=y.title,se=Z===void 0?null:Z,me=y.titleId,Ye=me===void 0?null:me,ft=y.classes,Fe=ft===void 0?[]:ft,ke=y.attributes,Xe=ke===void 0?{}:ke,vt=y.styles,Dt=vt===void 0?{}:vt;if(!!p){var Ut=p.prefix,At=p.iconName,Ci=p.icon;return Hd(bt({type:"icon"},p),function(){return wa("beforeDOMElementCreation",{iconDefinition:p,params:y}),Lt.autoA11y&&(se?Xe["aria-labelledby"]="".concat(Lt.replacementClass,"-title-").concat(Ye||ku()):(Xe["aria-hidden"]="true",Xe.focusable="false")),jm({icons:{main:rm(Ci),mask:U?rm(U.icon):{found:!1,width:null,height:null,icon:{}}},prefix:Ut,iconName:At,transform:bt(bt({},lo),T),symbol:D,title:se,maskId:te,titleId:Ye,extra:{attributes:Xe,styles:Dt,classes:Fe}})})}},C4={mixout:function(){return{icon:T4(E4)}},hooks:function(){return{mutationObserverCallbacks:function(y){return y.treeCallback=r1,y.nodeCallback=w4,y}}},provides:function(p){p.i2svg=function(y){var b=y.node,T=b===void 0?Ni:b,I=y.callback,D=I===void 0?function(){}:I;return r1(T,D)},p.generateSvgReplacementMutation=function(y,b){var T=b.iconName,I=b.title,D=b.titleId,o=b.prefix,U=b.transform,oe=b.symbol,te=b.mask,Z=b.maskId,se=b.extra;return new Promise(function(me,Ye){Promise.all([om(T,o),te.iconName?om(te.iconName,te.prefix):Promise.resolve({found:!1,width:512,height:512,icon:{}})]).then(function(ft){var Fe=Dm(ft,2),ke=Fe[0],Xe=Fe[1];me([y,jm({icons:{main:ke,mask:Xe},prefix:o,iconName:T,transform:U,symbol:oe,maskId:Z,title:I,titleId:D,extra:se,watchable:!0})])}).catch(Ye)})},p.generateAbstractIcon=function(y){var b=y.children,T=y.attributes,I=y.main,D=y.transform,o=y.styles,U=Zd(o);U.length>0&&(T.style=U);var oe;return Fm(D)&&(oe=Uo("generateAbstractTransformGrouping",{main:I,transform:D,containerWidth:I.width,iconWidth:I.width})),b.push(oe||I.icon),{children:b,attributes:T}}}},M4={mixout:function(){return{layer:function(y){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},T=b.classes,I=T===void 0?[]:T;return Hd({type:"layer"},function(){wa("beforeDOMElementCreation",{assembler:y,params:b});var D=[];return y(function(o){Array.isArray(o)?o.map(function(U){D=D.concat(U.abstract)}):D=D.concat(o.abstract)}),[{tag:"span",attributes:{class:["".concat(Lt.familyPrefix,"-layers")].concat(Gd(I)).join(" ")},children:D}]})}}}},S4={mixout:function(){return{counter:function(y){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},T=b.title,I=T===void 0?null:T,D=b.classes,o=D===void 0?[]:D,U=b.attributes,oe=U===void 0?{}:U,te=b.styles,Z=te===void 0?{}:te;return Hd({type:"counter",content:y},function(){return wa("beforeDOMElementCreation",{content:y,params:b}),a4({content:y.toString(),title:I,extra:{attributes:oe,styles:Z,classes:["".concat(Lt.familyPrefix,"-layers-counter")].concat(Gd(o))}})})}}}},I4={mixout:function(){return{text:function(y){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},T=b.transform,I=T===void 0?lo:T,D=b.title,o=D===void 0?null:D,U=b.classes,oe=U===void 0?[]:U,te=b.attributes,Z=te===void 0?{}:te,se=b.styles,me=se===void 0?{}:se;return Hd({type:"text",content:y},function(){return wa("beforeDOMElementCreation",{content:y,params:b}),$y({content:y,transform:bt(bt({},lo),I),title:o,extra:{attributes:Z,styles:me,classes:["".concat(Lt.familyPrefix,"-layers-text")].concat(Gd(oe))}})})}}},provides:function(p){p.generateLayersText=function(y,b){var T=b.title,I=b.transform,D=b.extra,o=null,U=null;if(R0){var oe=parseInt(getComputedStyle(y).fontSize,10),te=y.getBoundingClientRect();o=te.width/oe,U=te.height/oe}return Lt.autoA11y&&!T&&(D.attributes["aria-hidden"]="true"),Promise.resolve([y,$y({content:y.innerHTML,width:o,height:U,transform:I,title:T,extra:D,watchable:!0})])}}},z4=new RegExp('"',"ug"),o1=[1105920,1112319];function k4(c){var p=c.replace(z4,""),y=ZT(p,0),b=y>=o1[0]&&y<=o1[1],T=p.length===2?p[0]===p[1]:!1;return{value:em(T?p[0]:p),isSecondary:b||T}}function s1(c,p){var y="".concat(yT).concat(p.replace(":","-"));return new Promise(function(b,T){if(c.getAttribute(y)!==null)return b();var I=Zl(c.children),D=I.filter(function(At){return At.getAttribute(Jf)===p})[0],o=zs.getComputedStyle(c,p),U=o.getPropertyValue("font-family").match(wT),oe=o.getPropertyValue("font-weight"),te=o.getPropertyValue("content");if(D&&!U)return c.removeChild(D),b();if(U&&te!=="none"&&te!==""){var Z=o.getPropertyValue("content"),se=~["Solid","Regular","Light","Thin","Duotone","Brands","Kit"].indexOf(U[2])?Id[U[2].toLowerCase()]:TT[oe],me=k4(Z),Ye=me.value,ft=me.isSecondary,Fe=U[0].startsWith("FontAwesome"),ke=Um(se,Ye),Xe=ke;if(Fe){var vt=KT(Ye);vt.iconName&&vt.prefix&&(ke=vt.iconName,se=vt.prefix)}if(ke&&!ft&&(!D||D.getAttribute(Bm)!==se||D.getAttribute(Lm)!==Xe)){c.setAttribute(y,Xe),D&&c.removeChild(D);var Dt=b4(),Ut=Dt.extra;Ut.attributes[Jf]=p,om(ke,se).then(function(At){var Ci=jm(bt(bt({},Dt),{},{icons:{main:At,mask:Vm()},prefix:se,iconName:Xe,extra:Ut,watchable:!0})),Li=Ni.createElement("svg");p==="::before"?c.insertBefore(Li,c.firstChild):c.appendChild(Li),Li.outerHTML=Ci.map(function(zi){return Bu(zi)}).join(`
`),c.removeAttribute(y),b()}).catch(T)}else b()}else b()})}function D4(c){return Promise.all([s1(c,"::before"),s1(c,"::after")])}function P4(c){return c.parentNode!==document.head&&!~vT.indexOf(c.tagName.toUpperCase())&&!c.getAttribute(Jf)&&(!c.parentNode||c.parentNode.tagName!=="svg")}function a1(c){if(!!jo)return new Promise(function(p,y){var b=Zl(c.querySelectorAll("*")).filter(P4).map(D4),T=Gm.begin("searchPseudoElements");rx(),Promise.all(b).then(function(){T(),am(),p()}).catch(function(){T(),am(),y()})})}var B4={hooks:function(){return{mutationObserverCallbacks:function(y){return y.pseudoElementsCallback=a1,y}}},provides:function(p){p.pseudoElements2svg=function(y){var b=y.node,T=b===void 0?Ni:b;Lt.searchPseudoElements&&a1(T)}}},l1=!1,L4={mixout:function(){return{dom:{unwatch:function(){rx(),l1=!0}}}},hooks:function(){return{bootstrap:function(){i1(im("mutationObserverCallbacks",{}))},noAuto:function(){g4()},watch:function(y){var b=y.observeMutationsRoot;l1?am():i1(im("mutationObserverCallbacks",{observeMutationsRoot:b}))}}}},c1=function(p){var y={size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0};return p.toLowerCase().split(" ").reduce(function(b,T){var I=T.toLowerCase().split("-"),D=I[0],o=I.slice(1).join("-");if(D&&o==="h")return b.flipX=!0,b;if(D&&o==="v")return b.flipY=!0,b;if(o=parseFloat(o),isNaN(o))return b;switch(D){case"grow":b.size=b.size+o;break;case"shrink":b.size=b.size-o;break;case"left":b.x=b.x-o;break;case"right":b.x=b.x+o;break;case"up":b.y=b.y-o;break;case"down":b.y=b.y+o;break;case"rotate":b.rotate=b.rotate+o;break}return b},y)},R4={mixout:function(){return{parse:{transform:function(y){return c1(y)}}}},hooks:function(){return{parseNodeAttributes:function(y,b){var T=b.getAttribute("data-fa-transform");return T&&(y.transform=c1(T)),y}}},provides:function(p){p.generateAbstractTransformGrouping=function(y){var b=y.main,T=y.transform,I=y.containerWidth,D=y.iconWidth,o={transform:"translate(".concat(I/2," 256)")},U="translate(".concat(T.x*32,", ").concat(T.y*32,") "),oe="scale(".concat(T.size/16*(T.flipX?-1:1),", ").concat(T.size/16*(T.flipY?-1:1),") "),te="rotate(".concat(T.rotate," 0 0)"),Z={transform:"".concat(U," ").concat(oe," ").concat(te)},se={transform:"translate(".concat(D/2*-1," -256)")},me={outer:o,inner:Z,path:se};return{tag:"g",attributes:bt({},me.outer),children:[{tag:"g",attributes:bt({},me.inner),children:[{tag:b.icon.tag,children:b.icon.children,attributes:bt(bt({},b.icon.attributes),me.path)}]}]}}}},zf={x:0,y:0,width:"100%",height:"100%"};function u1(c){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return c.attributes&&(c.attributes.fill||p)&&(c.attributes.fill="black"),c}function O4(c){return c.tag==="g"?c.children:[c]}var F4={hooks:function(){return{parseNodeAttributes:function(y,b){var T=b.getAttribute("data-fa-mask"),I=T?Wd(T.split(" ").map(function(D){return D.trim()})):Vm();return I.prefix||(I.prefix=ks()),y.mask=I,y.maskId=b.getAttribute("data-fa-mask-id"),y}}},provides:function(p){p.generateAbstractMask=function(y){var b=y.children,T=y.attributes,I=y.main,D=y.mask,o=y.maskId,U=y.transform,oe=I.width,te=I.icon,Z=D.width,se=D.icon,me=RT({transform:U,containerWidth:Z,iconWidth:oe}),Ye={tag:"rect",attributes:bt(bt({},zf),{},{fill:"white"})},ft=te.children?{children:te.children.map(u1)}:{},Fe={tag:"g",attributes:bt({},me.inner),children:[u1(bt({tag:te.tag,attributes:bt(bt({},te.attributes),me.path)},ft))]},ke={tag:"g",attributes:bt({},me.outer),children:[Fe]},Xe="mask-".concat(o||ku()),vt="clip-".concat(o||ku()),Dt={tag:"mask",attributes:bt(bt({},zf),{},{id:Xe,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[Ye,ke]},Ut={tag:"defs",children:[{tag:"clipPath",attributes:{id:vt},children:O4(se)},Dt]};return b.push(Ut,{tag:"rect",attributes:bt({fill:"currentColor","clip-path":"url(#".concat(vt,")"),mask:"url(#".concat(Xe,")")},zf)}),{children:b,attributes:T}}}},N4={provides:function(p){var y=!1;zs.matchMedia&&(y=zs.matchMedia("(prefers-reduced-motion: reduce)").matches),p.missingIconAbstract=function(){var b=[],T={fill:"currentColor"},I={attributeType:"XML",repeatCount:"indefinite",dur:"2s"};b.push({tag:"path",attributes:bt(bt({},T),{},{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"})});var D=bt(bt({},I),{},{attributeName:"opacity"}),o={tag:"circle",attributes:bt(bt({},T),{},{cx:"256",cy:"364",r:"28"}),children:[]};return y||o.children.push({tag:"animate",attributes:bt(bt({},I),{},{attributeName:"r",values:"28;14;28;28;14;28;"})},{tag:"animate",attributes:bt(bt({},D),{},{values:"1;0;1;1;0;1;"})}),b.push(o),b.push({tag:"path",attributes:bt(bt({},T),{},{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),children:y?[]:[{tag:"animate",attributes:bt(bt({},D),{},{values:"1;0;0;0;0;1;"})}]}),y||b.push({tag:"path",attributes:bt(bt({},T),{},{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),children:[{tag:"animate",attributes:bt(bt({},D),{},{values:"0;0;1;1;0;0;"})}]}),{tag:"g",attributes:{class:"missing"},children:b}}}},U4={hooks:function(){return{parseNodeAttributes:function(y,b){var T=b.getAttribute("data-fa-symbol"),I=T===null?!1:T===""?!0:T;return y.symbol=I,y}}}},V4=[NT,C4,M4,S4,I4,B4,L4,R4,F4,N4,U4];e4(V4,{mixoutsTo:mr});mr.noAuto;mr.config;var j4=mr.library;mr.dom;var lm=mr.parse;mr.findIconDefinition;mr.toHtml;var G4=mr.icon;mr.layer;mr.text;mr.counter;/*!
 * Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 * Copyright 2022 Fonticons, Inc.
 */var Z4={prefix:"fas",iconName:"hat-wizard",icon:[512,512,[],"f6e8","M200 376l-49.23-16.41c-7.289-2.434-7.289-12.75 0-15.18L200 328l16.41-49.23c2.434-7.289 12.75-7.289 15.18 0L248 328l49.23 16.41c7.289 2.434 7.289 12.75 0 15.18L248 376L240 416H448l-86.38-201.6C355.4 200 354.8 183.8 359.8 168.9L416 0L228.4 107.3C204.8 120.8 185.1 141.4 175 166.4L64 416h144L200 376zM231.2 172.4L256 160l12.42-24.84c1.477-2.949 5.68-2.949 7.156 0L288 160l24.84 12.42c2.949 1.477 2.949 5.68 0 7.156L288 192l-12.42 24.84c-1.477 2.949-5.68 2.949-7.156 0L256 192L231.2 179.6C228.2 178.1 228.2 173.9 231.2 172.4zM496 448h-480C7.164 448 0 455.2 0 464C0 490.5 21.49 512 48 512h416c26.51 0 48-21.49 48-48C512 455.2 504.8 448 496 448z"]},q4=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function W4(c,p){return p={exports:{}},c(p,p.exports),p.exports}var H4=W4(function(c){(function(p){var y=function(ke,Xe,vt){if(!oe(Xe)||Z(Xe)||se(Xe)||me(Xe)||U(Xe))return Xe;var Dt,Ut=0,At=0;if(te(Xe))for(Dt=[],At=Xe.length;Ut<At;Ut++)Dt.push(y(ke,Xe[Ut],vt));else{Dt={};for(var Ci in Xe)Object.prototype.hasOwnProperty.call(Xe,Ci)&&(Dt[ke(Ci,vt)]=y(ke,Xe[Ci],vt))}return Dt},b=function(ke,Xe){Xe=Xe||{};var vt=Xe.separator||"_",Dt=Xe.split||/(?=[A-Z])/;return ke.split(Dt).join(vt)},T=function(ke){return Ye(ke)?ke:(ke=ke.replace(/[\-_\s]+(.)?/g,function(Xe,vt){return vt?vt.toUpperCase():""}),ke.substr(0,1).toLowerCase()+ke.substr(1))},I=function(ke){var Xe=T(ke);return Xe.substr(0,1).toUpperCase()+Xe.substr(1)},D=function(ke,Xe){return b(ke,Xe).toLowerCase()},o=Object.prototype.toString,U=function(ke){return typeof ke=="function"},oe=function(ke){return ke===Object(ke)},te=function(ke){return o.call(ke)=="[object Array]"},Z=function(ke){return o.call(ke)=="[object Date]"},se=function(ke){return o.call(ke)=="[object RegExp]"},me=function(ke){return o.call(ke)=="[object Boolean]"},Ye=function(ke){return ke=ke-0,ke===ke},ft=function(ke,Xe){var vt=Xe&&"process"in Xe?Xe.process:Xe;return typeof vt!="function"?ke:function(Dt,Ut){return vt(Dt,ke,Ut)}},Fe={camelize:T,decamelize:D,pascalize:I,depascalize:D,camelizeKeys:function(ke,Xe){return y(ft(T,Xe),ke)},decamelizeKeys:function(ke,Xe){return y(ft(D,Xe),ke,Xe)},pascalizeKeys:function(ke,Xe){return y(ft(I,Xe),ke)},depascalizeKeys:function(){return this.decamelizeKeys.apply(this,arguments)}};c.exports?c.exports=Fe:p.humps=Fe})(q4)}),h1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(c){return typeof c}:function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},fu=function(c,p,y){return p in c?Object.defineProperty(c,p,{value:y,enumerable:!0,configurable:!0,writable:!0}):c[p]=y,c},xd=Object.assign||function(c){for(var p=1;p<arguments.length;p++){var y=arguments[p];for(var b in y)Object.prototype.hasOwnProperty.call(y,b)&&(c[b]=y[b])}return c},Y4=function(c,p){var y={};for(var b in c)p.indexOf(b)>=0||!Object.prototype.hasOwnProperty.call(c,b)||(y[b]=c[b]);return y};function X4(c){return c.split(";").map(function(p){return p.trim()}).filter(function(p){return p}).reduce(function(p,y){var b=y.indexOf(":"),T=H4.camelize(y.slice(0,b)),I=y.slice(b+1).trim();return p[T]=I,p},{})}function Q4(c){return c.split(/\s+/).reduce(function(p,y){return p[y]=!0,p},{})}function K4(){for(var c=arguments.length,p=Array(c),y=0;y<c;y++)p[y]=arguments[y];return p.reduce(function(b,T){return Array.isArray(T)?b=b.concat(T):b.push(T),b},[])}function sx(c,p){var y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},b=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},T=(p.children||[]).map(sx.bind(null,c)),I=Object.keys(p.attributes||{}).reduce(function(me,Ye){var ft=p.attributes[Ye];switch(Ye){case"class":me.class=Q4(ft);break;case"style":me.style=X4(ft);break;default:me.attrs[Ye]=ft}return me},{class:{},style:{},attrs:{}}),D=b.class,o=D===void 0?{}:D,U=b.style,oe=U===void 0?{}:U,te=b.attrs,Z=te===void 0?{}:te,se=Y4(b,["class","style","attrs"]);return typeof p=="string"?p:c(p.tag,xd({class:K4(I.class,o),style:xd({},I.style,oe),attrs:xd({},I.attrs,Z)},se,{props:y}),T)}var ax=!1;try{ax=!0}catch{}function $4(){if(!ax&&console&&typeof console.error=="function"){var c;(c=console).error.apply(c,arguments)}}function kf(c,p){return Array.isArray(p)&&p.length>0||!Array.isArray(p)&&p?fu({},c,p):{}}function J4(c){var p,y=(p={"fa-spin":c.spin,"fa-spin-pulse":c.spinPulse,"fa-spin-reverse":c.spinReverse,"fa-pulse":c.pulse,"fa-beat":c.beat,"fa-fade":c.fade,"fa-flash":c.flash,"fa-fw":c.fixedWidth,"fa-border":c.border,"fa-li":c.listItem,"fa-inverse":c.inverse,"fa-flip-horizontal":c.flip==="horizontal"||c.flip==="both","fa-flip-vertical":c.flip==="vertical"||c.flip==="both"},fu(p,"fa-"+c.size,c.size!==null),fu(p,"fa-rotate-"+c.rotation,c.rotation!==null),fu(p,"fa-pull-"+c.pull,c.pull!==null),fu(p,"fa-swap-opacity",c.swapOpacity),p);return Object.keys(y).map(function(b){return y[b]?b:null}).filter(function(b){return b})}function d1(c){if(c&&(typeof c=="undefined"?"undefined":h1(c))==="object"&&c.prefix&&c.iconName&&c.icon)return c;if(lm.icon)return lm.icon(c);if(c===null)return null;if((typeof c=="undefined"?"undefined":h1(c))==="object"&&c.prefix&&c.iconName)return c;if(Array.isArray(c)&&c.length===2)return{prefix:c[0],iconName:c[1]};if(typeof c=="string")return{prefix:"fas",iconName:c}}var eE={name:"FontAwesomeIcon",functional:!0,props:{beat:{type:Boolean,default:!1},border:{type:Boolean,default:!1},fade:{type:Boolean,default:!1},fixedWidth:{type:Boolean,default:!1},flash:{type:Boolean,default:!1},flip:{type:String,default:null,validator:function(p){return["horizontal","vertical","both"].indexOf(p)>-1}},icon:{type:[Object,Array,String],required:!0},mask:{type:[Object,Array,String],default:null},listItem:{type:Boolean,default:!1},pull:{type:String,default:null,validator:function(p){return["right","left"].indexOf(p)>-1}},pulse:{type:Boolean,default:!1},rotation:{type:[String,Number],default:null,validator:function(p){return[90,180,270].indexOf(parseInt(p,10))>-1}},swapOpacity:{type:Boolean,default:!1},size:{type:String,default:null,validator:function(p){return["2xs","xs","sm","lg","xl","2xl","1x","2x","3x","4x","5x","6x","7x","8x","9x","10x"].indexOf(p)>-1}},spin:{type:Boolean,default:!1},spinPulse:{type:Boolean,default:!1},spinReverse:{type:Boolean,default:!1},transform:{type:[String,Object],default:null},symbol:{type:[Boolean,String],default:!1},title:{type:String,default:null},inverse:{type:Boolean,default:!1}},render:function(p,y){var b=y.props,T=b.icon,I=b.mask,D=b.symbol,o=b.title,U=d1(T),oe=kf("classes",J4(b)),te=kf("transform",typeof b.transform=="string"?lm.transform(b.transform):b.transform),Z=kf("mask",d1(I)),se=G4(U,xd({},oe,te,Z,{symbol:D,title:o}));if(!se)return $4("Could not find one or more icon(s)",U,Z);var me=se.abstract,Ye=sx.bind(null,p);return Ye(me[0],{},y.data)}};j4.add(Z4);Qf.accessToken="pk.eyJ1IjoiYWJkdWxraGFrIiwiYSI6ImNsMjd1ZTN5ejAxODIzY3AzcTRjc2sxcHAifQ.5NyEXgxDRXYrFwLhn7zW5Q";const Yd=QA(rT);Yd.use(eE);Yd.use(ew());Yd.use(aT);Yd.mount("#app");export{fr as _,zt as a,pr as c,dr as o};
