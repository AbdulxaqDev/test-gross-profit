const px=function(){const y=document.createElement("link").relList;if(y&&y.supports&&y.supports("modulepreload"))return;for(const I of document.querySelectorAll('link[rel="modulepreload"]'))M(I);new MutationObserver(I=>{for(const B of I)if(B.type==="childList")for(const G of B.addedNodes)G.tagName==="LINK"&&G.rel==="modulepreload"&&M(G)}).observe(document,{childList:!0,subtree:!0});function b(I){const B={};return I.integrity&&(B.integrity=I.integrity),I.referrerpolicy&&(B.referrerPolicy=I.referrerpolicy),I.crossorigin==="use-credentials"?B.credentials="include":I.crossorigin==="anonymous"?B.credentials="omit":B.credentials="same-origin",B}function M(I){if(I.ep)return;I.ep=!0;const B=b(I);fetch(I.href,B)}};px();function af(d,y){const b=Object.create(null),M=d.split(",");for(let I=0;I<M.length;I++)b[M[I]]=!0;return y?I=>!!b[I.toLowerCase()]:I=>!!b[I]}const fx="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",mx=af(fx);function Mg(d){return!!d||d===""}function lf(d){if(Zt(d)){const y={};for(let b=0;b<d.length;b++){const M=d[b],I=lr(M)?yx(M):lf(M);if(I)for(const B in I)y[B]=I[B]}return y}else{if(lr(d))return d;if(rr(d))return d}}const _x=/;(?![^(]*\))/g,gx=/:(.+)/;function yx(d){const y={};return d.split(_x).forEach(b=>{if(b){const M=b.split(gx);M.length>1&&(y[M[0].trim()]=M[1].trim())}}),y}function xs(d){let y="";if(lr(d))y=d;else if(Zt(d))for(let b=0;b<d.length;b++){const M=xs(d[b]);M&&(y+=M+" ")}else if(rr(d))for(const b in d)d[b]&&(y+=b+" ");return y.trim()}const h5=d=>lr(d)?d:d==null?"":Zt(d)||rr(d)&&(d.toString===Dg||!Yt(d.toString))?JSON.stringify(d,Sg,2):String(d),Sg=(d,y)=>y&&y.__v_isRef?Sg(d,y.value):xl(y)?{[`Map(${y.size})`]:[...y.entries()].reduce((b,[M,I])=>(b[`${M} =>`]=I,b),{})}:Ig(y)?{[`Set(${y.size})`]:[...y.values()]}:rr(y)&&!Zt(y)&&!kg(y)?String(y):y,zi={},yl=[],Dn=()=>{},xx=()=>!1,vx=/^on[^a-z]/,$h=d=>vx.test(d),cf=d=>d.startsWith("onUpdate:"),Fr=Object.assign,uf=(d,y)=>{const b=d.indexOf(y);b>-1&&d.splice(b,1)},Ax=Object.prototype.hasOwnProperty,hi=(d,y)=>Ax.call(d,y),Zt=Array.isArray,xl=d=>Jh(d)==="[object Map]",Ig=d=>Jh(d)==="[object Set]",Yt=d=>typeof d=="function",lr=d=>typeof d=="string",hf=d=>typeof d=="symbol",rr=d=>d!==null&&typeof d=="object",zg=d=>rr(d)&&Yt(d.then)&&Yt(d.catch),Dg=Object.prototype.toString,Jh=d=>Dg.call(d),bx=d=>Jh(d).slice(8,-1),kg=d=>Jh(d)==="[object Object]",df=d=>lr(d)&&d!=="NaN"&&d[0]!=="-"&&""+parseInt(d,10)===d,Nh=af(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),ed=d=>{const y=Object.create(null);return b=>y[b]||(y[b]=d(b))},wx=/-(\w)/g,no=ed(d=>d.replace(wx,(y,b)=>b?b.toUpperCase():"")),Tx=/\B([A-Z])/g,Tl=ed(d=>d.replace(Tx,"-$1").toLowerCase()),td=ed(d=>d.charAt(0).toUpperCase()+d.slice(1)),Pp=ed(d=>d?`on${td(d)}`:""),ru=(d,y)=>!Object.is(d,y),Bp=(d,y)=>{for(let b=0;b<d.length;b++)d[b](y)},Zh=(d,y,b)=>{Object.defineProperty(d,y,{configurable:!0,enumerable:!1,value:b})},Ex=d=>{const y=parseFloat(d);return isNaN(y)?d:y};let F_;const Cx=()=>F_||(F_=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});let Jn;class Pg{constructor(y=!1){this.active=!0,this.effects=[],this.cleanups=[],!y&&Jn&&(this.parent=Jn,this.index=(Jn.scopes||(Jn.scopes=[])).push(this)-1)}run(y){if(this.active){const b=Jn;try{return Jn=this,y()}finally{Jn=b}}}on(){Jn=this}off(){Jn=this.parent}stop(y){if(this.active){let b,M;for(b=0,M=this.effects.length;b<M;b++)this.effects[b].stop();for(b=0,M=this.cleanups.length;b<M;b++)this.cleanups[b]();if(this.scopes)for(b=0,M=this.scopes.length;b<M;b++)this.scopes[b].stop(!0);if(this.parent&&!y){const I=this.parent.scopes.pop();I&&I!==this&&(this.parent.scopes[this.index]=I,I.index=this.index)}this.active=!1}}}function Mx(d){return new Pg(d)}function Sx(d,y=Jn){y&&y.active&&y.effects.push(d)}const pf=d=>{const y=new Set(d);return y.w=0,y.n=0,y},Bg=d=>(d.w&vs)>0,Lg=d=>(d.n&vs)>0,Ix=({deps:d})=>{if(d.length)for(let y=0;y<d.length;y++)d[y].w|=vs},zx=d=>{const{deps:y}=d;if(y.length){let b=0;for(let M=0;M<y.length;M++){const I=y[M];Bg(I)&&!Lg(I)?I.delete(d):y[b++]=I,I.w&=~vs,I.n&=~vs}y.length=b}},Vp=new WeakMap;let Xc=0,vs=1;const Gp=30;let io;const la=Symbol(""),jp=Symbol("");class ff{constructor(y,b=null,M){this.fn=y,this.scheduler=b,this.active=!0,this.deps=[],this.parent=void 0,Sx(this,M)}run(){if(!this.active)return this.fn();let y=io,b=_s;for(;y;){if(y===this)return;y=y.parent}try{return this.parent=io,io=this,_s=!0,vs=1<<++Xc,Xc<=Gp?Ix(this):O_(this),this.fn()}finally{Xc<=Gp&&zx(this),vs=1<<--Xc,io=this.parent,_s=b,this.parent=void 0}}stop(){this.active&&(O_(this),this.onStop&&this.onStop(),this.active=!1)}}function O_(d){const{deps:y}=d;if(y.length){for(let b=0;b<y.length;b++)y[b].delete(d);y.length=0}}let _s=!0;const Rg=[];function El(){Rg.push(_s),_s=!1}function Cl(){const d=Rg.pop();_s=d===void 0?!0:d}function un(d,y,b){if(_s&&io){let M=Vp.get(d);M||Vp.set(d,M=new Map);let I=M.get(b);I||M.set(b,I=pf()),Fg(I)}}function Fg(d,y){let b=!1;Xc<=Gp?Lg(d)||(d.n|=vs,b=!Bg(d)):b=!d.has(io),b&&(d.add(io),io.deps.push(d))}function Do(d,y,b,M,I,B){const G=Vp.get(d);if(!G)return;let s=[];if(y==="clear")s=[...G.values()];else if(b==="length"&&Zt(d))G.forEach((K,ue)=>{(ue==="length"||ue>=M)&&s.push(K)});else switch(b!==void 0&&s.push(G.get(b)),y){case"add":Zt(d)?df(b)&&s.push(G.get("length")):(s.push(G.get(la)),xl(d)&&s.push(G.get(jp)));break;case"delete":Zt(d)||(s.push(G.get(la)),xl(d)&&s.push(G.get(jp)));break;case"set":xl(d)&&s.push(G.get(la));break}if(s.length===1)s[0]&&Zp(s[0]);else{const K=[];for(const ue of s)ue&&K.push(...ue);Zp(pf(K))}}function Zp(d,y){for(const b of Zt(d)?d:[...d])(b!==io||b.allowRecurse)&&(b.scheduler?b.scheduler():b.run())}const Dx=af("__proto__,__v_isRef,__isVue"),Og=new Set(Object.getOwnPropertyNames(Symbol).map(d=>Symbol[d]).filter(hf)),kx=mf(),Px=mf(!1,!0),Bx=mf(!0),N_=Lx();function Lx(){const d={};return["includes","indexOf","lastIndexOf"].forEach(y=>{d[y]=function(...b){const M=vi(this);for(let B=0,G=this.length;B<G;B++)un(M,"get",B+"");const I=M[y](...b);return I===-1||I===!1?M[y](...b.map(vi)):I}}),["push","pop","shift","unshift","splice"].forEach(y=>{d[y]=function(...b){El();const M=vi(this)[y].apply(this,b);return Cl(),M}}),d}function mf(d=!1,y=!1){return function(M,I,B){if(I==="__v_isReactive")return!d;if(I==="__v_isReadonly")return d;if(I==="__v_isShallow")return y;if(I==="__v_raw"&&B===(d?y?Kx:jg:y?Gg:Vg).get(M))return M;const G=Zt(M);if(!d&&G&&hi(N_,I))return Reflect.get(N_,I,B);const s=Reflect.get(M,I,B);return(hf(I)?Og.has(I):Dx(I))||(d||un(M,"get",I),y)?s:mr(s)?!G||!df(I)?s.value:s:rr(s)?d?Zg(s):da(s):s}}const Rx=Ng(),Fx=Ng(!0);function Ng(d=!1){return function(b,M,I,B){let G=b[M];if(nu(G)&&mr(G)&&!mr(I))return!1;if(!d&&!nu(I)&&(qg(I)||(I=vi(I),G=vi(G)),!Zt(b)&&mr(G)&&!mr(I)))return G.value=I,!0;const s=Zt(b)&&df(M)?Number(M)<b.length:hi(b,M),K=Reflect.set(b,M,I,B);return b===vi(B)&&(s?ru(I,G)&&Do(b,"set",M,I):Do(b,"add",M,I)),K}}function Ox(d,y){const b=hi(d,y);d[y];const M=Reflect.deleteProperty(d,y);return M&&b&&Do(d,"delete",y,void 0),M}function Nx(d,y){const b=Reflect.has(d,y);return(!hf(y)||!Og.has(y))&&un(d,"has",y),b}function Ux(d){return un(d,"iterate",Zt(d)?"length":la),Reflect.ownKeys(d)}const Ug={get:kx,set:Rx,deleteProperty:Ox,has:Nx,ownKeys:Ux},Vx={get:Bx,set(d,y){return!0},deleteProperty(d,y){return!0}},Gx=Fr({},Ug,{get:Px,set:Fx}),_f=d=>d,id=d=>Reflect.getPrototypeOf(d);function Bh(d,y,b=!1,M=!1){d=d.__v_raw;const I=vi(d),B=vi(y);y!==B&&!b&&un(I,"get",y),!b&&un(I,"get",B);const{has:G}=id(I),s=M?_f:b?vf:ou;if(G.call(I,y))return s(d.get(y));if(G.call(I,B))return s(d.get(B));d!==I&&d.get(y)}function Lh(d,y=!1){const b=this.__v_raw,M=vi(b),I=vi(d);return d!==I&&!y&&un(M,"has",d),!y&&un(M,"has",I),d===I?b.has(d):b.has(d)||b.has(I)}function Rh(d,y=!1){return d=d.__v_raw,!y&&un(vi(d),"iterate",la),Reflect.get(d,"size",d)}function U_(d){d=vi(d);const y=vi(this);return id(y).has.call(y,d)||(y.add(d),Do(y,"add",d,d)),this}function V_(d,y){y=vi(y);const b=vi(this),{has:M,get:I}=id(b);let B=M.call(b,d);B||(d=vi(d),B=M.call(b,d));const G=I.call(b,d);return b.set(d,y),B?ru(y,G)&&Do(b,"set",d,y):Do(b,"add",d,y),this}function G_(d){const y=vi(this),{has:b,get:M}=id(y);let I=b.call(y,d);I||(d=vi(d),I=b.call(y,d)),M&&M.call(y,d);const B=y.delete(d);return I&&Do(y,"delete",d,void 0),B}function j_(){const d=vi(this),y=d.size!==0,b=d.clear();return y&&Do(d,"clear",void 0,void 0),b}function Fh(d,y){return function(M,I){const B=this,G=B.__v_raw,s=vi(G),K=y?_f:d?vf:ou;return!d&&un(s,"iterate",la),G.forEach((ue,he)=>M.call(I,K(ue),K(he),B))}}function Oh(d,y,b){return function(...M){const I=this.__v_raw,B=vi(I),G=xl(B),s=d==="entries"||d===Symbol.iterator&&G,K=d==="keys"&&G,ue=I[d](...M),he=b?_f:y?vf:ou;return!y&&un(B,"iterate",K?jp:la),{next(){const{value:J,done:pe}=ue.next();return pe?{value:J,done:pe}:{value:s?[he(J[0]),he(J[1])]:he(J),done:pe}},[Symbol.iterator](){return this}}}}function us(d){return function(...y){return d==="delete"?!1:this}}function jx(){const d={get(B){return Bh(this,B)},get size(){return Rh(this)},has:Lh,add:U_,set:V_,delete:G_,clear:j_,forEach:Fh(!1,!1)},y={get(B){return Bh(this,B,!1,!0)},get size(){return Rh(this)},has:Lh,add:U_,set:V_,delete:G_,clear:j_,forEach:Fh(!1,!0)},b={get(B){return Bh(this,B,!0)},get size(){return Rh(this,!0)},has(B){return Lh.call(this,B,!0)},add:us("add"),set:us("set"),delete:us("delete"),clear:us("clear"),forEach:Fh(!0,!1)},M={get(B){return Bh(this,B,!0,!0)},get size(){return Rh(this,!0)},has(B){return Lh.call(this,B,!0)},add:us("add"),set:us("set"),delete:us("delete"),clear:us("clear"),forEach:Fh(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(B=>{d[B]=Oh(B,!1,!1),b[B]=Oh(B,!0,!1),y[B]=Oh(B,!1,!0),M[B]=Oh(B,!0,!0)}),[d,b,y,M]}const[Zx,qx,Wx,Hx]=jx();function gf(d,y){const b=y?d?Hx:Wx:d?qx:Zx;return(M,I,B)=>I==="__v_isReactive"?!d:I==="__v_isReadonly"?d:I==="__v_raw"?M:Reflect.get(hi(b,I)&&I in M?b:M,I,B)}const Yx={get:gf(!1,!1)},Xx={get:gf(!1,!0)},Qx={get:gf(!0,!1)},Vg=new WeakMap,Gg=new WeakMap,jg=new WeakMap,Kx=new WeakMap;function $x(d){switch(d){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Jx(d){return d.__v_skip||!Object.isExtensible(d)?0:$x(bx(d))}function da(d){return nu(d)?d:yf(d,!1,Ug,Yx,Vg)}function ev(d){return yf(d,!1,Gx,Xx,Gg)}function Zg(d){return yf(d,!0,Vx,Qx,jg)}function yf(d,y,b,M,I){if(!rr(d)||d.__v_raw&&!(y&&d.__v_isReactive))return d;const B=I.get(d);if(B)return B;const G=Jx(d);if(G===0)return d;const s=new Proxy(d,G===2?M:b);return I.set(d,s),s}function vl(d){return nu(d)?vl(d.__v_raw):!!(d&&d.__v_isReactive)}function nu(d){return!!(d&&d.__v_isReadonly)}function qg(d){return!!(d&&d.__v_isShallow)}function Wg(d){return vl(d)||nu(d)}function vi(d){const y=d&&d.__v_raw;return y?vi(y):d}function xf(d){return Zh(d,"__v_skip",!0),d}const ou=d=>rr(d)?da(d):d,vf=d=>rr(d)?Zg(d):d;function Hg(d){_s&&io&&(d=vi(d),Fg(d.dep||(d.dep=pf())))}function Yg(d,y){d=vi(d),d.dep&&Zp(d.dep)}function mr(d){return!!(d&&d.__v_isRef===!0)}function Xg(d){return Qg(d,!1)}function tv(d){return Qg(d,!0)}function Qg(d,y){return mr(d)?d:new iv(d,y)}class iv{constructor(y,b){this.__v_isShallow=b,this.dep=void 0,this.__v_isRef=!0,this._rawValue=b?y:vi(y),this._value=b?y:ou(y)}get value(){return Hg(this),this._value}set value(y){y=this.__v_isShallow?y:vi(y),ru(y,this._rawValue)&&(this._rawValue=y,this._value=this.__v_isShallow?y:ou(y),Yg(this))}}function Kc(d){return mr(d)?d.value:d}const rv={get:(d,y,b)=>Kc(Reflect.get(d,y,b)),set:(d,y,b,M)=>{const I=d[y];return mr(I)&&!mr(b)?(I.value=b,!0):Reflect.set(d,y,b,M)}};function Kg(d){return vl(d)?d:new Proxy(d,rv)}class nv{constructor(y,b,M,I){this._setter=b,this.dep=void 0,this.__v_isRef=!0,this._dirty=!0,this.effect=new ff(y,()=>{this._dirty||(this._dirty=!0,Yg(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!I,this.__v_isReadonly=M}get value(){const y=vi(this);return Hg(y),(y._dirty||!y._cacheable)&&(y._dirty=!1,y._value=y.effect.run()),y._value}set value(y){this._setter(y)}}function ov(d,y,b=!1){let M,I;const B=Yt(d);return B?(M=d,I=Dn):(M=d.get,I=d.set),new nv(M,I,B||!I,b)}Promise.resolve();function gs(d,y,b,M){let I;try{I=M?d(...M):d()}catch(B){rd(B,y,b)}return I}function kn(d,y,b,M){if(Yt(d)){const B=gs(d,y,b,M);return B&&zg(B)&&B.catch(G=>{rd(G,y,b)}),B}const I=[];for(let B=0;B<d.length;B++)I.push(kn(d[B],y,b,M));return I}function rd(d,y,b,M=!0){const I=y?y.vnode:null;if(y){let B=y.parent;const G=y.proxy,s=b;for(;B;){const ue=B.ec;if(ue){for(let he=0;he<ue.length;he++)if(ue[he](d,G,s)===!1)return}B=B.parent}const K=y.appContext.config.errorHandler;if(K){gs(K,null,10,[d,G,s]);return}}sv(d,b,I,M)}function sv(d,y,b,M=!0){console.error(d)}let qh=!1,qp=!1;const cn=[];let zo=0;const $c=[];let Qc=null,fl=0;const Jc=[];let ps=null,ml=0;const $g=Promise.resolve();let Af=null,Wp=null;function Jg(d){const y=Af||$g;return d?y.then(this?d.bind(this):d):y}function av(d){let y=zo+1,b=cn.length;for(;y<b;){const M=y+b>>>1;su(cn[M])<d?y=M+1:b=M}return y}function ey(d){(!cn.length||!cn.includes(d,qh&&d.allowRecurse?zo+1:zo))&&d!==Wp&&(d.id==null?cn.push(d):cn.splice(av(d.id),0,d),ty())}function ty(){!qh&&!qp&&(qp=!0,Af=$g.then(ny))}function lv(d){const y=cn.indexOf(d);y>zo&&cn.splice(y,1)}function iy(d,y,b,M){Zt(d)?b.push(...d):(!y||!y.includes(d,d.allowRecurse?M+1:M))&&b.push(d),ty()}function cv(d){iy(d,Qc,$c,fl)}function uv(d){iy(d,ps,Jc,ml)}function bf(d,y=null){if($c.length){for(Wp=y,Qc=[...new Set($c)],$c.length=0,fl=0;fl<Qc.length;fl++)Qc[fl]();Qc=null,fl=0,Wp=null,bf(d,y)}}function ry(d){if(Jc.length){const y=[...new Set(Jc)];if(Jc.length=0,ps){ps.push(...y);return}for(ps=y,ps.sort((b,M)=>su(b)-su(M)),ml=0;ml<ps.length;ml++)ps[ml]();ps=null,ml=0}}const su=d=>d.id==null?1/0:d.id;function ny(d){qp=!1,qh=!0,bf(d),cn.sort((b,M)=>su(b)-su(M));const y=Dn;try{for(zo=0;zo<cn.length;zo++){const b=cn[zo];b&&b.active!==!1&&gs(b,null,14)}}finally{zo=0,cn.length=0,ry(),qh=!1,Af=null,(cn.length||$c.length||Jc.length)&&ny(d)}}function hv(d,y,...b){const M=d.vnode.props||zi;let I=b;const B=y.startsWith("update:"),G=B&&y.slice(7);if(G&&G in M){const he=`${G==="modelValue"?"model":G}Modifiers`,{number:J,trim:pe}=M[he]||zi;pe?I=b.map(Ee=>Ee.trim()):J&&(I=b.map(Ex))}let s,K=M[s=Pp(y)]||M[s=Pp(no(y))];!K&&B&&(K=M[s=Pp(Tl(y))]),K&&kn(K,d,6,I);const ue=M[s+"Once"];if(ue){if(!d.emitted)d.emitted={};else if(d.emitted[s])return;d.emitted[s]=!0,kn(ue,d,6,I)}}function oy(d,y,b=!1){const M=y.emitsCache,I=M.get(d);if(I!==void 0)return I;const B=d.emits;let G={},s=!1;if(!Yt(d)){const K=ue=>{const he=oy(ue,y,!0);he&&(s=!0,Fr(G,he))};!b&&y.mixins.length&&y.mixins.forEach(K),d.extends&&K(d.extends),d.mixins&&d.mixins.forEach(K)}return!B&&!s?(M.set(d,null),null):(Zt(B)?B.forEach(K=>G[K]=null):Fr(G,B),M.set(d,G),G)}function nd(d,y){return!d||!$h(y)?!1:(y=y.slice(2).replace(/Once$/,""),hi(d,y[0].toLowerCase()+y.slice(1))||hi(d,Tl(y))||hi(d,y))}let ro=null,od=null;function Wh(d){const y=ro;return ro=d,od=d&&d.type.__scopeId||null,y}function pa(d){od=d}function fa(){od=null}function aa(d,y=ro,b){if(!y||d._n)return d;const M=(...I)=>{M._d&&J_(-1);const B=Wh(y),G=d(...I);return Wh(B),M._d&&J_(1),G};return M._n=!0,M._c=!0,M._d=!0,M}function Lp(d){const{type:y,vnode:b,proxy:M,withProxy:I,props:B,propsOptions:[G],slots:s,attrs:K,emit:ue,render:he,renderCache:J,data:pe,setupState:Ee,ctx:ut,inheritAttrs:Dt}=d;let We,dt;const Lt=Wh(d);try{if(b.shapeFlag&4){const Jt=I||M;We=eo(he.call(Jt,Jt,J,B,Ee,pe,ut)),dt=K}else{const Jt=y;We=eo(Jt.length>1?Jt(B,{attrs:K,slots:s,emit:ue}):Jt(B,null)),dt=y.props?K:dv(K)}}catch(Jt){eu.length=0,rd(Jt,d,1),We=li(ha)}let Xt=We;if(dt&&Dt!==!1){const Jt=Object.keys(dt),{shapeFlag:wi}=Xt;Jt.length&&wi&7&&(G&&Jt.some(cf)&&(dt=pv(dt,G)),Xt=au(Xt,dt))}return b.dirs&&(Xt.dirs=Xt.dirs?Xt.dirs.concat(b.dirs):b.dirs),b.transition&&(Xt.transition=b.transition),We=Xt,Wh(Lt),We}const dv=d=>{let y;for(const b in d)(b==="class"||b==="style"||$h(b))&&((y||(y={}))[b]=d[b]);return y},pv=(d,y)=>{const b={};for(const M in d)(!cf(M)||!(M.slice(9)in y))&&(b[M]=d[M]);return b};function fv(d,y,b){const{props:M,children:I,component:B}=d,{props:G,children:s,patchFlag:K}=y,ue=B.emitsOptions;if(y.dirs||y.transition)return!0;if(b&&K>=0){if(K&1024)return!0;if(K&16)return M?Z_(M,G,ue):!!G;if(K&8){const he=y.dynamicProps;for(let J=0;J<he.length;J++){const pe=he[J];if(G[pe]!==M[pe]&&!nd(ue,pe))return!0}}}else return(I||s)&&(!s||!s.$stable)?!0:M===G?!1:M?G?Z_(M,G,ue):!0:!!G;return!1}function Z_(d,y,b){const M=Object.keys(y);if(M.length!==Object.keys(d).length)return!0;for(let I=0;I<M.length;I++){const B=M[I];if(y[B]!==d[B]&&!nd(b,B))return!0}return!1}function mv({vnode:d,parent:y},b){for(;y&&y.subTree===d;)(d=y.vnode).el=b,y=y.parent}const _v=d=>d.__isSuspense;function gv(d,y){y&&y.pendingBranch?Zt(d)?y.effects.push(...d):y.effects.push(d):uv(d)}function Uh(d,y){if(fr){let b=fr.provides;const M=fr.parent&&fr.parent.provides;M===b&&(b=fr.provides=Object.create(M)),b[d]=y}}function ys(d,y,b=!1){const M=fr||ro;if(M){const I=M.parent==null?M.vnode.appContext&&M.vnode.appContext.provides:M.parent.provides;if(I&&d in I)return I[d];if(arguments.length>1)return b&&Yt(y)?y.call(M.proxy):y}}const q_={};function Vh(d,y,b){return sy(d,y,b)}function sy(d,y,{immediate:b,deep:M,flush:I,onTrack:B,onTrigger:G}=zi){const s=fr;let K,ue=!1,he=!1;if(mr(d)?(K=()=>d.value,ue=qg(d)):vl(d)?(K=()=>d,M=!0):Zt(d)?(he=!0,ue=d.some(vl),K=()=>d.map(dt=>{if(mr(dt))return dt.value;if(vl(dt))return gl(dt);if(Yt(dt))return gs(dt,s,2)})):Yt(d)?y?K=()=>gs(d,s,2):K=()=>{if(!(s&&s.isUnmounted))return J&&J(),kn(d,s,3,[pe])}:K=Dn,y&&M){const dt=K;K=()=>gl(dt())}let J,pe=dt=>{J=We.onStop=()=>{gs(dt,s,4)}};if(lu)return pe=Dn,y?b&&kn(y,s,3,[K(),he?[]:void 0,pe]):K(),Dn;let Ee=he?[]:q_;const ut=()=>{if(!!We.active)if(y){const dt=We.run();(M||ue||(he?dt.some((Lt,Xt)=>ru(Lt,Ee[Xt])):ru(dt,Ee)))&&(J&&J(),kn(y,s,3,[dt,Ee===q_?void 0:Ee,pe]),Ee=dt)}else We.run()};ut.allowRecurse=!!y;let Dt;I==="sync"?Dt=ut:I==="post"?Dt=()=>Kr(ut,s&&s.suspense):Dt=()=>{!s||s.isMounted?cv(ut):ut()};const We=new ff(K,Dt);return y?b?ut():Ee=We.run():I==="post"?Kr(We.run.bind(We),s&&s.suspense):We.run(),()=>{We.stop(),s&&s.scope&&uf(s.scope.effects,We)}}function yv(d,y,b){const M=this.proxy,I=lr(d)?d.includes(".")?ay(M,d):()=>M[d]:d.bind(M,M);let B;Yt(y)?B=y:(B=y.handler,b=y);const G=fr;Al(this);const s=sy(I,B.bind(M),b);return G?Al(G):ua(),s}function ay(d,y){const b=y.split(".");return()=>{let M=d;for(let I=0;I<b.length&&M;I++)M=M[b[I]];return M}}function gl(d,y){if(!rr(d)||d.__v_skip||(y=y||new Set,y.has(d)))return d;if(y.add(d),mr(d))gl(d.value,y);else if(Zt(d))for(let b=0;b<d.length;b++)gl(d[b],y);else if(Ig(d)||xl(d))d.forEach(b=>{gl(b,y)});else if(kg(d))for(const b in d)gl(d[b],y);return d}function wf(d){return Yt(d)?{setup:d,name:d.name}:d}const Hp=d=>!!d.type.__asyncLoader,ly=d=>d.type.__isKeepAlive;function xv(d,y){cy(d,"a",y)}function vv(d,y){cy(d,"da",y)}function cy(d,y,b=fr){const M=d.__wdc||(d.__wdc=()=>{let I=b;for(;I;){if(I.isDeactivated)return;I=I.parent}return d()});if(sd(y,M,b),b){let I=b.parent;for(;I&&I.parent;)ly(I.parent.vnode)&&Av(M,y,b,I),I=I.parent}}function Av(d,y,b,M){const I=sd(y,d,M,!0);uy(()=>{uf(M[y],I)},b)}function sd(d,y,b=fr,M=!1){if(b){const I=b[d]||(b[d]=[]),B=y.__weh||(y.__weh=(...G)=>{if(b.isUnmounted)return;El(),Al(b);const s=kn(y,b,d,G);return ua(),Cl(),s});return M?I.unshift(B):I.push(B),B}}const ko=d=>(y,b=fr)=>(!lu||d==="sp")&&sd(d,y,b),bv=ko("bm"),wv=ko("m"),Tv=ko("bu"),Ev=ko("u"),Cv=ko("bum"),uy=ko("um"),Mv=ko("sp"),Sv=ko("rtg"),Iv=ko("rtc");function zv(d,y=fr){sd("ec",d,y)}let Yp=!0;function Dv(d){const y=dy(d),b=d.proxy,M=d.ctx;Yp=!1,y.beforeCreate&&W_(y.beforeCreate,d,"bc");const{data:I,computed:B,methods:G,watch:s,provide:K,inject:ue,created:he,beforeMount:J,mounted:pe,beforeUpdate:Ee,updated:ut,activated:Dt,deactivated:We,beforeDestroy:dt,beforeUnmount:Lt,destroyed:Xt,unmounted:Jt,render:wi,renderTracked:It,renderTriggered:cr,errorCaptured:Qi,serverPrefetch:Ki,expose:_r,inheritAttrs:mi,components:ur,directives:Tr,filters:Jr}=y;if(ue&&kv(ue,M,null,d.appContext.config.unwrapInjectedRef),G)for(const ci in G){const Wt=G[ci];Yt(Wt)&&(M[ci]=Wt.bind(b))}if(I){const ci=I.call(b,b);rr(ci)&&(d.data=da(ci))}if(Yp=!0,B)for(const ci in B){const Wt=B[ci],Bi=Yt(Wt)?Wt.bind(b,b):Yt(Wt.get)?Wt.get.bind(b,b):Dn,Or=!Yt(Wt)&&Yt(Wt.set)?Wt.set.bind(b):Dn,Li=to({get:Bi,set:Or});Object.defineProperty(M,ci,{enumerable:!0,configurable:!0,get:()=>Li.value,set:hr=>Li.value=hr})}if(s)for(const ci in s)hy(s[ci],M,b,ci);if(K){const ci=Yt(K)?K.call(b):K;Reflect.ownKeys(ci).forEach(Wt=>{Uh(Wt,ci[Wt])})}he&&W_(he,d,"c");function Ai(ci,Wt){Zt(Wt)?Wt.forEach(Bi=>ci(Bi.bind(b))):Wt&&ci(Wt.bind(b))}if(Ai(bv,J),Ai(wv,pe),Ai(Tv,Ee),Ai(Ev,ut),Ai(xv,Dt),Ai(vv,We),Ai(zv,Qi),Ai(Iv,It),Ai(Sv,cr),Ai(Cv,Lt),Ai(uy,Jt),Ai(Mv,Ki),Zt(_r))if(_r.length){const ci=d.exposed||(d.exposed={});_r.forEach(Wt=>{Object.defineProperty(ci,Wt,{get:()=>b[Wt],set:Bi=>b[Wt]=Bi})})}else d.exposed||(d.exposed={});wi&&d.render===Dn&&(d.render=wi),mi!=null&&(d.inheritAttrs=mi),ur&&(d.components=ur),Tr&&(d.directives=Tr)}function kv(d,y,b=Dn,M=!1){Zt(d)&&(d=Xp(d));for(const I in d){const B=d[I];let G;rr(B)?"default"in B?G=ys(B.from||I,B.default,!0):G=ys(B.from||I):G=ys(B),mr(G)&&M?Object.defineProperty(y,I,{enumerable:!0,configurable:!0,get:()=>G.value,set:s=>G.value=s}):y[I]=G}}function W_(d,y,b){kn(Zt(d)?d.map(M=>M.bind(y.proxy)):d.bind(y.proxy),y,b)}function hy(d,y,b,M){const I=M.includes(".")?ay(b,M):()=>b[M];if(lr(d)){const B=y[d];Yt(B)&&Vh(I,B)}else if(Yt(d))Vh(I,d.bind(b));else if(rr(d))if(Zt(d))d.forEach(B=>hy(B,y,b,M));else{const B=Yt(d.handler)?d.handler.bind(b):y[d.handler];Yt(B)&&Vh(I,B,d)}}function dy(d){const y=d.type,{mixins:b,extends:M}=y,{mixins:I,optionsCache:B,config:{optionMergeStrategies:G}}=d.appContext,s=B.get(y);let K;return s?K=s:!I.length&&!b&&!M?K=y:(K={},I.length&&I.forEach(ue=>Hh(K,ue,G,!0)),Hh(K,y,G)),B.set(y,K),K}function Hh(d,y,b,M=!1){const{mixins:I,extends:B}=y;B&&Hh(d,B,b,!0),I&&I.forEach(G=>Hh(d,G,b,!0));for(const G in y)if(!(M&&G==="expose")){const s=Pv[G]||b&&b[G];d[G]=s?s(d[G],y[G]):y[G]}return d}const Pv={data:H_,props:oa,emits:oa,methods:oa,computed:oa,beforeCreate:Lr,created:Lr,beforeMount:Lr,mounted:Lr,beforeUpdate:Lr,updated:Lr,beforeDestroy:Lr,beforeUnmount:Lr,destroyed:Lr,unmounted:Lr,activated:Lr,deactivated:Lr,errorCaptured:Lr,serverPrefetch:Lr,components:oa,directives:oa,watch:Lv,provide:H_,inject:Bv};function H_(d,y){return y?d?function(){return Fr(Yt(d)?d.call(this,this):d,Yt(y)?y.call(this,this):y)}:y:d}function Bv(d,y){return oa(Xp(d),Xp(y))}function Xp(d){if(Zt(d)){const y={};for(let b=0;b<d.length;b++)y[d[b]]=d[b];return y}return d}function Lr(d,y){return d?[...new Set([].concat(d,y))]:y}function oa(d,y){return d?Fr(Fr(Object.create(null),d),y):y}function Lv(d,y){if(!d)return y;if(!y)return d;const b=Fr(Object.create(null),d);for(const M in y)b[M]=Lr(d[M],y[M]);return b}function Rv(d,y,b,M=!1){const I={},B={};Zh(B,ad,1),d.propsDefaults=Object.create(null),py(d,y,I,B);for(const G in d.propsOptions[0])G in I||(I[G]=void 0);b?d.props=M?I:ev(I):d.type.props?d.props=I:d.props=B,d.attrs=B}function Fv(d,y,b,M){const{props:I,attrs:B,vnode:{patchFlag:G}}=d,s=vi(I),[K]=d.propsOptions;let ue=!1;if((M||G>0)&&!(G&16)){if(G&8){const he=d.vnode.dynamicProps;for(let J=0;J<he.length;J++){let pe=he[J];if(nd(d.emitsOptions,pe))continue;const Ee=y[pe];if(K)if(hi(B,pe))Ee!==B[pe]&&(B[pe]=Ee,ue=!0);else{const ut=no(pe);I[ut]=Qp(K,s,ut,Ee,d,!1)}else Ee!==B[pe]&&(B[pe]=Ee,ue=!0)}}}else{py(d,y,I,B)&&(ue=!0);let he;for(const J in s)(!y||!hi(y,J)&&((he=Tl(J))===J||!hi(y,he)))&&(K?b&&(b[J]!==void 0||b[he]!==void 0)&&(I[J]=Qp(K,s,J,void 0,d,!0)):delete I[J]);if(B!==s)for(const J in B)(!y||!hi(y,J)&&!0)&&(delete B[J],ue=!0)}ue&&Do(d,"set","$attrs")}function py(d,y,b,M){const[I,B]=d.propsOptions;let G=!1,s;if(y)for(let K in y){if(Nh(K))continue;const ue=y[K];let he;I&&hi(I,he=no(K))?!B||!B.includes(he)?b[he]=ue:(s||(s={}))[he]=ue:nd(d.emitsOptions,K)||(!(K in M)||ue!==M[K])&&(M[K]=ue,G=!0)}if(B){const K=vi(b),ue=s||zi;for(let he=0;he<B.length;he++){const J=B[he];b[J]=Qp(I,K,J,ue[J],d,!hi(ue,J))}}return G}function Qp(d,y,b,M,I,B){const G=d[b];if(G!=null){const s=hi(G,"default");if(s&&M===void 0){const K=G.default;if(G.type!==Function&&Yt(K)){const{propsDefaults:ue}=I;b in ue?M=ue[b]:(Al(I),M=ue[b]=K.call(null,y),ua())}else M=K}G[0]&&(B&&!s?M=!1:G[1]&&(M===""||M===Tl(b))&&(M=!0))}return M}function fy(d,y,b=!1){const M=y.propsCache,I=M.get(d);if(I)return I;const B=d.props,G={},s=[];let K=!1;if(!Yt(d)){const he=J=>{K=!0;const[pe,Ee]=fy(J,y,!0);Fr(G,pe),Ee&&s.push(...Ee)};!b&&y.mixins.length&&y.mixins.forEach(he),d.extends&&he(d.extends),d.mixins&&d.mixins.forEach(he)}if(!B&&!K)return M.set(d,yl),yl;if(Zt(B))for(let he=0;he<B.length;he++){const J=no(B[he]);Y_(J)&&(G[J]=zi)}else if(B)for(const he in B){const J=no(he);if(Y_(J)){const pe=B[he],Ee=G[J]=Zt(pe)||Yt(pe)?{type:pe}:pe;if(Ee){const ut=K_(Boolean,Ee.type),Dt=K_(String,Ee.type);Ee[0]=ut>-1,Ee[1]=Dt<0||ut<Dt,(ut>-1||hi(Ee,"default"))&&s.push(J)}}}const ue=[G,s];return M.set(d,ue),ue}function Y_(d){return d[0]!=="$"}function X_(d){const y=d&&d.toString().match(/^\s*function (\w+)/);return y?y[1]:d===null?"null":""}function Q_(d,y){return X_(d)===X_(y)}function K_(d,y){return Zt(y)?y.findIndex(b=>Q_(b,d)):Yt(y)&&Q_(y,d)?0:-1}const my=d=>d[0]==="_"||d==="$stable",Tf=d=>Zt(d)?d.map(eo):[eo(d)],Ov=(d,y,b)=>{const M=aa((...I)=>Tf(y(...I)),b);return M._c=!1,M},_y=(d,y,b)=>{const M=d._ctx;for(const I in d){if(my(I))continue;const B=d[I];if(Yt(B))y[I]=Ov(I,B,M);else if(B!=null){const G=Tf(B);y[I]=()=>G}}},gy=(d,y)=>{const b=Tf(y);d.slots.default=()=>b},Nv=(d,y)=>{if(d.vnode.shapeFlag&32){const b=y._;b?(d.slots=vi(y),Zh(y,"_",b)):_y(y,d.slots={})}else d.slots={},y&&gy(d,y);Zh(d.slots,ad,1)},Uv=(d,y,b)=>{const{vnode:M,slots:I}=d;let B=!0,G=zi;if(M.shapeFlag&32){const s=y._;s?b&&s===1?B=!1:(Fr(I,y),!b&&s===1&&delete I._):(B=!y.$stable,_y(y,I)),G=y}else y&&(gy(d,y),G={default:1});if(B)for(const s in I)!my(s)&&!(s in G)&&delete I[s]};function ra(d,y,b,M){const I=d.dirs,B=y&&y.dirs;for(let G=0;G<I.length;G++){const s=I[G];B&&(s.oldValue=B[G].value);let K=s.dir[M];K&&(El(),kn(K,b,8,[d.el,s,d,y]),Cl())}}function yy(){return{app:null,config:{isNativeTag:xx,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Vv=0;function Gv(d,y){return function(M,I=null){Yt(M)||(M=Object.assign({},M)),I!=null&&!rr(I)&&(I=null);const B=yy(),G=new Set;let s=!1;const K=B.app={_uid:Vv++,_component:M,_props:I,_container:null,_context:B,_instance:null,version:uA,get config(){return B.config},set config(ue){},use(ue,...he){return G.has(ue)||(ue&&Yt(ue.install)?(G.add(ue),ue.install(K,...he)):Yt(ue)&&(G.add(ue),ue(K,...he))),K},mixin(ue){return B.mixins.includes(ue)||B.mixins.push(ue),K},component(ue,he){return he?(B.components[ue]=he,K):B.components[ue]},directive(ue,he){return he?(B.directives[ue]=he,K):B.directives[ue]},mount(ue,he,J){if(!s){const pe=li(M,I);return pe.appContext=B,he&&y?y(pe,ue):d(pe,ue,J),s=!0,K._container=ue,ue.__vue_app__=K,Mf(pe.component)||pe.component.proxy}},unmount(){s&&(d(null,K._container),delete K._container.__vue_app__)},provide(ue,he){return B.provides[ue]=he,K}};return K}}function Kp(d,y,b,M,I=!1){if(Zt(d)){d.forEach((pe,Ee)=>Kp(pe,y&&(Zt(y)?y[Ee]:y),b,M,I));return}if(Hp(M)&&!I)return;const B=M.shapeFlag&4?Mf(M.component)||M.component.proxy:M.el,G=I?null:B,{i:s,r:K}=d,ue=y&&y.r,he=s.refs===zi?s.refs={}:s.refs,J=s.setupState;if(ue!=null&&ue!==K&&(lr(ue)?(he[ue]=null,hi(J,ue)&&(J[ue]=null)):mr(ue)&&(ue.value=null)),Yt(K))gs(K,s,12,[G,he]);else{const pe=lr(K),Ee=mr(K);if(pe||Ee){const ut=()=>{if(d.f){const Dt=pe?he[K]:K.value;I?Zt(Dt)&&uf(Dt,B):Zt(Dt)?Dt.includes(B)||Dt.push(B):pe?(he[K]=[B],hi(J,K)&&(J[K]=he[K])):(K.value=[B],d.k&&(he[d.k]=K.value))}else pe?(he[K]=G,hi(J,K)&&(J[K]=G)):mr(K)&&(K.value=G,d.k&&(he[d.k]=G))};G?(ut.id=-1,Kr(ut,b)):ut()}}}const Kr=gv;function jv(d){return Zv(d)}function Zv(d,y){const b=Cx();b.__VUE__=!0;const{insert:M,remove:I,patchProp:B,createElement:G,createText:s,createComment:K,setText:ue,setElementText:he,parentNode:J,nextSibling:pe,setScopeId:Ee=Dn,cloneNode:ut,insertStaticContent:Dt}=d,We=(te,de,Te,Fe=null,ze=null,Ye=null,ot=!1,qe=null,Qe=!!de.dynamicChildren)=>{if(te===de)return;te&&!Hc(te,de)&&(Fe=xt(te),Ot(te,ze,Ye,!0),te=null),de.patchFlag===-2&&(Qe=!1,de.dynamicChildren=null);const{type:Ve,ref:wt,shapeFlag:ft}=de;switch(Ve){case Ef:dt(te,de,Te,Fe);break;case ha:Lt(te,de,Te,Fe);break;case Gh:te==null&&Xt(de,Te,Fe,ot);break;case Io:Tr(te,de,Te,Fe,ze,Ye,ot,qe,Qe);break;default:ft&1?It(te,de,Te,Fe,ze,Ye,ot,qe,Qe):ft&6?Jr(te,de,Te,Fe,ze,Ye,ot,qe,Qe):(ft&64||ft&128)&&Ve.process(te,de,Te,Fe,ze,Ye,ot,qe,Qe,oi)}wt!=null&&ze&&Kp(wt,te&&te.ref,Ye,de||te,!de)},dt=(te,de,Te,Fe)=>{if(te==null)M(de.el=s(de.children),Te,Fe);else{const ze=de.el=te.el;de.children!==te.children&&ue(ze,de.children)}},Lt=(te,de,Te,Fe)=>{te==null?M(de.el=K(de.children||""),Te,Fe):de.el=te.el},Xt=(te,de,Te,Fe)=>{[te.el,te.anchor]=Dt(te.children,de,Te,Fe,te.el,te.anchor)},Jt=({el:te,anchor:de},Te,Fe)=>{let ze;for(;te&&te!==de;)ze=pe(te),M(te,Te,Fe),te=ze;M(de,Te,Fe)},wi=({el:te,anchor:de})=>{let Te;for(;te&&te!==de;)Te=pe(te),I(te),te=Te;I(de)},It=(te,de,Te,Fe,ze,Ye,ot,qe,Qe)=>{ot=ot||de.type==="svg",te==null?cr(de,Te,Fe,ze,Ye,ot,qe,Qe):_r(te,de,ze,Ye,ot,qe,Qe)},cr=(te,de,Te,Fe,ze,Ye,ot,qe)=>{let Qe,Ve;const{type:wt,props:ft,shapeFlag:bt,transition:Et,patchFlag:Ut,dirs:Qt}=te;if(te.el&&ut!==void 0&&Ut===-1)Qe=te.el=ut(te.el);else{if(Qe=te.el=G(te.type,Ye,ft&&ft.is,ft),bt&8?he(Qe,te.children):bt&16&&Ki(te.children,Qe,null,Fe,ze,Ye&&wt!=="foreignObject",ot,qe),Qt&&ra(te,null,Fe,"created"),ft){for(const si in ft)si!=="value"&&!Nh(si)&&B(Qe,si,null,ft[si],Ye,te.children,Fe,ze,Je);"value"in ft&&B(Qe,"value",null,ft.value),(Ve=ft.onVnodeBeforeMount)&&$n(Ve,Fe,te)}Qi(Qe,te,te.scopeId,ot,Fe)}Qt&&ra(te,null,Fe,"beforeMount");const qt=(!ze||ze&&!ze.pendingBranch)&&Et&&!Et.persisted;qt&&Et.beforeEnter(Qe),M(Qe,de,Te),((Ve=ft&&ft.onVnodeMounted)||qt||Qt)&&Kr(()=>{Ve&&$n(Ve,Fe,te),qt&&Et.enter(Qe),Qt&&ra(te,null,Fe,"mounted")},ze)},Qi=(te,de,Te,Fe,ze)=>{if(Te&&Ee(te,Te),Fe)for(let Ye=0;Ye<Fe.length;Ye++)Ee(te,Fe[Ye]);if(ze){let Ye=ze.subTree;if(de===Ye){const ot=ze.vnode;Qi(te,ot,ot.scopeId,ot.slotScopeIds,ze.parent)}}},Ki=(te,de,Te,Fe,ze,Ye,ot,qe,Qe=0)=>{for(let Ve=Qe;Ve<te.length;Ve++){const wt=te[Ve]=qe?fs(te[Ve]):eo(te[Ve]);We(null,wt,de,Te,Fe,ze,Ye,ot,qe)}},_r=(te,de,Te,Fe,ze,Ye,ot)=>{const qe=de.el=te.el;let{patchFlag:Qe,dynamicChildren:Ve,dirs:wt}=de;Qe|=te.patchFlag&16;const ft=te.props||zi,bt=de.props||zi;let Et;Te&&na(Te,!1),(Et=bt.onVnodeBeforeUpdate)&&$n(Et,Te,de,te),wt&&ra(de,te,Te,"beforeUpdate"),Te&&na(Te,!0);const Ut=ze&&de.type!=="foreignObject";if(Ve?mi(te.dynamicChildren,Ve,qe,Te,Fe,Ut,Ye):ot||Bi(te,de,qe,null,Te,Fe,Ut,Ye,!1),Qe>0){if(Qe&16)ur(qe,de,ft,bt,Te,Fe,ze);else if(Qe&2&&ft.class!==bt.class&&B(qe,"class",null,bt.class,ze),Qe&4&&B(qe,"style",ft.style,bt.style,ze),Qe&8){const Qt=de.dynamicProps;for(let qt=0;qt<Qt.length;qt++){const si=Qt[qt],$i=ft[si],gr=bt[si];(gr!==$i||si==="value")&&B(qe,si,$i,gr,ze,te.children,Te,Fe,Je)}}Qe&1&&te.children!==de.children&&he(qe,de.children)}else!ot&&Ve==null&&ur(qe,de,ft,bt,Te,Fe,ze);((Et=bt.onVnodeUpdated)||wt)&&Kr(()=>{Et&&$n(Et,Te,de,te),wt&&ra(de,te,Te,"updated")},Fe)},mi=(te,de,Te,Fe,ze,Ye,ot)=>{for(let qe=0;qe<de.length;qe++){const Qe=te[qe],Ve=de[qe],wt=Qe.el&&(Qe.type===Io||!Hc(Qe,Ve)||Qe.shapeFlag&70)?J(Qe.el):Te;We(Qe,Ve,wt,null,Fe,ze,Ye,ot,!0)}},ur=(te,de,Te,Fe,ze,Ye,ot)=>{if(Te!==Fe){for(const qe in Fe){if(Nh(qe))continue;const Qe=Fe[qe],Ve=Te[qe];Qe!==Ve&&qe!=="value"&&B(te,qe,Ve,Qe,ot,de.children,ze,Ye,Je)}if(Te!==zi)for(const qe in Te)!Nh(qe)&&!(qe in Fe)&&B(te,qe,Te[qe],null,ot,de.children,ze,Ye,Je);"value"in Fe&&B(te,"value",Te.value,Fe.value)}},Tr=(te,de,Te,Fe,ze,Ye,ot,qe,Qe)=>{const Ve=de.el=te?te.el:s(""),wt=de.anchor=te?te.anchor:s("");let{patchFlag:ft,dynamicChildren:bt,slotScopeIds:Et}=de;Et&&(qe=qe?qe.concat(Et):Et),te==null?(M(Ve,Te,Fe),M(wt,Te,Fe),Ki(de.children,Te,wt,ze,Ye,ot,qe,Qe)):ft>0&&ft&64&&bt&&te.dynamicChildren?(mi(te.dynamicChildren,bt,Te,ze,Ye,ot,qe),(de.key!=null||ze&&de===ze.subTree)&&xy(te,de,!0)):Bi(te,de,Te,wt,ze,Ye,ot,qe,Qe)},Jr=(te,de,Te,Fe,ze,Ye,ot,qe,Qe)=>{de.slotScopeIds=qe,te==null?de.shapeFlag&512?ze.ctx.activate(de,Te,Fe,ot,Qe):en(de,Te,Fe,ze,Ye,ot,Qe):Ai(te,de,Qe)},en=(te,de,Te,Fe,ze,Ye,ot)=>{const qe=te.component=rA(te,Fe,ze);if(ly(te)&&(qe.ctx.renderer=oi),nA(qe),qe.asyncDep){if(ze&&ze.registerDep(qe,ci),!te.el){const Qe=qe.subTree=li(ha);Lt(null,Qe,de,Te)}return}ci(qe,te,de,Te,ze,Ye,ot)},Ai=(te,de,Te)=>{const Fe=de.component=te.component;if(fv(te,de,Te))if(Fe.asyncDep&&!Fe.asyncResolved){Wt(Fe,de,Te);return}else Fe.next=de,lv(Fe.update),Fe.update();else de.component=te.component,de.el=te.el,Fe.vnode=de},ci=(te,de,Te,Fe,ze,Ye,ot)=>{const qe=()=>{if(te.isMounted){let{next:wt,bu:ft,u:bt,parent:Et,vnode:Ut}=te,Qt=wt,qt;na(te,!1),wt?(wt.el=Ut.el,Wt(te,wt,ot)):wt=Ut,ft&&Bp(ft),(qt=wt.props&&wt.props.onVnodeBeforeUpdate)&&$n(qt,Et,wt,Ut),na(te,!0);const si=Lp(te),$i=te.subTree;te.subTree=si,We($i,si,J($i.el),xt($i),te,ze,Ye),wt.el=si.el,Qt===null&&mv(te,si.el),bt&&Kr(bt,ze),(qt=wt.props&&wt.props.onVnodeUpdated)&&Kr(()=>$n(qt,Et,wt,Ut),ze)}else{let wt;const{el:ft,props:bt}=de,{bm:Et,m:Ut,parent:Qt}=te,qt=Hp(de);if(na(te,!1),Et&&Bp(Et),!qt&&(wt=bt&&bt.onVnodeBeforeMount)&&$n(wt,Qt,de),na(te,!0),ft&&it){const si=()=>{te.subTree=Lp(te),it(ft,te.subTree,te,ze,null)};qt?de.type.__asyncLoader().then(()=>!te.isUnmounted&&si()):si()}else{const si=te.subTree=Lp(te);We(null,si,Te,Fe,te,ze,Ye),de.el=si.el}if(Ut&&Kr(Ut,ze),!qt&&(wt=bt&&bt.onVnodeMounted)){const si=de;Kr(()=>$n(wt,Qt,si),ze)}de.shapeFlag&256&&te.a&&Kr(te.a,ze),te.isMounted=!0,de=Te=Fe=null}},Qe=te.effect=new ff(qe,()=>ey(te.update),te.scope),Ve=te.update=Qe.run.bind(Qe);Ve.id=te.uid,na(te,!0),Ve()},Wt=(te,de,Te)=>{de.component=te;const Fe=te.vnode.props;te.vnode=de,te.next=null,Fv(te,de.props,Fe,Te),Uv(te,de.children,Te),El(),bf(void 0,te.update),Cl()},Bi=(te,de,Te,Fe,ze,Ye,ot,qe,Qe=!1)=>{const Ve=te&&te.children,wt=te?te.shapeFlag:0,ft=de.children,{patchFlag:bt,shapeFlag:Et}=de;if(bt>0){if(bt&128){Li(Ve,ft,Te,Fe,ze,Ye,ot,qe,Qe);return}else if(bt&256){Or(Ve,ft,Te,Fe,ze,Ye,ot,qe,Qe);return}}Et&8?(wt&16&&Je(Ve,ze,Ye),ft!==Ve&&he(Te,ft)):wt&16?Et&16?Li(Ve,ft,Te,Fe,ze,Ye,ot,qe,Qe):Je(Ve,ze,Ye,!0):(wt&8&&he(Te,""),Et&16&&Ki(ft,Te,Fe,ze,Ye,ot,qe,Qe))},Or=(te,de,Te,Fe,ze,Ye,ot,qe,Qe)=>{te=te||yl,de=de||yl;const Ve=te.length,wt=de.length,ft=Math.min(Ve,wt);let bt;for(bt=0;bt<ft;bt++){const Et=de[bt]=Qe?fs(de[bt]):eo(de[bt]);We(te[bt],Et,Te,null,ze,Ye,ot,qe,Qe)}Ve>wt?Je(te,ze,Ye,!0,!1,ft):Ki(de,Te,Fe,ze,Ye,ot,qe,Qe,ft)},Li=(te,de,Te,Fe,ze,Ye,ot,qe,Qe)=>{let Ve=0;const wt=de.length;let ft=te.length-1,bt=wt-1;for(;Ve<=ft&&Ve<=bt;){const Et=te[Ve],Ut=de[Ve]=Qe?fs(de[Ve]):eo(de[Ve]);if(Hc(Et,Ut))We(Et,Ut,Te,null,ze,Ye,ot,qe,Qe);else break;Ve++}for(;Ve<=ft&&Ve<=bt;){const Et=te[ft],Ut=de[bt]=Qe?fs(de[bt]):eo(de[bt]);if(Hc(Et,Ut))We(Et,Ut,Te,null,ze,Ye,ot,qe,Qe);else break;ft--,bt--}if(Ve>ft){if(Ve<=bt){const Et=bt+1,Ut=Et<wt?de[Et].el:Fe;for(;Ve<=bt;)We(null,de[Ve]=Qe?fs(de[Ve]):eo(de[Ve]),Te,Ut,ze,Ye,ot,qe,Qe),Ve++}}else if(Ve>bt)for(;Ve<=ft;)Ot(te[Ve],ze,Ye,!0),Ve++;else{const Et=Ve,Ut=Ve,Qt=new Map;for(Ve=Ut;Ve<=bt;Ve++){const Wi=de[Ve]=Qe?fs(de[Ve]):eo(de[Ve]);Wi.key!=null&&Qt.set(Wi.key,Ve)}let qt,si=0;const $i=bt-Ut+1;let gr=!1,yn=0;const xn=new Array($i);for(Ve=0;Ve<$i;Ve++)xn[Ve]=0;for(Ve=Et;Ve<=ft;Ve++){const Wi=te[Ve];if(si>=$i){Ot(Wi,ze,Ye,!0);continue}let Ji;if(Wi.key!=null)Ji=Qt.get(Wi.key);else for(qt=Ut;qt<=bt;qt++)if(xn[qt-Ut]===0&&Hc(Wi,de[qt])){Ji=qt;break}Ji===void 0?Ot(Wi,ze,Ye,!0):(xn[Ji-Ut]=Ve+1,Ji>=yn?yn=Ji:gr=!0,We(Wi,de[Ji],Te,null,ze,Ye,ot,qe,Qe),si++)}const oo=gr?qv(xn):yl;for(qt=oo.length-1,Ve=$i-1;Ve>=0;Ve--){const Wi=Ut+Ve,Ji=de[Wi],so=Wi+1<wt?de[Wi+1].el:Fe;xn[Ve]===0?We(null,Ji,Te,so,ze,Ye,ot,qe,Qe):gr&&(qt<0||Ve!==oo[qt]?hr(Ji,Te,so,2):qt--)}}},hr=(te,de,Te,Fe,ze=null)=>{const{el:Ye,type:ot,transition:qe,children:Qe,shapeFlag:Ve}=te;if(Ve&6){hr(te.component.subTree,de,Te,Fe);return}if(Ve&128){te.suspense.move(de,Te,Fe);return}if(Ve&64){ot.move(te,de,Te,oi);return}if(ot===Io){M(Ye,de,Te);for(let ft=0;ft<Qe.length;ft++)hr(Qe[ft],de,Te,Fe);M(te.anchor,de,Te);return}if(ot===Gh){Jt(te,de,Te);return}if(Fe!==2&&Ve&1&&qe)if(Fe===0)qe.beforeEnter(Ye),M(Ye,de,Te),Kr(()=>qe.enter(Ye),ze);else{const{leave:ft,delayLeave:bt,afterLeave:Et}=qe,Ut=()=>M(Ye,de,Te),Qt=()=>{ft(Ye,()=>{Ut(),Et&&Et()})};bt?bt(Ye,Ut,Qt):Qt()}else M(Ye,de,Te)},Ot=(te,de,Te,Fe=!1,ze=!1)=>{const{type:Ye,props:ot,ref:qe,children:Qe,dynamicChildren:Ve,shapeFlag:wt,patchFlag:ft,dirs:bt}=te;if(qe!=null&&Kp(qe,null,Te,te,!0),wt&256){de.ctx.deactivate(te);return}const Et=wt&1&&bt,Ut=!Hp(te);let Qt;if(Ut&&(Qt=ot&&ot.onVnodeBeforeUnmount)&&$n(Qt,de,te),wt&6)ht(te.component,Te,Fe);else{if(wt&128){te.suspense.unmount(Te,Fe);return}Et&&ra(te,null,de,"beforeUnmount"),wt&64?te.type.remove(te,de,Te,ze,oi,Fe):Ve&&(Ye!==Io||ft>0&&ft&64)?Je(Ve,de,Te,!1,!0):(Ye===Io&&ft&384||!ze&&wt&16)&&Je(Qe,de,Te),Fe&&Ui(te)}(Ut&&(Qt=ot&&ot.onVnodeUnmounted)||Et)&&Kr(()=>{Qt&&$n(Qt,de,te),Et&&ra(te,null,de,"unmounted")},Te)},Ui=te=>{const{type:de,el:Te,anchor:Fe,transition:ze}=te;if(de===Io){Be(Te,Fe);return}if(de===Gh){wi(te);return}const Ye=()=>{I(Te),ze&&!ze.persisted&&ze.afterLeave&&ze.afterLeave()};if(te.shapeFlag&1&&ze&&!ze.persisted){const{leave:ot,delayLeave:qe}=ze,Qe=()=>ot(Te,Ye);qe?qe(te.el,Ye,Qe):Qe()}else Ye()},Be=(te,de)=>{let Te;for(;te!==de;)Te=pe(te),I(te),te=Te;I(de)},ht=(te,de,Te)=>{const{bum:Fe,scope:ze,update:Ye,subTree:ot,um:qe}=te;Fe&&Bp(Fe),ze.stop(),Ye&&(Ye.active=!1,Ot(ot,te,de,Te)),qe&&Kr(qe,de),Kr(()=>{te.isUnmounted=!0},de),de&&de.pendingBranch&&!de.isUnmounted&&te.asyncDep&&!te.asyncResolved&&te.suspenseId===de.pendingId&&(de.deps--,de.deps===0&&de.resolve())},Je=(te,de,Te,Fe=!1,ze=!1,Ye=0)=>{for(let ot=Ye;ot<te.length;ot++)Ot(te[ot],de,Te,Fe,ze)},xt=te=>te.shapeFlag&6?xt(te.component.subTree):te.shapeFlag&128?te.suspense.next():pe(te.anchor||te.el),ui=(te,de,Te)=>{te==null?de._vnode&&Ot(de._vnode,null,null,!0):We(de._vnode||null,te,de,null,null,null,Te),ry(),de._vnode=te},oi={p:We,um:Ot,m:hr,r:Ui,mt:en,mc:Ki,pc:Bi,pbc:mi,n:xt,o:d};let kt,it;return y&&([kt,it]=y(oi)),{render:ui,hydrate:kt,createApp:Gv(ui,kt)}}function na({effect:d,update:y},b){d.allowRecurse=y.allowRecurse=b}function xy(d,y,b=!1){const M=d.children,I=y.children;if(Zt(M)&&Zt(I))for(let B=0;B<M.length;B++){const G=M[B];let s=I[B];s.shapeFlag&1&&!s.dynamicChildren&&((s.patchFlag<=0||s.patchFlag===32)&&(s=I[B]=fs(I[B]),s.el=G.el),b||xy(G,s))}}function qv(d){const y=d.slice(),b=[0];let M,I,B,G,s;const K=d.length;for(M=0;M<K;M++){const ue=d[M];if(ue!==0){if(I=b[b.length-1],d[I]<ue){y[M]=I,b.push(M);continue}for(B=0,G=b.length-1;B<G;)s=B+G>>1,d[b[s]]<ue?B=s+1:G=s;ue<d[b[B]]&&(B>0&&(y[M]=b[B-1]),b[B]=M)}}for(B=b.length,G=b[B-1];B-- >0;)b[B]=G,G=y[G];return b}const Wv=d=>d.__isTeleport,vy="components";function Rr(d,y){return Yv(vy,d,!0,y)||d}const Hv=Symbol();function Yv(d,y,b=!0,M=!1){const I=ro||fr;if(I){const B=I.type;if(d===vy){const s=lA(B);if(s&&(s===y||s===no(y)||s===td(no(y))))return B}const G=$_(I[d]||B[d],y)||$_(I.appContext[d],y);return!G&&M?B:G}}function $_(d,y){return d&&(d[y]||d[no(y)]||d[td(no(y))])}const Io=Symbol(void 0),Ef=Symbol(void 0),ha=Symbol(void 0),Gh=Symbol(void 0),eu=[];let ca=null;function $r(d=!1){eu.push(ca=d?null:[])}function Xv(){eu.pop(),ca=eu[eu.length-1]||null}let Yh=1;function J_(d){Yh+=d}function Ay(d){return d.dynamicChildren=Yh>0?ca||yl:null,Xv(),Yh>0&&ca&&ca.push(d),d}function hn(d,y,b,M,I,B){return Ay(Xe(d,y,b,M,I,B,!0))}function Qv(d,y,b,M,I){return Ay(li(d,y,b,M,I,!0))}function $p(d){return d?d.__v_isVNode===!0:!1}function Hc(d,y){return d.type===y.type&&d.key===y.key}const ad="__vInternal",by=({key:d})=>d!=null?d:null,jh=({ref:d,ref_key:y,ref_for:b})=>d!=null?lr(d)||mr(d)||Yt(d)?{i:ro,r:d,k:y,f:!!b}:d:null;function Xe(d,y=null,b=null,M=0,I=null,B=d===Io?0:1,G=!1,s=!1){const K={__v_isVNode:!0,__v_skip:!0,type:d,props:y,key:y&&by(y),ref:y&&jh(y),scopeId:od,slotScopeIds:null,children:b,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:B,patchFlag:M,dynamicProps:I,dynamicChildren:null,appContext:null};return s?(Cf(K,b),B&128&&d.normalize(K)):b&&(K.shapeFlag|=lr(b)?8:16),Yh>0&&!G&&ca&&(K.patchFlag>0||B&6)&&K.patchFlag!==32&&ca.push(K),K}const li=Kv;function Kv(d,y=null,b=null,M=0,I=null,B=!1){if((!d||d===Hv)&&(d=ha),$p(d)){const s=au(d,y,!0);return b&&Cf(s,b),s}if(cA(d)&&(d=d.__vccOpts),y){y=$v(y);let{class:s,style:K}=y;s&&!lr(s)&&(y.class=xs(s)),rr(K)&&(Wg(K)&&!Zt(K)&&(K=Fr({},K)),y.style=lf(K))}const G=lr(d)?1:_v(d)?128:Wv(d)?64:rr(d)?4:Yt(d)?2:0;return Xe(d,y,b,M,I,G,B,!0)}function $v(d){return d?Wg(d)||ad in d?Fr({},d):d:null}function au(d,y,b=!1){const{props:M,ref:I,patchFlag:B,children:G}=d,s=y?Jv(M||{},y):M;return{__v_isVNode:!0,__v_skip:!0,type:d.type,props:s,key:s&&by(s),ref:y&&y.ref?b&&I?Zt(I)?I.concat(jh(y)):[I,jh(y)]:jh(y):I,scopeId:d.scopeId,slotScopeIds:d.slotScopeIds,children:G,target:d.target,targetAnchor:d.targetAnchor,staticCount:d.staticCount,shapeFlag:d.shapeFlag,patchFlag:y&&d.type!==Io?B===-1?16:B|16:B,dynamicProps:d.dynamicProps,dynamicChildren:d.dynamicChildren,appContext:d.appContext,dirs:d.dirs,transition:d.transition,component:d.component,suspense:d.suspense,ssContent:d.ssContent&&au(d.ssContent),ssFallback:d.ssFallback&&au(d.ssFallback),el:d.el,anchor:d.anchor}}function ir(d=" ",y=0){return li(Ef,null,d,y)}function Ml(d,y){const b=li(Gh,null,d);return b.staticCount=y,b}function d5(d="",y=!1){return y?($r(),Qv(ha,null,d)):li(ha,null,d)}function eo(d){return d==null||typeof d=="boolean"?li(ha):Zt(d)?li(Io,null,d.slice()):typeof d=="object"?fs(d):li(Ef,null,String(d))}function fs(d){return d.el===null||d.memo?d:au(d)}function Cf(d,y){let b=0;const{shapeFlag:M}=d;if(y==null)y=null;else if(Zt(y))b=16;else if(typeof y=="object")if(M&65){const I=y.default;I&&(I._c&&(I._d=!1),Cf(d,I()),I._c&&(I._d=!0));return}else{b=32;const I=y._;!I&&!(ad in y)?y._ctx=ro:I===3&&ro&&(ro.slots._===1?y._=1:(y._=2,d.patchFlag|=1024))}else Yt(y)?(y={default:y,_ctx:ro},b=32):(y=String(y),M&64?(b=16,y=[ir(y)]):b=8);d.children=y,d.shapeFlag|=b}function Jv(...d){const y={};for(let b=0;b<d.length;b++){const M=d[b];for(const I in M)if(I==="class")y.class!==M.class&&(y.class=xs([y.class,M.class]));else if(I==="style")y.style=lf([y.style,M.style]);else if($h(I)){const B=y[I],G=M[I];G&&B!==G&&!(Zt(B)&&B.includes(G))&&(y[I]=B?[].concat(B,G):G)}else I!==""&&(y[I]=M[I])}return y}function $n(d,y,b,M=null){kn(d,y,7,[b,M])}function p5(d,y,b,M){let I;const B=b&&b[M];if(Zt(d)||lr(d)){I=new Array(d.length);for(let G=0,s=d.length;G<s;G++)I[G]=y(d[G],G,void 0,B&&B[G])}else if(typeof d=="number"){I=new Array(d);for(let G=0;G<d;G++)I[G]=y(G+1,G,void 0,B&&B[G])}else if(rr(d))if(d[Symbol.iterator])I=Array.from(d,(G,s)=>y(G,s,void 0,B&&B[s]));else{const G=Object.keys(d);I=new Array(G.length);for(let s=0,K=G.length;s<K;s++){const ue=G[s];I[s]=y(d[ue],ue,s,B&&B[s])}}else I=[];return b&&(b[M]=I),I}const Jp=d=>d?wy(d)?Mf(d)||d.proxy:Jp(d.parent):null,Xh=Fr(Object.create(null),{$:d=>d,$el:d=>d.vnode.el,$data:d=>d.data,$props:d=>d.props,$attrs:d=>d.attrs,$slots:d=>d.slots,$refs:d=>d.refs,$parent:d=>Jp(d.parent),$root:d=>Jp(d.root),$emit:d=>d.emit,$options:d=>dy(d),$forceUpdate:d=>()=>ey(d.update),$nextTick:d=>Jg.bind(d.proxy),$watch:d=>yv.bind(d)}),eA={get({_:d},y){const{ctx:b,setupState:M,data:I,props:B,accessCache:G,type:s,appContext:K}=d;let ue;if(y[0]!=="$"){const Ee=G[y];if(Ee!==void 0)switch(Ee){case 1:return M[y];case 2:return I[y];case 4:return b[y];case 3:return B[y]}else{if(M!==zi&&hi(M,y))return G[y]=1,M[y];if(I!==zi&&hi(I,y))return G[y]=2,I[y];if((ue=d.propsOptions[0])&&hi(ue,y))return G[y]=3,B[y];if(b!==zi&&hi(b,y))return G[y]=4,b[y];Yp&&(G[y]=0)}}const he=Xh[y];let J,pe;if(he)return y==="$attrs"&&un(d,"get",y),he(d);if((J=s.__cssModules)&&(J=J[y]))return J;if(b!==zi&&hi(b,y))return G[y]=4,b[y];if(pe=K.config.globalProperties,hi(pe,y))return pe[y]},set({_:d},y,b){const{data:M,setupState:I,ctx:B}=d;return I!==zi&&hi(I,y)?(I[y]=b,!0):M!==zi&&hi(M,y)?(M[y]=b,!0):hi(d.props,y)||y[0]==="$"&&y.slice(1)in d?!1:(B[y]=b,!0)},has({_:{data:d,setupState:y,accessCache:b,ctx:M,appContext:I,propsOptions:B}},G){let s;return!!b[G]||d!==zi&&hi(d,G)||y!==zi&&hi(y,G)||(s=B[0])&&hi(s,G)||hi(M,G)||hi(Xh,G)||hi(I.config.globalProperties,G)},defineProperty(d,y,b){return b.get!=null?d.$.accessCache[y]=0:hi(b,"value")&&this.set(d,y,b.value,null),Reflect.defineProperty(d,y,b)}},tA=yy();let iA=0;function rA(d,y,b){const M=d.type,I=(y?y.appContext:d.appContext)||tA,B={uid:iA++,vnode:d,type:M,parent:y,appContext:I,root:null,next:null,subTree:null,effect:null,update:null,scope:new Pg(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:y?y.provides:Object.create(I.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:fy(M,I),emitsOptions:oy(M,I),emit:null,emitted:null,propsDefaults:zi,inheritAttrs:M.inheritAttrs,ctx:zi,data:zi,props:zi,attrs:zi,slots:zi,refs:zi,setupState:zi,setupContext:null,suspense:b,suspenseId:b?b.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return B.ctx={_:B},B.root=y?y.root:B,B.emit=hv.bind(null,B),d.ce&&d.ce(B),B}let fr=null;const Al=d=>{fr=d,d.scope.on()},ua=()=>{fr&&fr.scope.off(),fr=null};function wy(d){return d.vnode.shapeFlag&4}let lu=!1;function nA(d,y=!1){lu=y;const{props:b,children:M}=d.vnode,I=wy(d);Rv(d,b,I,y),Nv(d,M);const B=I?oA(d,y):void 0;return lu=!1,B}function oA(d,y){const b=d.type;d.accessCache=Object.create(null),d.proxy=xf(new Proxy(d.ctx,eA));const{setup:M}=b;if(M){const I=d.setupContext=M.length>1?aA(d):null;Al(d),El();const B=gs(M,d,0,[d.props,I]);if(Cl(),ua(),zg(B)){if(B.then(ua,ua),y)return B.then(G=>{eg(d,G,y)}).catch(G=>{rd(G,d,0)});d.asyncDep=B}else eg(d,B,y)}else Ty(d,y)}function eg(d,y,b){Yt(y)?d.type.__ssrInlineRender?d.ssrRender=y:d.render=y:rr(y)&&(d.setupState=Kg(y)),Ty(d,b)}let tg;function Ty(d,y,b){const M=d.type;if(!d.render){if(!y&&tg&&!M.render){const I=M.template;if(I){const{isCustomElement:B,compilerOptions:G}=d.appContext.config,{delimiters:s,compilerOptions:K}=M,ue=Fr(Fr({isCustomElement:B,delimiters:s},G),K);M.render=tg(I,ue)}}d.render=M.render||Dn}Al(d),El(),Dv(d),Cl(),ua()}function sA(d){return new Proxy(d.attrs,{get(y,b){return un(d,"get","$attrs"),y[b]}})}function aA(d){const y=M=>{d.exposed=M||{}};let b;return{get attrs(){return b||(b=sA(d))},slots:d.slots,emit:d.emit,expose:y}}function Mf(d){if(d.exposed)return d.exposeProxy||(d.exposeProxy=new Proxy(Kg(xf(d.exposed)),{get(y,b){if(b in y)return y[b];if(b in Xh)return Xh[b](d)}}))}function lA(d){return Yt(d)&&d.displayName||d.name}function cA(d){return Yt(d)&&"__vccOpts"in d}const to=(d,y)=>ov(d,y,lu);function Ey(d,y,b){const M=arguments.length;return M===2?rr(y)&&!Zt(y)?$p(y)?li(d,null,[y]):li(d,y):li(d,null,y):(M>3?b=Array.prototype.slice.call(arguments,2):M===3&&$p(b)&&(b=[b]),li(d,y,b))}const uA="3.2.32",hA="http://www.w3.org/2000/svg",sa=typeof document!="undefined"?document:null,ig=sa&&sa.createElement("template"),dA={insert:(d,y,b)=>{y.insertBefore(d,b||null)},remove:d=>{const y=d.parentNode;y&&y.removeChild(d)},createElement:(d,y,b,M)=>{const I=y?sa.createElementNS(hA,d):sa.createElement(d,b?{is:b}:void 0);return d==="select"&&M&&M.multiple!=null&&I.setAttribute("multiple",M.multiple),I},createText:d=>sa.createTextNode(d),createComment:d=>sa.createComment(d),setText:(d,y)=>{d.nodeValue=y},setElementText:(d,y)=>{d.textContent=y},parentNode:d=>d.parentNode,nextSibling:d=>d.nextSibling,querySelector:d=>sa.querySelector(d),setScopeId(d,y){d.setAttribute(y,"")},cloneNode(d){const y=d.cloneNode(!0);return"_value"in d&&(y._value=d._value),y},insertStaticContent(d,y,b,M,I,B){const G=b?b.previousSibling:y.lastChild;if(I&&(I===B||I.nextSibling))for(;y.insertBefore(I.cloneNode(!0),b),!(I===B||!(I=I.nextSibling)););else{ig.innerHTML=M?`<svg>${d}</svg>`:d;const s=ig.content;if(M){const K=s.firstChild;for(;K.firstChild;)s.appendChild(K.firstChild);s.removeChild(K)}y.insertBefore(s,b)}return[G?G.nextSibling:y.firstChild,b?b.previousSibling:y.lastChild]}};function pA(d,y,b){const M=d._vtc;M&&(y=(y?[y,...M]:[...M]).join(" ")),y==null?d.removeAttribute("class"):b?d.setAttribute("class",y):d.className=y}function fA(d,y,b){const M=d.style,I=lr(b);if(b&&!I){for(const B in b)ef(M,B,b[B]);if(y&&!lr(y))for(const B in y)b[B]==null&&ef(M,B,"")}else{const B=M.display;I?y!==b&&(M.cssText=b):y&&d.removeAttribute("style"),"_vod"in d&&(M.display=B)}}const rg=/\s*!important$/;function ef(d,y,b){if(Zt(b))b.forEach(M=>ef(d,y,M));else if(y.startsWith("--"))d.setProperty(y,b);else{const M=mA(d,y);rg.test(b)?d.setProperty(Tl(M),b.replace(rg,""),"important"):d[M]=b}}const ng=["Webkit","Moz","ms"],Rp={};function mA(d,y){const b=Rp[y];if(b)return b;let M=no(y);if(M!=="filter"&&M in d)return Rp[y]=M;M=td(M);for(let I=0;I<ng.length;I++){const B=ng[I]+M;if(B in d)return Rp[y]=B}return y}const og="http://www.w3.org/1999/xlink";function _A(d,y,b,M,I){if(M&&y.startsWith("xlink:"))b==null?d.removeAttributeNS(og,y.slice(6,y.length)):d.setAttributeNS(og,y,b);else{const B=mx(y);b==null||B&&!Mg(b)?d.removeAttribute(y):d.setAttribute(y,B?"":b)}}function gA(d,y,b,M,I,B,G){if(y==="innerHTML"||y==="textContent"){M&&G(M,I,B),d[y]=b==null?"":b;return}if(y==="value"&&d.tagName!=="PROGRESS"&&!d.tagName.includes("-")){d._value=b;const s=b==null?"":b;(d.value!==s||d.tagName==="OPTION")&&(d.value=s),b==null&&d.removeAttribute(y);return}if(b===""||b==null){const s=typeof d[y];if(s==="boolean"){d[y]=Mg(b);return}else if(b==null&&s==="string"){d[y]="",d.removeAttribute(y);return}else if(s==="number"){try{d[y]=0}catch{}d.removeAttribute(y);return}}try{d[y]=b}catch{}}let Qh=Date.now,Cy=!1;if(typeof window!="undefined"){Qh()>document.createEvent("Event").timeStamp&&(Qh=()=>performance.now());const d=navigator.userAgent.match(/firefox\/(\d+)/i);Cy=!!(d&&Number(d[1])<=53)}let tf=0;const yA=Promise.resolve(),xA=()=>{tf=0},vA=()=>tf||(yA.then(xA),tf=Qh());function AA(d,y,b,M){d.addEventListener(y,b,M)}function bA(d,y,b,M){d.removeEventListener(y,b,M)}function wA(d,y,b,M,I=null){const B=d._vei||(d._vei={}),G=B[y];if(M&&G)G.value=M;else{const[s,K]=TA(y);if(M){const ue=B[y]=EA(M,I);AA(d,s,ue,K)}else G&&(bA(d,s,G,K),B[y]=void 0)}}const sg=/(?:Once|Passive|Capture)$/;function TA(d){let y;if(sg.test(d)){y={};let b;for(;b=d.match(sg);)d=d.slice(0,d.length-b[0].length),y[b[0].toLowerCase()]=!0}return[Tl(d.slice(2)),y]}function EA(d,y){const b=M=>{const I=M.timeStamp||Qh();(Cy||I>=b.attached-1)&&kn(CA(M,b.value),y,5,[M])};return b.value=d,b.attached=vA(),b}function CA(d,y){if(Zt(y)){const b=d.stopImmediatePropagation;return d.stopImmediatePropagation=()=>{b.call(d),d._stopped=!0},y.map(M=>I=>!I._stopped&&M&&M(I))}else return y}const ag=/^on[a-z]/,MA=(d,y,b,M,I=!1,B,G,s,K)=>{y==="class"?pA(d,M,I):y==="style"?fA(d,b,M):$h(y)?cf(y)||wA(d,y,b,M,G):(y[0]==="."?(y=y.slice(1),!0):y[0]==="^"?(y=y.slice(1),!1):SA(d,y,M,I))?gA(d,y,M,B,G,s,K):(y==="true-value"?d._trueValue=M:y==="false-value"&&(d._falseValue=M),_A(d,y,M,I))};function SA(d,y,b,M){return M?!!(y==="innerHTML"||y==="textContent"||y in d&&ag.test(y)&&Yt(b)):y==="spellcheck"||y==="draggable"||y==="form"||y==="list"&&d.tagName==="INPUT"||y==="type"&&d.tagName==="TEXTAREA"||ag.test(y)&&lr(b)?!1:y in d}const IA=["ctrl","shift","alt","meta"],zA={stop:d=>d.stopPropagation(),prevent:d=>d.preventDefault(),self:d=>d.target!==d.currentTarget,ctrl:d=>!d.ctrlKey,shift:d=>!d.shiftKey,alt:d=>!d.altKey,meta:d=>!d.metaKey,left:d=>"button"in d&&d.button!==0,middle:d=>"button"in d&&d.button!==1,right:d=>"button"in d&&d.button!==2,exact:(d,y)=>IA.some(b=>d[`${b}Key`]&&!y.includes(b))},My=(d,y)=>(b,...M)=>{for(let I=0;I<y.length;I++){const B=zA[y[I]];if(B&&B(b,y))return}return d(b,...M)},DA=Fr({patchProp:MA},dA);let lg;function kA(){return lg||(lg=jv(DA))}const PA=(...d)=>{const y=kA().createApp(...d),{mount:b}=y;return y.mount=M=>{const I=BA(M);if(!I)return;const B=y._component;!Yt(B)&&!B.render&&!B.template&&(B.template=I.innerHTML),I.innerHTML="";const G=b(I,!1,I instanceof SVGElement);return I instanceof Element&&(I.removeAttribute("v-cloak"),I.setAttribute("data-v-app","")),G},y};function BA(d){return lr(d)?document.querySelector(d):d}var LA=!1;/*!
  * pinia v2.0.13
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const RA=Symbol();var cg;(function(d){d.direct="direct",d.patchObject="patch object",d.patchFunction="patch function"})(cg||(cg={}));function FA(){const d=Mx(!0),y=d.run(()=>Xg({}));let b=[],M=[];const I=xf({install(B){I._a=B,B.provide(RA,I),B.config.globalProperties.$pinia=I,M.forEach(G=>b.push(G)),M=[]},use(B){return!this._a&&!LA?M.push(B):b.push(B),this},_p:b,_a:null,_e:d,_s:new Map,state:y});return I}const ld=da({isVisible:!1,index:"",showDetailedSer:!1,hideBotForm:()=>{globalThis.isVisible=!1}}),OA=da({isVisible:!1});/*!
  * vue-router v4.0.14
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const Sy=typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol",Sl=d=>Sy?Symbol(d):"_vr_"+d,NA=Sl("rvlm"),ug=Sl("rvd"),Sf=Sl("r"),Iy=Sl("rl"),rf=Sl("rvl"),_l=typeof window!="undefined";function UA(d){return d.__esModule||Sy&&d[Symbol.toStringTag]==="Module"}const Ci=Object.assign;function Fp(d,y){const b={};for(const M in y){const I=y[M];b[M]=Array.isArray(I)?I.map(d):d(I)}return b}const tu=()=>{},VA=/\/$/,GA=d=>d.replace(VA,"");function Op(d,y,b="/"){let M,I={},B="",G="";const s=y.indexOf("?"),K=y.indexOf("#",s>-1?s:0);return s>-1&&(M=y.slice(0,s),B=y.slice(s+1,K>-1?K:y.length),I=d(B)),K>-1&&(M=M||y.slice(0,K),G=y.slice(K,y.length)),M=WA(M!=null?M:y,b),{fullPath:M+(B&&"?")+B+G,path:M,query:I,hash:G}}function jA(d,y){const b=y.query?d(y.query):"";return y.path+(b&&"?")+b+(y.hash||"")}function hg(d,y){return!y||!d.toLowerCase().startsWith(y.toLowerCase())?d:d.slice(y.length)||"/"}function ZA(d,y,b){const M=y.matched.length-1,I=b.matched.length-1;return M>-1&&M===I&&bl(y.matched[M],b.matched[I])&&zy(y.params,b.params)&&d(y.query)===d(b.query)&&y.hash===b.hash}function bl(d,y){return(d.aliasOf||d)===(y.aliasOf||y)}function zy(d,y){if(Object.keys(d).length!==Object.keys(y).length)return!1;for(const b in d)if(!qA(d[b],y[b]))return!1;return!0}function qA(d,y){return Array.isArray(d)?dg(d,y):Array.isArray(y)?dg(y,d):d===y}function dg(d,y){return Array.isArray(y)?d.length===y.length&&d.every((b,M)=>b===y[M]):d.length===1&&d[0]===y}function WA(d,y){if(d.startsWith("/"))return d;if(!d)return y;const b=y.split("/"),M=d.split("/");let I=b.length-1,B,G;for(B=0;B<M.length;B++)if(G=M[B],!(I===1||G==="."))if(G==="..")I--;else break;return b.slice(0,I).join("/")+"/"+M.slice(B-(B===M.length?1:0)).join("/")}var cu;(function(d){d.pop="pop",d.push="push"})(cu||(cu={}));var iu;(function(d){d.back="back",d.forward="forward",d.unknown=""})(iu||(iu={}));function HA(d){if(!d)if(_l){const y=document.querySelector("base");d=y&&y.getAttribute("href")||"/",d=d.replace(/^\w+:\/\/[^\/]+/,"")}else d="/";return d[0]!=="/"&&d[0]!=="#"&&(d="/"+d),GA(d)}const YA=/^[^#]+#/;function XA(d,y){return d.replace(YA,"#")+y}function QA(d,y){const b=document.documentElement.getBoundingClientRect(),M=d.getBoundingClientRect();return{behavior:y.behavior,left:M.left-b.left-(y.left||0),top:M.top-b.top-(y.top||0)}}const cd=()=>({left:window.pageXOffset,top:window.pageYOffset});function KA(d){let y;if("el"in d){const b=d.el,M=typeof b=="string"&&b.startsWith("#"),I=typeof b=="string"?M?document.getElementById(b.slice(1)):document.querySelector(b):b;if(!I)return;y=QA(I,d)}else y=d;"scrollBehavior"in document.documentElement.style?window.scrollTo(y):window.scrollTo(y.left!=null?y.left:window.pageXOffset,y.top!=null?y.top:window.pageYOffset)}function pg(d,y){return(history.state?history.state.position-y:-1)+d}const nf=new Map;function $A(d,y){nf.set(d,y)}function JA(d){const y=nf.get(d);return nf.delete(d),y}let e2=()=>location.protocol+"//"+location.host;function Dy(d,y){const{pathname:b,search:M,hash:I}=y,B=d.indexOf("#");if(B>-1){let s=I.includes(d.slice(B))?d.slice(B).length:1,K=I.slice(s);return K[0]!=="/"&&(K="/"+K),hg(K,"")}return hg(b,d)+M+I}function t2(d,y,b,M){let I=[],B=[],G=null;const s=({state:pe})=>{const Ee=Dy(d,location),ut=b.value,Dt=y.value;let We=0;if(pe){if(b.value=Ee,y.value=pe,G&&G===ut){G=null;return}We=Dt?pe.position-Dt.position:0}else M(Ee);I.forEach(dt=>{dt(b.value,ut,{delta:We,type:cu.pop,direction:We?We>0?iu.forward:iu.back:iu.unknown})})};function K(){G=b.value}function ue(pe){I.push(pe);const Ee=()=>{const ut=I.indexOf(pe);ut>-1&&I.splice(ut,1)};return B.push(Ee),Ee}function he(){const{history:pe}=window;!pe.state||pe.replaceState(Ci({},pe.state,{scroll:cd()}),"")}function J(){for(const pe of B)pe();B=[],window.removeEventListener("popstate",s),window.removeEventListener("beforeunload",he)}return window.addEventListener("popstate",s),window.addEventListener("beforeunload",he),{pauseListeners:K,listen:ue,destroy:J}}function fg(d,y,b,M=!1,I=!1){return{back:d,current:y,forward:b,replaced:M,position:window.history.length,scroll:I?cd():null}}function i2(d){const{history:y,location:b}=window,M={value:Dy(d,b)},I={value:y.state};I.value||B(M.value,{back:null,current:M.value,forward:null,position:y.length-1,replaced:!0,scroll:null},!0);function B(K,ue,he){const J=d.indexOf("#"),pe=J>-1?(b.host&&document.querySelector("base")?d:d.slice(J))+K:e2()+d+K;try{y[he?"replaceState":"pushState"](ue,"",pe),I.value=ue}catch(Ee){console.error(Ee),b[he?"replace":"assign"](pe)}}function G(K,ue){const he=Ci({},y.state,fg(I.value.back,K,I.value.forward,!0),ue,{position:I.value.position});B(K,he,!0),M.value=K}function s(K,ue){const he=Ci({},I.value,y.state,{forward:K,scroll:cd()});B(he.current,he,!0);const J=Ci({},fg(M.value,K,null),{position:he.position+1},ue);B(K,J,!1),M.value=K}return{location:M,state:I,push:s,replace:G}}function r2(d){d=HA(d);const y=i2(d),b=t2(d,y.state,y.location,y.replace);function M(B,G=!0){G||b.pauseListeners(),history.go(B)}const I=Ci({location:"",base:d,go:M,createHref:XA.bind(null,d)},y,b);return Object.defineProperty(I,"location",{enumerable:!0,get:()=>y.location.value}),Object.defineProperty(I,"state",{enumerable:!0,get:()=>y.state.value}),I}function n2(d){return typeof d=="string"||d&&typeof d=="object"}function ky(d){return typeof d=="string"||typeof d=="symbol"}const hs={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},Py=Sl("nf");var mg;(function(d){d[d.aborted=4]="aborted",d[d.cancelled=8]="cancelled",d[d.duplicated=16]="duplicated"})(mg||(mg={}));function wl(d,y){return Ci(new Error,{type:d,[Py]:!0},y)}function ds(d,y){return d instanceof Error&&Py in d&&(y==null||!!(d.type&y))}const _g="[^/]+?",o2={sensitive:!1,strict:!1,start:!0,end:!0},s2=/[.+*?^${}()[\]/\\]/g;function a2(d,y){const b=Ci({},o2,y),M=[];let I=b.start?"^":"";const B=[];for(const ue of d){const he=ue.length?[]:[90];b.strict&&!ue.length&&(I+="/");for(let J=0;J<ue.length;J++){const pe=ue[J];let Ee=40+(b.sensitive?.25:0);if(pe.type===0)J||(I+="/"),I+=pe.value.replace(s2,"\\$&"),Ee+=40;else if(pe.type===1){const{value:ut,repeatable:Dt,optional:We,regexp:dt}=pe;B.push({name:ut,repeatable:Dt,optional:We});const Lt=dt||_g;if(Lt!==_g){Ee+=10;try{new RegExp(`(${Lt})`)}catch(Jt){throw new Error(`Invalid custom RegExp for param "${ut}" (${Lt}): `+Jt.message)}}let Xt=Dt?`((?:${Lt})(?:/(?:${Lt}))*)`:`(${Lt})`;J||(Xt=We&&ue.length<2?`(?:/${Xt})`:"/"+Xt),We&&(Xt+="?"),I+=Xt,Ee+=20,We&&(Ee+=-8),Dt&&(Ee+=-20),Lt===".*"&&(Ee+=-50)}he.push(Ee)}M.push(he)}if(b.strict&&b.end){const ue=M.length-1;M[ue][M[ue].length-1]+=.7000000000000001}b.strict||(I+="/?"),b.end?I+="$":b.strict&&(I+="(?:/|$)");const G=new RegExp(I,b.sensitive?"":"i");function s(ue){const he=ue.match(G),J={};if(!he)return null;for(let pe=1;pe<he.length;pe++){const Ee=he[pe]||"",ut=B[pe-1];J[ut.name]=Ee&&ut.repeatable?Ee.split("/"):Ee}return J}function K(ue){let he="",J=!1;for(const pe of d){(!J||!he.endsWith("/"))&&(he+="/"),J=!1;for(const Ee of pe)if(Ee.type===0)he+=Ee.value;else if(Ee.type===1){const{value:ut,repeatable:Dt,optional:We}=Ee,dt=ut in ue?ue[ut]:"";if(Array.isArray(dt)&&!Dt)throw new Error(`Provided param "${ut}" is an array but it is not repeatable (* or + modifiers)`);const Lt=Array.isArray(dt)?dt.join("/"):dt;if(!Lt)if(We)pe.length<2&&(he.endsWith("/")?he=he.slice(0,-1):J=!0);else throw new Error(`Missing required param "${ut}"`);he+=Lt}}return he}return{re:G,score:M,keys:B,parse:s,stringify:K}}function l2(d,y){let b=0;for(;b<d.length&&b<y.length;){const M=y[b]-d[b];if(M)return M;b++}return d.length<y.length?d.length===1&&d[0]===40+40?-1:1:d.length>y.length?y.length===1&&y[0]===40+40?1:-1:0}function c2(d,y){let b=0;const M=d.score,I=y.score;for(;b<M.length&&b<I.length;){const B=l2(M[b],I[b]);if(B)return B;b++}return I.length-M.length}const u2={type:0,value:""},h2=/[a-zA-Z0-9_]/;function d2(d){if(!d)return[[]];if(d==="/")return[[u2]];if(!d.startsWith("/"))throw new Error(`Invalid path "${d}"`);function y(Ee){throw new Error(`ERR (${b})/"${ue}": ${Ee}`)}let b=0,M=b;const I=[];let B;function G(){B&&I.push(B),B=[]}let s=0,K,ue="",he="";function J(){!ue||(b===0?B.push({type:0,value:ue}):b===1||b===2||b===3?(B.length>1&&(K==="*"||K==="+")&&y(`A repeatable param (${ue}) must be alone in its segment. eg: '/:ids+.`),B.push({type:1,value:ue,regexp:he,repeatable:K==="*"||K==="+",optional:K==="*"||K==="?"})):y("Invalid state to consume buffer"),ue="")}function pe(){ue+=K}for(;s<d.length;){if(K=d[s++],K==="\\"&&b!==2){M=b,b=4;continue}switch(b){case 0:K==="/"?(ue&&J(),G()):K===":"?(J(),b=1):pe();break;case 4:pe(),b=M;break;case 1:K==="("?b=2:h2.test(K)?pe():(J(),b=0,K!=="*"&&K!=="?"&&K!=="+"&&s--);break;case 2:K===")"?he[he.length-1]=="\\"?he=he.slice(0,-1)+K:b=3:he+=K;break;case 3:J(),b=0,K!=="*"&&K!=="?"&&K!=="+"&&s--,he="";break;default:y("Unknown state");break}}return b===2&&y(`Unfinished custom RegExp for param "${ue}"`),J(),G(),I}function p2(d,y,b){const M=a2(d2(d.path),b),I=Ci(M,{record:d,parent:y,children:[],alias:[]});return y&&!I.record.aliasOf==!y.record.aliasOf&&y.children.push(I),I}function f2(d,y){const b=[],M=new Map;y=yg({strict:!1,end:!0,sensitive:!1},y);function I(he){return M.get(he)}function B(he,J,pe){const Ee=!pe,ut=_2(he);ut.aliasOf=pe&&pe.record;const Dt=yg(y,he),We=[ut];if("alias"in he){const Xt=typeof he.alias=="string"?[he.alias]:he.alias;for(const Jt of Xt)We.push(Ci({},ut,{components:pe?pe.record.components:ut.components,path:Jt,aliasOf:pe?pe.record:ut}))}let dt,Lt;for(const Xt of We){const{path:Jt}=Xt;if(J&&Jt[0]!=="/"){const wi=J.record.path,It=wi[wi.length-1]==="/"?"":"/";Xt.path=J.record.path+(Jt&&It+Jt)}if(dt=p2(Xt,J,Dt),pe?pe.alias.push(dt):(Lt=Lt||dt,Lt!==dt&&Lt.alias.push(dt),Ee&&he.name&&!gg(dt)&&G(he.name)),"children"in ut){const wi=ut.children;for(let It=0;It<wi.length;It++)B(wi[It],dt,pe&&pe.children[It])}pe=pe||dt,K(dt)}return Lt?()=>{G(Lt)}:tu}function G(he){if(ky(he)){const J=M.get(he);J&&(M.delete(he),b.splice(b.indexOf(J),1),J.children.forEach(G),J.alias.forEach(G))}else{const J=b.indexOf(he);J>-1&&(b.splice(J,1),he.record.name&&M.delete(he.record.name),he.children.forEach(G),he.alias.forEach(G))}}function s(){return b}function K(he){let J=0;for(;J<b.length&&c2(he,b[J])>=0&&(he.record.path!==b[J].record.path||!By(he,b[J]));)J++;b.splice(J,0,he),he.record.name&&!gg(he)&&M.set(he.record.name,he)}function ue(he,J){let pe,Ee={},ut,Dt;if("name"in he&&he.name){if(pe=M.get(he.name),!pe)throw wl(1,{location:he});Dt=pe.record.name,Ee=Ci(m2(J.params,pe.keys.filter(Lt=>!Lt.optional).map(Lt=>Lt.name)),he.params),ut=pe.stringify(Ee)}else if("path"in he)ut=he.path,pe=b.find(Lt=>Lt.re.test(ut)),pe&&(Ee=pe.parse(ut),Dt=pe.record.name);else{if(pe=J.name?M.get(J.name):b.find(Lt=>Lt.re.test(J.path)),!pe)throw wl(1,{location:he,currentLocation:J});Dt=pe.record.name,Ee=Ci({},J.params,he.params),ut=pe.stringify(Ee)}const We=[];let dt=pe;for(;dt;)We.unshift(dt.record),dt=dt.parent;return{name:Dt,path:ut,params:Ee,matched:We,meta:y2(We)}}return d.forEach(he=>B(he)),{addRoute:B,resolve:ue,removeRoute:G,getRoutes:s,getRecordMatcher:I}}function m2(d,y){const b={};for(const M of y)M in d&&(b[M]=d[M]);return b}function _2(d){return{path:d.path,redirect:d.redirect,name:d.name,meta:d.meta||{},aliasOf:void 0,beforeEnter:d.beforeEnter,props:g2(d),children:d.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in d?d.components||{}:{default:d.component}}}function g2(d){const y={},b=d.props||!1;if("component"in d)y.default=b;else for(const M in d.components)y[M]=typeof b=="boolean"?b:b[M];return y}function gg(d){for(;d;){if(d.record.aliasOf)return!0;d=d.parent}return!1}function y2(d){return d.reduce((y,b)=>Ci(y,b.meta),{})}function yg(d,y){const b={};for(const M in d)b[M]=M in y?y[M]:d[M];return b}function By(d,y){return y.children.some(b=>b===d||By(d,b))}const Ly=/#/g,x2=/&/g,v2=/\//g,A2=/=/g,b2=/\?/g,Ry=/\+/g,w2=/%5B/g,T2=/%5D/g,Fy=/%5E/g,E2=/%60/g,Oy=/%7B/g,C2=/%7C/g,Ny=/%7D/g,M2=/%20/g;function If(d){return encodeURI(""+d).replace(C2,"|").replace(w2,"[").replace(T2,"]")}function S2(d){return If(d).replace(Oy,"{").replace(Ny,"}").replace(Fy,"^")}function of(d){return If(d).replace(Ry,"%2B").replace(M2,"+").replace(Ly,"%23").replace(x2,"%26").replace(E2,"`").replace(Oy,"{").replace(Ny,"}").replace(Fy,"^")}function I2(d){return of(d).replace(A2,"%3D")}function z2(d){return If(d).replace(Ly,"%23").replace(b2,"%3F")}function D2(d){return d==null?"":z2(d).replace(v2,"%2F")}function Kh(d){try{return decodeURIComponent(""+d)}catch{}return""+d}function k2(d){const y={};if(d===""||d==="?")return y;const M=(d[0]==="?"?d.slice(1):d).split("&");for(let I=0;I<M.length;++I){const B=M[I].replace(Ry," "),G=B.indexOf("="),s=Kh(G<0?B:B.slice(0,G)),K=G<0?null:Kh(B.slice(G+1));if(s in y){let ue=y[s];Array.isArray(ue)||(ue=y[s]=[ue]),ue.push(K)}else y[s]=K}return y}function xg(d){let y="";for(let b in d){const M=d[b];if(b=I2(b),M==null){M!==void 0&&(y+=(y.length?"&":"")+b);continue}(Array.isArray(M)?M.map(B=>B&&of(B)):[M&&of(M)]).forEach(B=>{B!==void 0&&(y+=(y.length?"&":"")+b,B!=null&&(y+="="+B))})}return y}function P2(d){const y={};for(const b in d){const M=d[b];M!==void 0&&(y[b]=Array.isArray(M)?M.map(I=>I==null?null:""+I):M==null?M:""+M)}return y}function Yc(){let d=[];function y(M){return d.push(M),()=>{const I=d.indexOf(M);I>-1&&d.splice(I,1)}}function b(){d=[]}return{add:y,list:()=>d,reset:b}}function ms(d,y,b,M,I){const B=M&&(M.enterCallbacks[I]=M.enterCallbacks[I]||[]);return()=>new Promise((G,s)=>{const K=J=>{J===!1?s(wl(4,{from:b,to:y})):J instanceof Error?s(J):n2(J)?s(wl(2,{from:y,to:J})):(B&&M.enterCallbacks[I]===B&&typeof J=="function"&&B.push(J),G())},ue=d.call(M&&M.instances[I],y,b,K);let he=Promise.resolve(ue);d.length<3&&(he=he.then(K)),he.catch(J=>s(J))})}function Np(d,y,b,M){const I=[];for(const B of d)for(const G in B.components){let s=B.components[G];if(!(y!=="beforeRouteEnter"&&!B.instances[G]))if(B2(s)){const ue=(s.__vccOpts||s)[y];ue&&I.push(ms(ue,b,M,B,G))}else{let K=s();I.push(()=>K.then(ue=>{if(!ue)return Promise.reject(new Error(`Couldn't resolve component "${G}" at "${B.path}"`));const he=UA(ue)?ue.default:ue;B.components[G]=he;const pe=(he.__vccOpts||he)[y];return pe&&ms(pe,b,M,B,G)()}))}}return I}function B2(d){return typeof d=="object"||"displayName"in d||"props"in d||"__vccOpts"in d}function vg(d){const y=ys(Sf),b=ys(Iy),M=to(()=>y.resolve(Kc(d.to))),I=to(()=>{const{matched:K}=M.value,{length:ue}=K,he=K[ue-1],J=b.matched;if(!he||!J.length)return-1;const pe=J.findIndex(bl.bind(null,he));if(pe>-1)return pe;const Ee=Ag(K[ue-2]);return ue>1&&Ag(he)===Ee&&J[J.length-1].path!==Ee?J.findIndex(bl.bind(null,K[ue-2])):pe}),B=to(()=>I.value>-1&&O2(b.params,M.value.params)),G=to(()=>I.value>-1&&I.value===b.matched.length-1&&zy(b.params,M.value.params));function s(K={}){return F2(K)?y[Kc(d.replace)?"replace":"push"](Kc(d.to)).catch(tu):Promise.resolve()}return{route:M,href:to(()=>M.value.href),isActive:B,isExactActive:G,navigate:s}}const L2=wf({name:"RouterLink",props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:vg,setup(d,{slots:y}){const b=da(vg(d)),{options:M}=ys(Sf),I=to(()=>({[bg(d.activeClass,M.linkActiveClass,"router-link-active")]:b.isActive,[bg(d.exactActiveClass,M.linkExactActiveClass,"router-link-exact-active")]:b.isExactActive}));return()=>{const B=y.default&&y.default(b);return d.custom?B:Ey("a",{"aria-current":b.isExactActive?d.ariaCurrentValue:null,href:b.href,onClick:b.navigate,class:I.value},B)}}}),R2=L2;function F2(d){if(!(d.metaKey||d.altKey||d.ctrlKey||d.shiftKey)&&!d.defaultPrevented&&!(d.button!==void 0&&d.button!==0)){if(d.currentTarget&&d.currentTarget.getAttribute){const y=d.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(y))return}return d.preventDefault&&d.preventDefault(),!0}}function O2(d,y){for(const b in y){const M=y[b],I=d[b];if(typeof M=="string"){if(M!==I)return!1}else if(!Array.isArray(I)||I.length!==M.length||M.some((B,G)=>B!==I[G]))return!1}return!0}function Ag(d){return d?d.aliasOf?d.aliasOf.path:d.path:""}const bg=(d,y,b)=>d!=null?d:y!=null?y:b,N2=wf({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},setup(d,{attrs:y,slots:b}){const M=ys(rf),I=to(()=>d.route||M.value),B=ys(ug,0),G=to(()=>I.value.matched[B]);Uh(ug,B+1),Uh(NA,G),Uh(rf,I);const s=Xg();return Vh(()=>[s.value,G.value,d.name],([K,ue,he],[J,pe,Ee])=>{ue&&(ue.instances[he]=K,pe&&pe!==ue&&K&&K===J&&(ue.leaveGuards.size||(ue.leaveGuards=pe.leaveGuards),ue.updateGuards.size||(ue.updateGuards=pe.updateGuards))),K&&ue&&(!pe||!bl(ue,pe)||!J)&&(ue.enterCallbacks[he]||[]).forEach(ut=>ut(K))},{flush:"post"}),()=>{const K=I.value,ue=G.value,he=ue&&ue.components[d.name],J=d.name;if(!he)return wg(b.default,{Component:he,route:K});const pe=ue.props[d.name],Ee=pe?pe===!0?K.params:typeof pe=="function"?pe(K):pe:null,Dt=Ey(he,Ci({},Ee,y,{onVnodeUnmounted:We=>{We.component.isUnmounted&&(ue.instances[J]=null)},ref:s}));return wg(b.default,{Component:Dt,route:K})||Dt}}});function wg(d,y){if(!d)return null;const b=d(y);return b.length===1?b[0]:b}const U2=N2;function V2(d){const y=f2(d.routes,d),b=d.parseQuery||k2,M=d.stringifyQuery||xg,I=d.history,B=Yc(),G=Yc(),s=Yc(),K=tv(hs);let ue=hs;_l&&d.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const he=Fp.bind(null,Be=>""+Be),J=Fp.bind(null,D2),pe=Fp.bind(null,Kh);function Ee(Be,ht){let Je,xt;return ky(Be)?(Je=y.getRecordMatcher(Be),xt=ht):xt=Be,y.addRoute(xt,Je)}function ut(Be){const ht=y.getRecordMatcher(Be);ht&&y.removeRoute(ht)}function Dt(){return y.getRoutes().map(Be=>Be.record)}function We(Be){return!!y.getRecordMatcher(Be)}function dt(Be,ht){if(ht=Ci({},ht||K.value),typeof Be=="string"){const it=Op(b,Be,ht.path),te=y.resolve({path:it.path},ht),de=I.createHref(it.fullPath);return Ci(it,te,{params:pe(te.params),hash:Kh(it.hash),redirectedFrom:void 0,href:de})}let Je;if("path"in Be)Je=Ci({},Be,{path:Op(b,Be.path,ht.path).path});else{const it=Ci({},Be.params);for(const te in it)it[te]==null&&delete it[te];Je=Ci({},Be,{params:J(Be.params)}),ht.params=J(ht.params)}const xt=y.resolve(Je,ht),ui=Be.hash||"";xt.params=he(pe(xt.params));const oi=jA(M,Ci({},Be,{hash:S2(ui),path:xt.path})),kt=I.createHref(oi);return Ci({fullPath:oi,hash:ui,query:M===xg?P2(Be.query):Be.query||{}},xt,{redirectedFrom:void 0,href:kt})}function Lt(Be){return typeof Be=="string"?Op(b,Be,K.value.path):Ci({},Be)}function Xt(Be,ht){if(ue!==Be)return wl(8,{from:ht,to:Be})}function Jt(Be){return cr(Be)}function wi(Be){return Jt(Ci(Lt(Be),{replace:!0}))}function It(Be){const ht=Be.matched[Be.matched.length-1];if(ht&&ht.redirect){const{redirect:Je}=ht;let xt=typeof Je=="function"?Je(Be):Je;return typeof xt=="string"&&(xt=xt.includes("?")||xt.includes("#")?xt=Lt(xt):{path:xt},xt.params={}),Ci({query:Be.query,hash:Be.hash,params:Be.params},xt)}}function cr(Be,ht){const Je=ue=dt(Be),xt=K.value,ui=Be.state,oi=Be.force,kt=Be.replace===!0,it=It(Je);if(it)return cr(Ci(Lt(it),{state:ui,force:oi,replace:kt}),ht||Je);const te=Je;te.redirectedFrom=ht;let de;return!oi&&ZA(M,xt,Je)&&(de=wl(16,{to:te,from:xt}),Or(xt,xt,!0,!1)),(de?Promise.resolve(de):Ki(te,xt)).catch(Te=>ds(Te)?ds(Te,2)?Te:Bi(Te):ci(Te,te,xt)).then(Te=>{if(Te){if(ds(Te,2))return cr(Ci(Lt(Te.to),{state:ui,force:oi,replace:kt}),ht||te)}else Te=mi(te,xt,!0,kt,ui);return _r(te,xt,Te),Te})}function Qi(Be,ht){const Je=Xt(Be,ht);return Je?Promise.reject(Je):Promise.resolve()}function Ki(Be,ht){let Je;const[xt,ui,oi]=G2(Be,ht);Je=Np(xt.reverse(),"beforeRouteLeave",Be,ht);for(const it of xt)it.leaveGuards.forEach(te=>{Je.push(ms(te,Be,ht))});const kt=Qi.bind(null,Be,ht);return Je.push(kt),pl(Je).then(()=>{Je=[];for(const it of B.list())Je.push(ms(it,Be,ht));return Je.push(kt),pl(Je)}).then(()=>{Je=Np(ui,"beforeRouteUpdate",Be,ht);for(const it of ui)it.updateGuards.forEach(te=>{Je.push(ms(te,Be,ht))});return Je.push(kt),pl(Je)}).then(()=>{Je=[];for(const it of Be.matched)if(it.beforeEnter&&!ht.matched.includes(it))if(Array.isArray(it.beforeEnter))for(const te of it.beforeEnter)Je.push(ms(te,Be,ht));else Je.push(ms(it.beforeEnter,Be,ht));return Je.push(kt),pl(Je)}).then(()=>(Be.matched.forEach(it=>it.enterCallbacks={}),Je=Np(oi,"beforeRouteEnter",Be,ht),Je.push(kt),pl(Je))).then(()=>{Je=[];for(const it of G.list())Je.push(ms(it,Be,ht));return Je.push(kt),pl(Je)}).catch(it=>ds(it,8)?it:Promise.reject(it))}function _r(Be,ht,Je){for(const xt of s.list())xt(Be,ht,Je)}function mi(Be,ht,Je,xt,ui){const oi=Xt(Be,ht);if(oi)return oi;const kt=ht===hs,it=_l?history.state:{};Je&&(xt||kt?I.replace(Be.fullPath,Ci({scroll:kt&&it&&it.scroll},ui)):I.push(Be.fullPath,ui)),K.value=Be,Or(Be,ht,Je,kt),Bi()}let ur;function Tr(){ur=I.listen((Be,ht,Je)=>{const xt=dt(Be),ui=It(xt);if(ui){cr(Ci(ui,{replace:!0}),xt).catch(tu);return}ue=xt;const oi=K.value;_l&&$A(pg(oi.fullPath,Je.delta),cd()),Ki(xt,oi).catch(kt=>ds(kt,12)?kt:ds(kt,2)?(cr(kt.to,xt).then(it=>{ds(it,20)&&!Je.delta&&Je.type===cu.pop&&I.go(-1,!1)}).catch(tu),Promise.reject()):(Je.delta&&I.go(-Je.delta,!1),ci(kt,xt,oi))).then(kt=>{kt=kt||mi(xt,oi,!1),kt&&(Je.delta?I.go(-Je.delta,!1):Je.type===cu.pop&&ds(kt,20)&&I.go(-1,!1)),_r(xt,oi,kt)}).catch(tu)})}let Jr=Yc(),en=Yc(),Ai;function ci(Be,ht,Je){Bi(Be);const xt=en.list();return xt.length?xt.forEach(ui=>ui(Be,ht,Je)):console.error(Be),Promise.reject(Be)}function Wt(){return Ai&&K.value!==hs?Promise.resolve():new Promise((Be,ht)=>{Jr.add([Be,ht])})}function Bi(Be){return Ai||(Ai=!Be,Tr(),Jr.list().forEach(([ht,Je])=>Be?Je(Be):ht()),Jr.reset()),Be}function Or(Be,ht,Je,xt){const{scrollBehavior:ui}=d;if(!_l||!ui)return Promise.resolve();const oi=!Je&&JA(pg(Be.fullPath,0))||(xt||!Je)&&history.state&&history.state.scroll||null;return Jg().then(()=>ui(Be,ht,oi)).then(kt=>kt&&KA(kt)).catch(kt=>ci(kt,Be,ht))}const Li=Be=>I.go(Be);let hr;const Ot=new Set;return{currentRoute:K,addRoute:Ee,removeRoute:ut,hasRoute:We,getRoutes:Dt,resolve:dt,options:d,push:Jt,replace:wi,go:Li,back:()=>Li(-1),forward:()=>Li(1),beforeEach:B.add,beforeResolve:G.add,afterEach:s.add,onError:en.add,isReady:Wt,install(Be){const ht=this;Be.component("RouterLink",R2),Be.component("RouterView",U2),Be.config.globalProperties.$router=ht,Object.defineProperty(Be.config.globalProperties,"$route",{enumerable:!0,get:()=>Kc(K)}),_l&&!hr&&K.value===hs&&(hr=!0,Jt(I.location).catch(ui=>{}));const Je={};for(const ui in hs)Je[ui]=to(()=>K.value[ui]);Be.provide(Sf,ht),Be.provide(Iy,da(Je)),Be.provide(rf,K);const xt=Be.unmount;Ot.add(Be),Be.unmount=function(){Ot.delete(Be),Ot.size<1&&(ue=hs,ur&&ur(),K.value=hs,hr=!1,Ai=!1),xt()}}}}function pl(d){return d.reduce((y,b)=>y.then(()=>b()),Promise.resolve())}function G2(d,y){const b=[],M=[],I=[],B=Math.max(y.matched.length,d.matched.length);for(let G=0;G<B;G++){const s=y.matched[G];s&&(d.matched.find(ue=>bl(ue,s))?M.push(s):b.push(s));const K=d.matched[G];K&&(y.matched.find(ue=>bl(ue,K))||I.push(K))}return[b,M,I]}var j2="/assets/Group338.cc02c2c4.png",Z2="/assets/Group406.5765f38c.png",q2="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD4AAAAoCAYAAACmTknCAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAm8SURBVHgB7VlpbFTXFT5v5r1ZbOOFpRhsaqAsZYvAqVD5UQKhPyo2qaWFAiJiqRCCH9QIVbgNDUGt3MQhtA1Bqdo/LUJggaKKVG1ToFQVSzFF4EBALF4Ag42Nd2zPjGfp992ZO31jYTMGBpo0R7q67725b+75znbPOU/kC/r/IkP+x2jHjh0jHzx4MLOpqcnV09NjhcNhy+VyWT6fr9Hv97dnZGTcXbNmTc38+fP98hT0woGvW7euIBQKrQbAWcFgsDASjgwLhUOCe4lEIoLf1Mx7PXCPKfwvjD/j939UV1efr6mp8Q1k3xcCfOPGjRnQ3mYw/n2AmKoBESQ0q2YOw4iy53A44td6HazBLgg/5jIIrvT06dOXk+HhuQJfu3btIJjtCjD5JsZwMg0BSEtLi3R1dQkYVyBN0xSsE8uy1HA6nUrrWgB6DgQC6j0OCoP/h7Uf4t3Xjx07drU/Xp4b8O3bt09pb239oy/QMw6WKt3d3XL37l3p6OhQQLKysiQ7O1sGDRokaWlp4na7FWgKgcC5hkSAFBDBPnz4UIGlABATpL29XVvAPaz/0alTp/bLiwReXFz8jc7Ozo/AcBYZr6urkzt37iitDhs2THJzc+Mg+Yz3FAKvKQRqm6atAVNoWhi8bmxsVEKgEG/duqXWxlxlW3l5+VvyIoBv3rx5OKbzYDqPAAj43r17MnLkSMnJyRGv1yv5+XkycfxEKRg9WnIG58TN227WnPXQGqbFNDQ0qLhAl9H3169fV2sYASGAhRcuXPhLb75MSTGB6d9g/zwyf//+faWdcePGSXpaurz88gyZMmWyDBk8FNoGWNMZB9wXUXi0hLy8PAgsX2mW/3np0iXBUacshXT5sopxkJPjg5kzZxZC8032/3FKCmnr1q1jwNj7uDTI4M2bN2XUqFEyfvx4WbRwAeaoAJxOSxw03Zg/E3iyg+7B+DBx4kT1Lt2Bz+rr65UbQFBZEPwduFe5nbeUahybzsCkolJra6sMHTpUpk6dInPnvCIej0ccBv3UBGhHdBhP53mTJk1S7kOroDXQHUiwkGWY9tjXOiSF5DSMr3MmIxxfGTtW5r06F4y4FWCn04xq2ha1n5ZGjBghhYWFyrI0IWbk9l6XUuAeT1qAM02Sx9S8eXOVGZowbTMO2tGvTz8JjYWAeTJoGjx4sAuCT8CaUuAvTX/J1KDS09Phi9nidEQjtsOMgn5Wmu5NVVVV8evZs2dbmCz77ykFPnr0aHPIkCHqmsfLp59eQeQ2o6Adz17Tms6dOycnT55U19xn8eLFEVxG7GtSCtxyOn2zZs2Ka7Xik0+kqroqeh/DrDKtcCSecoZD0XvGBNHcGpK0kHiWl5aWqujOdzZs2MCjrxbXAfu6lAJ3eTxl1DjBMykhnThxQioqKiQY6JEef0ACGH4kIAGfH3M3Rldsjj4LwlKCPcF4ldYfXblyRbZs2aLyBRI0LStWrKAAKnuvTWnmBkaNixcvXsbGk5mtETTTSmp27JgxiL4zcPxkiRExFCcOdTbDBRyGigPxYVoqwWFANK3ERIczi5x9+/YJChPlUrQolLuybNkyxQcC6tdwpJ1/bsBJ0G4hGDwNjbupsbNnz8qZM2cUeDKYjwxsAjK5/LyRCWkpx3+BRwGbsWrNMl2UklRWVsrRo0eVT2uBTpgwQTZt2iSTJ0/WLPwa+f7m3nylHDjSyQUoID5AtZXPo4yM0w+PHz8uN27cUMWFPudx7CB9zZFMHH08ATJwElAA+BXFSbd0POyQZmj39u3byPlrdT6uKjkmL0uWLJHp06fHYwqEdhWangPBN0gqgS9fvnwoNhm7f//+c+iIDMf1bgD6LgCb1JwGzmsWE6jYpLa2Vq5du6aEwLJSBznddemjA6OOR4KdNm2aiiHMCm3EYPAeCqDt4KH9Ubw+E+Dr16+3UHUVITf+KaJpOja7jVI0C8VIlh2svubc3Nysykd79cWSU5eYbW1tauYaEvNxJkGZmZkqQWHQ7CPSV+D/fwBN/7s/np8KOIPXokWLFkIr78LsxukmAWeCKykpUeVnb+BkuPF+gzrPdbFh9237fX+/9SJKaC9K1DfgMm2P4/2Jga9evXo8oukuaGQhwBq6T6aBc9AU0TWNd1E4R/C8GVpV3RJYpOX2QpMZ4kXD4VGA+wMe5j7Yj5btslx19Y2NOCzGJNV0HHB1BsDZMMk3YYob4W9mf2crz1UGsoKCAqFVhhGMOhl9wbATjPf4fQhYnWoNjyg2JRio9GDdrS0imtyEVOLBd7mvidnj9Ygb71mmmYtE5av4+WIyOJIGDs25UE+/Bj8uBRPZj0smSNQ6wLeh7v6nxzQX+ZGQ0NRpFQSlgpcKWBHxoYPSFujbQl04x71ul3ggEC9KWpa1Joai6KlgGJHItyRJ4Ellbkj7XkXSXw4gv8VttiRJ1NShQ4e2DR+eu9hpmT8maBeY1xoliDSPV9K9bslIg7YhDFXA2BoN1K7bwjsunuEmNatcJm7+THiMuAsEk+WtX41Dy7noXPwK/azvUaIyQILp9sAlPuZ1RmZ2SXtrU6PbcO+FSCztq84YEJcVEA9S0yD9llaATqxaA1Cm06GyNgKHL8fbzlY8i2MjwzzpqDX3JMvbI4Hv3r07G0nCOoB+HVpOWsN2Qj18FsnET3bu3Fmtn2VmD/ldR0er5XA495JZzTzNXndRdWBUSY3E0lhkaSpdjQlJv2O58T5mZHQtkOJqY4yR9NeUBC1Sq0VFRUtwNL0D/yvQn3B0tObQSYVm0s4sB9LDCkTzt3bt2nWgr0272tu/HY5E3g8G/CMIuIeajrWE7QmMJnsKq8GbrpjQ3O46dHKKXV7v72UAlAAclc1CJA0fMXFgu5ZJAzdMBjjW1aPf9Q40vAfNxMd+0AOwL/t8na+EAsEFbAEjYqeHYv/P0pSmHmdSH2EJhYvZjOLll75A4D3s2yoDpARTR6ScT9AkAmI6yQSkv1qYv+G9t1EJ/WLlypUtBw4cSGpjZneY9nEgWxvk9abNsiKh14xQZA6MPA8WAVcP+wC4G7v78IIPJo9702cYzo89aZ538R/N8oSUABwmlCA5apJtWjbw7EQzxKZhmNpR9LGLUBJePXLkiDwp4WtKB6a/ccSCKFzbCEkKKQE4Eo2/o4gvtj9juccCoJfWKxFcflhWVvYnecaEfejcKQVNSgCOIuAEAH2Iy+/oZ/qTLKMozK4LGik5fPjwz2MMfmYpIYFZunRpCFXPG7issT+Hr3UA9NsoI/MOHjz4s886aNIjo9aqVau+hKj+B3z9+Caqnb/CBbbBj5P64P65IPTIMuQL+nzRfwAvmzxCxnCF2AAAAABJRU5ErkJggg==",Tg="/assets/farxod.833046d4.png";var dn=(d,y)=>{const b=d.__vccOpts||d;for(const[M,I]of y)b[M]=I;return b};const W2={},H2={class:"homeIntroImg"},Y2=Ml('<div class="blueBlock1" data-v-2fe4c2f7></div><div class="blueBlock2" data-v-2fe4c2f7></div><img class="introMan" src="'+j2+'" alt="You are welcome" data-v-2fe4c2f7><img class="progress" src="'+Z2+'" alt="You are welcome" data-v-2fe4c2f7><img class="lupa" src="'+q2+'" alt="You are welcome" data-v-2fe4c2f7><div class="smallCard" data-v-2fe4c2f7><img src="'+Tg+'" alt="\u0424\u0430\u0440\u0445\u043E\u0434 \u0418\u0441\u0440\u043E\u0438\u043B\u043E\u0432" data-v-2fe4c2f7><div data-v-2fe4c2f7><h2 class="smallCardName" data-v-2fe4c2f7>\u0424\u0430\u0440\u0445\u043E\u0434 \u0418\u0441\u0440\u043E\u0438\u043B\u043E\u0432</h2><p data-v-2fe4c2f7>\u041D\u0430\u043B\u043E\u0433\u043E\u0432\u044B\u0439 \u043A\u043E\u043D\u0441\u0443\u043B\u044C\u0442\u0430\u043D\u0442</p></div></div><div class="smallCard secondSmallCard" data-v-2fe4c2f7><img src="'+Tg+'" alt="\u0424\u0430\u0440\u0445\u043E\u0434 \u0418\u0441\u0440\u043E\u0438\u043B\u043E\u0432" data-v-2fe4c2f7><div data-v-2fe4c2f7><h2 class="smallCardName" data-v-2fe4c2f7>OOO \u201C\u041C\u0415\u0427\u0422\u0410\u201D</h2><p data-v-2fe4c2f7>\u041C\u043D\u0435 \u043D\u0443\u0436\u043D\u0430 \u0432\u0430\u0448\u0430 \u043F\u043E\u043C\u043E\u0449\u044C</p></div></div>',7),X2=[Y2];function Q2(d,y,b,M,I,B){return $r(),hn("div",H2,X2)}var K2=dn(W2,[["render",Q2],["__scopeId","data-v-2fe4c2f7"]]);const $2={components:{HomeIntroImg:K2},data(){return{showForm:ld}},methods:{showBottForm(d){if(d==2){this.showForm.isVisible=!1;return}this.showForm.isVisible=!this.showForm.isVisible},fireForm(){setTimeout(()=>{this.showBottForm(1)},200)}}},Uy=d=>(pa("data-v-3bb56337"),d=d(),fa(),d),J2={class:"home-intro-text"},eb=Uy(()=>Xe("h1",null,[ir(" \u041D\u0430\u0434\u0435\u0436\u043D\u0430\u044F "),Xe("br"),ir(),Xe("span",{class:"yellow"},"\u0411\u0423\u0425\u0413\u0410\u041B\u0422\u0415\u0420\u0418\u042F"),Xe("br"),ir(" \u0434\u043B\u044F "),Xe("span",{class:"yellow"},"\u0412\u0410\u0428\u0415\u0413\u041E \u0411\u0418\u0417\u041D\u0415\u0421\u0410")],-1)),tb=Uy(()=>Xe("p",null,[ir(" \u0412\u044B \u0437\u0430\u043D\u0438\u043C\u0430\u0435\u0442\u0435\u0441\u044C \u0431\u0438\u0437\u043D\u0435\u0441\u043E\u043C, \u043C\u044B \u0437\u0430\u043D\u0438\u043C\u0430\u0435\u043C\u0441\u044F \u0412\u0430\u0448\u0435\u0439 \u0431\u0443\u0445\u0433\u0430\u043B\u0442\u0435\u0440\u0438\u0435\u0439."),Xe("br"),ir("\u0412\u0430\u0448\u0430 \u043B\u0438\u0447\u043D\u0430\u044F \u043A\u043E\u043C\u0430\u043D\u0434\u0430 \u043F\u0440\u043E\u0444\u0435\u0441\u0441\u0438\u043E\u043D\u0430\u043B\u044C\u043D\u044B\u0445 \u0431\u0443\u0445\u0433\u0430\u043B\u0442\u0435\u0440\u043E\u0432, \u043A\u043E\u0442\u043E\u0440\u0430\u044F \u0432\u0441\u0435\u0433\u0434\u0430 \u043F\u043E\u0434 \u0440\u0443\u043A\u043E\u0439. ")],-1));function ib(d,y,b,M,I,B){const G=Rr("HomeIntroImg");return $r(),hn("div",{class:"home-intro",onClick:y[1]||(y[1]=s=>B.showBottForm(2))},[Xe("div",J2,[eb,tb,Xe("button",{onClick:y[0]||(y[0]=(...s)=>B.fireForm&&B.fireForm(...s))},"\u041E\u0441\u0442\u0430\u0432\u0438\u0442\u044C \u0437\u0430\u044F\u0432\u043A\u0443")]),li(G)])}var rb=dn($2,[["render",ib],["__scopeId","data-v-3bb56337"]]);const nb={props:["title","description","imageUrl"]},ob={class:"serviceCard"},sb=["innerHTML"],ab=["innerHTML"],lb={class:"image"},cb=["src"];function ub(d,y,b,M,I,B){return $r(),hn("div",ob,[Xe("h3",{innerHTML:b.title},null,8,sb),Xe("p",{innerHTML:b.description},null,8,ab),Xe("div",lb,[Xe("img",{src:b.imageUrl,alt:"Service"},null,8,cb)])])}var hb=dn(nb,[["render",ub],["__scopeId","data-v-67d2c57f"]]),db="/assets/calc.b9b52796.png",pb="/assets/stamp.ec76809c.png",fb="/assets/files.866f037e.png",mb="/assets/taxy.91c24906.png",_b="/assets/man.36f21450.png";const gb={components:{ServiceCard:hb},data(){return{card1:{title:"\u0411\u0443\u0445\u0433\u0430\u043B\u0442\u0435\u0440\u0441\u043A\u043E\u0435 \u0441\u043E\u043F\u0440\u043E\u0432\u043E\u0436\u0434\u0435\u043D\u0438e",description:"\u0411\u0435\u0440\u0451\u043C \u043D\u0430 \u0441\u0435\u0431\u044F \u0432\u0441\u044E \u0431\u0443\u0433\u0430\u043B\u0442\u0435\u0440\u0438\u044E!<br>\u0412\u0435\u0434\u0435\u043C \u043D\u0430\u043B\u043E\u0433\u043E\u0432\u044B\u0439 \u0443\u0447\u0435\u0442 \u0438 \u0433\u043E\u0442\u043E\u0432\u0438\u043C \u0441\u0447\u0435\u0442\u0430 \u043A \u043E\u043F\u043B\u0430\u0442\u0435 \u0432\u043E\u0432\u0440\u0435\u043C\u044F \u0438 \u0431\u0435\u0437 \u0437\u0430\u0434\u0435\u0440\u0436\u0435\u043A.",path:db},card2:{title:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044F \u043A\u043E\u043C\u043F\u0430\u043D\u0438\u0438",description:"\u041F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u043E\u0435 \u043E\u0444\u043E\u0440\u043C\u043B\u0435\u043D\u0438\u0435 \u0434\u043E\u043A\u0443\u043C\u0435\u043D\u0442\u043E\u0432, \u0431\u044B\u0441\u0442\u0440\u043E\u0435 \u0438 \u043B\u0435\u0433\u043A\u043E\u0435 \u043F\u0440\u043E\u0445\u043E\u0436\u0434\u0435\u043D\u0438\u0435 \u043F\u0440\u043E\u0446\u0435\u0434\u0443\u0440\u044B \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438, \u043F\u043E\u043B\u0443\u0447\u0435\u043D\u0438\u0435 \u0441\u0432\u0438\u0434\u0435\u0442\u0435\u043B\u044C\u0441\u0442\u0432.",path:pb},card3:{title:"\u0412\u043E\u0441\u0441\u0442\u0430\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u0435<br>\u0431\u0443\u0445\u0433\u0430\u043B\u0442\u0435\u0440\u0441\u043A\u043E\u0433\u043E \u0443\u0447\u0435\u0442\u0430",description:"\u0412\u0441\u0435 \u0434\u043E\u043A\u0443\u043C\u0435\u043D\u0442\u044B \u043F\u0440\u0438\u0432\u043E\u0434\u044F\u0442\u0441\u044F \u0432 \u043F\u043E\u0440\u044F\u0434\u043E\u043A \u0438 \u0432\u043E\u0441\u0441\u0442\u0430\u043D\u0430\u0432\u043B\u0438\u0432\u0430\u044E\u0442\u0441\u044F \u043E\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044E\u0449\u0438\u0435 \u0434\u043E\u043A\u0443\u043C\u0435\u043D\u0442\u044B.",path:fb},card4:{title:"\u041F\u0435\u0440\u0435\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044F<br>\u044E\u0440\u0438\u0434\u0438\u0447\u0435\u0441\u043A\u043E\u0433\u043E \u043B\u0438\u0446\u0430",description:"\u041B\u044E\u0431\u044B\u0435 \u0438\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u044F, \u0441\u0432\u044F\u0437\u0430\u043D\u043D\u044B\u0435 \u0441 \u0438\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u0435\u043C \u043F\u043E\u043B\u043E\u0436\u0435\u043D\u0438\u0439 \u0443\u0447\u0440\u0435\u0434\u0438\u0442\u0435\u043B\u044C\u043D\u044B\u0445 \u0434\u043E\u043A\u0443\u043C\u0435\u043D\u0442\u043E\u0432 \u0444\u0438\u0440\u043C\u044B.",path:mb},card5:{title:"\u0420\u0430\u0437\u0440\u0435\u0448\u0435\u043D\u0438\u0435 \u043D\u0430<br>\u043F\u0440\u0438\u0432\u043B\u0435\u0447\u0435\u043D\u0438\u0435 \u0438\u043D\u043E\u0441\u0442\u0440\u0430\u043D\u043D\u043E\u0439<br>\u0440\u0430\u0431\u043E\u0447\u0435\u0439 \u0441\u0438\u043B\u044B",description:"\u0411\u044B\u0441\u0442\u0440\u043E\u0435 \u0438 \u043B\u0435\u0433\u043A\u043E\u0435 \u043F\u0440\u043E\u0445\u043E\u0436\u0434\u0435\u043D\u0438\u0435 \u043F\u0440\u043E\u0446\u0435\u0434\u0443\u0440\u044B.",path:_b},showForm:ld}},methods:{showBotForm(){this.showForm.isVisible=!this.showForm.isVisible}},created(){window.addEventListener("scroll",d=>{window.scrollY>260&&document.getElementById("groupOne").classList.add("showCards"),window.scrollY>530&&document.getElementById("groupTwo").classList.add("showCards")})},unmounted(){window.removeEventListener("scroll",d=>{d.removeEventListener()})}},yb=d=>(pa("data-v-b4c0b730"),d=d(),fa(),d),xb=yb(()=>Xe("h1",null,"\u041D\u0410\u0428\u0418 \u0423\u0421\u041B\u0423\u0413\u0418",-1)),vb={class:"cards",id:"groupOne"},Ab={class:"cards",id:"groupTwo"},bb=ir("\u0412\u0441\u0435 \u0443\u0441\u043B\u0443\u0433\u0438");function wb(d,y,b,M,I,B){const G=Rr("ServiceCard"),s=Rr("RouterLink");return $r(),hn("div",{class:"homeService",onClick:y[0]||(y[0]=(...K)=>I.showForm.hideBotForm&&I.showForm.hideBotForm(...K))},[xb,Xe("div",vb,[li(G,{class:"",title:I.card1.title,description:I.card1.description,imageUrl:I.card1.path},null,8,["title","description","imageUrl"]),li(G,{class:"",title:I.card2.title,description:I.card2.description,imageUrl:I.card2.path},null,8,["title","description","imageUrl"])]),Xe("div",Ab,[li(G,{class:"",title:I.card3.title,description:I.card3.description,imageUrl:I.card3.path},null,8,["title","description","imageUrl"]),li(G,{class:"",title:I.card4.title,description:I.card4.description,imageUrl:I.card4.path},null,8,["title","description","imageUrl"]),li(G,{class:"",title:I.card5.title,description:I.card5.description,imageUrl:I.card5.path},null,8,["title","description","imageUrl"])]),li(s,{to:"/service"},{default:aa(()=>[bb]),_:1})])}var Tb=dn(gb,[["render",wb],["__scopeId","data-v-b4c0b730"]]),Eb="/assets/aboutImg.a4f61460.png";window.addEventListener("scroll",()=>{const d=document.getElementById("box");window.scrollY>1500&&d.classList.add("showImg")});const Cb={},zf=d=>(pa("data-v-bade05ee"),d=d(),fa(),d),Mb=zf(()=>Xe("div",{class:"corner-block"},null,-1)),Sb=zf(()=>Xe("img",{src:Eb,alt:""},null,-1)),Ib=zf(()=>Xe("div",{class:"corner-block2"},null,-1)),zb=[Mb,Sb,Ib];function Db(d,y,b,M,I,B){return $r(),hn("div",{class:xs(["home-about-img",d.showAboutImg?"showImg":""]),id:"box"},zb,2)}var kb=dn(Cb,[["render",Db],["__scopeId","data-v-bade05ee"]]);const Pb={components:{HomeAboutImg:kb}};window.addEventListener("scroll",()=>{const d=document.getElementById("abourText");window.scrollY>1500&&d.classList.add("showText")});const Vy=d=>(pa("data-v-ed049b30"),d=d(),fa(),d),Bb=Vy(()=>Xe("h1",null,"\u041E \u043D\u0430\u0441",-1)),Lb={class:"details"},Rb=Ml('<p id="abourText" class="about-text" data-v-ed049b30>\u041A\u043E\u043D\u0441\u0430\u043B\u0442\u0438\u043D\u0433\u043E\u0432\u043E\u0435 \u0430\u0433\u0435\u043D\u0442\u0441\u0442\u0432\u043E &quot;GrossProfit&quot; \u0431\u044B\u043B\u0430 \u043E\u0441\u043D\u043E\u0432\u0430\u043D\u0430 \u0432 2019 \u0433\u043E\u0434\u0443 \u0434\u043B\u044F \u0442\u043E\u0433\u043E, \u0447\u0442\u043E\u0431\u044B \u043F\u043E\u043C\u043E\u0447\u044C \u0434\u0440\u0443\u0437\u044C\u044F\u043C \u043F\u043E \u0431\u0438\u0437\u043D\u0435\u0441\u0443 \u0441 \u0431\u0443\u0445\u0433\u0430\u043B\u0442\u0435\u0440\u0441\u043A\u0438\u043C \u0438 \u043D\u0430\u043B\u043E\u0433\u043E\u0432\u044B\u043C \u0443\u0447\u0435\u0442\u043E\u043C. <br data-v-ed049b30><br data-v-ed049b30> \u0421 \u0441\u0430\u043C\u043E\u0433\u043E \u043D\u0430\u0447\u0430\u043B\u0430 \u043D\u0430\u0448\u0438\u043C \u0433\u043B\u0430\u0432\u043D\u044B\u043C \u043F\u0440\u0438\u043D\u0446\u0438\u043F\u043E\u043C \u0431\u044B\u043B\u043E \u0440\u0430\u0431\u043E\u0442\u0430\u0442\u044C \u0434\u043E\u0431\u0440\u043E\u0441\u043E\u0432\u0435\u0441\u0442\u043D\u043E, \u0430 \u043D\u0435 \u0437\u0430\u0446\u0438\u043A\u043B\u0438\u0432\u0430\u0442\u044C\u0441\u044F \u043D\u0430 \u0441\u0438\u044E\u043C\u0438\u043D\u0443\u0442\u043D\u043E\u0439 \u043F\u0440\u0438\u0431\u044B\u043B\u0438. \u041F\u043E\u043C\u043E\u0433\u0430\u044F \u043E\u0440\u0433\u0430\u043D\u0438\u0437\u043E\u0432\u0430\u0442\u044C \u0431\u0438\u0437\u043D\u0435\u0441 \u0431\u043B\u0438\u0437\u043A\u0438\u043C \u043B\u044E\u0434\u044F\u043C, \u043C\u044B \u0440\u0430\u0437\u0434\u0435\u043B\u044F\u043B\u0438 \u0441 \u043D\u0438\u043C\u0438 \u043E\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0435\u043D\u043D\u043E\u0441\u0442\u044C \u0437\u0430 \u043F\u0440\u0438\u043D\u0438\u043C\u0430\u0435\u043C\u044B\u0435 \u0440\u0435\u0448\u0435\u043D\u0438\u044F, \u0441\u0442\u0440\u0435\u043C\u0438\u043B\u0438\u0441\u044C \u0441\u0442\u0430\u0442\u044C \u043B\u0443\u0447\u0448\u0435 \u0438 \u0442\u0435\u043C \u0441\u0430\u043C\u044B\u043C \u0434\u0430\u0442\u044C \u043F\u0430\u0440\u0442\u043D\u0435\u0440\u0430\u043C \u0435\u0449\u0435 \u0431\u043E\u043B\u044C\u0448\u0435. </p><div class="years-cards" data-v-ed049b30><div class="years-card" data-v-ed049b30><div class="text" data-v-ed049b30><h2 data-v-ed049b30>3+</h2><p data-v-ed049b30>\u043B\u0435\u0442 \u043D\u0430 \u0440\u044B\u043D\u043A\u0435 \u0423\u0437\u0431\u0435\u043A\u0438\u0441\u0442\u0430\u043D\u0430</p></div><div class="corner" data-v-ed049b30></div></div><div class="years-card" data-v-ed049b30><div class="text" data-v-ed049b30><h2 data-v-ed049b30>40+</h2><p data-v-ed049b30>\u0434\u043E\u0432\u043E\u043B\u043D\u0438\u0445 \u043A\u043B\u0438\u0435\u043D\u0442\u043E\u0432</p></div><div class="blue corner" data-v-ed049b30></div></div><div class="years-card" data-v-ed049b30><div class="text" data-v-ed049b30><h2 data-v-ed049b30>100%</h2><p data-v-ed049b30>\u043A\u043E\u043D\u0444\u0438\u0434\u0435\u043D\u0446\u0438\u0430\u043B\u044C\u043D\u043E\u0441\u0442\u044C \u0432\u0430\u0448\u0438\u0445 \u0434\u0430\u043D\u043D\u044B\u0445</p></div><div class="corner" data-v-ed049b30></div></div></div>',2),Fb=Vy(()=>Xe("button",null," \u041F\u043E\u0434\u0440\u043E\u0431\u043D\u0435\u0435",-1));function Ob(d,y,b,M,I,B){const G=Rr("HomeAboutImg"),s=Rr("RouterLink");return $r(),hn("div",{class:"home-about",onClick:y[0]||(y[0]=(...K)=>d.showForm.hideBotForm&&d.showForm.hideBotForm(...K))},[Bb,Xe("div",Lb,[li(G),Rb]),li(s,{to:"/about"},{default:aa(()=>[Fb]),_:1})])}var Nb=dn(Pb,[["render",Ob],["__scopeId","data-v-ed049b30"]]),Ub="/assets/mountain.da13267f.png",Vb="/assets/train.6d027718.png",Gb="/assets/team.bf3d4ed0.png",jb="/assets/vestco.8dc13c30.png",Zb="/assets/plant.4a655a19.png";const qb={},Wb=Ml('<div class="stake-holders-text" data-v-7f628765><h1 data-v-7f628765>\u041F\u043E\u0447\u0435\u043C\u0443 \u043D\u0443\u0436\u043D\u043E \u0432\u044B\u0431\u0440\u0430\u0442\u044C <br data-v-7f628765>\u0438\u043C\u0435\u043D\u043D\u043E \u043D\u0430\u0441?</h1><h3 data-v-7f628765>\u041C\u044B \u043F\u043E\u043C\u043E\u0436\u0435\u043C \u0441\u043E\u043A\u0440\u0430\u0442\u0438\u0442\u044C <span class="yellow" data-v-7f628765>\u0440\u0430\u0441\u0445\u043E\u0434\u044B \u043D\u0430 15%</span></h3><p data-v-7f628765>\u041E\u0431\u0440\u0430\u0442\u0438\u0442\u0435\u0441\u044C \u043A \u043D\u0430\u043C \u0438 \u0443\u0432\u0435\u043B\u0438\u0447\u044C\u0442\u0435 \u043C\u0430\u0442\u0435\u0440\u0438\u0430\u043B\u044C\u043D\u0443\u044E \u0432\u044B\u0433\u043E\u0434\u0443, \u0442\u0430\u043A \u043A\u0430\u043A \u0431\u0438\u0437\u043D\u0435\u0441 \u0441\u0442\u0430\u043D\u0435\u0442 \u0431\u043E\u043B\u0435\u0435 \u043F\u0440\u043E\u0437\u0440\u0430\u0447\u043D\u044B\u043C</p><div class="smallCards" data-v-7f628765><div class="smallCard" data-v-7f628765><p data-v-7f628765>\u0421\u043E\u043A\u0440\u0430\u0442\u0438\u043C \u0432\u0430\u0448\u0438 \u0440\u0430\u0441\u0445\u043E\u0434\u044B</p><h4 data-v-7f628765>1</h4></div><div class="smallCard" data-v-7f628765><p data-v-7f628765>\u041F\u043E\u043B\u043D\u043E\u0441\u0442\u044C\u044E \u0437\u0430\u043C\u0435\u043D\u0438\u043C \u0448\u0442\u0430\u0442\u043D\u043E\u0433\u043E \u0431\u0443\u0445\u0433\u0430\u043B\u0442\u0435\u0440\u0430</p><h4 data-v-7f628765>2</h4></div><div class="smallCard" data-v-7f628765><p data-v-7f628765>\u0412\u043E\u0432\u0435\u0440\u0435\u043C\u044F \u0441\u0434\u0430\u0434\u0438\u043C \u0432\u0441\u044E \u043E\u0442\u0447\u0435\u0442\u043D\u043E\u0441\u0442\u044C</p><h4 data-v-7f628765>3</h4></div></div></div><div class="stakeHolders" data-v-7f628765><h1 data-v-7f628765>\u041D\u0430\u043C \u0434\u043E\u0432\u0435\u0440\u044F\u0435\u0442 </h1><h6 data-v-7f628765><img src="'+Ub+'" alt="" data-v-7f628765><img src="'+Vb+'" alt="" data-v-7f628765></h6><h6 data-v-7f628765><img src="'+Gb+'" alt="" data-v-7f628765><img src="'+jb+'" alt="" data-v-7f628765></h6><h6 data-v-7f628765><img src="'+Zb+'" alt="" data-v-7f628765></h6></div>',2),Hb=[Wb];function Yb(d,y,b,M,I,B){return $r(),hn("div",{class:"home-stake-holders",onClick:y[0]||(y[0]=(...G)=>d.showForm.hideBotForm&&d.showForm.hideBotForm(...G))},Hb)}var Xb=dn(qb,[["render",Yb],["__scopeId","data-v-7f628765"]]),Qb="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADkAAAA4CAYAAABHRFAgAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAaDSURBVHgBzVq9c9xEFH97MeNAzIxSgN2x6eg4U6WL0jndpaOzjvwBsUsqnzs67H8glstUJB1UVrpQ5dJB5XVnoDlmAmMobnlPu/JJq11p9eHz/WZysXS7e/vT+9j3IQY1CHgU3IXBcwlyxACG+naC/+JLcXIKK4gt/mwXQIaX4sWYrln14IjjkDP8kzuGCFzs8aWIBawIFMF5rK5YTESZe3AtwRQSYIaL7K2CVIsEM7D4jn2wH8F0CYC7+N9oI/gaPszevYFbgp0gQR4PyoPtBNEmj69A3se/HoCySXOxyRYf78ItoILgGE0pZsXBLgnKQxw8McbiNTuwLEw2moDX5qIQYJB7MDJpqvZ1BOkvQ5LsBDwIEugeSne/tDSwH9XD8gKOk1HuXwgN4EOQMFhMiCL8LzQGWwlm+F3ER7Rg/h6qRkDa0IBoK/gSJOQkaaqejKsIZlALFolCKiF2Rmcs3ACaECSkJD/n0QjKnvQQPKGJmuM5ut096BlNCRIG6oONjAlx0wNeSz0prALsOfSINgQJmbp+AcXNvYJWkGMKDrIrss++bLMtQUJKUi5i0hRzkBfQAiR9liPZF7oQJKQklUdc4E8RT6EFNvkzUk+ev9c1ru1KkDCAnvAZj1Ab5pPiXRlDB/RBkNALSYpc0HmdmRoBDTx0ec1+CBIykqL4A/7OQh0/NoJpICGgBfokSMgcj+ksuMfc9GEwFQqamzn0CSTsa/ZLkKAdj3xfWM7wtm6wiSlBimfbEsT1wr4JEjJJFrwpbvyruolapY3USh6qeLY1ePlWN4KElOS8HKmMPOby4iWlSW0l6EJ3goQ1+qBzcZOPZ5nq6UglrMoL8cEERddcWS5qA4EyeLTFv33kP8Wej67lBuCXi1gTVZikmbiWGxgqjgg3ebTXUV3z4CrHbAJJHyWS18JAORjxKtutSpX08ZAYcw5UULBauCZJqpl3QKSydakSxrjH+Wuac6dZZWApWMtf4FHyGj9zkmDkPSeuyX+I+BUSOjQSbq4rAz712MSScHeBsN0seAtSz3Vg58bZF9UVl2xFLdKKf7GoNRNx71lJUxTqrlez6dWnwfBjdShfY7gWDE/pO9ciH2bTZCMYsvw8vNhC1d35KBi+rJq7DJQCdNzNkRHmeZUx1BlZLIFQ72T9Bms9vihV0G3SxOBgiPdeosQqVW9VJWpNtUxp6jLjCXhgFSVq7YXQE78XDH/DDOOb3G2O9/76ezZ9CzWokihqxM91GtE3alp3Y2oZhNm16mDJbd880dFKEG3bfapXqjx/k/m1/Um0x3fGkSKw8bPtezT0QVT3aMhcwuIaLMGQpDY5ryx/0GRpqY6vw8DLPvUaE1vh2beVoIpj7BxKLYwstq1f5w7UAG3wV7TF+2ifD7N7KNkvm/QjbTYKyplhX3P42mWjmIEcoHl8D9WoXaeWJAGJ/nQv2KZ3BrZyt0NfR0RoSpQkaCcoBc4xvXSAZhWhU/sF1xHmDO9qHf7gUzBiQ5TuD00ar76qqyQ4L6Rs6khL7fiBagTL0+JeVDeN0j0o7b0BKI1ylB6jJs1TdwMXKBMKmFFjIoKY8Tw2i96udajOlM9rvdQ1wz+z6SWpBC4cGZsIXapig0N1CdwwiRSoRU8w43lrW4dMBjVqpzie7WwE2wK/Twt0jUjqhQVu8AJydSD1cgSL8gt7rOMieg19Lj+pKsOQTzD3o+eGn2DgQYJpTFJvcOrY4KiFM7rQOaxZnE7wB4hgbV9G76f04NG0diiD6lR9ctsWm1yKF4fQAGTv+MQDKpD9h7bZJg9Fp3PEjJ4o2WcnknrhPfKy5n3qcaKH3F/221pmKIpIOjd8yIuh53tqthrQlkawhBckyigeUdQN6KWrRbUecvFQrrFwCsno3IMl4arcDQh660+qM8xKFPTbWufLkCq90Vn4ZSTd2SZtsDmAxY8y/G5+fBO2qjRGToq/J/dbHSF1oFjXdTTgU32o4tXtme+Z6gMbQQS9w/DdjUhy8cOpek50/dYGob6Xb7pI1kUwy1lvlORiE/RKW3qecvcoFmMCfOr78qFel1uSaYLIJ+VLIbnYEESOwPwa6ihKM36KeEidRV7KtA4GDBhupdHWriVZEGbVYWkkM3iocBcIW1ll6SQzqPoRjLQX5tAZMsGPsc22b41kHurl3lSVqeHKG0zNkunKNv5KkMyDCEv1zkKo7Y3jNvliBJU/AAts8J56qj6O6n/sSXLF3EZLYQAAAABJRU5ErkJggg==",Up="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAmCAYAAADAzmuWAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAD1SURBVHgBtdY7DoMwDAZgB68MjIwcoeoJOErVi0Bv0qO0J2iP0LEjAzMpQVDxCGDH5pciObb0KcqSAPRJs2vpFigFBxTAFm2Zx8nZ1NXrAcLgCB2igkcAjV22bSG9Fqyr9zNOTm1p8tlMdPLujo/AcSi0cRxvNHGcN7Rw9DU1cFwbSHHcGkrwTViC78KhOAkOwckwF2fBHJwNU/EgmIJHIEpk/P3GGgiM5+XpY8vv534LgvdQV7FhCsqGqSgL5qBkmIuS4BB0Fw5FN2EJugpLUS+sgS5gLXQCa6J/WBvt4CNQl7X/sQh18fyP5egkaXYp3AKl/ABe/gUeGbQ3WAAAAABJRU5ErkJggg==",Kb="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADoAAAA8CAYAAAA34qk1AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAX3SURBVHgBzVq9cttGEN6j5LEy9kyQIpG7nJ4glKuUdJcuUpnKpP0App5AYJmK0gtYUJV0oquUprp0Qrp0vnRy0jAzzow0GfO8iwNN/BzugOOB5DcD/gC4n73v9va7BRi0iID3gz3ovMKfXJ2Zj25FJGADYNASnvB+D6u/gM9Gfm4yvBWvR7BmeDeUWHwInVMGcmi4TQDIZ+tkdwc8gljcBfYbjt4PllsDHOPh4+ApfJjdXMMa4IVRO4sywqZ6UJrGCcQ62O3Aivia97t7wG4qjBSpEQP6xuNScw/HQXj3hL84hRaxEqOqczLUXZMgz+8BwpmIZvky/T42S0ZxTTHRFrtOhmJnuQR2hYW7mssCOzvAzk5N5fErxOaf6+/wvzI3NnSfv8S4OA9ZsqDkUcViFdbJbm1DFQtJXOyBvlNGFs31ts9uLUMtLE6QxUFdFqvQNrvM0jivYlECzNDIwd8imoAnKN+HIQP2Sn+HO7usutGXzyXMz3QsoplT/Bi0Ffuq5WMC4eImJUPT4H+BcfGoeI1YxM/RexGdQctQ/YCwil1c9c/ucZNQ12VyhppHsl0Wq+CL3cRQk4RbJ4tV8MEuU3tGdgOaEUMjYzT+eFN7yCJs7N6BPKwytrOnFhtNQWLx4nBbjCTQFCVjSJhoLvM97cKpUCXqBR5T2EIQY+hvFNJEk3K7Fec5TpG3+/xFo5WtbSwiAmgigg0dNTXlAWhGiBYn8l/aisGGQcrpIW7nmN5IYVNOxfASpjJMd+tGcj0WjQ20lqCBIVjANBX3LHFrbbkek8amuP4R4OQfEcV16tJKQFvcaptdm8Z2ies2Ud9bN7s2FsFRnVm3aetilxa8HWBj8MhiFk023r222DXlnnxp7EapFN/s0uChTh3rck++NbZrcqy3Cru2PLCvrEUWTpn6D7NYPA66b/DnV2hwkQ1jFt6SzRdo5jGy+PPdLL4Dj2Bp45wkHzjs+ermemqwaMwgUjvpNA+a9pHgRRnZMnm0X0ylG4eGndxKZWRht9xFC4sUUxnMh+nKe41KKP4f++Diu96VkT1Pm0DYWeycYnIuxoG49LEotaaMqtmVI1xlzky+iOXkrbi4BI9oVRkt87TwJf3HqXdeJcKVMqLXAMyP/1XqRy1IOGAzpyygCW0rI/TXo6r8VCos8Dr8WGyfhAWep8GLTLNg48ooHTzQDZR9xS1B4BHqDN64MlKMyMOykaYnBWYg+6is5jll5fTEW62Wbk+waZDyT8jlqGwklZ1HLkYSKGZj2uUtDejyHNRSRq6xU1iUkcBpdlCor5f2xQemWP8z+pFoXdSuMzzOUb+y9KWKLIzaFcvFNt37KHgaPMCQotG3Qyz/x+JPOuBX0JxJgQP6RtM+fxR0//1vFv++SWWkYdO0L63GR/RxClv7vE+PHMfZa7QG3GOWs+Sjtmy4yf+wbGTw3SwEKaPyadmHxpCjRWxWe1d5oPayCuTnGCn6W6OMXHyT9q1o3HH23De8f9RR0z+LqXE/SvvO3aB7iTd9gVPi+8LlWr6Lo8twNP/EUzEqI3pC/qtur4m+NNS0YYLAen+i9WVxgnwc6/gFyj7Ot0IZEfDxx5X+4bOc0AJZDDULv8zXMbhh+leC6sfRVXy3DtBIzYsgENPUJEEBuUcmS79cgNquMlLV7wAfyqjsowPyz15VPcsHTHOo6Zc5bEwZZVWLgvwr+28O8iQ7WDQw78XrY0qaFerjnUJI0cH5pUfqBB79NEyI8h0yRJbepRvxhBH0w/FCgT0o70LifMfYFcXFYq3FmSAVkxwMoHCz8tudltjJiV0ysPgG6E7Bn1jBUHWOjU1+b/PLZT1y4uSj1Q03UUYyUq+3ZsuX/FTdqXmXoo5fZsofeTWUsErOyNJ5KkN7XY4T+1u1Ua+liROp6d3QBdxzRnpW3SEPaCa0ZiihSc4oW8awZWyIZc63VUNd4cfYfGJ75VW3DaQvkNCGeQoNkb51elLM3m8lo1nUXcnT3BPqYtCmS7fe0AVUyjMJE9/hd5CuuCI9rnGBm5hyvJ8Ao3wUs/GYuwIAAAAASUVORK5CYII=",$b="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD0AAAA6CAYAAAADZ1FRAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAbISURBVHgBzVtNVtxGEK6WecGLvBe8SGDn5gQMJ7C8S1bACdA4BwBOwMwJgAsE+QQ2J7A4QSa77GjvcLKAvJcFJA91qtTSTKvVUuunhfO9B0Iaqaeqq/qrnxYMnglbPAolsH0GsCcBNvC4gcd7PC4kyI94vLoVsYBnAIORgcpy/JpL/DN03YuTcv4I6fxexPcwIkZV+gceoWXZJVm1w2MC1X87ptVHU/p7Hk1eAPsV+kGMqXgAI4BcGhX+UP1EJqTMA8hXt4IcQG7jzxQyJUvg+ZIYBaNYeotPYzwclq/KOVpu1vEZsnYCnuHd0hs8IlbeK19tVpiAlo/wkJSvslMYAd6V/gZZ2iAu4VJ4BTk3LoQ0ieAZ3pXGASflK7SO24FcGb1koV97WRlvOMYgMm6cX0MHMJC/OcYbjFHYewgkBN/ByBhDaaGfyM7uKXnTeD7gXenUWJPosIdtyYjiOzMm6aEy3nCsQb0AIc7JG1iuqfQz/kpccfMfvGddFRKZonRch4BCzwk4YSYkMnHl4TShRHaqmGHZ0pCQLpoKmEpy0qJAEK4UEceYVWMsm92KX+ZQK3hwhuNGxkcRxu/3UAN3bs/iB0hPzIkrKU35cgDsk6tAoJIwRcX/FPGiXoks7+bGRwk+d0HeQILQBFMig4IfV++VMU7stE6GLf4OJ1XOwA2Bae+urjhbDZJZ+BO0DBGqFpa7dRZXyyMbrw9Ekzfh2FHH3ByX5eXb4kQjMjaD6mwnqiDIfkpuprwhqE0Tae2jVQ9ocqAbhLvCKi8d+g5sRFyQnHg8hirjh8oIS9kVNvn0ruzW1XzZtlapYmoim9yFz9CF98EBEvwRYNY0Hq3jwKjgntDj9KWWLy+6J9RuW1o7yAVrlS/n14R+bR3YG2gAWeyLiA/IeuQtqNhipSR5QeZNc5o8vO/YxdasQrAyNrlFjVHO4/V8oSZkSQG1kJhWMr4SQr6CFshDXQIDYSHZ67rvw3LV+lxm6Sdj3WHMa2Bv9tq49w6eERaO4Lb7FDHbkSn9r+GylBXpC98YKCzfWykQxoYon9ZlfEGpIaFXb1rImlJ4CbWbKKs6xrV2ReeqxMvCBNcH+iIud+EZQQoij9yYHETMTS6tPg9OmWJxHctERwtZ5YWfDxojC969zFy4GsPxnnN4ZhBJsSw8lcBJPjScJFktCgvFRQovij/+vl+IbzcmqAcLoRWykHYBXwFrG5MFNh5/RGG3XPfm2eNPf4j49+KaLfeeuXpTGHZOMLy0tjJxAVZfmOI2preCKqq2jf680DinNd00JsbwAzOksToh8TDDWdrBpCKPb1Lg+RW5dJt+dF5EHFGG5MrldRBPqO+oLzQMWUM8RBhF9lZbRVkucI2TeG6bRAYjYJP/fISl6KyLshaIsRr+3psIVP0wSM8HKkzgaJMbJKdD8Ayvlq4r9zSXE7bnil1MG4m6ytg+8KZ0Xpre6NdyZS/q1pZ9DJhZyAlrgctt8ISK0gUBocghJel93XSIhdpEENd3M5WBxTZCZMaX0cb5Bw/rkRC1ZWAbNnmEvMCOYDiESYhLpW11al/QTGN62qr6qkNeE/sqZoSueFFPc1T4DDyBaTVzXxAHSH/tX663l/J62toqmncgoFgnHxTWS+WlKjg20WSioiJ2PadeCIBjgxCzlhEVJUUTweh+uLdWDfFel4Xt/QZCWQpFSDp4m+dy8owwxpNcofYRTUIS5LUo1x/qprBNGPkZPIBV3fs1dILZMlJeE5hboV3XUc2kJeABacsuSR0sW0KcfgXVDbZuVrJMWteWby2C6r4Yhw7I+Ugsn0YbKdKuNgY6WdqcNB/MXeBhoKUJ6NIL43wnQNLZMS52IiFWYtdsEv4CTzAtRWhq+NmRGp4rtyvunXYnIYO5/W6tyoHWNuXBc7J0OeXskSuH+onPNU3w8DqGMJ8PTCG7vM1DSYB57f9mafN+Wn6BKeR6w6acCWYR4MmzpaFqqY6xulytkb5r2MPCvteqeKf2KTYDUPD0vatVwywb9z6LfQJaRvTJyvKt4lPL/TFr2EDvI+Dg6sqErTnRH2qjP6Cw8NRvH7kCnzG6wIO/5SLwJ0tLs9KSXDLNtlKHvb7UvPH3NaHePi6Wq63ZH+HhkJLzfh0Uue2zbdvjVQslRb73jTpcmLXA4MagZeMPm/XywIfiORmVNg1dL+C0wRoMBr2LorN/trtJ/eoEjwJ6AqMK5QATy0dzGIjBliZs8nfYTJT7MDq6Njfs8LLD8QjpFDngI4wKPwoTvFi6QE46toRgALL3xec+/63Bq9IFKCenFDUY0D+nrknxZiF4xn8ENCLeobOzZgAAAABJRU5ErkJggg==",Jb="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAABACAYAAABcIPRGAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAQ9SURBVHgB7ZrNbhMxEMf/TkGtBBLhAO0N9wlIb9xIn4DyBN3AAwA3bqRPQHkB2D4B4caNcONGeQLMraWHhgNSK9SYmf1Am91sas9utUHan9Q2dp1Zj3c8Ho+tUAMbOtD0R/t85wKYnJjwEBVRENLVQXcNnWcW9jkJ6UKAJSUU1AiY7h2Z0ECASIF4xNUneI76Agypsy1RogMRtXYesSz1DgIKb4BN4zoJXCk1i85DGq1htobM6JAETeD3aI3CINgBorcxH3pD44KUbGFDP3nlb9M2JMEDCFjXwT7NgWceXzHUZXre27204p8JbejBJx5ZwYQ8gBB61sjvG/zG7HBdD76mFZECPPL0pw8ZfcjREECK98iRDKPPsTtUp7k2hjQdl3xdo9BpFZIr/AwvOvfy5krlUflcUn1kFGYXfA67qe7qYKcD9T7T0pzBbk1MOFcQK7wK9V3q+xdgjsy7zUUN2HR49NMyKbHT6RQ6Yg/KOs/w/xTsY9SOvdQR0HM/5Mq3ResAu7MLektY4PI8MMkiNoaAaxCSxDGbNJn6EExkev2nZA7fpB1PESuQknRgjIYQhhLLQ6tA07QKNE2rQNO0CjRN5ZW4Kml2g4KLvoWiQHH6wmdz76xAEkbzju0+xNhBvnO0F9mn+l3+rHhHQHE/xVdbrko4K7AKcOd99q9ziDIP22kpSYjtzrSgsaJA7znin0txngN1bGCsowx61i044jOJh6gQ//MWkAxkL1uXmIkptlZjOOJsQsnDNpPX7s05KTB/p2e3Sbn3lF7p2Wg/bPeOTeic6fD2QtIc5iXytthJLNrKlrE064Ck80y7EjdNq0Bd8CSGAG8vJHWjZyVuNDks4RWaQoiByWefL8NZgaqnMmuRjEFA6cOcj5+RqTn7TM/67JovcjahJD7RqMYwW7ijg16JzF044hMLifz0LNZkSyslMmmwfsERZxMiG95fg9X08R4ExCeSeJGt41V4XT+hlLrdybXbd5XrrEAyAQPUzLF5+5iOmvic4BEVzRR4c3IVG5qrhII3HnHnUc/SLmRN0yrQNEsxiePUCtiVGt8TGy8FkuMkDQHkHic/TTgqynxKq+40TMt0EnlIx6fbrhscn1gokF7IYDqxDL5WM0zr4gh0Osy242PU1Xi9cXKrPnOgj8qomRjnevw2daGVR/LMR4ExKjN7+v+HbN7OjYeuJq0SkgnwRw0BfKxKK+6bbB3bOYURFPur15lqvinwwVWu1yRmJVAzHEbQwPDkDhB1HiOfDMVSuNEkNzSEgHYlbppWgaZhBcxsldqVpk6uknjVVvnNvlElN7AM6rkLVBu0jvTyfeQbXtdKFhONei+2VqZwwRU2yi+t8K/fk8MvN7q923TI8AD/BfaA1o7oDG0lrSIlPt7s9n6QrpxsqvtCX01Yjp34BOdlWqPmNUs2GD0sCXxVn5Ng806H/gLb14gD5xk/bgAAAABJRU5ErkJggg==";const ew={},tw=Ml('<h1 data-v-4a632190>\u042D\u0442\u0430\u043F\u044B \u0440\u0430\u0431\u043E\u0442\u044B \u0441 \u043D\u0430\u043C\u0438<br data-v-4a632190>\u043E\u0447\u0435\u043D \u043F\u0440\u043E\u0441\u0442\u044B</h1><div class="smallCards" data-v-4a632190><div class="frame" data-v-4a632190><div class="smallCard" data-v-4a632190><img src="'+Qb+'" alt="" data-v-4a632190></div><div class="cornerBlock" data-v-4a632190></div><p data-v-4a632190>\u0412\u044B \u043E\u0441\u0442\u0430\u0432\u0434\u044F\u0435\u0442\u0435 \u0437\u0430\u044F\u0432\u043A\u0443 \u0438 \u043D\u0430\u0448 \u043C\u0435\u043D\u0435\u0434\u0436\u0435\u0440 \u0441\u0432\u044F\u0437\u044B\u0432\u0430\u0435\u0442\u0441\u044F \u0441 \u0412\u0430\u043C\u0438</p></div><img class="arrow" src="'+Up+'" alt="" data-v-4a632190><div class="frame topMargin" data-v-4a632190><div class="smallCard" data-v-4a632190><img src="'+Kb+'" alt="" data-v-4a632190></div><div class="cornerBlock blue" data-v-4a632190></div><p data-v-4a632190>\u041E\u043F\u0440\u0435\u0434\u0435\u043B\u044F\u0435\u043C \u043F\u043B\u0430\u043D \u0440\u0430\u0431\u043E\u0442\u044B, \u0441\u0442\u043E\u0438\u043C\u043E\u0441\u0442\u044C \u0438 \u043F\u043E\u0434\u043F\u0438\u0441\u044B\u0432\u0430\u0435\u043C \u0434\u043E\u0433\u043E\u0432\u043E\u0440</p></div><img class="arrow" src="'+Up+'" alt="" data-v-4a632190><div class="frame" data-v-4a632190><div class="smallCard" data-v-4a632190><img src="'+$b+'" alt="" data-v-4a632190></div><div class="cornerBlock" data-v-4a632190></div><p data-v-4a632190>\u041D\u0430\u0448\u0438 \u0441\u043F\u0435\u0446\u0438\u0430\u043B\u0438\u0441\u0442\u044B \u043F\u0440\u0438\u0432\u043E\u0434\u044F\u0442 \u0432 \u043F\u043E\u0440\u044F\u0434\u043E\u043A \u043E\u0442\u0447\u0435\u0442\u043D\u043E\u0441\u0442\u044C</p></div><img class="arrow" src="'+Up+'" alt="" data-v-4a632190><div class="frame" data-v-4a632190><div class="smallCard" data-v-4a632190><img src="'+Jb+'" alt="" data-v-4a632190></div><div class="cornerBlock blue" data-v-4a632190></div><p data-v-4a632190>\u0412\u044B \u0440\u0435\u0433\u0443\u043B\u044F\u0440\u043D\u043E \u043F\u043E\u043B\u0443\u0447\u0430\u0435\u0442\u0435 \u0433\u043E\u0442\u043E\u0432\u0443\u044E \u043E\u0442\u0447\u0435\u0442\u043D\u043E\u0441\u0442\u044C</p></div></div>',2),iw=[tw];function rw(d,y,b,M,I,B){return $r(),hn("div",{class:"home-contact-details",onClick:y[0]||(y[0]=(...G)=>d.showForm.hideBotForm&&d.showForm.hideBotForm(...G))},iw)}var nw=dn(ew,[["render",rw],["__scopeId","data-v-4a632190"]]),ow=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},Gy={exports:{}};(function(d,y){(function(b,M){d.exports=M()})(ow,function(){var b,M,I;function B(s,K){if(!b)b=K;else if(!M)M=K;else{var ue="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+b+")(sharedChunk); ("+M+")(sharedChunk); self.onerror = null;",he={};b(he),I=K(he),typeof window!="undefined"&&window&&window.URL&&window.URL.createObjectURL&&(I.workerUrl=window.URL.createObjectURL(new Blob([ue],{type:"text/javascript"})))}}B(["exports"],function(s){var K="2.8.1",ue=he;function he(i,e,r,n){this.cx=3*i,this.bx=3*(r-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(n-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=n,this.p2x=r,this.p2y=n}he.prototype.sampleCurveX=function(i){return((this.ax*i+this.bx)*i+this.cx)*i},he.prototype.sampleCurveY=function(i){return((this.ay*i+this.by)*i+this.cy)*i},he.prototype.sampleCurveDerivativeX=function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},he.prototype.solveCurveX=function(i,e){var r,n,a,c,h;for(e===void 0&&(e=1e-6),a=i,h=0;h<8;h++){if(c=this.sampleCurveX(a)-i,Math.abs(c)<e)return a;var p=this.sampleCurveDerivativeX(a);if(Math.abs(p)<1e-6)break;a-=c/p}if((a=i)<(r=0))return r;if(a>(n=1))return n;for(;r<n;){if(c=this.sampleCurveX(a),Math.abs(c-i)<e)return a;i>c?r=a:n=a,a=.5*(n-r)+r}return a},he.prototype.solve=function(i,e){return this.sampleCurveY(this.solveCurveX(i,e))};var J=pe;function pe(i,e){this.x=i,this.y=e}pe.prototype={clone:function(){return new pe(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,e){return this.clone()._rotateAround(i,e)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var e=i.x-this.x,r=i.y-this.y;return e*e+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,e){return Math.atan2(this.x*e-this.y*i,this.x*i+this.y*e)},_matMult:function(i){var e=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=e,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var e=Math.cos(i),r=Math.sin(i),n=r*this.x+e*this.y;return this.x=e*this.x-r*this.y,this.y=n,this},_rotateAround:function(i,e){var r=Math.cos(i),n=Math.sin(i),a=e.y+n*(this.x-e.x)+r*(this.y-e.y);return this.x=e.x+r*(this.x-e.x)-n*(this.y-e.y),this.y=a,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},pe.convert=function(i){return i instanceof pe?i:Array.isArray(i)?new pe(i[0],i[1]):i};var Ee=typeof self!="undefined"?self:{};const ut=Math.PI/180,Dt=180/Math.PI;function We(i){return i*ut}function dt(i){return i*Dt}const Lt=[[0,0],[1,0],[1,1],[0,1]];function Xt(i){if(i<=0)return 0;if(i>=1)return 1;const e=i*i,r=e*i;return 4*(i<.5?r:3*(i-e)+r-.75)}function Jt(i,e,r,n){const a=new ue(i,e,r,n);return function(c){return a.solve(c)}}const wi=Jt(.25,.1,.25,1);function It(i,e,r){return Math.min(r,Math.max(e,i))}function cr(i,e,r){return(r=It((r-i)/(e-i),0,1))*r*(3-2*r)}function Qi(i,e,r){const n=r-e,a=((i-e)%n+n)%n+e;return a===e?r:a}function Ki(i,e,r){if(!i.length)return r(null,[]);let n=i.length;const a=new Array(i.length);let c=null;i.forEach((h,p)=>{e(h,(_,x)=>{_&&(c=_),a[p]=x,--n==0&&r(c,a)})})}function _r(i){const e=[];for(const r in i)e.push(i[r]);return e}function mi(i,...e){for(const r of e)for(const n in r)i[n]=r[n];return i}let ur=1;function Tr(){return ur++}function Jr(){return function i(e){return e?(e^Math.random()*(16>>e/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,i)}()}function en(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function Ai(i){return!!i&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(i)}function ci(i,e){i.forEach(r=>{e[r]&&(e[r]=e[r].bind(e))})}function Wt(i,e){return i.indexOf(e,i.length-e.length)!==-1}function Bi(i,e,r){const n={};for(const a in i)n[a]=e.call(r||this,i[a],a,i);return n}function Or(i,e,r){const n={};for(const a in i)e.call(r||this,i[a],a,i)&&(n[a]=i[a]);return n}function Li(i){return Array.isArray(i)?i.map(Li):typeof i=="object"&&i?Bi(i,Li):i}const hr={};function Ot(i){hr[i]||(typeof console!="undefined"&&console.warn(i),hr[i]=!0)}function Ui(i,e,r){return(r.y-i.y)*(e.x-i.x)>(e.y-i.y)*(r.x-i.x)}function Be(i){let e=0;for(let r,n,a=0,c=i.length,h=c-1;a<c;h=a++)r=i[a],n=i[h],e+=(n.x-r.x)*(r.y+n.y);return e}function ht(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function Je(i){const e={};if(i.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(r,n,a,c)=>{const h=a||c;return e[n]=!h||h.toLowerCase(),""}),e["max-age"]){const r=parseInt(e["max-age"],10);isNaN(r)?delete e["max-age"]:e["max-age"]=r}return e}let xt,ui,oi,kt,it=null;function te(i){if(it==null){const e=i.navigator?i.navigator.userAgent:null;it=!!i.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return it}function de(i){try{const e=Ee[i];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}const Te={now:()=>oi!==void 0?oi:Ee.performance.now(),setNow(i){oi=i},restoreNow(){oi=void 0},frame(i){const e=Ee.requestAnimationFrame(i);return{cancel:()=>Ee.cancelAnimationFrame(e)}},getImageData(i,e=0){const{width:r,height:n}=i;kt||(kt=Ee.document.createElement("canvas"));const a=kt.getContext("2d");if(!a)throw new Error("failed to create canvas 2d context");return(r>kt.width||n>kt.height)&&(kt.width=r,kt.height=n),a.clearRect(-e,-e,r+2*e,n+2*e),a.drawImage(i,0,0,r,n),a.getImageData(-e,-e,r+2*e,n+2*e)},resolveURL:i=>(xt||(xt=Ee.document.createElement("a")),xt.href=i,xt.href),get devicePixelRatio(){return Ee.devicePixelRatio},get prefersReducedMotion(){return!!Ee.matchMedia&&(ui==null&&(ui=Ee.matchMedia("(prefers-reduced-motion: reduce)")),ui.matches)}};let Fe;const ze={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(Fe==null){const i=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{Fe={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):i}catch{Fe=i}}return Fe},get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Ye={supported:!1,testSupport:function(i){!Qe&&qe&&(Ve?wt(i):ot=i)}};let ot,qe,Qe=!1,Ve=!1;function wt(i){const e=i.createTexture();i.bindTexture(i.TEXTURE_2D,e);try{if(i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,qe),i.isContextLost())return;Ye.supported=!0}catch{}i.deleteTexture(e),Qe=!0}Ee.document&&(qe=Ee.document.createElement("img"),qe.onload=function(){ot&&wt(ot),ot=null,Ve=!0},qe.onerror=function(){Qe=!0,ot=null},qe.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const ft="01",bt="NO_ACCESS_TOKEN";function Et(i){return i.indexOf("mapbox:")===0}function Ut(i){return ze.API_URL_REGEX.test(i)}const Qt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function qt(i){const e=i.match(Qt);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function si(i){const e=i.params.length?`?${i.params.join("&")}`:"";return`${i.protocol}://${i.authority}${i.path}${e}`}function $i(i){if(!i)return null;const e=i.split(".");if(!e||e.length!==3)return null;try{return JSON.parse(decodeURIComponent(Ee.atob(e[1]).split("").map(r=>"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class gr{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const r=$i(ze.ACCESS_TOKEN);let n="";return n=r&&r.u?Ee.btoa(encodeURIComponent(r.u).replace(/%([0-9A-F]{2})/g,(a,c)=>String.fromCharCode(Number("0x"+c)))):ze.ACCESS_TOKEN||"",e?`mapbox.eventData.${e}:${n}`:`mapbox.eventData:${n}`}fetchEventData(){const e=de("localStorage"),r=this.getStorageKey(),n=this.getStorageKey("uuid");if(e)try{const a=Ee.localStorage.getItem(r);a&&(this.eventData=JSON.parse(a));const c=Ee.localStorage.getItem(n);c&&(this.anonId=c)}catch{Ot("Unable to read from LocalStorage")}}saveEventData(){const e=de("localStorage"),r=this.getStorageKey(),n=this.getStorageKey("uuid");if(e)try{Ee.localStorage.setItem(n,this.anonId),Object.keys(this.eventData).length>=1&&Ee.localStorage.setItem(r,JSON.stringify(this.eventData))}catch{Ot("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,r,n,a){if(!ze.EVENTS_URL)return;const c=qt(ze.EVENTS_URL);c.params.push(`access_token=${a||ze.ACCESS_TOKEN||""}`);const h={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:K,skuId:ft,userId:this.anonId},p=r?mi(h,r):h,_={url:si(c),headers:{"Content-Type":"text/plain"},body:JSON.stringify([p])};this.pendingRequest=ne(_,x=>{this.pendingRequest=null,n(x),this.saveEventData(),this.processRequests(a)})}queueRequest(e,r){this.queue.push(e),this.processRequests(r)}}const yn=new class extends gr{constructor(i){super("appUserTurnstile"),this._customAccessToken=i}postTurnstileEvent(i,e){ze.EVENTS_URL&&ze.ACCESS_TOKEN&&Array.isArray(i)&&i.some(r=>Et(r)||Ut(r))&&this.queueRequest(Date.now(),e)}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=$i(ze.ACCESS_TOKEN),r=e?e.u:ze.ACCESS_TOKEN;let n=r!==this.eventData.tokenU;Ai(this.anonId)||(this.anonId=Jr(),n=!0);const a=this.queue.shift();if(this.eventData.lastSuccess){const c=new Date(this.eventData.lastSuccess),h=new Date(a),p=(a-this.eventData.lastSuccess)/864e5;n=n||p>=1||p<-1||c.getDate()!==h.getDate()}else n=!0;n?this.postEvent(a,{"enabled.telemetry":!1},c=>{c||(this.eventData.lastSuccess=a,this.eventData.tokenU=r)},i):this.processRequests()}},xn=yn.postTurnstileEvent.bind(yn),oo=new class extends gr{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(i,e,r,n){this.skuToken=e,this.errorCb=n,ze.EVENTS_URL&&(r||ze.ACCESS_TOKEN?this.queueRequest({id:i,timestamp:Date.now()},r):this.errorCb(new Error(bt)))}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:r}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),Ai(this.anonId)||(this.anonId=Jr()),this.postEvent(r,{skuToken:this.skuToken},n=>{n?this.errorCb(n):e&&(this.success[e]=!0)},i))}},Wi=oo.postMapLoadEvent.bind(oo),Ji=new class extends gr{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(i,e,r,n){if(!ze.API_URL||!ze.SESSION_PATH)return;const a=qt(ze.API_URL+ze.SESSION_PATH);a.params.push(`sku=${e||""}`),a.params.push(`access_token=${n||ze.ACCESS_TOKEN||""}`);const c={url:si(a),headers:{"Content-Type":"text/plain"}};this.pendingRequest=me(c,h=>{this.pendingRequest=null,r(h),this.saveEventData(),this.processRequests(n)})}getSessionAPI(i,e,r,n){this.skuToken=e,this.errorCb=n,ze.SESSION_PATH&&ze.API_URL&&(r||ze.ACCESS_TOKEN?this.queueRequest({id:i,timestamp:Date.now()},r):this.errorCb(new Error(bt)))}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:r}=this.queue.shift();e&&this.success[e]||this.getSession(r,this.skuToken,n=>{n?this.errorCb(n):e&&(this.success[e]=!0)},i)}},so=Ji.getSessionAPI.bind(Ji),ao=new Set,ma="mapbox-tiles";let tn,Pn,lo=500,co=50;function Bo(){Ee.caches&&!tn&&(tn=Ee.caches.open(ma))}function As(i){const e=i.indexOf("?");return e<0?i:i.slice(0,e)}let Lo=1/0;const W={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(W);class D extends Error{constructor(e,r,n){r===401&&Ut(n)&&(e+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),super(e),this.status=r,this.url=n}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const L=ht()?()=>self.worker&&self.worker.referrer:()=>(Ee.location.protocol==="blob:"?Ee.parent:Ee).location.href,j=function(i,e){if(!(/^file:/.test(r=i.url)||/^file:/.test(L())&&!/^\w+:/.test(r))){if(Ee.fetch&&Ee.Request&&Ee.AbortController&&Ee.Request.prototype.hasOwnProperty("signal"))return function(n,a){const c=new Ee.AbortController,h=new Ee.Request(n.url,{method:n.method||"GET",body:n.body,credentials:n.credentials,headers:n.headers,referrer:L(),signal:c.signal});let p=!1,_=!1;const x=(A=h.url).indexOf("sku=")>0&&Ut(A);var A;n.type==="json"&&h.headers.set("Accept","application/json");const w=(z,P,F)=>{if(_)return;if(z&&z.message!=="SecurityError"&&Ot(z),P&&F)return E(P);const U=Date.now();Ee.fetch(h).then(q=>{if(q.ok){const ie=x?q.clone():null;return E(q,ie,U)}return a(new D(q.statusText,q.status,n.url))}).catch(q=>{q.code!==20&&a(new Error(q.message))})},E=(z,P,F)=>{(n.type==="arrayBuffer"?z.arrayBuffer():n.type==="json"?z.json():z.text()).then(U=>{_||(P&&F&&function(q,ie,oe){if(Bo(),!tn)return;const ae={status:ie.status,statusText:ie.statusText,headers:new Ee.Headers};ie.headers.forEach((we,Me)=>ae.headers.set(Me,we));const le=Je(ie.headers.get("Cache-Control")||"");if(le["no-store"])return;le["max-age"]&&ae.headers.set("Expires",new Date(oe+1e3*le["max-age"]).toUTCString());const ce=ae.headers.get("Expires");ce&&(new Date(ce).getTime()-oe<42e4||function(we,Me){if(Pn===void 0)try{new Response(new ReadableStream),Pn=!0}catch{Pn=!1}Pn?Me(we.body):we.blob().then(Me)}(ie,we=>{const Me=new Ee.Response(we,ae);Bo(),tn&&tn.then(De=>De.put(As(q.url),Me)).catch(De=>Ot(De.message))}))}(h,P,F),p=!0,a(null,U,z.headers.get("Cache-Control"),z.headers.get("Expires")))}).catch(U=>{_||a(new Error(U.message))})};return x?function(z,P){if(Bo(),!tn)return P(null);const F=As(z.url);tn.then(U=>{U.match(F).then(q=>{const ie=function(oe){if(!oe)return!1;const ae=new Date(oe.headers.get("Expires")||0),le=Je(oe.headers.get("Cache-Control")||"");return ae>Date.now()&&!le["no-cache"]}(q);U.delete(F),ie&&U.put(F,q.clone()),P(null,q,ie)}).catch(P)}).catch(P)}(h,w):w(null,null),{cancel:()=>{_=!0,p||c.abort()}}}(i,e);if(ht()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",i,e,void 0,!0)}var r;return function(n,a){const c=new Ee.XMLHttpRequest;c.open(n.method||"GET",n.url,!0),n.type==="arrayBuffer"&&(c.responseType="arraybuffer");for(const h in n.headers)c.setRequestHeader(h,n.headers[h]);return n.type==="json"&&(c.responseType="text",c.setRequestHeader("Accept","application/json")),c.withCredentials=n.credentials==="include",c.onerror=()=>{a(new Error(c.statusText))},c.onload=()=>{if((c.status>=200&&c.status<300||c.status===0)&&c.response!==null){let h=c.response;if(n.type==="json")try{h=JSON.parse(c.response)}catch(p){return a(p)}a(null,h,c.getResponseHeader("Cache-Control"),c.getResponseHeader("Expires"))}else a(new D(c.statusText,c.status,n.url))},c.send(n.body),{cancel:()=>c.abort()}}(i,e)},$=function(i,e){return j(mi(i,{type:"arrayBuffer"}),e)},ne=function(i,e){return j(mi(i,{method:"POST"}),e)},me=function(i,e){return j(mi(i,{method:"GET"}),e)};function fe(i){const e=Ee.document.createElement("a");return e.href=i,e.protocol===Ee.document.location.protocol&&e.host===Ee.document.location.host}const se="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let ye,ke;ye=[],ke=0;const Ke=function(i,e){if(Ye.supported&&(i.headers||(i.headers={}),i.headers.accept="image/webp,*/*"),ke>=ze.MAX_PARALLEL_IMAGE_REQUESTS){const c={requestParameters:i,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return ye.push(c),c}ke++;let r=!1;const n=()=>{if(!r)for(r=!0,ke--;ye.length&&ke<ze.MAX_PARALLEL_IMAGE_REQUESTS;){const c=ye.shift(),{requestParameters:h,callback:p,cancelled:_}=c;_||(c.cancel=Ke(h,p).cancel)}},a=$(i,(c,h,p,_)=>{n(),c?e(c):h&&(Ee.createImageBitmap?function(x,A){const w=new Ee.Blob([new Uint8Array(x)],{type:"image/png"});Ee.createImageBitmap(w).then(E=>{A(null,E)}).catch(E=>{A(new Error(`Could not load image because of ${E.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(h,(x,A)=>e(x,A,p,_)):function(x,A){const w=new Ee.Image,E=Ee.URL;w.onload=()=>{A(null,w),E.revokeObjectURL(w.src),w.onload=null,Ee.requestAnimationFrame(()=>{w.src=se})},w.onerror=()=>A(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const z=new Ee.Blob([new Uint8Array(x)],{type:"image/png"});w.src=x.byteLength?E.createObjectURL(z):se}(h,(x,A)=>e(x,A,p,_)))});return{cancel:()=>{a.cancel(),n()}}};function Le(i,e,r){r[i]&&r[i].indexOf(e)!==-1||(r[i]=r[i]||[],r[i].push(e))}function vt(i,e,r){if(r&&r[i]){const n=r[i].indexOf(e);n!==-1&&r[i].splice(n,1)}}class mt{constructor(e,r={}){mi(this,r),this.type=e}}class _t extends mt{constructor(e,r={}){super("error",mi({error:e},r))}}class Tt{on(e,r){return this._listeners=this._listeners||{},Le(e,r,this._listeners),this}off(e,r){return vt(e,r,this._listeners),vt(e,r,this._oneTimeListeners),this}once(e,r){return r?(this._oneTimeListeners=this._oneTimeListeners||{},Le(e,r,this._oneTimeListeners),this):new Promise(n=>this.once(e,n))}fire(e,r){typeof e=="string"&&(e=new mt(e,r||{}));const n=e.type;if(this.listens(n)){e.target=this;const a=this._listeners&&this._listeners[n]?this._listeners[n].slice():[];for(const p of a)p.call(this,e);const c=this._oneTimeListeners&&this._oneTimeListeners[n]?this._oneTimeListeners[n].slice():[];for(const p of c)vt(n,p,this._oneTimeListeners),p.call(this,e);const h=this._eventedParent;h&&(mi(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),h.fire(e))}else e instanceof _t&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,r){return this._eventedParent=e,this._eventedParentData=r,this}}var xe=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":0.1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":true,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"cross-faded"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"cross-faded":{"type":"property-type"},"cross-faded-data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function ei(i,...e){for(const r of e)for(const n in r)i[n]=r[n];return i}function at(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function Kt(i){if(Array.isArray(i))return i.map(Kt);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){const e={};for(const r in i)e[r]=Kt(i[r]);return e}return at(i)}class ti extends Error{constructor(e,r){super(r),this.message=r,this.key=e}}class uo{constructor(e,r=[]){this.parent=e,this.bindings={};for(const[n,a]of r)this.bindings[n]=a}concat(e){return new uo(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const vn={kind:"null"},He={kind:"number"},Gt={kind:"string"},Rt={kind:"boolean"},pn={kind:"color"},ho={kind:"object"},Nt={kind:"value"},po={kind:"collator"},Ro={kind:"formatted"},dr={kind:"resolvedImage"};function Nr(i,e){return{kind:"array",itemType:i,N:e}}function Ti(i){if(i.kind==="array"){const e=Ti(i.itemType);return typeof i.N=="number"?`array<${e}, ${i.N}>`:i.itemType.kind==="value"?"array":`array<${e}>`}return i.kind}const ud=[vn,He,Gt,Rt,pn,Ro,ho,Nr(Nt),dr];function bs(i,e){if(e.kind==="error")return null;if(i.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!bs(i.itemType,e.itemType))&&(typeof i.N!="number"||i.N===e.N))return null}else{if(i.kind===e.kind)return null;if(i.kind==="value"){for(const r of ud)if(!bs(r,e))return null}}return`Expected ${Ti(i)} but found ${Ti(e)} instead.`}function _a(i,e){return e.some(r=>r.kind===i.kind)}function Fo(i,e){return e.some(r=>r==="null"?i===null:r==="array"?Array.isArray(i):r==="object"?i&&!Array.isArray(i)&&typeof i=="object":r===typeof i)}function ga(i){var e={exports:{}};return i(e,e.exports),e.exports}var zl=ga(function(i,e){var r={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function n(p){return(p=Math.round(p))<0?0:p>255?255:p}function a(p){return n(p[p.length-1]==="%"?parseFloat(p)/100*255:parseInt(p))}function c(p){return(_=p[p.length-1]==="%"?parseFloat(p)/100:parseFloat(p))<0?0:_>1?1:_;var _}function h(p,_,x){return x<0?x+=1:x>1&&(x-=1),6*x<1?p+(_-p)*x*6:2*x<1?_:3*x<2?p+(_-p)*(2/3-x)*6:p}try{e.parseCSSColor=function(p){var _,x=p.replace(/ /g,"").toLowerCase();if(x in r)return r[x].slice();if(x[0]==="#")return x.length===4?(_=parseInt(x.substr(1),16))>=0&&_<=4095?[(3840&_)>>4|(3840&_)>>8,240&_|(240&_)>>4,15&_|(15&_)<<4,1]:null:x.length===7&&(_=parseInt(x.substr(1),16))>=0&&_<=16777215?[(16711680&_)>>16,(65280&_)>>8,255&_,1]:null;var A=x.indexOf("("),w=x.indexOf(")");if(A!==-1&&w+1===x.length){var E=x.substr(0,A),z=x.substr(A+1,w-(A+1)).split(","),P=1;switch(E){case"rgba":if(z.length!==4)return null;P=c(z.pop());case"rgb":return z.length!==3?null:[a(z[0]),a(z[1]),a(z[2]),P];case"hsla":if(z.length!==4)return null;P=c(z.pop());case"hsl":if(z.length!==3)return null;var F=(parseFloat(z[0])%360+360)%360/360,U=c(z[1]),q=c(z[2]),ie=q<=.5?q*(U+1):q+U-q*U,oe=2*q-ie;return[n(255*h(oe,ie,F+1/3)),n(255*h(oe,ie,F)),n(255*h(oe,ie,F-1/3)),P];default:return null}}return null}}catch{}});class $t{constructor(e,r,n,a=1){this.r=e,this.g=r,this.b=n,this.a=a}static parse(e){if(!e)return;if(e instanceof $t)return e;if(typeof e!="string")return;const r=zl.parseCSSColor(e);return r?new $t(r[0]/255*r[3],r[1]/255*r[3],r[2]/255*r[3],r[3]):void 0}toString(){const[e,r,n,a]=this.toArray();return`rgba(${Math.round(e)},${Math.round(r)},${Math.round(n)},${a})`}toArray(){const{r:e,g:r,b:n,a}=this;return a===0?[0,0,0,0]:[255*e/a,255*r/a,255*n/a,a]}}$t.black=new $t(0,0,0,1),$t.white=new $t(1,1,1,1),$t.transparent=new $t(0,0,0,0),$t.red=new $t(1,0,0,1),$t.blue=new $t(0,0,1,1);class Oo{constructor(e,r,n){this.sensitivity=e?r?"variant":"case":r?"accent":"base",this.locale=n,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,r){return this.collator.compare(e,r)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Dl{constructor(e,r,n,a,c){this.text=e.normalize?e.normalize():e,this.image=r,this.scale=n,this.fontStack=a,this.textColor=c}}class Vi{constructor(e){this.sections=e}static fromString(e){return new Vi([new Dl(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof Vi?e:Vi.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const r of this.sections){if(r.image){e.push(["image",r.image.name]);continue}e.push(r.text);const n={};r.fontStack&&(n["text-font"]=["literal",r.fontStack.split(",")]),r.scale&&(n["font-scale"]=r.scale),r.textColor&&(n["text-color"]=["rgba"].concat(r.textColor.toArray())),e.push(n)}return e}}class Er{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new Er({name:e,available:!1}):null}serialize(){return["image",this.name]}}function rn(i,e,r,n){return typeof i=="number"&&i>=0&&i<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof r=="number"&&r>=0&&r<=255?n===void 0||typeof n=="number"&&n>=0&&n<=1?null:`Invalid rgba value [${[i,e,r,n].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof n=="number"?[i,e,r,n]:[i,e,r]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ya(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof $t||i instanceof Oo||i instanceof Vi||i instanceof Er)return!0;if(Array.isArray(i)){for(const e of i)if(!ya(e))return!1;return!0}if(typeof i=="object"){for(const e in i)if(!ya(i[e]))return!1;return!0}return!1}function Ri(i){if(i===null)return vn;if(typeof i=="string")return Gt;if(typeof i=="boolean")return Rt;if(typeof i=="number")return He;if(i instanceof $t)return pn;if(i instanceof Oo)return po;if(i instanceof Vi)return Ro;if(i instanceof Er)return dr;if(Array.isArray(i)){const e=i.length;let r;for(const n of i){const a=Ri(n);if(r){if(r===a)continue;r=Nt;break}r=a}return Nr(r||Nt,e)}return ho}function An(i){const e=typeof i;return i===null?"":e==="string"||e==="number"||e==="boolean"?String(i):i instanceof $t||i instanceof Vi||i instanceof Er?i.toString():JSON.stringify(i)}class bn{constructor(e,r){this.type=e,this.value=r}static parse(e,r){if(e.length!==2)return r.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!ya(e[1]))return r.error("invalid value");const n=e[1];let a=Ri(n);const c=r.expectedType;return a.kind!=="array"||a.N!==0||!c||c.kind!=="array"||typeof c.N=="number"&&c.N!==0||(a=c),new bn(a,n)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof $t?["rgba"].concat(this.value.toArray()):this.value instanceof Vi?this.value.serialize():this.value}}class er{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}}const kl={string:Gt,number:He,boolean:Rt,object:ho};class nn{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let n,a=1;const c=e[0];if(c==="array"){let p,_;if(e.length>2){const x=e[1];if(typeof x!="string"||!(x in kl)||x==="object")return r.error('The item type argument of "array" must be one of string, number, boolean',1);p=kl[x],a++}else p=Nt;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return r.error('The length argument to "array" must be a positive integer literal',2);_=e[2],a++}n=Nr(p,_)}else n=kl[c];const h=[];for(;a<e.length;a++){const p=r.parse(e[a],a,Nt);if(!p)return null;h.push(p)}return new nn(n,h)}evaluate(e){for(let r=0;r<this.args.length;r++){const n=this.args[r].evaluate(e);if(!bs(this.type,Ri(n)))return n;if(r===this.args.length-1)throw new er(`Expected value to be of type ${Ti(this.type)}, but found ${Ti(Ri(n))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,r=[e.kind];if(e.kind==="array"){const n=e.itemType;if(n.kind==="string"||n.kind==="number"||n.kind==="boolean"){r.push(n.kind);const a=e.N;(typeof a=="number"||this.args.length>1)&&r.push(a)}}return r.concat(this.args.map(n=>n.serialize()))}}class No{constructor(e){this.type=Ro,this.sections=e}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");const n=e[1];if(!Array.isArray(n)&&typeof n=="object")return r.error("First argument must be an image or text section.");const a=[];let c=!1;for(let h=1;h<=e.length-1;++h){const p=e[h];if(c&&typeof p=="object"&&!Array.isArray(p)){c=!1;let _=null;if(p["font-scale"]&&(_=r.parse(p["font-scale"],1,He),!_))return null;let x=null;if(p["text-font"]&&(x=r.parse(p["text-font"],1,Nr(Gt)),!x))return null;let A=null;if(p["text-color"]&&(A=r.parse(p["text-color"],1,pn),!A))return null;const w=a[a.length-1];w.scale=_,w.font=x,w.textColor=A}else{const _=r.parse(e[h],1,Nt);if(!_)return null;const x=_.type.kind;if(x!=="string"&&x!=="value"&&x!=="null"&&x!=="resolvedImage")return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");c=!0,a.push({content:_,scale:null,font:null,textColor:null})}}return new No(a)}evaluate(e){return new Vi(this.sections.map(r=>{const n=r.content.evaluate(e);return Ri(n)===dr?new Dl("",n,null,null,null):new Dl(An(n),null,r.scale?r.scale.evaluate(e):null,r.font?r.font.evaluate(e).join(","):null,r.textColor?r.textColor.evaluate(e):null)}))}eachChild(e){for(const r of this.sections)e(r.content),r.scale&&e(r.scale),r.font&&e(r.font),r.textColor&&e(r.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const r of this.sections){e.push(r.content.serialize());const n={};r.scale&&(n["font-scale"]=r.scale.serialize()),r.font&&(n["text-font"]=r.font.serialize()),r.textColor&&(n["text-color"]=r.textColor.serialize()),e.push(n)}return e}}class Uo{constructor(e){this.type=dr,this.input=e}static parse(e,r){if(e.length!==2)return r.error("Expected two arguments.");const n=r.parse(e[1],1,Gt);return n?new Uo(n):r.error("No image name provided.")}evaluate(e){const r=this.input.evaluate(e),n=Er.fromString(r);return n&&e.availableImages&&(n.available=e.availableImages.indexOf(r)>-1),n}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const hd={"to-boolean":Rt,"to-color":pn,"to-number":He,"to-string":Gt};class on{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");const n=e[0];if((n==="to-boolean"||n==="to-string")&&e.length!==2)return r.error("Expected one argument.");const a=hd[n],c=[];for(let h=1;h<e.length;h++){const p=r.parse(e[h],h,Nt);if(!p)return null;c.push(p)}return new on(a,c)}evaluate(e){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(e));if(this.type.kind==="color"){let r,n;for(const a of this.args){if(r=a.evaluate(e),n=null,r instanceof $t)return r;if(typeof r=="string"){const c=e.parseColor(r);if(c)return c}else if(Array.isArray(r)&&(n=r.length<3||r.length>4?`Invalid rbga value ${JSON.stringify(r)}: expected an array containing either three or four numeric values.`:rn(r[0],r[1],r[2],r[3]),!n))return new $t(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new er(n||`Could not parse color from value '${typeof r=="string"?r:String(JSON.stringify(r))}'`)}if(this.type.kind==="number"){let r=null;for(const n of this.args){if(r=n.evaluate(e),r===null)return 0;const a=Number(r);if(!isNaN(a))return a}throw new er(`Could not convert ${JSON.stringify(r)} to number.`)}return this.type.kind==="formatted"?Vi.fromString(An(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Er.fromString(An(this.args[0].evaluate(e))):An(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if(this.type.kind==="formatted")return new No([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Uo(this.args[0]).serialize();const e=[`to-${this.type.kind}`];return this.eachChild(r=>{e.push(r.serialize())}),e}}const dd=["Unknown","Point","LineString","Polygon"];class uu{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&"id"in this.feature&&this.feature.id?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?dd[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const e=this.featureDistanceData.center,r=this.featureDistanceData.scale,{x:n,y:a}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(n*r-e[0])+this.featureDistanceData.bearing[1]*(a*r-e[1])}return 0}parseColor(e){let r=this._parseColorCache[e];return r||(r=this._parseColorCache[e]=$t.parse(e)),r}}class Cr{constructor(e,r,n,a){this.name=e,this.type=r,this._evaluate=n,this.args=a}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,r){const n=e[0],a=Cr.definitions[n];if(!a)return r.error(`Unknown expression "${n}". If you wanted a literal array, use ["literal", [...]].`,0);const c=Array.isArray(a)?a[0]:a.type,h=Array.isArray(a)?[[a[1],a[2]]]:a.overloads,p=h.filter(([x])=>!Array.isArray(x)||x.length===e.length-1);let _=null;for(const[x,A]of p){_=new Ln(r.registry,r.path,null,r.scope);const w=[];let E=!1;for(let z=1;z<e.length;z++){const P=e[z],F=Array.isArray(x)?x[z-1]:x.type,U=_.parse(P,1+w.length,F);if(!U){E=!0;break}w.push(U)}if(!E)if(Array.isArray(x)&&x.length!==w.length)_.error(`Expected ${x.length} arguments, but found ${w.length} instead.`);else{for(let z=0;z<w.length;z++){const P=Array.isArray(x)?x[z]:x.type,F=w[z];_.concat(z+1).checkSubtype(P,F.type)}if(_.errors.length===0)return new Cr(n,c,A,w)}}if(p.length===1)r.errors.push(..._.errors);else{const x=(p.length?p:h).map(([w])=>{return E=w,Array.isArray(E)?`(${E.map(Ti).join(", ")})`:`(${Ti(E.type)}...)`;var E}).join(" | "),A=[];for(let w=1;w<e.length;w++){const E=r.parse(e[w],1+A.length);if(!E)return null;A.push(Ti(E.type))}r.error(`Expected arguments of type ${x}, but found (${A.join(", ")}) instead.`)}return null}static register(e,r){Cr.definitions=r;for(const n in r)e[n]=Cr}}class xa{constructor(e,r,n){this.type=po,this.locale=n,this.caseSensitive=e,this.diacriticSensitive=r}static parse(e,r){if(e.length!==2)return r.error("Expected one argument.");const n=e[1];if(typeof n!="object"||Array.isArray(n))return r.error("Collator options argument must be an object.");const a=r.parse(n["case-sensitive"]!==void 0&&n["case-sensitive"],1,Rt);if(!a)return null;const c=r.parse(n["diacritic-sensitive"]!==void 0&&n["diacritic-sensitive"],1,Rt);if(!c)return null;let h=null;return n.locale&&(h=r.parse(n.locale,1,Gt),!h)?null:new xa(a,c,h)}evaluate(e){return new Oo(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}const Bn=8192;function Pl(i,e){i[0]=Math.min(i[0],e[0]),i[1]=Math.min(i[1],e[1]),i[2]=Math.max(i[2],e[0]),i[3]=Math.max(i[3],e[1])}function va(i,e){return!(i[0]<=e[0]||i[2]>=e[2]||i[1]<=e[1]||i[3]>=e[3])}function hu(i,e){const r=(180+i[0])/360,n=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i[1]*Math.PI/360)))/360,a=Math.pow(2,e.z);return[Math.round(r*a*Bn),Math.round(n*a*Bn)]}function Aa(i,e,r){const n=i[0]-e[0],a=i[1]-e[1],c=i[0]-r[0],h=i[1]-r[1];return n*h-c*a==0&&n*c<=0&&a*h<=0}function Bl(i,e){let r=!1;for(let h=0,p=e.length;h<p;h++){const _=e[h];for(let x=0,A=_.length;x<A-1;x++){if(Aa(i,_[x],_[x+1]))return!1;(a=_[x])[1]>(n=i)[1]!=(c=_[x+1])[1]>n[1]&&n[0]<(c[0]-a[0])*(n[1]-a[1])/(c[1]-a[1])+a[0]&&(r=!r)}}var n,a,c;return r}function pd(i,e){for(let r=0;r<e.length;r++)if(Bl(i,e[r]))return!0;return!1}function du(i,e,r,n){const a=n[0]-r[0],c=n[1]-r[1],h=(i[0]-r[0])*c-a*(i[1]-r[1]),p=(e[0]-r[0])*c-a*(e[1]-r[1]);return h>0&&p<0||h<0&&p>0}function fd(i,e,r){for(const x of r)for(let A=0;A<x.length-1;++A)if((p=[(h=x[A+1])[0]-(c=x[A])[0],h[1]-c[1]])[0]*(_=[(a=e)[0]-(n=i)[0],a[1]-n[1]])[1]-p[1]*_[0]!=0&&du(n,a,c,h)&&du(c,h,n,a))return!0;var n,a,c,h,p,_;return!1}function pu(i,e){for(let r=0;r<i.length;++r)if(!Bl(i[r],e))return!1;for(let r=0;r<i.length-1;++r)if(fd(i[r],i[r+1],e))return!1;return!0}function md(i,e){for(let r=0;r<e.length;r++)if(pu(i,e[r]))return!0;return!1}function ba(i,e,r){const n=[];for(let a=0;a<i.length;a++){const c=[];for(let h=0;h<i[a].length;h++){const p=hu(i[a][h],r);Pl(e,p),c.push(p)}n.push(c)}return n}function ws(i,e,r){const n=[];for(let a=0;a<i.length;a++){const c=ba(i[a],e,r);n.push(c)}return n}function fu(i,e,r,n){if(i[0]<r[0]||i[0]>r[2]){const a=.5*n;let c=i[0]-r[0]>a?-n:r[0]-i[0]>a?n:0;c===0&&(c=i[0]-r[2]>a?-n:r[2]-i[0]>a?n:0),i[0]+=c}Pl(e,i)}function mu(i,e,r,n){const a=Math.pow(2,n.z)*Bn,c=[n.x*Bn,n.y*Bn],h=[];if(!i)return h;for(const p of i)for(const _ of p){const x=[_.x+c[0],_.y+c[1]];fu(x,e,r,a),h.push(x)}return h}function _u(i,e,r,n){const a=Math.pow(2,n.z)*Bn,c=[n.x*Bn,n.y*Bn],h=[];if(!i)return h;for(const _ of i){const x=[];for(const A of _){const w=[A.x+c[0],A.y+c[1]];Pl(e,w),x.push(w)}h.push(x)}if(e[2]-e[0]<=a/2){(p=e)[0]=p[1]=1/0,p[2]=p[3]=-1/0;for(const _ of h)for(const x of _)fu(x,e,r,a)}var p;return h}class fo{constructor(e,r){this.type=Rt,this.geojson=e,this.geometries=r}static parse(e,r){if(e.length!==2)return r.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(ya(e[1])){const n=e[1];if(n.type==="FeatureCollection")for(let a=0;a<n.features.length;++a){const c=n.features[a].geometry.type;if(c==="Polygon"||c==="MultiPolygon")return new fo(n,n.features[a].geometry)}else if(n.type==="Feature"){const a=n.geometry.type;if(a==="Polygon"||a==="MultiPolygon")return new fo(n,n.geometry)}else if(n.type==="Polygon"||n.type==="MultiPolygon")return new fo(n,n)}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(r,n){const a=[1/0,1/0,-1/0,-1/0],c=[1/0,1/0,-1/0,-1/0],h=r.canonicalID();if(!h)return!1;if(n.type==="Polygon"){const p=ba(n.coordinates,c,h),_=mu(r.geometry(),a,c,h);if(!va(a,c))return!1;for(const x of _)if(!Bl(x,p))return!1}if(n.type==="MultiPolygon"){const p=ws(n.coordinates,c,h),_=mu(r.geometry(),a,c,h);if(!va(a,c))return!1;for(const x of _)if(!pd(x,p))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(r,n){const a=[1/0,1/0,-1/0,-1/0],c=[1/0,1/0,-1/0,-1/0],h=r.canonicalID();if(!h)return!1;if(n.type==="Polygon"){const p=ba(n.coordinates,c,h),_=_u(r.geometry(),a,c,h);if(!va(a,c))return!1;for(const x of _)if(!pu(x,p))return!1}if(n.type==="MultiPolygon"){const p=ws(n.coordinates,c,h),_=_u(r.geometry(),a,c,h);if(!va(a,c))return!1;for(const x of _)if(!md(x,p))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}function yr(i){if(i instanceof Cr&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof fo)return!1;let e=!0;return i.eachChild(r=>{e&&!yr(r)&&(e=!1)}),e}function Ts(i){if(i instanceof Cr&&i.name==="feature-state")return!1;let e=!0;return i.eachChild(r=>{e&&!Ts(r)&&(e=!1)}),e}function Es(i,e){if(i instanceof Cr&&e.indexOf(i.name)>=0)return!1;let r=!0;return i.eachChild(n=>{r&&!Es(n,e)&&(r=!1)}),r}class mo{constructor(e,r){this.type=r.type,this.name=e,this.boundExpression=r}static parse(e,r){if(e.length!==2||typeof e[1]!="string")return r.error("'var' expression requires exactly one string literal argument.");const n=e[1];return r.scope.has(n)?new mo(n,r.scope.get(n)):r.error(`Unknown variable "${n}". Make sure "${n}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class Ln{constructor(e,r=[],n,a=new uo,c=[]){this.registry=e,this.path=r,this.key=r.map(h=>`[${h}]`).join(""),this.scope=a,this.errors=c,this.expectedType=n}parse(e,r,n,a,c={}){return r?this.concat(r,n,a)._parse(e,c):this._parse(e,c)}_parse(e,r){function n(a,c,h){return h==="assert"?new nn(c,[a]):h==="coerce"?new on(c,[a]):a}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const a=e[0];if(typeof a!="string")return this.error(`Expression name must be a string, but found ${typeof a} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const c=this.registry[a];if(c){let h=c.parse(e,this);if(!h)return null;if(this.expectedType){const p=this.expectedType,_=h.type;if(p.kind!=="string"&&p.kind!=="number"&&p.kind!=="boolean"&&p.kind!=="object"&&p.kind!=="array"||_.kind!=="value")if(p.kind!=="color"&&p.kind!=="formatted"&&p.kind!=="resolvedImage"||_.kind!=="value"&&_.kind!=="string"){if(this.checkSubtype(p,_))return null}else h=n(h,p,r.typeAnnotation||"coerce");else h=n(h,p,r.typeAnnotation||"assert")}if(!(h instanceof bn)&&h.type.kind!=="resolvedImage"&&wa(h)){const p=new uu;try{h=new bn(h.type,h.evaluate(p))}catch(_){return this.error(_.message),null}}return h}return this.error(`Unknown expression "${a}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,r,n){const a=typeof e=="number"?this.path.concat(e):this.path,c=n?this.scope.concat(n):this.scope;return new Ln(this.registry,a,r||null,c,this.errors)}error(e,...r){const n=`${this.key}${r.map(a=>`[${a}]`).join("")}`;this.errors.push(new ti(n,e))}checkSubtype(e,r){const n=bs(e,r);return n&&this.error(n),n}}function wa(i){if(i instanceof mo)return wa(i.boundExpression);if(i instanceof Cr&&i.name==="error"||i instanceof xa||i instanceof fo)return!1;const e=i instanceof on||i instanceof nn;let r=!0;return i.eachChild(n=>{r=e?r&&wa(n):r&&n instanceof bn}),!!r&&yr(i)&&Es(i,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Cs(i,e){const r=i.length-1;let n,a,c=0,h=r,p=0;for(;c<=h;)if(p=Math.floor((c+h)/2),n=i[p],a=i[p+1],n<=e){if(p===r||e<a)return p;c=p+1}else{if(!(n>e))throw new er("Input is not a number.");h=p-1}return 0}class Ms{constructor(e,r,n){this.type=e,this.input=r,this.labels=[],this.outputs=[];for(const[a,c]of n)this.labels.push(a),this.outputs.push(c)}static parse(e,r){if(e.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return r.error("Expected an even number of arguments.");const n=r.parse(e[1],1,He);if(!n)return null;const a=[];let c=null;r.expectedType&&r.expectedType.kind!=="value"&&(c=r.expectedType);for(let h=1;h<e.length;h+=2){const p=h===1?-1/0:e[h],_=e[h+1],x=h,A=h+1;if(typeof p!="number")return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',x);if(a.length&&a[a.length-1][0]>=p)return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',x);const w=r.parse(_,A,c);if(!w)return null;c=c||w.type,a.push([p,w])}return new Ms(c,n,a)}evaluate(e){const r=this.labels,n=this.outputs;if(r.length===1)return n[0].evaluate(e);const a=this.input.evaluate(e);if(a<=r[0])return n[0].evaluate(e);const c=r.length;return a>=r[c-1]?n[c-1].evaluate(e):n[Cs(r,a)].evaluate(e)}eachChild(e){e(this.input);for(const r of this.outputs)e(r)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let r=0;r<this.labels.length;r++)r>0&&e.push(this.labels[r]),e.push(this.outputs[r].serialize());return e}}function yt(i,e,r){return i*(1-r)+e*r}var Ta=Object.freeze({__proto__:null,number:yt,color:function(i,e,r){return new $t(yt(i.r,e.r,r),yt(i.g,e.g,r),yt(i.b,e.b,r),yt(i.a,e.a,r))},array:function(i,e,r){return i.map((n,a)=>yt(n,e[a],r))}});const gu=.95047,yu=1.08883,Ll=4/29,Rl=6/29,Fl=3*Rl*Rl,xu=Math.PI/180,vu=180/Math.PI;function Ea(i){return i>.008856451679035631?Math.pow(i,1/3):i/Fl+Ll}function Rn(i){return i>Rl?i*i*i:Fl*(i-Ll)}function Vo(i){return 255*(i<=.0031308?12.92*i:1.055*Math.pow(i,1/2.4)-.055)}function Ol(i){return(i/=255)<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function Ca(i){const e=Ol(i.r),r=Ol(i.g),n=Ol(i.b),a=Ea((.4124564*e+.3575761*r+.1804375*n)/gu),c=Ea((.2126729*e+.7151522*r+.072175*n)/1);return{l:116*c-16,a:500*(a-c),b:200*(c-Ea((.0193339*e+.119192*r+.9503041*n)/yu)),alpha:i.a}}function Nl(i){let e=(i.l+16)/116,r=isNaN(i.a)?e:e+i.a/500,n=isNaN(i.b)?e:e-i.b/200;return e=1*Rn(e),r=gu*Rn(r),n=yu*Rn(n),new $t(Vo(3.2404542*r-1.5371385*e-.4985314*n),Vo(-.969266*r+1.8760108*e+.041556*n),Vo(.0556434*r-.2040259*e+1.0572252*n),i.alpha)}function _d(i,e,r){const n=e-i;return i+r*(n>180||n<-180?n-360*Math.round(n/360):n)}const Ss={forward:Ca,reverse:Nl,interpolate:function(i,e,r){return{l:yt(i.l,e.l,r),a:yt(i.a,e.a,r),b:yt(i.b,e.b,r),alpha:yt(i.alpha,e.alpha,r)}}},Is={forward:function(i){const{l:e,a:r,b:n}=Ca(i),a=Math.atan2(n,r)*vu;return{h:a<0?a+360:a,c:Math.sqrt(r*r+n*n),l:e,alpha:i.a}},reverse:function(i){const e=i.h*xu,r=i.c;return Nl({l:i.l,a:Math.cos(e)*r,b:Math.sin(e)*r,alpha:i.alpha})},interpolate:function(i,e,r){return{h:_d(i.h,e.h,r),c:yt(i.c,e.c,r),l:yt(i.l,e.l,r),alpha:yt(i.alpha,e.alpha,r)}}};var Ul=Object.freeze({__proto__:null,lab:Ss,hcl:Is});class Mr{constructor(e,r,n,a,c){this.type=e,this.operator=r,this.interpolation=n,this.input=a,this.labels=[],this.outputs=[];for(const[h,p]of c)this.labels.push(h),this.outputs.push(p)}static interpolationFactor(e,r,n,a){let c=0;if(e.name==="exponential")c=Ma(r,e.base,n,a);else if(e.name==="linear")c=Ma(r,1,n,a);else if(e.name==="cubic-bezier"){const h=e.controlPoints;c=new ue(h[0],h[1],h[2],h[3]).solve(Ma(r,1,n,a))}return c}static parse(e,r){let[n,a,c,...h]=e;if(!Array.isArray(a)||a.length===0)return r.error("Expected an interpolation type expression.",1);if(a[0]==="linear")a={name:"linear"};else if(a[0]==="exponential"){const x=a[1];if(typeof x!="number")return r.error("Exponential interpolation requires a numeric base.",1,1);a={name:"exponential",base:x}}else{if(a[0]!=="cubic-bezier")return r.error(`Unknown interpolation type ${String(a[0])}`,1,0);{const x=a.slice(1);if(x.length!==4||x.some(A=>typeof A!="number"||A<0||A>1))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);a={name:"cubic-bezier",controlPoints:x}}}if(e.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return r.error("Expected an even number of arguments.");if(c=r.parse(c,2,He),!c)return null;const p=[];let _=null;n==="interpolate-hcl"||n==="interpolate-lab"?_=pn:r.expectedType&&r.expectedType.kind!=="value"&&(_=r.expectedType);for(let x=0;x<h.length;x+=2){const A=h[x],w=h[x+1],E=x+3,z=x+4;if(typeof A!="number")return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',E);if(p.length&&p[p.length-1][0]>=A)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',E);const P=r.parse(w,z,_);if(!P)return null;_=_||P.type,p.push([A,P])}return _.kind==="number"||_.kind==="color"||_.kind==="array"&&_.itemType.kind==="number"&&typeof _.N=="number"?new Mr(_,n,a,c,p):r.error(`Type ${Ti(_)} is not interpolatable.`)}evaluate(e){const r=this.labels,n=this.outputs;if(r.length===1)return n[0].evaluate(e);const a=this.input.evaluate(e);if(a<=r[0])return n[0].evaluate(e);const c=r.length;if(a>=r[c-1])return n[c-1].evaluate(e);const h=Cs(r,a),p=Mr.interpolationFactor(this.interpolation,a,r[h],r[h+1]),_=n[h].evaluate(e),x=n[h+1].evaluate(e);return this.operator==="interpolate"?Ta[this.type.kind.toLowerCase()](_,x,p):this.operator==="interpolate-hcl"?Is.reverse(Is.interpolate(Is.forward(_),Is.forward(x),p)):Ss.reverse(Ss.interpolate(Ss.forward(_),Ss.forward(x),p))}eachChild(e){e(this.input);for(const r of this.outputs)e(r)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const r=[this.operator,e,this.input.serialize()];for(let n=0;n<this.labels.length;n++)r.push(this.labels[n],this.outputs[n].serialize());return r}}function Ma(i,e,r,n){const a=n-r,c=i-r;return a===0?0:e===1?c/a:(Math.pow(e,c)-1)/(Math.pow(e,a)-1)}class zs{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expectected at least one argument.");let n=null;const a=r.expectedType;a&&a.kind!=="value"&&(n=a);const c=[];for(const p of e.slice(1)){const _=r.parse(p,1+c.length,n,void 0,{typeAnnotation:"omit"});if(!_)return null;n=n||_.type,c.push(_)}const h=a&&c.some(p=>bs(a,p.type));return new zs(h?Nt:n,c)}evaluate(e){let r,n=null,a=0;for(const c of this.args){if(a++,n=c.evaluate(e),n&&n instanceof Er&&!n.available&&(r||(r=n),n=null,a===this.args.length))return r;if(n!==null)break}return n}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(r=>{e.push(r.serialize())}),e}}class Ds{constructor(e,r){this.type=r.type,this.bindings=[].concat(e),this.result=r}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const r of this.bindings)e(r[1]);e(this.result)}static parse(e,r){if(e.length<4)return r.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const n=[];for(let c=1;c<e.length-1;c+=2){const h=e[c];if(typeof h!="string")return r.error(`Expected string, but found ${typeof h} instead.`,c);if(/[^a-zA-Z0-9_]/.test(h))return r.error("Variable names must contain only alphanumeric characters or '_'.",c);const p=r.parse(e[c+1],c+1);if(!p)return null;n.push([h,p])}const a=r.parse(e[e.length-1],e.length-1,r.expectedType,n);return a?new Ds(n,a):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[r,n]of this.bindings)e.push(r,n.serialize());return e.push(this.result.serialize()),e}}class Vl{constructor(e,r,n){this.type=e,this.index=r,this.input=n}static parse(e,r){if(e.length!==3)return r.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const n=r.parse(e[1],1,He),a=r.parse(e[2],2,Nr(r.expectedType||Nt));return n&&a?new Vl(a.type.itemType,n,a):null}evaluate(e){const r=this.index.evaluate(e),n=this.input.evaluate(e);if(r<0)throw new er(`Array index out of bounds: ${r} < 0.`);if(r>=n.length)throw new er(`Array index out of bounds: ${r} > ${n.length-1}.`);if(r!==Math.floor(r))throw new er(`Array index must be an integer, but found ${r} instead.`);return n[r]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class Sa{constructor(e,r){this.type=Rt,this.needle=e,this.haystack=r}static parse(e,r){if(e.length!==3)return r.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const n=r.parse(e[1],1,Nt),a=r.parse(e[2],2,Nt);return n&&a?_a(n.type,[Rt,Gt,He,vn,Nt])?new Sa(n,a):r.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ti(n.type)} instead`):null}evaluate(e){const r=this.needle.evaluate(e),n=this.haystack.evaluate(e);if(n==null)return!1;if(!Fo(r,["boolean","string","number","null"]))throw new er(`Expected first argument to be of type boolean, string, number or null, but found ${Ti(Ri(r))} instead.`);if(!Fo(n,["string","array"]))throw new er(`Expected second argument to be of type array or string, but found ${Ti(Ri(n))} instead.`);return n.indexOf(r)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class Ia{constructor(e,r,n){this.type=He,this.needle=e,this.haystack=r,this.fromIndex=n}static parse(e,r){if(e.length<=2||e.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const n=r.parse(e[1],1,Nt),a=r.parse(e[2],2,Nt);if(!n||!a)return null;if(!_a(n.type,[Rt,Gt,He,vn,Nt]))return r.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ti(n.type)} instead`);if(e.length===4){const c=r.parse(e[3],3,He);return c?new Ia(n,a,c):null}return new Ia(n,a)}evaluate(e){const r=this.needle.evaluate(e),n=this.haystack.evaluate(e);if(!Fo(r,["boolean","string","number","null"]))throw new er(`Expected first argument to be of type boolean, string, number or null, but found ${Ti(Ri(r))} instead.`);if(!Fo(n,["string","array"]))throw new er(`Expected second argument to be of type array or string, but found ${Ti(Ri(n))} instead.`);if(this.fromIndex){const a=this.fromIndex.evaluate(e);return n.indexOf(r,a)}return n.indexOf(r)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class za{constructor(e,r,n,a,c,h){this.inputType=e,this.type=r,this.input=n,this.cases=a,this.outputs=c,this.otherwise=h}static parse(e,r){if(e.length<5)return r.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return r.error("Expected an even number of arguments.");let n,a;r.expectedType&&r.expectedType.kind!=="value"&&(a=r.expectedType);const c={},h=[];for(let x=2;x<e.length-1;x+=2){let A=e[x];const w=e[x+1];Array.isArray(A)||(A=[A]);const E=r.concat(x);if(A.length===0)return E.error("Expected at least one branch label.");for(const P of A){if(typeof P!="number"&&typeof P!="string")return E.error("Branch labels must be numbers or strings.");if(typeof P=="number"&&Math.abs(P)>Number.MAX_SAFE_INTEGER)return E.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof P=="number"&&Math.floor(P)!==P)return E.error("Numeric branch labels must be integer values.");if(n){if(E.checkSubtype(n,Ri(P)))return null}else n=Ri(P);if(c[String(P)]!==void 0)return E.error("Branch labels must be unique.");c[String(P)]=h.length}const z=r.parse(w,x,a);if(!z)return null;a=a||z.type,h.push(z)}const p=r.parse(e[1],1,Nt);if(!p)return null;const _=r.parse(e[e.length-1],e.length-1,a);return _?p.type.kind!=="value"&&r.concat(1).checkSubtype(n,p.type)?null:new za(n,a,p,c,h,_):null}evaluate(e){const r=this.input.evaluate(e);return(Ri(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],r=Object.keys(this.cases).sort(),n=[],a={};for(const h of r){const p=a[this.cases[h]];p===void 0?(a[this.cases[h]]=n.length,n.push([this.cases[h],[h]])):n[p][1].push(h)}const c=h=>this.inputType.kind==="number"?Number(h):h;for(const[h,p]of n)e.push(p.length===1?c(p[0]):p.map(c)),e.push(this.outputs[h].serialize());return e.push(this.otherwise.serialize()),e}}class Da{constructor(e,r,n){this.type=e,this.branches=r,this.otherwise=n}static parse(e,r){if(e.length<4)return r.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return r.error("Expected an odd number of arguments.");let n;r.expectedType&&r.expectedType.kind!=="value"&&(n=r.expectedType);const a=[];for(let h=1;h<e.length-1;h+=2){const p=r.parse(e[h],h,Rt);if(!p)return null;const _=r.parse(e[h+1],h+1,n);if(!_)return null;a.push([p,_]),n=n||_.type}const c=r.parse(e[e.length-1],e.length-1,n);return c?new Da(n,a,c):null}evaluate(e){for(const[r,n]of this.branches)if(r.evaluate(e))return n.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[r,n]of this.branches)e(r),e(n);e(this.otherwise)}outputDefined(){return this.branches.every(([e,r])=>r.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(r=>{e.push(r.serialize())}),e}}class ka{constructor(e,r,n,a){this.type=e,this.input=r,this.beginIndex=n,this.endIndex=a}static parse(e,r){if(e.length<=2||e.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const n=r.parse(e[1],1,Nt),a=r.parse(e[2],2,He);if(!n||!a)return null;if(!_a(n.type,[Nr(Nt),Gt,Nt]))return r.error(`Expected first argument to be of type array or string, but found ${Ti(n.type)} instead`);if(e.length===4){const c=r.parse(e[3],3,He);return c?new ka(n.type,n,a,c):null}return new ka(n.type,n,a)}evaluate(e){const r=this.input.evaluate(e),n=this.beginIndex.evaluate(e);if(!Fo(r,["string","array"]))throw new er(`Expected first argument to be of type array or string, but found ${Ti(Ri(r))} instead.`);if(this.endIndex){const a=this.endIndex.evaluate(e);return r.slice(n,a)}return r.slice(n)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function Au(i,e){return i==="=="||i==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function bu(i,e,r,n){return n.compare(e,r)===0}function Go(i,e,r){const n=i!=="=="&&i!=="!=";return class jy{constructor(c,h,p){this.type=Rt,this.lhs=c,this.rhs=h,this.collator=p,this.hasUntypedArgument=c.type.kind==="value"||h.type.kind==="value"}static parse(c,h){if(c.length!==3&&c.length!==4)return h.error("Expected two or three arguments.");const p=c[0];let _=h.parse(c[1],1,Nt);if(!_)return null;if(!Au(p,_.type))return h.concat(1).error(`"${p}" comparisons are not supported for type '${Ti(_.type)}'.`);let x=h.parse(c[2],2,Nt);if(!x)return null;if(!Au(p,x.type))return h.concat(2).error(`"${p}" comparisons are not supported for type '${Ti(x.type)}'.`);if(_.type.kind!==x.type.kind&&_.type.kind!=="value"&&x.type.kind!=="value")return h.error(`Cannot compare types '${Ti(_.type)}' and '${Ti(x.type)}'.`);n&&(_.type.kind==="value"&&x.type.kind!=="value"?_=new nn(x.type,[_]):_.type.kind!=="value"&&x.type.kind==="value"&&(x=new nn(_.type,[x])));let A=null;if(c.length===4){if(_.type.kind!=="string"&&x.type.kind!=="string"&&_.type.kind!=="value"&&x.type.kind!=="value")return h.error("Cannot use collator to compare non-string types.");if(A=h.parse(c[3],3,po),!A)return null}return new jy(_,x,A)}evaluate(c){const h=this.lhs.evaluate(c),p=this.rhs.evaluate(c);if(n&&this.hasUntypedArgument){const _=Ri(h),x=Ri(p);if(_.kind!==x.kind||_.kind!=="string"&&_.kind!=="number")throw new er(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${_.kind}, ${x.kind}) instead.`)}if(this.collator&&!n&&this.hasUntypedArgument){const _=Ri(h),x=Ri(p);if(_.kind!=="string"||x.kind!=="string")return e(c,h,p)}return this.collator?r(c,h,p,this.collator.evaluate(c)):e(c,h,p)}eachChild(c){c(this.lhs),c(this.rhs),this.collator&&c(this.collator)}outputDefined(){return!0}serialize(){const c=[i];return this.eachChild(h=>{c.push(h.serialize())}),c}}}const gd=Go("==",function(i,e,r){return e===r},bu),yd=Go("!=",function(i,e,r){return e!==r},function(i,e,r,n){return!bu(0,e,r,n)}),wu=Go("<",function(i,e,r){return e<r},function(i,e,r,n){return n.compare(e,r)<0}),xd=Go(">",function(i,e,r){return e>r},function(i,e,r,n){return n.compare(e,r)>0}),vd=Go("<=",function(i,e,r){return e<=r},function(i,e,r,n){return n.compare(e,r)<=0}),Ad=Go(">=",function(i,e,r){return e>=r},function(i,e,r,n){return n.compare(e,r)>=0});class Gl{constructor(e,r,n,a,c){this.type=Gt,this.number=e,this.locale=r,this.currency=n,this.minFractionDigits=a,this.maxFractionDigits=c}static parse(e,r){if(e.length!==3)return r.error("Expected two arguments.");const n=r.parse(e[1],1,He);if(!n)return null;const a=e[2];if(typeof a!="object"||Array.isArray(a))return r.error("NumberFormat options argument must be an object.");let c=null;if(a.locale&&(c=r.parse(a.locale,1,Gt),!c))return null;let h=null;if(a.currency&&(h=r.parse(a.currency,1,Gt),!h))return null;let p=null;if(a["min-fraction-digits"]&&(p=r.parse(a["min-fraction-digits"],1,He),!p))return null;let _=null;return a["max-fraction-digits"]&&(_=r.parse(a["max-fraction-digits"],1,He),!_)?null:new Gl(n,c,h,p,_)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class Pa{constructor(e){this.type=He,this.input=e}static parse(e,r){if(e.length!==2)return r.error(`Expected 1 argument, but found ${e.length-1} instead.`);const n=r.parse(e[1],1);return n?n.type.kind!=="array"&&n.type.kind!=="string"&&n.type.kind!=="value"?r.error(`Expected argument of type string or array, but found ${Ti(n.type)} instead.`):new Pa(n):null}evaluate(e){const r=this.input.evaluate(e);if(typeof r=="string"||Array.isArray(r))return r.length;throw new er(`Expected value to be of type string or array, but found ${Ti(Ri(r))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(r=>{e.push(r.serialize())}),e}}const _o={"==":gd,"!=":yd,">":xd,"<":wu,">=":Ad,"<=":vd,array:nn,at:Vl,boolean:nn,case:Da,coalesce:zs,collator:xa,format:No,image:Uo,in:Sa,"index-of":Ia,interpolate:Mr,"interpolate-hcl":Mr,"interpolate-lab":Mr,length:Pa,let:Ds,literal:bn,match:za,number:nn,"number-format":Gl,object:nn,slice:ka,step:Ms,string:nn,"to-boolean":on,"to-color":on,"to-number":on,"to-string":on,var:mo,within:fo};function jl(i,[e,r,n,a]){e=e.evaluate(i),r=r.evaluate(i),n=n.evaluate(i);const c=a?a.evaluate(i):1,h=rn(e,r,n,c);if(h)throw new er(h);return new $t(e/255*c,r/255*c,n/255*c,c)}function Tu(i,e){return i in e}function Zl(i,e){const r=e[i];return r===void 0?null:r}function Fn(i){return{type:i}}function ql(i){return{result:"success",value:i}}function go(i){return{result:"error",value:i}}function jo(i){return i["property-type"]==="data-driven"||i["property-type"]==="cross-faded-data-driven"}function Eu(i){return!!i.expression&&i.expression.parameters.indexOf("zoom")>-1}function Wl(i){return!!i.expression&&i.expression.interpolated}function ai(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}function yo(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}function Cu(i){return i}function Hl(i,e){const r=e.type==="color",n=i.stops&&typeof i.stops[0][0]=="object",a=n||!(n||i.property!==void 0),c=i.type||(Wl(e)?"exponential":"interval");if(r&&((i=ei({},i)).stops&&(i.stops=i.stops.map(x=>[x[0],$t.parse(x[1])])),i.default=$t.parse(i.default?i.default:e.default)),i.colorSpace&&i.colorSpace!=="rgb"&&!Ul[i.colorSpace])throw new Error(`Unknown color space: ${i.colorSpace}`);let h,p,_;if(c==="exponential")h=Yl;else if(c==="interval")h=wd;else if(c==="categorical"){h=bd,p=Object.create(null);for(const x of i.stops)p[x[0]]=x[1];_=typeof i.stops[0][0]}else{if(c!=="identity")throw new Error(`Unknown function type "${c}"`);h=Mu}if(n){const x={},A=[];for(let z=0;z<i.stops.length;z++){const P=i.stops[z],F=P[0].zoom;x[F]===void 0&&(x[F]={zoom:F,type:i.type,property:i.property,default:i.default,stops:[]},A.push(F)),x[F].stops.push([P[0].value,P[1]])}const w=[];for(const z of A)w.push([x[z].zoom,Hl(x[z],e)]);const E={name:"linear"};return{kind:"composite",interpolationType:E,interpolationFactor:Mr.interpolationFactor.bind(void 0,E),zoomStops:w.map(z=>z[0]),evaluate:({zoom:z},P)=>Yl({stops:w,base:i.base},e,z).evaluate(z,P)}}if(a){const x=c==="exponential"?{name:"exponential",base:i.base!==void 0?i.base:1}:null;return{kind:"camera",interpolationType:x,interpolationFactor:Mr.interpolationFactor.bind(void 0,x),zoomStops:i.stops.map(A=>A[0]),evaluate:({zoom:A})=>h(i,e,A,p,_)}}return{kind:"source",evaluate(x,A){const w=A&&A.properties?A.properties[i.property]:void 0;return w===void 0?ks(i.default,e.default):h(i,e,w,p,_)}}}function ks(i,e,r){return i!==void 0?i:e!==void 0?e:r!==void 0?r:void 0}function bd(i,e,r,n,a){return ks(typeof r===a?n[r]:void 0,i.default,e.default)}function wd(i,e,r){if(ai(r)!=="number")return ks(i.default,e.default);const n=i.stops.length;if(n===1||r<=i.stops[0][0])return i.stops[0][1];if(r>=i.stops[n-1][0])return i.stops[n-1][1];const a=Cs(i.stops.map(c=>c[0]),r);return i.stops[a][1]}function Yl(i,e,r){const n=i.base!==void 0?i.base:1;if(ai(r)!=="number")return ks(i.default,e.default);const a=i.stops.length;if(a===1||r<=i.stops[0][0])return i.stops[0][1];if(r>=i.stops[a-1][0])return i.stops[a-1][1];const c=Cs(i.stops.map(A=>A[0]),r),h=function(A,w,E,z){const P=z-E,F=A-E;return P===0?0:w===1?F/P:(Math.pow(w,F)-1)/(Math.pow(w,P)-1)}(r,n,i.stops[c][0],i.stops[c+1][0]),p=i.stops[c][1],_=i.stops[c+1][1];let x=Ta[e.type]||Cu;if(i.colorSpace&&i.colorSpace!=="rgb"){const A=Ul[i.colorSpace];x=(w,E)=>A.reverse(A.interpolate(A.forward(w),A.forward(E),h))}return typeof p.evaluate=="function"?{evaluate(...A){const w=p.evaluate.apply(void 0,A),E=_.evaluate.apply(void 0,A);if(w!==void 0&&E!==void 0)return x(w,E,h)}}:x(p,_,h)}function Mu(i,e,r){return e.type==="color"?r=$t.parse(r):e.type==="formatted"?r=Vi.fromString(r.toString()):e.type==="resolvedImage"?r=Er.fromString(r.toString()):ai(r)===e.type||e.type==="enum"&&e.values[r]||(r=void 0),ks(r,i.default,e.default)}Cr.register(_o,{error:[{kind:"error"},[Gt],(i,[e])=>{throw new er(e.evaluate(i))}],typeof:[Gt,[Nt],(i,[e])=>Ti(Ri(e.evaluate(i)))],"to-rgba":[Nr(He,4),[pn],(i,[e])=>e.evaluate(i).toArray()],rgb:[pn,[He,He,He],jl],rgba:[pn,[He,He,He,He],jl],has:{type:Rt,overloads:[[[Gt],(i,[e])=>Tu(e.evaluate(i),i.properties())],[[Gt,ho],(i,[e,r])=>Tu(e.evaluate(i),r.evaluate(i))]]},get:{type:Nt,overloads:[[[Gt],(i,[e])=>Zl(e.evaluate(i),i.properties())],[[Gt,ho],(i,[e,r])=>Zl(e.evaluate(i),r.evaluate(i))]]},"feature-state":[Nt,[Gt],(i,[e])=>Zl(e.evaluate(i),i.featureState||{})],properties:[ho,[],i=>i.properties()],"geometry-type":[Gt,[],i=>i.geometryType()],id:[Nt,[],i=>i.id()],zoom:[He,[],i=>i.globals.zoom],pitch:[He,[],i=>i.globals.pitch||0],"distance-from-center":[He,[],i=>i.distanceFromCenter()],"heatmap-density":[He,[],i=>i.globals.heatmapDensity||0],"line-progress":[He,[],i=>i.globals.lineProgress||0],"sky-radial-progress":[He,[],i=>i.globals.skyRadialProgress||0],accumulated:[Nt,[],i=>i.globals.accumulated===void 0?null:i.globals.accumulated],"+":[He,Fn(He),(i,e)=>{let r=0;for(const n of e)r+=n.evaluate(i);return r}],"*":[He,Fn(He),(i,e)=>{let r=1;for(const n of e)r*=n.evaluate(i);return r}],"-":{type:He,overloads:[[[He,He],(i,[e,r])=>e.evaluate(i)-r.evaluate(i)],[[He],(i,[e])=>-e.evaluate(i)]]},"/":[He,[He,He],(i,[e,r])=>e.evaluate(i)/r.evaluate(i)],"%":[He,[He,He],(i,[e,r])=>e.evaluate(i)%r.evaluate(i)],ln2:[He,[],()=>Math.LN2],pi:[He,[],()=>Math.PI],e:[He,[],()=>Math.E],"^":[He,[He,He],(i,[e,r])=>Math.pow(e.evaluate(i),r.evaluate(i))],sqrt:[He,[He],(i,[e])=>Math.sqrt(e.evaluate(i))],log10:[He,[He],(i,[e])=>Math.log(e.evaluate(i))/Math.LN10],ln:[He,[He],(i,[e])=>Math.log(e.evaluate(i))],log2:[He,[He],(i,[e])=>Math.log(e.evaluate(i))/Math.LN2],sin:[He,[He],(i,[e])=>Math.sin(e.evaluate(i))],cos:[He,[He],(i,[e])=>Math.cos(e.evaluate(i))],tan:[He,[He],(i,[e])=>Math.tan(e.evaluate(i))],asin:[He,[He],(i,[e])=>Math.asin(e.evaluate(i))],acos:[He,[He],(i,[e])=>Math.acos(e.evaluate(i))],atan:[He,[He],(i,[e])=>Math.atan(e.evaluate(i))],min:[He,Fn(He),(i,e)=>Math.min(...e.map(r=>r.evaluate(i)))],max:[He,Fn(He),(i,e)=>Math.max(...e.map(r=>r.evaluate(i)))],abs:[He,[He],(i,[e])=>Math.abs(e.evaluate(i))],round:[He,[He],(i,[e])=>{const r=e.evaluate(i);return r<0?-Math.round(-r):Math.round(r)}],floor:[He,[He],(i,[e])=>Math.floor(e.evaluate(i))],ceil:[He,[He],(i,[e])=>Math.ceil(e.evaluate(i))],"filter-==":[Rt,[Gt,Nt],(i,[e,r])=>i.properties()[e.value]===r.value],"filter-id-==":[Rt,[Nt],(i,[e])=>i.id()===e.value],"filter-type-==":[Rt,[Gt],(i,[e])=>i.geometryType()===e.value],"filter-<":[Rt,[Gt,Nt],(i,[e,r])=>{const n=i.properties()[e.value],a=r.value;return typeof n==typeof a&&n<a}],"filter-id-<":[Rt,[Nt],(i,[e])=>{const r=i.id(),n=e.value;return typeof r==typeof n&&r<n}],"filter->":[Rt,[Gt,Nt],(i,[e,r])=>{const n=i.properties()[e.value],a=r.value;return typeof n==typeof a&&n>a}],"filter-id->":[Rt,[Nt],(i,[e])=>{const r=i.id(),n=e.value;return typeof r==typeof n&&r>n}],"filter-<=":[Rt,[Gt,Nt],(i,[e,r])=>{const n=i.properties()[e.value],a=r.value;return typeof n==typeof a&&n<=a}],"filter-id-<=":[Rt,[Nt],(i,[e])=>{const r=i.id(),n=e.value;return typeof r==typeof n&&r<=n}],"filter->=":[Rt,[Gt,Nt],(i,[e,r])=>{const n=i.properties()[e.value],a=r.value;return typeof n==typeof a&&n>=a}],"filter-id->=":[Rt,[Nt],(i,[e])=>{const r=i.id(),n=e.value;return typeof r==typeof n&&r>=n}],"filter-has":[Rt,[Nt],(i,[e])=>e.value in i.properties()],"filter-has-id":[Rt,[],i=>i.id()!==null&&i.id()!==void 0],"filter-type-in":[Rt,[Nr(Gt)],(i,[e])=>e.value.indexOf(i.geometryType())>=0],"filter-id-in":[Rt,[Nr(Nt)],(i,[e])=>e.value.indexOf(i.id())>=0],"filter-in-small":[Rt,[Gt,Nr(Nt)],(i,[e,r])=>r.value.indexOf(i.properties()[e.value])>=0],"filter-in-large":[Rt,[Gt,Nr(Nt)],(i,[e,r])=>function(n,a,c,h){for(;c<=h;){const p=c+h>>1;if(a[p]===n)return!0;a[p]>n?h=p-1:c=p+1}return!1}(i.properties()[e.value],r.value,0,r.value.length-1)],all:{type:Rt,overloads:[[[Rt,Rt],(i,[e,r])=>e.evaluate(i)&&r.evaluate(i)],[Fn(Rt),(i,e)=>{for(const r of e)if(!r.evaluate(i))return!1;return!0}]]},any:{type:Rt,overloads:[[[Rt,Rt],(i,[e,r])=>e.evaluate(i)||r.evaluate(i)],[Fn(Rt),(i,e)=>{for(const r of e)if(r.evaluate(i))return!0;return!1}]]},"!":[Rt,[Rt],(i,[e])=>!e.evaluate(i)],"is-supported-script":[Rt,[Gt],(i,[e])=>{const r=i.globals&&i.globals.isSupportedScript;return!r||r(e.evaluate(i))}],upcase:[Gt,[Gt],(i,[e])=>e.evaluate(i).toUpperCase()],downcase:[Gt,[Gt],(i,[e])=>e.evaluate(i).toLowerCase()],concat:[Gt,Fn(Nt),(i,e)=>e.map(r=>An(r.evaluate(i))).join("")],"resolved-locale":[Gt,[po],(i,[e])=>e.evaluate(i).resolvedLocale()]});class Ba{constructor(e,r){this.expression=e,this._warningHistory={},this._evaluator=new uu,this._defaultValue=r?function(n){return n.type==="color"&&yo(n.default)?new $t(0,0,0,0):n.type==="color"?$t.parse(n.default)||null:n.default===void 0?null:n.default}(r):null,this._enumValues=r&&r.type==="enum"?r.values:null}evaluateWithoutErrorHandling(e,r,n,a,c,h,p,_){return this._evaluator.globals=e,this._evaluator.feature=r,this._evaluator.featureState=n,this._evaluator.canonical=a||null,this._evaluator.availableImages=c||null,this._evaluator.formattedSection=h,this._evaluator.featureTileCoord=p||null,this._evaluator.featureDistanceData=_||null,this.expression.evaluate(this._evaluator)}evaluate(e,r,n,a,c,h,p,_){this._evaluator.globals=e,this._evaluator.feature=r||null,this._evaluator.featureState=n||null,this._evaluator.canonical=a||null,this._evaluator.availableImages=c||null,this._evaluator.formattedSection=h||null,this._evaluator.featureTileCoord=p||null,this._evaluator.featureDistanceData=_||null;try{const x=this.expression.evaluate(this._evaluator);if(x==null||typeof x=="number"&&x!=x)return this._defaultValue;if(this._enumValues&&!(x in this._enumValues))throw new er(`Expected value to be one of ${Object.keys(this._enumValues).map(A=>JSON.stringify(A)).join(", ")}, but found ${JSON.stringify(x)} instead.`);return x}catch(x){return this._warningHistory[x.message]||(this._warningHistory[x.message]=!0,typeof console!="undefined"&&console.warn(x.message)),this._defaultValue}}}function Zo(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in _o}function Ps(i,e){const r=new Ln(_o,[],e?function(a){const c={color:pn,string:Gt,number:He,enum:Gt,boolean:Rt,formatted:Ro,resolvedImage:dr};return a.type==="array"?Nr(c[a.value]||Nt,a.length):c[a.type]}(e):void 0),n=r.parse(i,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return n?ql(new Ba(n,e)):go(r.errors)}class Xl{constructor(e,r){this.kind=e,this._styleExpression=r,this.isStateDependent=e!=="constant"&&!Ts(r.expression)}evaluateWithoutErrorHandling(e,r,n,a,c,h){return this._styleExpression.evaluateWithoutErrorHandling(e,r,n,a,c,h)}evaluate(e,r,n,a,c,h){return this._styleExpression.evaluate(e,r,n,a,c,h)}}class Ql{constructor(e,r,n,a){this.kind=e,this.zoomStops=n,this._styleExpression=r,this.isStateDependent=e!=="camera"&&!Ts(r.expression),this.interpolationType=a}evaluateWithoutErrorHandling(e,r,n,a,c,h){return this._styleExpression.evaluateWithoutErrorHandling(e,r,n,a,c,h)}evaluate(e,r,n,a,c,h){return this._styleExpression.evaluate(e,r,n,a,c,h)}interpolationFactor(e,r,n){return this.interpolationType?Mr.interpolationFactor(this.interpolationType,e,r,n):0}}function Su(i,e){if((i=Ps(i,e)).result==="error")return i;const r=i.value.expression,n=yr(r);if(!n&&!jo(e))return go([new ti("","data expressions not supported")]);const a=Es(r,["zoom","pitch","distance-from-center"]);if(!a&&!Eu(e))return go([new ti("","zoom expressions not supported")]);const c=Ra(r);return c||a?c instanceof ti?go([c]):c instanceof Mr&&!Wl(e)?go([new ti("",'"interpolate" expressions cannot be used with this property')]):ql(c?new Ql(n?"camera":"composite",i.value,c.labels,c instanceof Mr?c.interpolation:void 0):new Xl(n?"constant":"source",i.value)):go([new ti("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class La{constructor(e,r){this._parameters=e,this._specification=r,ei(this,Hl(this._parameters,this._specification))}static deserialize(e){return new La(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function Ra(i){let e=null;if(i instanceof Ds)e=Ra(i.result);else if(i instanceof zs){for(const r of i.args)if(e=Ra(r),e)break}else(i instanceof Ms||i instanceof Mr)&&i.input instanceof Cr&&i.input.name==="zoom"&&(e=i);return e instanceof ti||i.eachChild(r=>{const n=Ra(r);n instanceof ti?e=n:!e&&n?e=new ti("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&n&&e!==n&&(e=new ti("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}class $e{constructor(e,r,n,a){this.message=(e?`${e}: `:"")+n,a&&(this.identifier=a),r!=null&&r.__line__&&(this.line=r.__line__)}}function Ur(i){const e=i.key,r=i.value,n=i.valueSpec||{},a=i.objectElementValidators||{},c=i.style,h=i.styleSpec;let p=[];const _=ai(r);if(_!=="object")return[new $e(e,r,`object expected, ${_} found`)];for(const x in r){const A=x.split(".")[0],w=n[A]||n["*"];let E;a[A]?E=a[A]:n[A]?E=qi:a["*"]?E=a["*"]:n["*"]&&(E=qi),E?p=p.concat(E({key:(e&&`${e}.`)+x,value:r[x],valueSpec:w,style:c,styleSpec:h,object:r,objectKey:x},r)):p.push(new $e(e,r[x],`unknown property "${x}"`))}for(const x in n)a[x]||n[x].required&&n[x].default===void 0&&r[x]===void 0&&p.push(new $e(e,r,`missing required property "${x}"`));return p}function Bs(i){const e=i.value,r=i.valueSpec,n=i.style,a=i.styleSpec,c=i.key,h=i.arrayElementValidator||qi;if(ai(e)!=="array")return[new $e(c,e,`array expected, ${ai(e)} found`)];if(r.length&&e.length!==r.length)return[new $e(c,e,`array length ${r.length} expected, length ${e.length} found`)];if(r["min-length"]&&e.length<r["min-length"])return[new $e(c,e,`array length at least ${r["min-length"]} expected, length ${e.length} found`)];let p={type:r.value,values:r.values,minimum:r.minimum,maximum:r.maximum,function:void 0};a.$version<7&&(p.function=r.function),ai(r.value)==="object"&&(p=r.value);let _=[];for(let x=0;x<e.length;x++)_=_.concat(h({array:e,arrayIndex:x,value:e[x],valueSpec:p,style:n,styleSpec:a,key:`${c}[${x}]`}));return _}function Iu(i){const e=i.key,r=i.value,n=i.valueSpec;let a=ai(r);if(a==="number"&&r!=r&&(a="NaN"),a!=="number")return[new $e(e,r,`number expected, ${a} found`)];if("minimum"in n){let c=n.minimum;if(ai(n.minimum)==="array"&&(c=n.minimum[i.arrayIndex]),r<c)return[new $e(e,r,`${r} is less than the minimum value ${c}`)]}if("maximum"in n){let c=n.maximum;if(ai(n.maximum)==="array"&&(c=n.maximum[i.arrayIndex]),r>c)return[new $e(e,r,`${r} is greater than the maximum value ${c}`)]}return[]}function zu(i){const e=i.valueSpec,r=at(i.value.type);let n,a,c,h={};const p=r!=="categorical"&&i.value.property===void 0,_=!p,x=ai(i.value.stops)==="array"&&ai(i.value.stops[0])==="array"&&ai(i.value.stops[0][0])==="object",A=Ur({key:i.key,value:i.value,valueSpec:i.styleSpec.function,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:function(z){if(r==="identity")return[new $e(z.key,z.value,'identity function may not have a "stops" property')];let P=[];const F=z.value;return P=P.concat(Bs({key:z.key,value:F,valueSpec:z.valueSpec,style:z.style,styleSpec:z.styleSpec,arrayElementValidator:w})),ai(F)==="array"&&F.length===0&&P.push(new $e(z.key,F,"array must have at least one stop")),P},default:function(z){return qi({key:z.key,value:z.value,valueSpec:e,style:z.style,styleSpec:z.styleSpec})}}});return r==="identity"&&p&&A.push(new $e(i.key,i.value,'missing required property "property"')),r==="identity"||i.value.stops||A.push(new $e(i.key,i.value,'missing required property "stops"')),r==="exponential"&&i.valueSpec.expression&&!Wl(i.valueSpec)&&A.push(new $e(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(_&&!jo(i.valueSpec)?A.push(new $e(i.key,i.value,"property functions not supported")):p&&!Eu(i.valueSpec)&&A.push(new $e(i.key,i.value,"zoom functions not supported"))),r!=="categorical"&&!x||i.value.property!==void 0||A.push(new $e(i.key,i.value,'"property" property is required')),A;function w(z){let P=[];const F=z.value,U=z.key;if(ai(F)!=="array")return[new $e(U,F,`array expected, ${ai(F)} found`)];if(F.length!==2)return[new $e(U,F,`array length 2 expected, length ${F.length} found`)];if(x){if(ai(F[0])!=="object")return[new $e(U,F,`object expected, ${ai(F[0])} found`)];if(F[0].zoom===void 0)return[new $e(U,F,"object stop key must have zoom")];if(F[0].value===void 0)return[new $e(U,F,"object stop key must have value")];const q=at(F[0].zoom);if(typeof q!="number")return[new $e(U,F[0].zoom,"stop zoom values must be numbers")];if(c&&c>q)return[new $e(U,F[0].zoom,"stop zoom values must appear in ascending order")];q!==c&&(c=q,a=void 0,h={}),P=P.concat(Ur({key:`${U}[0]`,value:F[0],valueSpec:{zoom:{}},style:z.style,styleSpec:z.styleSpec,objectElementValidators:{zoom:Iu,value:E}}))}else P=P.concat(E({key:`${U}[0]`,value:F[0],valueSpec:{},style:z.style,styleSpec:z.styleSpec},F));return Zo(Kt(F[1]))?P.concat([new $e(`${U}[1]`,F[1],"expressions are not allowed in function stops.")]):P.concat(qi({key:`${U}[1]`,value:F[1],valueSpec:e,style:z.style,styleSpec:z.styleSpec}))}function E(z,P){const F=ai(z.value),U=at(z.value),q=z.value!==null?z.value:P;if(n){if(F!==n)return[new $e(z.key,q,`${F} stop domain type must match previous stop domain type ${n}`)]}else n=F;if(F!=="number"&&F!=="string"&&F!=="boolean"&&typeof U!="number"&&typeof U!="string"&&typeof U!="boolean")return[new $e(z.key,q,"stop domain value must be a number, string, or boolean")];if(F!=="number"&&r!=="categorical"){let ie=`number expected, ${F} found`;return jo(e)&&r===void 0&&(ie+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new $e(z.key,q,ie)]}return r!=="categorical"||F!=="number"||typeof U=="number"&&isFinite(U)&&Math.floor(U)===U?r!=="categorical"&&F==="number"&&typeof U=="number"&&typeof a=="number"&&a!==void 0&&U<a?[new $e(z.key,q,"stop domain values must appear in ascending order")]:(a=U,r==="categorical"&&U in h?[new $e(z.key,q,"stop domain values must be unique")]:(h[U]=!0,[])):[new $e(z.key,q,`integer expected, found ${String(U)}`)]}}function qo(i){const e=(i.expressionContext==="property"?Su:Ps)(Kt(i.value),i.valueSpec);if(e.result==="error")return e.value.map(n=>new $e(`${i.key}${n.key}`,i.value,n.message));const r=e.value.expression||e.value._styleExpression.expression;if(i.expressionContext==="property"&&i.propertyKey==="text-font"&&!r.outputDefined())return[new $e(i.key,i.value,`Invalid data expression for "${i.propertyKey}". Output values must be contained as literals within the expression.`)];if(i.expressionContext==="property"&&i.propertyType==="layout"&&!Ts(r))return[new $e(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if(i.expressionContext==="filter")return wn(r,i);if(i.expressionContext&&i.expressionContext.indexOf("cluster")===0){if(!Es(r,["zoom","feature-state"]))return[new $e(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(i.expressionContext==="cluster-initial"&&!yr(r))return[new $e(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function wn(i,e){const r=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(e.valueSpec&&e.valueSpec.expression)for(const a of e.valueSpec.expression.parameters)r.delete(a);if(r.size===0)return[];const n=[];return i instanceof Cr&&r.has(i.name)?[new $e(e.key,e.value,`["${i.name}"] expression is not supported in a filter for a ${e.object.type} layer with id: ${e.object.id}`)]:(i.eachChild(a=>{n.push(...wn(a,e))}),n)}function Ls(i){const e=i.key,r=i.value,n=i.valueSpec,a=[];return Array.isArray(n.values)?n.values.indexOf(at(r))===-1&&a.push(new $e(e,r,`expected one of [${n.values.join(", ")}], ${JSON.stringify(r)} found`)):Object.keys(n.values).indexOf(at(r))===-1&&a.push(new $e(e,r,`expected one of [${Object.keys(n.values).join(", ")}], ${JSON.stringify(r)} found`)),a}function On(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(const e of i.slice(1))if(!On(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}function Nn(i,e="fill"){if(i==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};On(i)||(i=Rs(i));const r=i;let n=!0;try{n=function(x){if(!Un(x))return x;let A=Kt(x);return Du(A),A=Kl(A),A}(r)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(r,null,2)}
        `)}const a=xe[`filter_${e}`],c=Ps(n,a);let h=null;if(c.result==="error")throw new Error(c.value.map(x=>`${x.key}: ${x.message}`).join(", "));h=(x,A,w)=>c.value.evaluate(x,A,{},w);let p=null,_=null;if(n!==r){const x=Ps(r,a);if(x.result==="error")throw new Error(x.value.map(A=>`${A.key}: ${A.message}`).join(", "));p=(A,w,E,z,P)=>x.value.evaluate(A,w,{},E,void 0,void 0,z,P),_=!yr(x.value.expression)}return h=h,{filter:h,dynamicFilter:p||void 0,needGeometry:Fa(n),needFeature:!!_}}function Kl(i){if(!Array.isArray(i))return i;const e=function(r){if(ku.has(r[0])){for(let n=1;n<r.length;n++)if(Un(r[n]))return!0}return r}(i);return e===!0?e:e.map(r=>Kl(r))}function Du(i){let e=!1;const r=[];if(i[0]==="case"){for(let n=1;n<i.length-1;n+=2)e=e||Un(i[n]),r.push(i[n+1]);r.push(i[i.length-1])}else if(i[0]==="match"){e=e||Un(i[1]);for(let n=2;n<i.length-1;n+=2)r.push(i[n+1]);r.push(i[i.length-1])}else if(i[0]==="step"){e=e||Un(i[1]);for(let n=1;n<i.length-1;n+=2)r.push(i[n+1])}e&&(i.length=0,i.push("any",...r));for(let n=1;n<i.length;n++)Du(i[n])}function Un(i){if(!Array.isArray(i))return!1;if((e=i[0])==="pitch"||e==="distance-from-center")return!0;var e;for(let r=1;r<i.length;r++)if(Un(i[r]))return!0;return!1}const ku=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function $l(i,e){return i<e?-1:i>e?1:0}function Fa(i){if(!Array.isArray(i))return!1;if(i[0]==="within")return!0;for(let e=1;e<i.length;e++)if(Fa(i[e]))return!0;return!1}function Rs(i){if(!i)return!0;const e=i[0];return i.length<=1?e!=="any":e==="=="?Fs(i[1],i[2],"=="):e==="!="?Os(Fs(i[1],i[2],"==")):e==="<"||e===">"||e==="<="||e===">="?Fs(i[1],i[2],e):e==="any"?(r=i.slice(1),["any"].concat(r.map(Rs))):e==="all"?["all"].concat(i.slice(1).map(Rs)):e==="none"?["all"].concat(i.slice(1).map(Rs).map(Os)):e==="in"?Jl(i[1],i.slice(2)):e==="!in"?Os(Jl(i[1],i.slice(2))):e==="has"?ec(i[1]):e==="!has"?Os(ec(i[1])):e!=="within"||i;var r}function Fs(i,e,r){switch(i){case"$type":return[`filter-type-${r}`,e];case"$id":return[`filter-id-${r}`,e];default:return[`filter-${r}`,i,e]}}function Jl(i,e){if(e.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(r=>typeof r!=typeof e[0])?["filter-in-large",i,["literal",e.sort($l)]]:["filter-in-small",i,["literal",e]]}}function ec(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}function Os(i){return["!",i]}function Vn(i){return On(Kt(i.value))?qo(ei({},i,{expressionContext:"filter",valueSpec:i.styleSpec[`filter_${i.layerType||"fill"}`]})):tc(i)}function tc(i){const e=i.value,r=i.key;if(ai(e)!=="array")return[new $e(r,e,`array expected, ${ai(e)} found`)];const n=i.styleSpec;let a,c=[];if(e.length<1)return[new $e(r,e,"filter array must have at least 1 element")];switch(c=c.concat(Ls({key:`${r}[0]`,value:e[0],valueSpec:n.filter_operator,style:i.style,styleSpec:i.styleSpec})),at(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&at(e[1])==="$type"&&c.push(new $e(r,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&c.push(new $e(r,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(a=ai(e[1]),a!=="string"&&c.push(new $e(`${r}[1]`,e[1],`string expected, ${a} found`)));for(let h=2;h<e.length;h++)a=ai(e[h]),at(e[1])==="$type"?c=c.concat(Ls({key:`${r}[${h}]`,value:e[h],valueSpec:n.geometry_type,style:i.style,styleSpec:i.styleSpec})):a!=="string"&&a!=="number"&&a!=="boolean"&&c.push(new $e(`${r}[${h}]`,e[h],`string, number, or boolean expected, ${a} found`));break;case"any":case"all":case"none":for(let h=1;h<e.length;h++)c=c.concat(tc({key:`${r}[${h}]`,value:e[h],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":a=ai(e[1]),e.length!==2?c.push(new $e(r,e,`filter array for "${e[0]}" operator must have 2 elements`)):a!=="string"&&c.push(new $e(`${r}[1]`,e[1],`string expected, ${a} found`));break;case"within":a=ai(e[1]),e.length!==2?c.push(new $e(r,e,`filter array for "${e[0]}" operator must have 2 elements`)):a!=="object"&&c.push(new $e(`${r}[1]`,e[1],`object expected, ${a} found`))}return c}function ic(i,e){const r=i.key,n=i.style,a=i.styleSpec,c=i.value,h=i.objectKey,p=a[`${e}_${i.layerType}`];if(!p)return[];const _=h.match(/^(.*)-transition$/);if(e==="paint"&&_&&p[_[1]]&&p[_[1]].transition)return qi({key:r,value:c,valueSpec:a.transition,style:n,styleSpec:a});const x=i.valueSpec||p[h];if(!x)return[new $e(r,c,`unknown property "${h}"`)];let A;if(ai(c)==="string"&&jo(x)&&!x.tokens&&(A=/^{([^}]+)}$/.exec(c)))return[new $e(r,c,`"${h}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(A[1])} }\`.`)];const w=[];return i.layerType==="symbol"&&(h==="text-field"&&n&&!n.glyphs&&w.push(new $e(r,c,'use of "text-field" requires a style "glyphs" property')),h==="text-font"&&yo(Kt(c))&&at(c.type)==="identity"&&w.push(new $e(r,c,'"text-font" does not support identity functions'))),w.concat(qi({key:i.key,value:c,valueSpec:x,style:n,styleSpec:a,expressionContext:"property",propertyType:e,propertyKey:h}))}function Oa(i){return ic(i,"paint")}function rc(i){return ic(i,"layout")}function Pu(i){let e=[];const r=i.value,n=i.key,a=i.style,c=i.styleSpec;r.type||r.ref||e.push(new $e(n,r,'either "type" or "ref" is required'));let h=at(r.type);const p=at(r.ref);if(r.id){const _=at(r.id);for(let x=0;x<i.arrayIndex;x++){const A=a.layers[x];at(A.id)===_&&e.push(new $e(n,r.id,`duplicate layer id "${r.id}", previously used at line ${A.id.__line__}`))}}if("ref"in r){let _;["type","source","source-layer","filter","layout"].forEach(x=>{x in r&&e.push(new $e(n,r[x],`"${x}" is prohibited for ref layers`))}),a.layers.forEach(x=>{at(x.id)===p&&(_=x)}),_?_.ref?e.push(new $e(n,r.ref,"ref cannot reference another ref layer")):h=at(_.type):typeof p=="string"&&e.push(new $e(n,r.ref,`ref layer "${p}" not found`))}else if(h!=="background"&&h!=="sky")if(r.source){const _=a.sources&&a.sources[r.source],x=_&&at(_.type);_?x==="vector"&&h==="raster"?e.push(new $e(n,r.source,`layer "${r.id}" requires a raster source`)):x==="raster"&&h!=="raster"?e.push(new $e(n,r.source,`layer "${r.id}" requires a vector source`)):x!=="vector"||r["source-layer"]?x==="raster-dem"&&h!=="hillshade"?e.push(new $e(n,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):h!=="line"||!r.paint||!r.paint["line-gradient"]||x==="geojson"&&_.lineMetrics||e.push(new $e(n,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new $e(n,r,`layer "${r.id}" must specify a "source-layer"`)):e.push(new $e(n,r.source,`source "${r.source}" not found`))}else e.push(new $e(n,r,'missing required property "source"'));return e=e.concat(Ur({key:n,value:r,valueSpec:c.layer,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{"*":()=>[],type:()=>qi({key:`${n}.type`,value:r.type,valueSpec:c.layer.type,style:i.style,styleSpec:i.styleSpec,object:r,objectKey:"type"}),filter:_=>Vn(ei({layerType:h},_)),layout:_=>Ur({layer:r,key:_.key,value:_.value,valueSpec:{},style:_.style,styleSpec:_.styleSpec,objectElementValidators:{"*":x=>rc(ei({layerType:h},x))}}),paint:_=>Ur({layer:r,key:_.key,value:_.value,valueSpec:{},style:_.style,styleSpec:_.styleSpec,objectElementValidators:{"*":x=>Oa(ei({layerType:h},x))}})}})),e}function Tn(i){const e=i.value,r=i.key,n=ai(e);return n!=="string"?[new $e(r,e,`string expected, ${n} found`)]:[]}const Bu={promoteId:function({key:i,value:e}){if(ai(e)==="string")return Tn({key:i,value:e});{const r=[];for(const n in e)r.push(...Tn({key:`${i}.${n}`,value:e[n]}));return r}}};function Lu(i){const e=i.value,r=i.key,n=i.styleSpec,a=i.style;if(!e.type)return[new $e(r,e,'"type" is required')];const c=at(e.type);let h;switch(c){case"vector":case"raster":case"raster-dem":return h=Ur({key:r,value:e,valueSpec:n[`source_${c.replace("-","_")}`],style:i.style,styleSpec:n,objectElementValidators:Bu}),h;case"geojson":if(h=Ur({key:r,value:e,valueSpec:n.source_geojson,style:a,styleSpec:n,objectElementValidators:Bu}),e.cluster)for(const p in e.clusterProperties){const[_,x]=e.clusterProperties[p],A=typeof _=="string"?[_,["accumulated"],["get",p]]:_;h.push(...qo({key:`${r}.${p}.map`,value:x,expressionContext:"cluster-map"})),h.push(...qo({key:`${r}.${p}.reduce`,value:A,expressionContext:"cluster-reduce"}))}return h;case"video":return Ur({key:r,value:e,valueSpec:n.source_video,style:a,styleSpec:n});case"image":return Ur({key:r,value:e,valueSpec:n.source_image,style:a,styleSpec:n});case"canvas":return[new $e(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ls({key:`${r}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:a,styleSpec:n})}}function Ru(i){const e=i.value,r=i.styleSpec,n=r.light,a=i.style;let c=[];const h=ai(e);if(e===void 0)return c;if(h!=="object")return c=c.concat([new $e("light",e,`object expected, ${h} found`)]),c;for(const p in e){const _=p.match(/^(.*)-transition$/);c=c.concat(_&&n[_[1]]&&n[_[1]].transition?qi({key:p,value:e[p],valueSpec:r.transition,style:a,styleSpec:r}):n[p]?qi({key:p,value:e[p],valueSpec:n[p],style:a,styleSpec:r}):[new $e(p,e[p],`unknown property "${p}"`)])}return c}function Fu(i){const e=i.value,r=i.key,n=i.style,a=i.styleSpec,c=a.terrain;let h=[];const p=ai(e);if(e===void 0)return h;if(p!=="object")return h=h.concat([new $e("terrain",e,`object expected, ${p} found`)]),h;for(const _ in e){const x=_.match(/^(.*)-transition$/);h=h.concat(x&&c[x[1]]&&c[x[1]].transition?qi({key:_,value:e[_],valueSpec:a.transition,style:n,styleSpec:a}):c[_]?qi({key:_,value:e[_],valueSpec:c[_],style:n,styleSpec:a}):[new $e(_,e[_],`unknown property "${_}"`)])}if(e.source){const _=n.sources&&n.sources[e.source],x=_&&at(_.type);_?x!=="raster-dem"&&h.push(new $e(r,e.source,`terrain cannot be used with a source of type ${String(x)}, it only be used with a "raster-dem" source type`)):h.push(new $e(r,e.source,`source "${e.source}" not found`))}else h.push(new $e(r,e,'terrain is missing required property "source"'));return h}function Ou(i){const e=i.value,r=i.style,n=i.styleSpec,a=n.fog;let c=[];const h=ai(e);if(e===void 0)return c;if(h!=="object")return c=c.concat([new $e("fog",e,`object expected, ${h} found`)]),c;for(const p in e){const _=p.match(/^(.*)-transition$/);c=c.concat(_&&a[_[1]]&&a[_[1]].transition?qi({key:p,value:e[p],valueSpec:n.transition,style:r,styleSpec:n}):a[p]?qi({key:p,value:e[p],valueSpec:a[p],style:r,styleSpec:n}):[new $e(p,e[p],`unknown property "${p}"`)])}return c}const Ns={"*":()=>[],array:Bs,boolean:function(i){const e=i.value,r=i.key,n=ai(e);return n!=="boolean"?[new $e(r,e,`boolean expected, ${n} found`)]:[]},number:Iu,color:function(i){const e=i.key,r=i.value,n=ai(r);return n!=="string"?[new $e(e,r,`color expected, ${n} found`)]:zl.parseCSSColor(r)===null?[new $e(e,r,`color expected, "${r}" found`)]:[]},enum:Ls,filter:Vn,function:zu,layer:Pu,object:Ur,source:Lu,light:Ru,terrain:Fu,fog:Ou,string:Tn,formatted:function(i){return Tn(i).length===0?[]:qo(i)},resolvedImage:function(i){return Tn(i).length===0?[]:qo(i)},projection:function(i){const e=i.value,r=i.styleSpec,n=r.projection,a=i.style;let c=[];const h=ai(e);if(h==="object")for(const p in e)c=c.concat(qi({key:p,value:e[p],valueSpec:n[p],style:a,styleSpec:r}));else h!=="string"&&(c=c.concat([new $e("projection",e,`object or string expected, ${h} found`)]));return c}};function qi(i){const e=i.value,r=i.valueSpec,n=i.styleSpec;return r.expression&&yo(at(e))?zu(i):r.expression&&Zo(Kt(e))?qo(i):r.type&&Ns[r.type]?Ns[r.type](i):Ur(ei({},i,{valueSpec:r.type?n[r.type]:r}))}function Sr(i){const e=i.value,r=i.key,n=Tn(i);return n.length||(e.indexOf("{fontstack}")===-1&&n.push(new $e(r,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&n.push(new $e(r,e,'"glyphs" url must include a "{range}" token'))),n}function Us(i,e=xe){return En(qi({key:"",value:i,valueSpec:e.$root,styleSpec:e,style:i,objectElementValidators:{glyphs:Sr,"*":()=>[]}}))}const Td=i=>En(Oa(i)),Ed=i=>En(rc(i));function En(i){return i.slice().sort((e,r)=>e.line&&r.line?e.line-r.line:0)}function Nu(i,e){let r=!1;if(e&&e.length)for(const n of e)i.fire(new _t(new Error(n.message))),r=!0;return r}var Gn=fn;function fn(i,e,r){var n=this.cells=[];if(i instanceof ArrayBuffer){this.arrayBuffer=i;var a=new Int32Array(this.arrayBuffer);i=a[0],this.d=(e=a[1])+2*(r=a[2]);for(var c=0;c<this.d*this.d;c++){var h=a[3+c],p=a[3+c+1];n.push(h===p?null:a.subarray(h,p))}var _=a[3+n.length+1];this.keys=a.subarray(a[3+n.length],_),this.bboxes=a.subarray(_),this.insert=this._insertReadonly}else{this.d=e+2*r;for(var x=0;x<this.d*this.d;x++)n.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=i,this.padding=r,this.scale=e/i,this.uid=0;var A=r/e*i;this.min=-A,this.max=i+A}fn.prototype.insert=function(i,e,r,n,a){this._forEachCell(e,r,n,a,this._insertCell,this.uid++),this.keys.push(i),this.bboxes.push(e),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(a)},fn.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},fn.prototype._insertCell=function(i,e,r,n,a,c){this.cells[a].push(c)},fn.prototype.query=function(i,e,r,n,a){var c=this.min,h=this.max;if(i<=c&&e<=c&&h<=r&&h<=n&&!a)return Array.prototype.slice.call(this.keys);var p=[];return this._forEachCell(i,e,r,n,this._queryCell,p,{},a),p},fn.prototype._queryCell=function(i,e,r,n,a,c,h,p){var _=this.cells[a];if(_!==null)for(var x=this.keys,A=this.bboxes,w=0;w<_.length;w++){var E=_[w];if(h[E]===void 0){var z=4*E;(p?p(A[z+0],A[z+1],A[z+2],A[z+3]):i<=A[z+2]&&e<=A[z+3]&&r>=A[z+0]&&n>=A[z+1])?(h[E]=!0,c.push(x[E])):h[E]=!1}}},fn.prototype._forEachCell=function(i,e,r,n,a,c,h,p){for(var _=this._convertToCellCoord(i),x=this._convertToCellCoord(e),A=this._convertToCellCoord(r),w=this._convertToCellCoord(n),E=_;E<=A;E++)for(var z=x;z<=w;z++){var P=this.d*z+E;if((!p||p(this._convertFromCellCoord(E),this._convertFromCellCoord(z),this._convertFromCellCoord(E+1),this._convertFromCellCoord(z+1)))&&a.call(this,i,e,r,n,P,c,h,p))return}},fn.prototype._convertFromCellCoord=function(i){return(i-this.padding)/this.scale},fn.prototype._convertToCellCoord=function(i){return Math.max(0,Math.min(this.d-1,Math.floor(i*this.scale)+this.padding))},fn.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var i=this.cells,e=3+this.cells.length+1+1,r=0,n=0;n<this.cells.length;n++)r+=this.cells[n].length;var a=new Int32Array(e+r+this.keys.length+this.bboxes.length);a[0]=this.extent,a[1]=this.n,a[2]=this.padding;for(var c=e,h=0;h<i.length;h++){var p=i[h];a[3+h]=c,a.set(p,c),c+=p.length}return a[3+i.length]=c,a.set(this.keys,c),a[3+i.length+1]=c+=this.keys.length,a.set(this.bboxes,c),c+=this.bboxes.length,a.buffer};const xo={};function tt(i,e={}){xo[i.name]={klass:i,omit:e.omit||[]}}tt(Object),Gn.serialize=function(i,e){const r=i.toArrayBuffer();return e&&e.push(r),{buffer:r}},Gn.deserialize=function(i){return new Gn(i.buffer)},Object.defineProperty(Gn,"name",{value:"Grid"}),tt(Gn),tt($t),tt(Error),tt(D),tt(Er),tt(La),tt(Ba,{omit:["_evaluator"]}),tt(Ql),tt(Xl),tt(Cr,{omit:["_evaluate"]});for(const i in _o)xo[_o[i].name]||tt(_o[i]);function Uu(i){return i&&typeof ArrayBuffer!="undefined"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}function Na(i){return Ee.ImageBitmap&&i instanceof Ee.ImageBitmap}function Vs(i,e){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp)return i;if(Uu(i)||Na(i))return e&&e.push(i),i;if(ArrayBuffer.isView(i)){const r=i;return e&&e.push(r.buffer),r}if(i instanceof Ee.ImageData)return e&&e.push(i.data.buffer),i;if(Array.isArray(i)){const r=[];for(const n of i)r.push(Vs(n,e));return r}if(typeof i=="object"){const r=i.constructor,n=r.name;if(!xo[n])throw new Error(`can't serialize object of unregistered class ${n}`);const a=r.serialize?r.serialize(i,e):{};if(!r.serialize){for(const c in i)i.hasOwnProperty(c)&&(xo[n].omit.indexOf(c)>=0||(a[c]=Vs(i[c],e)));i instanceof Error&&(a.message=i.message)}if(a.$name)throw new Error("$name property is reserved for worker serialization logic.");return n!=="Object"&&(a.$name=n),a}throw new Error("can't serialize object of type "+typeof i)}function Wo(i){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||Uu(i)||Na(i)||ArrayBuffer.isView(i)||i instanceof Ee.ImageData)return i;if(Array.isArray(i))return i.map(Wo);if(typeof i=="object"){const e=i.$name||"Object",{klass:r}=xo[e];if(!r)throw new Error(`can't deserialize unregistered class ${e}`);if(r.deserialize)return r.deserialize(i);const n=Object.create(r.prototype);for(const a of Object.keys(i))a!=="$name"&&(n[a]=Wo(i[a]));return n}throw new Error("can't deserialize object of type "+typeof i)}class nc{constructor(){this.first=!0}update(e,r){const n=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=n,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=n,!0):(this.lastFloorZoom>n?(this.lastIntegerZoom=n+1,this.lastIntegerZoomTime=r):this.lastFloorZoom<n&&(this.lastIntegerZoom=n,this.lastIntegerZoomTime=r),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=n,!0))}}const Vu=i=>i>=1536&&i<=1791,Ua=i=>i>=1872&&i<=1919,Gs=i=>i>=2208&&i<=2303,oc=i=>i>=11904&&i<=12031,Gu=i=>i>=12032&&i<=12255,sc=i=>i>=12272&&i<=12287,Va=i=>i>=12288&&i<=12351,js=i=>i>=12352&&i<=12447,Ga=i=>i>=12448&&i<=12543,ju=i=>i>=12544&&i<=12591,Zu=i=>i>=12704&&i<=12735,qu=i=>i>=12736&&i<=12783,ac=i=>i>=12784&&i<=12799,Wu=i=>i>=12800&&i<=13055,Hu=i=>i>=13056&&i<=13311,Yu=i=>i>=13312&&i<=19903,lc=i=>i>=19968&&i<=40959,Xu=i=>i>=40960&&i<=42127,Qu=i=>i>=42128&&i<=42191,Ku=i=>i>=44032&&i<=55215,Zs=i=>i>=63744&&i<=64255,cc=i=>i>=64336&&i<=65023,$u=i=>i>=65040&&i<=65055,Ho=i=>i>=65072&&i<=65103,Ju=i=>i>=65104&&i<=65135,ja=i=>i>=65136&&i<=65279,uc=i=>i>=65280&&i<=65519;function Za(i){for(const e of i)if(qa(e.charCodeAt(0)))return!0;return!1}function eh(i){for(const e of i)if(!th(e.charCodeAt(0)))return!1;return!0}function th(i){return!(Vu(i)||Ua(i)||Gs(i)||cc(i)||ja(i))}function qa(i){return!(i!==746&&i!==747&&(i<4352||!(Zu(i)||ju(i)||Ho(i)&&!(i>=65097&&i<=65103)||Zs(i)||Hu(i)||oc(i)||qu(i)||!(!Va(i)||i>=12296&&i<=12305||i>=12308&&i<=12319||i===12336)||Yu(i)||lc(i)||Wu(i)||(e=>e>=12592&&e<=12687)(i)||(e=>e>=43360&&e<=43391)(i)||(e=>e>=55216&&e<=55295)(i)||(e=>e>=4352&&e<=4607)(i)||Ku(i)||js(i)||sc(i)||(e=>e>=12688&&e<=12703)(i)||Gu(i)||ac(i)||Ga(i)&&i!==12540||!(!uc(i)||i===65288||i===65289||i===65293||i>=65306&&i<=65310||i===65339||i===65341||i===65343||i>=65371&&i<=65503||i===65507||i>=65512&&i<=65519)||!(!Ju(i)||i>=65112&&i<=65118||i>=65123&&i<=65126)||(e=>e>=5120&&e<=5759)(i)||(e=>e>=6320&&e<=6399)(i)||$u(i)||(e=>e>=19904&&e<=19967)(i)||Xu(i)||Qu(i))))}function Wa(i){return!(qa(i)||function(e){return!!((r=>r>=128&&r<=255)(e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||(r=>r>=8192&&r<=8303)(e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||(r=>r>=8448&&r<=8527)(e)||(r=>r>=8528&&r<=8591)(e)||(r=>r>=8960&&r<=9215)(e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||(r=>r>=9216&&r<=9279)(e)&&e!==9251||(r=>r>=9280&&r<=9311)(e)||(r=>r>=9312&&r<=9471)(e)||(r=>r>=9632&&r<=9727)(e)||(r=>r>=9728&&r<=9983)(e)&&!(e>=9754&&e<=9759)||(r=>r>=11008&&r<=11263)(e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||Va(e)||Ga(e)||(r=>r>=57344&&r<=63743)(e)||Ho(e)||Ju(e)||uc(e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(i))}function Ha(i){return i>=1424&&i<=2303||cc(i)||ja(i)}function Cd(i,e){return!(!e&&Ha(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||(r=>r>=6016&&r<=6143)(i))}function Md(i){for(const e of i)if(Ha(e.charCodeAt(0)))return!0;return!1}const hc="deferred",qs="loading",dc="loaded";let pc=null,xr="unavailable",Ir=null;const Ws=function(i){i&&typeof i=="string"&&i.indexOf("NetworkError")>-1&&(xr="error"),pc&&pc(i)};function vo(){fc.fire(new mt("pluginStateChange",{pluginStatus:xr,pluginURL:Ir}))}const fc=new Tt,Ya=function(){return xr},Yo=function(){if(xr!==hc||!Ir)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");xr=qs,vo(),Ir&&$({url:Ir},i=>{i?Ws(i):(xr=dc,vo())})},Vr={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>xr===dc||Vr.applyArabicShaping!=null,isLoading:()=>xr===qs,setState(i){xr=i.pluginStatus,Ir=i.pluginURL},isParsed:()=>Vr.applyArabicShaping!=null&&Vr.processBidirectionalText!=null&&Vr.processStyledBidirectionalText!=null,getPluginURL:()=>Ir};class gi{constructor(e,r){this.zoom=e,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.zoomHistory=r.zoomHistory,this.transition=r.transition,this.pitch=r.pitch):(this.now=0,this.fadeDuration=0,this.zoomHistory=new nc,this.transition={},this.pitch=0)}isSupportedScript(e){return function(r,n){for(const a of r)if(!Cd(a.charCodeAt(0),n))return!1;return!0}(e,Vr.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,r=e-Math.floor(e),n=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:r+(1-r)*n}:{fromScale:.5,toScale:1,t:1-(1-n)*r}}}class Hs{constructor(e,r){this.property=e,this.value=r,this.expression=function(n,a){if(yo(n))return new La(n,a);if(Zo(n)){const c=Su(n,a);if(c.result==="error")throw new Error(c.value.map(h=>`${h.key}: ${h.message}`).join(", "));return c.value}{let c=n;return typeof n=="string"&&a.type==="color"&&(c=$t.parse(n)),{kind:"constant",evaluate:()=>c}}}(r===void 0?e.specification.default:r,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,r,n){return this.property.possiblyEvaluate(this,e,r,n)}}class Xo{constructor(e){this.property=e,this.value=new Hs(e,void 0)}transitioned(e,r){return new t(this.property,this.value,r,mi({},e.transition,this.transition),e.now)}untransitioned(){return new t(this.property,this.value,null,{},0)}}class l{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return Li(this._values[e].value.value)}setValue(e,r){this._values.hasOwnProperty(e)||(this._values[e]=new Xo(this._values[e].property)),this._values[e].value=new Hs(this._values[e].property,r===null?void 0:Li(r))}getTransition(e){return Li(this._values[e].transition)}setTransition(e,r){this._values.hasOwnProperty(e)||(this._values[e]=new Xo(this._values[e].property)),this._values[e].transition=Li(r)||void 0}serialize(){const e={};for(const r of Object.keys(this._values)){const n=this.getValue(r);n!==void 0&&(e[r]=n);const a=this.getTransition(r);a!==void 0&&(e[`${r}-transition`]=a)}return e}transitioned(e,r){const n=new o(this._properties);for(const a of Object.keys(this._values))n._values[a]=this._values[a].transitioned(e,r._values[a]);return n}untransitioned(){const e=new o(this._properties);for(const r of Object.keys(this._values))e._values[r]=this._values[r].untransitioned();return e}}class t{constructor(e,r,n,a,c){const h=a.delay||0,p=a.duration||0;c=c||0,this.property=e,this.value=r,this.begin=c+h,this.end=this.begin+p,e.specification.transition&&(a.delay||a.duration)&&(this.prior=n)}possiblyEvaluate(e,r,n){const a=e.now||0,c=this.value.possiblyEvaluate(e,r,n),h=this.prior;if(h){if(a>this.end)return this.prior=null,c;if(this.value.isDataDriven())return this.prior=null,c;if(a<this.begin)return h.possiblyEvaluate(e,r,n);{const p=(a-this.begin)/(this.end-this.begin);return this.property.interpolate(h.possiblyEvaluate(e,r,n),c,Xt(p))}}return c}}class o{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,r,n){const a=new m(this._properties);for(const c of Object.keys(this._values))a._values[c]=this._values[c].possiblyEvaluate(e,r,n);return a}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class u{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return Li(this._values[e].value)}setValue(e,r){this._values[e]=new Hs(this._values[e].property,r===null?void 0:Li(r))}serialize(){const e={};for(const r of Object.keys(this._values)){const n=this.getValue(r);n!==void 0&&(e[r]=n)}return e}possiblyEvaluate(e,r,n){const a=new m(this._properties);for(const c of Object.keys(this._values))a._values[c]=this._values[c].possiblyEvaluate(e,r,n);return a}}class f{constructor(e,r,n){this.property=e,this.value=r,this.parameters=n}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,r,n,a){return this.property.evaluate(this.value,this.parameters,e,r,n,a)}}class m{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class g{constructor(e){this.specification=e}possiblyEvaluate(e,r){return e.expression.evaluate(r)}interpolate(e,r,n){const a=Ta[this.specification.type];return a?a(e,r,n):e}}class v{constructor(e,r){this.specification=e,this.overrides=r}possiblyEvaluate(e,r,n,a){return new f(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(r,null,{},n,a)}:e.expression,r)}interpolate(e,r,n){if(e.value.kind!=="constant"||r.value.kind!=="constant")return e;if(e.value.value===void 0||r.value.value===void 0)return new f(this,{kind:"constant",value:void 0},e.parameters);const a=Ta[this.specification.type];return a?new f(this,{kind:"constant",value:a(e.value.value,r.value.value,n)},e.parameters):e}evaluate(e,r,n,a,c,h){return e.kind==="constant"?e.value:e.evaluate(r,n,a,c,h)}}class T extends v{possiblyEvaluate(e,r,n,a){if(e.value===void 0)return new f(this,{kind:"constant",value:void 0},r);if(e.expression.kind==="constant"){const c=e.expression.evaluate(r,null,{},n,a),h=e.property.specification.type==="resolvedImage"&&typeof c!="string"?c.name:c,p=this._calculate(h,h,h,r);return new f(this,{kind:"constant",value:p},r)}if(e.expression.kind==="camera"){const c=this._calculate(e.expression.evaluate({zoom:r.zoom-1}),e.expression.evaluate({zoom:r.zoom}),e.expression.evaluate({zoom:r.zoom+1}),r);return new f(this,{kind:"constant",value:c},r)}return new f(this,e.expression,r)}evaluate(e,r,n,a,c,h){if(e.kind==="source"){const p=e.evaluate(r,n,a,c,h);return this._calculate(p,p,p,r)}return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(r.zoom)-1},n,a),e.evaluate({zoom:Math.floor(r.zoom)},n,a),e.evaluate({zoom:Math.floor(r.zoom)+1},n,a),r):e.value}_calculate(e,r,n,a){return a.zoom>a.zoomHistory.lastIntegerZoom?{from:e,to:r,other:n}:{from:n,to:r,other:e}}interpolate(e){return e}}class C{constructor(e){this.specification=e}possiblyEvaluate(e,r,n,a){if(e.value!==void 0){if(e.expression.kind==="constant"){const c=e.expression.evaluate(r,null,{},n,a);return this._calculate(c,c,c,r)}return this._calculate(e.expression.evaluate(new gi(Math.floor(r.zoom-1),r)),e.expression.evaluate(new gi(Math.floor(r.zoom),r)),e.expression.evaluate(new gi(Math.floor(r.zoom+1),r)),r)}}_calculate(e,r,n,a){return a.zoom>a.zoomHistory.lastIntegerZoom?{from:e,to:r}:{from:n,to:r}}interpolate(e){return e}}class S{constructor(e){this.specification=e}possiblyEvaluate(e,r,n,a){return!!e.expression.evaluate(r,null,{},n,a)}interpolate(){return!1}}class k{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const r in e){const n=e[r];n.specification.overridable&&this.overridableProperties.push(r);const a=this.defaultPropertyValues[r]=new Hs(n,void 0),c=this.defaultTransitionablePropertyValues[r]=new Xo(n);this.defaultTransitioningPropertyValues[r]=c.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=a.possiblyEvaluate({})}}}function O(i,e){return 256*(i=It(Math.floor(i),0,255))+It(Math.floor(e),0,255)}tt(v),tt(g),tt(T),tt(C),tt(S);const V={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class N{constructor(e,r){this._structArray=e,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class R{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,r){return e._trim(),r&&(e.isTransferred=!0,r.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const r=Object.create(this.prototype);return r.arrayBuffer=e.arrayBuffer,r.length=e.length,r.capacity=e.arrayBuffer.byteLength/r.bytesPerElement,r._refreshViews(),r}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const r=this.uint8;this._refreshViews(),r&&this.uint8.set(r)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Q(i,e=1){let r=0,n=0;return{members:i.map(a=>{const c=V[a.type].BYTES_PER_ELEMENT,h=r=Z(r,Math.max(e,c)),p=a.components||1;return n=Math.max(n,c),r+=c*p,{name:a.name,type:a.type,components:p,offset:h}}),size:Z(r,Math.max(n,e)),alignment:e}}function Z(i,e){return Math.ceil(i/e)*e}class Y extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r){const n=this.length;return this.resize(n+1),this.emplace(n,e,r)}emplace(e,r,n){const a=2*e;return this.int16[a+0]=r,this.int16[a+1]=n,e}}Y.prototype.bytesPerElement=4,tt(Y);class X extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,n){const a=this.length;return this.resize(a+1),this.emplace(a,e,r,n)}emplace(e,r,n,a){const c=3*e;return this.int16[c+0]=r,this.int16[c+1]=n,this.int16[c+2]=a,e}}X.prototype.bytesPerElement=6,tt(X);class ee extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,n,a){const c=this.length;return this.resize(c+1),this.emplace(c,e,r,n,a)}emplace(e,r,n,a,c){const h=4*e;return this.int16[h+0]=r,this.int16[h+1]=n,this.int16[h+2]=a,this.int16[h+3]=c,e}}ee.prototype.bytesPerElement=8,tt(ee);class H extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,n,a,c,h,p){const _=this.length;return this.resize(_+1),this.emplace(_,e,r,n,a,c,h,p)}emplace(e,r,n,a,c,h,p,_){const x=6*e,A=12*e,w=3*e;return this.int16[x+0]=r,this.int16[x+1]=n,this.uint8[A+4]=a,this.uint8[A+5]=c,this.uint8[A+6]=h,this.uint8[A+7]=p,this.float32[w+2]=_,e}}H.prototype.bytesPerElement=12,tt(H);class re extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,n){const a=this.length;return this.resize(a+1),this.emplace(a,e,r,n)}emplace(e,r,n,a){const c=3*e;return this.float32[c+0]=r,this.float32[c+1]=n,this.float32[c+2]=a,e}}re.prototype.bytesPerElement=12,tt(re);class _e extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,n,a,c,h,p,_,x,A){const w=this.length;return this.resize(w+1),this.emplace(w,e,r,n,a,c,h,p,_,x,A)}emplace(e,r,n,a,c,h,p,_,x,A,w){const E=10*e;return this.uint16[E+0]=r,this.uint16[E+1]=n,this.uint16[E+2]=a,this.uint16[E+3]=c,this.uint16[E+4]=h,this.uint16[E+5]=p,this.uint16[E+6]=_,this.uint16[E+7]=x,this.uint16[E+8]=A,this.uint16[E+9]=w,e}}_e.prototype.bytesPerElement=20,tt(_e);class Ae extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,n,a,c,h,p,_){const x=this.length;return this.resize(x+1),this.emplace(x,e,r,n,a,c,h,p,_)}emplace(e,r,n,a,c,h,p,_,x){const A=8*e;return this.uint16[A+0]=r,this.uint16[A+1]=n,this.uint16[A+2]=a,this.uint16[A+3]=c,this.uint16[A+4]=h,this.uint16[A+5]=p,this.uint16[A+6]=_,this.uint16[A+7]=x,e}}Ae.prototype.bytesPerElement=16,tt(Ae);class Se extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,n,a,c,h){const p=this.length;return this.resize(p+1),this.emplace(p,e,r,n,a,c,h)}emplace(e,r,n,a,c,h,p){const _=6*e;return this.int16[_+0]=r,this.int16[_+1]=n,this.int16[_+2]=a,this.int16[_+3]=c,this.int16[_+4]=h,this.int16[_+5]=p,e}}Se.prototype.bytesPerElement=12,tt(Se);class Ce extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,n,a,c,h,p,_,x,A,w,E,z,P,F,U){const q=this.length;return this.resize(q+1),this.emplace(q,e,r,n,a,c,h,p,_,x,A,w,E,z,P,F,U)}emplace(e,r,n,a,c,h,p,_,x,A,w,E,z,P,F,U,q){const ie=16*e;return this.int16[ie+0]=r,this.int16[ie+1]=n,this.int16[ie+2]=a,this.int16[ie+3]=c,this.uint16[ie+4]=h,this.uint16[ie+5]=p,this.uint16[ie+6]=_,this.uint16[ie+7]=x,this.int16[ie+8]=A,this.int16[ie+9]=w,this.int16[ie+10]=E,this.int16[ie+11]=z,this.int16[ie+12]=P,this.int16[ie+13]=F,this.int16[ie+14]=U,this.int16[ie+15]=q,e}}Ce.prototype.bytesPerElement=32,tt(Ce);class Ge extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.uint32[1*e+0]=r,e}}Ge.prototype.bytesPerElement=4,tt(Ge);class ge extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,n,a,c,h,p,_,x,A,w,E,z){const P=this.length;return this.resize(P+1),this.emplace(P,e,r,n,a,c,h,p,_,x,A,w,E,z)}emplace(e,r,n,a,c,h,p,_,x,A,w,E,z,P){const F=20*e,U=10*e;return this.int16[F+0]=r,this.int16[F+1]=n,this.int16[F+2]=a,this.int16[F+3]=c,this.int16[F+4]=h,this.float32[U+3]=p,this.float32[U+4]=_,this.float32[U+5]=x,this.float32[U+6]=A,this.int16[F+14]=w,this.uint32[U+8]=E,this.uint16[F+18]=z,this.uint16[F+19]=P,e}}ge.prototype.bytesPerElement=40,tt(ge);class Ue extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,n,a,c,h,p){const _=this.length;return this.resize(_+1),this.emplace(_,e,r,n,a,c,h,p)}emplace(e,r,n,a,c,h,p,_){const x=8*e;return this.int16[x+0]=r,this.int16[x+1]=n,this.int16[x+2]=a,this.int16[x+4]=c,this.int16[x+5]=h,this.int16[x+6]=p,this.int16[x+7]=_,e}}Ue.prototype.bytesPerElement=16,tt(Ue);class Oe extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,n,a,c){const h=this.length;return this.resize(h+1),this.emplace(h,e,r,n,a,c)}emplace(e,r,n,a,c,h){const p=4*e,_=8*e;return this.float32[p+0]=r,this.float32[p+1]=n,this.float32[p+2]=a,this.int16[_+6]=c,this.int16[_+7]=h,e}}Oe.prototype.bytesPerElement=16,tt(Oe);class st extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,n,a){const c=this.length;return this.resize(c+1),this.emplace(c,e,r,n,a)}emplace(e,r,n,a,c){const h=12*e,p=3*e;return this.uint8[h+0]=r,this.uint8[h+1]=n,this.float32[p+1]=a,this.float32[p+2]=c,e}}st.prototype.bytesPerElement=12,tt(st);class be extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,n){const a=this.length;return this.resize(a+1),this.emplace(a,e,r,n)}emplace(e,r,n,a){const c=3*e;return this.uint16[c+0]=r,this.uint16[c+1]=n,this.uint16[c+2]=a,e}}be.prototype.bytesPerElement=6,tt(be);class pt extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,r,n,a,c,h,p,_,x,A,w,E,z,P,F,U,q,ie,oe,ae,le){const ce=this.length;return this.resize(ce+1),this.emplace(ce,e,r,n,a,c,h,p,_,x,A,w,E,z,P,F,U,q,ie,oe,ae,le)}emplace(e,r,n,a,c,h,p,_,x,A,w,E,z,P,F,U,q,ie,oe,ae,le,ce){const we=30*e,Me=15*e,De=60*e;return this.int16[we+0]=r,this.int16[we+1]=n,this.int16[we+2]=a,this.float32[Me+2]=c,this.float32[Me+3]=h,this.uint16[we+8]=p,this.uint16[we+9]=_,this.uint32[Me+5]=x,this.uint32[Me+6]=A,this.uint32[Me+7]=w,this.uint16[we+16]=E,this.uint16[we+17]=z,this.uint16[we+18]=P,this.float32[Me+10]=F,this.float32[Me+11]=U,this.uint8[De+48]=q,this.uint8[De+49]=ie,this.uint8[De+50]=oe,this.uint32[Me+13]=ae,this.int16[we+28]=le,this.uint8[De+58]=ce,e}}pt.prototype.bytesPerElement=60,tt(pt);class gt extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,r,n,a,c,h,p,_,x,A,w,E,z,P,F,U,q,ie,oe,ae,le,ce,we,Me,De,Pe,ve,Ie,Re,Ze){const Ne=this.length;return this.resize(Ne+1),this.emplace(Ne,e,r,n,a,c,h,p,_,x,A,w,E,z,P,F,U,q,ie,oe,ae,le,ce,we,Me,De,Pe,ve,Ie,Re,Ze)}emplace(e,r,n,a,c,h,p,_,x,A,w,E,z,P,F,U,q,ie,oe,ae,le,ce,we,Me,De,Pe,ve,Ie,Re,Ze,Ne){const je=38*e,Mt=19*e;return this.int16[je+0]=r,this.int16[je+1]=n,this.int16[je+2]=a,this.float32[Mt+2]=c,this.float32[Mt+3]=h,this.int16[je+8]=p,this.int16[je+9]=_,this.int16[je+10]=x,this.int16[je+11]=A,this.int16[je+12]=w,this.int16[je+13]=E,this.uint16[je+14]=z,this.uint16[je+15]=P,this.uint16[je+16]=F,this.uint16[je+17]=U,this.uint16[je+18]=q,this.uint16[je+19]=ie,this.uint16[je+20]=oe,this.uint16[je+21]=ae,this.uint16[je+22]=le,this.uint16[je+23]=ce,this.uint16[je+24]=we,this.uint16[je+25]=Me,this.uint16[je+26]=De,this.uint16[je+27]=Pe,this.uint16[je+28]=ve,this.uint32[Mt+15]=Ie,this.float32[Mt+16]=Re,this.float32[Mt+17]=Ze,this.float32[Mt+18]=Ne,e}}gt.prototype.bytesPerElement=76,tt(gt);class rt extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.float32[1*e+0]=r,e}}rt.prototype.bytesPerElement=4,tt(rt);class nt extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,n,a,c,h,p){const _=this.length;return this.resize(_+1),this.emplace(_,e,r,n,a,c,h,p)}emplace(e,r,n,a,c,h,p,_){const x=7*e;return this.float32[x+0]=r,this.float32[x+1]=n,this.float32[x+2]=a,this.float32[x+3]=c,this.float32[x+4]=h,this.float32[x+5]=p,this.float32[x+6]=_,e}}nt.prototype.bytesPerElement=28,tt(nt);class At extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,n,a,c){const h=this.length;return this.resize(h+1),this.emplace(h,e,r,n,a,c)}emplace(e,r,n,a,c,h){const p=5*e;return this.float32[p+0]=r,this.float32[p+1]=n,this.float32[p+2]=a,this.float32[p+3]=c,this.float32[p+4]=h,e}}At.prototype.bytesPerElement=20,tt(At);class Pt extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,n,a){const c=this.length;return this.resize(c+1),this.emplace(c,e,r,n,a)}emplace(e,r,n,a,c){const h=6*e;return this.uint32[3*e+0]=r,this.uint16[h+2]=n,this.uint16[h+3]=a,this.uint16[h+4]=c,e}}Pt.prototype.bytesPerElement=12,tt(Pt);class ct extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r){const n=this.length;return this.resize(n+1),this.emplace(n,e,r)}emplace(e,r,n){const a=2*e;return this.uint16[a+0]=r,this.uint16[a+1]=n,e}}ct.prototype.bytesPerElement=4,tt(ct);class Ct extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.uint16[1*e+0]=r,e}}Ct.prototype.bytesPerElement=2,tt(Ct);class Ht extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r){const n=this.length;return this.resize(n+1),this.emplace(n,e,r)}emplace(e,r,n){const a=2*e;return this.float32[a+0]=r,this.float32[a+1]=n,e}}Ht.prototype.bytesPerElement=8,tt(Ht);class Mi extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,n,a){const c=this.length;return this.resize(c+1),this.emplace(c,e,r,n,a)}emplace(e,r,n,a,c){const h=4*e;return this.float32[h+0]=r,this.float32[h+1]=n,this.float32[h+2]=a,this.float32[h+3]=c,e}}Mi.prototype.bytesPerElement=16,tt(Mi);class nr extends R{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,n,a,c,h,p){const _=this.length;return this.resize(_+1),this.emplace(_,e,r,n,a,c,h,p)}emplace(e,r,n,a,c,h,p,_){const x=8*e,A=4*e;return this.int16[x+0]=r,this.int16[x+1]=n,this.int16[x+2]=a,this.int16[x+3]=c,this.int16[x+4]=h,this.int16[x+5]=p,this.float32[A+3]=_,e}}nr.prototype.bytesPerElement=16,tt(nr);class or extends N{get a_pos_30(){return this._structArray.int16[this._pos2+0]}get a_pos_31(){return this._structArray.int16[this._pos2+1]}get a_pos_32(){return this._structArray.int16[this._pos2+2]}get a_pos_normal_30(){return this._structArray.int16[this._pos2+3]}get a_pos_normal_31(){return this._structArray.int16[this._pos2+4]}get a_pos_normal_32(){return this._structArray.int16[this._pos2+5]}}or.prototype.size=12;class zr extends Se{get(e){return new or(this,e)}}tt(zr);class sn extends N{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}sn.prototype.size=40;class Cn extends ge{get(e){return new sn(this,e)}}tt(Cn);class jn extends N{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}jn.prototype.size=60;class Mn extends pt{get(e){return new jn(this,e)}}tt(Mn);class Si extends N{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(e){this._structArray.uint32[this._pos4+15]=e}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Si.prototype.size=76;class Di extends gt{get(e){return new Si(this,e)}}tt(Di);class ii extends rt{getoffsetX(e){return this.float32[1*e+0]}}tt(ii);class Fi extends X{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}tt(Fi);class Dr extends N{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Dr.prototype.size=12;class Ei extends Pt{get(e){return new Dr(this,e)}}tt(Ei);class Gr extends N{get a_centroid_pos0(){return this._structArray.uint16[this._pos2+0]}get a_centroid_pos1(){return this._structArray.uint16[this._pos2+1]}}Gr.prototype.size=4;class Ys extends ct{get(e){return new Gr(this,e)}}tt(Ys);class kr extends N{get a_pos_30(){return this._structArray.int16[this._pos2+0]}get a_pos_31(){return this._structArray.int16[this._pos2+1]}get a_pos_32(){return this._structArray.int16[this._pos2+2]}get a_pos_normal_30(){return this._structArray.int16[this._pos2+3]}get a_pos_normal_31(){return this._structArray.int16[this._pos2+4]}get a_pos_normal_32(){return this._structArray.int16[this._pos2+5]}get a_scale(){return this._structArray.float32[this._pos4+3]}}kr.prototype.size=16;class Ao extends nr{get(e){return new kr(this,e)}}tt(Ao);const ih=Q([{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"}]),mc=Q([{name:"a_dash_to",components:4,type:"Uint16"},{name:"a_dash_from",components:4,type:"Uint16"}]);var Qo=ga(function(i){i.exports=function(e,r){var n,a,c,h,p,_,x,A;for(a=e.length-(n=3&e.length),c=r,p=3432918353,_=461845907,A=0;A<a;)x=255&e.charCodeAt(A)|(255&e.charCodeAt(++A))<<8|(255&e.charCodeAt(++A))<<16|(255&e.charCodeAt(++A))<<24,++A,c=27492+(65535&(h=5*(65535&(c=(c^=x=(65535&(x=(x=(65535&x)*p+(((x>>>16)*p&65535)<<16)&4294967295)<<15|x>>>17))*_+(((x>>>16)*_&65535)<<16)&4294967295)<<13|c>>>19))+((5*(c>>>16)&65535)<<16)&4294967295))+((58964+(h>>>16)&65535)<<16);switch(x=0,n){case 3:x^=(255&e.charCodeAt(A+2))<<16;case 2:x^=(255&e.charCodeAt(A+1))<<8;case 1:c^=x=(65535&(x=(x=(65535&(x^=255&e.charCodeAt(A)))*p+(((x>>>16)*p&65535)<<16)&4294967295)<<15|x>>>17))*_+(((x>>>16)*_&65535)<<16)&4294967295}return c^=e.length,c=2246822507*(65535&(c^=c>>>16))+((2246822507*(c>>>16)&65535)<<16)&4294967295,c=3266489909*(65535&(c^=c>>>13))+((3266489909*(c>>>16)&65535)<<16)&4294967295,(c^=c>>>16)>>>0}}),Sd=ga(function(i){i.exports=function(e,r){for(var n,a=e.length,c=r^a,h=0;a>=4;)n=1540483477*(65535&(n=255&e.charCodeAt(h)|(255&e.charCodeAt(++h))<<8|(255&e.charCodeAt(++h))<<16|(255&e.charCodeAt(++h))<<24))+((1540483477*(n>>>16)&65535)<<16),c=1540483477*(65535&c)+((1540483477*(c>>>16)&65535)<<16)^(n=1540483477*(65535&(n^=n>>>24))+((1540483477*(n>>>16)&65535)<<16)),a-=4,++h;switch(a){case 3:c^=(255&e.charCodeAt(h+2))<<16;case 2:c^=(255&e.charCodeAt(h+1))<<8;case 1:c=1540483477*(65535&(c^=255&e.charCodeAt(h)))+((1540483477*(c>>>16)&65535)<<16)}return c=1540483477*(65535&(c^=c>>>13))+((1540483477*(c>>>16)&65535)<<16),(c^=c>>>15)>>>0}}),Zn=Qo,_c=Sd;Zn.murmur3=Qo,Zn.murmur2=_c;class rh{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,r,n,a){this.ids.push(kf(e)),this.positions.push(r,n,a)}getPositions(e){const r=kf(e);let n=0,a=this.ids.length-1;for(;n<a;){const h=n+a>>1;this.ids[h]>=r?a=h:n=h+1}const c=[];for(;this.ids[n]===r;)c.push({index:this.positions[3*n],start:this.positions[3*n+1],end:this.positions[3*n+2]}),n++;return c}static serialize(e,r){const n=new Float64Array(e.ids),a=new Uint32Array(e.positions);return Id(n,a,0,n.length-1),r&&r.push(n.buffer,a.buffer),{ids:n,positions:a}}static deserialize(e){const r=new rh;return r.ids=e.ids,r.positions=e.positions,r.indexed=!0,r}}function kf(i){const e=+i;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:Zn(String(i))}function Id(i,e,r,n){for(;r<n;){const a=i[r+n>>1];let c=r-1,h=n+1;for(;;){do c++;while(i[c]<a);do h--;while(i[h]>a);if(c>=h)break;nh(i,c,h),nh(e,3*c,3*h),nh(e,3*c+1,3*h+1),nh(e,3*c+2,3*h+2)}h-r<n-h?(Id(i,e,r,h),r=h+1):(Id(i,e,h+1,n),n=h)}}function nh(i,e,r){const n=i[e];i[e]=i[r],i[r]=n}tt(rh);class bo{constructor(e,r){this.gl=e.gl,this.location=r}}class oh extends bo{constructor(e,r){super(e,r),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class Pf extends bo{constructor(e,r){super(e,r),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class Bf extends bo{constructor(e,r){super(e,r),this.current=$t.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const qy=new Float32Array(16),Wy=new Float32Array(9),Hy=new Float32Array(4);function zd(i){return[O(255*i.r,255*i.g),O(255*i.b,255*i.a)]}class gc{constructor(e,r,n){this.value=e,this.uniformNames=r.map(a=>`u_${a}`),this.type=n}setUniform(e,r,n){e.set(n.constantOr(this.value))}getBinding(e,r,n){return this.type==="color"?new Bf(e,r):new oh(e,r)}}class Xa{constructor(e,r){this.uniformNames=r.map(n=>`u_${n}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,r){this.pixelRatioFrom=r.pixelRatio||1,this.pixelRatioTo=e.pixelRatio||1,this.patternFrom=r.tl.concat(r.br),this.patternTo=e.tl.concat(e.br)}setUniform(e,r,n,a){const c=a==="u_pattern_to"||a==="u_dash_to"?this.patternTo:a==="u_pattern_from"||a==="u_dash_from"?this.patternFrom:a==="u_pixel_ratio_to"?this.pixelRatioTo:a==="u_pixel_ratio_from"?this.pixelRatioFrom:null;c&&e.set(c)}getBinding(e,r,n){return n==="u_pattern_from"||n==="u_pattern_to"||n==="u_dash_from"||n==="u_dash_to"?new Pf(e,r):new oh(e,r)}}class wo{constructor(e,r,n,a){this.expression=e,this.type=n,this.maxValue=0,this.paintVertexAttributes=r.map(c=>({name:`a_${c}`,type:"Float32",components:n==="color"?2:1,offset:0})),this.paintVertexArray=new a}populatePaintArray(e,r,n,a,c,h){const p=this.paintVertexArray.length,_=this.expression.evaluate(new gi(0),r,{},c,a,h);this.paintVertexArray.resize(e),this._setPaintValue(p,e,_)}updatePaintArray(e,r,n,a,c){const h=this.expression.evaluate({zoom:0},n,a,void 0,c);this._setPaintValue(e,r,h)}_setPaintValue(e,r,n){if(this.type==="color"){const a=zd(n);for(let c=e;c<r;c++)this.paintVertexArray.emplace(c,a[0],a[1])}else{for(let a=e;a<r;a++)this.paintVertexArray.emplace(a,n);this.maxValue=Math.max(this.maxValue,Math.abs(n))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Sn{constructor(e,r,n,a,c,h){this.expression=e,this.uniformNames=r.map(p=>`u_${p}_t`),this.type=n,this.useIntegerZoom=a,this.zoom=c,this.maxValue=0,this.paintVertexAttributes=r.map(p=>({name:`a_${p}`,type:"Float32",components:n==="color"?4:2,offset:0})),this.paintVertexArray=new h}populatePaintArray(e,r,n,a,c,h){const p=this.expression.evaluate(new gi(this.zoom),r,{},c,a,h),_=this.expression.evaluate(new gi(this.zoom+1),r,{},c,a,h),x=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(x,e,p,_)}updatePaintArray(e,r,n,a,c){const h=this.expression.evaluate({zoom:this.zoom},n,a,void 0,c),p=this.expression.evaluate({zoom:this.zoom+1},n,a,void 0,c);this._setPaintValue(e,r,h,p)}_setPaintValue(e,r,n,a){if(this.type==="color"){const c=zd(n),h=zd(a);for(let p=e;p<r;p++)this.paintVertexArray.emplace(p,c[0],c[1],h[0],h[1])}else{for(let c=e;c<r;c++)this.paintVertexArray.emplace(c,n,a);this.maxValue=Math.max(this.maxValue,Math.abs(n),Math.abs(a))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,r){const n=this.useIntegerZoom?Math.floor(r.zoom):r.zoom,a=It(this.expression.interpolationFactor(n,this.zoom,this.zoom+1),0,1);e.set(a)}getBinding(e,r,n){return new oh(e,r)}}class Ko{constructor(e,r,n,a,c,h,p){this.expression=e,this.type=n,this.useIntegerZoom=a,this.zoom=c,this.layerId=p,this.paintVertexAttributes=(n==="array"?mc:ih).members;for(let _=0;_<r.length;++_);this.zoomInPaintVertexArray=new h,this.zoomOutPaintVertexArray=new h}populatePaintArray(e,r,n){const a=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(a,e,r.patterns&&r.patterns[this.layerId],n)}updatePaintArray(e,r,n,a,c,h){this._setPaintValues(e,r,n.patterns&&n.patterns[this.layerId],h)}_setPaintValues(e,r,n,a){if(!a||!n)return;const{min:c,mid:h,max:p}=n,_=a[c],x=a[h],A=a[p];if(_&&x&&A)for(let w=e;w<r;w++)this._setPaintValue(this.zoomInPaintVertexArray,w,x,_),this._setPaintValue(this.zoomOutPaintVertexArray,w,x,A)}_setPaintValue(e,r,n,a){e.emplace(r,n.tl[0],n.tl[1],n.br[0],n.br[1],a.tl[0],a.tl[1],a.br[0],a.br[1],n.pixelRatio,a.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class $o{constructor(e,r,n=()=>!0){this.binders={},this._buffers=[];const a=[];for(const c in e.paint._values){if(!n(c))continue;const h=e.paint.get(c);if(!(h instanceof f&&jo(h.property.specification)))continue;const p=Xy(c,e.type),_=h.value,x=h.property.specification.type,A=h.property.useIntegerZoom,w=h.property.specification["property-type"],E=w==="cross-faded"||w==="cross-faded-data-driven",z=String(c)==="line-dasharray"&&e.layout.get("line-cap").value.kind!=="constant";if(_.kind!=="constant"||z)if(_.kind==="source"||z||E){const P=Lf(c,x,"source");this.binders[c]=E?new Ko(_,p,x,A,r,P,e.id):new wo(_,p,x,P),a.push(`/a_${c}`)}else{const P=Lf(c,x,"composite");this.binders[c]=new Sn(_,p,x,A,r,P),a.push(`/z_${c}`)}else this.binders[c]=E?new Xa(_.value,p):new gc(_.value,p,x),a.push(`/u_${c}`)}this.cacheKey=a.sort().join("")}getMaxValue(e){const r=this.binders[e];return r instanceof wo||r instanceof Sn?r.maxValue:0}populatePaintArrays(e,r,n,a,c,h){for(const p in this.binders){const _=this.binders[p];(_ instanceof wo||_ instanceof Sn||_ instanceof Ko)&&_.populatePaintArray(e,r,n,a,c,h)}}setConstantPatternPositions(e,r){for(const n in this.binders){const a=this.binders[n];a instanceof Xa&&a.setConstantPatternPositions(e,r)}}updatePaintArrays(e,r,n,a,c,h){let p=!1;for(const _ in e){const x=r.getPositions(_);for(const A of x){const w=n.feature(A.index);for(const E in this.binders){const z=this.binders[E];if((z instanceof wo||z instanceof Sn||z instanceof Ko)&&z.expression.isStateDependent===!0){const P=a.paint.get(E);z.expression=P.value,z.updatePaintArray(A.start,A.end,w,e[_],c,h),p=!0}}}}return p}defines(){const e=[];for(const r in this.binders){const n=this.binders[r];(n instanceof gc||n instanceof Xa)&&e.push(...n.uniformNames.map(a=>`#define HAS_UNIFORM_${a}`))}return e}getBinderAttributes(){const e=[];for(const r in this.binders){const n=this.binders[r];if(n instanceof wo||n instanceof Sn||n instanceof Ko)for(let a=0;a<n.paintVertexAttributes.length;a++)e.push(n.paintVertexAttributes[a].name)}return e}getBinderUniforms(){const e=[];for(const r in this.binders){const n=this.binders[r];if(n instanceof gc||n instanceof Xa||n instanceof Sn)for(const a of n.uniformNames)e.push(a)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,r){const n=[];for(const a in this.binders){const c=this.binders[a];if(c instanceof gc||c instanceof Xa||c instanceof Sn){for(const h of c.uniformNames)if(r[h]){const p=c.getBinding(e,r[h],h);n.push({name:h,property:a,binding:p})}}}return n}setUniforms(e,r,n,a){for(const{name:c,property:h,binding:p}of r)this.binders[h].setUniform(p,a,n.get(h),c)}updatePaintBuffers(e){this._buffers=[];for(const r in this.binders){const n=this.binders[r];if(e&&n instanceof Ko){const a=e.fromScale===2?n.zoomInPaintVertexBuffer:n.zoomOutPaintVertexBuffer;a&&this._buffers.push(a)}else(n instanceof wo||n instanceof Sn)&&n.paintVertexBuffer&&this._buffers.push(n.paintVertexBuffer)}}upload(e){for(const r in this.binders){const n=this.binders[r];(n instanceof wo||n instanceof Sn||n instanceof Ko)&&n.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const r=this.binders[e];(r instanceof wo||r instanceof Sn||r instanceof Ko)&&r.destroy()}}}class Xs{constructor(e,r,n=()=>!0){this.programConfigurations={};for(const a of e)this.programConfigurations[a.id]=new $o(a,r,n);this.needsUpload=!1,this._featureMap=new rh,this._bufferOffset=0}populatePaintArrays(e,r,n,a,c,h,p){for(const _ in this.programConfigurations)this.programConfigurations[_].populatePaintArrays(e,r,a,c,h,p);r.id!==void 0&&this._featureMap.add(r.id,n,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,r,n,a,c){for(const h of n)this.needsUpload=this.programConfigurations[h.id].updatePaintArrays(e,this._featureMap,r,h,a,c)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const r in this.programConfigurations)this.programConfigurations[r].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const Yy={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"line-dasharray":["dash_to","dash_from"]};function Xy(i,e){return Yy[i]||[i.replace(`${e}-`,"").replace(/-/g,"_")]}const Qy={"line-pattern":{source:_e,composite:_e},"fill-pattern":{source:_e,composite:_e},"fill-extrusion-pattern":{source:_e,composite:_e},"line-dasharray":{source:Ae,composite:Ae}},Ky={color:{source:Ht,composite:Mi},number:{source:rt,composite:Ht}};function Lf(i,e,r){const n=Qy[i];return n&&n[r]||Ky[e][r]}tt(gc),tt(Xa),tt(wo),tt(Ko),tt(Sn),tt($o,{omit:["_buffers"]}),tt(Xs);const sh="-transition";class In extends Tt{constructor(e,r){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,e.type!=="custom"&&(this.metadata=(e=e).metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&e.type!=="sky"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),r.layout&&(this._unevaluatedLayout=new u(r.layout)),r.paint)){this._transitionablePaint=new l(r.paint);for(const n in e.paint)this.setPaintProperty(n,e.paint[n],{validate:!1});for(const n in e.layout)this.setLayoutProperty(n,e.layout[n],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new m(r.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,r,n={}){r!=null&&this._validate(Ed,`layers.${this.id}.layout.${e}`,e,r,n)||(e!=="visibility"?this._unevaluatedLayout.setValue(e,r):this.visibility=r)}getPaintProperty(e){return Wt(e,sh)?this._transitionablePaint.getTransition(e.slice(0,-sh.length)):this._transitionablePaint.getValue(e)}setPaintProperty(e,r,n={}){if(r!=null&&this._validate(Td,`layers.${this.id}.paint.${e}`,e,r,n))return!1;if(Wt(e,sh))return this._transitionablePaint.setTransition(e.slice(0,-sh.length),r||void 0),!1;{const a=this._transitionablePaint._values[e],c=a.property.specification["property-type"]==="cross-faded-data-driven",h=a.value.isDataDriven(),p=a.value;this._transitionablePaint.setValue(e,r),this._handleSpecialPaintPropertyUpdate(e);const _=this._transitionablePaint._values[e].value;return _.isDataDriven()||h||c||this._handleOverridablePaintPropertyUpdate(e,p,_)}}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getProgramConfiguration(e){return null}_handleOverridablePaintPropertyUpdate(e,r,n){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,r){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,r)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,r)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),Or(e,(r,n)=>!(r===void 0||n==="layout"&&!Object.keys(r).length||n==="paint"&&!Object.keys(r).length))}_validate(e,r,n,a,c={}){return(!c||c.validate!==!1)&&Nu(this,e.call(Us,{key:r,layerType:this.type,objectKey:n,value:a,styleSpec:xe,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const r=this.paint.get(e);if(r instanceof f&&jo(r.property.specification)&&(r.value.kind==="source"||r.value.kind==="composite")&&r.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=Nn(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const $y=Q([{name:"a_pos",components:2,type:"Int16"}],4),Jy=Q([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"},{name:"a_scale",components:1,type:"Float32"}]);class ki{constructor(e=[]){this.segments=e}prepareSegment(e,r,n,a){let c=this.segments[this.segments.length-1];return e>ki.MAX_VERTEX_ARRAY_LENGTH&&Ot(`Max vertices per segment is ${ki.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!c||c.vertexLength+e>ki.MAX_VERTEX_ARRAY_LENGTH||c.sortKey!==a)&&(c={vertexOffset:r.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0},a!==void 0&&(c.sortKey=a),this.segments.push(c)),c}get(){return this.segments}destroy(){for(const e of this.segments)for(const r in e.vaos)e.vaos[r].destroy()}static simpleSegment(e,r,n,a){return new ki([{vertexOffset:e,primitiveOffset:r,vertexLength:n,primitiveLength:a,vaos:{},sortKey:0}])}}ki.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,tt(ki);var zt=8192;class Jo{constructor(e,r){e&&(r?this.setSouthWest(e).setNorthEast(r):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof di?new di(e.lng,e.lat):di.convert(e),this}setSouthWest(e){return this._sw=e instanceof di?new di(e.lng,e.lat):di.convert(e),this}extend(e){const r=this._sw,n=this._ne;let a,c;if(e instanceof di)a=e,c=e;else{if(!(e instanceof Jo))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Jo.convert(e)):this.extend(di.convert(e)):this;if(a=e._sw,c=e._ne,!a||!c)return this}return r||n?(r.lng=Math.min(a.lng,r.lng),r.lat=Math.min(a.lat,r.lat),n.lng=Math.max(c.lng,n.lng),n.lat=Math.max(c.lat,n.lat)):(this._sw=new di(a.lng,a.lat),this._ne=new di(c.lng,c.lat)),this}getCenter(){return new di((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new di(this.getWest(),this.getNorth())}getSouthEast(){return new di(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:r,lat:n}=di.convert(e);let a=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(a=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=n&&n<=this._ne.lat&&a}static convert(e){return!e||e instanceof Jo?e:new Jo(e)}}const Dd=63710088e-1;class di{constructor(e,r){if(isNaN(e)||isNaN(r))throw new Error(`Invalid LngLat object: (${e}, ${r})`);if(this.lng=+e,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new di(Qi(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const r=Math.PI/180,n=this.lat*r,a=e.lat*r,c=Math.sin(n)*Math.sin(a)+Math.cos(n)*Math.cos(a)*Math.cos((e.lng-this.lng)*r);return Dd*Math.acos(Math.min(c,1))}toBounds(e=0){const r=360*e/40075017,n=r/Math.cos(Math.PI/180*this.lat);return new Jo(new di(this.lng-n,this.lat-r),new di(this.lng+n,this.lat+r))}static convert(e){if(e instanceof di)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new di(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new di(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Rf=2*Math.PI*Dd;function kd(i){return Rf*Math.cos(i*Math.PI/180)}function yc(i){return(180+i)/360}function Qa(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function Ka(i,e){return i/kd(e)}function mn(i){return 360*i-180}function sr(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}function Ff(i,e){return i*kd(sr(e))}const qn=85.051129;class ah{constructor(e,r,n=0){this.x=+e,this.y=+r,this.z=+n}static fromLngLat(e,r=0){const n=di.convert(e);return new ah(yc(n.lng),Qa(n.lat),Ka(r,n.lat))}toLngLat(){return new di(mn(this.x),sr(this.y))}toAltitude(){return Ff(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Rf*(e=sr(this.y),1/Math.cos(e*Math.PI/180));var e}}function Pd(i,e,r,n,a,c,h,p,_){const x=(e+n)/2,A=(r+a)/2,w=new J(x,A);p(w),function(E,z,P,F,U,q){const ie=P-U,oe=F-q;return Math.abs((F-z)*ie-(P-E)*oe)/Math.hypot(ie,oe)}(w.x,w.y,c.x,c.y,h.x,h.y)>=_?(Pd(i,e,r,x,A,c,w,p,_),Pd(i,x,A,n,a,w,h,p,_)):i.push(h)}function e1(i,e,r){let n=i[0],a=n.x,c=n.y;e(n);const h=[n];for(let p=1;p<i.length;p++){const _=i[p],{x,y:A}=_;e(_),Pd(h,a,c,x,A,n,_,e,r),a=x,c=A,n=_}return h}const Bd=Math.pow(2,14)-1,Of=-Bd-1;function t1(i,e){const r=Math.round(i.x*e),n=Math.round(i.y*e);return i.x=It(r,Of,Bd),i.y=It(n,Of,Bd),(r<i.x||r>i.x+1||n<i.y||n>i.y+1)&&Ot("Geometry exceeds allowed extent, reduce your vector tile buffer size"),i}function To(i,e,r){const n=i.loadGeometry(),a=i.extent,c=zt/a;if(e&&r&&r.projection.isReprojectedInTileSpace){const h=1<<e.z,{scale:p,x:_,y:x,projection:A}=r,w=E=>{const z=mn((e.x+E.x/a)/h),P=sr((e.y+E.y/a)/h),F=A.project(z,P);E.x=(F.x*p-_)*a,E.y=(F.y*p-x)*a};for(let E=0;E<n.length;E++)if(i.type!==1)n[E]=e1(n[E],w,1);else{const z=[];for(const P of n[E])P.x<0||P.x>=a||P.y<0||P.y>=a||(w(P),z.push(P));n[E]=z}}for(const h of n)for(const p of h)t1(p,c);return n}function Qs(i,e){return{type:i.type,id:i.id,properties:i.properties,geometry:e?To(i):[]}}function lh(i,e,r,n,a){i.emplaceBack(2*e+(n+1)/2,2*r+(a+1)/2)}function ch(i,e,r,n){i.emplaceBack(e.x,e.y,e.z,r[0]*16384,r[1]*16384,r[2]*16384,n)}class Ld{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new Y,this.indexArray=new be,this.segments=new ki,this.programConfigurations=new Xs(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,n,a){const c=this.layers[0],h=[];let p=null;c.type==="circle"&&(p=c.layout.get("circle-sort-key"));for(const{feature:x,id:A,index:w,sourceLayerIndex:E}of e){const z=this.layers[0]._featureFilter.needGeometry,P=Qs(x,z);if(!this.layers[0]._featureFilter.filter(new gi(this.zoom),P,n))continue;const F=p?p.evaluate(P,{},n):void 0,U={id:A,properties:x.properties,type:x.type,sourceLayerIndex:E,index:w,geometry:z?P.geometry:To(x,n,a),patterns:{},sortKey:F};h.push(U)}p&&h.sort((x,A)=>x.sortKey-A.sortKey);let _=null;a.projection.name==="globe"&&(this.globeExtVertexArray=new Ao,_=a.projection);for(const x of h){const{geometry:A,index:w,sourceLayerIndex:E}=x,z=e[w].feature;this.addFeature(x,A,w,r.availableImages,n,_),r.featureIndex.insert(z,A,w,E,this.index)}}update(e,r,n,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,n,a)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,$y.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,Jy.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(e,r,n,a,c,h){for(const p of r)for(const _ of p){const x=_.x,A=_.y;if(x<0||x>=zt||A<0||A>=zt)continue;if(h){const z=h.projectTilePoint(x,A,c),P=h.upVector(c,x,A),F=sr((A/zt+c.y)/(1<<c.z)),U=h.pixelsPerMeter(F,1)/Ka(1,F),q=this.globeExtVertexArray;ch(q,z,P,U),ch(q,z,P,U),ch(q,z,P,U),ch(q,z,P,U)}const w=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),E=w.vertexLength;lh(this.layoutVertexArray,x,A,-1,-1),lh(this.layoutVertexArray,x,A,1,-1),lh(this.layoutVertexArray,x,A,1,1),lh(this.layoutVertexArray,x,A,-1,1),this.indexArray.emplaceBack(E,E+1,E+2),this.indexArray.emplaceBack(E,E+3,E+2),w.vertexLength+=4,w.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,{},a,c)}}function Nf(i,e){for(let r=0;r<i.length;r++)if($a(e,i[r]))return!0;for(let r=0;r<e.length;r++)if($a(i,e[r]))return!0;return!!Rd(i,e)}function i1(i,e,r){return!!$a(i,e)||!!Fd(e,i,r)}function Uf(i,e){if(i.length===1)return Gf(e,i[0]);for(let r=0;r<e.length;r++){const n=e[r];for(let a=0;a<n.length;a++)if($a(i,n[a]))return!0}for(let r=0;r<i.length;r++)if(Gf(e,i[r]))return!0;for(let r=0;r<e.length;r++)if(Rd(i,e[r]))return!0;return!1}function r1(i,e,r){if(i.length>1){if(Rd(i,e))return!0;for(let n=0;n<e.length;n++)if(Fd(e[n],i,r))return!0}for(let n=0;n<i.length;n++)if(Fd(i[n],e,r))return!0;return!1}function Rd(i,e){if(i.length===0||e.length===0)return!1;for(let r=0;r<i.length-1;r++){const n=i[r],a=i[r+1];for(let c=0;c<e.length-1;c++)if(n1(n,a,e[c],e[c+1]))return!0}return!1}function n1(i,e,r,n){return Ui(i,r,n)!==Ui(e,r,n)&&Ui(i,e,r)!==Ui(i,e,n)}function Fd(i,e,r){const n=r*r;if(e.length===1)return i.distSqr(e[0])<n;for(let a=1;a<e.length;a++)if(Vf(i,e[a-1],e[a])<n)return!0;return!1}function Vf(i,e,r){const n=e.distSqr(r);if(n===0)return i.distSqr(e);const a=((i.x-e.x)*(r.x-e.x)+(i.y-e.y)*(r.y-e.y))/n;return i.distSqr(a<0?e:a>1?r:r.sub(e)._mult(a)._add(e))}function Gf(i,e){let r,n,a,c=!1;for(let h=0;h<i.length;h++){r=i[h];for(let p=0,_=r.length-1;p<r.length;_=p++)n=r[p],a=r[_],n.y>e.y!=a.y>e.y&&e.x<(a.x-n.x)*(e.y-n.y)/(a.y-n.y)+n.x&&(c=!c)}return c}function $a(i,e){let r=!1;for(let n=0,a=i.length-1;n<i.length;a=n++){const c=i[n],h=i[a];c.y>e.y!=h.y>e.y&&e.x<(h.x-c.x)*(e.y-c.y)/(h.y-c.y)+c.x&&(r=!r)}return r}function jf(i,e,r,n,a){for(const h of i)if(e<=h.x&&r<=h.y&&n>=h.x&&a>=h.y)return!0;const c=[new J(e,r),new J(e,a),new J(n,a),new J(n,r)];if(i.length>2){for(const h of c)if($a(i,h))return!0}for(let h=0;h<i.length-1;h++)if(o1(i[h],i[h+1],c))return!0;return!1}function o1(i,e,r){const n=r[0],a=r[2];if(i.x<n.x&&e.x<n.x||i.x>a.x&&e.x>a.x||i.y<n.y&&e.y<n.y||i.y>a.y&&e.y>a.y)return!1;const c=Ui(i,e,r[0]);return c!==Ui(i,e,r[1])||c!==Ui(i,e,r[2])||c!==Ui(i,e,r[3])}function Ja(i,e,r){const n=e.paint.get(i).value;return n.kind==="constant"?n.value:r.programConfigurations.get(e.id).getMaxValue(i)}function uh(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}function Zf(i,e,r,n,a){if(!e[0]&&!e[1])return i;const c=J.convert(e)._mult(a);r==="viewport"&&c._rotate(-n);const h=[];for(let p=0;p<i.length;p++)h.push(i[p].sub(c));return h}function qf(i,e,r,n){const a=J.convert(i)._mult(n);return e==="viewport"&&a._rotate(-r),a}tt(Ld,{omit:["layers"]});const s1=new k({"circle-sort-key":new v(xe.layout_circle["circle-sort-key"])});var a1={paint:new k({"circle-radius":new v(xe.paint_circle["circle-radius"]),"circle-color":new v(xe.paint_circle["circle-color"]),"circle-blur":new v(xe.paint_circle["circle-blur"]),"circle-opacity":new v(xe.paint_circle["circle-opacity"]),"circle-translate":new g(xe.paint_circle["circle-translate"]),"circle-translate-anchor":new g(xe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new g(xe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new g(xe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new v(xe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new v(xe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new v(xe.paint_circle["circle-stroke-opacity"])}),layout:s1},Od=1e-6,jr=typeof Float32Array!="undefined"?Float32Array:Array;function Wf(){var i=new jr(9);return jr!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[5]=0,i[6]=0,i[7]=0),i[0]=1,i[4]=1,i[8]=1,i}function Wn(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function Nd(i,e,r){var n=e[0],a=e[1],c=e[2],h=e[3],p=e[4],_=e[5],x=e[6],A=e[7],w=e[8],E=e[9],z=e[10],P=e[11],F=e[12],U=e[13],q=e[14],ie=e[15],oe=r[0],ae=r[1],le=r[2],ce=r[3];return i[0]=oe*n+ae*p+le*w+ce*F,i[1]=oe*a+ae*_+le*E+ce*U,i[2]=oe*c+ae*x+le*z+ce*q,i[3]=oe*h+ae*A+le*P+ce*ie,i[4]=(oe=r[4])*n+(ae=r[5])*p+(le=r[6])*w+(ce=r[7])*F,i[5]=oe*a+ae*_+le*E+ce*U,i[6]=oe*c+ae*x+le*z+ce*q,i[7]=oe*h+ae*A+le*P+ce*ie,i[8]=(oe=r[8])*n+(ae=r[9])*p+(le=r[10])*w+(ce=r[11])*F,i[9]=oe*a+ae*_+le*E+ce*U,i[10]=oe*c+ae*x+le*z+ce*q,i[11]=oe*h+ae*A+le*P+ce*ie,i[12]=(oe=r[12])*n+(ae=r[13])*p+(le=r[14])*w+(ce=r[15])*F,i[13]=oe*a+ae*_+le*E+ce*U,i[14]=oe*c+ae*x+le*z+ce*q,i[15]=oe*h+ae*A+le*P+ce*ie,i}function Ks(i,e,r){var n,a,c,h,p,_,x,A,w,E,z,P,F=r[0],U=r[1],q=r[2];return e===i?(i[12]=e[0]*F+e[4]*U+e[8]*q+e[12],i[13]=e[1]*F+e[5]*U+e[9]*q+e[13],i[14]=e[2]*F+e[6]*U+e[10]*q+e[14],i[15]=e[3]*F+e[7]*U+e[11]*q+e[15]):(a=e[1],c=e[2],h=e[3],p=e[4],_=e[5],x=e[6],A=e[7],w=e[8],E=e[9],z=e[10],P=e[11],i[0]=n=e[0],i[1]=a,i[2]=c,i[3]=h,i[4]=p,i[5]=_,i[6]=x,i[7]=A,i[8]=w,i[9]=E,i[10]=z,i[11]=P,i[12]=n*F+p*U+w*q+e[12],i[13]=a*F+_*U+E*q+e[13],i[14]=c*F+x*U+z*q+e[14],i[15]=h*F+A*U+P*q+e[15]),i}function es(i,e,r){var n=r[0],a=r[1],c=r[2];return i[0]=e[0]*n,i[1]=e[1]*n,i[2]=e[2]*n,i[3]=e[3]*n,i[4]=e[4]*a,i[5]=e[5]*a,i[6]=e[6]*a,i[7]=e[7]*a,i[8]=e[8]*c,i[9]=e[9]*c,i[10]=e[10]*c,i[11]=e[11]*c,i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15],i}function Ud(i,e,r){var n=Math.sin(r),a=Math.cos(r),c=e[4],h=e[5],p=e[6],_=e[7],x=e[8],A=e[9],w=e[10],E=e[11];return e!==i&&(i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[4]=c*a+x*n,i[5]=h*a+A*n,i[6]=p*a+w*n,i[7]=_*a+E*n,i[8]=x*a-c*n,i[9]=A*a-h*n,i[10]=w*a-p*n,i[11]=E*a-_*n,i}function Vd(i,e,r){var n=Math.sin(r),a=Math.cos(r),c=e[0],h=e[1],p=e[2],_=e[3],x=e[8],A=e[9],w=e[10],E=e[11];return e!==i&&(i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[0]=c*a-x*n,i[1]=h*a-A*n,i[2]=p*a-w*n,i[3]=_*a-E*n,i[8]=c*n+x*a,i[9]=h*n+A*a,i[10]=p*n+w*a,i[11]=_*n+E*a,i}Math.hypot||(Math.hypot=function(){for(var i=0,e=arguments.length;e--;)i+=arguments[e]*arguments[e];return Math.sqrt(i)});var l1=Nd;function Gd(){var i=new jr(3);return jr!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i}function Hf(i){var e=new jr(3);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e}function Yf(i){return Math.hypot(i[0],i[1],i[2])}function xc(i,e,r){var n=new jr(3);return n[0]=i,n[1]=e,n[2]=r,n}function Xf(i,e,r){return i[0]=e[0]+r[0],i[1]=e[1]+r[1],i[2]=e[2]+r[2],i}function Qf(i,e,r){return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],i}function Kf(i,e,r){return i[0]=e[0]*r[0],i[1]=e[1]*r[1],i[2]=e[2]*r[2],i}function jd(i,e,r){return i[0]=Math.min(e[0],r[0]),i[1]=Math.min(e[1],r[1]),i[2]=Math.min(e[2],r[2]),i}function Zd(i,e,r){return i[0]=Math.max(e[0],r[0]),i[1]=Math.max(e[1],r[1]),i[2]=Math.max(e[2],r[2]),i}function vc(i,e,r){return i[0]=e[0]*r,i[1]=e[1]*r,i[2]=e[2]*r,i}function qd(i,e,r,n){return i[0]=e[0]+r[0]*n,i[1]=e[1]+r[1]*n,i[2]=e[2]+r[2]*n,i}function Ac(i,e){var r=e[0],n=e[1],a=e[2],c=r*r+n*n+a*a;return c>0&&(c=1/Math.sqrt(c)),i[0]=e[0]*c,i[1]=e[1]*c,i[2]=e[2]*c,i}function bc(i,e){return i[0]*e[0]+i[1]*e[1]+i[2]*e[2]}function $f(i,e,r){var n=e[0],a=e[1],c=e[2],h=r[0],p=r[1],_=r[2];return i[0]=a*_-c*p,i[1]=c*h-n*_,i[2]=n*p-a*h,i}function $s(i,e,r){var n=e[0],a=e[1],c=e[2],h=r[3]*n+r[7]*a+r[11]*c+r[15];return i[0]=(r[0]*n+r[4]*a+r[8]*c+r[12])/(h=h||1),i[1]=(r[1]*n+r[5]*a+r[9]*c+r[13])/h,i[2]=(r[2]*n+r[6]*a+r[10]*c+r[14])/h,i}function Jf(i,e,r){var n=r[0],a=r[1],c=r[2],h=e[0],p=e[1],_=e[2],x=a*_-c*p,A=c*h-n*_,w=n*p-a*h,E=a*w-c*A,z=c*x-n*w,P=n*A-a*x,F=2*r[3];return A*=F,w*=F,z*=2,P*=2,i[0]=h+(x*=F)+(E*=2),i[1]=p+A+z,i[2]=_+w+P,i}var wc,el=Qf,c1=Kf,u1=Yf;function tl(i,e,r){var n=e[0],a=e[1],c=e[2],h=e[3];return i[0]=r[0]*n+r[4]*a+r[8]*c+r[12]*h,i[1]=r[1]*n+r[5]*a+r[9]*c+r[13]*h,i[2]=r[2]*n+r[6]*a+r[10]*c+r[14]*h,i[3]=r[3]*n+r[7]*a+r[11]*c+r[15]*h,i}function em(){var i=new jr(4);return jr!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i[3]=1,i}function tm(i){return i[0]=0,i[1]=0,i[2]=0,i[3]=1,i}function im(i,e,r){r*=.5;var n=e[0],a=e[1],c=e[2],h=e[3],p=Math.sin(r),_=Math.cos(r);return i[0]=n*_+h*p,i[1]=a*_+c*p,i[2]=c*_-a*p,i[3]=h*_-n*p,i}Gd(),wc=new jr(4),jr!=Float32Array&&(wc[0]=0,wc[1]=0,wc[2]=0,wc[3]=0),Gd(),xc(1,0,0),xc(0,1,0),em(),em(),Wf();class Wd{constructor(e,r){this.points=e,this.planes=r}static fromInvProjectionMatrix(e,r,n,a){const c=Math.pow(2,n),h=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(_=>{const x=tl([],_,e),A=1/x[3]/r*c;return function(w,E,z){return w[0]=E[0]*z[0],w[1]=E[1]*z[1],w[2]=E[2]*z[2],w[3]=E[3]*z[3],w}(x,x,[A,A,a?1/x[3]:A,A])}),p=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(_=>{const x=Ac([],$f([],el([],h[_[0]],h[_[1]]),el([],h[_[2]],h[_[1]]))),A=-bc(x,h[_[1]]);return x.concat(A)});return new Wd(h,p)}}class an{constructor(e,r){this.min=e,this.max=r,this.center=vc([],Xf([],this.min,this.max),.5)}quadrant(e){const r=[e%2==0,e<2],n=Hf(this.min),a=Hf(this.max);for(let c=0;c<r.length;c++)n[c]=r[c]?this.min[c]:this.center[c],a[c]=r[c]?this.center[c]:this.max[c];return a[2]=this.max[2],new an(n,a)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,r=this.max;return[[e[0],e[1],e[2]],[r[0],e[1],e[2]],[r[0],r[1],e[2]],[e[0],r[1],e[2]],[e[0],e[1],r[2]],[r[0],e[1],r[2]],[r[0],r[1],r[2]],[e[0],r[1],r[2]]]}intersects(e){const r=this.getCorners();let n=!0;for(let a=0;a<e.planes.length;a++){const c=e.planes[a];let h=0;for(let p=0;p<r.length;p++)h+=bc(c,r[p])+c[3]>=0;if(h===0)return 0;h!==r.length&&(n=!1)}if(n)return 2;for(let a=0;a<3;a++){let c=Number.MAX_VALUE,h=-Number.MAX_VALUE;for(let p=0;p<e.points.length;p++){const _=e.points[p][a]-this.min[a];c=Math.min(c,_),h=Math.max(h,_)}if(h<0||c>this.max[a]-this.min[a])return 0}return 1}}function rm(i,e,r,n,a,c,h,p,_){if(c&&i.queryGeometry.isAboveHorizon)return!1;c&&(_*=i.pixelToTileUnitsFactor);for(const x of e)for(const A of x){const w=A.add(p),E=a&&r.elevation?r.elevation.exaggeration()*a.getElevationAt(w.x,w.y,!0):0,z=c?w:h1(w,E,n),P=c?i.tilespaceRays.map(U=>p1(U,E)):i.queryGeometry.screenGeometry,F=tl([],[A.x,A.y,E,1],n);if(!h&&c?_*=F[3]/r.cameraToCenterDistance:h&&!c&&(_*=r.cameraToCenterDistance/F[3]),i1(P,z,_))return!0}return!1}function h1(i,e,r){const n=tl([],[i.x,i.y,e,1],r);return new J(n[0]/n[3],n[1]/n[3])}const nm=xc(0,0,0),d1=xc(0,0,1);function p1(i,e){const r=Gd();return nm[2]=e,i.intersectsPlane(nm,d1,r),new J(r[0],r[1])}class om extends Ld{}function sm(i,{width:e,height:r},n,a){if(a){if(a instanceof Uint8ClampedArray)a=new Uint8Array(a.buffer);else if(a.length!==e*r*n)throw new RangeError("mismatched image size")}else a=new Uint8Array(e*r*n);return i.width=e,i.height=r,i.data=a,i}function am(i,e,r){const{width:n,height:a}=e;n===i.width&&a===i.height||(Hd(i,e,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,n),height:Math.min(i.height,a)},r),i.width=n,i.height=a,i.data=e.data)}function Hd(i,e,r,n,a,c){if(a.width===0||a.height===0)return e;if(a.width>i.width||a.height>i.height||r.x>i.width-a.width||r.y>i.height-a.height)throw new RangeError("out of range source coordinates for image copy");if(a.width>e.width||a.height>e.height||n.x>e.width-a.width||n.y>e.height-a.height)throw new RangeError("out of range destination coordinates for image copy");const h=i.data,p=e.data;for(let _=0;_<a.height;_++){const x=((r.y+_)*i.width+r.x)*c,A=((n.y+_)*e.width+n.x)*c;for(let w=0;w<a.width*c;w++)p[A+w]=h[x+w]}return e}tt(om,{omit:["layers"]});class Eo{constructor(e,r){sm(this,e,1,r)}resize(e){am(this,new Eo(e),1)}clone(){return new Eo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,r,n,a,c){Hd(e,r,n,a,c,1)}}class Zr{constructor(e,r){sm(this,e,4,r)}resize(e){am(this,new Zr(e),4)}replace(e,r){r?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Zr({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,r,n,a,c){Hd(e,r,n,a,c,4)}}tt(Eo),tt(Zr);var f1={paint:new k({"heatmap-radius":new v(xe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new v(xe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new g(xe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new S(xe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new g(xe.paint_heatmap["heatmap-opacity"])})};function Yd(i){const e={},r=i.resolution||256,n=i.clips?i.clips.length:1,a=i.image||new Zr({width:r,height:n}),c=(h,p,_)=>{e[i.evaluationKey]=_;const x=i.expression.evaluate(e);a.data[h+p+0]=Math.floor(255*x.r/x.a),a.data[h+p+1]=Math.floor(255*x.g/x.a),a.data[h+p+2]=Math.floor(255*x.b/x.a),a.data[h+p+3]=Math.floor(255*x.a)};if(i.clips)for(let h=0,p=0;h<n;++h,p+=4*r)for(let _=0,x=0;_<r;_++,x+=4){const A=_/(r-1),{start:w,end:E}=i.clips[h];c(p,x,w*(1-A)+E*A)}else for(let h=0,p=0;h<r;h++,p+=4)c(0,p,h/(r-1));return a}var m1={paint:new k({"hillshade-illumination-direction":new g(xe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new g(xe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new g(xe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new g(xe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new g(xe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new g(xe.paint_hillshade["hillshade-accent-color"])})};const _1=Q([{name:"a_pos",components:2,type:"Int16"}],4),{members:g1}=_1;var hh=dh,y1=dh;function dh(i,e,r){r=r||2;var n,a,c,h,p,_,x,A=e&&e.length,w=A?e[0]*r:i.length,E=lm(i,0,w,r,!0),z=[];if(!E||E.next===E.prev)return z;if(A&&(E=function(F,U,q,ie){var oe,ae,le,ce=[];for(oe=0,ae=U.length;oe<ae;oe++)(le=lm(F,U[oe]*ie,oe<ae-1?U[oe+1]*ie:F.length,ie,!1))===le.next&&(le.steiner=!0),ce.push(C1(le));for(ce.sort(w1),oe=0;oe<ce.length;oe++)q=ts(q=T1(ce[oe],q),q.next);return q}(i,e,E,r)),i.length>80*r){n=c=i[0],a=h=i[1];for(var P=r;P<w;P+=r)(p=i[P])<n&&(n=p),(_=i[P+1])<a&&(a=_),p>c&&(c=p),_>h&&(h=_);x=(x=Math.max(c-n,h-a))!==0?1/x:0}return Tc(E,z,r,n,a,x),z}function lm(i,e,r,n,a){var c,h;if(a===Kd(i,e,r,n)>0)for(c=e;c<r;c+=n)h=hm(c,i[c],i[c+1],h);else for(c=r-n;c>=e;c-=n)h=hm(c,i[c],i[c+1],h);return h&&ph(h,h.next)&&(Cc(h),h=h.next),h}function ts(i,e){if(!i)return i;e||(e=i);var r,n=i;do if(r=!1,n.steiner||!ph(n,n.next)&&Oi(n.prev,n,n.next)!==0)n=n.next;else{if(Cc(n),(n=e=n.prev)===n.next)break;r=!0}while(r||n!==e);return e}function Tc(i,e,r,n,a,c,h){if(i){!h&&c&&function(A,w,E,z){var P=A;do P.z===null&&(P.z=Xd(P.x,P.y,w,E,z)),P.prevZ=P.prev,P.nextZ=P.next,P=P.next;while(P!==A);P.prevZ.nextZ=null,P.prevZ=null,function(F){var U,q,ie,oe,ae,le,ce,we,Me=1;do{for(q=F,F=null,ae=null,le=0;q;){for(le++,ie=q,ce=0,U=0;U<Me&&(ce++,ie=ie.nextZ);U++);for(we=Me;ce>0||we>0&&ie;)ce!==0&&(we===0||!ie||q.z<=ie.z)?(oe=q,q=q.nextZ,ce--):(oe=ie,ie=ie.nextZ,we--),ae?ae.nextZ=oe:F=oe,oe.prevZ=ae,ae=oe;q=ie}ae.nextZ=null,Me*=2}while(le>1)}(P)}(i,n,a,c);for(var p,_,x=i;i.prev!==i.next;)if(p=i.prev,_=i.next,c?v1(i,n,a,c):x1(i))e.push(p.i/r),e.push(i.i/r),e.push(_.i/r),Cc(i),i=_.next,x=_.next;else if((i=_)===x){h?h===1?Tc(i=A1(ts(i),e,r),e,r,n,a,c,2):h===2&&b1(i,e,r,n,a,c):Tc(ts(i),e,r,n,a,c,1);break}}}function x1(i){var e=i.prev,r=i,n=i.next;if(Oi(e,r,n)>=0)return!1;for(var a=i.next.next;a!==i.prev;){if(il(e.x,e.y,r.x,r.y,n.x,n.y,a.x,a.y)&&Oi(a.prev,a,a.next)>=0)return!1;a=a.next}return!0}function v1(i,e,r,n){var a=i.prev,c=i,h=i.next;if(Oi(a,c,h)>=0)return!1;for(var p=a.x>c.x?a.x>h.x?a.x:h.x:c.x>h.x?c.x:h.x,_=a.y>c.y?a.y>h.y?a.y:h.y:c.y>h.y?c.y:h.y,x=Xd(a.x<c.x?a.x<h.x?a.x:h.x:c.x<h.x?c.x:h.x,a.y<c.y?a.y<h.y?a.y:h.y:c.y<h.y?c.y:h.y,e,r,n),A=Xd(p,_,e,r,n),w=i.prevZ,E=i.nextZ;w&&w.z>=x&&E&&E.z<=A;){if(w!==i.prev&&w!==i.next&&il(a.x,a.y,c.x,c.y,h.x,h.y,w.x,w.y)&&Oi(w.prev,w,w.next)>=0||(w=w.prevZ,E!==i.prev&&E!==i.next&&il(a.x,a.y,c.x,c.y,h.x,h.y,E.x,E.y)&&Oi(E.prev,E,E.next)>=0))return!1;E=E.nextZ}for(;w&&w.z>=x;){if(w!==i.prev&&w!==i.next&&il(a.x,a.y,c.x,c.y,h.x,h.y,w.x,w.y)&&Oi(w.prev,w,w.next)>=0)return!1;w=w.prevZ}for(;E&&E.z<=A;){if(E!==i.prev&&E!==i.next&&il(a.x,a.y,c.x,c.y,h.x,h.y,E.x,E.y)&&Oi(E.prev,E,E.next)>=0)return!1;E=E.nextZ}return!0}function A1(i,e,r){var n=i;do{var a=n.prev,c=n.next.next;!ph(a,c)&&cm(a,n,n.next,c)&&Ec(a,c)&&Ec(c,a)&&(e.push(a.i/r),e.push(n.i/r),e.push(c.i/r),Cc(n),Cc(n.next),n=i=c),n=n.next}while(n!==i);return ts(n)}function b1(i,e,r,n,a,c){var h=i;do{for(var p=h.next.next;p!==h.prev;){if(h.i!==p.i&&M1(h,p)){var _=um(h,p);return h=ts(h,h.next),_=ts(_,_.next),Tc(h,e,r,n,a,c),void Tc(_,e,r,n,a,c)}p=p.next}h=h.next}while(h!==i)}function w1(i,e){return i.x-e.x}function T1(i,e){var r=function(c,h){var p,_=h,x=c.x,A=c.y,w=-1/0;do{if(A<=_.y&&A>=_.next.y&&_.next.y!==_.y){var E=_.x+(A-_.y)*(_.next.x-_.x)/(_.next.y-_.y);if(E<=x&&E>w){if(w=E,E===x){if(A===_.y)return _;if(A===_.next.y)return _.next}p=_.x<_.next.x?_:_.next}}_=_.next}while(_!==h);if(!p)return null;if(x===w)return p;var z,P=p,F=p.x,U=p.y,q=1/0;_=p;do x>=_.x&&_.x>=F&&x!==_.x&&il(A<U?x:w,A,F,U,A<U?w:x,A,_.x,_.y)&&(z=Math.abs(A-_.y)/(x-_.x),Ec(_,c)&&(z<q||z===q&&(_.x>p.x||_.x===p.x&&E1(p,_)))&&(p=_,q=z)),_=_.next;while(_!==P);return p}(i,e);if(!r)return e;var n=um(r,i),a=ts(r,r.next);return ts(n,n.next),e===r?a:e}function E1(i,e){return Oi(i.prev,i,e.prev)<0&&Oi(e.next,i,i.next)<0}function Xd(i,e,r,n,a){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=32767*(i-r)*a)|i<<8))|i<<4))|i<<2))|i<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*a)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function C1(i){var e=i,r=i;do(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next;while(e!==i);return r}function il(i,e,r,n,a,c,h,p){return(a-h)*(e-p)-(i-h)*(c-p)>=0&&(i-h)*(n-p)-(r-h)*(e-p)>=0&&(r-h)*(c-p)-(a-h)*(n-p)>=0}function M1(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!function(r,n){var a=r;do{if(a.i!==r.i&&a.next.i!==r.i&&a.i!==n.i&&a.next.i!==n.i&&cm(a,a.next,r,n))return!0;a=a.next}while(a!==r);return!1}(i,e)&&(Ec(i,e)&&Ec(e,i)&&function(r,n){var a=r,c=!1,h=(r.x+n.x)/2,p=(r.y+n.y)/2;do a.y>p!=a.next.y>p&&a.next.y!==a.y&&h<(a.next.x-a.x)*(p-a.y)/(a.next.y-a.y)+a.x&&(c=!c),a=a.next;while(a!==r);return c}(i,e)&&(Oi(i.prev,i,e.prev)||Oi(i,e.prev,e))||ph(i,e)&&Oi(i.prev,i,i.next)>0&&Oi(e.prev,e,e.next)>0)}function Oi(i,e,r){return(e.y-i.y)*(r.x-e.x)-(e.x-i.x)*(r.y-e.y)}function ph(i,e){return i.x===e.x&&i.y===e.y}function cm(i,e,r,n){var a=mh(Oi(i,e,r)),c=mh(Oi(i,e,n)),h=mh(Oi(r,n,i)),p=mh(Oi(r,n,e));return a!==c&&h!==p||!(a!==0||!fh(i,r,e))||!(c!==0||!fh(i,n,e))||!(h!==0||!fh(r,i,n))||!(p!==0||!fh(r,e,n))}function fh(i,e,r){return e.x<=Math.max(i.x,r.x)&&e.x>=Math.min(i.x,r.x)&&e.y<=Math.max(i.y,r.y)&&e.y>=Math.min(i.y,r.y)}function mh(i){return i>0?1:i<0?-1:0}function Ec(i,e){return Oi(i.prev,i,i.next)<0?Oi(i,e,i.next)>=0&&Oi(i,i.prev,e)>=0:Oi(i,e,i.prev)<0||Oi(i,i.next,e)<0}function um(i,e){var r=new Qd(i.i,i.x,i.y),n=new Qd(e.i,e.x,e.y),a=i.next,c=e.prev;return i.next=e,e.prev=i,r.next=a,a.prev=r,n.next=r,r.prev=n,c.next=n,n.prev=c,n}function hm(i,e,r,n){var a=new Qd(i,e,r);return n?(a.next=n.next,a.prev=n,n.next.prev=a,n.next=a):(a.prev=a,a.next=a),a}function Cc(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function Qd(i,e,r){this.i=i,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Kd(i,e,r,n){for(var a=0,c=e,h=r-n;c<r;c+=n)a+=(i[h]-i[c])*(i[c+1]+i[h+1]),h=c;return a}function S1(i,e,r,n,a){dm(i,e,r||0,n||i.length-1,a||I1)}function dm(i,e,r,n,a){for(;n>r;){if(n-r>600){var c=n-r+1,h=e-r+1,p=Math.log(c),_=.5*Math.exp(2*p/3),x=.5*Math.sqrt(p*_*(c-_)/c)*(h-c/2<0?-1:1);dm(i,e,Math.max(r,Math.floor(e-h*_/c+x)),Math.min(n,Math.floor(e+(c-h)*_/c+x)),a)}var A=i[e],w=r,E=n;for(Mc(i,r,e),a(i[n],A)>0&&Mc(i,r,n);w<E;){for(Mc(i,w,E),w++,E--;a(i[w],A)<0;)w++;for(;a(i[E],A)>0;)E--}a(i[r],A)===0?Mc(i,r,E):Mc(i,++E,n),E<=e&&(r=E+1),e<=E&&(n=E-1)}}function Mc(i,e,r){var n=i[e];i[e]=i[r],i[r]=n}function I1(i,e){return i<e?-1:i>e?1:0}function $d(i,e){const r=i.length;if(r<=1)return[i];const n=[];let a,c;for(let h=0;h<r;h++){const p=Be(i[h]);p!==0&&(i[h].area=Math.abs(p),c===void 0&&(c=p<0),c===p<0?(a&&n.push(a),a=[i[h]]):a.push(i[h]))}if(a&&n.push(a),e>1)for(let h=0;h<n.length;h++)n[h].length<=e||(S1(n[h],e,1,n[h].length-1,z1),n[h]=n[h].slice(0,e));return n}function z1(i,e){return e.area-i.area}function Jd(i,e,r){const n=r.patternDependencies;let a=!1;for(const c of e){const h=c.paint.get(`${i}-pattern`);h.isConstant()||(a=!0);const p=h.constantOr(null);p&&(a=!0,n[p.to]=!0,n[p.from]=!0)}return a}function ep(i,e,r,n,a){const c=a.patternDependencies;for(const h of e){const p=h.paint.get(`${i}-pattern`).value;if(p.kind!=="constant"){let _=p.evaluate({zoom:n-1},r,{},a.availableImages),x=p.evaluate({zoom:n},r,{},a.availableImages),A=p.evaluate({zoom:n+1},r,{},a.availableImages);_=_&&_.name?_.name:_,x=x&&x.name?x.name:x,A=A&&A.name?A.name:A,c[_]=!0,c[x]=!0,c[A]=!0,r.patterns[h.id]={min:_,mid:x,max:A}}}return r}dh.deviation=function(i,e,r,n){var a=e&&e.length,c=Math.abs(Kd(i,0,a?e[0]*r:i.length,r));if(a)for(var h=0,p=e.length;h<p;h++)c-=Math.abs(Kd(i,e[h]*r,h<p-1?e[h+1]*r:i.length,r));var _=0;for(h=0;h<n.length;h+=3){var x=n[h]*r,A=n[h+1]*r,w=n[h+2]*r;_+=Math.abs((i[x]-i[w])*(i[A+1]-i[x+1])-(i[x]-i[A])*(i[w+1]-i[x+1]))}return c===0&&_===0?0:Math.abs((_-c)/c)},dh.flatten=function(i){for(var e=i[0][0].length,r={vertices:[],holes:[],dimensions:e},n=0,a=0;a<i.length;a++){for(var c=0;c<i[a].length;c++)for(var h=0;h<e;h++)r.vertices.push(i[a][c][h]);a>0&&r.holes.push(n+=i[a-1].length)}return r},hh.default=y1;class _h{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Y,this.indexArray=new be,this.indexArray2=new ct,this.programConfigurations=new Xs(e.layers,e.zoom),this.segments=new ki,this.segments2=new ki,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id),this.projection=e.projection}populate(e,r,n,a){this.hasPattern=Jd("fill",this.layers,r);const c=this.layers[0].layout.get("fill-sort-key"),h=[];for(const{feature:p,id:_,index:x,sourceLayerIndex:A}of e){const w=this.layers[0]._featureFilter.needGeometry,E=Qs(p,w);if(!this.layers[0]._featureFilter.filter(new gi(this.zoom),E,n))continue;const z=c?c.evaluate(E,{},n,r.availableImages):void 0,P={id:_,properties:p.properties,type:p.type,sourceLayerIndex:A,index:x,geometry:w?E.geometry:To(p,n,a),patterns:{},sortKey:z};h.push(P)}c&&h.sort((p,_)=>p.sortKey-_.sortKey);for(const p of h){const{geometry:_,index:x,sourceLayerIndex:A}=p;if(this.hasPattern){const w=ep("fill",this.layers,p,this.zoom,r);this.patternFeatures.push(w)}else this.addFeature(p,_,x,n,{},r.availableImages);r.featureIndex.insert(e[x].feature,_,x,A,this.index)}}update(e,r,n,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,n,a)}addFeatures(e,r,n,a,c){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,r,n,a)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,g1),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,r,n,a,c,h=[]){for(const p of $d(r,500)){let _=0;for(const P of p)_+=P.length;const x=this.segments.prepareSegment(_,this.layoutVertexArray,this.indexArray),A=x.vertexLength,w=[],E=[];for(const P of p){if(P.length===0)continue;P!==p[0]&&E.push(w.length/2);const F=this.segments2.prepareSegment(P.length,this.layoutVertexArray,this.indexArray2),U=F.vertexLength;this.layoutVertexArray.emplaceBack(P[0].x,P[0].y),this.indexArray2.emplaceBack(U+P.length-1,U),w.push(P[0].x),w.push(P[0].y);for(let q=1;q<P.length;q++)this.layoutVertexArray.emplaceBack(P[q].x,P[q].y),this.indexArray2.emplaceBack(U+q-1,U+q),w.push(P[q].x),w.push(P[q].y);F.vertexLength+=P.length,F.primitiveLength+=P.length}const z=hh(w,E);for(let P=0;P<z.length;P+=3)this.indexArray.emplaceBack(A+z[P],A+z[P+1],A+z[P+2]);x.vertexLength+=_,x.primitiveLength+=z.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,c,h,a)}}tt(_h,{omit:["layers","patternFeatures"]});const D1=new k({"fill-sort-key":new v(xe.layout_fill["fill-sort-key"])});var k1={paint:new k({"fill-antialias":new g(xe.paint_fill["fill-antialias"]),"fill-opacity":new v(xe.paint_fill["fill-opacity"]),"fill-color":new v(xe.paint_fill["fill-color"]),"fill-outline-color":new v(xe.paint_fill["fill-outline-color"]),"fill-translate":new g(xe.paint_fill["fill-translate"]),"fill-translate-anchor":new g(xe.paint_fill["fill-translate-anchor"]),"fill-pattern":new T(xe.paint_fill["fill-pattern"])}),layout:D1};const P1=Q([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),B1=Q([{name:"a_centroid_pos",components:2,type:"Uint16"}]),L1=Q([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:R1}=P1;var pm=rl;function rl(i,e,r,n,a){this.properties={},this.extent=r,this.type=0,this._pbf=i,this._geometry=-1,this._keys=n,this._values=a,i.readFields(F1,this,e)}function F1(i,e,r){i==1?e.id=r.readVarint():i==2?function(n,a){for(var c=n.readVarint()+n.pos;n.pos<c;){var h=a._keys[n.readVarint()],p=a._values[n.readVarint()];a.properties[h]=p}}(r,e):i==3?e.type=r.readVarint():i==4&&(e._geometry=r.pos)}function O1(i){for(var e,r,n=0,a=0,c=i.length,h=c-1;a<c;h=a++)n+=((r=i[h]).x-(e=i[a]).x)*(e.y+r.y);return n}rl.types=["Unknown","Point","LineString","Polygon"],rl.prototype.loadGeometry=function(){var i=this._pbf;i.pos=this._geometry;for(var e,r=i.readVarint()+i.pos,n=1,a=0,c=0,h=0,p=[];i.pos<r;){if(a<=0){var _=i.readVarint();n=7&_,a=_>>3}if(a--,n===1||n===2)c+=i.readSVarint(),h+=i.readSVarint(),n===1&&(e&&p.push(e),e=[]),e.push(new J(c,h));else{if(n!==7)throw new Error("unknown command "+n);e&&e.push(e[0].clone())}}return e&&p.push(e),p},rl.prototype.bbox=function(){var i=this._pbf;i.pos=this._geometry;for(var e=i.readVarint()+i.pos,r=1,n=0,a=0,c=0,h=1/0,p=-1/0,_=1/0,x=-1/0;i.pos<e;){if(n<=0){var A=i.readVarint();r=7&A,n=A>>3}if(n--,r===1||r===2)(a+=i.readSVarint())<h&&(h=a),a>p&&(p=a),(c+=i.readSVarint())<_&&(_=c),c>x&&(x=c);else if(r!==7)throw new Error("unknown command "+r)}return[h,_,p,x]},rl.prototype.toGeoJSON=function(i,e,r){var n,a,c=this.extent*Math.pow(2,r),h=this.extent*i,p=this.extent*e,_=this.loadGeometry(),x=rl.types[this.type];function A(z){for(var P=0;P<z.length;P++){var F=z[P];z[P]=[360*(F.x+h)/c-180,360/Math.PI*Math.atan(Math.exp((180-360*(F.y+p)/c)*Math.PI/180))-90]}}switch(this.type){case 1:var w=[];for(n=0;n<_.length;n++)w[n]=_[n][0];A(_=w);break;case 2:for(n=0;n<_.length;n++)A(_[n]);break;case 3:for(_=function(z){var P=z.length;if(P<=1)return[z];for(var F,U,q=[],ie=0;ie<P;ie++){var oe=O1(z[ie]);oe!==0&&(U===void 0&&(U=oe<0),U===oe<0?(F&&q.push(F),F=[z[ie]]):F.push(z[ie]))}return F&&q.push(F),q}(_),n=0;n<_.length;n++)for(a=0;a<_[n].length;a++)A(_[n][a])}_.length===1?_=_[0]:x="Multi"+x;var E={type:"Feature",geometry:{type:x,coordinates:_},properties:this.properties};return"id"in this&&(E.id=this.id),E};var fm=mm;function mm(i,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(N1,this,e),this.length=this._features.length}function N1(i,e,r){i===15?e.version=r.readVarint():i===1?e.name=r.readString():i===5?e.extent=r.readVarint():i===2?e._features.push(r.pos):i===3?e._keys.push(r.readString()):i===4&&e._values.push(function(n){for(var a=null,c=n.readVarint()+n.pos;n.pos<c;){var h=n.readVarint()>>3;a=h===1?n.readString():h===2?n.readFloat():h===3?n.readDouble():h===4?n.readVarint64():h===5?n.readVarint():h===6?n.readSVarint():h===7?n.readBoolean():null}return a}(r))}function U1(i,e,r){if(i===3){var n=new fm(r,r.readVarint()+r.pos);n.length&&(e[n.name]=n)}}mm.prototype.feature=function(i){if(i<0||i>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[i];var e=this._pbf.readVarint()+this._pbf.pos;return new pm(this._pbf,e,this.extent,this._keys,this._values)};var Js={VectorTile:function(i,e){this.layers=i.readFields(U1,{},e)},VectorTileFeature:pm,VectorTileLayer:fm};function gh(i,e,r,n){const a=[],c=n===0?(h,p,_,x,A,w)=>{h.push(new J(w,_+(w-p)/(x-p)*(A-_)))}:(h,p,_,x,A,w)=>{h.push(new J(p+(w-_)/(A-_)*(x-p),w))};for(const h of i){const p=[];for(const _ of h){if(_.length<=2)continue;const x=[];for(let E=0;E<_.length-1;E++){const z=_[E].x,P=_[E].y,F=_[E+1].x,U=_[E+1].y,q=n===0?z:P,ie=n===0?F:U;q<e?ie>e&&c(x,z,P,F,U,e):q>r?ie<r&&c(x,z,P,F,U,r):x.push(_[E]),ie<e&&q>=e&&c(x,z,P,F,U,e),ie>r&&q<=r&&c(x,z,P,F,U,r)}let A=_[_.length-1];const w=n===0?A.x:A.y;w>=e&&w<=r&&x.push(A),x.length&&(A=x[x.length-1],x[0].x===A.x&&x[0].y===A.y||x.push(x[0]),p.push(x))}p.length&&a.push(p)}return a}const V1=Js.VectorTileFeature.types,G1=Math.pow(2,13);function Sc(i,e,r,n,a,c,h,p){i.emplaceBack((e<<1)+h,(r<<1)+c,(Math.floor(n*G1)<<1)+a,Math.round(p))}function Ic(i,e,r){i.emplaceBack(e.x,e.y,e.z,r[0]*16384,r[1]*16384,r[2]*16384)}class _m{constructor(){this.acc=new J(0,0),this.polyCount=[]}startRing(e){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new J(e.x,e.y),this.max=new J(e.x,e.y))}append(e,r){this.currentPolyCount.edges++,this.acc._add(e);const n=this.min,a=this.max;e.x<n.x?n.x=e.x:e.x>a.x&&(a.x=e.x),e.y<n.y?n.y=e.y:e.y>a.y&&(a.y=e.y),((e.x===0||e.x===zt)&&e.x===r.x)!=((e.y===0||e.y===zt)&&e.y===r.y)&&this.processBorderOverlap(e,r),r.x<0!=e.x<0&&this.addBorderIntersection(0,yt(r.y,e.y,(0-r.x)/(e.x-r.x))),r.x>zt!=e.x>zt&&this.addBorderIntersection(1,yt(r.y,e.y,(zt-r.x)/(e.x-r.x))),r.y<0!=e.y<0&&this.addBorderIntersection(2,yt(r.x,e.x,(0-r.y)/(e.y-r.y))),r.y>zt!=e.y>zt&&this.addBorderIntersection(3,yt(r.x,e.x,(zt-r.y)/(e.y-r.y)))}addBorderIntersection(e,r){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const n=this.borders[e];r<n[0]&&(n[0]=r),r>n[1]&&(n[1]=r)}processBorderOverlap(e,r){if(e.x===r.x){if(e.y===r.y)return;const n=e.x===0?0:1;this.addBorderIntersection(n,r.y),this.addBorderIntersection(n,e.y)}else{const n=e.y===0?2:3;this.addBorderIntersection(n,r.x),this.addBorderIntersection(n,e.x)}}centroid(){const e=this.polyCount.reduce((r,n)=>r+n.edges,0);return e!==0?this.acc.div(e)._round():new J(0,0)}span(){return new J(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((e,r)=>e+ +(r[0]!==Number.MAX_VALUE),0)}}class zc{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new ee,this.centroidVertexArray=new Ys,this.indexArray=new be,this.programConfigurations=new Xs(e.layers,e.zoom),this.segments=new ki,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id),this.enableTerrain=e.enableTerrain}populate(e,r,n,a){this.features=[],this.hasPattern=Jd("fill-extrusion",this.layers,r),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(c){const h=Math.exp(Math.PI*(1-c.y/(1<<c.z)*2));return 80150034*h/(h*h+1)/zt/(1<<c.z)}(n);for(const{feature:c,id:h,index:p,sourceLayerIndex:_}of e){const x=this.layers[0]._featureFilter.needGeometry,A=Qs(c,x);if(!this.layers[0]._featureFilter.filter(new gi(this.zoom),A,n))continue;const w={id:h,sourceLayerIndex:_,index:p,geometry:x?A.geometry:To(c,n,a),properties:c.properties,type:c.type,patterns:{}},E=this.layoutVertexArray.length;this.hasPattern?this.features.push(ep("fill-extrusion",this.layers,w,this.zoom,r)):this.addFeature(w,w.geometry,p,n,{},r.availableImages,a),r.featureIndex.insert(c,w.geometry,p,_,this.index,E)}this.sortBorders()}addFeatures(e,r,n,a,c){for(const h of this.features){const{geometry:p}=h;this.addFeature(h,p,h.index,r,n,a,c)}this.sortBorders()}update(e,r,n,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,n,a)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,R1),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,L1.members,!0))),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,B1.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,r,n,a,c,h,p){const _=[new J(0,0),new J(zt,zt)],x=p.projection,A=x.name==="globe",w=this.enableTerrain&&!A?new _m:null;A&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new zr);const E=$d(r,500);for(let F=E.length-1;F>=0;F--){const U=E[F];(U.length===0||(z=U[0]).every(q=>q.x<=0)||z.every(q=>q.x>=zt)||z.every(q=>q.y<=0)||z.every(q=>q.y>=zt))&&E.splice(F,1)}var z;let P;if(A){const U=1<<a.z,q=mn(a.x/U),ie=mn((a.x+1)/U),oe=sr(a.y/U),ae=sr((a.y+1)/U);P=function(le,ce,we,Me,De=0,Pe){const ve=[];if(!le.length||!we||!Me)return ve;const Ie=(St,Bt)=>{for(const lt of St)ve.push({polygon:lt,bounds:Bt})},Re=Math.ceil(Math.log2(we)),Ze=Math.ceil(Math.log2(Me)),Ne=Re-Ze,je=[];for(let St=0;St<Math.abs(Ne);St++)je.push(Ne>0?0:1);for(let St=0;St<Math.min(Re,Ze);St++)je.push(0),je.push(1);let Mt=le;if(Mt=gh(Mt,ce[0].y-De,ce[1].y+De,1),Mt=gh(Mt,ce[0].x-De,ce[1].x+De,0),!Mt.length)return ve;const Ft=[];for(je.length?Ft.push({polygons:Mt,bounds:ce,depth:0}):Ie(Mt,ce);Ft.length;){const St=Ft.pop(),Bt=St.depth,lt=je[Bt],et=St.bounds[0],Vt=St.bounds[1],ri=lt===0?et.x:et.y,Gi=lt===0?Vt.x:Vt.y,yi=Pe?Pe(lt,ri,Gi):.5*(ri+Gi),ji=gh(St.polygons,ri-De,yi+De,lt),ni=gh(St.polygons,yi-De,Gi+De,lt);if(ji.length){const jt=[et,new J(lt===0?yi:Vt.x,lt===1?yi:Vt.y)];je.length>Bt+1?Ft.push({polygons:ji,bounds:jt,depth:Bt+1}):Ie(ji,jt)}if(ni.length){const jt=[new J(lt===0?yi:et.x,lt===1?yi:et.y),Vt];je.length>Bt+1?Ft.push({polygons:ni,bounds:jt,depth:Bt+1}):Ie(ni,jt)}}return ve}(E,_,Math.ceil((ie-q)/11.25),Math.ceil((oe-ae)/11.25),1,(le,ce,we)=>{if(le===0)return .5*(ce+we);{const Me=sr((a.y+ce/zt)/U);return(Qa(.5*(sr((a.y+we/zt)/U)+Me))*U-a.y)*zt}})}else{P=[];for(const F of E)P.push({polygon:F,bounds:_})}for(const F of P){const U=F.polygon;let q=0,ie=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(let we=0;we<U.length;we++){const Me=U[we];if(Me.length===0)continue;q+=Me.length;let De=0;w&&w.startRing(Me[0]);for(let Pe=0;Pe<Me.length;Pe++){const ve=Me[Pe];if(Pe>=1){const Ie=Me[Pe-1];if(!j1(ve,Ie,F.bounds)){w&&w.append(ve,Ie),ie.vertexLength+4>ki.MAX_VERTEX_ARRAY_LENGTH&&(ie=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Re=ve.sub(Ie)._perp(),Ze=Re.x/(Math.abs(Re.x)+Math.abs(Re.y)),Ne=Re.y>0?1:0,je=Ie.dist(ve);De+je>32768&&(De=0),Sc(this.layoutVertexArray,ve.x,ve.y,Ze,Ne,0,0,De),Sc(this.layoutVertexArray,ve.x,ve.y,Ze,Ne,0,1,De),De+=je,Sc(this.layoutVertexArray,Ie.x,Ie.y,Ze,Ne,0,0,De),Sc(this.layoutVertexArray,Ie.x,Ie.y,Ze,Ne,0,1,De);const Mt=ie.vertexLength;if(this.indexArray.emplaceBack(Mt,Mt+2,Mt+1),this.indexArray.emplaceBack(Mt+1,Mt+2,Mt+3),ie.vertexLength+=4,ie.primitiveLength+=2,A){const Ft=this.layoutVertexExtArray,St=x.projectTilePoint(ve.x,ve.y,a),Bt=x.projectTilePoint(Ie.x,Ie.y,a),lt=x.upVector(a,ve.x,ve.y),et=x.upVector(a,Ie.x,Ie.y);Ic(Ft,St,lt),Ic(Ft,St,lt),Ic(Ft,Bt,et),Ic(Ft,Bt,et)}}}}}if(ie.vertexLength+q>ki.MAX_VERTEX_ARRAY_LENGTH&&(ie=this.segments.prepareSegment(q,this.layoutVertexArray,this.indexArray)),V1[e.type]!=="Polygon")continue;const oe=[],ae=[],le=ie.vertexLength;for(let we=0;we<U.length;we++){const Me=U[we];if(Me.length!==0){Me!==U[0]&&ae.push(oe.length/2);for(let De=0;De<Me.length;De++){const Pe=Me[De];Sc(this.layoutVertexArray,Pe.x,Pe.y,0,0,1,1,0),oe.push(Pe.x),oe.push(Pe.y),w&&w.currentPolyCount.top++,A&&Ic(this.layoutVertexExtArray,x.projectTilePoint(Pe.x,Pe.y,a),x.upVector(a,Pe.x,Pe.y))}}}const ce=hh(oe,ae);for(let we=0;we<ce.length;we+=3)this.indexArray.emplaceBack(le+ce[we],le+ce[we+2],le+ce[we+1]);ie.primitiveLength+=ce.length/3,ie.vertexLength+=q}if(w&&w.polyCount.length>0){if(w.borders){w.vertexArrayOffset=this.centroidVertexArray.length;const F=w.borders,U=this.featuresOnBorder.push(w)-1;for(let q=0;q<4;q++)F[q][0]!==Number.MAX_VALUE&&this.borders[q].push(U)}this.encodeCentroid(w.borders?void 0:w.centroid(),w)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,c,h,a)}sortBorders(){for(let e=0;e<4;e++)this.borders[e].sort((r,n)=>this.featuresOnBorder[r].borders[e][0]-this.featuresOnBorder[n].borders[e][0])}encodeCentroid(e,r,n=!0){let a,c;if(e)if(e.y!==0){const p=r.span()._mult(this.tileToMeter);a=(Math.max(e.x,1)<<3)+Math.min(7,Math.round(p.x/10)),c=(Math.max(e.y,1)<<3)+Math.min(7,Math.round(p.y/10))}else a=Math.ceil(7*(e.x+450)),c=0;else a=0,c=+n;let h=n?this.centroidVertexArray.length:r.vertexArrayOffset;for(const p of r.polyCount){n&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*p.edges+p.top);for(let _=0;_<2*p.edges;_++)this.centroidVertexArray.emplace(h++,0,c),this.centroidVertexArray.emplace(h++,a,c);for(let _=0;_<p.top;_++)this.centroidVertexArray.emplace(h++,a,c)}}}function j1(i,e,r){return i.x===e.x&&(i.x<r[0].x||i.x>r[1].x)||i.y===e.y&&(i.y<r[0].y||i.y>r[1].y)}tt(zc,{omit:["layers","features"]}),tt(_m);var Z1={paint:new k({"fill-extrusion-opacity":new g(xe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new v(xe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new g(xe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new g(xe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new T(xe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new v(xe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new v(xe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new g(xe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function Dc(i,e){return i.x*e.x+i.y*e.y}function gm(i,e){if(i.length===1){let r=0;const n=e[r++];let a;for(;!a||n.equals(a);)if(a=e[r++],!a)return 1/0;for(;r<e.length;r++){const c=e[r],h=i[0],p=a.sub(n),_=c.sub(n),x=h.sub(n),A=Dc(p,p),w=Dc(p,_),E=Dc(_,_),z=Dc(x,p),P=Dc(x,_),F=A*E-w*w,U=(E*z-w*P)/F,q=(A*P-w*z)/F,ie=n.z*(1-U-q)+a.z*U+c.z*q;if(isFinite(ie))return ie}return 1/0}{let r=1/0;for(const n of e)r=Math.min(r,n.z);return r}}function ym(i){const e=new J(i[0],i[1]);return e.z=i[2],e}function q1(i,e,r,n,a,c,h,p){const _=h*a.getElevationAt(i,e,!0,!0),x=c[0]!==0,A=x?c[1]===0?h*(c[0]/7-450):h*function(w,E,z){const P=Math.floor(E[0]/8),F=Math.floor(E[1]/8),U=10*(E[0]-8*P),q=10*(E[1]-8*F),ie=w.getElevationAt(P,F,!0,!0),oe=w.getMeterToDEM(z),ae=Math.floor(.5*(U*oe-1)),le=Math.floor(.5*(q*oe-1)),ce=w.tileCoordToPixel(P,F),we=2*ae+1,Me=2*le+1,De=function(Ne,je,Mt,Ft,St){return[Ne.getElevationAtPixel(je,Mt,!0),Ne.getElevationAtPixel(je+St,Mt,!0),Ne.getElevationAtPixel(je,Mt+St,!0),Ne.getElevationAtPixel(je+Ft,Mt+St,!0)]}(w,ce.x-ae,ce.y-le,we,Me),Pe=Math.abs(De[0]-De[1]),ve=Math.abs(De[2]-De[3]),Ie=Math.abs(De[0]-De[2])+Math.abs(De[1]-De[3]),Re=Math.min(.25,.5*oe*(Pe+ve)/we),Ze=Math.min(.25,.5*oe*Ie/Me);return ie+Math.max(Re*U,Ze*q)}(a,c,p):_;return{base:_+(r===0)?-1:r,top:x?Math.max(A+n,_+r+2):_+n}}const W1=Q([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:H1}=W1,Y1=Q([{name:"a_packed",components:3,type:"Float32"}]),{members:X1}=Y1,Q1=Js.VectorTileFeature.types,K1=Math.cos(Math.PI/180*37.5);class yh{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(r=>{this.gradients[r.id]={}}),this.layoutVertexArray=new H,this.layoutVertexArray2=new re,this.indexArray=new be,this.programConfigurations=new Xs(e.layers,e.zoom),this.segments=new ki,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,n,a){this.hasPattern=Jd("line",this.layers,r);const c=this.layers[0].layout.get("line-sort-key"),h=[];for(const{feature:A,id:w,index:E,sourceLayerIndex:z}of e){const P=this.layers[0]._featureFilter.needGeometry,F=Qs(A,P);if(!this.layers[0]._featureFilter.filter(new gi(this.zoom),F,n))continue;const U=c?c.evaluate(F,{},n):void 0,q={id:w,properties:A.properties,type:A.type,sourceLayerIndex:z,index:E,geometry:P?F.geometry:To(A,n,a),patterns:{},sortKey:U};h.push(q)}c&&h.sort((A,w)=>A.sortKey-w.sortKey);const{lineAtlas:p,featureIndex:_}=r,x=this.addConstantDashes(p);for(const A of h){const{geometry:w,index:E,sourceLayerIndex:z}=A;if(x&&this.addFeatureDashes(A,p),this.hasPattern){const P=ep("line",this.layers,A,this.zoom,r);this.patternFeatures.push(P)}else this.addFeature(A,w,E,n,p.positions,r.availableImages);_.insert(e[E].feature,w,E,z,this.index)}}addConstantDashes(e){let r=!1;for(const n of this.layers){const a=n.paint.get("line-dasharray").value,c=n.layout.get("line-cap").value;if(a.kind!=="constant"||c.kind!=="constant")r=!0;else{const h=c.value,p=a.value;if(!p)continue;e.addDash(p.from,h),e.addDash(p.to,h),p.other&&e.addDash(p.other,h)}}return r}addFeatureDashes(e,r){const n=this.zoom;for(const a of this.layers){const c=a.paint.get("line-dasharray").value,h=a.layout.get("line-cap").value;if(c.kind==="constant"&&h.kind==="constant")continue;let p,_,x,A,w,E;if(c.kind==="constant"){const U=c.value;if(!U)continue;p=U.other||U.to,_=U.to,x=U.from}else p=c.evaluate({zoom:n-1},e),_=c.evaluate({zoom:n},e),x=c.evaluate({zoom:n+1},e);h.kind==="constant"?A=w=E=h.value:(A=h.evaluate({zoom:n-1},e),w=h.evaluate({zoom:n},e),E=h.evaluate({zoom:n+1},e)),r.addDash(p,A),r.addDash(_,w),r.addDash(x,E);const z=r.getKey(p,A),P=r.getKey(_,w),F=r.getKey(x,E);e.patterns[a.id]={min:z,mid:P,max:F}}}update(e,r,n,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,n,a)}addFeatures(e,r,n,a,c){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,r,n,a)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,X1)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,H1),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,r,n,a,c,h){const p=this.layers[0].layout,_=p.get("line-join").evaluate(e,{}),x=p.get("line-cap").evaluate(e,{}),A=p.get("line-miter-limit"),w=p.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const E of r)this.addLine(E,e,_,x,A,w);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,c,h,a)}addLine(e,r,n,a,c,h){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let q=0;q<e.length-1;q++)this.totalDistance+=e[q].dist(e[q+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const p=Q1[r.type]==="Polygon";let _=e.length;for(;_>=2&&e[_-1].equals(e[_-2]);)_--;let x=0;for(;x<_-1&&e[x].equals(e[x+1]);)x++;if(_<(p?3:2))return;n==="bevel"&&(c=1.05);const A=this.overscaling<=16?122880/(512*this.overscaling):0,w=this.segments.prepareSegment(10*_,this.layoutVertexArray,this.indexArray);let E,z,P,F,U;this.e1=this.e2=-1,p&&(E=e[_-2],U=e[x].sub(E)._unit()._perp());for(let q=x;q<_;q++){if(P=q===_-1?p?e[x+1]:void 0:e[q+1],P&&e[q].equals(P))continue;U&&(F=U),E&&(z=E),E=e[q],U=P?P.sub(E)._unit()._perp():F,F=F||U;let ie=F.add(U);ie.x===0&&ie.y===0||ie._unit();const oe=F.x*U.x+F.y*U.y,ae=ie.x*U.x+ie.y*U.y,le=ae!==0?1/ae:1/0,ce=2*Math.sqrt(2-2*ae),we=ae<K1&&z&&P,Me=F.x*U.y-F.y*U.x>0;if(we&&q>x){const ve=E.dist(z);if(ve>2*A){const Ie=E.sub(E.sub(z)._mult(A/ve)._round());this.updateDistance(z,Ie),this.addCurrentVertex(Ie,F,0,0,w),z=Ie}}const De=z&&P;let Pe=De?n:p?"butt":a;if(De&&Pe==="round"&&(le<h?Pe="miter":le<=2&&(Pe="fakeround")),Pe==="miter"&&le>c&&(Pe="bevel"),Pe==="bevel"&&(le>2&&(Pe="flipbevel"),le<c&&(Pe="miter")),z&&this.updateDistance(z,E),Pe==="miter")ie._mult(le),this.addCurrentVertex(E,ie,0,0,w);else if(Pe==="flipbevel"){if(le>100)ie=U.mult(-1);else{const ve=le*F.add(U).mag()/F.sub(U).mag();ie._perp()._mult(ve*(Me?-1:1))}this.addCurrentVertex(E,ie,0,0,w),this.addCurrentVertex(E,ie.mult(-1),0,0,w)}else if(Pe==="bevel"||Pe==="fakeround"){const ve=-Math.sqrt(le*le-1),Ie=Me?ve:0,Re=Me?0:ve;if(z&&this.addCurrentVertex(E,F,Ie,Re,w),Pe==="fakeround"){const Ze=Math.round(180*ce/Math.PI/20);for(let Ne=1;Ne<Ze;Ne++){let je=Ne/Ze;if(je!==.5){const Ft=je-.5;je+=je*Ft*(je-1)*((1.0904+oe*(oe*(3.55645-1.43519*oe)-3.2452))*Ft*Ft+(.848013+oe*(.215638*oe-1.06021)))}const Mt=U.sub(F)._mult(je)._add(F)._unit()._mult(Me?-1:1);this.addHalfVertex(E,Mt.x,Mt.y,!1,Me,0,w)}}P&&this.addCurrentVertex(E,U,-Ie,-Re,w)}else if(Pe==="butt")this.addCurrentVertex(E,ie,0,0,w);else if(Pe==="square"){const ve=z?1:-1;z||this.addCurrentVertex(E,ie,ve,ve,w),this.addCurrentVertex(E,ie,0,0,w),z&&this.addCurrentVertex(E,ie,ve,ve,w)}else Pe==="round"&&(z&&(this.addCurrentVertex(E,F,0,0,w),this.addCurrentVertex(E,F,1,1,w,!0)),P&&(this.addCurrentVertex(E,U,-1,-1,w,!0),this.addCurrentVertex(E,U,0,0,w)));if(we&&q<_-1){const ve=E.dist(P);if(ve>2*A){const Ie=E.add(P.sub(E)._mult(A/ve)._round());this.updateDistance(E,Ie),this.addCurrentVertex(Ie,U,0,0,w),E=Ie}}}}addCurrentVertex(e,r,n,a,c,h=!1){const p=r.y*a-r.x,_=-r.y-r.x*a;this.addHalfVertex(e,r.x+r.y*n,r.y-r.x*n,h,!1,n,c),this.addHalfVertex(e,p,_,h,!0,-a,c)}addHalfVertex({x:e,y:r},n,a,c,h,p,_){this.layoutVertexArray.emplaceBack((e<<1)+(c?1:0),(r<<1)+(h?1:0),Math.round(63*n)+128,Math.round(63*a)+128,1+(p===0?0:p<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineSoFar);const x=_.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,x),_.primitiveLength++),h?this.e2=x:this.e1=x}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,r){this.distance+=e.dist(r),this.updateScaledDistance()}}tt(yh,{omit:["layers","patternFeatures"]});const $1=new k({"line-cap":new v(xe.layout_line["line-cap"]),"line-join":new v(xe.layout_line["line-join"]),"line-miter-limit":new g(xe.layout_line["line-miter-limit"]),"line-round-limit":new g(xe.layout_line["line-round-limit"]),"line-sort-key":new v(xe.layout_line["line-sort-key"])});var xm={paint:new k({"line-opacity":new v(xe.paint_line["line-opacity"]),"line-color":new v(xe.paint_line["line-color"]),"line-translate":new g(xe.paint_line["line-translate"]),"line-translate-anchor":new g(xe.paint_line["line-translate-anchor"]),"line-width":new v(xe.paint_line["line-width"]),"line-gap-width":new v(xe.paint_line["line-gap-width"]),"line-offset":new v(xe.paint_line["line-offset"]),"line-blur":new v(xe.paint_line["line-blur"]),"line-dasharray":new T(xe.paint_line["line-dasharray"]),"line-pattern":new T(xe.paint_line["line-pattern"]),"line-gradient":new S(xe.paint_line["line-gradient"])}),layout:$1};const vm=new class extends v{possiblyEvaluate(i,e){return e=new gi(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,zoomHistory:e.zoomHistory,transition:e.transition}),super.possiblyEvaluate(i,e)}evaluate(i,e,r,n){return e=mi({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(i,e,r,n)}}(xm.paint.properties["line-width"].specification);function Am(i,e){return e>0?e+2*i:i}vm.useIntegerZoom=!0;const J1=Q([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"},{name:"a_z_tile_anchor",components:4,type:"Int16"}],4),e0=Q([{name:"a_projected_pos",components:3,type:"Float32"}],4);Q([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const t0=Q([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),i0=Q([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Q([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const bm=Q([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),r0=Q([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Q([{name:"triangle",components:3,type:"Uint16"}]),Q([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Q([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Q([{type:"Float32",name:"offsetX"}]),Q([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var ar=24;const Hn=128;function tp(i,e){const{expression:r}=e;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new gi(i+1))};if(r.kind==="source")return{kind:"source"};{const{zoomStops:n,interpolationType:a}=r;let c=0;for(;c<n.length&&n[c]<=i;)c++;c=Math.max(0,c-1);let h=c;for(;h<n.length&&n[h]<i+1;)h++;h=Math.min(n.length-1,h);const p=n[c],_=n[h];return r.kind==="composite"?{kind:"composite",minZoom:p,maxZoom:_,interpolationType:a}:{kind:"camera",minZoom:p,maxZoom:_,minSize:r.evaluate(new gi(p)),maxSize:r.evaluate(new gi(_)),interpolationType:a}}}function xh(i,{uSize:e,uSizeT:r},{lowerSize:n,upperSize:a}){return i.kind==="source"?n/Hn:i.kind==="composite"?yt(n/Hn,a/Hn,r):e}function nl(i,e){let r=0,n=0;if(i.kind==="constant")n=i.layoutSize;else if(i.kind!=="source"){const{interpolationType:a,minZoom:c,maxZoom:h}=i,p=a?It(Mr.interpolationFactor(a,e,c,h),0,1):0;i.kind==="camera"?n=yt(i.minSize,i.maxSize,p):r=p}return{uSizeT:r,uSize:n}}var n0=Object.freeze({__proto__:null,getSizeData:tp,evaluateSizeForFeature:xh,evaluateSizeForZoom:nl,SIZE_PACK_FACTOR:Hn});function o0(i,e,r){return i.sections.forEach(n=>{n.text=function(a,c,h){const p=c.layout.get("text-transform").evaluate(h,{});return p==="uppercase"?a=a.toLocaleUpperCase():p==="lowercase"&&(a=a.toLocaleLowerCase()),Vr.applyArabicShaping&&(a=Vr.applyArabicShaping(a)),a}(n.text,e,r)}),i}const kc={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"};function s0(i){return i==="\uFE36"||i==="\uFE48"||i==="\uFE38"||i==="\uFE44"||i==="\uFE42"||i==="\uFE3E"||i==="\uFE3C"||i==="\uFE3A"||i==="\uFE18"||i==="\uFE40"||i==="\uFE10"||i==="\uFE13"||i==="\uFE14"||i==="\uFF40"||i==="\uFFE3"||i==="\uFE11"||i==="\uFE12"}function a0(i){return i==="\uFE35"||i==="\uFE47"||i==="\uFE37"||i==="\uFE43"||i==="\uFE41"||i==="\uFE3D"||i==="\uFE3B"||i==="\uFE39"||i==="\uFE17"||i==="\uFE3F"}var wm=function(i,e,r,n,a){var c,h,p=8*a-n-1,_=(1<<p)-1,x=_>>1,A=-7,w=r?a-1:0,E=r?-1:1,z=i[e+w];for(w+=E,c=z&(1<<-A)-1,z>>=-A,A+=p;A>0;c=256*c+i[e+w],w+=E,A-=8);for(h=c&(1<<-A)-1,c>>=-A,A+=n;A>0;h=256*h+i[e+w],w+=E,A-=8);if(c===0)c=1-x;else{if(c===_)return h?NaN:1/0*(z?-1:1);h+=Math.pow(2,n),c-=x}return(z?-1:1)*h*Math.pow(2,c-n)},Tm=function(i,e,r,n,a,c){var h,p,_,x=8*c-a-1,A=(1<<x)-1,w=A>>1,E=a===23?Math.pow(2,-24)-Math.pow(2,-77):0,z=n?0:c-1,P=n?1:-1,F=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(p=isNaN(e)?1:0,h=A):(h=Math.floor(Math.log(e)/Math.LN2),e*(_=Math.pow(2,-h))<1&&(h--,_*=2),(e+=h+w>=1?E/_:E*Math.pow(2,1-w))*_>=2&&(h++,_/=2),h+w>=A?(p=0,h=A):h+w>=1?(p=(e*_-1)*Math.pow(2,a),h+=w):(p=e*Math.pow(2,w-1)*Math.pow(2,a),h=0));a>=8;i[r+z]=255&p,z+=P,p/=256,a-=8);for(h=h<<a|p,x+=a;x>0;i[r+z]=255&h,z+=P,h/=256,x-=8);i[r+z-P]|=128*F},Pc=_i;function _i(i){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(i)?i:new Uint8Array(i||0),this.pos=0,this.type=0,this.length=this.buf.length}_i.Varint=0,_i.Fixed64=1,_i.Bytes=2,_i.Fixed32=5;var ip=4294967296,Em=1/ip,Cm=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function Co(i){return i.type===_i.Bytes?i.readVarint()+i.pos:i.pos+1}function ol(i,e,r){return r?4294967296*e+(i>>>0):4294967296*(e>>>0)+(i>>>0)}function Mm(i,e,r){var n=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));r.realloc(n);for(var a=r.pos-1;a>=i;a--)r.buf[a+n]=r.buf[a]}function l0(i,e){for(var r=0;r<i.length;r++)e.writeVarint(i[r])}function c0(i,e){for(var r=0;r<i.length;r++)e.writeSVarint(i[r])}function u0(i,e){for(var r=0;r<i.length;r++)e.writeFloat(i[r])}function h0(i,e){for(var r=0;r<i.length;r++)e.writeDouble(i[r])}function d0(i,e){for(var r=0;r<i.length;r++)e.writeBoolean(i[r])}function p0(i,e){for(var r=0;r<i.length;r++)e.writeFixed32(i[r])}function f0(i,e){for(var r=0;r<i.length;r++)e.writeSFixed32(i[r])}function m0(i,e){for(var r=0;r<i.length;r++)e.writeFixed64(i[r])}function _0(i,e){for(var r=0;r<i.length;r++)e.writeSFixed64(i[r])}function vh(i,e){return(i[e]|i[e+1]<<8|i[e+2]<<16)+16777216*i[e+3]}function sl(i,e,r){i[r]=e,i[r+1]=e>>>8,i[r+2]=e>>>16,i[r+3]=e>>>24}function Sm(i,e){return(i[e]|i[e+1]<<8|i[e+2]<<16)+(i[e+3]<<24)}function g0(i,e,r){e.glyphs=[],i===1&&r.readMessage(y0,e)}function y0(i,e,r){if(i===3){const{id:n,bitmap:a,width:c,height:h,left:p,top:_,advance:x}=r.readMessage(x0,{});e.glyphs.push({id:n,bitmap:new Eo({width:c+6,height:h+6},a),metrics:{width:c,height:h,left:p,top:_,advance:x}})}else i===4?e.ascender=r.readSVarint():i===5&&(e.descender=r.readSVarint())}function x0(i,e,r){i===1?e.id=r.readVarint():i===2?e.bitmap=r.readBytes():i===3?e.width=r.readVarint():i===4?e.height=r.readVarint():i===5?e.left=r.readSVarint():i===6?e.top=r.readSVarint():i===7&&(e.advance=r.readVarint())}function rp(i){let e=0,r=0;for(const h of i)e+=h.w*h.h,r=Math.max(r,h.w);i.sort((h,p)=>p.h-h.h);const n=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),r),h:1/0}];let a=0,c=0;for(const h of i)for(let p=n.length-1;p>=0;p--){const _=n[p];if(!(h.w>_.w||h.h>_.h)){if(h.x=_.x,h.y=_.y,c=Math.max(c,h.y+h.h),a=Math.max(a,h.x+h.w),h.w===_.w&&h.h===_.h){const x=n.pop();p<n.length&&(n[p]=x)}else h.h===_.h?(_.x+=h.w,_.w-=h.w):h.w===_.w?(_.y+=h.h,_.h-=h.h):(n.push({x:_.x+h.w,y:_.y,w:_.w-h.w,h:h.h}),_.y+=h.h,_.h-=h.h);break}}return{w:a,h:c,fill:e/(a*c)||0}}_i.prototype={destroy:function(){this.buf=null},readFields:function(i,e,r){for(r=r||this.length;this.pos<r;){var n=this.readVarint(),a=n>>3,c=this.pos;this.type=7&n,i(a,e,this),this.pos===c&&this.skip(n)}return e},readMessage:function(i,e){return this.readFields(i,e,this.readVarint()+this.pos)},readFixed32:function(){var i=vh(this.buf,this.pos);return this.pos+=4,i},readSFixed32:function(){var i=Sm(this.buf,this.pos);return this.pos+=4,i},readFixed64:function(){var i=vh(this.buf,this.pos)+vh(this.buf,this.pos+4)*ip;return this.pos+=8,i},readSFixed64:function(){var i=vh(this.buf,this.pos)+Sm(this.buf,this.pos+4)*ip;return this.pos+=8,i},readFloat:function(){var i=wm(this.buf,this.pos,!0,23,4);return this.pos+=4,i},readDouble:function(){var i=wm(this.buf,this.pos,!0,52,8);return this.pos+=8,i},readVarint:function(i){var e,r,n=this.buf;return e=127&(r=n[this.pos++]),r<128?e:(e|=(127&(r=n[this.pos++]))<<7,r<128?e:(e|=(127&(r=n[this.pos++]))<<14,r<128?e:(e|=(127&(r=n[this.pos++]))<<21,r<128?e:function(a,c,h){var p,_,x=h.buf;if(p=(112&(_=x[h.pos++]))>>4,_<128||(p|=(127&(_=x[h.pos++]))<<3,_<128)||(p|=(127&(_=x[h.pos++]))<<10,_<128)||(p|=(127&(_=x[h.pos++]))<<17,_<128)||(p|=(127&(_=x[h.pos++]))<<24,_<128)||(p|=(1&(_=x[h.pos++]))<<31,_<128))return ol(a,p,c);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(r=n[this.pos]))<<28,i,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var i=this.readVarint();return i%2==1?(i+1)/-2:i/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var i=this.readVarint()+this.pos,e=this.pos;return this.pos=i,i-e>=12&&Cm?function(r,n,a){return Cm.decode(r.subarray(n,a))}(this.buf,e,i):function(r,n,a){for(var c="",h=n;h<a;){var p,_,x,A=r[h],w=null,E=A>239?4:A>223?3:A>191?2:1;if(h+E>a)break;E===1?A<128&&(w=A):E===2?(192&(p=r[h+1]))==128&&(w=(31&A)<<6|63&p)<=127&&(w=null):E===3?(_=r[h+2],(192&(p=r[h+1]))==128&&(192&_)==128&&((w=(15&A)<<12|(63&p)<<6|63&_)<=2047||w>=55296&&w<=57343)&&(w=null)):E===4&&(_=r[h+2],x=r[h+3],(192&(p=r[h+1]))==128&&(192&_)==128&&(192&x)==128&&((w=(15&A)<<18|(63&p)<<12|(63&_)<<6|63&x)<=65535||w>=1114112)&&(w=null)),w===null?(w=65533,E=1):w>65535&&(w-=65536,c+=String.fromCharCode(w>>>10&1023|55296),w=56320|1023&w),c+=String.fromCharCode(w),h+=E}return c}(this.buf,e,i)},readBytes:function(){var i=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,i);return this.pos=i,e},readPackedVarint:function(i,e){if(this.type!==_i.Bytes)return i.push(this.readVarint(e));var r=Co(this);for(i=i||[];this.pos<r;)i.push(this.readVarint(e));return i},readPackedSVarint:function(i){if(this.type!==_i.Bytes)return i.push(this.readSVarint());var e=Co(this);for(i=i||[];this.pos<e;)i.push(this.readSVarint());return i},readPackedBoolean:function(i){if(this.type!==_i.Bytes)return i.push(this.readBoolean());var e=Co(this);for(i=i||[];this.pos<e;)i.push(this.readBoolean());return i},readPackedFloat:function(i){if(this.type!==_i.Bytes)return i.push(this.readFloat());var e=Co(this);for(i=i||[];this.pos<e;)i.push(this.readFloat());return i},readPackedDouble:function(i){if(this.type!==_i.Bytes)return i.push(this.readDouble());var e=Co(this);for(i=i||[];this.pos<e;)i.push(this.readDouble());return i},readPackedFixed32:function(i){if(this.type!==_i.Bytes)return i.push(this.readFixed32());var e=Co(this);for(i=i||[];this.pos<e;)i.push(this.readFixed32());return i},readPackedSFixed32:function(i){if(this.type!==_i.Bytes)return i.push(this.readSFixed32());var e=Co(this);for(i=i||[];this.pos<e;)i.push(this.readSFixed32());return i},readPackedFixed64:function(i){if(this.type!==_i.Bytes)return i.push(this.readFixed64());var e=Co(this);for(i=i||[];this.pos<e;)i.push(this.readFixed64());return i},readPackedSFixed64:function(i){if(this.type!==_i.Bytes)return i.push(this.readSFixed64());var e=Co(this);for(i=i||[];this.pos<e;)i.push(this.readSFixed64());return i},skip:function(i){var e=7&i;if(e===_i.Varint)for(;this.buf[this.pos++]>127;);else if(e===_i.Bytes)this.pos=this.readVarint()+this.pos;else if(e===_i.Fixed32)this.pos+=4;else{if(e!==_i.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(i,e){this.writeVarint(i<<3|e)},realloc:function(i){for(var e=this.length||16;e<this.pos+i;)e*=2;if(e!==this.length){var r=new Uint8Array(e);r.set(this.buf),this.buf=r,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(i){this.realloc(4),sl(this.buf,i,this.pos),this.pos+=4},writeSFixed32:function(i){this.realloc(4),sl(this.buf,i,this.pos),this.pos+=4},writeFixed64:function(i){this.realloc(8),sl(this.buf,-1&i,this.pos),sl(this.buf,Math.floor(i*Em),this.pos+4),this.pos+=8},writeSFixed64:function(i){this.realloc(8),sl(this.buf,-1&i,this.pos),sl(this.buf,Math.floor(i*Em),this.pos+4),this.pos+=8},writeVarint:function(i){(i=+i||0)>268435455||i<0?function(e,r){var n,a;if(e>=0?(n=e%4294967296|0,a=e/4294967296|0):(a=~(-e/4294967296),4294967295^(n=~(-e%4294967296))?n=n+1|0:(n=0,a=a+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");r.realloc(10),function(c,h,p){p.buf[p.pos++]=127&c|128,c>>>=7,p.buf[p.pos++]=127&c|128,c>>>=7,p.buf[p.pos++]=127&c|128,c>>>=7,p.buf[p.pos++]=127&c|128,p.buf[p.pos]=127&(c>>>=7)}(n,0,r),function(c,h){var p=(7&c)<<4;h.buf[h.pos++]|=p|((c>>>=3)?128:0),c&&(h.buf[h.pos++]=127&c|((c>>>=7)?128:0),c&&(h.buf[h.pos++]=127&c|((c>>>=7)?128:0),c&&(h.buf[h.pos++]=127&c|((c>>>=7)?128:0),c&&(h.buf[h.pos++]=127&c|((c>>>=7)?128:0),c&&(h.buf[h.pos++]=127&c)))))}(a,r)}(i,this):(this.realloc(4),this.buf[this.pos++]=127&i|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=i>>>7&127))))},writeSVarint:function(i){this.writeVarint(i<0?2*-i-1:2*i)},writeBoolean:function(i){this.writeVarint(Boolean(i))},writeString:function(i){i=String(i),this.realloc(4*i.length),this.pos++;var e=this.pos;this.pos=function(n,a,c){for(var h,p,_=0;_<a.length;_++){if((h=a.charCodeAt(_))>55295&&h<57344){if(!p){h>56319||_+1===a.length?(n[c++]=239,n[c++]=191,n[c++]=189):p=h;continue}if(h<56320){n[c++]=239,n[c++]=191,n[c++]=189,p=h;continue}h=p-55296<<10|h-56320|65536,p=null}else p&&(n[c++]=239,n[c++]=191,n[c++]=189,p=null);h<128?n[c++]=h:(h<2048?n[c++]=h>>6|192:(h<65536?n[c++]=h>>12|224:(n[c++]=h>>18|240,n[c++]=h>>12&63|128),n[c++]=h>>6&63|128),n[c++]=63&h|128)}return c}(this.buf,i,this.pos);var r=this.pos-e;r>=128&&Mm(e,r,this),this.pos=e-1,this.writeVarint(r),this.pos+=r},writeFloat:function(i){this.realloc(4),Tm(this.buf,i,this.pos,!0,23,4),this.pos+=4},writeDouble:function(i){this.realloc(8),Tm(this.buf,i,this.pos,!0,52,8),this.pos+=8},writeBytes:function(i){var e=i.length;this.writeVarint(e),this.realloc(e);for(var r=0;r<e;r++)this.buf[this.pos++]=i[r]},writeRawMessage:function(i,e){this.pos++;var r=this.pos;i(e,this);var n=this.pos-r;n>=128&&Mm(r,n,this),this.pos=r-1,this.writeVarint(n),this.pos+=n},writeMessage:function(i,e,r){this.writeTag(i,_i.Bytes),this.writeRawMessage(e,r)},writePackedVarint:function(i,e){e.length&&this.writeMessage(i,l0,e)},writePackedSVarint:function(i,e){e.length&&this.writeMessage(i,c0,e)},writePackedBoolean:function(i,e){e.length&&this.writeMessage(i,d0,e)},writePackedFloat:function(i,e){e.length&&this.writeMessage(i,u0,e)},writePackedDouble:function(i,e){e.length&&this.writeMessage(i,h0,e)},writePackedFixed32:function(i,e){e.length&&this.writeMessage(i,p0,e)},writePackedSFixed32:function(i,e){e.length&&this.writeMessage(i,f0,e)},writePackedFixed64:function(i,e){e.length&&this.writeMessage(i,m0,e)},writePackedSFixed64:function(i,e){e.length&&this.writeMessage(i,_0,e)},writeBytesField:function(i,e){this.writeTag(i,_i.Bytes),this.writeBytes(e)},writeFixed32Field:function(i,e){this.writeTag(i,_i.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(i,e){this.writeTag(i,_i.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(i,e){this.writeTag(i,_i.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(i,e){this.writeTag(i,_i.Fixed64),this.writeSFixed64(e)},writeVarintField:function(i,e){this.writeTag(i,_i.Varint),this.writeVarint(e)},writeSVarintField:function(i,e){this.writeTag(i,_i.Varint),this.writeSVarint(e)},writeStringField:function(i,e){this.writeTag(i,_i.Bytes),this.writeString(e)},writeFloatField:function(i,e){this.writeTag(i,_i.Fixed32),this.writeFloat(e)},writeDoubleField:function(i,e){this.writeTag(i,_i.Fixed64),this.writeDouble(e)},writeBooleanField:function(i,e){this.writeVarintField(i,Boolean(e))}};class np{constructor(e,{pixelRatio:r,version:n,stretchX:a,stretchY:c,content:h}){this.paddedRect=e,this.pixelRatio=r,this.stretchX=a,this.stretchY=c,this.content=h,this.version=n}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Im{constructor(e,r){const n={},a={};this.haveRenderCallbacks=[];const c=[];this.addImages(e,n,c),this.addImages(r,a,c);const{w:h,h:p}=rp(c),_=new Zr({width:h||1,height:p||1});for(const x in e){const A=e[x],w=n[x].paddedRect;Zr.copy(A.data,_,{x:0,y:0},{x:w.x+1,y:w.y+1},A.data)}for(const x in r){const A=r[x],w=a[x].paddedRect,E=w.x+1,z=w.y+1,P=A.data.width,F=A.data.height;Zr.copy(A.data,_,{x:0,y:0},{x:E,y:z},A.data),Zr.copy(A.data,_,{x:0,y:F-1},{x:E,y:z-1},{width:P,height:1}),Zr.copy(A.data,_,{x:0,y:0},{x:E,y:z+F},{width:P,height:1}),Zr.copy(A.data,_,{x:P-1,y:0},{x:E-1,y:z},{width:1,height:F}),Zr.copy(A.data,_,{x:0,y:0},{x:E+P,y:z},{width:1,height:F})}this.image=_,this.iconPositions=n,this.patternPositions=a}addImages(e,r,n){for(const a in e){const c=e[a],h={x:0,y:0,w:c.data.width+2,h:c.data.height+2};n.push(h),r[a]=new np(h,c),c.hasRenderCallback&&this.haveRenderCallbacks.push(a)}}patchUpdatedImages(e,r){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(n=>e.hasImage(n)),e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const n in e.updatedImages)this.patchUpdatedImage(this.iconPositions[n],e.getImage(n),r),this.patchUpdatedImage(this.patternPositions[n],e.getImage(n),r)}patchUpdatedImage(e,r,n){if(!e||!r||e.version===r.version)return;e.version=r.version;const[a,c]=e.tl;n.update(r.data,void 0,{x:a,y:c})}}tt(np),tt(Im);const ln={horizontal:1,vertical:2,horizontalOnly:3};class Bc{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,r){const n=new Bc;return n.scale=e||1,n.fontStack=r,n}static forImage(e){const r=new Bc;return r.imageName=e,r}}class al{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,r){const n=new al;for(let a=0;a<e.sections.length;a++){const c=e.sections[a];c.image?n.addImageSection(c):n.addTextSection(c,r)}return n}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(e){this.text=function(r,n){let a="";for(let c=0;c<r.length;c++){const h=r.charCodeAt(c+1)||null,p=r.charCodeAt(c-1)||null;a+=!n&&(h&&Wa(h)&&!kc[r[c+1]]||p&&Wa(p)&&!kc[r[c-1]])||!kc[r[c]]?r[c]:kc[r[c]]}return a}(this.text,e)}trim(){let e=0;for(let n=0;n<this.text.length&&Ah[this.text.charCodeAt(n)];n++)e++;let r=this.text.length;for(let n=this.text.length-1;n>=0&&n>=e&&Ah[this.text.charCodeAt(n)];n--)r--;this.text=this.text.substring(e,r),this.sectionIndex=this.sectionIndex.slice(e,r)}substring(e,r){const n=new al;return n.text=this.text.substring(e,r),n.sectionIndex=this.sectionIndex.slice(e,r),n.sections=this.sections,n}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,r)=>Math.max(e,this.sections[r].scale),0)}addTextSection(e,r){this.text+=e.text,this.sections.push(Bc.forText(e.scale,e.fontStack||r));const n=this.sections.length-1;for(let a=0;a<e.text.length;++a)this.sectionIndex.push(n)}addImageSection(e){const r=e.image?e.image.name:"";if(r.length===0)return void Ot("Can't add FormattedSection with an empty image.");const n=this.getNextImageSectionCharCode();n?(this.text+=String.fromCharCode(n),this.sections.push(Bc.forImage(r)),this.sectionIndex.push(this.sections.length-1)):Ot("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function op(i,e,r,n,a,c,h,p,_,x,A,w,E,z,P,F){const U=al.fromFeature(i,a);let q;w===ln.vertical&&U.verticalizePunctuation(E);const{processBidirectionalText:ie,processStyledBidirectionalText:oe}=Vr;if(ie&&U.sections.length===1){q=[];const ce=ie(U.toString(),sp(U,x,c,e,n,z,P));for(const we of ce){const Me=new al;Me.text=we,Me.sections=U.sections;for(let De=0;De<we.length;De++)Me.sectionIndex.push(0);q.push(Me)}}else if(oe){q=[];const ce=oe(U.text,U.sectionIndex,sp(U,x,c,e,n,z,P));for(const we of ce){const Me=new al;Me.text=we[0],Me.sectionIndex=we[1],Me.sections=U.sections,q.push(Me)}}else q=function(ce,we){const Me=[],De=ce.text;let Pe=0;for(const ve of we)Me.push(ce.substring(Pe,ve)),Pe=ve;return Pe<De.length&&Me.push(ce.substring(Pe,De.length)),Me}(U,sp(U,x,c,e,n,z,P));const ae=[],le={positionedLines:ae,text:U.toString(),top:A[1],bottom:A[1],left:A[0],right:A[0],writingMode:w,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(ce,we,Me,De,Pe,ve,Ie,Re,Ze,Ne,je,Mt){let Ft=0,St=0,Bt=0;const lt=Re==="right"?1:Re==="left"?0:.5;let et=!1;for(const ni of Pe){const jt=ni.getSections();for(const pi of jt){if(pi.imageName)continue;const Ii=we[pi.fontStack];if(Ii&&(et=Ii.ascender!==void 0&&Ii.descender!==void 0,!et))break}if(!et)break}let Vt=0;for(const ni of Pe){ni.trim();const jt=ni.getMaxScale(),pi=(jt-1)*ar,Ii={positionedGlyphs:[],lineOffset:0};ce.positionedLines[Vt]=Ii;const Pi=Ii.positionedGlyphs;let Zi=0;if(!ni.length()){St+=ve,++Vt;continue}let Hi=0,Hr=0;for(let fi=0;fi<ni.length();fi++){const Ar=ni.getSection(fi),Yr=ni.getSectionIndex(fi),tr=ni.getCharCode(fi);let Yi=Ar.scale,bi=null,xi=null,Br=null,br=ar,Ni=0;const wr=!(Ze===ln.horizontal||!je&&!qa(tr)||je&&(Ah[tr]||(ri=tr,Vu(ri)||Ua(ri)||Gs(ri)||cc(ri)||ja(ri))));if(Ar.imageName){const pr=De[Ar.imageName];if(!pr)continue;Br=Ar.imageName,ce.iconsInText=ce.iconsInText||!0,xi=pr.paddedRect;const Xi=pr.displaySize;Yi=Yi*ar/Mt,bi={width:Xi[0],height:Xi[1],left:1,top:-3,advance:wr?Xi[1]:Xi[0],localGlyph:!1},Ni=et?-bi.height*Yi:jt*ar-17-Xi[1]*Yi,br=bi.advance;const gn=(wr?Xi[0]:Xi[1])*Yi-ar*jt;gn>0&&gn>Zi&&(Zi=gn)}else{const pr=Me[Ar.fontStack];if(!pr)continue;pr[tr]&&(xi=pr[tr]);const Xi=we[Ar.fontStack];if(!Xi)continue;const gn=Xi.glyphs[tr];if(!gn)continue;if(bi=gn.metrics,br=tr!==8203?ar:0,et){const ls=Xi.ascender!==void 0?Math.abs(Xi.ascender):0,Zc=Xi.descender!==void 0?Math.abs(Xi.descender):0,qc=(ls+Zc)*Yi;Hi<qc&&(Hi=qc,Hr=(ls-Zc)/2*Yi),Ni=-ls*Yi}else Ni=(jt-Yi)*ar-17}wr?(ce.verticalizable=!0,Pi.push({glyph:tr,imageName:Br,x:Ft,y:St+Ni,vertical:wr,scale:Yi,localGlyph:bi.localGlyph,fontStack:Ar.fontStack,sectionIndex:Yr,metrics:bi,rect:xi}),Ft+=br*Yi+Ne):(Pi.push({glyph:tr,imageName:Br,x:Ft,y:St+Ni,vertical:wr,scale:Yi,localGlyph:bi.localGlyph,fontStack:Ar.fontStack,sectionIndex:Yr,metrics:bi,rect:xi}),Ft+=bi.advance*Yi+Ne)}Pi.length!==0&&(Bt=Math.max(Ft-Ne,Bt),et?Bm(Pi,lt,Zi,Hr,ve*jt/2):Bm(Pi,lt,Zi,0,ve/2)),Ft=0;const Pr=ve*jt+Zi;Ii.lineOffset=Math.max(Zi,pi),St+=Pr,++Vt}var ri;const Gi=St,{horizontalAlign:yi,verticalAlign:ji}=ap(Ie);(function(ni,jt,pi,Ii,Pi,Zi){const Hi=(jt-pi)*Pi,Hr=-Zi*Ii;for(const Pr of ni)for(const fi of Pr.positionedGlyphs)fi.x+=Hi,fi.y+=Hr})(ce.positionedLines,lt,yi,ji,Bt,Gi),ce.top+=-ji*Gi,ce.bottom=ce.top+Gi,ce.left+=-yi*Bt,ce.right=ce.left+Bt,ce.hasBaseline=et}(le,e,r,n,q,h,p,_,w,x,E,F),!function(ce){for(const we of ce)if(we.positionedGlyphs.length!==0)return!1;return!0}(ae)&&le}const Ah={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},v0={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function zm(i,e,r,n,a,c){if(e.imageName){const h=n[e.imageName];return h?h.displaySize[0]*e.scale*ar/c+a:0}{const h=r[e.fontStack],p=h&&h.glyphs[i];return p?p.metrics.advance*e.scale+a:0}}function Dm(i,e,r,n){const a=Math.pow(i-e,2);return n?i<e?a/2:2*a:a+Math.abs(r)*r}function A0(i,e,r){let n=0;return i===10&&(n-=1e4),r&&(n+=150),i!==40&&i!==65288||(n+=50),e!==41&&e!==65289||(n+=50),n}function km(i,e,r,n,a,c){let h=null,p=Dm(e,r,a,c);for(const _ of n){const x=Dm(e-_.x,r,a,c)+_.badness;x<=p&&(h=_,p=x)}return{index:i,x:e,priorBreak:h,badness:p}}function Pm(i){return i?Pm(i.priorBreak).concat(i.index):[]}function sp(i,e,r,n,a,c,h){if(c!=="point")return[];if(!i)return[];const p=[],_=function(E,z,P,F,U,q){let ie=0;for(let oe=0;oe<E.length();oe++){const ae=E.getSection(oe);ie+=zm(E.getCharCode(oe),ae,F,U,z,q)}return ie/Math.max(1,Math.ceil(ie/P))}(i,e,r,n,a,h),x=i.text.indexOf("\u200B")>=0;let A=0;for(let E=0;E<i.length();E++){const z=i.getSection(E),P=i.getCharCode(E);if(Ah[P]||(A+=zm(P,z,n,a,e,h)),E<i.length()-1){const F=!((w=P)<11904||!(Zu(w)||ju(w)||Ho(w)||Zs(w)||Hu(w)||oc(w)||qu(w)||Va(w)||Yu(w)||lc(w)||Wu(w)||uc(w)||js(w)||sc(w)||Gu(w)||ac(w)||Ga(w)||$u(w)||Qu(w)||Xu(w)));(v0[P]||F||z.imageName)&&p.push(km(E+1,A,_,p,A0(P,i.getCharCode(E+1),F&&x),!1))}}var w;return Pm(km(i.length(),A,_,p,0,!0))}function ap(i){let e=.5,r=.5;switch(i){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(i){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:e,verticalAlign:r}}function Bm(i,e,r,n,a){if(!(e||r||n||a))return;const c=i.length-1,h=i[c],p=(h.x+h.metrics.advance*h.scale)*e;for(let _=0;_<=c;_++)i[_].x-=p,i[_].y+=r+n+a}function b0(i,e,r){const{horizontalAlign:n,verticalAlign:a}=ap(r),c=e[0]-i.displaySize[0]*n,h=e[1]-i.displaySize[1]*a;return{image:i,top:h,bottom:h+i.displaySize[1],left:c,right:c+i.displaySize[0]}}function Lm(i,e,r,n,a,c){const h=i.image;let p;if(h.content){const U=h.content,q=h.pixelRatio||1;p=[U[0]/q,U[1]/q,h.displaySize[0]-U[2]/q,h.displaySize[1]-U[3]/q]}const _=e.left*c,x=e.right*c;let A,w,E,z;r==="width"||r==="both"?(z=a[0]+_-n[3],w=a[0]+x+n[1]):(z=a[0]+(_+x-h.displaySize[0])/2,w=z+h.displaySize[0]);const P=e.top*c,F=e.bottom*c;return r==="height"||r==="both"?(A=a[1]+P-n[0],E=a[1]+F+n[2]):(A=a[1]+(P+F-h.displaySize[1])/2,E=A+h.displaySize[1]),{image:h,top:A,right:w,bottom:E,left:z,collisionPadding:p}}class Mo extends J{constructor(e,r,n,a,c){super(e,r),this.angle=a,this.z=n,c!==void 0&&(this.segment=c)}clone(){return new Mo(this.x,this.y,this.z,this.angle,this.segment)}}function Rm(i,e,r,n,a){if(e.segment===void 0)return!0;let c=e,h=e.segment+1,p=0;for(;p>-r/2;){if(h--,h<0)return!1;p-=i[h].dist(c),c=i[h]}p+=i[h].dist(i[h+1]),h++;const _=[];let x=0;for(;p<r/2;){const A=i[h],w=i[h+1];if(!w)return!1;let E=i[h-1].angleTo(A)-A.angleTo(w);for(E=Math.abs((E+3*Math.PI)%(2*Math.PI)-Math.PI),_.push({distance:p,angleDelta:E}),x+=E;p-_[0].distance>n;)x-=_.shift().angleDelta;if(x>a)return!1;h++,p+=A.dist(w)}return!0}function Fm(i){let e=0;for(let r=0;r<i.length-1;r++)e+=i[r].dist(i[r+1]);return e}function Om(i,e,r){return i?.6*e*r:0}function Nm(i,e){return Math.max(i?i.right-i.left:0,e?e.right-e.left:0)}function w0(i,e,r,n,a,c){const h=Om(r,a,c),p=Nm(r,n)*c;let _=0;const x=Fm(i)/2;for(let A=0;A<i.length-1;A++){const w=i[A],E=i[A+1],z=w.dist(E);if(_+z>x){const P=(x-_)/z,F=yt(w.x,E.x,P),U=yt(w.y,E.y,P),q=new Mo(F,U,0,E.angleTo(w),A);return!h||Rm(i,q,p,h,e)?q:void 0}_+=z}}function T0(i,e,r,n,a,c,h,p,_){const x=Om(n,c,h),A=Nm(n,a),w=A*h,E=i[0].x===0||i[0].x===_||i[0].y===0||i[0].y===_;return e-w<e/4&&(e=w+e/4),Um(i,E?e/2*p%e:(A/2+2*c)*h*p%e,e,x,r,w,E,!1,_)}function Um(i,e,r,n,a,c,h,p,_){const x=c/2,A=Fm(i);let w=0,E=e-r,z=[];for(let P=0;P<i.length-1;P++){const F=i[P],U=i[P+1],q=F.dist(U),ie=U.angleTo(F);for(;E+r<w+q;){E+=r;const oe=(E-w)/q,ae=yt(F.x,U.x,oe),le=yt(F.y,U.y,oe);if(ae>=0&&ae<_&&le>=0&&le<_&&E-x>=0&&E+x<=A){const ce=new Mo(ae,le,0,ie,P);ce._round(),n&&!Rm(i,ce,c,n,a)||z.push(ce)}}w+=q}return p||z.length||h||(z=Um(i,w/2,r,n,a,c,h,!0,_)),z}function Vm(i,e,r,n,a){const c=[];for(let h=0;h<i.length;h++){const p=i[h];let _;for(let x=0;x<p.length-1;x++){let A=p[x],w=p[x+1];A.x<e&&w.x<e||(A.x<e?A=new J(e,A.y+(e-A.x)/(w.x-A.x)*(w.y-A.y))._round():w.x<e&&(w=new J(e,A.y+(e-A.x)/(w.x-A.x)*(w.y-A.y))._round()),A.y<r&&w.y<r||(A.y<r?A=new J(A.x+(r-A.y)/(w.y-A.y)*(w.x-A.x),r)._round():w.y<r&&(w=new J(A.x+(r-A.y)/(w.y-A.y)*(w.x-A.x),r)._round()),A.x>=n&&w.x>=n||(A.x>=n?A=new J(n,A.y+(n-A.x)/(w.x-A.x)*(w.y-A.y))._round():w.x>=n&&(w=new J(n,A.y+(n-A.x)/(w.x-A.x)*(w.y-A.y))._round()),A.y>=a&&w.y>=a||(A.y>=a?A=new J(A.x+(a-A.y)/(w.y-A.y)*(w.x-A.x),a)._round():w.y>=a&&(w=new J(A.x+(a-A.y)/(w.y-A.y)*(w.x-A.x),a)._round()),_&&A.equals(_[_.length-1])||(_=[A],c.push(_)),_.push(w)))))}}return c}tt(Mo);const Lc=1e20;function Gm(i,e,r,n,a,c,h,p,_){for(let x=e;x<e+n;x++)jm(i,r*c+x,c,a,h,p,_);for(let x=r;x<r+a;x++)jm(i,x*c+e,1,n,h,p,_)}function jm(i,e,r,n,a,c,h){c[0]=0,h[0]=-Lc,h[1]=Lc,a[0]=i[e];for(let p=1,_=0,x=0;p<n;p++){a[p]=i[e+p*r];const A=p*p;do{const w=c[_];x=(a[p]-a[w]+A-w*w)/(p-w)/2}while(x<=h[_]&&--_>-1);_++,c[_]=p,h[_]=x,h[_+1]=Lc}for(let p=0,_=0;p<n;p++){for(;h[_+1]<p;)_++;const x=c[_],A=p-x;i[e+p*r]=a[x]+A*A}}const lp={none:0,ideographs:1,all:2};class ll{constructor(e,r,n){this.requestManager=e,this.localGlyphMode=r,this.localFontFamily=n,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e){this.url=e}getGlyphs(e,r){const n=[];for(const a in e)for(const c of e[a])n.push({stack:a,id:c});Ki(n,({stack:a,id:c},h)=>{let p=this.entries[a];p||(p=this.entries[a]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let _=p.glyphs[c];if(_!==void 0)return void h(null,{stack:a,id:c,glyph:_});if(_=this._tinySDF(p,a,c),_)return p.glyphs[c]=_,void h(null,{stack:a,id:c,glyph:_});const x=Math.floor(c/256);if(256*x>65535)return void h(new Error("glyphs > 65535 not supported"));if(p.ranges[x])return void h(null,{stack:a,id:c,glyph:_});let A=p.requests[x];A||(A=p.requests[x]=[],ll.loadGlyphRange(a,x,this.url,this.requestManager,(w,E)=>{if(E){p.ascender=E.ascender,p.descender=E.descender;for(const z in E.glyphs)this._doesCharSupportLocalGlyph(+z)||(p.glyphs[+z]=E.glyphs[+z]);p.ranges[x]=!0}for(const z of A)z(w,E);delete p.requests[x]})),A.push((w,E)=>{w?h(w):E&&h(null,{stack:a,id:c,glyph:E.glyphs[c]||null})})},(a,c)=>{if(a)r(a);else if(c){const h={};for(const{stack:p,id:_,glyph:x}of c)h[p]===void 0&&(h[p]={}),h[p].glyphs===void 0&&(h[p].glyphs={}),h[p].glyphs[_]=x&&{id:x.id,bitmap:x.bitmap.clone(),metrics:x.metrics},h[p].ascender=this.entries[p].ascender,h[p].descender=this.entries[p].descender;r(null,h)}})}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==lp.none&&(this.localGlyphMode===lp.all?!!this.localFontFamily:!!this.localFontFamily&&(lc(e)||Ku(e)||js(e)||Ga(e)||Va(e)))}_tinySDF(e,r,n){const a=this.localFontFamily;if(!a||!this._doesCharSupportLocalGlyph(n))return;let c=e.tinySDF;if(!c){let F="400";/bold/i.test(r)?F="900":/medium/i.test(r)?F="500":/light/i.test(r)&&(F="200"),c=e.tinySDF=new ll.TinySDF({fontFamily:a,fontWeight:F,fontSize:48,buffer:6,radius:16}),c.fontWeight=F}if(this.localGlyphs[c.fontWeight][n])return this.localGlyphs[c.fontWeight][n];const h=String.fromCharCode(n),{data:p,width:_,height:x,glyphWidth:A,glyphHeight:w,glyphLeft:E,glyphTop:z,glyphAdvance:P}=c.draw(h);return this.localGlyphs[c.fontWeight][n]={id:n,bitmap:new Eo({width:_,height:x},p),metrics:{width:A/2,height:w/2,left:E/2,top:z/2-27,advance:P/2,localGlyph:!0}}}}function Zm(i,e,r,n){const a=[],c=i.image,h=c.pixelRatio,p=c.paddedRect.w-2,_=c.paddedRect.h-2,x=i.right-i.left,A=i.bottom-i.top,w=c.stretchX||[[0,p]],E=c.stretchY||[[0,_]],z=(ve,Ie)=>ve+Ie[1]-Ie[0],P=w.reduce(z,0),F=E.reduce(z,0),U=p-P,q=_-F;let ie=0,oe=P,ae=0,le=F,ce=0,we=U,Me=0,De=q;if(c.content&&n){const ve=c.content;ie=bh(w,0,ve[0]),ae=bh(E,0,ve[1]),oe=bh(w,ve[0],ve[2]),le=bh(E,ve[1],ve[3]),ce=ve[0]-ie,Me=ve[1]-ae,we=ve[2]-ve[0]-oe,De=ve[3]-ve[1]-le}const Pe=(ve,Ie,Re,Ze)=>{const Ne=wh(ve.stretch-ie,oe,x,i.left),je=Th(ve.fixed-ce,we,ve.stretch,P),Mt=wh(Ie.stretch-ae,le,A,i.top),Ft=Th(Ie.fixed-Me,De,Ie.stretch,F),St=wh(Re.stretch-ie,oe,x,i.left),Bt=Th(Re.fixed-ce,we,Re.stretch,P),lt=wh(Ze.stretch-ae,le,A,i.top),et=Th(Ze.fixed-Me,De,Ze.stretch,F),Vt=new J(Ne,Mt),ri=new J(St,Mt),Gi=new J(St,lt),yi=new J(Ne,lt),ji=new J(je/h,Ft/h),ni=new J(Bt/h,et/h),jt=e*Math.PI/180;if(jt){const Pi=Math.sin(jt),Zi=Math.cos(jt),Hi=[Zi,-Pi,Pi,Zi];Vt._matMult(Hi),ri._matMult(Hi),yi._matMult(Hi),Gi._matMult(Hi)}const pi=ve.stretch+ve.fixed,Ii=Ie.stretch+Ie.fixed;return{tl:Vt,tr:ri,bl:yi,br:Gi,tex:{x:c.paddedRect.x+1+pi,y:c.paddedRect.y+1+Ii,w:Re.stretch+Re.fixed-pi,h:Ze.stretch+Ze.fixed-Ii},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:ji,pixelOffsetBR:ni,minFontScaleX:we/h/x,minFontScaleY:De/h/A,isSDF:r}};if(n&&(c.stretchX||c.stretchY)){const ve=qm(w,U,P),Ie=qm(E,q,F);for(let Re=0;Re<ve.length-1;Re++){const Ze=ve[Re],Ne=ve[Re+1];for(let je=0;je<Ie.length-1;je++)a.push(Pe(Ze,Ie[je],Ne,Ie[je+1]))}}else a.push(Pe({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:p+1},{fixed:0,stretch:_+1}));return a}function bh(i,e,r){let n=0;for(const a of i)n+=Math.max(e,Math.min(r,a[1]))-Math.max(e,Math.min(r,a[0]));return n}function qm(i,e,r){const n=[{fixed:-1,stretch:0}];for(const[a,c]of i){const h=n[n.length-1];n.push({fixed:a-h.stretch,stretch:h.stretch}),n.push({fixed:a-h.stretch,stretch:h.stretch+(c-a)})}return n.push({fixed:e+1,stretch:r}),n}function wh(i,e,r,n){return i/e*r+n}function Th(i,e,r,n){return i-e*r/n}function E0(i,e,r,n){const a=e+i.positionedLines[n].lineOffset;return n===0?r+a/2:r+(a+(e+i.positionedLines[n-1].lineOffset))/2}ll.loadGlyphRange=function(i,e,r,n,a){const c=256*e,h=c+255,p=n.transformRequest(n.normalizeGlyphsURL(r).replace("{fontstack}",i).replace("{range}",`${c}-${h}`),W.Glyphs);$(p,(_,x)=>{if(_)a(_);else if(x){const A={},w=function(E){return new Pc(E).readFields(g0,{})}(x);for(const E of w.glyphs)A[E.id]=E;a(null,{glyphs:A,ascender:w.ascender,descender:w.descender})}})},ll.TinySDF=class{constructor({fontSize:i=24,buffer:e=3,radius:r=8,cutoff:n=.25,fontFamily:a="sans-serif",fontWeight:c="normal",fontStyle:h="normal"}){this.buffer=e,this.cutoff=n,this.radius=r;const p=this.size=i+4*e,_=this._createCanvas(p),x=this.ctx=_.getContext("2d",{willReadFrequently:!0});x.font=`${h} ${c} ${i}px ${a}`,x.textBaseline="alphabetic",x.textAlign="left",x.fillStyle="black",this.gridOuter=new Float64Array(p*p),this.gridInner=new Float64Array(p*p),this.f=new Float64Array(p),this.z=new Float64Array(p+1),this.v=new Uint16Array(p)}_createCanvas(i){const e=document.createElement("canvas");return e.width=e.height=i,e}draw(i){const{width:e,actualBoundingBoxAscent:r,actualBoundingBoxDescent:n,actualBoundingBoxLeft:a,actualBoundingBoxRight:c}=this.ctx.measureText(i),h=Math.floor(r),p=Math.min(this.size-this.buffer,Math.ceil(c-a)),_=Math.min(this.size-this.buffer,Math.ceil(r)+Math.ceil(n)),x=p+2*this.buffer,A=_+2*this.buffer,w=x*A,E=new Uint8ClampedArray(w),z={data:E,width:x,height:A,glyphWidth:p,glyphHeight:_,glyphTop:h,glyphLeft:0,glyphAdvance:e};if(p===0||_===0)return z;const{ctx:P,buffer:F,gridInner:U,gridOuter:q}=this;P.clearRect(F,F,p,_),P.fillText(i,F,F+h+1);const ie=P.getImageData(F,F,p,_);q.fill(Lc,0,w),U.fill(0,0,w);for(let oe=0;oe<_;oe++)for(let ae=0;ae<p;ae++){const le=ie.data[4*(oe*p+ae)+3]/255;if(le===0)continue;const ce=(oe+F)*x+ae+F;if(le===1)q[ce]=0,U[ce]=Lc;else{const we=.5-le;q[ce]=we>0?we*we:0,U[ce]=we<0?we*we:0}}Gm(q,0,0,x,A,x,this.f,this.v,this.z),Gm(U,F,F,p,_,x,this.f,this.v,this.z);for(let oe=0;oe<w;oe++){const ae=Math.sqrt(q[oe])-Math.sqrt(U[oe]);E[oe]=Math.round(255-255*(ae/this.radius+this.cutoff))}return z}};class C0{constructor(e=[],r=M0){if(this.data=e,this.length=this.data.length,this.compare=r,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],r=this.data.pop();return this.length--,this.length>0&&(this.data[0]=r,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:r,compare:n}=this,a=r[e];for(;e>0;){const c=e-1>>1,h=r[c];if(n(a,h)>=0)break;r[e]=h,e=c}r[e]=a}_down(e){const{data:r,compare:n}=this,a=this.length>>1,c=r[e];for(;e<a;){let h=1+(e<<1),p=r[h];const _=h+1;if(_<this.length&&n(r[_],p)<0&&(h=_,p=r[_]),n(p,c)>=0)break;r[e]=p,e=h}r[e]=c}}function M0(i,e){return i<e?-1:i>e?1:0}function S0(i,e=1,r=!1){let n=1/0,a=1/0,c=-1/0,h=-1/0;const p=i[0];for(let z=0;z<p.length;z++){const P=p[z];(!z||P.x<n)&&(n=P.x),(!z||P.y<a)&&(a=P.y),(!z||P.x>c)&&(c=P.x),(!z||P.y>h)&&(h=P.y)}const _=Math.min(c-n,h-a);let x=_/2;const A=new C0([],I0);if(_===0)return new J(n,a);for(let z=n;z<c;z+=_)for(let P=a;P<h;P+=_)A.push(new cl(z+x,P+x,x,i));let w=function(z){let P=0,F=0,U=0;const q=z[0];for(let ie=0,oe=q.length,ae=oe-1;ie<oe;ae=ie++){const le=q[ie],ce=q[ae],we=le.x*ce.y-ce.x*le.y;F+=(le.x+ce.x)*we,U+=(le.y+ce.y)*we,P+=3*we}return new cl(F/P,U/P,0,z)}(i),E=A.length;for(;A.length;){const z=A.pop();(z.d>w.d||!w.d)&&(w=z,r&&console.log("found best %d after %d probes",Math.round(1e4*z.d)/1e4,E)),z.max-w.d<=e||(x=z.h/2,A.push(new cl(z.p.x-x,z.p.y-x,x,i)),A.push(new cl(z.p.x+x,z.p.y-x,x,i)),A.push(new cl(z.p.x-x,z.p.y+x,x,i)),A.push(new cl(z.p.x+x,z.p.y+x,x,i)),E+=4)}return r&&(console.log(`num probes: ${E}`),console.log(`best distance: ${w.d}`)),w.p}function I0(i,e){return e.max-i.max}function cl(i,e,r,n){this.p=new J(i,e),this.h=r,this.d=function(a,c){let h=!1,p=1/0;for(let _=0;_<c.length;_++){const x=c[_];for(let A=0,w=x.length,E=w-1;A<w;E=A++){const z=x[A],P=x[E];z.y>a.y!=P.y>a.y&&a.x<(P.x-z.x)*(a.y-z.y)/(P.y-z.y)+z.x&&(h=!h),p=Math.min(p,Vf(a,z,P))}}return(h?1:-1)*Math.sqrt(p)}(this.p,n),this.max=this.d+this.h*Math.SQRT2}const cp=Number.POSITIVE_INFINITY,z0=Math.sqrt(2);function Wm(i,e){return e[1]!==cp?function(r,n,a){let c=0,h=0;switch(n=Math.abs(n),a=Math.abs(a),r){case"top-right":case"top-left":case"top":h=a-7;break;case"bottom-right":case"bottom-left":case"bottom":h=7-a}switch(r){case"top-right":case"bottom-right":case"right":c=-n;break;case"top-left":case"bottom-left":case"left":c=n}return[c,h]}(i,e[0],e[1]):function(r,n){let a=0,c=0;n<0&&(n=0);const h=n/z0;switch(r){case"top-right":case"top-left":c=h-7;break;case"bottom-right":case"bottom-left":c=7-h;break;case"bottom":c=7-n;break;case"top":c=n-7}switch(r){case"top-right":case"bottom-right":a=-h;break;case"top-left":case"bottom-left":a=h;break;case"left":a=n;break;case"right":a=-n}return[a,c]}(i,e[0])}function D0(i,e,r,n,a,c,h,p,_,x){i.createArrays(),i.tilePixelRatio=zt/(512*i.overscaling),i.compareText={},i.iconsNeedLinear=!1;const A=i.layers[0].layout,w=i.layers[0]._unevaluatedLayout._values,E={};if(i.textSizeData.kind==="composite"){const{minZoom:F,maxZoom:U}=i.textSizeData;E.compositeTextSizes=[w["text-size"].possiblyEvaluate(new gi(F),p),w["text-size"].possiblyEvaluate(new gi(U),p)]}if(i.iconSizeData.kind==="composite"){const{minZoom:F,maxZoom:U}=i.iconSizeData;E.compositeIconSizes=[w["icon-size"].possiblyEvaluate(new gi(F),p),w["icon-size"].possiblyEvaluate(new gi(U),p)]}E.layoutTextSize=w["text-size"].possiblyEvaluate(new gi(_+1),p),E.layoutIconSize=w["icon-size"].possiblyEvaluate(new gi(_+1),p),E.textMaxSize=w["text-size"].possiblyEvaluate(new gi(18),p);const z=A.get("text-rotation-alignment")==="map"&&A.get("symbol-placement")!=="point",P=A.get("text-size");for(const F of i.features){const U=A.get("text-font").evaluate(F,{},p).join(","),q=P.evaluate(F,{},p),ie=E.layoutTextSize.evaluate(F,{},p),oe=(E.layoutIconSize.evaluate(F,{},p),{horizontal:{},vertical:void 0}),ae=F.text;let le,ce=[0,0];if(ae){const De=ae.toString(),Pe=A.get("text-letter-spacing").evaluate(F,{},p)*ar,ve=A.get("text-line-height").evaluate(F,{},p)*ar,Ie=eh(De)?Pe:0,Re=A.get("text-anchor").evaluate(F,{},p),Ze=A.get("text-variable-anchor");if(!Ze){const Bt=A.get("text-radial-offset").evaluate(F,{},p);ce=Bt?Wm(Re,[Bt*ar,cp]):A.get("text-offset").evaluate(F,{},p).map(lt=>lt*ar)}let Ne=z?"center":A.get("text-justify").evaluate(F,{},p);const je=A.get("symbol-placement"),Mt=je==="point",Ft=je==="point"?A.get("text-max-width").evaluate(F,{},p)*ar:0,St=Bt=>{i.allowVerticalPlacement&&Za(De)&&(oe.vertical=op(ae,e,r,a,U,Ft,ve,Re,Bt,Ie,ce,ln.vertical,!0,je,ie,q))};if(!z&&Ze){const Bt=Ne==="auto"?Ze.map(et=>up(et)):[Ne];let lt=!1;for(let et=0;et<Bt.length;et++){const Vt=Bt[et];if(!oe.horizontal[Vt])if(lt)oe.horizontal[Vt]=oe.horizontal[0];else{const ri=op(ae,e,r,a,U,Ft,ve,"center",Vt,Ie,ce,ln.horizontal,!1,je,ie,q);ri&&(oe.horizontal[Vt]=ri,lt=ri.positionedLines.length===1)}}St("left")}else{if(Ne==="auto"&&(Ne=up(Re)),Mt||A.get("text-writing-mode").indexOf("horizontal")>=0||!Za(De)){const Bt=op(ae,e,r,a,U,Ft,ve,Re,Ne,Ie,ce,ln.horizontal,!1,je,ie,q);Bt&&(oe.horizontal[Ne]=Bt)}St(je==="point"?"left":Ne)}}let we=!1;if(F.icon&&F.icon.name){const De=n[F.icon.name];De&&(le=b0(a[F.icon.name],A.get("icon-offset").evaluate(F,{},p),A.get("icon-anchor").evaluate(F,{},p)),we=De.sdf,i.sdfIcons===void 0?i.sdfIcons=De.sdf:i.sdfIcons!==De.sdf&&Ot("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(De.pixelRatio!==i.pixelRatio||A.get("icon-rotate").constantOr(1)!==0)&&(i.iconsNeedLinear=!0))}const Me=Ym(oe.horizontal)||oe.vertical;i.iconsInText||(i.iconsInText=!!Me&&Me.iconsInText),(Me||le)&&k0(i,F,oe,le,n,E,ie,0,ce,we,h,p,x)}c&&i.generateCollisionDebugBuffers(_,i.collisionBoxArray)}function up(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function k0(i,e,r,n,a,c,h,p,_,x,A,w,E){let z=c.textMaxSize.evaluate(e,{},w);z===void 0&&(z=h);const P=i.layers[0].layout,F=P.get("icon-offset").evaluate(e,{},w),U=Ym(r.horizontal)||r.vertical,q=h/24,ie=i.tilePixelRatio*z/24,oe=(ve=i.overscaling,i.zoom>18&&ve>2&&(ve>>=1),Math.max(zt/(512*ve),1)*P.get("symbol-spacing")),ae=P.get("text-padding")*i.tilePixelRatio,le=P.get("icon-padding")*i.tilePixelRatio,ce=We(P.get("text-max-angle")),we=P.get("text-rotation-alignment")==="map"&&P.get("symbol-placement")!=="point",Me=P.get("icon-rotation-alignment")==="map"&&P.get("symbol-placement")!=="point",De=P.get("symbol-placement"),Pe=oe/2;var ve;const Ie=P.get("icon-text-fit");let Re;n&&Ie!=="none"&&(i.allowVerticalPlacement&&r.vertical&&(Re=Lm(n,r.vertical,Ie,P.get("icon-text-fit-padding"),F,q)),U&&(n=Lm(n,U,Ie,P.get("icon-text-fit-padding"),F,q)));const Ze=(Ne,je,Mt)=>{if(je.x<0||je.x>=zt||je.y<0||je.y>=zt)return;const{x:Ft,y:St,z:Bt}=E.projectTilePoint(je.x,je.y,Mt),lt=new Mo(Ft,St,Bt,0,void 0);(function(et,Vt,ri,Gi,yi,ji,ni,jt,pi,Ii,Pi,Zi,Hi,Hr,Pr,fi,Ar,Yr,tr,Yi,bi,xi,Br,br,Ni){const wr=et.addToLineVertexArray(Vt,Gi);let pr,Xi,gn,ls,Zc,qc,z_,D_=0,k_=0,P_=0,B_=0,Mp=-1,Sp=-1;const Kn={};let L_=Zn(""),Ip=0,zp=0;if(pi._unevaluatedLayout.getValue("text-radial-offset")===void 0?[Ip,zp]=pi.layout.get("text-offset").evaluate(bi,{},Ni).map(Xr=>Xr*ar):(Ip=pi.layout.get("text-radial-offset").evaluate(bi,{},Ni)*ar,zp=cp),et.allowVerticalPlacement&&yi.vertical){const Xr=yi.vertical;if(Pr)qc=hp(Xr),jt&&(z_=hp(jt));else{const Qr=pi.layout.get("text-rotate").evaluate(bi,{},Ni)+90;gn=Eh(Ii,ri,Vt,Pi,Zi,Hi,Xr,Hr,Qr,fi),jt&&(ls=Eh(Ii,ri,Vt,Pi,Zi,Hi,jt,Yr,Qr))}}if(ji){const Xr=pi.layout.get("icon-rotate").evaluate(bi,{},Ni),Qr=pi.layout.get("icon-text-fit")!=="none",Wc=Zm(ji,Xr,Br,Qr),kp=jt?Zm(jt,Xr,Br,Qr):void 0;Xi=Eh(Ii,ri,Vt,Pi,Zi,Hi,ji,Yr,Xr),D_=4*Wc.length;const R_=et.iconSizeData;let ia=null;R_.kind==="source"?(ia=[Hn*pi.layout.get("icon-size").evaluate(bi,{},Ni)],ia[0]>is&&Ot(`${et.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):R_.kind==="composite"&&(ia=[Hn*xi.compositeIconSizes[0].evaluate(bi,{},Ni),Hn*xi.compositeIconSizes[1].evaluate(bi,{},Ni)],(ia[0]>is||ia[1]>is)&&Ot(`${et.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),et.addSymbols(et.icon,Wc,ia,Yi,tr,bi,!1,ri,Vt,wr.lineStartIndex,wr.lineLength,-1,br,Ni),Mp=et.icon.placedSymbolArray.length-1,kp&&(k_=4*kp.length,et.addSymbols(et.icon,kp,ia,Yi,tr,bi,ln.vertical,ri,Vt,wr.lineStartIndex,wr.lineLength,-1,br,Ni),Sp=et.icon.placedSymbolArray.length-1)}for(const Xr in yi.horizontal){const Qr=yi.horizontal[Xr];pr||(L_=Zn(Qr.text),Pr?Zc=hp(Qr):pr=Eh(Ii,ri,Vt,Pi,Zi,Hi,Qr,Hr,pi.layout.get("text-rotate").evaluate(bi,{},Ni),fi));const Wc=Qr.positionedLines.length===1;if(P_+=Hm(et,ri,Vt,Qr,ni,pi,Pr,bi,fi,wr,yi.vertical?ln.horizontal:ln.horizontalOnly,Wc?Object.keys(yi.horizontal):[Xr],Kn,Mp,xi,br,Ni),Wc)break}yi.vertical&&(B_+=Hm(et,ri,Vt,yi.vertical,ni,pi,Pr,bi,fi,wr,ln.vertical,["vertical"],Kn,Sp,xi,br,Ni));let cs=-1;const Dp=(Xr,Qr)=>Xr?Math.max(Xr,Qr):Qr;cs=Dp(Zc,cs),cs=Dp(qc,cs),cs=Dp(z_,cs);const dx=cs>-1?1:0;et.glyphOffsetArray.length>=rs.MAX_GLYPHS&&Ot("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),bi.sortKey!==void 0&&et.addToSortKeyRanges(et.symbolInstances.length,bi.sortKey),et.symbolInstances.emplaceBack(ri.x,ri.y,ri.z,Vt.x,Vt.y,Kn.right>=0?Kn.right:-1,Kn.center>=0?Kn.center:-1,Kn.left>=0?Kn.left:-1,Kn.vertical>=0?Kn.vertical:-1,Mp,Sp,L_,pr!==void 0?pr:et.collisionBoxArray.length,pr!==void 0?pr+1:et.collisionBoxArray.length,gn!==void 0?gn:et.collisionBoxArray.length,gn!==void 0?gn+1:et.collisionBoxArray.length,Xi!==void 0?Xi:et.collisionBoxArray.length,Xi!==void 0?Xi+1:et.collisionBoxArray.length,ls||et.collisionBoxArray.length,ls?ls+1:et.collisionBoxArray.length,Pi,P_,B_,D_,k_,dx,0,Ip,zp,cs)})(i,je,lt,Ne,r,n,a,Re,i.layers[0],i.collisionBoxArray,e.index,e.sourceLayerIndex,i.index,ae,we,_,0,le,Me,F,e,c,x,A,w)};if(De==="line")for(const Ne of Vm(e.geometry,0,0,zt,zt)){const je=T0(Ne,oe,ce,r.vertical||U,n,24,ie,i.overscaling,zt);for(const Mt of je){const Ft=U;Ft&&P0(i,Ft.text,Pe,Mt)||Ze(Ne,Mt,w)}}else if(De==="line-center"){for(const Ne of e.geometry)if(Ne.length>1){const je=w0(Ne,ce,r.vertical||U,n,24,ie);je&&Ze(Ne,je,w)}}else if(e.type==="Polygon")for(const Ne of $d(e.geometry,0)){const je=S0(Ne,16);Ze(Ne[0],new Mo(je.x,je.y,0,0,void 0),w)}else if(e.type==="LineString")for(const Ne of e.geometry)Ze(Ne,new Mo(Ne[0].x,Ne[0].y,0,0,void 0),w);else if(e.type==="Point")for(const Ne of e.geometry)for(const je of Ne)Ze([je],new Mo(je.x,je.y,0,0,void 0),w)}const is=32640;function Hm(i,e,r,n,a,c,h,p,_,x,A,w,E,z,P,F,U){const q=function(ae,le,ce,we,Me,De,Pe,ve){const Ie=[];if(le.positionedLines.length===0)return Ie;const Re=we.layout.get("text-rotate").evaluate(De,{})*Math.PI/180,Ze=function(St){const Bt=St[0],lt=St[1],et=Bt*lt;return et>0?[Bt,-lt]:et<0?[-Bt,lt]:Bt===0?[lt,Bt]:[lt,-Bt]}(ce);let Ne=Math.abs(le.top-le.bottom);for(const St of le.positionedLines)Ne-=St.lineOffset;const je=le.positionedLines.length,Mt=Ne/je;let Ft=le.top-ce[1];for(let St=0;St<je;++St){const Bt=le.positionedLines[St];Ft=E0(le,Mt,Ft,St);for(const lt of Bt.positionedGlyphs){if(!lt.rect)continue;const et=lt.rect||{};let Vt=4,ri=!0,Gi=1,yi=0;if(lt.imageName){const xi=Pe[lt.imageName];if(!xi)continue;if(xi.sdf){Ot("SDF images are not supported in formatted text and will be ignored.");continue}ri=!1,Gi=xi.pixelRatio,Vt=1/Gi}const ji=(Me||ve)&&lt.vertical,ni=lt.metrics.advance*lt.scale/2,jt=lt.metrics,pi=lt.rect;if(pi===null)continue;ve&&le.verticalizable&&(yi=lt.imageName?ni-lt.metrics.width*lt.scale/2:0);const Ii=Me?[lt.x+ni,lt.y]:[0,0];let Pi=[0,0],Zi=[0,0],Hi=!1;Me||(ji?(Zi=[lt.x+ni+Ze[0],lt.y+Ze[1]-yi],Hi=!0):Pi=[lt.x+ni+ce[0],lt.y+ce[1]-yi]);const Hr=pi.w*lt.scale/(Gi*(lt.localGlyph?2:1)),Pr=pi.h*lt.scale/(Gi*(lt.localGlyph?2:1));let fi,Ar,Yr,tr;if(ji){const xi=lt.y-Ft,Br=new J(-ni,ni-xi),br=-Math.PI/2,Ni=new J(...Zi);fi=new J(-ni+Pi[0],Pi[1]),fi._rotateAround(br,Br)._add(Ni),fi.x+=-xi+ni,fi.y-=(jt.left-Vt)*lt.scale;const wr=lt.imageName?jt.advance*lt.scale:ar*lt.scale,pr=String.fromCharCode(lt.glyph);s0(pr)?fi.x+=(1-Vt)*lt.scale:a0(pr)?fi.x+=wr-jt.height*lt.scale+(-Vt-1)*lt.scale:fi.x+=lt.imageName||jt.width+2*Vt===pi.w&&jt.height+2*Vt===pi.h?(wr-Pr)/2:(wr-(jt.height+2*Vt)*lt.scale)/2,Ar=new J(fi.x,fi.y-Hr),Yr=new J(fi.x+Pr,fi.y),tr=new J(fi.x+Pr,fi.y-Hr)}else{const xi=(jt.left-Vt)*lt.scale-ni+Pi[0],Br=(-jt.top-Vt)*lt.scale+Pi[1],br=xi+Hr,Ni=Br+Pr;fi=new J(xi,Br),Ar=new J(br,Br),Yr=new J(xi,Ni),tr=new J(br,Ni)}if(Re){let xi;xi=Me?new J(0,0):Hi?new J(Ze[0],Ze[1]):new J(ce[0],ce[1]),fi._rotateAround(Re,xi),Ar._rotateAround(Re,xi),Yr._rotateAround(Re,xi),tr._rotateAround(Re,xi)}const Yi=new J(0,0),bi=new J(0,0);Ie.push({tl:fi,tr:Ar,bl:Yr,br:tr,tex:et,writingMode:le.writingMode,glyphOffset:Ii,sectionIndex:lt.sectionIndex,isSDF:ri,pixelOffsetTL:Yi,pixelOffsetBR:bi,minFontScaleX:0,minFontScaleY:0})}}return Ie}(0,n,_,c,h,p,a,i.allowVerticalPlacement),ie=i.textSizeData;let oe=null;ie.kind==="source"?(oe=[Hn*c.layout.get("text-size").evaluate(p,{},U)],oe[0]>is&&Ot(`${i.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):ie.kind==="composite"&&(oe=[Hn*P.compositeTextSizes[0].evaluate(p,{},U),Hn*P.compositeTextSizes[1].evaluate(p,{},U)],(oe[0]>is||oe[1]>is)&&Ot(`${i.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),i.addSymbols(i.text,q,oe,_,h,p,A,e,r,x.lineStartIndex,x.lineLength,z,F,U);for(const ae of w)E[ae]=i.text.placedSymbolArray.length-1;return 4*q.length}function Ym(i){for(const e in i)return i[e];return null}function Eh(i,e,r,n,a,c,h,p,_,x){let A=h.top,w=h.bottom,E=h.left,z=h.right;const P=h.collisionPadding;if(P&&(E-=P[0],A-=P[1],z+=P[2],w+=P[3]),_){const F=new J(E,A),U=new J(z,A),q=new J(E,w),ie=new J(z,w),oe=We(_);let ae=new J(0,0);x&&(ae=new J(x[0],x[1])),F._rotateAround(oe,ae),U._rotateAround(oe,ae),q._rotateAround(oe,ae),ie._rotateAround(oe,ae),E=Math.min(F.x,U.x,q.x,ie.x),z=Math.max(F.x,U.x,q.x,ie.x),A=Math.min(F.y,U.y,q.y,ie.y),w=Math.max(F.y,U.y,q.y,ie.y)}return i.emplaceBack(e.x,e.y,e.z,r.x,r.y,E,A,z,w,p,n,a,c),i.length-1}function hp(i){i.collisionPadding&&(i.top-=i.collisionPadding[1],i.bottom+=i.collisionPadding[3]);const e=i.bottom-i.top;return e>0?Math.max(10,e):null}function P0(i,e,r,n){const a=i.compareText;if(e in a){const c=a[e];for(let h=c.length-1;h>=0;h--)if(n.dist(c[h])<r)return!0}else a[e]=[];return a[e].push(n),!1}const B0=Js.VectorTileFeature.types,L0=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Ch(i,e,r,n,a,c,h,p,_,x,A,w,E,z,P,F){const U=A?Math.min(is,Math.round(A[0])):0,q=A?Math.min(is,Math.round(A[1])):0;i.emplaceBack(e,r,Math.round(32*h),Math.round(32*p),_,x,(U<<1)+(w?1:0),q,16*E,16*z,256*P,256*F,n,a,c,0)}function dp(i,e,r){i.emplaceBack(e.x,e.y,r),i.emplaceBack(e.x,e.y,r),i.emplaceBack(e.x,e.y,r),i.emplaceBack(e.x,e.y,r)}function R0(i){for(const e of i.sections)if(Md(e.text))return!0;return!1}class pp{constructor(e){this.layoutVertexArray=new Ce,this.indexArray=new be,this.programConfigurations=e,this.segments=new ki,this.dynamicLayoutVertexArray=new re,this.opacityVertexArray=new Ge,this.placedSymbolArray=new Mn}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,r,n,a){this.isEmpty()||(n&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,J1.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,r),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,e0.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,L0,!0),this.opacityVertexBuffer.itemSize=1),(n||a)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}tt(pp);class fp{constructor(e,r,n){this.layoutVertexArray=new e,this.layoutAttributes=r,this.indexArray=new n,this.segments=new ki,this.collisionVertexArray=new st,this.collisionVertexArrayExt=new re}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,t0.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,i0.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}tt(fp);class rs{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(h=>h.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Wn([]),this.placementViewportMatrix=Wn([]);const r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=tp(this.zoom,r["text-size"]),this.iconSizeData=tp(this.zoom,r["icon-size"]);const n=this.layers[0].layout,a=n.get("symbol-sort-key"),c=n.get("symbol-z-order");this.canOverlap=n.get("text-allow-overlap")||n.get("icon-allow-overlap")||n.get("text-ignore-placement")||n.get("icon-ignore-placement"),this.sortFeaturesByKey=c!=="viewport-y"&&a.constantOr(1)!==void 0,this.sortFeaturesByY=(c==="viewport-y"||c==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=n.get("text-writing-mode").map(h=>ln[h]),this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id),this.sourceID=e.sourceID,this.projection=e.projection}createArrays(){this.text=new pp(new Xs(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new pp(new Xs(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new ii,this.lineVertexArray=new Fi,this.symbolInstances=new Di}calculateGlyphDependencies(e,r,n,a,c){for(let h=0;h<e.length;h++)if(r[e.charCodeAt(h)]=!0,a&&c){const p=kc[e.charAt(h)];p&&(r[p.charCodeAt(0)]=!0)}}populate(e,r,n,a){const c=this.layers[0],h=c.layout,p=h.get("text-font"),_=h.get("text-field"),x=h.get("icon-image"),A=(_.value.kind!=="constant"||_.value.value instanceof Vi&&!_.value.value.isEmpty()||_.value.value.toString().length>0)&&(p.value.kind!=="constant"||p.value.value.length>0),w=x.value.kind!=="constant"||!!x.value.value||Object.keys(x.parameters).length>0,E=h.get("symbol-sort-key");if(this.features=[],!A&&!w)return;const z=r.iconDependencies,P=r.glyphDependencies,F=r.availableImages,U=new gi(this.zoom);for(const{feature:q,id:ie,index:oe,sourceLayerIndex:ae}of e){const le=c._featureFilter.needGeometry,ce=Qs(q,le);if(!c._featureFilter.filter(U,ce,n))continue;let we,Me;if(le||(ce.geometry=To(q,n,a)),A){const Pe=c.getValueAndResolveTokens("text-field",ce,n,F),ve=Vi.factory(Pe);R0(ve)&&(this.hasRTLText=!0),(!this.hasRTLText||Ya()==="unavailable"||this.hasRTLText&&Vr.isParsed())&&(we=o0(ve,c,ce))}if(w){const Pe=c.getValueAndResolveTokens("icon-image",ce,n,F);Me=Pe instanceof Er?Pe:Er.fromString(Pe)}if(!we&&!Me)continue;const De=this.sortFeaturesByKey?E.evaluate(ce,{},n):void 0;if(this.features.push({id:ie,text:we,icon:Me,index:oe,sourceLayerIndex:ae,geometry:ce.geometry,properties:q.properties,type:B0[q.type],sortKey:De}),Me&&(z[Me.name]=!0),we){const Pe=p.evaluate(ce,{},n).join(","),ve=h.get("text-rotation-alignment")==="map"&&h.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(ln.vertical)>=0;for(const Ie of we.sections)if(Ie.image)z[Ie.image.name]=!0;else{const Re=Za(we.toString()),Ze=Ie.fontStack||Pe,Ne=P[Ze]=P[Ze]||{};this.calculateGlyphDependencies(Ie.text,Ne,ve,this.allowVerticalPlacement,Re)}}}h.get("symbol-placement")==="line"&&(this.features=function(q){const ie={},oe={},ae=[];let le=0;function ce(Pe){ae.push(q[Pe]),le++}function we(Pe,ve,Ie){const Re=oe[Pe];return delete oe[Pe],oe[ve]=Re,ae[Re].geometry[0].pop(),ae[Re].geometry[0]=ae[Re].geometry[0].concat(Ie[0]),Re}function Me(Pe,ve,Ie){const Re=ie[ve];return delete ie[ve],ie[Pe]=Re,ae[Re].geometry[0].shift(),ae[Re].geometry[0]=Ie[0].concat(ae[Re].geometry[0]),Re}function De(Pe,ve,Ie){const Re=Ie?ve[0][ve[0].length-1]:ve[0][0];return`${Pe}:${Re.x}:${Re.y}`}for(let Pe=0;Pe<q.length;Pe++){const ve=q[Pe],Ie=ve.geometry,Re=ve.text?ve.text.toString():null;if(!Re){ce(Pe);continue}const Ze=De(Re,Ie),Ne=De(Re,Ie,!0);if(Ze in oe&&Ne in ie&&oe[Ze]!==ie[Ne]){const je=Me(Ze,Ne,Ie),Mt=we(Ze,Ne,ae[je].geometry);delete ie[Ze],delete oe[Ne],oe[De(Re,ae[Mt].geometry,!0)]=Mt,ae[je].geometry=null}else Ze in oe?we(Ze,Ne,Ie):Ne in ie?Me(Ze,Ne,Ie):(ce(Pe),ie[Ze]=le-1,oe[Ne]=le-1)}return ae.filter(Pe=>Pe.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((q,ie)=>q.sortKey-ie.sortKey)}update(e,r,n,a){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,r,this.layers,n,a),this.icon.programConfigurations.updatePaintArrays(e,r,this.layers,n,a))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,r){const n=this.lineVertexArray.length,a=e.segment;if(a!==void 0){let c=e.dist(r[a+1]),h=e.dist(r[a]);const p={};for(let _=a+1;_<r.length;_++)p[_]={x:r[_].x,y:r[_].y,tileUnitDistanceFromAnchor:c},_<r.length-1&&(c+=r[_+1].dist(r[_]));for(let _=a||0;_>=0;_--)p[_]={x:r[_].x,y:r[_].y,tileUnitDistanceFromAnchor:h},_>0&&(h+=r[_-1].dist(r[_]));for(let _=0;_<r.length;_++){const x=p[_];this.lineVertexArray.emplaceBack(x.x,x.y,x.tileUnitDistanceFromAnchor)}}return{lineStartIndex:n,lineLength:this.lineVertexArray.length-n}}addSymbols(e,r,n,a,c,h,p,_,x,A,w,E,z,P){const F=e.indexArray,U=e.layoutVertexArray,q=e.segments.prepareSegment(4*r.length,U,F,this.canOverlap?h.sortKey:void 0),ie=this.glyphOffsetArray.length,oe=q.vertexLength,ae=this.allowVerticalPlacement&&p===ln.vertical?Math.PI/2:0,le=h.text&&h.text.sections;for(let ce=0;ce<r.length;ce++){const{tl:we,tr:Me,bl:De,br:Pe,tex:ve,pixelOffsetTL:Ie,pixelOffsetBR:Re,minFontScaleX:Ze,minFontScaleY:Ne,glyphOffset:je,isSDF:Mt,sectionIndex:Ft}=r[ce],St=q.vertexLength,Bt=je[1];Ch(U,_.x,_.y,_.z,x.x,x.y,we.x,Bt+we.y,ve.x,ve.y,n,Mt,Ie.x,Ie.y,Ze,Ne),Ch(U,_.x,_.y,_.z,x.x,x.y,Me.x,Bt+Me.y,ve.x+ve.w,ve.y,n,Mt,Re.x,Ie.y,Ze,Ne),Ch(U,_.x,_.y,_.z,x.x,x.y,De.x,Bt+De.y,ve.x,ve.y+ve.h,n,Mt,Ie.x,Re.y,Ze,Ne),Ch(U,_.x,_.y,_.z,x.x,x.y,Pe.x,Bt+Pe.y,ve.x+ve.w,ve.y+ve.h,n,Mt,Re.x,Re.y,Ze,Ne),dp(e.dynamicLayoutVertexArray,_,ae),F.emplaceBack(St,St+1,St+2),F.emplaceBack(St+1,St+2,St+3),q.vertexLength+=4,q.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(je[0]),ce!==r.length-1&&Ft===r[ce+1].sectionIndex||e.programConfigurations.populatePaintArrays(U.length,h,h.index,{},z,P,le&&le[Ft])}e.placedSymbolArray.emplaceBack(_.x,_.y,_.z,x.x,x.y,ie,this.glyphOffsetArray.length-ie,oe,A,w,x.segment,n?n[0]:0,n?n[1]:0,a[0],a[1],p,0,!1,0,E,0)}_commitLayoutVertex(e,r,n,a,c,h,p){e.emplaceBack(r,n,a,c,h,Math.round(p.x),Math.round(p.y))}_addCollisionDebugVertices(e,r,n,a,c,h,p){const _=n.segments.prepareSegment(4,n.layoutVertexArray,n.indexArray),x=_.vertexLength,A=p.tileAnchorX,w=p.tileAnchorY;for(let z=0;z<4;z++)n.collisionVertexArray.emplaceBack(0,0,0,0);n.collisionVertexArrayExt.emplaceBack(r,-e.padding,-e.padding),n.collisionVertexArrayExt.emplaceBack(r,e.padding,-e.padding),n.collisionVertexArrayExt.emplaceBack(r,e.padding,e.padding),n.collisionVertexArrayExt.emplaceBack(r,-e.padding,e.padding),this._commitLayoutVertex(n.layoutVertexArray,a,c,h,A,w,new J(e.x1,e.y1)),this._commitLayoutVertex(n.layoutVertexArray,a,c,h,A,w,new J(e.x2,e.y1)),this._commitLayoutVertex(n.layoutVertexArray,a,c,h,A,w,new J(e.x2,e.y2)),this._commitLayoutVertex(n.layoutVertexArray,a,c,h,A,w,new J(e.x1,e.y2)),_.vertexLength+=4;const E=n.indexArray;E.emplaceBack(x,x+1),E.emplaceBack(x+1,x+2),E.emplaceBack(x+2,x+3),E.emplaceBack(x+3,x),_.primitiveLength+=4}_addTextDebugCollisionBoxes(e,r,n,a,c,h){for(let p=a;p<c;p++){const _=n.get(p),x=this.getSymbolInstanceTextSize(e,h,r,p);this._addCollisionDebugVertices(_,x,this.textCollisionBox,_.projectedAnchorX,_.projectedAnchorY,_.projectedAnchorZ,h)}}_addIconDebugCollisionBoxes(e,r,n,a,c,h){for(let p=a;p<c;p++){const _=n.get(p),x=this.getSymbolInstanceIconSize(e,r,p);this._addCollisionDebugVertices(_,x,this.iconCollisionBox,_.projectedAnchorX,_.projectedAnchorY,_.projectedAnchorZ,h)}}generateCollisionDebugBuffers(e,r){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new fp(Ue,bm.members,ct),this.iconCollisionBox=new fp(Ue,bm.members,ct);const n=nl(this.iconSizeData,e),a=nl(this.textSizeData,e);for(let c=0;c<this.symbolInstances.length;c++){const h=this.symbolInstances.get(c);this._addTextDebugCollisionBoxes(a,e,r,h.textBoxStartIndex,h.textBoxEndIndex,h),this._addTextDebugCollisionBoxes(a,e,r,h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h),this._addIconDebugCollisionBoxes(n,e,r,h.iconBoxStartIndex,h.iconBoxEndIndex,h),this._addIconDebugCollisionBoxes(n,e,r,h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex,h)}}getSymbolInstanceTextSize(e,r,n,a){const c=this.text.placedSymbolArray.get(r.rightJustifiedTextSymbolIndex>=0?r.rightJustifiedTextSymbolIndex:r.centerJustifiedTextSymbolIndex>=0?r.centerJustifiedTextSymbolIndex:r.leftJustifiedTextSymbolIndex>=0?r.leftJustifiedTextSymbolIndex:r.verticalPlacedTextSymbolIndex>=0?r.verticalPlacedTextSymbolIndex:a),h=xh(this.textSizeData,e,c)/ar;return this.tilePixelRatio*h}getSymbolInstanceIconSize(e,r,n){const a=this.icon.placedSymbolArray.get(n),c=xh(this.iconSizeData,e,a);return this.tilePixelRatio*c}_commitDebugCollisionVertexUpdate(e,r,n){e.emplaceBack(r,-n,-n),e.emplaceBack(r,n,-n),e.emplaceBack(r,n,n),e.emplaceBack(r,-n,n)}_updateTextDebugCollisionBoxes(e,r,n,a,c,h){for(let p=a;p<c;p++){const _=n.get(p),x=this.getSymbolInstanceTextSize(e,h,r,p);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,x,_.padding)}}_updateIconDebugCollisionBoxes(e,r,n,a,c){for(let h=a;h<c;h++){const p=n.get(h),_=this.getSymbolInstanceIconSize(e,r,h);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,_,p.padding)}}updateCollisionDebugBuffers(e,r){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const n=nl(this.iconSizeData,e),a=nl(this.textSizeData,e);for(let c=0;c<this.symbolInstances.length;c++){const h=this.symbolInstances.get(c);this._updateTextDebugCollisionBoxes(a,e,r,h.textBoxStartIndex,h.textBoxEndIndex,h),this._updateTextDebugCollisionBoxes(a,e,r,h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h),this._updateIconDebugCollisionBoxes(n,e,r,h.iconBoxStartIndex,h.iconBoxEndIndex),this._updateIconDebugCollisionBoxes(n,e,r,h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,r,n,a,c,h,p,_,x){const A={};for(let w=r;w<n;w++){const E=e.get(w);A.textBox={x1:E.x1,y1:E.y1,x2:E.x2,y2:E.y2,padding:E.padding,projectedAnchorX:E.projectedAnchorX,projectedAnchorY:E.projectedAnchorY,projectedAnchorZ:E.projectedAnchorZ,tileAnchorX:E.tileAnchorX,tileAnchorY:E.tileAnchorY},A.textFeatureIndex=E.featureIndex;break}for(let w=a;w<c;w++){const E=e.get(w);A.verticalTextBox={x1:E.x1,y1:E.y1,x2:E.x2,y2:E.y2,padding:E.padding,projectedAnchorX:E.projectedAnchorX,projectedAnchorY:E.projectedAnchorY,projectedAnchorZ:E.projectedAnchorZ,tileAnchorX:E.tileAnchorX,tileAnchorY:E.tileAnchorY},A.verticalTextFeatureIndex=E.featureIndex;break}for(let w=h;w<p;w++){const E=e.get(w);A.iconBox={x1:E.x1,y1:E.y1,x2:E.x2,y2:E.y2,padding:E.padding,projectedAnchorX:E.projectedAnchorX,projectedAnchorY:E.projectedAnchorY,projectedAnchorZ:E.projectedAnchorZ,tileAnchorX:E.tileAnchorX,tileAnchorY:E.tileAnchorY},A.iconFeatureIndex=E.featureIndex;break}for(let w=_;w<x;w++){const E=e.get(w);A.verticalIconBox={x1:E.x1,y1:E.y1,x2:E.x2,y2:E.y2,padding:E.padding,projectedAnchorX:E.projectedAnchorX,projectedAnchorY:E.projectedAnchorY,projectedAnchorZ:E.projectedAnchorZ,tileAnchorX:E.tileAnchorX,tileAnchorY:E.tileAnchorY},A.verticalIconFeatureIndex=E.featureIndex;break}return A}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let r=0;r<this.symbolInstances.length;r++){const n=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,n.textBoxStartIndex,n.textBoxEndIndex,n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n.iconBoxStartIndex,n.iconBoxEndIndex,n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,r){const n=e.placedSymbolArray.get(r),a=n.vertexStartIndex+4*n.numGlyphs;for(let c=n.vertexStartIndex;c<a;c+=4)e.indexArray.emplaceBack(c,c+1,c+2),e.indexArray.emplaceBack(c+1,c+2,c+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const r=Math.sin(e),n=Math.cos(e),a=[],c=[],h=[];for(let p=0;p<this.symbolInstances.length;++p){h.push(p);const _=this.symbolInstances.get(p);a.push(0|Math.round(r*_.tileAnchorX+n*_.tileAnchorY)),c.push(_.featureIndex)}return h.sort((p,_)=>a[p]-a[_]||c[_]-c[p]),h}addToSortKeyRanges(e,r){const n=this.sortKeyRanges[this.sortKeyRanges.length-1];n&&n.sortKey===r?n.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:r,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const r of this.symbolInstanceIndexes){const n=this.symbolInstances.get(r);this.featureSortOrder.push(n.featureIndex),[n.rightJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.leftJustifiedTextSymbolIndex].forEach((a,c,h)=>{a>=0&&h.indexOf(a)===c&&this.addIndicesForPlacedSymbol(this.text,a)}),n.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,n.verticalPlacedTextSymbolIndex),n.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,n.placedIconSymbolIndex),n.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,n.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}tt(rs,{omit:["layers","collisionBoxArray","features","compareText"]}),rs.MAX_GLYPHS=65535,rs.addDynamicAttributes=dp;const F0=new k({"symbol-placement":new g(xe.layout_symbol["symbol-placement"]),"symbol-spacing":new g(xe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new g(xe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new v(xe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new g(xe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new g(xe.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new g(xe.layout_symbol["icon-ignore-placement"]),"icon-optional":new g(xe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new g(xe.layout_symbol["icon-rotation-alignment"]),"icon-size":new v(xe.layout_symbol["icon-size"]),"icon-text-fit":new g(xe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new g(xe.layout_symbol["icon-text-fit-padding"]),"icon-image":new v(xe.layout_symbol["icon-image"]),"icon-rotate":new v(xe.layout_symbol["icon-rotate"]),"icon-padding":new g(xe.layout_symbol["icon-padding"]),"icon-keep-upright":new g(xe.layout_symbol["icon-keep-upright"]),"icon-offset":new v(xe.layout_symbol["icon-offset"]),"icon-anchor":new v(xe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new g(xe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new g(xe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new g(xe.layout_symbol["text-rotation-alignment"]),"text-field":new v(xe.layout_symbol["text-field"]),"text-font":new v(xe.layout_symbol["text-font"]),"text-size":new v(xe.layout_symbol["text-size"]),"text-max-width":new v(xe.layout_symbol["text-max-width"]),"text-line-height":new v(xe.layout_symbol["text-line-height"]),"text-letter-spacing":new v(xe.layout_symbol["text-letter-spacing"]),"text-justify":new v(xe.layout_symbol["text-justify"]),"text-radial-offset":new v(xe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new g(xe.layout_symbol["text-variable-anchor"]),"text-anchor":new v(xe.layout_symbol["text-anchor"]),"text-max-angle":new g(xe.layout_symbol["text-max-angle"]),"text-writing-mode":new g(xe.layout_symbol["text-writing-mode"]),"text-rotate":new v(xe.layout_symbol["text-rotate"]),"text-padding":new g(xe.layout_symbol["text-padding"]),"text-keep-upright":new g(xe.layout_symbol["text-keep-upright"]),"text-transform":new v(xe.layout_symbol["text-transform"]),"text-offset":new v(xe.layout_symbol["text-offset"]),"text-allow-overlap":new g(xe.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new g(xe.layout_symbol["text-ignore-placement"]),"text-optional":new g(xe.layout_symbol["text-optional"])});var mp={paint:new k({"icon-opacity":new v(xe.paint_symbol["icon-opacity"]),"icon-color":new v(xe.paint_symbol["icon-color"]),"icon-halo-color":new v(xe.paint_symbol["icon-halo-color"]),"icon-halo-width":new v(xe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new v(xe.paint_symbol["icon-halo-blur"]),"icon-translate":new g(xe.paint_symbol["icon-translate"]),"icon-translate-anchor":new g(xe.paint_symbol["icon-translate-anchor"]),"text-opacity":new v(xe.paint_symbol["text-opacity"]),"text-color":new v(xe.paint_symbol["text-color"],{runtimeType:pn,getOverride:i=>i.textColor,hasOverride:i=>!!i.textColor}),"text-halo-color":new v(xe.paint_symbol["text-halo-color"]),"text-halo-width":new v(xe.paint_symbol["text-halo-width"]),"text-halo-blur":new v(xe.paint_symbol["text-halo-blur"]),"text-translate":new g(xe.paint_symbol["text-translate"]),"text-translate-anchor":new g(xe.paint_symbol["text-translate-anchor"])}),layout:F0};class Xm{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:vn,this.defaultValue=e}evaluate(e){if(e.formattedSection){const r=this.defaultValue.property.overrides;if(r&&r.hasOverride(e.formattedSection))return r.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}tt(Xm,{omit:["defaultValue"]});class Mh extends In{constructor(e){super(e,mp)}recalculate(e,r){super.recalculate(e,r),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const n=this.layout.get("text-writing-mode");if(n){const a=[];for(const c of n)a.indexOf(c)<0&&a.push(c);this.layout._values["text-writing-mode"]=a}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,r,n,a){const c=this.layout.get(e).evaluate(r,{},n,a),h=this._unevaluatedLayout._values[e];return h.isDataDriven()||Zo(h.value)||!c?c:function(p,_){return _.replace(/{([^{}]+)}/g,(x,A)=>A in p?String(p[A]):"")}(r.properties,c)}createBucket(e){return new rs(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of mp.paint.overridableProperties){if(!Mh.hasPaintOverride(this.layout,e))continue;const r=this.paint.get(e),n=new Xm(r),a=new Ba(n,r.property.specification);let c=null;c=r.value.kind==="constant"||r.value.kind==="source"?new Xl("source",a):new Ql("composite",a,r.value.zoomStops,r.value._interpolationType),this.paint._values[e]=new f(r.property,c,r.parameters)}}_handleOverridablePaintPropertyUpdate(e,r,n){return!(!this.layout||r.isDataDriven()||n.isDataDriven())&&Mh.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,r){const n=e.get("text-field"),a=mp.paint.properties[r];let c=!1;const h=p=>{for(const _ of p)if(a.overrides&&a.overrides.hasOverride(_))return void(c=!0)};if(n.value.kind==="constant"&&n.value.value instanceof Vi)h(n.value.value.sections);else if(n.value.kind==="source"){const p=x=>{c||(x instanceof bn&&Ri(x.value)===Ro?h(x.value.sections):x instanceof No?h(x.sections):x.eachChild(p))},_=n.value;_._styleExpression&&p(_._styleExpression.expression)}return c}getProgramConfiguration(e){return new $o(this,e)}}var O0={paint:new k({"background-color":new g(xe.paint_background["background-color"]),"background-pattern":new C(xe.paint_background["background-pattern"]),"background-opacity":new g(xe.paint_background["background-opacity"])})},N0={paint:new k({"raster-opacity":new g(xe.paint_raster["raster-opacity"]),"raster-hue-rotate":new g(xe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new g(xe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new g(xe.paint_raster["raster-brightness-max"]),"raster-saturation":new g(xe.paint_raster["raster-saturation"]),"raster-contrast":new g(xe.paint_raster["raster-contrast"]),"raster-resampling":new g(xe.paint_raster["raster-resampling"]),"raster-fade-duration":new g(xe.paint_raster["raster-fade-duration"])})};class U0 extends In{constructor(e){super(e,{}),this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}var V0={paint:new k({"sky-type":new g(xe.paint_sky["sky-type"]),"sky-atmosphere-sun":new g(xe.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new g(xe.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new g(xe.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new g(xe.paint_sky["sky-gradient-radius"]),"sky-gradient":new S(xe.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new g(xe.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new g(xe.paint_sky["sky-atmosphere-color"]),"sky-opacity":new g(xe.paint_sky["sky-opacity"])})};function _p(i,e,r){const n=[0,0,1],a=tm([]);return function(c,h,p){p*=.5;var _=h[0],x=h[1],A=h[2],w=h[3],E=Math.sin(p),z=Math.cos(p);c[0]=_*z-A*E,c[1]=x*z+w*E,c[2]=A*z+_*E,c[3]=w*z-x*E}(a,a,r?-We(i)+Math.PI:We(i)),im(a,a,-We(e)),Jf(n,n,a),Ac(n,n)}const G0={circle:class extends In{constructor(i){super(i,a1)}createBucket(i){return new Ld(i)}queryRadius(i){const e=i;return Ja("circle-radius",this,e)+Ja("circle-stroke-width",this,e)+uh(this.paint.get("circle-translate"))}queryIntersectsFeature(i,e,r,n,a,c,h,p){const _=qf(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),c.angle,i.pixelToTileUnitsFactor),x=this.paint.get("circle-radius").evaluate(e,r)+this.paint.get("circle-stroke-width").evaluate(e,r);return rm(i,n,c,h,p,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",_,x)}getProgramIds(){return["circle"]}getProgramConfiguration(i){return new $o(this,i)}},heatmap:class extends In{createBucket(i){return new om(i)}constructor(i){super(i,f1),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){i==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Yd({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(i){return Ja("heatmap-radius",this,i)}queryIntersectsFeature(i,e,r,n,a,c,h,p){const _=this.paint.get("heatmap-radius").evaluate(e,r);return rm(i,n,c,h,p,!0,!0,new J(0,0),_)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(i){return new $o(this,i)}},hillshade:class extends In{constructor(i){super(i,m1)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends In{constructor(i){super(i,k1)}getProgramIds(){const i=this.paint.get("fill-pattern"),e=i&&i.constantOr(1),r=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&r.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),r}getProgramConfiguration(i){return new $o(this,i)}recalculate(i,e){super.recalculate(i,e);const r=this.paint._values["fill-outline-color"];r.value.kind==="constant"&&r.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(i){return new _h(i)}queryRadius(){return uh(this.paint.get("fill-translate"))}queryIntersectsFeature(i,e,r,n,a,c){return!i.queryGeometry.isAboveHorizon&&Uf(Zf(i.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),c.angle,i.pixelToTileUnitsFactor),n)}isTileClipped(){return!0}},"fill-extrusion":class extends In{constructor(i){super(i,Z1)}createBucket(i){return new zc(i)}queryRadius(){return uh(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(i){return new $o(this,i)}queryIntersectsFeature(i,e,r,n,a,c,h,p,_){const x=qf(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),c.angle,i.pixelToTileUnitsFactor),A=this.paint.get("fill-extrusion-height").evaluate(e,r),w=this.paint.get("fill-extrusion-base").evaluate(e,r),E=[0,0],z=p&&c.elevation,P=c.elevation?c.elevation.exaggeration():1,F=i.tile.getBucket(this);if(z&&F instanceof zc){const ie=F.centroidVertexArray,oe=_+1;if(oe<ie.length){const ae=ie.get(oe);E[0]=ae.a_centroid_pos0,E[1]=ae.a_centroid_pos1}}if(E[0]===0&&E[1]===1)return!1;const U=function(ie,oe,ae,le,ce,we,Me,De,Pe){return we?function(ve,Ie,Re,Ze,Ne,je,Mt,Ft,St){const Bt=[],lt=[],et=[0,0,0,1];for(const Vt of ve){const ri=[],Gi=[];for(const yi of Vt){const ji=yi.x+Ze.x,ni=yi.y+Ze.y,jt=q1(ji,ni,Ie,Re,je,Mt,Ft,St);et[0]=ji,et[1]=ni,et[2]=jt.base,et[3]=1,tl(et,et,Ne),et[3]=Math.max(et[3],1e-5);const pi=ym([et[0]/et[3],et[1]/et[3],et[2]/et[3]]);et[0]=ji,et[1]=ni,et[2]=jt.top,et[3]=1,tl(et,et,Ne),et[3]=Math.max(et[3],1e-5);const Ii=ym([et[0]/et[3],et[1]/et[3],et[2]/et[3]]);ri.push(pi),Gi.push(Ii)}Bt.push(ri),lt.push(Gi)}return[Bt,lt]}(ie,oe,ae,le,ce,we,Me,De,Pe):function(ve,Ie,Re,Ze,Ne){const je=[],Mt=[],Ft=Ne[8]*Ie,St=Ne[9]*Ie,Bt=Ne[10]*Ie,lt=Ne[11]*Ie,et=Ne[8]*Re,Vt=Ne[9]*Re,ri=Ne[10]*Re,Gi=Ne[11]*Re;for(const yi of ve){const ji=[],ni=[];for(const jt of yi){const pi=jt.x+Ze.x,Ii=jt.y+Ze.y,Pi=Ne[0]*pi+Ne[4]*Ii+Ne[12],Zi=Ne[1]*pi+Ne[5]*Ii+Ne[13],Hi=Ne[2]*pi+Ne[6]*Ii+Ne[14],Hr=Ne[3]*pi+Ne[7]*Ii+Ne[15],Pr=Pi+Ft,fi=Zi+St,Ar=Hi+Bt,Yr=Math.max(Hr+lt,1e-5),tr=Pi+et,Yi=Zi+Vt,bi=Hi+ri,xi=Math.max(Hr+Gi,1e-5),Br=new J(Pr/Yr,fi/Yr);Br.z=Ar/Yr,ji.push(Br);const br=new J(tr/xi,Yi/xi);br.z=bi/xi,ni.push(br)}je.push(ji),Mt.push(ni)}return[je,Mt]}(ie,oe,ae,le,ce)}(n,w,A,x,h,z?p:null,E,P,c.center.lat),q=i.queryGeometry;return function(ie,oe,ae){let le=1/0;Uf(ae,oe)&&(le=gm(ae,oe[0]));for(let ce=0;ce<oe.length;ce++){const we=oe[ce],Me=ie[ce];for(let De=0;De<we.length-1;De++){const Pe=we[De],ve=[Pe,we[De+1],Me[De+1],Me[De],Pe];Nf(ae,ve)&&(le=Math.min(le,gm(ae,ve)))}}return le!==1/0&&le}(U[0],U[1],q.isPointQuery()?q.screenBounds:q.screenGeometry)}},line:class extends In{constructor(i){super(i,xm),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(i){if(i==="line-gradient"){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof Ms,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(i,e){super.recalculate(i,e),this.paint._values["line-floorwidth"]=vm.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)}createBucket(i){return new yh(i)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(i){return new $o(this,i)}queryRadius(i){const e=i,r=Am(Ja("line-width",this,e),Ja("line-gap-width",this,e)),n=Ja("line-offset",this,e);return r/2+Math.abs(n)+uh(this.paint.get("line-translate"))}queryIntersectsFeature(i,e,r,n,a,c){if(i.queryGeometry.isAboveHorizon)return!1;const h=Zf(i.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),c.angle,i.pixelToTileUnitsFactor),p=i.pixelToTileUnitsFactor/2*Am(this.paint.get("line-width").evaluate(e,r),this.paint.get("line-gap-width").evaluate(e,r)),_=this.paint.get("line-offset").evaluate(e,r);return _&&(n=function(x,A){const w=[],E=new J(0,0);for(let z=0;z<x.length;z++){const P=x[z],F=[];for(let U=0;U<P.length;U++){const q=P[U-1],ie=P[U],oe=P[U+1],ae=U===0?E:ie.sub(q)._unit()._perp(),le=U===P.length-1?E:oe.sub(ie)._unit()._perp(),ce=ae._add(le)._unit();ce._mult(1/(ce.x*le.x+ce.y*le.y)),F.push(ce._mult(A)._add(ie))}w.push(F)}return w}(n,_*i.pixelToTileUnitsFactor)),function(x,A,w){for(let E=0;E<A.length;E++){const z=A[E];if(x.length>=3){for(let P=0;P<z.length;P++)if($a(x,z[P]))return!0}if(r1(x,z,w))return!0}return!1}(h,n,p)}isTileClipped(){return!0}},symbol:Mh,background:class extends In{constructor(i){super(i,O0)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends In{constructor(i){super(i,N0)}getProgramIds(){return["raster"]}},sky:class extends In{constructor(i){super(i,V0),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){i==="sky-gradient"?this._updateColorRamp():i!=="sky-atmosphere-sun"&&i!=="sky-atmosphere-halo-color"&&i!=="sky-atmosphere-color"&&i!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Yd({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(i){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=i.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}return!1}getCenter(i,e){if(this.paint.get("sky-type")==="atmosphere"){const n=this.paint.get("sky-atmosphere-sun"),a=!n,c=i.style.light,h=c.properties.get("position");return a&&c.properties.get("anchor")==="viewport"&&Ot("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),a?_p(h.azimuthal,90-h.polar,e):_p(n[0],90-n[1],e)}const r=this.paint.get("sky-gradient-center");return _p(r[0],90-r[1],e)}is3D(){return!1}isSky(){return!0}markSkyboxValid(i){this._skyboxInvalidated=!1,this._lightPosition=i.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const i=this.paint.get("sky-type");return i==="atmosphere"?["skyboxCapture","skybox"]:i==="gradient"?["skyboxGradient"]:null}}};class Rc{constructor(e,r,n,a){this.context=e,this.format=n,this.texture=e.gl.createTexture(),this.update(r,a)}update(e,r,n){const{width:a,height:c}=e,{context:h}=this,{gl:p}=h,{HTMLImageElement:_,HTMLCanvasElement:x,HTMLVideoElement:A,ImageData:w,ImageBitmap:E}=Ee;if(p.bindTexture(p.TEXTURE_2D,this.texture),h.pixelStoreUnpackFlipY.set(!1),h.pixelStoreUnpack.set(1),h.pixelStoreUnpackPremultiplyAlpha.set(this.format===p.RGBA&&(!r||r.premultiply!==!1)),n||this.size&&this.size[0]===a&&this.size[1]===c){const{x:z,y:P}=n||{x:0,y:0};e instanceof _||e instanceof x||e instanceof A||e instanceof w||E&&e instanceof E?p.texSubImage2D(p.TEXTURE_2D,0,z,P,p.RGBA,p.UNSIGNED_BYTE,e):p.texSubImage2D(p.TEXTURE_2D,0,z,P,a,c,p.RGBA,p.UNSIGNED_BYTE,e.data)}else this.size=[a,c],e instanceof _||e instanceof x||e instanceof A||e instanceof w||E&&e instanceof E?p.texImage2D(p.TEXTURE_2D,0,this.format,this.format,p.UNSIGNED_BYTE,e):p.texImage2D(p.TEXTURE_2D,0,this.format,a,c,0,this.format,p.UNSIGNED_BYTE,e.data);this.useMipmap=Boolean(r&&r.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&p.generateMipmap(p.TEXTURE_2D)}bind(e,r){const{context:n}=this,{gl:a}=n;a.bindTexture(a.TEXTURE_2D,this.texture),e!==this.filter&&(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,e),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,this.useMipmap?e===a.NEAREST?a.NEAREST_MIPMAP_NEAREST:a.LINEAR_MIPMAP_NEAREST:e),this.filter=e),r!==this.wrap&&(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,r),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,r),this.wrap=r)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class gp{constructor(e,r){this.width=e,this.height=r,this.nextRow=0,this.image=new Eo({width:e,height:r}),this.positions={},this.uploaded=!1}getDash(e,r){const n=this.getKey(e,r);return this.positions[n]}trim(){const e=this.width,r=this.height=en(this.nextRow);this.image.resize({width:e,height:r})}getKey(e,r){return e.join(",")+r}getDashRanges(e,r,n){const a=[];let c=e.length%2==1?-e[e.length-1]*n:0,h=e[0]*n,p=!0;a.push({left:c,right:h,isDash:p,zeroLength:e[0]===0});let _=e[0];for(let x=1;x<e.length;x++){p=!p;const A=e[x];c=_*n,_+=A,h=_*n,a.push({left:c,right:h,isDash:p,zeroLength:A===0})}return a}addRoundDash(e,r,n){const a=r/2;for(let c=-n;c<=n;c++){const h=this.width*(this.nextRow+n+c);let p=0,_=e[p];for(let x=0;x<this.width;x++){x/_.right>1&&(_=e[++p]);const A=Math.abs(x-_.left),w=Math.abs(x-_.right),E=Math.min(A,w);let z;const P=c/n*(a+1);if(_.isDash){const F=a-Math.abs(P);z=Math.sqrt(E*E+F*F)}else z=a-Math.sqrt(E*E+P*P);this.image.data[h+x]=Math.max(0,Math.min(255,z+128))}}}addRegularDash(e,r){for(let _=e.length-1;_>=0;--_){const x=e[_],A=e[_+1];x.zeroLength?e.splice(_,1):A&&A.isDash===x.isDash&&(A.left=x.left,e.splice(_,1))}const n=e[0],a=e[e.length-1];n.isDash===a.isDash&&(n.left=a.left-this.width,a.right=n.right+this.width);const c=this.width*this.nextRow;let h=0,p=e[h];for(let _=0;_<this.width;_++){_/p.right>1&&(p=e[++h]);const x=Math.abs(_-p.left),A=Math.abs(_-p.right),w=Math.min(x,A);this.image.data[c+_]=Math.max(0,Math.min(255,(p.isDash?w:-w)+r+128))}}addDash(e,r){const n=this.getKey(e,r);if(this.positions[n])return this.positions[n];const a=r==="round",c=a?7:0,h=2*c+1;if(this.nextRow+h>this.height)return Ot("LineAtlas out of space"),null;e.length===0&&e.push(1);let p=0;for(let A=0;A<e.length;A++)e[A]<0&&(Ot("Negative value is found in line dasharray, replacing values with 0"),e[A]=0),p+=e[A];if(p!==0){const A=this.width/p,w=this.getDashRanges(e,this.width,A);a?this.addRoundDash(w,A,c):this.addRegularDash(w,r==="square"?.5*A:0)}const _=this.nextRow+c;this.nextRow+=h;const x={tl:[_,c],br:[p,0]};return this.positions[n]=x,x}}tt(gp);class j0{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}const Z0=Ee.performance;function Qm(i){const e=i?i.url.toString():void 0;return Z0.getEntriesByName(e)}class q0{constructor(){this.tasks={},this.taskQueue=[],ci(["process"],this),this.invoker=new j0(this.process),this.nextId=0}add(e,r){const n=this.nextId++,a=function({type:c,isSymbolTile:h,zoom:p}){return p=p||0,c==="message"?0:c!=="maybePrepare"||h?c!=="parseTile"||h?c==="parseTile"&&h?300-p:c==="maybePrepare"&&h?400-p:500:200-p:100-p}(r);if(a===0){ht();try{e()}finally{}return{cancel:()=>{}}}return this.tasks[n]={fn:e,metadata:r,priority:a,id:n},this.taskQueue.push(n),this.invoker.trigger(),{cancel:()=>{delete this.tasks[n]}}}process(){ht();try{if(this.taskQueue=this.taskQueue.filter(n=>!!this.tasks[n]),!this.taskQueue.length)return;const e=this.pick();if(e===null)return;const r=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!r)return;r.fn()}finally{}}pick(){let e=null,r=1/0;for(let a=0;a<this.taskQueue.length;a++){const c=this.tasks[this.taskQueue[a]];c.priority<r&&(r=c.priority,e=a)}if(e===null)return null;const n=this.taskQueue[e];return this.taskQueue.splice(e,1),n}remove(){this.invoker.remove()}}const W0=Q([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_merc_pos",components:2},{type:"Float32",name:"a_uv",components:2}]),H0=Q([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:Km}=W0,$m=Q([{name:"a_pos_3",components:3,type:"Int16"}]);var Fc=Q([{name:"a_pos",type:"Int16",components:2}]);const ul=zt/Math.PI/2,qr=-ul,Wr=ul,Y0=[new an([qr,qr,qr],[Wr,Wr,Wr]),new an([qr,qr,qr],[0,0,Wr]),new an([0,qr,qr],[Wr,0,Wr]),new an([qr,0,qr],[0,Wr,Wr]),new an([0,0,qr],[Wr,Wr,Wr])];class X0{constructor(e,r,n){this.a=el([],e,n),this.b=el([],r,n),this.center=n;const a=Ac([],this.a),c=Ac([],this.b);this.angle=Math.acos(bc(a,c))}}function yp(i,e){if(i.angle===0)return null;let r;return r=i.a[e]===0?1/i.angle*.5*Math.PI:1/i.angle*Math.atan(i.b[e]/i.a[e]/Math.sin(i.angle)-1/Math.tan(i.angle)),r<0||r>1?null:function(n,a,c,h){const p=Math.sin(c);return n*(Math.sin((1-h)*c)/p)+a*(Math.sin(h*c)/p)}(i.a[e],i.b[e],i.angle,It(r,0,1))+i.center[e]}function Oc(i){if(i.z<=1)return Y0[i.z+2*i.y+i.x];const[e,r]=xp(i),n=[So(e[0],e[1]),So(e[0],r[1]),So(r[0],e[1]),So(r[0],r[1])],a=[Wr,Wr,Wr],c=[qr,qr,qr];for(const h of n)a[0]=Math.min(a[0],h[0]),a[1]=Math.min(a[1],h[1]),a[2]=Math.min(a[2],h[2]),c[0]=Math.max(c[0],h[0]),c[1]=Math.max(c[1],h[1]),c[2]=Math.max(c[2],h[2]);return new an(a,c)}function Q0(i,e,r){const n=e/i.worldSize,a=(Ie,Re)=>{vc(Ie,Ie,n),vc(Re,Re,n)},c=Number.MAX_VALUE,h=[-c,-c,-c],p=[c,c,c],_=r_(i);if(r.z<=1){const Ie=Oc(r).getCorners();for(let Re=0;Re<Ie.length;Re++)$s(Ie[Re],Ie[Re],_),jd(p,p,Ie[Re]),Zd(h,h,Ie[Re]);return a(p,h),new an(p,h)}const[x,A]=xp(r),w=new Jo;w.setSouthWest([x[1],A[0]]),w.setNorthEast([A[1],x[0]]);const E=[So(w.getSouth(),w.getWest()),So(w.getSouth(),w.getEast()),So(w.getNorth(),w.getEast()),So(w.getNorth(),w.getWest())];for(let Ie=0;Ie<E.length;Ie++)$s(E[Ie],E[Ie],_),jd(p,p,E[Ie]),Zd(h,h,E[Ie]);if(w.contains(i.center))return h[2]=0,a(p,h),new an(p,h);const z=[_[12],_[13],_[14]],P=i.center.lng,F=It(i.center.lat,-85.051129,qn),U=[yc(P),Qa(F)],q=w.getCenter().lng,ie=It(w.getCenter().lat,-85.051129,qn),oe=[yc(q),Qa(ie)];let ae=new Array(3),le=0;const ce=U[0]-oe[0],we=U[1]-oe[1];if(Math.abs(ce)>Math.abs(we))le=ce>=0?1:3,ae=z;else{le=we>=0?0:2;const Ie=[_[4],_[5],_[6]];let Re;Re=we>=0?-Math.sin(We(w.getSouth()))*ul:-Math.sin(We(w.getNorth()))*ul,ae=qd(ae,z,Ie,Re)}const Me=E[le],De=E[(le+1)%4],Pe=new X0(Me,De,ae),ve=[yp(Pe,0)||Me[0],yp(Pe,1)||Me[1],yp(Pe,2)||Me[2]];return p[2]=Math.min(Me[2],De[2]),jd(p,p,ve),Zd(h,h,ve),a(p,h),new an(p,h)}function xp(i){const e=1<<i.z,r=i.x/e,n=(i.x+1)/e,a=(i.y+1)/e;return[[sr(i.y/e),mn(r)],[sr(a),mn(n)]]}function Jm(i,e,r,n=ul){return r=We(r),[i*Math.sin(r)*n,-e*n,i*Math.cos(r)*n]}function So(i,e,r){return Jm(Math.cos(We(i)),Math.sin(We(i)),e,r)}function e_(i,e,r){const n=Math.pow(2,r.z),a=(i/zt+r.x)/n;return So(sr((e/zt+r.y)/n),mn(a))}function vp(i){return 16383/Math.max(...el([],i.max,i.min))}function t_(i){const e=Wn(new Float64Array(16)),r=vp(i);var n,a;return es(e,e,[r,r,r]),Ks(e,e,((n=[])[0]=-(a=i.min)[0],n[1]=-a[1],n[2]=-a[2],n)),e}function i_(i,e,r,n,a){const c=function(_){const x=zt/(2*Math.PI);return _/(2*Math.PI)/x}(r),h=[i,e,-r/(2*Math.PI)],p=Wn(new Float64Array(16));return Ks(p,p,h),es(p,p,[c,c,c]),Ud(p,p,We(-a)),Vd(p,p,We(-n)),p}function r_(i){const{x:e,y:r}=i.point,{lng:n,lat:a}=i._center;return i_(e,r,i.worldSize,n,a)}const n_=We(85),K0=Math.cos(n_),$0=Math.sin(n_);function o_(i,e,r){var n=2*Math.PI*6378137/256/Math.pow(2,r);return[i*n-2*Math.PI*6378137/2,e*n-2*Math.PI*6378137/2]}class Sh{constructor(e,r,n){this.z=e,this.x=r,this.y=n,this.key=Nc(0,e,e,r,n)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,r){const n=function(c,h,p){var _=o_(256*c,256*(h=Math.pow(2,p)-h-1),p),x=o_(256*(c+1),256*(h+1),p);return _[0]+","+_[1]+","+x[0]+","+x[1]}(this.x,this.y,this.z),a=function(c,h,p){let _,x="";for(let A=c;A>0;A--)_=1<<A-1,x+=(h&_?1:0)+(p&_?2:0);return x}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(r==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",a).replace("{bbox-epsg-3857}",n)}toString(){return`${this.z}/${this.x}/${this.y}`}}class s_{constructor(e,r){this.wrap=e,this.canonical=r,this.key=Nc(e,r.z,r.z,r.x,r.y)}}class vr{constructor(e,r,n,a,c){this.overscaledZ=e,this.wrap=r,this.canonical=new Sh(n,+a,+c),this.key=r===0&&e===n?this.canonical.key:Nc(r,e,n,a,c)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const r=this.canonical.z-e;return e>this.canonical.z?new vr(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new vr(e,this.wrap,e,this.canonical.x>>r,this.canonical.y>>r)}calculateScaledKey(e,r=!0){if(this.overscaledZ===e&&r)return this.key;if(e>this.canonical.z)return Nc(this.wrap*+r,e,this.canonical.z,this.canonical.x,this.canonical.y);{const n=this.canonical.z-e;return Nc(this.wrap*+r,e,e,this.canonical.x>>n,this.canonical.y>>n)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const r=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>r&&e.canonical.y===this.canonical.y>>r}children(e){if(this.overscaledZ>=e)return[new vr(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const r=this.canonical.z+1,n=2*this.canonical.x,a=2*this.canonical.y;return[new vr(r,this.wrap,r,n,a),new vr(r,this.wrap,r,n+1,a),new vr(r,this.wrap,r,n,a+1),new vr(r,this.wrap,r,n+1,a+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new vr(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new vr(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new s_(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Nc(i,e,r,n,a){const c=1<<Math.min(r,22);let h=c*(a%c)+n%c;return i&&r<22&&(h+=c*c*((i<0?-2*i-1:2*i)%(1<<2*(22-r)))),16*(32*h+r)+(e-r)}function ea(i,e){if(!e.isReprojectedInTileSpace)return{scale:1<<i.z,x:i.x,y:i.y,x2:i.x+1,y2:i.y+1,projection:e};const r=Math.pow(2,-i.z),n=i.x*r,a=(i.x+1)*r,c=i.y*r,h=(i.y+1)*r,p=mn(n),_=mn(a),x=sr(c),A=sr(h),w=e.project(p,x),E=e.project(_,x),z=e.project(_,A),P=e.project(p,A);let F=Math.min(w.x,E.x,z.x,P.x),U=Math.min(w.y,E.y,z.y,P.y),q=Math.max(w.x,E.x,z.x,P.x),ie=Math.max(w.y,E.y,z.y,P.y);const oe=r/16;function ae(ce,we,Me,De,Pe,ve){const Ie=(Me+Pe)/2,Re=(De+ve)/2,Ze=e.project(mn(Ie),sr(Re)),Ne=Math.max(0,F-Ze.x,U-Ze.y,Ze.x-q,Ze.y-ie);F=Math.min(F,Ze.x),q=Math.max(q,Ze.x),U=Math.min(U,Ze.y),ie=Math.max(ie,Ze.y),Ne>oe&&(ae(ce,Ze,Me,De,Ie,Re),ae(Ze,we,Ie,Re,Pe,ve))}ae(w,E,n,c,a,c),ae(E,z,a,c,a,h),ae(z,P,a,h,n,h),ae(P,w,n,h,n,c),F-=oe,U-=oe,q+=oe,ie+=oe;const le=1/Math.max(q-F,ie-U);return{scale:le,x:F*le,y:U*le,x2:q*le,y2:ie*le,projection:e}}tt(Sh),tt(vr,{omit:["projMatrix"]});class a_{constructor(e){this._stringToNumber={},this._numberToString=[];for(let r=0;r<e.length;r++){const n=e[r];this._stringToNumber[n]=r,this._numberToString[r]=n}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}const J0=["tile","layer","source","sourceLayer","state"];class l_{constructor(e,r,n,a,c){this.type="Feature",this._vectorTileFeature=e,this._z=r,this._x=n,this._y=a,this.properties=e.properties,this.id=c}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={type:"Feature",geometry:this.geometry,properties:this.properties};this.id!==void 0&&(e.id=this.id);for(const r of J0)this[r]!==void 0&&(e[r]=this[r]);return e}}const _n=32,Yn=33,ns=new Uint16Array(8184);for(let i=0;i<2046;i++){let e=i+2,r=0,n=0,a=0,c=0,h=0,p=0;for(1&e?a=c=h=_n:r=n=p=_n;(e>>=1)>1;){const x=r+a>>1,A=n+c>>1;1&e?(a=r,c=n,r=h,n=p):(r=a,n=c,a=h,c=p),h=x,p=A}const _=4*i;ns[_+0]=r,ns[_+1]=n,ns[_+2]=a,ns[_+3]=c}const Xn=new Uint16Array(2178),os=new Uint8Array(1089),Ih=new Uint16Array(1089);function c_(i){return i===0?-.03125:i===32?.03125:0}var u_=Q([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const h_={type:2,extent:zt,loadGeometry:()=>[[new J(0,0),new J(8193,0),new J(8193,8193),new J(0,8193),new J(0,0)]]};class Ap{constructor(e,r,n,a,c){this.tileID=e,this.uid=Tr(),this.uses=0,this.tileSize=r,this.tileZoom=n,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=c,this.expiredRequestCount=0,this.state="loading",a&&a.transform&&(this.projection=a.transform.projection)}registerFadeDuration(e){const r=e+this.timeAdded;r<Te.now()||this.fadeEndTime&&r<this.fadeEndTime||(this.fadeEndTime=r)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=ea(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(e,r,n){if(this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(a,c){const h={};if(!c)return h;for(const p of a){const _=p.layerIds.map(x=>c.getLayer(x)).filter(Boolean);if(_.length!==0){p.layers=_,p.stateDependentLayerIds&&(p.stateDependentLayers=p.stateDependentLayerIds.map(x=>_.filter(A=>A.id===x)[0]));for(const x of _)h[x.id]=p}}return h}(e.buckets,r.style),this.hasSymbolBuckets=!1;for(const a in this.buckets){const c=this.buckets[a];if(c instanceof rs){if(this.hasSymbolBuckets=!0,!n)break;c.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const a in this.buckets){const c=this.buckets[a];if(c instanceof rs&&c.hasRTLText){this.hasRTLText=!0,Vr.isLoading()||Vr.isLoaded()||Ya()!=="deferred"||Yo();break}}this.queryPadding=0;for(const a in this.buckets){const c=this.buckets[a];this.queryPadding=Math.max(this.queryPadding,r.style.getLayer(a).queryRadius(c))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas)}else this.collisionBoxArray=new Cn}unloadVectorData(){if(this.hasData()){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugIndexBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(e){return this.buckets[e.id]}upload(e){for(const n in this.buckets){const a=this.buckets[n];a.uploadPending()&&a.upload(e)}const r=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Rc(e,this.imageAtlas.image,r.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Rc(e,this.glyphAtlasImage,r.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Rc(e,this.lineAtlas.image,r.ALPHA),this.lineAtlas.uploaded=!0)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,r,n,a,c,h,p,_){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:a,pixelPosMatrix:p,transform:h,params:c,tileTransform:this.tileTransform},e,r,n):{}}querySourceFeatures(e,r){const n=this.latestFeatureIndex;if(!n||!n.rawTileData)return;const a=n.loadVTLayers(),c=r?r.sourceLayer:"",h=a._geojsonTileLayer||a[c];if(!h)return;const p=Nn(r&&r.filter),{z:_,x,y:A}=this.tileID.canonical,w={z:_,x,y:A};for(let E=0;E<h.length;E++){const z=h.feature(E);if(p.needGeometry){const U=Qs(z,!0);if(!p.filter(new gi(this.tileID.overscaledZ),U,this.tileID.canonical))continue}else if(!p.filter(new gi(this.tileID.overscaledZ),z))continue;const P=n.getId(z,c),F=new l_(z,_,x,A,P);F.tile=w,e.push(F)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const r=this.expirationTime;if(e.cacheControl){const n=Je(e.cacheControl);n["max-age"]&&(this.expirationTime=Date.now()+1e3*n["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const n=Date.now();let a=!1;if(this.expirationTime>n)a=!1;else if(r)if(this.expirationTime<r)a=!0;else{const c=this.expirationTime-r;c?this.expirationTime=n+Math.max(c,3e4):a=!0}else a=!0;a?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,r){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0||!r)return;const n=this.latestFeatureIndex.loadVTLayers(),a=r.style.listImages();for(const c in this.buckets){if(!r.style.hasLayer(c))continue;const h=this.buckets[c],p=h.layers[0].sourceLayer||"_geojsonTileLayer",_=n[p],x=e[p];if(!_||!x||Object.keys(x).length===0)continue;if(h.update(x,_,a,this.imageAtlas&&this.imageAtlas.patternPositions||{}),h instanceof yh||h instanceof _h){const w=r.style._getSourceCache(h.layers[0].source);r._terrain&&r._terrain.enabled&&w&&h.programConfigurations.needsUpload&&r._terrain._clearRenderCacheForTile(w.id,this.tileID)}const A=r&&r.style&&r.style.getLayer(c);A&&(this.queryPadding=Math.max(this.queryPadding,A.queryRadius(h)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Te.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=Te.now()+e}setTexture(e,r){const n=r.context,a=n.gl;this.texture=r.getTileTexture(e.width),this.texture?this.texture.update(e,{useMipmap:!0}):(this.texture=new Rc(n,e,a.RGBA,{useMipmap:!0}),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE),n.extTextureFilterAnisotropic&&a.texParameterf(a.TEXTURE_2D,n.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,n.extTextureFilterAnisotropicMax))}setDependencies(e,r){const n={};for(const a of r)n[a]=!0;this.dependencies[e]=n}hasDependency(e,r){for(const n of e){const a=this.dependencies[n];if(a){for(const c of r)if(a[c])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(e,r){if(!r||r.name==="mercator"||this._tileDebugBuffer)return;const n=To(h_,this.tileID.canonical,this.tileTransform)[0],a=new Y,c=new Ct;for(let h=0;h<n.length;h++){const{x:p,y:_}=n[h];a.emplaceBack(p,_),c.emplaceBack(h)}c.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(c),this._tileDebugBuffer=e.createVertexBuffer(a,Fc.members),this._tileDebugSegments=ki.simpleSegment(0,0,a.length,c.length)}_makeTileBoundsBuffers(e,r){if(this._tileBoundsBuffer||!r||r.name==="mercator")return;const n=To(h_,this.tileID.canonical,this.tileTransform)[0];let a,c;if(this.isRaster){const h=function(p,_){const x=ea(p,_),A=Math.pow(2,p.z);for(let U=0;U<Yn;U++)for(let q=0;q<Yn;q++){const ie=mn((p.x+(q+c_(q))/_n)/A),oe=sr((p.y+(U+c_(U))/_n)/A),ae=_.project(ie,oe),le=U*Yn+q;Xn[2*le+0]=Math.round((ae.x*x.scale-x.x)*zt),Xn[2*le+1]=Math.round((ae.y*x.scale-x.y)*zt)}os.fill(0),Ih.fill(0);for(let U=2045;U>=0;U--){const q=4*U,ie=ns[q+0],oe=ns[q+1],ae=ns[q+2],le=ns[q+3],ce=ie+ae>>1,we=oe+le>>1,Me=ce+we-oe,De=we+ie-ce,Pe=oe*Yn+ie,ve=le*Yn+ae,Ie=we*Yn+ce,Re=Math.hypot((Xn[2*Pe+0]+Xn[2*ve+0])/2-Xn[2*Ie+0],(Xn[2*Pe+1]+Xn[2*ve+1])/2-Xn[2*Ie+1])>=16;if(os[Ie]=os[Ie]||(Re?1:0),U<1022){const Ze=(oe+De>>1)*Yn+(ie+Me>>1),Ne=(le+De>>1)*Yn+(ae+Me>>1);os[Ie]=os[Ie]||os[Ze]||os[Ne]}}const w=new ee,E=new be;let z=0;function P(U,q){const ie=q*Yn+U;return Ih[ie]===0&&(w.emplaceBack(Xn[2*ie+0],Xn[2*ie+1],U*zt/_n,q*zt/_n),Ih[ie]=++z),Ih[ie]-1}function F(U,q,ie,oe,ae,le){const ce=U+ie>>1,we=q+oe>>1;if(Math.abs(U-ae)+Math.abs(q-le)>1&&os[we*Yn+ce])F(ae,le,U,q,ce,we),F(ie,oe,ae,le,ce,we);else{const Me=P(U,q),De=P(ie,oe),Pe=P(ae,le);E.emplaceBack(Me,De,Pe)}}return F(0,0,_n,_n,_n,0),F(_n,_n,0,0,0,_n),{vertices:w,indices:E}}(this.tileID.canonical,r);a=h.vertices,c=h.indices}else{a=new ee,c=new be;for(const{x:p,y:_}of n)a.emplaceBack(p,_,0,0);const h=hh(a.int16,void 0,4);for(let p=0;p<h.length;p+=3)c.emplaceBack(h[p],h[p+1],h[p+2])}this._tileBoundsBuffer=e.createVertexBuffer(a,u_.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(c),this._tileBoundsSegments=ki.simpleSegment(0,0,a.length,c.length)}_makeGlobeTileDebugBuffers(e,r){if(this._globeTileDebugBorderBuffer||this._globeTileDebugTextBuffer||!r||r.name!=="globe")return;const n=this.tileID.canonical,a=t_(Oc(n));this._makeGlobeTileDebugBorderBuffer(e,n,a),this._makeGlobeTileDebugTextBuffer(e,n,a)}_makeGlobeTileDebugBorderBuffer(e,r,n){const a=new Y,c=new Ct,h=new X,p=(x,A,w,E,z)=>{const P=(w-x)/(z-1),F=(E-A)/(z-1),U=a.length;for(let q=0;q<z;q++){const ie=x+q*P,oe=A+q*F;a.emplaceBack(ie,oe);const ae=e_(ie,oe,r),le=$s(ae,ae,n);h.emplaceBack(le[0],le[1],le[2]),c.emplaceBack(U+q)}},_=zt;p(0,0,_,0,16),p(_,0,_,_,16),p(_,_,0,_,16),p(0,_,0,0,16),this._tileDebugIndexBuffer=e.createIndexBuffer(c),this._tileDebugBuffer=e.createVertexBuffer(a,Fc.members),this._globeTileDebugBorderBuffer=e.createVertexBuffer(h,$m.members),this._tileDebugSegments=ki.simpleSegment(0,0,a.length,c.length)}_makeGlobeTileDebugTextBuffer(e,r,n){const a=new Y,c=new be,h=new X,p=25;c.reserve(32),a.reserve(p),h.reserve(p);const _=(x,A)=>p*x+A;for(let x=0;x<p;x++){const A=2048*x;for(let w=0;w<p;w++){const E=2048*w;a.emplaceBack(E,A);const z=e_(E,A,r),P=$s(z,z,n);h.emplaceBack(P[0],P[1],P[2])}}for(let x=0;x<4;x++)for(let A=0;A<4;A++){const w=_(x,A),E=_(x,A+1),z=_(x+1,A),P=_(x+1,A+1);c.emplaceBack(w,E,z),c.emplaceBack(z,E,P)}this._tileDebugTextIndexBuffer=e.createIndexBuffer(c),this._tileDebugTextBuffer=e.createVertexBuffer(a,Fc.members),this._globeTileDebugTextBuffer=e.createVertexBuffer(h,$m.members),this._tileDebugTextSegments=ki.simpleSegment(0,0,p,32)}}class ex{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,r,n){const a=String(r);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][a]=this.stateChanges[e][a]||{},mi(this.stateChanges[e][a],n),this.deletedStates[e]===null){this.deletedStates[e]={};for(const c in this.state[e])c!==a&&(this.deletedStates[e][c]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][a]===null){this.deletedStates[e][a]={};for(const c in this.state[e][a])n[c]||(this.deletedStates[e][a][c]=null)}else for(const c in n)this.deletedStates[e]&&this.deletedStates[e][a]&&this.deletedStates[e][a][c]===null&&delete this.deletedStates[e][a][c]}removeFeatureState(e,r,n){if(this.deletedStates[e]===null)return;const a=String(r);if(this.deletedStates[e]=this.deletedStates[e]||{},n&&r!==void 0)this.deletedStates[e][a]!==null&&(this.deletedStates[e][a]=this.deletedStates[e][a]||{},this.deletedStates[e][a][n]=null);else if(r!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][a])for(n in this.deletedStates[e][a]={},this.stateChanges[e][a])this.deletedStates[e][a][n]=null;else this.deletedStates[e][a]=null;else this.deletedStates[e]=null}getState(e,r){const n=String(r),a=mi({},(this.state[e]||{})[n],(this.stateChanges[e]||{})[n]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const c=this.deletedStates[e][r];if(c===null)return{};for(const h in c)delete a[h]}return a}initializeTileState(e,r){e.setFeatureState(this.state,r)}coalesceChanges(e,r){const n={};for(const a in this.stateChanges){this.state[a]=this.state[a]||{};const c={};for(const h in this.stateChanges[a])this.state[a][h]||(this.state[a][h]={}),mi(this.state[a][h],this.stateChanges[a][h]),c[h]=this.state[a][h];n[a]=c}for(const a in this.deletedStates){this.state[a]=this.state[a]||{};const c={};if(this.deletedStates[a]===null)for(const h in this.state[a])c[h]={},this.state[a][h]={};else for(const h in this.deletedStates[a]){if(this.deletedStates[a][h]===null)this.state[a][h]={};else for(const p of Object.keys(this.deletedStates[a][h]))delete this.state[a][h][p];c[h]=this.state[a][h]}n[a]=n[a]||{},mi(n[a],c)}if(this.stateChanges={},this.deletedStates={},Object.keys(n).length!==0)for(const a in e)e[a].setFeatureState(n,r)}}class d_{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,r){const n=this.toIdx(e,r);return{min:this.minimums[n],max:this.maximums[n]}}isLeaf(e,r){return this.leaves[this.toIdx(e,r)]}toIdx(e,r){return r*this.size+e}}function p_(i,e,r,n){let a=0,c=Number.MAX_VALUE;for(let h=0;h<3;h++)if(Math.abs(n[h])<1e-15){if(r[h]<i[h]||r[h]>e[h])return null}else{const p=1/n[h];let _=(i[h]-r[h])*p,x=(e[h]-r[h])*p;if(_>x){const A=_;_=x,x=A}if(_>a&&(a=_),x<c&&(c=x),a>c)return null}return a}function f_(i,e,r,n,a,c,h,p,_,x,A){const w=n-i,E=a-e,z=c-r,P=h-i,F=p-e,U=_-r,q=A[1]*U-A[2]*F,ie=A[2]*P-A[0]*U,oe=A[0]*F-A[1]*P,ae=w*q+E*ie+z*oe;if(Math.abs(ae)<1e-15)return null;const le=1/ae,ce=x[0]-i,we=x[1]-e,Me=x[2]-r,De=(ce*q+we*ie+Me*oe)*le;if(De<0||De>1)return null;const Pe=we*z-Me*E,ve=Me*w-ce*z,Ie=ce*E-we*w,Re=(A[0]*Pe+A[1]*ve+A[2]*Ie)*le;return Re<0||De+Re>1?null:(P*Pe+F*ve+U*Ie)*le}function m_(i,e,r){return(i-e)/(r-e)}function __(i,e,r,n,a,c,h,p,_){const x=1<<r,A=c-n,w=h-a,E=(i+1)/x*A+n,z=(e+0)/x*w+a,P=(e+1)/x*w+a;p[0]=(i+0)/x*A+n,p[1]=z,_[0]=E,_[1]=P}class g_{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const r=function(c){const h=Math.ceil(Math.log2(c.dim/8)),p=[];let _=Math.ceil(Math.pow(2,h));const x=1/_,A=(z,P,F,U,q)=>{const ie=U?1:0,oe=(z+1)*F-ie,ae=P*F,le=(P+1)*F-ie;q[0]=z*F,q[1]=ae,q[2]=oe,q[3]=le};let w=new d_(_);const E=[];for(let z=0;z<_*_;z++){A(z%_,Math.floor(z/_),x,!1,E);const P=ss(E[0],E[1],c),F=ss(E[2],E[1],c),U=ss(E[2],E[3],c),q=ss(E[0],E[3],c);w.minimums.push(Math.min(P,F,U,q)),w.maximums.push(Math.max(P,F,U,q)),w.leaves.push(1)}for(p.push(w),_/=2;_>=1;_/=2){const z=p[p.length-1];w=new d_(_);for(let P=0;P<_*_;P++){A(P%_,Math.floor(P/_),2,!0,E);const F=z.getElevation(E[0],E[1]),U=z.getElevation(E[2],E[1]),q=z.getElevation(E[2],E[3]),ie=z.getElevation(E[0],E[3]),oe=z.isLeaf(E[0],E[1]),ae=z.isLeaf(E[2],E[1]),le=z.isLeaf(E[2],E[3]),ce=z.isLeaf(E[0],E[3]),we=Math.min(F.min,U.min,q.min,ie.min),Me=Math.max(F.max,U.max,q.max,ie.max),De=oe&&ae&&le&&ce;w.maximums.push(Me),w.minimums.push(we),w.leaves.push(Me-we<=5&&De?1:0)}p.push(w)}return p}(this.dem),n=r.length-1,a=r[n];this._addNode(a.minimums[0],a.maximums[0],a.leaves[0]),this._construct(r,0,0,n,0)}raycastRoot(e,r,n,a,c,h,p=1){return p_([e,r,-100],[n,a,this.maximums[0]*p],c,h)}raycast(e,r,n,a,c,h,p=1){if(!this.nodeCount)return null;const _=this.raycastRoot(e,r,n,a,c,h,p);if(_==null)return null;const x=[],A=[],w=[],E=[],z=[{idx:0,t:_,nodex:0,nodey:0,depth:0}];for(;z.length>0;){const{idx:P,t:F,nodex:U,nodey:q,depth:ie}=z.pop();if(this.leaves[P]){__(U,q,ie,e,r,n,a,w,E);const ae=1<<ie,le=(U+0)/ae,ce=(U+1)/ae,we=(q+0)/ae,Me=(q+1)/ae,De=ss(le,we,this.dem)*p,Pe=ss(ce,we,this.dem)*p,ve=ss(ce,Me,this.dem)*p,Ie=ss(le,Me,this.dem)*p,Re=f_(w[0],w[1],De,E[0],w[1],Pe,E[0],E[1],ve,c,h),Ze=f_(E[0],E[1],ve,w[0],E[1],Ie,w[0],w[1],De,c,h),Ne=Math.min(Re!==null?Re:Number.MAX_VALUE,Ze!==null?Ze:Number.MAX_VALUE);if(Ne!==Number.MAX_VALUE)return Ne;{const je=qd([],c,h,F);if(y_(De,Pe,Ie,ve,m_(je[0],w[0],E[0]),m_(je[1],w[1],E[1]))>=je[2])return F}continue}let oe=0;for(let ae=0;ae<this._siblingOffset.length;ae++){__((U<<1)+this._siblingOffset[ae][0],(q<<1)+this._siblingOffset[ae][1],ie+1,e,r,n,a,w,E),w[2]=-100,E[2]=this.maximums[this.childOffsets[P]+ae]*p;const le=p_(w,E,c,h);if(le!=null){const ce=le;x[ae]=ce;let we=!1;for(let Me=0;Me<oe&&!we;Me++)ce>=x[A[Me]]&&(A.splice(Me,0,ae),we=!0);we||(A[oe]=ae),oe++}}for(let ae=0;ae<oe;ae++){const le=A[ae];z.push({idx:this.childOffsets[P]+le,t:x[le],nodex:(U<<1)+this._siblingOffset[le][0],nodey:(q<<1)+this._siblingOffset[le][1],depth:ie+1})}}return null}_addNode(e,r,n){return this.minimums.push(e),this.maximums.push(r),this.leaves.push(n),this.childOffsets.push(0),this.nodeCount++}_construct(e,r,n,a,c){if(e[a].isLeaf(r,n)===1)return;this.childOffsets[c]||(this.childOffsets[c]=this.nodeCount);const h=a-1,p=e[h];let _=0,x=0;for(let A=0;A<this._siblingOffset.length;A++){const w=2*r+this._siblingOffset[A][0],E=2*n+this._siblingOffset[A][1],z=p.getElevation(w,E),P=p.isLeaf(w,E),F=this._addNode(z.min,z.max,P);P&&(_|=1<<A),x||(x=F)}for(let A=0;A<this._siblingOffset.length;A++)_&1<<A||this._construct(e,2*r+this._siblingOffset[A][0],2*n+this._siblingOffset[A][1],h,x+A)}}function y_(i,e,r,n,a,c){return yt(yt(i,r,c),yt(e,n,c),a)}function ss(i,e,r){const n=r.dim,a=It(i*n-.5,0,n-1),c=It(e*n-.5,0,n-1),h=Math.floor(a),p=Math.floor(c),_=Math.min(h+1,n-1),x=Math.min(p+1,n-1);return y_(r.get(h,p),r.get(_,p),r.get(h,x),r.get(_,x),a-h,c-p)}const x_={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class zh{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,r,n,a=!1,c=!1){if(this.uid=e,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(n&&n!=="mapbox"&&n!=="terrarium")return Ot(`"${n}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=r.height;const h=this.dim=r.height-2,p=new Uint32Array(r.data.buffer);if(this.pixels=new Uint8Array(r.data.buffer),this.encoding=n||"mapbox",this.borderReady=a,!a){for(let _=0;_<h;_++)p[this._idx(-1,_)]=p[this._idx(0,_)],p[this._idx(h,_)]=p[this._idx(h-1,_)],p[this._idx(_,-1)]=p[this._idx(_,0)],p[this._idx(_,h)]=p[this._idx(_,h-1)];p[this._idx(-1,-1)]=p[this._idx(0,0)],p[this._idx(h,-1)]=p[this._idx(h-1,0)],p[this._idx(-1,h)]=p[this._idx(0,h-1)],p[this._idx(h,h)]=p[this._idx(h-1,h-1)],c&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new g_(this)}get(e,r,n=!1){n&&(e=It(e,-1,this.dim),r=It(r,-1,this.dim));const a=4*this._idx(e,r);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(this.pixels[a],this.pixels[a+1],this.pixels[a+2])}static getUnpackVector(e){return x_[e]}get unpackVector(){return x_[this.encoding]}_idx(e,r){if(e<-1||e>=this.dim+1||r<-1||r>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(r+1)*this.stride+(e+1)}_unpackMapbox(e,r,n){return(256*e*256+256*r+n)/10-1e4}_unpackTerrarium(e,r,n){return 256*e+r+n/256-32768}static pack(e,r){const n=[0,0,0,0],a=zh.getUnpackVector(r);let c=Math.floor((e+a[3])/a[2]);return n[2]=c%256,c=Math.floor(c/256),n[1]=c%256,c=Math.floor(c/256),n[0]=c,n}getPixels(){return new Zr({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,r,n){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let a=r*this.dim,c=r*this.dim+this.dim,h=n*this.dim,p=n*this.dim+this.dim;switch(r){case-1:a=c-1;break;case 1:c=a+1}switch(n){case-1:h=p-1;break;case 1:p=h+1}const _=-r*this.dim,x=-n*this.dim;for(let A=h;A<p;A++)for(let w=a;w<c;w++){const E=4*this._idx(w,A),z=4*this._idx(w+_,A+x);this.pixels[E+0]=e.pixels[z+0],this.pixels[E+1]=e.pixels[z+1],this.pixels[E+2]=e.pixels[z+2],this.pixels[E+3]=e.pixels[z+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}tt(zh),tt(g_,{omit:["dem"]});class tx{constructor(e,r){this.max=e,this.onRemove=r,this.reset()}reset(){for(const e in this.data)for(const r of this.data[e])r.timeout&&clearTimeout(r.timeout),this.onRemove(r.value);return this.data={},this.order=[],this}add(e,r,n){const a=e.wrapped().key;this.data[a]===void 0&&(this.data[a]=[]);const c={value:r,timeout:void 0};if(n!==void 0&&(c.timeout=setTimeout(()=>{this.remove(e,c)},n)),this.data[a].push(c),this.order.push(a),this.order.length>this.max){const h=this._getAndRemoveByKey(this.order[0]);h&&this.onRemove(h)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const r=this.data[e].shift();return r.timeout&&clearTimeout(r.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),r.value}getByKey(e){const r=this.data[e];return r?r[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,r){if(!this.has(e))return this;const n=e.wrapped().key,a=r===void 0?0:this.data[n].indexOf(r),c=this.data[n][a];return this.data[n].splice(a,1),c.timeout&&clearTimeout(c.timeout),this.data[n].length===0&&delete this.data[n],this.onRemove(c.value),this.order.splice(this.order.indexOf(n),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const r=this._getAndRemoveByKey(this.order[0]);r&&this.onRemove(r)}return this}filter(e){const r=[];for(const n in this.data)for(const a of this.data[n])e(a.value)||r.push(a);for(const n of r)this.remove(n.value.tileID,n)}}class hl{constructor(e,r,n){this.func=e,this.mask=r,this.range=n}}hl.ReadOnly=!1,hl.ReadWrite=!0,hl.disabled=new hl(519,hl.ReadOnly,[0,1]);const bp=7680;class wp{constructor(e,r,n,a,c,h){this.test=e,this.ref=r,this.mask=n,this.fail=a,this.depthFail=c,this.pass=h}}wp.disabled=new wp({func:519,mask:0},0,0,bp,bp,bp);class Qn{constructor(e,r,n){this.blendFunction=e,this.blendColor=r,this.mask=n}}Qn.Replace=[1,0],Qn.disabled=new Qn(Qn.Replace,$t.transparent,[!1,!1,!1,!1]),Qn.unblended=new Qn(Qn.Replace,$t.transparent,[!0,!0,!0,!0]),Qn.alphaBlended=new Qn([1,771],$t.transparent,[!0,!0,!0,!0]);const Tp=1029,Ep=2305;class zn{constructor(e,r,n){this.enable=e,this.mode=r,this.frontFace=n}}zn.disabled=new zn(!1,Tp,Ep),zn.backCCW=new zn(!0,Tp,Ep),zn.backCW=new zn(!0,Tp,2304),zn.frontCW=new zn(!0,1028,2304),zn.frontCCW=new zn(!0,1028,Ep);class ta extends Tt{constructor(e,r,n){super(),this.id=e,this._onlySymbols=n,r.on("data",a=>{a.dataType==="source"&&a.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&a.dataType==="source"&&a.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),r.on("error",()=>{this._sourceErrored=!0}),this._source=r,this._tiles={},this._cache=new tx(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=r.minTileCacheSize,this._maxTileCacheSize=r.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new ex,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(e){this.map=e,this._minTileCacheSize=this._minTileCacheSize===void 0&&e?e._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&e?e._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const e in this._tiles){const r=this._tiles[e];if(r.state!=="loaded"&&r.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,r){return e.isSymbolTile=this._onlySymbols,this._source.loadTile(e,r)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e,()=>{})}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e,()=>{})}serialize(){return this._source.serialize()}prepare(e){if(this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._source.prepareTile)for(const r in this._tiles){const n=this._tiles[r];this._source.prepareTile(n)&&this.map.painter.terrain&&this.map.painter.terrain._clearRenderCacheForTile(this.id,n.tileID),n.upload(e),n.prepare(this.map.style.imageManager)}else for(const r in this._tiles){const n=this._tiles[r];n.upload(e),n.prepare(this.map.style.imageManager)}}getIds(){return _r(this._tiles).map(e=>e.tileID).sort(v_).map(e=>e.key)}getRenderableIds(e){const r=[];for(const n in this._tiles)this._isIdRenderable(+n,e)&&r.push(this._tiles[n]);return e?r.sort((n,a)=>{const c=n.tileID,h=a.tileID,p=new J(c.canonical.x,c.canonical.y)._rotate(this.transform.angle),_=new J(h.canonical.x,h.canonical.y)._rotate(this.transform.angle);return c.overscaledZ-h.overscaledZ||_.y-p.y||_.x-p.x}).map(n=>n.tileID.key):r.map(n=>n.tileID).sort(v_).map(n=>n.key)}hasRenderableParent(e){const r=this.findLoadedParent(e,0);return!!r&&this._isIdRenderable(r.tileID.key)}_isIdRenderable(e,r){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(r||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)this._tiles[e].state!=="errored"&&this._reloadTile(+e,"reloading")}}_reloadTile(e,r){const n=this._tiles[e];n&&(n.state!=="loading"&&(n.state=r),this._loadTile(n,this._tileLoaded.bind(this,n,e,r)))}_tileLoaded(e,r,n,a){if(a)if(e.state="errored",a.status!==404)this._source.fire(new _t(a,{tile:e}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const c=this.map.painter.terrain;this.update(this.transform,c.getScaledDemTileSize(),!0),c.resetTileLookupCache(this.id)}else this.update(this.transform);else e.timeAdded=Te.now(),n==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(r,e),this._source.type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new mt("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const r=this.getRenderableIds();for(let a=0;a<r.length;a++){const c=r[a];if(e.neighboringTiles&&e.neighboringTiles[c]){const h=this.getTileByID(c);n(e,h),n(h,e)}}function n(a,c){if(!a.dem||a.dem.borderReady)return;a.needsHillshadePrepare=!0,a.needsDEMTextureUpload=!0;let h=c.tileID.canonical.x-a.tileID.canonical.x;const p=c.tileID.canonical.y-a.tileID.canonical.y,_=Math.pow(2,a.tileID.canonical.z),x=c.tileID.key;h===0&&p===0||Math.abs(p)>1||(Math.abs(h)>1&&(Math.abs(h+_)===1?h+=_:Math.abs(h-_)===1&&(h-=_)),c.dem&&a.dem&&(a.dem.backfillBorder(c.dem,h,p),a.neighboringTiles&&a.neighboringTiles[x]&&(a.neighboringTiles[x].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,r,n,a){for(const c in this._tiles){let h=this._tiles[c];if(a[c]||!h.hasData()||h.tileID.overscaledZ<=r||h.tileID.overscaledZ>n)continue;let p=h.tileID;for(;h&&h.tileID.overscaledZ>r+1;){const x=h.tileID.scaledTo(h.tileID.overscaledZ-1);h=this._tiles[x.key],h&&h.hasData()&&(p=x)}let _=p;for(;_.overscaledZ>r;)if(_=_.scaledTo(_.overscaledZ-1),e[_.key]){a[p.key]=p;break}}}findLoadedParent(e,r){if(e.key in this._loadedParentTiles){const n=this._loadedParentTiles[e.key];return n&&n.tileID.overscaledZ>=r?n:null}for(let n=e.overscaledZ-1;n>=r;n--){const a=e.scaledTo(n),c=this._getLoadedTile(a);if(c)return c}}_getLoadedTile(e){const r=this._tiles[e.key];return r&&r.hasData()?r:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,r){r=r||this._source.tileSize;const n=Math.ceil(e.width/r)+1,a=Math.ceil(e.height/r)+1,c=Math.floor(n*a*5),h=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,c):c,p=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,h):h;this._cache.setMaxSize(p)}handleWrapJump(e){const r=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,r){const n={};for(const a in this._tiles){const c=this._tiles[a];c.tileID=c.tileID.unwrapTo(c.tileID.wrap+r),n[c.tileID.key]=c}this._tiles=n;for(const a in this._timers)clearTimeout(this._timers[a]),delete this._timers[a];for(const a in this._tiles)this._setTileReloadTimer(+a,this._tiles[a])}}update(e,r,n){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!n)return;let a;this.updateCacheSize(e,r),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?a=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(p=>new vr(p.canonical.z,p.wrap,p.canonical.z,p.canonical.x,p.canonical.y)):(a=e.coveringTiles({tileSize:r||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!n,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(a=a.filter(p=>this._source.hasTile(p)))):a=[];const c=this._updateRetainedTiles(a);if(A_(this._source.type)&&a.length!==0){const p={},_={},x=Object.keys(c);for(const w of x){const E=c[w],z=this._tiles[w];if(!z||z.fadeEndTime&&z.fadeEndTime<=Te.now())continue;const P=this.findLoadedParent(E,Math.max(E.overscaledZ-ta.maxOverzooming,this._source.minzoom));P&&(this._addTile(P.tileID),p[P.tileID.key]=P.tileID),_[w]=E}const A=a[a.length-1].overscaledZ;for(const w in this._tiles){const E=this._tiles[w];if(c[w]||!E.hasData())continue;let z=E.tileID;for(;z.overscaledZ>A;){z=z.scaledTo(z.overscaledZ-1);const P=this._tiles[z.key];if(P&&P.hasData()&&_[z.key]){c[w]=E.tileID;break}}}for(const w in p)c[w]||(this._coveredTiles[w]=!0,c[w]=p[w])}for(const p in c)this._tiles[p].clearFadeHold();const h=function(p,_){const x=[];for(const A in p)A in _||x.push(A);return x}(this._tiles,c);for(const p of h){const _=this._tiles[p];_.hasSymbolBuckets&&!_.holdingForFade()?_.setHoldDuration(this.map._fadeDuration):_.hasSymbolBuckets&&!_.symbolFadeFinished()||this._removeTile(+p)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const r={};if(e.length===0)return r;const n={},a=e.reduce((x,A)=>Math.min(x,A.overscaledZ),1/0),c=e[0].overscaledZ,h=Math.max(c-ta.maxOverzooming,this._source.minzoom),p=Math.max(c+ta.maxUnderzooming,this._source.minzoom),_={};for(const x of e){const A=this._addTile(x);r[x.key]=x,A.hasData()||a<this._source.maxzoom&&(_[x.key]=x)}this._retainLoadedChildren(_,a,p,r);for(const x of e){let A=this._tiles[x.key];if(A.hasData())continue;if(x.canonical.z>=this._source.maxzoom){const E=x.children(this._source.maxzoom)[0],z=this.getTile(E);if(z&&z.hasData()){r[E.key]=E;continue}}else{const E=x.children(this._source.maxzoom);if(r[E[0].key]&&r[E[1].key]&&r[E[2].key]&&r[E[3].key])continue}let w=A.wasRequested();for(let E=x.overscaledZ-1;E>=h;--E){const z=x.scaledTo(E);if(n[z.key]||(n[z.key]=!0,A=this.getTile(z),!A&&w&&(A=this._addTile(z)),A&&(r[z.key]=z,w=A.wasRequested(),A.hasData())))break}}return r}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const r=[];let n,a=this._tiles[e].tileID;for(;a.overscaledZ>0;){if(a.key in this._loadedParentTiles){n=this._loadedParentTiles[a.key];break}r.push(a.key);const c=a.scaledTo(a.overscaledZ-1);if(n=this._getLoadedTile(c),n)break;a=c}for(const c of r)this._loadedParentTiles[c]=n}}_addTile(e){let r=this._tiles[e.key];if(r)return this._source.prepareTile&&this._source.prepareTile(r),r;r=this._cache.getAndRemove(e),r&&(this._setTileReloadTimer(e.key,r),r.tileID=e,this._state.initializeTileState(r,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,r)));const n=Boolean(r);if(!n){const a=this.map?this.map.painter:null;r=new Ap(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,a,this._isRaster),this._source.prepareTile&&this._source.prepareTile(r)||this._loadTile(r,this._tileLoaded.bind(this,r,e.key,r.state))}return r?(r.uses++,this._tiles[e.key]=r,n||this._source.fire(new mt("dataloading",{tile:r,coord:r.tileID,dataType:"source"})),r):null}_setTileReloadTimer(e,r){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const n=r.getExpiryTimeout();n&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},n))}_removeTile(e){const r=this._tiles[e];r&&(r.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),r.uses>0||(r.hasData()&&r.state!=="reloading"?this._cache.add(r.tileID,r,r.getExpiryTimeout()):(r.aborted=!0,this._abortTile(r),this._unloadTile(r))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(e,r,n){const a=[],c=this.transform;if(!c)return a;for(const h in this._tiles){const p=this._tiles[h];if(n&&p.clearQueryDebugViz(),p.holdingForFade())continue;const _=e.containsTile(p,c,r);_&&a.push(_)}return a}getVisibleCoordinates(e){const r=this.getRenderableIds(e).map(n=>this._tiles[n].tileID);for(const n of r)n.projMatrix=this.transform.calculateProjMatrix(n.toUnwrapped());return r}hasTransition(){if(this._source.hasTransition())return!0;if(A_(this._source.type))for(const e in this._tiles){const r=this._tiles[e];if(r.fadeEndTime!==void 0&&r.fadeEndTime>=Te.now())return!0}return!1}setFeatureState(e,r,n){this._state.updateState(e=e||"_geojsonTileLayer",r,n)}removeFeatureState(e,r,n){this._state.removeFeatureState(e=e||"_geojsonTileLayer",r,n)}getFeatureState(e,r){return this._state.getState(e=e||"_geojsonTileLayer",r)}setDependencies(e,r,n){const a=this._tiles[e];a&&a.setDependencies(r,n)}reloadTilesForDependencies(e,r){for(const n in this._tiles)this._tiles[n].hasDependency(e,r)&&this._reloadTile(+n,"reloading");this._cache.filter(n=>!n.hasDependency(e,r))}_preloadTiles(e,r){const n=new Map,a=Array.isArray(e)?e:[e],c=this.map.painter.terrain,h=this.usedForTerrain&&c?c.getScaledDemTileSize():this._source.tileSize;for(const p of a){const _=p.coveringTiles({tileSize:h,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const x of _)n.set(x.key,x);this.usedForTerrain&&p.updateElevation(!1)}Ki(Array.from(n.values()),(p,_)=>{const x=new Ap(p,this._source.tileSize*p.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(x,A=>{this._source.type==="raster-dem"&&x.dem&&this._backfillDEM(x),_(A,x)})},r)}}function v_(i,e){const r=Math.abs(2*i.wrap)-+(i.wrap<0),n=Math.abs(2*e.wrap)-+(e.wrap<0);return i.overscaledZ-e.overscaledZ||n-r||e.canonical.y-i.canonical.y||e.canonical.x-i.canonical.x}function A_(i){return i==="raster"||i==="image"||i==="video"}ta.maxOverzooming=10,ta.maxUnderzooming=3;class Dh{constructor(e,r,n){this._demTile=e,this._dem=this._demTile.dem,this._scale=r,this._offset=n}static create(e,r,n){const a=n||e.findDEMTileFor(r);if(!a||!a.dem)return;const c=a.dem,h=a.tileID,p=1<<r.canonical.z-h.canonical.z;return new Dh(a,a.tileSize/zt/p,[(r.canonical.x/p-h.canonical.x)*c.dim,(r.canonical.y/p-h.canonical.y)*c.dim])}tileCoordToPixel(e,r){const n=r*this._scale+this._offset[1],a=Math.floor(e*this._scale+this._offset[0]),c=Math.floor(n);return new J(a,c)}getElevationAt(e,r,n,a){const c=e*this._scale+this._offset[0],h=r*this._scale+this._offset[1],p=Math.floor(c),_=Math.floor(h),x=this._dem;return a=!!a,n?yt(yt(x.get(p,_,a),x.get(p,_+1,a),h-_),yt(x.get(p+1,_,a),x.get(p+1,_+1,a),h-_),c-p):x.get(p,_,a)}getElevationAtPixel(e,r,n){return this._dem.get(e,r,!!n)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*Ka(1,e)*this._dem.stride}}class b_{constructor(e,r){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Gn(zt,16,0),this.featureIndexArray=new Ei,this.promoteId=r}insert(e,r,n,a,c,h=0){const p=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(n,a,c,h);const _=this.grid;for(let x=0;x<r.length;x++){const A=r[x],w=[1/0,1/0,-1/0,-1/0];for(let E=0;E<A.length;E++){const z=A[E];w[0]=Math.min(w[0],z.x),w[1]=Math.min(w[1],z.y),w[2]=Math.max(w[2],z.x),w[3]=Math.max(w[3],z.y)}w[0]<zt&&w[1]<zt&&w[2]>=0&&w[3]>=0&&_.insert(p,w[0],w[1],w[2],w[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Js.VectorTile(new Pc(this.rawTileData)).layers,this.sourceLayerCoder=new a_(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,r,n,a){this.loadVTLayers();const c=e.params||{},h=Nn(c.filter),p=e.tileResult,_=e.transform,x=p.bufferedTilespaceBounds,A=this.grid.query(x.min.x,x.min.y,x.max.x,x.max.y,(P,F,U,q)=>jf(p.bufferedTilespaceGeometry,P,F,U,q));A.sort(ix);let w=null;_.elevation&&A.length>0&&(w=Dh.create(_.elevation,this.tileID));const E={};let z;for(let P=0;P<A.length;P++){const F=A[P];if(F===z)continue;z=F;const U=this.featureIndexArray.get(F);let q=null;this.loadMatchingFeature(E,U,h,c.layers,c.availableImages,r,n,a,(ie,oe,ae,le=0)=>(q||(q=To(ie,this.tileID.canonical,e.tileTransform)),oe.queryIntersectsFeature(p,ie,ae,q,this.z,e.transform,e.pixelPosMatrix,w,le)))}return E}loadMatchingFeature(e,r,n,a,c,h,p,_,x){const{featureIndex:A,bucketIndex:w,sourceLayerIndex:E,layoutVertexArrayOffset:z}=r,P=this.bucketLayerIDs[w];if(a&&!function(ie,oe){for(let ae=0;ae<ie.length;ae++)if(oe.indexOf(ie[ae])>=0)return!0;return!1}(a,P))return;const F=this.sourceLayerCoder.decode(E),U=this.vtLayers[F].feature(A);if(n.needGeometry){const ie=Qs(U,!0);if(!n.filter(new gi(this.tileID.overscaledZ),ie,this.tileID.canonical))return}else if(!n.filter(new gi(this.tileID.overscaledZ),U))return;const q=this.getId(U,F);for(let ie=0;ie<P.length;ie++){const oe=P[ie];if(a&&a.indexOf(oe)<0)continue;const ae=h[oe];if(!ae)continue;let le={};q!==void 0&&_&&(le=_.getState(ae.sourceLayer||"_geojsonTileLayer",q));const ce=mi({},p[oe]);ce.paint=w_(ce.paint,ae.paint,U,le,c),ce.layout=w_(ce.layout,ae.layout,U,le,c);const we=!x||x(U,ae,le,z);if(!we)continue;const Me=new l_(U,this.z,this.x,this.y,q);Me.layer=ce;let De=e[oe];De===void 0&&(De=e[oe]=[]),De.push({featureIndex:A,feature:Me,intersectionZ:we})}}lookupSymbolFeatures(e,r,n,a,c,h,p,_){const x={};this.loadVTLayers();const A=Nn(c);for(const w of e)this.loadMatchingFeature(x,{bucketIndex:n,sourceLayerIndex:a,featureIndex:w,layoutVertexArrayOffset:0},A,h,p,_,r);return x}loadFeature(e){const{featureIndex:r,sourceLayerIndex:n}=e;this.loadVTLayers();const a=this.sourceLayerCoder.decode(n),c=this.vtFeatures[a];if(c[r])return c[r];const h=this.vtLayers[a].feature(r);return c[r]=h,h}hasLayer(e){for(const r of this.bucketLayerIDs)for(const n of r)if(e===n)return!0;return!1}getId(e,r){let n=e.id;return this.promoteId&&(n=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[r]],typeof n=="boolean"&&(n=Number(n))),n}}function w_(i,e,r,n,a){return Bi(i,(c,h)=>{const p=e instanceof m?e.get(h):null;return p&&p.evaluate?p.evaluate(r,n,a):p})}function ix(i,e){return e-i}tt(b_,{omit:["rawTileData","sourceLayerCoder"]});class T_{constructor(e){const r={},n=[];for(const p in e){const _=e[p],x=r[p]={};for(const A in _.glyphs){const w=_.glyphs[+A];if(!w||w.bitmap.width===0||w.bitmap.height===0)continue;const E=w.metrics.localGlyph?2:1,z={x:0,y:0,w:w.bitmap.width+2*E,h:w.bitmap.height+2*E};n.push(z),x[A]=z}}const{w:a,h:c}=rp(n),h=new Eo({width:a||1,height:c||1});for(const p in e){const _=e[p];for(const x in _.glyphs){const A=_.glyphs[+x];if(!A||A.bitmap.width===0||A.bitmap.height===0)continue;const w=r[p][x],E=A.metrics.localGlyph?2:1;Eo.copy(A.bitmap,h,{x:0,y:0},{x:w.x+E,y:w.y+E},A.bitmap)}}this.image=h,this.positions=r}}tt(T_);class rx{constructor(e){this.tileID=new vr(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.enableTerrain=!!e.enableTerrain,this.isSymbolTile=e.isSymbolTile,this.tileTransform=ea(e.tileID.canonical,e.projection),this.projection=e.projection}parse(e,r,n,a,c){this.status="parsing",this.data=e,this.collisionBoxArray=new Cn;const h=new a_(Object.keys(e.layers).sort()),p=new b_(this.tileID,this.promoteId);p.bucketLayerIDs=[];const _={},x=new gp(256,256),A={featureIndex:p,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:x,availableImages:n},w=r.familiesBySource[this.source];for(const le in w){const ce=e.layers[le];if(!ce)continue;let we=!1,Me=!1;for(const ve of w[le])ve[0].type==="symbol"?we=!0:Me=!0;if(this.isSymbolTile===!0&&!we||this.isSymbolTile===!1&&!Me)continue;ce.version===1&&Ot(`Vector tile source "${this.source}" layer "${le}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const De=h.encode(le),Pe=[];for(let ve=0;ve<ce.length;ve++){const Ie=ce.feature(ve),Re=p.getId(Ie,le);Pe.push({feature:Ie,id:Re,index:ve,sourceLayerIndex:De})}for(const ve of w[le]){const Ie=ve[0];this.isSymbolTile!==void 0&&Ie.type==="symbol"!==this.isSymbolTile||Ie.minzoom&&this.zoom<Math.floor(Ie.minzoom)||Ie.maxzoom&&this.zoom>=Ie.maxzoom||Ie.visibility!=="none"&&(Cp(ve,this.zoom,n),(_[Ie.id]=Ie.createBucket({index:p.bucketLayerIDs.length,layers:ve,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:De,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.name,availableImages:n})).populate(Pe,A,this.tileID.canonical,this.tileTransform),p.bucketLayerIDs.push(ve.map(Re=>Re.id)))}}let E,z,P,F;x.trim();const U={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},q=Bi(A.glyphDependencies,le=>Object.keys(le).map(Number));Object.keys(q).length?a.send("getGlyphs",{uid:this.uid,stacks:q},(le,ce)=>{E||(E=le,z=ce,ae.call(this))},void 0,!1,U):z={};const ie=Object.keys(A.iconDependencies);ie.length?a.send("getImages",{icons:ie,source:this.source,tileID:this.tileID,type:"icons"},(le,ce)=>{E||(E=le,P=ce,ae.call(this))},void 0,!1,U):P={};const oe=Object.keys(A.patternDependencies);function ae(){if(E)return c(E);if(z&&P&&F){const le=new T_(z),ce=new Im(P,F);for(const we in _){const Me=_[we];Me instanceof rs?(Cp(Me.layers,this.zoom,n),D0(Me,z,le.positions,P,ce.iconPositions,this.showCollisionBoxes,n,this.tileID.canonical,this.tileZoom,this.projection)):Me.hasPattern&&(Me instanceof yh||Me instanceof _h||Me instanceof zc)&&(Cp(Me.layers,this.zoom,n),Me.addFeatures(A,this.tileID.canonical,ce.patternPositions,n,this.tileTransform))}this.status="done",c(null,{buckets:_r(_).filter(we=>!we.isEmpty()),featureIndex:p,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:le.image,lineAtlas:x,imageAtlas:ce,glyphMap:this.returnDependencies?z:null,iconMap:this.returnDependencies?P:null,glyphPositions:this.returnDependencies?le.positions:null})}}oe.length?a.send("getImages",{icons:oe,source:this.source,tileID:this.tileID,type:"patterns"},(le,ce)=>{E||(E=le,F=ce,ae.call(this))},void 0,!1,U):F={},ae.call(this)}}function Cp(i,e,r){const n=new gi(e);for(const a of i)a.recalculate(n,r)}class E_{constructor(e){this.entries={},this.scheduler=e}request(e,r,n,a){const c=this.entries[e]=this.entries[e]||{callbacks:[]};if(c.result){const[h,p]=c.result;return this.scheduler?this.scheduler.add(()=>{a(h,p)},r):a(h,p),()=>{}}return c.callbacks.push(a),c.cancel||(c.cancel=n((h,p)=>{c.result=[h,p];for(const _ of c.callbacks)this.scheduler?this.scheduler.add(()=>{_(h,p)},r):_(h,p);setTimeout(()=>delete this.entries[e],3e3)})),()=>{c.result||(c.callbacks=c.callbacks.filter(h=>h!==a),c.callbacks.length||(c.cancel(),delete this.entries[e]))}}}function C_(i,e,r){const n=JSON.stringify(i.request);return i.data&&(this.deduped.entries[n]={result:[null,i.data]}),this.deduped.request(n,{type:"parseTile",isSymbolTile:i.isSymbolTile,zoom:i.tileZoom},a=>{const c=$(i.request,(h,p,_,x)=>{h?a(h):p&&a(null,{vectorTile:r?void 0:new Js.VectorTile(new Pc(p)),rawData:p,cacheControl:_,expires:x})});return()=>{c.cancel(),a()}},e)}const nx=Wn(new Float32Array(16));class as{constructor(e){this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,r){return{x:0,y:0,z:0}}unproject(e,r){return new di(0,0)}projectTilePoint(e,r,n){return{x:e,y:r,z:0}}locationPoint(e,r){return e._coordinatePoint(e.locationCoordinate(r),!1)}pixelsPerMeter(e,r){return Ka(1,e)*r}farthestPixelDistance(e){return function(r,n){const a=r.fovAboveCenter,c=r.elevation?r.elevation.getMinElevationBelowMSL()*n:0,h=(r._camera.position[2]*r.worldSize-c)/Math.cos(r._pitch),p=Math.sin(a)*h/Math.sin(Math.max(Math.PI/2-r._pitch-a,.01)),_=Math.sin(r._pitch)*p+h;return Math.min(1.01*_,h*(1/r._horizonShift))}(e,e.pixelsPerMeter)}pointCoordinate(e,r,n,a){const c=e.horizonLineFromTop(!1),h=new J(r,Math.max(c,n));return e.rayIntersectionCoordinate(e.pointRayIntersection(h,a))}createInversionMatrix(e,r){return nx}createTileMatrix(e,r,n){let a,c,h;const p=n.canonical,_=Wn(new Float64Array(16));if(this.isReprojectedInTileSpace){const x=ea(p,this);a=1,c=x.x+n.wrap*x.scale,h=x.y,es(_,_,[a/x.scale,a/x.scale,e.pixelsPerMeter/r])}else a=r/e.zoomScale(p.z),c=(p.x+Math.pow(2,p.z)*n.wrap)*a,h=p.y*a;return Ks(_,_,[c,h,0]),es(_,_,[a/zt,a/zt,1]),_}upVector(e,r,n){return[0,0,1]}upVectorScale(e,r,n){return{metersToTile:1,metersToLabelSpace:1}}}class ox extends as{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,r){return{x:yc(e),y:Qa(r),z:0}}unproject(e,r){const n=mn(e),a=sr(r);return new di(n,a)}}class sx extends as{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];const[r,n]=this.parallels=e.parallels||[29.5,45.5],a=Math.sin(We(r));this.n=(a+Math.sin(We(n)))/2,this.c=1+a*(2*this.n-a),this.r0=Math.sqrt(this.c)/this.n}project(e,r){const{n,c:a,r0:c}=this,h=We(e-this.center[0]),p=We(r),_=Math.sqrt(a-2*n*Math.sin(p))/n;return{x:_*Math.sin(h*n),y:_*Math.cos(h*n)-c,z:0}}unproject(e,r){const{n,c:a,r0:c}=this,h=c+r;let p=Math.atan2(e,Math.abs(h))*Math.sign(h);h*n<0&&(p-=Math.PI*Math.sign(e)*Math.sign(h));const _=We(this.center[0])*n;p=Qi(p,-Math.PI-_,Math.PI-_);const x=dt(p/n)+this.center[0],A=Math.asin(It((a-(e*e+h*h)*n*n)/(2*n),-1,1)),w=It(dt(A),-85.051129,qn);return new di(x,w)}}const Uc=1.340264,Vc=-.081106,Gc=893e-6,jc=.003796,kh=Math.sqrt(3)/2;class ax extends as{project(e,r){r=r/180*Math.PI,e=e/180*Math.PI;const n=Math.asin(kh*Math.sin(r)),a=n*n,c=a*a*a;return{x:.5*(e*Math.cos(n)/(kh*(Uc+3*Vc*a+c*(7*Gc+9*jc*a)))/Math.PI+.5),y:1-.5*(n*(Uc+Vc*a+c*(Gc+jc*a))/Math.PI+1),z:0}}unproject(e,r){e=(2*e-.5)*Math.PI;let n=r=(2*(1-r)-1)*Math.PI,a=n*n,c=a*a*a;for(let A,w,E,z=0;z<12&&(w=n*(Uc+Vc*a+c*(Gc+jc*a))-r,E=Uc+3*Vc*a+c*(7*Gc+9*jc*a),A=w/E,n=It(n-A,-Math.PI/3,Math.PI/3),a=n*n,c=a*a*a,!(Math.abs(A)<1e-12));++z);const h=kh*e*(Uc+3*Vc*a+c*(7*Gc+9*jc*a))/Math.cos(n),p=Math.asin(Math.sin(n)/kh),_=It(180*h/Math.PI,-180,180),x=It(180*p/Math.PI,-85.051129,qn);return new di(_,x)}}class lx extends as{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,r){return{x:.5+e/360,y:.5-r/360,z:0}}unproject(e,r){const n=360*(e-.5),a=It(360*(.5-r),-85.051129,qn);return new di(n,a)}}const dl=Math.PI/2;function Ph(i){return Math.tan((dl+i)/2)}class cx extends as{constructor(e){super(e),this.center=e.center||[0,30];const[r,n]=this.parallels=e.parallels||[30,30],a=We(r),c=We(n),h=Math.cos(a);this.n=a===c?Math.sin(a):Math.log(h/Math.cos(c))/Math.log(Ph(c)/Ph(a)),this.f=h*Math.pow(Ph(a),this.n)/this.n}project(e,r){r=We(r),e=We(e-this.center[0]);const n=1e-6,{n:a,f:c}=this;c>0?r<-dl+n&&(r=-dl+n):r>dl-n&&(r=dl-n);const h=c/Math.pow(Ph(r),a),p=h*Math.sin(a*e),_=c-h*Math.cos(a*e);return{x:.5*(p/Math.PI+.5),y:1-.5*(_/Math.PI+.5),z:0}}unproject(e,r){e=(2*e-.5)*Math.PI,r=(2*(1-r)-.5)*Math.PI;const{n,f:a}=this,c=a-r,h=Math.sign(c),p=Math.sign(n)*Math.sqrt(e*e+c*c);let _=Math.atan2(e,Math.abs(c))*h;c*n<0&&(_-=Math.PI*Math.sign(e)*h);const x=It(dt(_/n)+this.center[0],-180,180),A=It(dt(2*Math.atan(Math.pow(a/p,1/n))-dl),-85.051129,qn);return new di(x,A)}}const M_=We(qn);class ux extends as{project(e,r){const n=(r=We(r))*r,a=n*n;return{x:.5*((e=We(e))*(.8707-.131979*n+a*(a*(.003971*n-.001529*a)-.013791))/Math.PI+.5),y:1-.5*(r*(1.007226+n*(.015085+a*(.028874*n-.044475-.005916*a)))/Math.PI+1),z:0}}unproject(e,r){e=(2*e-.5)*Math.PI;let n=r=(2*(1-r)-1)*Math.PI,a=25,c=0,h=n*n;do{h=n*n;const x=h*h;c=(n*(1.007226+h*(.015085+x*(.028874*h-.044475-.005916*x)))-r)/(1.007226+h*(.045255+x*(.259866*h-.311325-.005916*11*x))),n=It(n-c,-M_,M_)}while(Math.abs(c)>1e-6&&--a>0);h=n*n;const p=It(dt(e/(.8707+h*(h*(h*h*h*(.003971-.001529*h)-.013791)-.131979))),-180,180),_=dt(n);return new di(p,_)}}const S_=We(qn);class hx extends as{project(e,r){r=We(r),e=We(e);const n=Math.cos(r),a=2/Math.PI,c=Math.acos(n*Math.cos(e/2)),h=Math.sin(c)/c,p=.5*(e*a+2*n*Math.sin(e/2)/h)||0,_=.5*(r+Math.sin(r)/h)||0;return{x:.5*(p/Math.PI+.5),y:1-.5*(_/Math.PI+1),z:0}}unproject(e,r){let n=e=(2*e-.5)*Math.PI,a=r=(2*(1-r)-1)*Math.PI,c=25;const h=1e-6;let p=0,_=0;do{const x=Math.cos(a),A=Math.sin(a),w=2*A*x,E=A*A,z=x*x,P=Math.cos(n/2),F=Math.sin(n/2),U=2*P*F,q=F*F,ie=1-z*P*P,oe=ie?1/ie:0,ae=ie?Math.acos(x*P)*Math.sqrt(1/ie):0,le=.5*(2*ae*x*F+2*n/Math.PI)-e,ce=.5*(ae*A+a)-r,we=.5*oe*(z*q+ae*x*P*E)+1/Math.PI,Me=oe*(U*w/4-ae*A*F),De=.125*oe*(w*F-ae*A*z*U),Pe=.5*oe*(E*P+ae*q*x)+.5,ve=Me*De-Pe*we;p=(ce*Me-le*Pe)/ve,_=(le*De-ce*we)/ve,n=It(n-p,-Math.PI,Math.PI),a=It(a-_,-S_,S_)}while((Math.abs(p)>h||Math.abs(_)>h)&&--c>0);return new di(dt(n),dt(a))}}class I_ extends as{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(We(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,r){const{scale:n,cosPhi:a}=this;return{x:We(e)*a*n+.5,y:-Math.sin(We(r))/a*n+.5,z:0}}unproject(e,r){const{scale:n,cosPhi:a}=this,c=-(r-.5)/n,h=It(dt((e-.5)/n)/a,-180,180),p=Math.asin(It(c*a,-1,1)),_=It(dt(p),-85.051129,qn);return new di(h,_)}}s.ARRAY_TYPE=jr,s.AUTH_ERR_MSG=bt,s.Aabb=an,s.Actor=class{constructor(i,e,r){this.target=i,this.parent=e,this.mapId=r,this.callbacks={},this.cancelCallbacks={},ci(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=ht()?i:Ee,this.scheduler=new q0}send(i,e,r,n,a=!1,c){const h=Math.round(1e18*Math.random()).toString(36).substring(0,10);r&&(r.metadata=c,this.callbacks[h]=r);const p=te(this.globalScope)?void 0:[];return this.target.postMessage({id:h,type:i,hasCallback:!!r,targetMapId:n,mustQueue:a,sourceMapId:this.mapId,data:Vs(e,p)},p),{cancel:()=>{r&&delete this.callbacks[h],this.target.postMessage({id:h,type:"<cancel>",targetMapId:n,sourceMapId:this.mapId})}}}receive(i){const e=i.data,r=e.id;if(r&&(!e.targetMapId||this.mapId===e.targetMapId))if(e.type==="<cancel>"){const n=this.cancelCallbacks[r];delete this.cancelCallbacks[r],n&&n.cancel()}else if(e.mustQueue||ht()){const n=this.callbacks[r];this.cancelCallbacks[r]=this.scheduler.add(()=>this.processTask(r,e),n&&n.metadata||{type:"message"})}else this.processTask(r,e)}processTask(i,e){if(e.type==="<response>"){const r=this.callbacks[i];delete this.callbacks[i],r&&(e.error?r(Wo(e.error)):r(null,Wo(e.data)))}else{const r=te(this.globalScope)?void 0:[],n=e.hasCallback?(c,h)=>{delete this.cancelCallbacks[i],this.target.postMessage({id:i,type:"<response>",sourceMapId:this.mapId,error:c?Vs(c):null,data:Vs(h,r)},r)}:c=>{},a=Wo(e.data);if(this.parent[e.type])this.parent[e.type](e.sourceMapId,a,n);else if(this.parent.getWorkerSource){const c=e.type.split(".");this.parent.getWorkerSource(e.sourceMapId,c[0],a.source)[c[1]](a,n)}else n(new Error(`Could not find function ${e.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},s.CanonicalTileID=Sh,s.Color=$t,s.ColorMode=Qn,s.CullFaceMode=zn,s.DEMData=zh,s.DataConstantProperty=g,s.DedupedRequest=E_,s.DepthMode=hl,s.EXTENT=zt,s.Elevation=class{isDataAvailableAtPoint(i){const e=this._source();if(!e||i.y<0||i.y>1)return!1;const r=e.getSource().maxzoom,n=1<<r,a=Math.floor(i.x),c=Math.floor((i.x-a)*n),h=Math.floor(i.y*n),p=this.findDEMTileFor(new vr(r,a,r,c,h));return!(!p||!p.dem)}getAtPointOrZero(i,e=0){return this.getAtPoint(i,e)||0}getAtPoint(i,e,r=!0){e==null&&(e=null);const n=this._source();if(!n||i.y<0||i.y>1)return e;const a=n.getSource().maxzoom,c=1<<a,h=Math.floor(i.x),p=i.x-h,_=new vr(a,h,a,Math.floor(p*c),Math.floor(i.y*c)),x=this.findDEMTileFor(_);if(!x||!x.dem)return e;const A=x.dem,w=1<<x.tileID.canonical.z,E=(p*w-x.tileID.canonical.x)*A.dim,z=(i.y*w-x.tileID.canonical.y)*A.dim,P=Math.floor(E),F=Math.floor(z);return(r?this.exaggeration():1)*yt(yt(A.get(P,F),A.get(P,F+1),z-F),yt(A.get(P+1,F),A.get(P+1,F+1),z-F),E-P)}getAtTileOffset(i,e,r){const n=1<<i.canonical.z;return this.getAtPointOrZero(new ah(i.wrap+(i.canonical.x+e/zt)/n,(i.canonical.y+r/zt)/n))}getAtTileOffsetFunc(i,e,r,n){return a=>{const c=this.getAtTileOffset(i,a.x,a.y),h=n.upVector(i.canonical,a.x,a.y);return vc(h,h,c*n.upVectorScale(i.canonical,e,r).metersToTile),h}}getForTilePoints(i,e,r,n){const a=Dh.create(this,i,n);return!!a&&(e.forEach(c=>{c[2]=this.exaggeration()*a.getElevationAt(c[0],c[1],r)}),!0)}getMinMaxForTile(i){const e=this.findDEMTileFor(i);if(!e||!e.dem)return null;const r=e.dem.tree,n=e.tileID,a=1<<i.canonical.z-n.canonical.z;let c=i.canonical.x/a-n.canonical.x,h=i.canonical.y/a-n.canonical.y,p=0;for(let _=0;_<i.canonical.z-n.canonical.z&&!r.leaves[p];_++){c*=2,h*=2;const x=2*Math.floor(h)+Math.floor(c);p=r.childOffsets[p]+x,c%=1,h%=1}return{min:this.exaggeration()*r.minimums[p],max:this.exaggeration()*r.maximums[p]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(i,e,r){throw new Error("Pure virtual method called.")}pointCoordinate(i){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(i){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},s.ErrorEvent=_t,s.EvaluationParameters=gi,s.Event=mt,s.Evented=Tt,s.FillExtrusionBucket=zc,s.Frustum=Wd,s.GLOBE_RADIUS=ul,s.GlobeSharedBuffers=class{constructor(i){this._createGrid(i),this._createPoles(i),this._createAtmosphere(i)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const i of this._poleSegments)i.destroy();this._gridSegments.destroy(),this.atmosphereVertexBuffer.destroy(),this.atmosphereIndexBuffer.destroy(),this.atmosphereSegments.destroy(),this._wireframeIndexBuffer&&(this._wireframeIndexBuffer.destroy(),this._wireframeSegments.destroy())}_createGrid(i){const e=new Y,r=new be,n=65;for(let a=0;a<n;a++)for(let c=0;c<n;c++)e.emplaceBack(c,a);for(let a=0;a<64;a++)for(let c=0;c<64;c++){const h=a*n+c;r.emplaceBack(h+1,h,h+n),r.emplaceBack(h+n,h+n+1,h+1)}this._gridBuffer=i.createVertexBuffer(e,Fc.members),this._gridIndexBuffer=i.createIndexBuffer(r,!0),this._gridSegments=ki.simpleSegment(0,0,4225,8192)}_createPoles(i){const e=new be;for(let a=0;a<=64;a++)e.emplaceBack(0,a+1,a+2);this._poleIndexBuffer=i.createIndexBuffer(e,!0);const r=new nt,n=new nt;this._poleSegments=[];for(let a=0,c=0;a<5;a++){const h=1<<a,p=512*h/Math.PI/2,_=360/h;r.emplaceBack(0,-p,0,0,0,.5,0),n.emplaceBack(0,-p,0,0,0,.5,1);for(let x=0;x<=64;x++){const A=x/64,w=yt(0,_,A),[E,z,P]=Jm(K0,$0,w,p);r.emplaceBack(E,z,P,0,0,A,0),n.emplaceBack(E,z,P,0,0,A,1)}this._poleSegments.push(ki.simpleSegment(c,0,66,64)),c+=66}this._poleNorthVertexBuffer=i.createVertexBuffer(r,Km,!1),this._poleSouthVertexBuffer=i.createVertexBuffer(n,Km,!1)}_createAtmosphere(i){const e=new At;e.emplaceBack(-1,1,1,0,0),e.emplaceBack(1,1,1,1,0),e.emplaceBack(1,-1,1,1,1),e.emplaceBack(-1,-1,1,0,1);const r=new be;r.emplaceBack(0,1,2),r.emplaceBack(2,3,0),this.atmosphereVertexBuffer=i.createVertexBuffer(e,H0.members),this.atmosphereIndexBuffer=i.createIndexBuffer(r),this.atmosphereSegments=ki.simpleSegment(0,0,4,2)}getGridBuffers(){return[this._gridBuffer,this._gridIndexBuffer,this._gridSegments]}getPoleBuffers(i){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[i]]}getWirefameBuffers(i){if(!this._wireframeSegments){const e=new ct,r=64,n=r+1;for(let a=0;a<r;a++)for(let c=0;c<r;c++){const h=a*n+c;e.emplaceBack(h,h+1),e.emplaceBack(h,h+n),e.emplaceBack(h,h+n+1)}this._wireframeIndexBuffer=i.createIndexBuffer(e),this._wireframeSegments=ki.simpleSegment(0,0,r*r,e.length)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments]}},s.GlyphManager=ll,s.ImagePosition=np,s.LineAtlas=gp,s.LngLat=di,s.LngLatBounds=Jo,s.LocalGlyphMode=lp,s.MAX_MERCATOR_LATITUDE=qn,s.MercatorCoordinate=ah,s.ONE_EM=ar,s.OverscaledTileID=vr,s.Properties=k,s.RGBAImage=Zr,s.Ray=class{constructor(i,e){this.pos=i,this.dir=e}intersectsPlane(i,e,r){const n=bc(e,this.dir);if(Math.abs(n)<1e-6)return!1;const a=((i[0]-this.pos[0])*e[0]+(i[1]-this.pos[1])*e[1]+(i[2]-this.pos[2])*e[2])/n;return r[0]=this.pos[0]+this.dir[0]*a,r[1]=this.pos[1]+this.dir[1]*a,r[2]=this.pos[2]+this.dir[2]*a,!0}closestPointOnSphere(i,e,r){if(function(E,z){var P=E[0],F=E[1],U=E[2],q=z[0],ie=z[1],oe=z[2];return Math.abs(P-q)<=Od*Math.max(1,Math.abs(P),Math.abs(q))&&Math.abs(F-ie)<=Od*Math.max(1,Math.abs(F),Math.abs(ie))&&Math.abs(U-oe)<=Od*Math.max(1,Math.abs(U),Math.abs(oe))}(this.pos,i)||e===0)return r[0]=r[1]=r[2]=0,!1;const[n,a,c]=this.dir,h=this.pos[0]-i[0],p=this.pos[1]-i[1],_=this.pos[2]-i[2],x=n*n+a*a+c*c,A=2*(h*n+p*a+_*c),w=A*A-4*x*(h*h+p*p+_*_-e*e);if(w<0){const E=Math.max(-A/2,0),z=h+n*E,P=p+a*E,F=_+c*E,U=Math.hypot(z,P,F);return r[0]=z*e/U,r[1]=P*e/U,r[2]=F*e/U,!1}{const E=(-A-Math.sqrt(w))/(2*x);if(E<0){const z=Math.hypot(h,p,_);return r[0]=h*e/z,r[1]=p*e/z,r[2]=_*e/z,!1}return r[0]=h+n*E,r[1]=p+a*E,r[2]=_+c*E,!0}}},s.RequestManager=class{constructor(i,e,r){this._transformRequestFn=i,this._customAccessToken=e,this._silenceAuthErrors=!!r,this._createSkuToken()}_createSkuToken(){const i=function(){let e="";for(let r=0;r<10;r++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ft,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=i.token,this._skuTokenExpiresAt=i.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(i,e){return this._transformRequestFn&&this._transformRequestFn(i,e)||{url:i}}normalizeStyleURL(i,e){if(!Et(i))return i;const r=qt(i);return r.path=`/styles/v1${r.path}`,this._makeAPIURL(r,this._customAccessToken||e)}normalizeGlyphsURL(i,e){if(!Et(i))return i;const r=qt(i);return r.path=`/fonts/v1${r.path}`,this._makeAPIURL(r,this._customAccessToken||e)}normalizeSourceURL(i,e){if(!Et(i))return i;const r=qt(i);return r.path=`/v4/${r.authority}.json`,r.params.push("secure"),this._makeAPIURL(r,this._customAccessToken||e)}normalizeSpriteURL(i,e,r,n){const a=qt(i);return Et(i)?(a.path=`/styles/v1${a.path}/sprite${e}${r}`,this._makeAPIURL(a,this._customAccessToken||n)):(a.path+=`${e}${r}`,si(a))}normalizeTileURL(i,e,r){if(this._isSkuTokenExpired()&&this._createSkuToken(),i&&!Et(i))return i;const n=qt(i);n.path=n.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||r&&n.authority!=="raster"&&r===512?"@2x":""}${Ye.supported?".webp":"$1"}`),n.authority==="raster"?n.path=`/${ze.RASTER_URL_PREFIX}${n.path}`:(n.path=n.path.replace(/^.+\/v4\//,"/"),n.path=`/${ze.TILE_URL_VERSION}${n.path}`);const a=this._customAccessToken||function(c){for(const h of c){const p=h.match(/^access_token=(.*)$/);if(p)return p[1]}return null}(n.params)||ze.ACCESS_TOKEN;return ze.REQUIRE_ACCESS_TOKEN&&a&&this._skuToken&&n.params.push(`sku=${this._skuToken}`),this._makeAPIURL(n,a)}canonicalizeTileURL(i,e){const r=qt(i);if(!r.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!r.path.match(/\.[\w]+$/))return i;let n="mapbox://";r.path.match(/^\/raster\/v1\//)?n+=`raster/${r.path.replace(`/${ze.RASTER_URL_PREFIX}/`,"")}`:n+=`tiles/${r.path.replace(`/${ze.TILE_URL_VERSION}/`,"")}`;let a=r.params;return e&&(a=a.filter(c=>!c.match(/^access_token=/))),a.length&&(n+=`?${a.join("&")}`),n}canonicalizeTileset(i,e){const r=!!e&&Et(e),n=[];for(const a of i.tiles||[])Ut(a)?n.push(this.canonicalizeTileURL(a,r)):n.push(a);return n}_makeAPIURL(i,e){const r="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",n=qt(ze.API_URL);if(i.protocol=n.protocol,i.authority=n.authority,i.protocol==="http"){const a=i.params.indexOf("secure");a>=0&&i.params.splice(a,1)}if(n.path!=="/"&&(i.path=`${n.path}${i.path}`),!ze.REQUIRE_ACCESS_TOKEN)return si(i);if(e=e||ze.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${r}`);if(e[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${r}`)}return i.params=i.params.filter(a=>a.indexOf("access_token")===-1),i.params.push(`access_token=${e||""}`),si(i)}},s.ResourceType=W,s.SegmentVector=ki,s.SourceCache=ta,s.StencilMode=wp,s.StructArrayLayout1ui2=Ct,s.StructArrayLayout2f1f2i16=Oe,s.StructArrayLayout2i4=Y,s.StructArrayLayout2ui4=ct,s.StructArrayLayout3f12=re,s.StructArrayLayout3ui6=be,s.StructArrayLayout4i8=ee,s.Texture=Rc,s.Tile=Ap,s.Transitionable=l,s.Uniform1f=oh,s.Uniform1i=class extends bo{constructor(i,e){super(i,e),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}},s.Uniform2f=class extends bo{constructor(i,e){super(i,e),this.current=[0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))}},s.Uniform3f=class extends bo{constructor(i,e){super(i,e),this.current=[0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))}},s.Uniform4f=Pf,s.UniformColor=Bf,s.UniformMatrix2f=class extends bo{constructor(i,e){super(i,e),this.current=Hy}set(i){for(let e=0;e<4;e++)if(i[e]!==this.current[e]){this.current=i,this.gl.uniformMatrix2fv(this.location,!1,i);break}}},s.UniformMatrix3f=class extends bo{constructor(i,e){super(i,e),this.current=Wy}set(i){for(let e=0;e<9;e++)if(i[e]!==this.current[e]){this.current=i,this.gl.uniformMatrix3fv(this.location,!1,i);break}}},s.UniformMatrix4f=class extends bo{constructor(i,e){super(i,e),this.current=qy}set(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let e=1;e<16;e++)if(i[e]!==this.current[e]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}},s.UnwrappedTileID=s_,s.ValidationError=$e,s.VectorTileWorkerSource=class extends Tt{constructor(i,e,r,n,a){super(),this.actor=i,this.layerIndex=e,this.availableImages=r,this.loadVectorData=a||C_,this.loading={},this.loaded={},this.deduped=new E_(i.scheduler),this.isSpriteLoaded=n,this.scheduler=i.scheduler}loadTile(i,e){const r=i.uid,n=i&&i.request,a=n&&n.collectResourceTiming,c=this.loading[r]=new rx(i);c.abort=this.loadVectorData(i,(h,p)=>{const _=!this.loading[r];if(delete this.loading[r],_||h||!p)return c.status="done",_||(this.loaded[r]=c),e(h);const x=p.rawData,A={};p.expires&&(A.expires=p.expires),p.cacheControl&&(A.cacheControl=p.cacheControl),c.vectorTile=p.vectorTile||new Js.VectorTile(new Pc(x));const w=()=>{c.parse(c.vectorTile,this.layerIndex,this.availableImages,this.actor,(E,z)=>{if(E||!z)return e(E);const P={};if(a){const F=Qm(n);F.length>0&&(P.resourceTiming=JSON.parse(JSON.stringify(F)))}e(null,mi({rawTileData:x.slice(0)},z,A,P))})};this.isSpriteLoaded?w():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(w,{type:"parseTile",isSymbolTile:i.isSymbolTile,zoom:i.tileZoom}):w()}),this.loaded=this.loaded||{},this.loaded[r]=c})}reloadTile(i,e){const r=this.loaded,n=i.uid,a=this;if(r&&r[n]){const c=r[n];c.showCollisionBoxes=i.showCollisionBoxes,c.enableTerrain=!!i.enableTerrain,c.projection=i.projection,c.tileTransform=ea(i.tileID.canonical,i.projection);const h=(p,_)=>{const x=c.reloadCallback;x&&(delete c.reloadCallback,c.parse(c.vectorTile,a.layerIndex,this.availableImages,a.actor,x)),e(p,_)};c.status==="parsing"?c.reloadCallback=h:c.status==="done"&&(c.vectorTile?c.parse(c.vectorTile,this.layerIndex,this.availableImages,this.actor,h):h())}}abortTile(i,e){const r=i.uid,n=this.loading[r];n&&(n.abort&&n.abort(),delete this.loading[r]),e()}removeTile(i,e){const r=this.loaded,n=i.uid;r&&r[n]&&delete r[n],e()}},s.WritingMode=ln,s.ZoomHistory=nc,s.add=Xf,s.addDynamicAttributes=dp,s.adjoint=function(i,e){var r=e[0],n=e[1],a=e[2],c=e[3],h=e[4],p=e[5],_=e[6],x=e[7],A=e[8];return i[0]=h*A-p*x,i[1]=a*x-n*A,i[2]=n*p-a*h,i[3]=p*_-c*A,i[4]=r*A-a*_,i[5]=a*c-r*p,i[6]=c*x-h*_,i[7]=n*_-r*x,i[8]=r*h-n*c,i},s.asyncAll=Ki,s.bezier=Jt,s.bindAll=ci,s.boundsAttributes=u_,s.bufferConvexPolygon=function(i,e){const r=[];for(let n=0;n<i.length;n++){const a=Qi(n-1,-1,i.length-1),c=Qi(n+1,-1,i.length-1),h=i[n],p=i[c],_=i[a].sub(h).unit(),x=p.sub(h).unit(),A=x.angleWithSep(_.x,_.y),w=_.add(x).unit().mult(-1*e/Math.sin(A/2));r.push(h.add(w))}return r},s.cacheEntryPossiblyAdded=function(i){Lo++,Lo>co&&(i.getActor().send("enforceCacheSizeLimit",lo),Lo=0)},s.calculateGlobeLabelMatrix=function(i,e){const{lng:r,lat:n}=i._center,a=i_(0,0,i.worldSize/i._projectionScaler,r,n);return Nd(a,a,function(c){const h=Wn(new Float64Array(16)),p=1/vp(c);return Ks(h,h,c.min),es(h,h,[p,p,p]),h}(Oc(e)))},s.calculateGlobeMatrix=r_,s.calculateGlobeMercatorMatrix=function(i){const e=i.worldSize,r=i.point,n=Ka(1,i.center.lat)*e,a=i.pixelsPerMeter,c=e/(n/i.pixelsPerMeter),h=Wn(new Float64Array(16));return Ks(h,h,[r.x,r.y,0]),es(h,h,[c,c,a]),Float32Array.from(h)},s.circumferenceAtLatitude=kd,s.clamp=It,s.clearTileCache=function(i){const e=Ee.caches.delete(ma);i&&e.catch(i).then(()=>i())},s.clipLine=Vm,s.clone=function(i){var e=new jr(16);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],e},s.clone$1=Li,s.collisionCircleLayout=r0,s.config=ze,s.conjugate=function(i,e){return i[0]=-e[0],i[1]=-e[1],i[2]=-e[2],i[3]=e[3],i},s.create=function(){var i=new jr(16);return jr!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i},s.create$1=Wf,s.createExpression=Ps,s.createLayout=Q,s.createStyleLayer=function(i){return i.type==="custom"?new U0(i):new G0[i.type](i)},s.cross=$f,s.degToRad=We,s.div=function(i,e,r){return i[0]=e[0]/r[0],i[1]=e[1]/r[1],i[2]=e[2]/r[2],i},s.dot=bc,s.earthRadius=Dd,s.ease=wi,s.easeCubicInOut=Xt,s.emitValidationErrors=Nu,s.endsWith=Wt,s.enforceCacheSizeLimit=function(i){Bo(),tn&&tn.then(e=>{e.keys().then(r=>{for(let n=0;n<r.length-i;n++)e.delete(r[n])})})},s.evaluateSizeForFeature=xh,s.evaluateSizeForZoom=nl,s.evaluateVariableOffset=Wm,s.evented=fc,s.exactEquals=function(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]&&i[3]===e[3]},s.exactEquals$1=function(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]},s.exported=Te,s.exported$1=Ye,s.extend=mi,s.extend$1=ei,s.filterObject=Or,s.fromMat4=function(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[4],i[4]=e[5],i[5]=e[6],i[6]=e[8],i[7]=e[9],i[8]=e[10],i},s.fromQuat=function(i,e){var r=e[0],n=e[1],a=e[2],c=e[3],h=r+r,p=n+n,_=a+a,x=r*h,A=n*h,w=n*p,E=a*h,z=a*p,P=a*_,F=c*h,U=c*p,q=c*_;return i[0]=1-w-P,i[1]=A+q,i[2]=E-U,i[3]=0,i[4]=A-q,i[5]=1-x-P,i[6]=z+F,i[7]=0,i[8]=E+U,i[9]=z-F,i[10]=1-x-w,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},s.fromRotation=function(i,e){var r=Math.sin(e),n=Math.cos(e);return i[0]=n,i[1]=r,i[2]=0,i[3]=-r,i[4]=n,i[5]=0,i[6]=0,i[7]=0,i[8]=1,i},s.fromScaling=function(i,e){return i[0]=e[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=e[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=e[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},s.furthestTileCorner=function(i){const e=Math.round((i+45+360)%360/90)%4;return Lt[e]},s.getAABBPointSquareDist=function(i,e,r){let n=0;for(let a=0;a<2;++a){const c=r?r[a]:0;i[a]>c&&(n+=(i[a]-c)*(i[a]-c)),e[a]<c&&(n+=(c-e[a])*(c-e[a]))}return n},s.getAnchorAlignment=ap,s.getAnchorJustification=up,s.getBounds=function(i){let e=1/0,r=1/0,n=-1/0,a=-1/0;for(const c of i)e=Math.min(e,c.x),r=Math.min(r,c.y),n=Math.max(n,c.x),a=Math.max(a,c.y);return{min:new J(e,r),max:new J(n,a)}},s.getColumn=function(i,e){return[i[4*e],i[4*e+1],i[4*e+2],i[4*e+3]]},s.getGridMatrix=function(i,e){const[r,n]=e,a=.015625;return[0,(n[1]-r[1])*a,1<<i.z,(n[0]-r[0])*a,0,i.y,r[0],r[1],a]},s.getImage=Ke,s.getJSON=function(i,e){return j(mi(i,{type:"json"}),e)},s.getMapSessionAPI=so,s.getPerformanceMeasurement=Qm,s.getProjection=function(i){const e=i.parallels,r=!!e&&Math.abs(e[0]+e[1])<.01;switch(i.name){case"mercator":return new ox(i);case"equirectangular":return new lx(i);case"naturalEarth":return new ux(i);case"equalEarth":return new ax(i);case"winkelTripel":return new hx(i);case"albers":return r?new I_(i):new sx(i);case"lambertConformalConic":return r?new I_(i):new cx(i)}throw new Error(`Invalid projection name: ${i.name}`)},s.getRTLTextPluginStatus=Ya,s.getReferrer=L,s.getTilePoint=function(i,{x:e,y:r},n=0){return new J(((e-n)*i.scale-i.x)*zt,(r*i.scale-i.y)*zt)},s.getTileVec3=function(i,e,r=0){return xc(((e.x-r)*i.scale-i.x)*zt,(e.y*i.scale-i.y)*zt,Ff(e.z,e.y))},s.getVideo=function(i,e){const r=Ee.document.createElement("video");r.muted=!0,r.onloadstart=function(){e(null,r)};for(let n=0;n<i.length;n++){const a=Ee.document.createElement("source");fe(i[n])||(r.crossOrigin="Anonymous"),a.src=i[n],r.appendChild(a)}return{cancel:()=>{}}},s.globeECEFOrigin=function(i,e){const r=[0,0,0];return $s(r,r,t_(Oc(e.canonical))),$s(r,r,i),r},s.globePixelsToTileUnits=function(i,e){return zt/(512*Math.pow(2,i))*vp(Oc(e))},s.globePoleMatrixForTile=function(i,e,r){const n=Wn(new Float64Array(16)),a=1<<i,c=360*(e/a-.5),h=r.point,p=r.worldSize/(r.tileSize*a);return Ks(n,n,[h.x,h.y,-r.worldSize/Math.PI/2]),es(n,n,[p,p,p]),Ud(n,n,We(-r._center.lat)),Vd(n,n,We(-r._center.lng+c)),Float32Array.from(n)},s.globeTileLatLngCorners=xp,s.globeToMercatorTransition=function(i){return cr(5,6,i)},s.identity=Wn,s.identity$1=tm,s.invert=function(i,e){var r=e[0],n=e[1],a=e[2],c=e[3],h=e[4],p=e[5],_=e[6],x=e[7],A=e[8],w=e[9],E=e[10],z=e[11],P=e[12],F=e[13],U=e[14],q=e[15],ie=r*p-n*h,oe=r*_-a*h,ae=r*x-c*h,le=n*_-a*p,ce=n*x-c*p,we=a*x-c*_,Me=A*F-w*P,De=A*U-E*P,Pe=A*q-z*P,ve=w*U-E*F,Ie=w*q-z*F,Re=E*q-z*U,Ze=ie*Re-oe*Ie+ae*ve+le*Pe-ce*De+we*Me;return Ze?(i[0]=(p*Re-_*Ie+x*ve)*(Ze=1/Ze),i[1]=(a*Ie-n*Re-c*ve)*Ze,i[2]=(F*we-U*ce+q*le)*Ze,i[3]=(E*ce-w*we-z*le)*Ze,i[4]=(_*Pe-h*Re-x*De)*Ze,i[5]=(r*Re-a*Pe+c*De)*Ze,i[6]=(U*ae-P*we-q*oe)*Ze,i[7]=(A*we-E*ae+z*oe)*Ze,i[8]=(h*Ie-p*Pe+x*Me)*Ze,i[9]=(n*Pe-r*Ie-c*Me)*Ze,i[10]=(P*ce-F*ae+q*ie)*Ze,i[11]=(w*ae-A*ce-z*ie)*Ze,i[12]=(p*De-h*ve-_*Me)*Ze,i[13]=(r*ve-n*De+a*Me)*Ze,i[14]=(F*oe-P*le-U*ie)*Ze,i[15]=(A*le-w*oe+E*ie)*Ze,i):null},s.isMapAuthenticated=function(i){return ao.has(i)},s.isMapboxURL=Et,s.isSafariWithAntialiasingBug=function(i){const e=i.navigator?i.navigator.userAgent:null;return!!te(i)&&e&&(e.match("Version/15.4")||e.match("Version/15.5")||e.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},s.latFromMercatorY=sr,s.len=u1,s.length=Yf,s.length$1=function(i){return Math.hypot(i[0],i[1],i[2],i[3])},s.loadVectorTile=C_,s.makeRequest=j,s.mercatorXfromLng=yc,s.mercatorYfromLat=Qa,s.mercatorZfromAltitude=Ka,s.mul=l1,s.mul$1=c1,s.multiply=function(i,e,r){var n=e[0],a=e[1],c=e[2],h=e[3],p=e[4],_=e[5],x=e[6],A=e[7],w=e[8],E=r[0],z=r[1],P=r[2],F=r[3],U=r[4],q=r[5],ie=r[6],oe=r[7],ae=r[8];return i[0]=E*n+z*h+P*x,i[1]=E*a+z*p+P*A,i[2]=E*c+z*_+P*w,i[3]=F*n+U*h+q*x,i[4]=F*a+U*p+q*A,i[5]=F*c+U*_+q*w,i[6]=ie*n+oe*h+ae*x,i[7]=ie*a+oe*p+ae*A,i[8]=ie*c+oe*_+ae*w,i},s.multiply$1=Nd,s.multiply$2=Kf,s.nextPowerOfTwo=en,s.normalize=Ac,s.normalize$1=function(i,e){var r=e[0],n=e[1],a=e[2],c=e[3],h=r*r+n*n+a*a+c*c;return h>0&&(h=1/Math.sqrt(h)),i[0]=r*h,i[1]=n*h,i[2]=a*h,i[3]=c*h,i},s.number=yt,s.ortho=function(i,e,r,n,a,c,h){var p=1/(e-r),_=1/(n-a),x=1/(c-h);return i[0]=-2*p,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*_,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*x,i[11]=0,i[12]=(e+r)*p,i[13]=(a+n)*_,i[14]=(h+c)*x,i[15]=1,i},s.pbf=Pc,s.perspective=function(i,e,r,n,a){var c,h=1/Math.tan(e/2);return i[0]=h/r,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=h,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,a!=null&&a!==1/0?(i[10]=(a+n)*(c=1/(n-a)),i[14]=2*a*n*c):(i[10]=-1,i[14]=-2*n),i},s.pick=function(i,e){const r={};for(let n=0;n<e.length;n++){const a=e[n];a in i&&(r[a]=i[a])}return r},s.plugin=Vr,s.pointGeometry=J,s.polygonIntersectsBox=jf,s.polygonIntersectsPolygon=Nf,s.polygonizeBounds=function(i,e,r=0,n=!0){const a=new J(r,r),c=i.sub(a),h=e.add(a),p=[c,new J(h.x,c.y),h,new J(c.x,h.y)];return n&&p.push(c),p},s.posAttributes=Fc,s.postMapLoadEvent=Wi,s.postTurnstileEvent=xn,s.potpack=rp,s.prevPowerOfTwo=function(i){return i<=1?1:Math.pow(2,Math.floor(Math.log(i)/Math.LN2))},s.radToDeg=dt,s.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],s.registerForPluginStateChange=function(i){return i({pluginStatus:xr,pluginURL:Ir}),fc.on("pluginStateChange",i),i},s.removeAuthState=function(i){ao.delete(i)},s.renderColorRamp=Yd,s.rotateX=Ud,s.rotateX$1=im,s.rotateY=Vd,s.rotateZ=function(i,e,r){var n=Math.sin(r),a=Math.cos(r),c=e[0],h=e[1],p=e[2],_=e[3],x=e[4],A=e[5],w=e[6],E=e[7];return e!==i&&(i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[0]=c*a+x*n,i[1]=h*a+A*n,i[2]=p*a+w*n,i[3]=_*a+E*n,i[4]=x*a-c*n,i[5]=A*a-h*n,i[6]=w*a-p*n,i[7]=E*a-_*n,i},s.rotateZ$1=function(i,e,r){r*=.5;var n=e[0],a=e[1],c=e[2],h=e[3],p=Math.sin(r),_=Math.cos(r);return i[0]=n*_+a*p,i[1]=a*_-n*p,i[2]=c*_+h*p,i[3]=h*_-c*p,i},s.scale=es,s.scale$1=function(i,e,r){return i[0]=e[0]*r,i[1]=e[1]*r,i[2]=e[2]*r,i[3]=e[3]*r,i},s.scale$2=vc,s.scaleAndAdd=qd,s.setCacheLimits=function(i,e){lo=i,co=e},s.setColumn=function(i,e,r){i[4*e+0]=r[0],i[4*e+1]=r[1],i[4*e+2]=r[2],i[4*e+3]=r[3]},s.setRTLTextPlugin=function(i,e,r=!1){if(xr===hc||xr===qs||xr===dc)throw new Error("setRTLTextPlugin cannot be called multiple times.");Ir=Te.resolveURL(i),xr=hc,pc=e,vo(),r||Yo()},s.smoothstep=cr,s.spec=xe,s.storeAuthState=function(i,e){e?ao.add(i):ao.delete(i)},s.sub=el,s.subtract=Qf,s.symbolSize=n0,s.tileAABB=function(i,e,r,n,a,c,h,p,_){if(_.name==="globe")return Q0(i,e,new Sh(r,n,a));const x=ea({z:r,x:n,y:a},_);return new an([(c+x.x/x.scale)*e,e*(x.y/x.scale),h],[(c+x.x2/x.scale)*e,e*(x.y2/x.scale),p])},s.tileTransform=ea,s.transformMat3=function(i,e,r){var n=e[0],a=e[1],c=e[2];return i[0]=n*r[0]+a*r[3]+c*r[6],i[1]=n*r[1]+a*r[4]+c*r[7],i[2]=n*r[2]+a*r[5]+c*r[8],i},s.transformMat4=$s,s.transformMat4$1=tl,s.transformQuat=Jf,s.translate=Ks,s.transpose=function(i,e){if(i===e){var r=e[1],n=e[2],a=e[5];i[1]=e[3],i[2]=e[6],i[3]=r,i[5]=e[7],i[6]=n,i[7]=a}else i[0]=e[0],i[1]=e[3],i[2]=e[6],i[3]=e[1],i[4]=e[4],i[5]=e[7],i[6]=e[2],i[7]=e[5],i[8]=e[8];return i},s.triggerPluginCompletionEvent=Ws,s.uniqueId=Tr,s.validateCustomStyleLayer=function(i){const e=[],r=i.id;return r===void 0&&e.push({message:`layers.${r}: missing required property "id"`}),i.render===void 0&&e.push({message:`layers.${r}: missing required method "render"`}),i.renderingMode&&i.renderingMode!=="2d"&&i.renderingMode!=="3d"&&e.push({message:`layers.${r}: property "renderingMode" must be either "2d" or "3d"`}),e},s.validateFilter=i=>En(Vn(i)),s.validateFog=i=>En(Ou(i)),s.validateLayer=i=>En(Pu(i)),s.validateLight=i=>En(Ru(i)),s.validateSource=i=>En(Lu(i)),s.validateStyle=Us,s.validateTerrain=i=>En(Fu(i)),s.values=_r,s.vectorTile=Js,s.version=K,s.warnOnce=Ot,s.window=Ee,s.wrap=Qi}),B(["./shared"],function(s){function K(W){if(typeof W=="number"||typeof W=="boolean"||typeof W=="string"||W==null)return JSON.stringify(W);if(Array.isArray(W)){let L="[";for(const j of W)L+=`${K(j)},`;return`${L}]`}let D="{";for(const L of Object.keys(W).sort())D+=`${L}:${K(W[L])},`;return`${D}}`}function ue(W){let D="";for(const L of s.refProperties)D+=`/${K(W[L])}`;return D}class he{constructor(D){this.keyCache={},D&&this.replace(D)}replace(D){this._layerConfigs={},this._layers={},this.update(D,[])}update(D,L){for(const $ of D)this._layerConfigs[$.id]=$,(this._layers[$.id]=s.createStyleLayer($)).compileFilter(),this.keyCache[$.id]&&delete this.keyCache[$.id];for(const $ of L)delete this.keyCache[$],delete this._layerConfigs[$],delete this._layers[$];this.familiesBySource={};const j=function($,ne){const me={};for(let se=0;se<$.length;se++){const ye=ne&&ne[$[se].id]||ue($[se]);ne&&(ne[$[se].id]=ye);let ke=me[ye];ke||(ke=me[ye]=[]),ke.push($[se])}const fe=[];for(const se in me)fe.push(me[se]);return fe}(s.values(this._layerConfigs),this.keyCache);for(const $ of j){const ne=$.map(Ke=>this._layers[Ke.id]),me=ne[0];if(me.visibility==="none")continue;const fe=me.source||"";let se=this.familiesBySource[fe];se||(se=this.familiesBySource[fe]={});const ye=me.sourceLayer||"_geojsonTileLayer";let ke=se[ye];ke||(ke=se[ye]=[]),ke.push(ne)}}}class J{loadTile(D,L){const{uid:j,encoding:$,rawImageData:ne,padding:me,buildQuadTree:fe}=D,se=s.window.ImageBitmap&&ne instanceof s.window.ImageBitmap?this.getImageData(ne,me):ne;L(null,new s.DEMData(j,se,$,me<1,fe))}getImageData(D,L){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(D.width,D.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=D.width,this.offscreenCanvas.height=D.height,this.offscreenCanvasContext.drawImage(D,0,0,D.width,D.height);const j=this.offscreenCanvasContext.getImageData(-L,-L,D.width+2*L,D.height+2*L);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),j}}var pe=function W(D,L){var j,$=D&&D.type;if($==="FeatureCollection")for(j=0;j<D.features.length;j++)W(D.features[j],L);else if($==="GeometryCollection")for(j=0;j<D.geometries.length;j++)W(D.geometries[j],L);else if($==="Feature")W(D.geometry,L);else if($==="Polygon")Ee(D.coordinates,L);else if($==="MultiPolygon")for(j=0;j<D.coordinates.length;j++)Ee(D.coordinates[j],L);return D};function Ee(W,D){if(W.length!==0){ut(W[0],D);for(var L=1;L<W.length;L++)ut(W[L],!D)}}function ut(W,D){for(var L=0,j=0,$=0,ne=W.length,me=ne-1;$<ne;me=$++){var fe=(W[$][0]-W[me][0])*(W[me][1]+W[$][1]),se=L+fe;j+=Math.abs(L)>=Math.abs(fe)?L-se+fe:fe-se+L,L=se}L+j>=0!=!!D&&W.reverse()}const Dt=s.vectorTile.VectorTileFeature.prototype.toGeoJSON;class We{constructor(D){this._feature=D,this.extent=s.EXTENT,this.type=D.type,this.properties=D.tags,"id"in D&&!isNaN(D.id)&&(this.id=parseInt(D.id,10))}loadGeometry(){if(this._feature.type===1){const D=[];for(const L of this._feature.geometry)D.push([new s.pointGeometry(L[0],L[1])]);return D}{const D=[];for(const L of this._feature.geometry){const j=[];for(const $ of L)j.push(new s.pointGeometry($[0],$[1]));D.push(j)}return D}}toGeoJSON(D,L,j){return Dt.call(this,D,L,j)}}class dt{constructor(D){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=s.EXTENT,this.length=D.length,this._features=D}feature(D){return new We(this._features[D])}}var Lt=s.vectorTile.VectorTileFeature,Xt=Jt;function Jt(W,D){this.options=D||{},this.features=W,this.length=W.length}function wi(W,D){this.id=typeof W.id=="number"?W.id:void 0,this.type=W.type,this.rawGeometry=W.type===1?[W.geometry]:W.geometry,this.properties=W.tags,this.extent=D||4096}Jt.prototype.feature=function(W){return new wi(this.features[W],this.options.extent)},wi.prototype.loadGeometry=function(){var W=this.rawGeometry;this.geometry=[];for(var D=0;D<W.length;D++){for(var L=W[D],j=[],$=0;$<L.length;$++)j.push(new s.pointGeometry(L[$][0],L[$][1]));this.geometry.push(j)}return this.geometry},wi.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var W=this.geometry,D=1/0,L=-1/0,j=1/0,$=-1/0,ne=0;ne<W.length;ne++)for(var me=W[ne],fe=0;fe<me.length;fe++){var se=me[fe];D=Math.min(D,se.x),L=Math.max(L,se.x),j=Math.min(j,se.y),$=Math.max($,se.y)}return[D,j,L,$]},wi.prototype.toGeoJSON=Lt.prototype.toGeoJSON;var It=Qi,cr=Xt;function Qi(W){var D=new s.pbf;return function(L,j){for(var $ in L.layers)j.writeMessage(3,Ki,L.layers[$])}(W,D),D.finish()}function Ki(W,D){var L;D.writeVarintField(15,W.version||1),D.writeStringField(1,W.name||""),D.writeVarintField(5,W.extent||4096);var j={keys:[],values:[],keycache:{},valuecache:{}};for(L=0;L<W.length;L++)j.feature=W.feature(L),D.writeMessage(2,_r,j);var $=j.keys;for(L=0;L<$.length;L++)D.writeStringField(3,$[L]);var ne=j.values;for(L=0;L<ne.length;L++)D.writeMessage(4,en,ne[L])}function _r(W,D){var L=W.feature;L.id!==void 0&&D.writeVarintField(1,L.id),D.writeMessage(2,mi,W),D.writeVarintField(3,L.type),D.writeMessage(4,Jr,L)}function mi(W,D){var L=W.feature,j=W.keys,$=W.values,ne=W.keycache,me=W.valuecache;for(var fe in L.properties){var se=L.properties[fe],ye=ne[fe];if(se!==null){ye===void 0&&(j.push(fe),ne[fe]=ye=j.length-1),D.writeVarint(ye);var ke=typeof se;ke!=="string"&&ke!=="boolean"&&ke!=="number"&&(se=JSON.stringify(se));var Ke=ke+":"+se,Le=me[Ke];Le===void 0&&($.push(se),me[Ke]=Le=$.length-1),D.writeVarint(Le)}}}function ur(W,D){return(D<<3)+(7&W)}function Tr(W){return W<<1^W>>31}function Jr(W,D){for(var L=W.loadGeometry(),j=W.type,$=0,ne=0,me=L.length,fe=0;fe<me;fe++){var se=L[fe],ye=1;j===1&&(ye=se.length),D.writeVarint(ur(1,ye));for(var ke=j===3?se.length-1:se.length,Ke=0;Ke<ke;Ke++){Ke===1&&j!==1&&D.writeVarint(ur(2,ke-1));var Le=se[Ke].x-$,vt=se[Ke].y-ne;D.writeVarint(Tr(Le)),D.writeVarint(Tr(vt)),$+=Le,ne+=vt}j===3&&D.writeVarint(ur(7,1))}}function en(W,D){var L=typeof W;L==="string"?D.writeStringField(1,W):L==="boolean"?D.writeBooleanField(7,W):L==="number"&&(W%1!=0?D.writeDoubleField(3,W):W<0?D.writeSVarintField(6,W):D.writeVarintField(5,W))}function Ai(W,D,L,j,$,ne){if($-j<=L)return;const me=j+$>>1;ci(W,D,me,j,$,ne%2),Ai(W,D,L,j,me-1,ne+1),Ai(W,D,L,me+1,$,ne+1)}function ci(W,D,L,j,$,ne){for(;$>j;){if($-j>600){const ye=$-j+1,ke=L-j+1,Ke=Math.log(ye),Le=.5*Math.exp(2*Ke/3),vt=.5*Math.sqrt(Ke*Le*(ye-Le)/ye)*(ke-ye/2<0?-1:1);ci(W,D,L,Math.max(j,Math.floor(L-ke*Le/ye+vt)),Math.min($,Math.floor(L+(ye-ke)*Le/ye+vt)),ne)}const me=D[2*L+ne];let fe=j,se=$;for(Wt(W,D,j,L),D[2*$+ne]>me&&Wt(W,D,j,$);fe<se;){for(Wt(W,D,fe,se),fe++,se--;D[2*fe+ne]<me;)fe++;for(;D[2*se+ne]>me;)se--}D[2*j+ne]===me?Wt(W,D,j,se):(se++,Wt(W,D,se,$)),se<=L&&(j=se+1),L<=se&&($=se-1)}}function Wt(W,D,L,j){Bi(W,L,j),Bi(D,2*L,2*j),Bi(D,2*L+1,2*j+1)}function Bi(W,D,L){const j=W[D];W[D]=W[L],W[L]=j}function Or(W,D,L,j){const $=W-L,ne=D-j;return $*$+ne*ne}It.fromVectorTileJs=Qi,It.fromGeojsonVt=function(W,D){D=D||{};var L={};for(var j in W)L[j]=new Xt(W[j].features,D),L[j].name=j,L[j].version=D.version,L[j].extent=D.extent;return Qi({layers:L})},It.GeoJSONWrapper=cr;const Li=W=>W[0],hr=W=>W[1];class Ot{constructor(D,L=Li,j=hr,$=64,ne=Float64Array){this.nodeSize=$,this.points=D;const me=D.length<65536?Uint16Array:Uint32Array,fe=this.ids=new me(D.length),se=this.coords=new ne(2*D.length);for(let ye=0;ye<D.length;ye++)fe[ye]=ye,se[2*ye]=L(D[ye]),se[2*ye+1]=j(D[ye]);Ai(fe,se,$,0,fe.length-1,0)}range(D,L,j,$){return function(ne,me,fe,se,ye,ke,Ke){const Le=[0,ne.length-1,0],vt=[];let mt,_t;for(;Le.length;){const Tt=Le.pop(),xe=Le.pop(),ei=Le.pop();if(xe-ei<=Ke){for(let ti=ei;ti<=xe;ti++)mt=me[2*ti],_t=me[2*ti+1],mt>=fe&&mt<=ye&&_t>=se&&_t<=ke&&vt.push(ne[ti]);continue}const at=Math.floor((ei+xe)/2);mt=me[2*at],_t=me[2*at+1],mt>=fe&&mt<=ye&&_t>=se&&_t<=ke&&vt.push(ne[at]);const Kt=(Tt+1)%2;(Tt===0?fe<=mt:se<=_t)&&(Le.push(ei),Le.push(at-1),Le.push(Kt)),(Tt===0?ye>=mt:ke>=_t)&&(Le.push(at+1),Le.push(xe),Le.push(Kt))}return vt}(this.ids,this.coords,D,L,j,$,this.nodeSize)}within(D,L,j){return function($,ne,me,fe,se,ye){const ke=[0,$.length-1,0],Ke=[],Le=se*se;for(;ke.length;){const vt=ke.pop(),mt=ke.pop(),_t=ke.pop();if(mt-_t<=ye){for(let Kt=_t;Kt<=mt;Kt++)Or(ne[2*Kt],ne[2*Kt+1],me,fe)<=Le&&Ke.push($[Kt]);continue}const Tt=Math.floor((_t+mt)/2),xe=ne[2*Tt],ei=ne[2*Tt+1];Or(xe,ei,me,fe)<=Le&&Ke.push($[Tt]);const at=(vt+1)%2;(vt===0?me-se<=xe:fe-se<=ei)&&(ke.push(_t),ke.push(Tt-1),ke.push(at)),(vt===0?me+se>=xe:fe+se>=ei)&&(ke.push(Tt+1),ke.push(mt),ke.push(at))}return Ke}(this.ids,this.coords,D,L,j,this.nodeSize)}}const Ui={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:W=>W},Be=Math.fround||(ht=new Float32Array(1),W=>(ht[0]=+W,ht[0]));var ht;class Je{constructor(D){this.options=Te(Object.create(Ui),D),this.trees=new Array(this.options.maxZoom+1)}load(D){const{log:L,minZoom:j,maxZoom:$,nodeSize:ne}=this.options;L&&console.time("total time");const me=`prepare ${D.length} points`;L&&console.time(me),this.points=D;let fe=[];for(let se=0;se<D.length;se++)D[se].geometry&&fe.push(ui(D[se],se));this.trees[$+1]=new Ot(fe,Fe,ze,ne,Float32Array),L&&console.timeEnd(me);for(let se=$;se>=j;se--){const ye=+Date.now();fe=this._cluster(fe,se),this.trees[se]=new Ot(fe,Fe,ze,ne,Float32Array),L&&console.log("z%d: %d clusters in %dms",se,fe.length,+Date.now()-ye)}return L&&console.timeEnd("total time"),this}getClusters(D,L){let j=((D[0]+180)%360+360)%360-180;const $=Math.max(-90,Math.min(90,D[1]));let ne=D[2]===180?180:((D[2]+180)%360+360)%360-180;const me=Math.max(-90,Math.min(90,D[3]));if(D[2]-D[0]>=360)j=-180,ne=180;else if(j>ne){const ke=this.getClusters([j,$,180,me],L),Ke=this.getClusters([-180,$,ne,me],L);return ke.concat(Ke)}const fe=this.trees[this._limitZoom(L)],se=fe.range(it(j),te(me),it(ne),te($)),ye=[];for(const ke of se){const Ke=fe.points[ke];ye.push(Ke.numPoints?oi(Ke):this.points[Ke.index])}return ye}getChildren(D){const L=this._getOriginId(D),j=this._getOriginZoom(D),$="No cluster with the specified id.",ne=this.trees[j];if(!ne)throw new Error($);const me=ne.points[L];if(!me)throw new Error($);const fe=this.options.radius/(this.options.extent*Math.pow(2,j-1)),se=ne.within(me.x,me.y,fe),ye=[];for(const ke of se){const Ke=ne.points[ke];Ke.parentId===D&&ye.push(Ke.numPoints?oi(Ke):this.points[Ke.index])}if(ye.length===0)throw new Error($);return ye}getLeaves(D,L,j){const $=[];return this._appendLeaves($,D,L=L||10,j=j||0,0),$}getTile(D,L,j){const $=this.trees[this._limitZoom(D)],ne=Math.pow(2,D),{extent:me,radius:fe}=this.options,se=fe/me,ye=(j-se)/ne,ke=(j+1+se)/ne,Ke={features:[]};return this._addTileFeatures($.range((L-se)/ne,ye,(L+1+se)/ne,ke),$.points,L,j,ne,Ke),L===0&&this._addTileFeatures($.range(1-se/ne,ye,1,ke),$.points,ne,j,ne,Ke),L===ne-1&&this._addTileFeatures($.range(0,ye,se/ne,ke),$.points,-1,j,ne,Ke),Ke.features.length?Ke:null}getClusterExpansionZoom(D){let L=this._getOriginZoom(D)-1;for(;L<=this.options.maxZoom;){const j=this.getChildren(D);if(L++,j.length!==1)break;D=j[0].properties.cluster_id}return L}_appendLeaves(D,L,j,$,ne){const me=this.getChildren(L);for(const fe of me){const se=fe.properties;if(se&&se.cluster?ne+se.point_count<=$?ne+=se.point_count:ne=this._appendLeaves(D,se.cluster_id,j,$,ne):ne<$?ne++:D.push(fe),D.length===j)break}return ne}_addTileFeatures(D,L,j,$,ne,me){for(const fe of D){const se=L[fe],ye=se.numPoints;let ke,Ke,Le;if(ye)ke=kt(se),Ke=se.x,Le=se.y;else{const _t=this.points[se.index];ke=_t.properties,Ke=it(_t.geometry.coordinates[0]),Le=te(_t.geometry.coordinates[1])}const vt={type:1,geometry:[[Math.round(this.options.extent*(Ke*ne-j)),Math.round(this.options.extent*(Le*ne-$))]],tags:ke};let mt;ye?mt=se.id:this.options.generateId?mt=se.index:this.points[se.index].id&&(mt=this.points[se.index].id),mt!==void 0&&(vt.id=mt),me.features.push(vt)}}_limitZoom(D){return Math.max(this.options.minZoom,Math.min(+D,this.options.maxZoom+1))}_cluster(D,L){const j=[],{radius:$,extent:ne,reduce:me,minPoints:fe}=this.options,se=$/(ne*Math.pow(2,L));for(let ye=0;ye<D.length;ye++){const ke=D[ye];if(ke.zoom<=L)continue;ke.zoom=L;const Ke=this.trees[L+1],Le=Ke.within(ke.x,ke.y,se),vt=ke.numPoints||1;let mt=vt;for(const _t of Le){const Tt=Ke.points[_t];Tt.zoom>L&&(mt+=Tt.numPoints||1)}if(mt>vt&&mt>=fe){let _t=ke.x*vt,Tt=ke.y*vt,xe=me&&vt>1?this._map(ke,!0):null;const ei=(ye<<5)+(L+1)+this.points.length;for(const at of Le){const Kt=Ke.points[at];if(Kt.zoom<=L)continue;Kt.zoom=L;const ti=Kt.numPoints||1;_t+=Kt.x*ti,Tt+=Kt.y*ti,Kt.parentId=ei,me&&(xe||(xe=this._map(ke,!0)),me(xe,this._map(Kt)))}ke.parentId=ei,j.push(xt(_t/mt,Tt/mt,ei,mt,xe))}else if(j.push(ke),mt>1)for(const _t of Le){const Tt=Ke.points[_t];Tt.zoom<=L||(Tt.zoom=L,j.push(Tt))}}return j}_getOriginId(D){return D-this.points.length>>5}_getOriginZoom(D){return(D-this.points.length)%32}_map(D,L){if(D.numPoints)return L?Te({},D.properties):D.properties;const j=this.points[D.index].properties,$=this.options.map(j);return L&&$===j?Te({},$):$}}function xt(W,D,L,j,$){return{x:Be(W),y:Be(D),zoom:1/0,id:L,parentId:-1,numPoints:j,properties:$}}function ui(W,D){const[L,j]=W.geometry.coordinates;return{x:Be(it(L)),y:Be(te(j)),zoom:1/0,index:D,parentId:-1}}function oi(W){return{type:"Feature",id:W.id,properties:kt(W),geometry:{type:"Point",coordinates:[(D=W.x,360*(D-.5)),de(W.y)]}};var D}function kt(W){const D=W.numPoints,L=D>=1e4?`${Math.round(D/1e3)}k`:D>=1e3?Math.round(D/100)/10+"k":D;return Te(Te({},W.properties),{cluster:!0,cluster_id:W.id,point_count:D,point_count_abbreviated:L})}function it(W){return W/360+.5}function te(W){const D=Math.sin(W*Math.PI/180),L=.5-.25*Math.log((1+D)/(1-D))/Math.PI;return L<0?0:L>1?1:L}function de(W){const D=(180-360*W)*Math.PI/180;return 360*Math.atan(Math.exp(D))/Math.PI-90}function Te(W,D){for(const L in D)W[L]=D[L];return W}function Fe(W){return W.x}function ze(W){return W.y}function Ye(W,D,L,j){for(var $,ne=j,me=L-D>>1,fe=L-D,se=W[D],ye=W[D+1],ke=W[L],Ke=W[L+1],Le=D+3;Le<L;Le+=3){var vt=ot(W[Le],W[Le+1],se,ye,ke,Ke);if(vt>ne)$=Le,ne=vt;else if(vt===ne){var mt=Math.abs(Le-me);mt<fe&&($=Le,fe=mt)}}ne>j&&($-D>3&&Ye(W,D,$,j),W[$+2]=ne,L-$>3&&Ye(W,$,L,j))}function ot(W,D,L,j,$,ne){var me=$-L,fe=ne-j;if(me!==0||fe!==0){var se=((W-L)*me+(D-j)*fe)/(me*me+fe*fe);se>1?(L=$,j=ne):se>0&&(L+=me*se,j+=fe*se)}return(me=W-L)*me+(fe=D-j)*fe}function qe(W,D,L,j){var $={id:W===void 0?null:W,type:D,geometry:L,tags:j,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ne){var me=ne.geometry,fe=ne.type;if(fe==="Point"||fe==="MultiPoint"||fe==="LineString")Qe(ne,me);else if(fe==="Polygon"||fe==="MultiLineString")for(var se=0;se<me.length;se++)Qe(ne,me[se]);else if(fe==="MultiPolygon")for(se=0;se<me.length;se++)for(var ye=0;ye<me[se].length;ye++)Qe(ne,me[se][ye])}($),$}function Qe(W,D){for(var L=0;L<D.length;L+=3)W.minX=Math.min(W.minX,D[L]),W.minY=Math.min(W.minY,D[L+1]),W.maxX=Math.max(W.maxX,D[L]),W.maxY=Math.max(W.maxY,D[L+1])}function Ve(W,D,L,j){if(D.geometry){var $=D.geometry.coordinates,ne=D.geometry.type,me=Math.pow(L.tolerance/((1<<L.maxZoom)*L.extent),2),fe=[],se=D.id;if(L.promoteId?se=D.properties[L.promoteId]:L.generateId&&(se=j||0),ne==="Point")wt($,fe);else if(ne==="MultiPoint")for(var ye=0;ye<$.length;ye++)wt($[ye],fe);else if(ne==="LineString")ft($,fe,me,!1);else if(ne==="MultiLineString"){if(L.lineMetrics){for(ye=0;ye<$.length;ye++)ft($[ye],fe=[],me,!1),W.push(qe(se,"LineString",fe,D.properties));return}bt($,fe,me,!1)}else if(ne==="Polygon")bt($,fe,me,!0);else{if(ne!=="MultiPolygon"){if(ne==="GeometryCollection"){for(ye=0;ye<D.geometry.geometries.length;ye++)Ve(W,{id:se,geometry:D.geometry.geometries[ye],properties:D.properties},L,j);return}throw new Error("Input data is not a valid GeoJSON object.")}for(ye=0;ye<$.length;ye++){var ke=[];bt($[ye],ke,me,!0),fe.push(ke)}}W.push(qe(se,ne,fe,D.properties))}}function wt(W,D){D.push(Et(W[0])),D.push(Ut(W[1])),D.push(0)}function ft(W,D,L,j){for(var $,ne,me=0,fe=0;fe<W.length;fe++){var se=Et(W[fe][0]),ye=Ut(W[fe][1]);D.push(se),D.push(ye),D.push(0),fe>0&&(me+=j?($*ye-se*ne)/2:Math.sqrt(Math.pow(se-$,2)+Math.pow(ye-ne,2))),$=se,ne=ye}var ke=D.length-3;D[2]=1,Ye(D,0,ke,L),D[ke+2]=1,D.size=Math.abs(me),D.start=0,D.end=D.size}function bt(W,D,L,j){for(var $=0;$<W.length;$++){var ne=[];ft(W[$],ne,L,j),D.push(ne)}}function Et(W){return W/360+.5}function Ut(W){var D=Math.sin(W*Math.PI/180),L=.5-.25*Math.log((1+D)/(1-D))/Math.PI;return L<0?0:L>1?1:L}function Qt(W,D,L,j,$,ne,me,fe){if(j/=D,ne>=(L/=D)&&me<j)return W;if(me<L||ne>=j)return null;for(var se=[],ye=0;ye<W.length;ye++){var ke=W[ye],Ke=ke.geometry,Le=ke.type,vt=$===0?ke.minX:ke.minY,mt=$===0?ke.maxX:ke.maxY;if(vt>=L&&mt<j)se.push(ke);else if(!(mt<L||vt>=j)){var _t=[];if(Le==="Point"||Le==="MultiPoint")qt(Ke,_t,L,j,$);else if(Le==="LineString")si(Ke,_t,L,j,$,!1,fe.lineMetrics);else if(Le==="MultiLineString")gr(Ke,_t,L,j,$,!1);else if(Le==="Polygon")gr(Ke,_t,L,j,$,!0);else if(Le==="MultiPolygon")for(var Tt=0;Tt<Ke.length;Tt++){var xe=[];gr(Ke[Tt],xe,L,j,$,!0),xe.length&&_t.push(xe)}if(_t.length){if(fe.lineMetrics&&Le==="LineString"){for(Tt=0;Tt<_t.length;Tt++)se.push(qe(ke.id,Le,_t[Tt],ke.tags));continue}Le!=="LineString"&&Le!=="MultiLineString"||(_t.length===1?(Le="LineString",_t=_t[0]):Le="MultiLineString"),Le!=="Point"&&Le!=="MultiPoint"||(Le=_t.length===3?"Point":"MultiPoint"),se.push(qe(ke.id,Le,_t,ke.tags))}}}return se.length?se:null}function qt(W,D,L,j,$){for(var ne=0;ne<W.length;ne+=3){var me=W[ne+$];me>=L&&me<=j&&(D.push(W[ne]),D.push(W[ne+1]),D.push(W[ne+2]))}}function si(W,D,L,j,$,ne,me){for(var fe,se,ye=$i(W),ke=$===0?xn:oo,Ke=W.start,Le=0;Le<W.length-3;Le+=3){var vt=W[Le],mt=W[Le+1],_t=W[Le+2],Tt=W[Le+3],xe=W[Le+4],ei=$===0?vt:mt,at=$===0?Tt:xe,Kt=!1;me&&(fe=Math.sqrt(Math.pow(vt-Tt,2)+Math.pow(mt-xe,2))),ei<L?at>L&&(se=ke(ye,vt,mt,Tt,xe,L),me&&(ye.start=Ke+fe*se)):ei>j?at<j&&(se=ke(ye,vt,mt,Tt,xe,j),me&&(ye.start=Ke+fe*se)):yn(ye,vt,mt,_t),at<L&&ei>=L&&(se=ke(ye,vt,mt,Tt,xe,L),Kt=!0),at>j&&ei<=j&&(se=ke(ye,vt,mt,Tt,xe,j),Kt=!0),!ne&&Kt&&(me&&(ye.end=Ke+fe*se),D.push(ye),ye=$i(W)),me&&(Ke+=fe)}var ti=W.length-3;vt=W[ti],mt=W[ti+1],_t=W[ti+2],(ei=$===0?vt:mt)>=L&&ei<=j&&yn(ye,vt,mt,_t),ti=ye.length-3,ne&&ti>=3&&(ye[ti]!==ye[0]||ye[ti+1]!==ye[1])&&yn(ye,ye[0],ye[1],ye[2]),ye.length&&D.push(ye)}function $i(W){var D=[];return D.size=W.size,D.start=W.start,D.end=W.end,D}function gr(W,D,L,j,$,ne){for(var me=0;me<W.length;me++)si(W[me],D,L,j,$,ne,!1)}function yn(W,D,L,j){W.push(D),W.push(L),W.push(j)}function xn(W,D,L,j,$,ne){var me=(ne-D)/(j-D);return W.push(ne),W.push(L+($-L)*me),W.push(1),me}function oo(W,D,L,j,$,ne){var me=(ne-L)/($-L);return W.push(D+(j-D)*me),W.push(ne),W.push(1),me}function Wi(W,D){for(var L=[],j=0;j<W.length;j++){var $,ne=W[j],me=ne.type;if(me==="Point"||me==="MultiPoint"||me==="LineString")$=Ji(ne.geometry,D);else if(me==="MultiLineString"||me==="Polygon"){$=[];for(var fe=0;fe<ne.geometry.length;fe++)$.push(Ji(ne.geometry[fe],D))}else if(me==="MultiPolygon")for($=[],fe=0;fe<ne.geometry.length;fe++){for(var se=[],ye=0;ye<ne.geometry[fe].length;ye++)se.push(Ji(ne.geometry[fe][ye],D));$.push(se)}L.push(qe(ne.id,me,$,ne.tags))}return L}function Ji(W,D){var L=[];L.size=W.size,W.start!==void 0&&(L.start=W.start,L.end=W.end);for(var j=0;j<W.length;j+=3)L.push(W[j]+D,W[j+1],W[j+2]);return L}function so(W,D){if(W.transformed)return W;var L,j,$,ne=1<<W.z,me=W.x,fe=W.y;for(L=0;L<W.features.length;L++){var se=W.features[L],ye=se.geometry,ke=se.type;if(se.geometry=[],ke===1)for(j=0;j<ye.length;j+=2)se.geometry.push(ao(ye[j],ye[j+1],D,ne,me,fe));else for(j=0;j<ye.length;j++){var Ke=[];for($=0;$<ye[j].length;$+=2)Ke.push(ao(ye[j][$],ye[j][$+1],D,ne,me,fe));se.geometry.push(Ke)}}return W.transformed=!0,W}function ao(W,D,L,j,$,ne){return[Math.round(L*(W*j-$)),Math.round(L*(D*j-ne))]}function ma(W,D,L,j,$){for(var ne=D===$.maxZoom?0:$.tolerance/((1<<D)*$.extent),me={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:L,y:j,z:D,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},fe=0;fe<W.length;fe++){me.numFeatures++,tn(me,W[fe],ne,$);var se=W[fe].minX,ye=W[fe].minY,ke=W[fe].maxX,Ke=W[fe].maxY;se<me.minX&&(me.minX=se),ye<me.minY&&(me.minY=ye),ke>me.maxX&&(me.maxX=ke),Ke>me.maxY&&(me.maxY=Ke)}return me}function tn(W,D,L,j){var $=D.geometry,ne=D.type,me=[];if(ne==="Point"||ne==="MultiPoint")for(var fe=0;fe<$.length;fe+=3)me.push($[fe]),me.push($[fe+1]),W.numPoints++,W.numSimplified++;else if(ne==="LineString")Pn(me,$,W,L,!1,!1);else if(ne==="MultiLineString"||ne==="Polygon")for(fe=0;fe<$.length;fe++)Pn(me,$[fe],W,L,ne==="Polygon",fe===0);else if(ne==="MultiPolygon")for(var se=0;se<$.length;se++){var ye=$[se];for(fe=0;fe<ye.length;fe++)Pn(me,ye[fe],W,L,!0,fe===0)}if(me.length){var ke=D.tags||null;if(ne==="LineString"&&j.lineMetrics){for(var Ke in ke={},D.tags)ke[Ke]=D.tags[Ke];ke.mapbox_clip_start=$.start/$.size,ke.mapbox_clip_end=$.end/$.size}var Le={geometry:me,type:ne==="Polygon"||ne==="MultiPolygon"?3:ne==="LineString"||ne==="MultiLineString"?2:1,tags:ke};D.id!==null&&(Le.id=D.id),W.features.push(Le)}}function Pn(W,D,L,j,$,ne){var me=j*j;if(j>0&&D.size<($?me:j))L.numPoints+=D.length/3;else{for(var fe=[],se=0;se<D.length;se+=3)(j===0||D[se+2]>me)&&(L.numSimplified++,fe.push(D[se]),fe.push(D[se+1])),L.numPoints++;$&&function(ye,ke){for(var Ke=0,Le=0,vt=ye.length,mt=vt-2;Le<vt;mt=Le,Le+=2)Ke+=(ye[Le]-ye[mt])*(ye[Le+1]+ye[mt+1]);if(Ke>0===ke)for(Le=0,vt=ye.length;Le<vt/2;Le+=2){var _t=ye[Le],Tt=ye[Le+1];ye[Le]=ye[vt-2-Le],ye[Le+1]=ye[vt-1-Le],ye[vt-2-Le]=_t,ye[vt-1-Le]=Tt}}(fe,ne),W.push(fe)}}function lo(W,D){var L=(D=this.options=function($,ne){for(var me in ne)$[me]=ne[me];return $}(Object.create(this.options),D)).debug;if(L&&console.time("preprocess data"),D.maxZoom<0||D.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(D.promoteId&&D.generateId)throw new Error("promoteId and generateId cannot be used together.");var j=function($,ne){var me=[];if($.type==="FeatureCollection")for(var fe=0;fe<$.features.length;fe++)Ve(me,$.features[fe],ne,fe);else Ve(me,$.type==="Feature"?$:{geometry:$},ne);return me}(W,D);this.tiles={},this.tileCoords=[],L&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",D.indexMaxZoom,D.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(j=function($,ne){var me=ne.buffer/ne.extent,fe=$,se=Qt($,1,-1-me,me,0,-1,2,ne),ye=Qt($,1,1-me,2+me,0,-1,2,ne);return(se||ye)&&(fe=Qt($,1,-me,1+me,0,-1,2,ne)||[],se&&(fe=Wi(se,1).concat(fe)),ye&&(fe=fe.concat(Wi(ye,-1)))),fe}(j,D)).length&&this.splitTile(j,0,0,0),L&&(j.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function co(W,D,L){return 32*((1<<W)*L+D)+W}function Bo(W,D){const L=W.tileID.canonical;if(!this._geoJSONIndex)return D(null,null);const j=this._geoJSONIndex.getTile(L.z,L.x,L.y);if(!j)return D(null,null);const $=new dt(j.features);let ne=It($);ne.byteOffset===0&&ne.byteLength===ne.buffer.byteLength||(ne=new Uint8Array(ne)),D(null,{vectorTile:$,rawData:ne.buffer})}lo.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},lo.prototype.splitTile=function(W,D,L,j,$,ne,me){for(var fe=[W,D,L,j],se=this.options,ye=se.debug;fe.length;){j=fe.pop(),L=fe.pop(),D=fe.pop(),W=fe.pop();var ke=1<<D,Ke=co(D,L,j),Le=this.tiles[Ke];if(!Le&&(ye>1&&console.time("creation"),Le=this.tiles[Ke]=ma(W,D,L,j,se),this.tileCoords.push({z:D,x:L,y:j}),ye)){ye>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",D,L,j,Le.numFeatures,Le.numPoints,Le.numSimplified),console.timeEnd("creation"));var vt="z"+D;this.stats[vt]=(this.stats[vt]||0)+1,this.total++}if(Le.source=W,$){if(D===se.maxZoom||D===$)continue;var mt=1<<$-D;if(L!==Math.floor(ne/mt)||j!==Math.floor(me/mt))continue}else if(D===se.indexMaxZoom||Le.numPoints<=se.indexMaxPoints)continue;if(Le.source=null,W.length!==0){ye>1&&console.time("clipping");var _t,Tt,xe,ei,at,Kt,ti=.5*se.buffer/se.extent,uo=.5-ti,vn=.5+ti,He=1+ti;_t=Tt=xe=ei=null,at=Qt(W,ke,L-ti,L+vn,0,Le.minX,Le.maxX,se),Kt=Qt(W,ke,L+uo,L+He,0,Le.minX,Le.maxX,se),W=null,at&&(_t=Qt(at,ke,j-ti,j+vn,1,Le.minY,Le.maxY,se),Tt=Qt(at,ke,j+uo,j+He,1,Le.minY,Le.maxY,se),at=null),Kt&&(xe=Qt(Kt,ke,j-ti,j+vn,1,Le.minY,Le.maxY,se),ei=Qt(Kt,ke,j+uo,j+He,1,Le.minY,Le.maxY,se),Kt=null),ye>1&&console.timeEnd("clipping"),fe.push(_t||[],D+1,2*L,2*j),fe.push(Tt||[],D+1,2*L,2*j+1),fe.push(xe||[],D+1,2*L+1,2*j),fe.push(ei||[],D+1,2*L+1,2*j+1)}}},lo.prototype.getTile=function(W,D,L){var j=this.options,$=j.extent,ne=j.debug;if(W<0||W>24)return null;var me=1<<W,fe=co(W,D=(D%me+me)%me,L);if(this.tiles[fe])return so(this.tiles[fe],$);ne>1&&console.log("drilling down to z%d-%d-%d",W,D,L);for(var se,ye=W,ke=D,Ke=L;!se&&ye>0;)ye--,ke=Math.floor(ke/2),Ke=Math.floor(Ke/2),se=this.tiles[co(ye,ke,Ke)];return se&&se.source?(ne>1&&console.log("found parent tile z%d-%d-%d",ye,ke,Ke),ne>1&&console.time("drilling down"),this.splitTile(se.source,ye,ke,Ke,W,D,L),ne>1&&console.timeEnd("drilling down"),this.tiles[fe]?so(this.tiles[fe],$):null):null};class As extends s.VectorTileWorkerSource{constructor(D,L,j,$,ne){super(D,L,j,$,Bo),ne&&(this.loadGeoJSON=ne)}loadData(D,L){const j=D&&D.request,$=j&&j.collectResourceTiming;this.loadGeoJSON(D,(ne,me)=>{if(ne||!me)return L(ne);if(typeof me!="object")return L(new Error(`Input data given to '${D.source}' is not a valid GeoJSON object.`));{pe(me,!0);try{if(D.filter){const se=s.createExpression(D.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(se.result==="error")throw new Error(se.value.map(ke=>`${ke.key}: ${ke.message}`).join(", "));const ye=me.features.filter(ke=>se.value.evaluate({zoom:0},ke));me={type:"FeatureCollection",features:ye}}this._geoJSONIndex=D.cluster?new Je(function({superclusterOptions:se,clusterProperties:ye}){if(!ye||!se)return se;const ke={},Ke={},Le={accumulated:null,zoom:0},vt={properties:null},mt=Object.keys(ye);for(const _t of mt){const[Tt,xe]=ye[_t],ei=s.createExpression(xe),at=s.createExpression(typeof Tt=="string"?[Tt,["accumulated"],["get",_t]]:Tt);ke[_t]=ei.value,Ke[_t]=at.value}return se.map=_t=>{vt.properties=_t;const Tt={};for(const xe of mt)Tt[xe]=ke[xe].evaluate(Le,vt);return Tt},se.reduce=(_t,Tt)=>{vt.properties=Tt;for(const xe of mt)Le.accumulated=_t[xe],_t[xe]=Ke[xe].evaluate(Le,vt)},se}(D)).load(me.features):function(se,ye){return new lo(se,ye)}(me,D.geojsonVtOptions)}catch(se){return L(se)}this.loaded={};const fe={};if($){const se=s.getPerformanceMeasurement(j);se&&(fe.resourceTiming={},fe.resourceTiming[D.source]=JSON.parse(JSON.stringify(se)))}L(null,fe)}})}reloadTile(D,L){const j=this.loaded;return j&&j[D.uid]?super.reloadTile(D,L):this.loadTile(D,L)}loadGeoJSON(D,L){if(D.request)s.getJSON(D.request,L);else{if(typeof D.data!="string")return L(new Error(`Input data given to '${D.source}' is not a valid GeoJSON object.`));try{return L(null,JSON.parse(D.data))}catch{return L(new Error(`Input data given to '${D.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(D,L){try{L(null,this._geoJSONIndex.getClusterExpansionZoom(D.clusterId))}catch(j){L(j)}}getClusterChildren(D,L){try{L(null,this._geoJSONIndex.getChildren(D.clusterId))}catch(j){L(j)}}getClusterLeaves(D,L){try{L(null,this._geoJSONIndex.getLeaves(D.clusterId,D.limit,D.offset))}catch(j){L(j)}}}class Lo{constructor(D){this.self=D,this.actor=new s.Actor(D,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=s.getProjection({name:"mercator"}),this.workerSourceTypes={vector:s.VectorTileWorkerSource,geojson:As},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(L,j)=>{if(this.workerSourceTypes[L])throw new Error(`Worker source with name "${L}" already registered.`);this.workerSourceTypes[L]=j},this.self.registerRTLTextPlugin=L=>{if(s.plugin.isParsed())throw new Error("RTL text plugin already registered.");s.plugin.applyArabicShaping=L.applyArabicShaping,s.plugin.processBidirectionalText=L.processBidirectionalText,s.plugin.processStyledBidirectionalText=L.processStyledBidirectionalText}}clearCaches(D,L,j){delete this.layerIndexes[D],delete this.availableImages[D],delete this.workerSources[D],delete this.demWorkerSources[D],j()}checkIfReady(D,L,j){j()}setReferrer(D,L){this.referrer=L}spriteLoaded(D,L){this.isSpriteLoaded[D]=L;for(const j in this.workerSources[D]){const $=this.workerSources[D][j];for(const ne in $)$[ne]instanceof s.VectorTileWorkerSource&&($[ne].isSpriteLoaded=L,$[ne].fire(new s.Event("isSpriteLoaded")))}}setImages(D,L,j){this.availableImages[D]=L;for(const $ in this.workerSources[D]){const ne=this.workerSources[D][$];for(const me in ne)ne[me].availableImages=L}j()}enableTerrain(D,L,j){this.terrain=L,j()}setProjection(D,L){this.projections[D]=s.getProjection(L)}setLayers(D,L,j){this.getLayerIndex(D).replace(L),j()}updateLayers(D,L,j){this.getLayerIndex(D).update(L.layers,L.removedIds),j()}loadTile(D,L,j){const $=this.enableTerrain?s.extend({enableTerrain:this.terrain},L):L;$.projection=this.projections[D]||this.defaultProjection,this.getWorkerSource(D,L.type,L.source).loadTile($,j)}loadDEMTile(D,L,j){const $=this.enableTerrain?s.extend({buildQuadTree:this.terrain},L):L;this.getDEMWorkerSource(D,L.source).loadTile($,j)}reloadTile(D,L,j){const $=this.enableTerrain?s.extend({enableTerrain:this.terrain},L):L;$.projection=this.projections[D]||this.defaultProjection,this.getWorkerSource(D,L.type,L.source).reloadTile($,j)}abortTile(D,L,j){this.getWorkerSource(D,L.type,L.source).abortTile(L,j)}removeTile(D,L,j){this.getWorkerSource(D,L.type,L.source).removeTile(L,j)}removeSource(D,L,j){if(!this.workerSources[D]||!this.workerSources[D][L.type]||!this.workerSources[D][L.type][L.source])return;const $=this.workerSources[D][L.type][L.source];delete this.workerSources[D][L.type][L.source],$.removeSource!==void 0?$.removeSource(L,j):j()}loadWorkerSource(D,L,j){try{this.self.importScripts(L.url),j()}catch($){j($.toString())}}syncRTLPluginState(D,L,j){try{s.plugin.setState(L);const $=s.plugin.getPluginURL();if(s.plugin.isLoaded()&&!s.plugin.isParsed()&&$!=null){this.self.importScripts($);const ne=s.plugin.isParsed();j(ne?void 0:new Error(`RTL Text Plugin failed to import scripts from ${$}`),ne)}}catch($){j($.toString())}}getAvailableImages(D){let L=this.availableImages[D];return L||(L=[]),L}getLayerIndex(D){let L=this.layerIndexes[D];return L||(L=this.layerIndexes[D]=new he),L}getWorkerSource(D,L,j){return this.workerSources[D]||(this.workerSources[D]={}),this.workerSources[D][L]||(this.workerSources[D][L]={}),this.workerSources[D][L][j]||(this.workerSources[D][L][j]=new this.workerSourceTypes[L]({send:($,ne,me,fe,se,ye)=>{this.actor.send($,ne,me,D,se,ye)},scheduler:this.actor.scheduler},this.getLayerIndex(D),this.getAvailableImages(D),this.isSpriteLoaded[D])),this.workerSources[D][L][j]}getDEMWorkerSource(D,L){return this.demWorkerSources[D]||(this.demWorkerSources[D]={}),this.demWorkerSources[D][L]||(this.demWorkerSources[D][L]=new J),this.demWorkerSources[D][L]}enforceCacheSizeLimit(D,L){s.enforceCacheSizeLimit(L)}getWorkerPerformanceMetrics(D,L,j){j(void 0,void 0)}}return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new Lo(self)),Lo}),B(["./shared"],function(s){var K=ue;function ue(l){return!function(t){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var u,f,m=new Blob([""],{type:"text/javascript"}),g=URL.createObjectURL(m);try{f=new Worker(g),u=!0}catch{u=!1}return f&&f.terminate(),URL.revokeObjectURL(g),u}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var u=document.createElement("canvas");u.width=u.height=1;var f=u.getContext("2d");if(!f)return!1;var m=f.getImageData(0,0,1,1);return m&&m.width===u.width}()?(he[o=t&&t.failIfMajorPerformanceCaveat]===void 0&&(he[o]=function(u){var f,m=function(g){var v=document.createElement("canvas"),T=Object.create(ue.webGLContextAttributes);return T.failIfMajorPerformanceCaveat=g,v.getContext("webgl",T)||v.getContext("experimental-webgl",T)}(u);if(!m)return!1;try{f=m.createShader(m.VERTEX_SHADER)}catch{return!1}return!(!f||m.isContextLost())&&(m.shaderSource(f,"void main() {}"),m.compileShader(f),m.getShaderParameter(f,m.COMPILE_STATUS)===!0)}(o)),he[o]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var o}(l)}var he={};function J(l,t){if(Array.isArray(l)){if(!Array.isArray(t)||l.length!==t.length)return!1;for(let o=0;o<l.length;o++)if(!J(l[o],t[o]))return!1;return!0}if(typeof l=="object"&&l!==null&&t!==null){if(typeof t!="object"||Object.keys(l).length!==Object.keys(t).length)return!1;for(const o in l)if(!J(l[o],t[o]))return!1;return!0}return l===t}function pe(l,t,o){const u=s.window.document.createElement(l);return t!==void 0&&(u.className=t),o&&o.appendChild(u),u}function Ee(l,t,o){const u=s.window.document.createElementNS("http://www.w3.org/2000/svg",l);for(const f of Object.keys(t))u.setAttributeNS(null,f,t[f]);return o&&o.appendChild(u),u}ue.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const ut=s.window.document&&s.window.document.documentElement.style,Dt=ut&&ut.userSelect!==void 0?"userSelect":"WebkitUserSelect";let We;function dt(){ut&&Dt&&(We=ut[Dt],ut[Dt]="none")}function Lt(){ut&&Dt&&(ut[Dt]=We)}function Xt(l){l.preventDefault(),l.stopPropagation(),s.window.removeEventListener("click",Xt,!0)}function Jt(){s.window.addEventListener("click",Xt,!0),s.window.setTimeout(()=>{s.window.removeEventListener("click",Xt,!0)},0)}function wi(l,t){const o=l.getBoundingClientRect();return Qi(l,o,t)}function It(l,t){const o=l.getBoundingClientRect(),u=[];for(let f=0;f<t.length;f++)u.push(Qi(l,o,t[f]));return u}function cr(l){return s.window.InstallTrigger!==void 0&&l.button===2&&l.ctrlKey&&s.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:l.button}function Qi(l,t,o){const u=l.offsetWidth===t.width?1:l.offsetWidth/t.width;return new s.pointGeometry((o.clientX-t.left)*u,(o.clientY-t.top)*u)}function Ki(l,t){var o=t[0],u=t[1],f=t[2],m=t[3],g=o*m-f*u;return g?(l[0]=m*(g=1/g),l[1]=-u*g,l[2]=-f*g,l[3]=o*g,l):null}function _r(l){const{userImage:t}=l;return!!(t&&t.render&&t.render())&&(l.data.replace(new Uint8Array(t.data.buffer)),!0)}class mi extends s.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new s.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:o,callback:u}of this.requestors)this._notify(o,u);this.requestors=[]}}hasImage(t){return!!this.getImage(t)}getImage(t){return this.images[t]}addImage(t,o){this._validate(t,o)&&(this.images[t]=o)}_validate(t,o){let u=!0;return this._validateStretch(o.stretchX,o.data&&o.data.width)||(this.fire(new s.ErrorEvent(new Error(`Image "${t}" has invalid "stretchX" value`))),u=!1),this._validateStretch(o.stretchY,o.data&&o.data.height)||(this.fire(new s.ErrorEvent(new Error(`Image "${t}" has invalid "stretchY" value`))),u=!1),this._validateContent(o.content,o)||(this.fire(new s.ErrorEvent(new Error(`Image "${t}" has invalid "content" value`))),u=!1),u}_validateStretch(t,o){if(!t)return!0;let u=0;for(const f of t){if(f[0]<u||f[1]<f[0]||o<f[1])return!1;u=f[1]}return!0}_validateContent(t,o){return!(t&&(t.length!==4||t[0]<0||o.data.width<t[0]||t[1]<0||o.data.height<t[1]||t[2]<0||o.data.width<t[2]||t[3]<0||o.data.height<t[3]||t[2]<t[0]||t[3]<t[1]))}updateImage(t,o){o.version=this.images[t].version+1,this.images[t]=o,this.updatedImages[t]=!0}removeImage(t){const o=this.images[t];delete this.images[t],delete this.patterns[t],o.userImage&&o.userImage.onRemove&&o.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t,o){let u=!0;if(!this.isLoaded())for(const f of t)this.images[f]||(u=!1);this.isLoaded()||u?this._notify(t,o):this.requestors.push({ids:t,callback:o})}_notify(t,o){const u={};for(const f of t){this.images[f]||this.fire(new s.Event("styleimagemissing",{id:f}));const m=this.images[f];m?u[f]={data:m.data.clone(),pixelRatio:m.pixelRatio,sdf:m.sdf,version:m.version,stretchX:m.stretchX,stretchY:m.stretchY,content:m.content,hasRenderCallback:Boolean(m.userImage&&m.userImage.render)}:s.warnOnce(`Image "${f}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}o(null,u)}getPixelSize(){const{width:t,height:o}=this.atlasImage;return{width:t,height:o}}getPattern(t){const o=this.patterns[t],u=this.getImage(t);if(!u)return null;if(o&&o.position.version===u.version)return o.position;if(o)o.position.version=u.version;else{const f={w:u.data.width+2,h:u.data.height+2,x:0,y:0},m=new s.ImagePosition(f,u);this.patterns[t]={bin:f,position:m}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const o=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new s.Texture(t,this.atlasImage,o.RGBA),this.atlasTexture.bind(o.LINEAR,o.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const m in this.patterns)t.push(this.patterns[m].bin);const{w:o,h:u}=s.potpack(t),f=this.atlasImage;f.resize({width:o||1,height:u||1});for(const m in this.patterns){const{bin:g}=this.patterns[m],v=g.x+1,T=g.y+1,C=this.images[m].data,S=C.width,k=C.height;s.RGBAImage.copy(C,f,{x:0,y:0},{x:v,y:T},{width:S,height:k}),s.RGBAImage.copy(C,f,{x:0,y:k-1},{x:v,y:T-1},{width:S,height:1}),s.RGBAImage.copy(C,f,{x:0,y:0},{x:v,y:T+k},{width:S,height:1}),s.RGBAImage.copy(C,f,{x:S-1,y:0},{x:v-1,y:T},{width:1,height:k}),s.RGBAImage.copy(C,f,{x:0,y:0},{x:v+S,y:T},{width:1,height:k})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const o of t){if(this.callbackDispatchedThisFrame[o])continue;this.callbackDispatchedThisFrame[o]=!0;const u=this.images[o];_r(u)&&this.updateImage(o,u)}}}const ur=new s.Properties({anchor:new s.DataConstantProperty(s.spec.light.anchor),position:new class{constructor(){this.specification=s.spec.light.position}possiblyEvaluate(l,t){return function([o,u,f]){const m=s.degToRad(u+90),g=s.degToRad(f);return{x:o*Math.cos(m)*Math.sin(g),y:o*Math.sin(m)*Math.sin(g),z:o*Math.cos(g),azimuthal:u,polar:f}}(l.expression.evaluate(t))}interpolate(l,t,o){return{x:s.number(l.x,t.x,o),y:s.number(l.y,t.y,o),z:s.number(l.z,t.z,o),azimuthal:s.number(l.azimuthal,t.azimuthal,o),polar:s.number(l.polar,t.polar,o)}}},color:new s.DataConstantProperty(s.spec.light.color),intensity:new s.DataConstantProperty(s.spec.light.intensity)}),Tr="-transition";class Jr extends s.Evented{constructor(t){super(),this._transitionable=new s.Transitionable(ur),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,o={}){if(!this._validate(s.validateLight,t,o))for(const u in t){const f=t[u];s.endsWith(u,Tr)?this._transitionable.setTransition(u.slice(0,-Tr.length),f):this._transitionable.setValue(u,f)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,o,u){return(!u||u.validate!==!1)&&s.emitValidationErrors(this,t.call(s.validateStyle,s.extend({value:o,style:{glyphs:!0,sprite:!0},styleSpec:s.spec})))}}const en=new s.Properties({source:new s.DataConstantProperty(s.spec.terrain.source),exaggeration:new s.DataConstantProperty(s.spec.terrain.exaggeration)}),Ai="-transition";class ci extends s.Evented{constructor(t,o){super(),this._transitionable=new s.Transitionable(en),this.set(t),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=o}get(){return this._transitionable.serialize()}set(t){for(const o in t){const u=t[o];s.endsWith(o,Ai)?this._transitionable.setTransition(o.slice(0,-Ai.length),u):this._transitionable.setValue(o,u)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}}function Wt(l,t,o,u){const f=s.smoothstep(45,65,o),[m,g]=Bi(l,u),v=s.length(t);let T=1-Math.min(1,Math.exp((v-m)/(g-m)*-6));return T*=T*T,T=Math.min(1,1.00747*T),T*f*l.alpha}function Bi(l,t){const o=.5/Math.tan(.5*t);return[l.range[0]+o,l.range[1]+o]}const Or=new s.Properties({range:new s.DataConstantProperty(s.spec.fog.range),color:new s.DataConstantProperty(s.spec.fog.color),"horizon-blend":new s.DataConstantProperty(s.spec.fog["horizon-blend"])}),Li="-transition";class hr extends s.Evented{constructor(t,o){super(),this._transitionable=new s.Transitionable(Or),this.set(t),this._transitioning=this._transitionable.untransitioned(),this._transform=o}get state(){return{range:this.properties.get("range"),horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(t,o={}){if(!this._validate(s.validateFog,t,o))for(const u in t){const f=t[u];s.endsWith(u,Li)?this._transitionable.setTransition(u.slice(0,-Li.length),f):this._transitionable.setValue(u,f)}}getOpacity(t){if(!this._transform.projection.supportsFog)return 0;const o=this.properties&&this.properties.get("color")||1;return s.smoothstep(45,65,t)*o.a}getOpacityAtLatLng(t,o){return this._transform.projection.supportsFog?function(u,f,m){const g=s.MercatorCoordinate.fromLngLat(f),v=m.elevation?m.elevation.getAtPointOrZero(g):0,T=[g.x,g.y,v];return s.transformMat4(T,T,m.mercatorFogMatrix),Wt(u,T,m.pitch,m._fov)}(this.state,t,o):0}getFovAdjustedRange(t){return this._transform.projection.supportsFog?Bi(this.state,t):[0,1]}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,o,u){return(!u||u.validate!==!1)&&s.emitValidationErrors(this,t.call(s.validateStyle,s.extend({value:o,style:{glyphs:!0,sprite:!0},styleSpec:s.spec})))}}class Ot{constructor(t,o){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=s.uniqueId();const u=this.workerPool.acquire(this.id);for(let f=0;f<u.length;f++){const m=new Ot.Actor(u[f],o,this.id);m.name=`Worker ${f}`,this.actors.push(m)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(t,o,u){s.asyncAll(this.actors,(f,m)=>{f.send(t,o,m)},u=u||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(t=>{t.remove()}),this.actors=[],this.workerPool.release(this.id)}}function Ui(l,t,o){return t*(s.EXTENT/(l.tileSize*Math.pow(2,o-l.tileID.overscaledZ)))}Ot.Actor=s.Actor;class Be{constructor(t,o,u,f){this.screenBounds=t,this.cameraPoint=o,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=u,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this.screenGeometry.map(m=>f.pointCoordinate3D(m)),this.cameraGeometry=this.bufferedCameraGeometry(0)}static createFromScreenPoints(t,o){let u,f;if(t instanceof s.pointGeometry||typeof t[0]=="number"){const m=s.pointGeometry.convert(t);u=[s.pointGeometry.convert(t)],f=o.isPointAboveHorizon(m)}else{const m=s.pointGeometry.convert(t[0]),g=s.pointGeometry.convert(t[1]);u=[m,g],f=s.polygonizeBounds(m,g).every(v=>o.isPointAboveHorizon(v))}return new Be(u,o.getCameraPoint(),f,o)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(t){return s.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],t)}bufferedCameraGeometry(t){const o=this.screenBounds[0],u=this.screenBounds.length===1?this.screenBounds[0].add(new s.pointGeometry(1,1)):this.screenBounds[1],f=s.polygonizeBounds(o,u,0,!1);return this.cameraPoint.y>u.y&&(this.cameraPoint.x>o.x&&this.cameraPoint.x<u.x?f.splice(3,0,this.cameraPoint):this.cameraPoint.x>=u.x?f[2]=this.cameraPoint:this.cameraPoint.x<=o.x&&(f[3]=this.cameraPoint)),s.bufferConvexPolygon(f,t)}containsTile(t,o,u){const f=t.queryPadding+1,m=t.tileID.wrap,g=u?this._bufferedCameraMercator(f,o).map(N=>s.getTilePoint(t.tileTransform,N,m)):this._bufferedScreenMercator(f,o).map(N=>s.getTilePoint(t.tileTransform,N,m)),v=this.screenGeometryMercator.map(N=>s.getTileVec3(t.tileTransform,N,m)),T=v.map(N=>new s.pointGeometry(N[0],N[1])),C=o.getFreeCameraOptions().position||new s.MercatorCoordinate(0,0,0),S=s.getTileVec3(t.tileTransform,C,m),k=v.map(N=>{const R=s.sub(N,N,S);return s.normalize(R,R),new s.Ray(S,R)}),O=Ui(t,1,o.zoom);if(s.polygonIntersectsBox(g,0,0,s.EXTENT,s.EXTENT))return{queryGeometry:this,tilespaceGeometry:T,tilespaceRays:k,bufferedTilespaceGeometry:g,bufferedTilespaceBounds:(V=s.getBounds(g),V.min.x=s.clamp(V.min.x,0,s.EXTENT),V.min.y=s.clamp(V.min.y,0,s.EXTENT),V.max.x=s.clamp(V.max.x,0,s.EXTENT),V.max.y=s.clamp(V.max.y,0,s.EXTENT),V),tile:t,tileID:t.tileID,pixelToTileUnitsFactor:O};var V}_bufferedScreenMercator(t,o){const u=ht(t);if(this._screenRaycastCache[u])return this._screenRaycastCache[u];{const f=this.bufferedScreenGeometry(t).map(m=>o.pointCoordinate3D(m));return this._screenRaycastCache[u]=f,f}}_bufferedCameraMercator(t,o){const u=ht(t);if(this._cameraRaycastCache[u])return this._cameraRaycastCache[u];{const f=this.bufferedCameraGeometry(t).map(m=>o.pointCoordinate3D(m));return this._cameraRaycastCache[u]=f,f}}}function ht(l){return 100*l|0}function Je(l,t,o){const u=function(f,m){if(f)return o(f);if(m){const g=s.pick(s.extend(m,l),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);m.vector_layers&&(g.vectorLayers=m.vector_layers,g.vectorLayerIds=g.vectorLayers.map(v=>v.id)),g.tiles=t.canonicalizeTileset(g,l.url),o(null,g)}};return l.url?s.getJSON(t.transformRequest(t.normalizeSourceURL(l.url),s.ResourceType.Source),u):s.exported.frame(()=>u(null,l))}class xt{constructor(t,o,u){this.bounds=s.LngLatBounds.convert(this.validateBounds(t)),this.minzoom=o||0,this.maxzoom=u||24}validateBounds(t){return Array.isArray(t)&&t.length===4?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const o=Math.pow(2,t.z),u=Math.floor(s.mercatorXfromLng(this.bounds.getWest())*o),f=Math.floor(s.mercatorYfromLat(this.bounds.getNorth())*o),m=Math.ceil(s.mercatorXfromLng(this.bounds.getEast())*o),g=Math.ceil(s.mercatorYfromLat(this.bounds.getSouth())*o);return t.x>=u&&t.x<m&&t.y>=f&&t.y<g}}class ui{constructor(t,o,u){this.context=t;const f=t.gl;this.buffer=f.createBuffer(),this.dynamicDraw=Boolean(u),this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),f.bufferData(f.ELEMENT_ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?f.DYNAMIC_DRAW:f.STATIC_DRAW),this.dynamicDraw||o.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const o=this.context.gl;this.context.unbindVAO(),this.bind(),o.bufferSubData(o.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const oi={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class kt{constructor(t,o,u,f){this.length=o.length,this.attributes=u,this.itemSize=o.bytesPerElement,this.dynamicDraw=f,this.context=t;const m=t.gl;this.buffer=m.createBuffer(),t.bindVertexBuffer.set(this.buffer),m.bufferData(m.ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?m.DYNAMIC_DRAW:m.STATIC_DRAW),this.dynamicDraw||o.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){const o=this.context.gl;this.bind(),o.bufferSubData(o.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,o){for(let u=0;u<this.attributes.length;u++){const f=o.attributes[this.attributes[u].name];f!==void 0&&t.enableVertexAttribArray(f)}}setVertexAttribPointers(t,o,u){for(let f=0;f<this.attributes.length;f++){const m=this.attributes[f],g=o.attributes[m.name];g!==void 0&&t.vertexAttribPointer(g,m.components,t[oi[m.type]],!1,this.itemSize,m.offset+this.itemSize*(u||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class it{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class te extends it{getDefault(){return s.Color.transparent}set(t){const o=this.current;(t.r!==o.r||t.g!==o.g||t.b!==o.b||t.a!==o.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class de extends it{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class Te extends it{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class Fe extends it{getDefault(){return[!0,!0,!0,!0]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||t[2]!==o[2]||t[3]!==o[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class ze extends it{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class Ye extends it{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class ot extends it{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const o=this.current;(t.func!==o.func||t.ref!==o.ref||t.mask!==o.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class qe extends it{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||t[2]!==o[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class Qe extends it{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;t?o.enable(o.STENCIL_TEST):o.disable(o.STENCIL_TEST),this.current=t,this.dirty=!1}}class Ve extends it{getDefault(){return[0,1]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class wt extends it{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;t?o.enable(o.DEPTH_TEST):o.disable(o.DEPTH_TEST),this.current=t,this.dirty=!1}}class ft extends it{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class bt extends it{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;t?o.enable(o.BLEND):o.disable(o.BLEND),this.current=t,this.dirty=!1}}class Et extends it{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class Ut extends it{getDefault(){return s.Color.transparent}set(t){const o=this.current;(t.r!==o.r||t.g!==o.g||t.b!==o.b||t.a!==o.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class Qt extends it{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class qt extends it{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;t?o.enable(o.CULL_FACE):o.disable(o.CULL_FACE),this.current=t,this.dirty=!1}}class si extends it{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class $i extends it{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class gr extends it{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class yn extends it{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class xn extends it{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||t[2]!==o[2]||t[3]!==o[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class oo extends it{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.bindFramebuffer(o.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class Wi extends it{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.bindRenderbuffer(o.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Ji extends it{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.bindTexture(o.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class so extends it{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.bindBuffer(o.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class ao extends it{getDefault(){return null}set(t){const o=this.gl;o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class ma extends it{constructor(t){super(t),this.vao=t.extVertexArrayObject}getDefault(){return null}set(t){this.vao&&(t!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(t),this.current=t,this.dirty=!1)}}class tn extends it{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class Pn extends it{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class lo extends it{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class co extends it{constructor(t,o){super(t),this.context=t,this.parent=o}getDefault(){return null}}class Bo extends co{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class As extends co{attachment(){return this.gl.DEPTH_ATTACHMENT}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferRenderbuffer(o.FRAMEBUFFER,this.attachment(),o.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Lo extends As{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class W{constructor(t,o,u,f){this.context=t,this.width=o,this.height=u;const m=this.framebuffer=t.gl.createFramebuffer();this.colorAttachment=new Bo(t,m),f&&(this.depthAttachment=new As(t,m))}destroy(){const t=this.context.gl,o=this.colorAttachment.get();if(o&&t.deleteTexture(o),this.depthAttachment){const u=this.depthAttachment.get();u&&t.deleteRenderbuffer(u)}t.deleteFramebuffer(this.framebuffer)}}class D{constructor(t){this.gl=t,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new te(this),this.clearDepth=new de(this),this.clearStencil=new Te(this),this.colorMask=new Fe(this),this.depthMask=new ze(this),this.stencilMask=new Ye(this),this.stencilFunc=new ot(this),this.stencilOp=new qe(this),this.stencilTest=new Qe(this),this.depthRange=new Ve(this),this.depthTest=new wt(this),this.depthFunc=new ft(this),this.blend=new bt(this),this.blendFunc=new Et(this),this.blendColor=new Ut(this),this.blendEquation=new Qt(this),this.cullFace=new qt(this),this.cullFaceSide=new si(this),this.frontFace=new $i(this),this.program=new gr(this),this.activeTexture=new yn(this),this.viewport=new xn(this),this.bindFramebuffer=new oo(this),this.bindRenderbuffer=new Wi(this),this.bindTexture=new Ji(this),this.bindVertexBuffer=new so(this),this.bindElementBuffer=new ao(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new ma(this),this.pixelStoreUnpack=new tn(this),this.pixelStoreUnpackPremultiplyAlpha=new Pn(this),this.pixelStoreUnpackFlipY=new lo(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extTextureHalfFloat=t.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(t.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=t.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=t.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,o){return new ui(this,t,o)}createVertexBuffer(t,o,u){return new kt(this,t,o,u)}createRenderbuffer(t,o,u){const f=this.gl,m=f.createRenderbuffer();return this.bindRenderbuffer.set(m),f.renderbufferStorage(f.RENDERBUFFER,t,o,u),this.bindRenderbuffer.set(null),m}createFramebuffer(t,o,u){return new W(this,t,o,u)}clear({color:t,depth:o,stencil:u}){const f=this.gl;let m=0;t&&(m|=f.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),o!==void 0&&(m|=f.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(o),this.depthMask.set(!0)),u!==void 0&&(m|=f.STENCIL_BUFFER_BIT,this.clearStencil.set(u),this.stencilMask.set(255)),f.clear(m)}setCullFace(t){t.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){J(t.blendFunction,s.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class L extends s.Evented{constructor(t,o,u,f){super(),this.id=t,this.dispatcher=u,this.setEventedParent(f),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.extend({type:"raster"},o),s.extend(this,s.pick(o,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Je(this._options,this.map._requestManager,(t,o)=>{this._tileJSONRequest=null,this._loaded=!0,t?this.fire(new s.ErrorEvent(t)):o&&(s.extend(this,o),o.bounds&&(this.tileBounds=new xt(o.bounds,this.minzoom,this.maxzoom)),s.postTurnstileEvent(o.tiles),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return s.extend({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t,o){const u=s.exported.devicePixelRatio>=2,f=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),u,this.tileSize);t.request=s.getImage(this.map._requestManager.transformRequest(f,s.ResourceType.Tile),(m,g,v,T)=>(delete t.request,t.aborted?(t.state="unloaded",o(null)):m?(t.state="errored",o(m)):g?(this.map._refreshExpiredTiles&&t.setExpiryData({cacheControl:v,expires:T}),t.setTexture(g,this.map.painter),t.state="loaded",s.cacheEntryPossiblyAdded(this.dispatcher),void o(null)):o(null)))}static loadTileData(t,o,u){t.setTexture(o,u)}static unloadTileData(t,o){t.texture&&o.saveTileTexture(t.texture)}abortTile(t,o){t.request&&(t.request.cancel(),delete t.request),o()}unloadTile(t,o){t.texture&&this.map.painter.saveTileTexture(t.texture),o()}hasTransition(){return!1}}let j;function $(l,t,o,u,f,m,g,v){const T=[l,o,f,t,u,m,1,1,1],C=[g,v,1],S=s.adjoint([],T),[k,O,V]=s.transformMat3(C,C,s.transpose(S,S));return s.multiply(T,[k,0,0,0,O,0,0,0,V],T)}class ne extends s.Evented{constructor(t,o,u,f){super(),this.id=t,this.dispatcher=u,this.coordinates=o.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(f),this.options=o}load(t){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this.url=this.options.url,s.getImage(this.map._requestManager.transformRequest(this.url,s.ResourceType.Image),(o,u)=>{if(this._loaded=!0,o)this.fire(new s.ErrorEvent(o));else if(u){const{HTMLImageElement:f}=s.window;this.image=u instanceof f?s.exported.getImageData(u):u,this.width=this.image.width,this.height=this.image.height,t&&(this.coordinates=t),this._finishLoading()}})}loaded(){return this._loaded}updateImage(t){return this.image&&t.url?(this.options.url=t.url,this.load(t.coordinates),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this.texture&&this.texture.destroy()}setCoordinates(t){this.coordinates=t,this._boundsArray=void 0;const o=t.map(s.MercatorCoordinate.fromLngLat);return this.tileID=function(u){let f=1/0,m=1/0,g=-1/0,v=-1/0;for(const k of u)f=Math.min(f,k.x),m=Math.min(m,k.y),g=Math.max(g,k.x),v=Math.max(v,k.y);const T=Math.max(g-f,v-m),C=Math.max(0,Math.floor(-Math.log(T)/Math.LN2)),S=Math.pow(2,C);return new s.CanonicalTileID(C,Math.floor((f+g)/2*S),Math.floor((m+v)/2*S))}(o),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(t){for(const T in this.tiles){const C=this.tiles[T];C.state!=="loaded"&&(C.state="loaded",C.texture=this.texture)}if(this._boundsArray)return;const o=s.tileTransform(this.tileID,this.map.transform.projection),[u,f,m,g]=this.coordinates.map(T=>{const C=o.projection.project(T[0],T[1]);return s.getTilePoint(o,C)._round()});this.perspectiveTransform=function(T,C,S,k,O,V,N,R,Q,Z){const Y=$(0,0,T,0,0,C,T,C),X=$(S,k,O,V,N,R,Q,Z);return s.multiply(X,s.adjoint(Y,Y),X),[X[6]/X[8]*T/s.EXTENT,X[7]/X[8]*C/s.EXTENT]}(this.width,this.height,u.x,u.y,f.x,f.y,g.x,g.y,m.x,m.y);const v=this._boundsArray=new s.StructArrayLayout4i8;v.emplaceBack(u.x,u.y,0,0),v.emplaceBack(f.x,f.y,s.EXTENT,0),v.emplaceBack(g.x,g.y,0,s.EXTENT),v.emplaceBack(m.x,m.y,s.EXTENT,s.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=t.createVertexBuffer(v,s.boundsAttributes.members),this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const t=this.map.painter.context,o=t.gl;this.texture?this.texture.update(this.image):(this.texture=new s.Texture(t,this.image,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE)),this._prepareData(t)}loadTile(t,o){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},o(null)):(t.state="errored",o(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const me={vector:class extends s.Evented{constructor(l,t,o,u){if(super(),this.id=l,this.dispatcher=o,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.extend(this,s.pick(t,["url","scheme","tileSize","promoteId"])),this._options=s.extend({type:"vector"},t),this._collectResourceTiming=t.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(u),this._tileWorkers={},this._deduped=new s.DedupedRequest}load(){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Je(this._options,this.map._requestManager,(l,t)=>{this._tileJSONRequest=null,this._loaded=!0,l?this.fire(new s.ErrorEvent(l)):t&&(s.extend(this,t),t.bounds&&(this.tileBounds=new xt(t.bounds,this.minzoom,this.maxzoom)),s.postTurnstileEvent(t.tiles,this.map._requestManager._customAccessToken),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}onAdd(l){this.map=l,this.load()}setSourceProperty(l){this._tileJSONRequest&&this._tileJSONRequest.cancel(),l();const t=this.map.style._getSourceCaches(this.id);for(const o of t)o.clearTiles();this.load()}setTiles(l){return this.setSourceProperty(()=>{this._options.tiles=l}),this}setUrl(l){return this.setSourceProperty(()=>{this.url=l,this._options.url=l}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return s.extend({},this._options)}loadTile(l,t){const o=this.map._requestManager.normalizeTileURL(l.tileID.canonical.url(this.tiles,this.scheme)),u={request:this.map._requestManager.transformRequest(o,s.ResourceType.Tile),data:void 0,uid:l.uid,tileID:l.tileID,tileZoom:l.tileZoom,zoom:l.tileID.overscaledZ,tileSize:this.tileSize*l.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:s.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:l.isSymbolTile};if(u.request.collectResourceTiming=this._collectResourceTiming,l.actor&&l.state!=="expired")l.state==="loading"?l.reloadCallback=t:l.request=l.actor.send("reloadTile",u,f.bind(this));else if(l.actor=this._tileWorkers[o]=this._tileWorkers[o]||this.dispatcher.getActor(),this.dispatcher.ready)l.request=l.actor.send("loadTile",u,f.bind(this),void 0,!0);else{const m=s.loadVectorTile.call({deduped:this._deduped},u,(g,v)=>{g||!v?f.call(this,g):(u.data={cacheControl:v.cacheControl,expires:v.expires,rawData:v.rawData.slice(0)},l.actor&&l.actor.send("loadTile",u,f.bind(this),void 0,!0))},!0);l.request={cancel:m}}function f(m,g){return delete l.request,l.aborted?t(null):m&&m.status!==404?t(m):(g&&g.resourceTiming&&(l.resourceTiming=g.resourceTiming),this.map._refreshExpiredTiles&&g&&l.setExpiryData(g),l.loadVectorData(g,this.map.painter),s.cacheEntryPossiblyAdded(this.dispatcher),t(null),void(l.reloadCallback&&(this.loadTile(l,l.reloadCallback),l.reloadCallback=null)))}}abortTile(l){l.request&&(l.request.cancel(),delete l.request),l.actor&&l.actor.send("abortTile",{uid:l.uid,type:this.type,source:this.id})}unloadTile(l){l.unloadVectorData(),l.actor&&l.actor.send("removeTile",{uid:l.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}},raster:L,"raster-dem":class extends L{constructor(l,t,o,u){super(l,t,o,u),this.type="raster-dem",this.maxzoom=22,this._options=s.extend({type:"raster-dem"},t),this.encoding=t.encoding||"mapbox"}loadTile(l,t){const o=this.map._requestManager.normalizeTileURL(l.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function u(f,m){f&&(l.state="errored",t(f)),m&&(l.dem=m,l.dem.onDeserialize(),l.needsHillshadePrepare=!0,l.needsDEMTextureUpload=!0,l.state="loaded",t(null))}l.request=s.getImage(this.map._requestManager.transformRequest(o,s.ResourceType.Tile),function(f,m,g,v){if(delete l.request,l.aborted)l.state="unloaded",t(null);else if(f)l.state="errored",t(f);else if(m){this.map._refreshExpiredTiles&&l.setExpiryData({cacheControl:g,expires:v});const T=s.window.ImageBitmap&&m instanceof s.window.ImageBitmap&&(j==null&&(j=s.window.OffscreenCanvas&&new s.window.OffscreenCanvas(1,1).getContext("2d")&&typeof s.window.createImageBitmap=="function"),j),C=1-(m.width-s.prevPowerOfTwo(m.width))/2;C<1||l.neighboringTiles||(l.neighboringTiles=this._getNeighboringTiles(l.tileID));const S=T?m:s.exported.getImageData(m,C),k={uid:l.uid,coord:l.tileID,source:this.id,rawImageData:S,encoding:this.encoding,padding:C};l.actor&&l.state!=="expired"||(l.actor=this.dispatcher.getActor(),l.actor.send("loadDEMTile",k,u.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(l){const t=l.canonical,o=Math.pow(2,t.z),u=(t.x-1+o)%o,f=t.x===0?l.wrap-1:l.wrap,m=(t.x+1+o)%o,g=t.x+1===o?l.wrap+1:l.wrap,v={};return v[new s.OverscaledTileID(l.overscaledZ,f,t.z,u,t.y).key]={backfilled:!1},v[new s.OverscaledTileID(l.overscaledZ,g,t.z,m,t.y).key]={backfilled:!1},t.y>0&&(v[new s.OverscaledTileID(l.overscaledZ,f,t.z,u,t.y-1).key]={backfilled:!1},v[new s.OverscaledTileID(l.overscaledZ,l.wrap,t.z,t.x,t.y-1).key]={backfilled:!1},v[new s.OverscaledTileID(l.overscaledZ,g,t.z,m,t.y-1).key]={backfilled:!1}),t.y+1<o&&(v[new s.OverscaledTileID(l.overscaledZ,f,t.z,u,t.y+1).key]={backfilled:!1},v[new s.OverscaledTileID(l.overscaledZ,l.wrap,t.z,t.x,t.y+1).key]={backfilled:!1},v[new s.OverscaledTileID(l.overscaledZ,g,t.z,m,t.y+1).key]={backfilled:!1}),v}unloadTile(l){l.demTexture&&this.map.painter.saveTileTexture(l.demTexture),l.fbo&&(l.fbo.destroy(),delete l.fbo),l.dem&&delete l.dem,delete l.neighboringTiles,l.state="unloaded"}},geojson:class extends s.Evented{constructor(l,t,o,u){super(),this.id=l,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=o.getActor(),this.setEventedParent(u),this._data=t.data,this._options=s.extend({},t),this._collectResourceTiming=t.collectResourceTiming,t.maxzoom!==void 0&&(this.maxzoom=t.maxzoom),t.type&&(this.type=t.type),t.attribution&&(this.attribution=t.attribution),this.promoteId=t.promoteId;const f=s.EXTENT/this.tileSize;this.workerOptions=s.extend({source:this.id,cluster:t.cluster||!1,geojsonVtOptions:{buffer:(t.buffer!==void 0?t.buffer:128)*f,tolerance:(t.tolerance!==void 0?t.tolerance:.375)*f,extent:s.EXTENT,maxZoom:this.maxzoom,lineMetrics:t.lineMetrics||!1,generateId:t.generateId||!1},superclusterOptions:{maxZoom:t.clusterMaxZoom!==void 0?t.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,t.clusterMinPoints||2),extent:s.EXTENT,radius:(t.clusterRadius!==void 0?t.clusterRadius:50)*f,log:!1,generateId:t.generateId||!1},clusterProperties:t.clusterProperties,filter:t.filter},t.workerOptions)}onAdd(l){this.map=l,this.setData(this._data)}setData(l){return this._data=l,this._updateWorkerData(),this}getClusterExpansionZoom(l,t){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:l,source:this.id},t),this}getClusterChildren(l,t){return this.actor.send("geojson.getClusterChildren",{clusterId:l,source:this.id},t),this}getClusterLeaves(l,t,o,u){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:l,limit:t,offset:o},u),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new s.Event("dataloading",{dataType:"source"})),this._loaded=!1;const l=s.extend({},this.workerOptions),t=this._data;typeof t=="string"?(l.request=this.map._requestManager.transformRequest(s.exported.resolveURL(t),s.ResourceType.Source),l.request.collectResourceTiming=this._collectResourceTiming):l.data=JSON.stringify(t),this._pendingLoad=this.actor.send(`${this.type}.loadData`,l,(o,u)=>{if(this._loaded=!0,this._pendingLoad=null,o)this.fire(new s.ErrorEvent(o));else{const f={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&u&&u.resourceTiming&&u.resourceTiming[this.id]&&(f.resourceTiming=u.resourceTiming[this.id]),this.fire(new s.Event("data",f)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(l,t){const o=l.actor?"reloadTile":"loadTile";l.actor=this.actor,l.request=this.actor.send(o,{type:this.type,uid:l.uid,tileID:l.tileID,tileZoom:l.tileZoom,zoom:l.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:s.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(u,f)=>(delete l.request,l.unloadVectorData(),l.aborted?t(null):u?t(u):(l.loadVectorData(f,this.map.painter,o==="reloadTile"),t(null))),void 0,o==="loadTile")}abortTile(l){l.request&&(l.request.cancel(),delete l.request),l.aborted=!0}unloadTile(l){l.unloadVectorData(),this.actor.send("removeTile",{uid:l.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return s.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends ne{constructor(l,t,o,u){super(l,t,o,u),this.roundZoom=!0,this.type="video",this.options=t}load(){this._loaded=!1;const l=this.options;this.urls=[];for(const t of l.urls)this.urls.push(this.map._requestManager.transformRequest(t,s.ResourceType.Source).url);s.getVideo(this.urls,(t,o)=>{this._loaded=!0,t?this.fire(new s.ErrorEvent(t)):o&&(this.video=o,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(l){if(this.video){const t=this.video.seekable;l<t.start(0)||l>t.end(0)?this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${t.start(0)} and ${t.end(0)}-second mark.`))):this.video.currentTime=l}}getVideo(){return this.video}onAdd(l){this.map||(this.map=l,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const l=this.map.painter.context,t=l.gl;this.texture?this.video.paused||(this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE),t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,this.video)):(this.texture=new s.Texture(l,this.video,t.RGBA),this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(l)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:ne,canvas:class extends ne{constructor(l,t,o,u){super(l,t,o,u),t.coordinates?Array.isArray(t.coordinates)&&t.coordinates.length===4&&!t.coordinates.some(f=>!Array.isArray(f)||f.length!==2||f.some(m=>typeof m!="number"))||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${l}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${l}`,null,'missing required property "coordinates"'))),t.animate&&typeof t.animate!="boolean"&&this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${l}`,null,'optional "animate" property must be a boolean value'))),t.canvas?typeof t.canvas=="string"||t.canvas instanceof s.window.HTMLCanvasElement||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${l}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${l}`,null,'missing required property "canvas"'))),this.options=t,this.animate=t.animate===void 0||t.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof s.window.HTMLCanvasElement?this.options.canvas:s.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(l){this.map=l,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let l=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,l=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,l=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const t=this.map.painter.context;this.texture?(l||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new s.Texture(t,this.canvas,t.gl.RGBA,{premultiply:!0}),this._prepareData(t)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const l of[this.canvas.width,this.canvas.height])if(isNaN(l)||l<=0)return!0;return!1}},custom:class extends s.Evented{constructor(l,t,o,u){super(),this.id=l,this.type="custom",this._dataType="raster",this._dispatcher=o,this._implementation=t,this.setEventedParent(u),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new s.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new s.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new xt(this._implementation.bounds,this.minzoom,this.maxzoom)),t.update=this._update.bind(this),t.coveringTiles=this._coveringTiles.bind(this),s.extend(this,s.pick(t,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return s.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(l){this._map=l,this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(l),this.load()}onRemove(l){this._implementation.onRemove&&this._implementation.onRemove(l)}hasTile(l){if(this._implementation.hasTile){const{x:t,y:o,z:u}=l.canonical;return this._implementation.hasTile({x:t,y:o,z:u})}return!this.tileBounds||this.tileBounds.contains(l.canonical)}loadTile(l,t){const{x:o,y:u,z:f}=l.tileID.canonical,m=new s.window.AbortController,g=this._implementation.loadTile({x:o,y:u,z:f},{signal:m.signal});if(!g)return this.loadTileData(l,{width:this.tileSize,height:this.tileSize,data:null}),l.state="loaded",t(null);g.cancel=()=>m.abort(),l.request=g.then(function(v){return delete l.request,l.aborted?(l.state="unloaded",t(null)):v?function(T){return T instanceof s.window.ImageData||T instanceof s.window.ImageBitmap||T instanceof s.window.HTMLCanvasElement}(v)?(this.loadTileData(l,v),l.state="loaded",void t(null)):(l.state="errored",t(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`))):(this.loadTileData(l,{width:this.tileSize,height:this.tileSize,data:null}),l.state="loaded",t(null))}.bind(this)).catch(v=>{v.code!==20&&(l.state="errored",t(v))})}loadTileData(l,t){L.loadTileData(l,t,this._map.painter)}unloadTileData(l){L.unloadTileData(l,this._map.painter)}prepareTile(l){if(!this._implementation.prepareTile)return null;const{x:t,y:o,z:u}=l.tileID.canonical,f=this._implementation.prepareTile({x:t,y:o,z:u});return f?(this.loadTileData(l,f),l.state="loaded",f):null}unloadTile(l,t){if(this.unloadTileData(l),this._implementation.unloadTile){const{x:o,y:u,z:f}=l.tileID.canonical;this._implementation.unloadTile({x:o,y:u,z:f})}t()}abortTile(l,t){l.request&&l.request.cancel&&(l.request.cancel(),delete l.request),t()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(l=>({x:l.canonical.x,y:l.canonical.y,z:l.canonical.z}))}_update(){this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))}}},fe=function(l,t,o,u){const f=new me[t.type](l,t,o,u);if(f.id!==l)throw new Error(`Expected Source id to be ${l} instead of ${f.id}`);return s.bindAll(["load","abort","unload","serialize","prepare"],f),f};function se(l,t){const o=s.identity([]);return s.scale(o,o,[.5*l.width,.5*-l.height,1]),s.translate(o,o,[1,-1,0]),s.multiply$1(o,o,l.calculateProjMatrix(t.toUnwrapped())),Float32Array.from(o)}function ye(l,t,o,u,f,m,g,v=!1){const T=l.tilesIn(u,g,v);T.sort(Ke);const C=[];for(const k of T)C.push({wrappedTileID:k.tile.tileID.wrapped().key,queryResults:k.tile.queryRenderedFeatures(t,o,l._state,k,f,m,se(l.transform,k.tile.tileID),v)});const S=function(k){const O={},V={};for(const N of k){const R=N.queryResults,Q=N.wrappedTileID,Z=V[Q]=V[Q]||{};for(const Y in R){const X=R[Y],ee=Z[Y]=Z[Y]||{},H=O[Y]=O[Y]||[];for(const re of X)ee[re.featureIndex]||(ee[re.featureIndex]=!0,H.push(re))}}return O}(C);for(const k in S)S[k].forEach(O=>{const V=O.feature,N=V.layer;N&&N.type!=="background"&&N.type!=="sky"&&(V.source=N.source,N["source-layer"]&&(V.sourceLayer=N["source-layer"]),V.state=V.id!==void 0?l.getFeatureState(N["source-layer"],V.id):{})});return S}function ke(l,t){const o=l.getRenderableIds().map(m=>l.getTileByID(m)),u=[],f={};for(let m=0;m<o.length;m++){const g=o[m],v=g.tileID.canonical.key;f[v]||(f[v]=!0,g.querySourceFeatures(u,t))}return u}function Ke(l,t){const o=l.tileID,u=t.tileID;return o.overscaledZ-u.overscaledZ||o.canonical.y-u.canonical.y||o.wrap-u.wrap||o.canonical.x-u.canonical.x}function Le(){return Xo.workerClass!=null?new Xo.workerClass:new s.window.Worker(Xo.workerUrl)}const vt="mapboxgl_preloaded_worker_pool";class mt{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<mt.workerCount;)this.workers.push(new Le);return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.numActive()===0&&(this.workers.forEach(o=>{o.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[vt]}numActive(){return Object.keys(this.active).length}}let _t;function Tt(){return _t||(_t=new mt),_t}function xe(l,t){const o={};for(const u in l)u!=="ref"&&(o[u]=l[u]);return s.refProperties.forEach(u=>{u in t&&(o[u]=t[u])}),o}function ei(l){l=l.slice();const t=Object.create(null);for(let o=0;o<l.length;o++)t[l[o].id]=l[o];for(let o=0;o<l.length;o++)"ref"in l[o]&&(l[o]=xe(l[o],t[l[o].ref]));return l}mt.workerCount=2;const at={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function Kt(l,t,o){o.push({command:at.addSource,args:[l,t[l]]})}function ti(l,t,o){t.push({command:at.removeSource,args:[l]}),o[l]=!0}function uo(l,t,o,u){ti(l,o,u),Kt(l,t,o)}function vn(l,t,o){let u;for(u in l[o])if(l[o].hasOwnProperty(u)&&u!=="data"&&!J(l[o][u],t[o][u]))return!1;for(u in t[o])if(t[o].hasOwnProperty(u)&&u!=="data"&&!J(l[o][u],t[o][u]))return!1;return!0}function He(l,t,o,u,f,m){let g;for(g in t=t||{},l=l||{})l.hasOwnProperty(g)&&(J(l[g],t[g])||o.push({command:m,args:[u,g,t[g],f]}));for(g in t)t.hasOwnProperty(g)&&!l.hasOwnProperty(g)&&(J(l[g],t[g])||o.push({command:m,args:[u,g,t[g],f]}))}function Gt(l){return l.id}function Rt(l,t){return l[t.id]=t,l}class pn{constructor(t,o){this.reset(t,o)}reset(t,o){this.points=t||[],this._distances=[0];for(let u=1;u<this.points.length;u++)this._distances[u]=this._distances[u-1]+this.points[u].dist(this.points[u-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(o||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(this.points.length===1)return this.points[0];t=s.clamp(t,0,1);let o=1,u=this._distances[o];const f=t*this.paddedLength+this.padding;for(;u<f&&o<this._distances.length;)u=this._distances[++o];const m=o-1,g=this._distances[m],v=u-g,T=v>0?(f-g)/v:0;return this.points[m].mult(1-T).add(this.points[o].mult(T))}}class ho{constructor(t,o,u){const f=this.boxCells=[],m=this.circleCells=[];this.xCellCount=Math.ceil(t/u),this.yCellCount=Math.ceil(o/u);for(let g=0;g<this.xCellCount*this.yCellCount;g++)f.push([]),m.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=o,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/o,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,o,u,f,m){this._forEachCell(o,u,f,m,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(o),this.bboxes.push(u),this.bboxes.push(f),this.bboxes.push(m)}insertCircle(t,o,u,f){this._forEachCell(o-f,u-f,o+f,u+f,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(o),this.circles.push(u),this.circles.push(f)}_insertBoxCell(t,o,u,f,m,g){this.boxCells[m].push(g)}_insertCircleCell(t,o,u,f,m,g){this.circleCells[m].push(g)}_query(t,o,u,f,m,g){if(u<0||t>this.width||f<0||o>this.height)return!m&&[];const v=[];if(t<=0&&o<=0&&this.width<=u&&this.height<=f){if(m)return!0;for(let T=0;T<this.boxKeys.length;T++)v.push({key:this.boxKeys[T],x1:this.bboxes[4*T],y1:this.bboxes[4*T+1],x2:this.bboxes[4*T+2],y2:this.bboxes[4*T+3]});for(let T=0;T<this.circleKeys.length;T++){const C=this.circles[3*T],S=this.circles[3*T+1],k=this.circles[3*T+2];v.push({key:this.circleKeys[T],x1:C-k,y1:S-k,x2:C+k,y2:S+k})}return g?v.filter(g):v}return this._forEachCell(t,o,u,f,this._queryCell,v,{hitTest:m,seenUids:{box:{},circle:{}}},g),m?v.length>0:v}_queryCircle(t,o,u,f,m){const g=t-u,v=t+u,T=o-u,C=o+u;if(v<0||g>this.width||C<0||T>this.height)return!f&&[];const S=[];return this._forEachCell(g,T,v,C,this._queryCellCircle,S,{hitTest:f,circle:{x:t,y:o,radius:u},seenUids:{box:{},circle:{}}},m),f?S.length>0:S}query(t,o,u,f,m){return this._query(t,o,u,f,!1,m)}hitTest(t,o,u,f,m){return this._query(t,o,u,f,!0,m)}hitTestCircle(t,o,u,f){return this._queryCircle(t,o,u,!0,f)}_queryCell(t,o,u,f,m,g,v,T){const C=v.seenUids,S=this.boxCells[m];if(S!==null){const O=this.bboxes;for(const V of S)if(!C.box[V]){C.box[V]=!0;const N=4*V;if(t<=O[N+2]&&o<=O[N+3]&&u>=O[N+0]&&f>=O[N+1]&&(!T||T(this.boxKeys[V]))){if(v.hitTest)return g.push(!0),!0;g.push({key:this.boxKeys[V],x1:O[N],y1:O[N+1],x2:O[N+2],y2:O[N+3]})}}}const k=this.circleCells[m];if(k!==null){const O=this.circles;for(const V of k)if(!C.circle[V]){C.circle[V]=!0;const N=3*V;if(this._circleAndRectCollide(O[N],O[N+1],O[N+2],t,o,u,f)&&(!T||T(this.circleKeys[V]))){if(v.hitTest)return g.push(!0),!0;{const R=O[N],Q=O[N+1],Z=O[N+2];g.push({key:this.circleKeys[V],x1:R-Z,y1:Q-Z,x2:R+Z,y2:Q+Z})}}}}}_queryCellCircle(t,o,u,f,m,g,v,T){const C=v.circle,S=v.seenUids,k=this.boxCells[m];if(k!==null){const V=this.bboxes;for(const N of k)if(!S.box[N]){S.box[N]=!0;const R=4*N;if(this._circleAndRectCollide(C.x,C.y,C.radius,V[R+0],V[R+1],V[R+2],V[R+3])&&(!T||T(this.boxKeys[N])))return g.push(!0),!0}}const O=this.circleCells[m];if(O!==null){const V=this.circles;for(const N of O)if(!S.circle[N]){S.circle[N]=!0;const R=3*N;if(this._circlesCollide(V[R],V[R+1],V[R+2],C.x,C.y,C.radius)&&(!T||T(this.circleKeys[N])))return g.push(!0),!0}}}_forEachCell(t,o,u,f,m,g,v,T){const C=this._convertToXCellCoord(t),S=this._convertToYCellCoord(o),k=this._convertToXCellCoord(u),O=this._convertToYCellCoord(f);for(let V=C;V<=k;V++)for(let N=S;N<=O;N++)if(m.call(this,t,o,u,f,this.xCellCount*N+V,g,v,T))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,o,u,f,m,g){const v=f-t,T=m-o,C=u+g;return C*C>v*v+T*T}_circleAndRectCollide(t,o,u,f,m,g,v){const T=(g-f)/2,C=Math.abs(t-(f+T));if(C>T+u)return!1;const S=(v-m)/2,k=Math.abs(o-(m+S));if(k>S+u)return!1;if(C<=T||k<=S)return!0;const O=C-T,V=k-S;return O*O+V*V<=u*u}}const Nt=Math.tan(85*Math.PI/180);function po(l,t,o,u,f,m){const g=s.create();if(o){if(f.projection.name==="globe")s.multiply$1(g,g,s.calculateGlobeLabelMatrix(f,t));else{const v=Ki([],m);g[0]=v[0],g[1]=v[1],g[4]=v[2],g[5]=v[3]}u||s.rotateZ(g,g,f.angle)}else s.multiply$1(g,f.labelPlaneMatrix,l);return g}function Ro(l,t,o,u,f,m){if(o){if(f.projection.name==="globe"){const g=po(l,t,o,u,f,m);return s.invert(g,g),s.multiply$1(g,l,g),g}{const g=s.clone(l),v=s.identity([]);return v[0]=m[0],v[1]=m[1],v[4]=m[2],v[5]=m[3],s.multiply$1(g,g,v),u||s.rotateZ(g,g,-f.angle),g}}return f.glCoordMatrix}function dr(l,t,o=0){const u=[l.x,l.y,o,1];o?s.transformMat4$1(u,u,t):Er(u,u,t);const f=u[3];return{point:new s.pointGeometry(u[0]/f,u[1]/f),signedDistanceFromCamera:f}}function Nr(l,t){const o=[l[0],l[1],l[2],1];s.transformMat4$1(o,o,t);const u=o[3];return{point:new s.pointGeometry(o[0]/u,o[1]/u),signedDistanceFromCamera:u}}function Ti(l,t){return Math.min(.5+l/t*.5,1.5)}function ud(l,t){const o=l[0]/l[3],u=l[1]/l[3];return o>=-t[0]&&o<=t[0]&&u>=-t[1]&&u<=t[1]}function bs(l,t,o,u,f,m,g,v,T,C){const S=o.transform,k=u?l.textSizeData:l.iconSizeData,O=s.evaluateSizeForZoom(k,o.transform.zoom),V=[256/o.width*2+1,256/o.height*2+1],N=u?l.text.dynamicLayoutVertexArray:l.icon.dynamicLayoutVertexArray;N.clear();const R=l.lineVertexArray,Q=u?l.text.placedSymbolArray:l.icon.placedSymbolArray,Z=o.transform.width/o.transform.height;let Y=!1;for(let X=0;X<Q.length;X++){const ee=Q.get(X);if(ee.writingMode!==s.WritingMode.vertical||Y||X!==0&&Q.get(X-1).writingMode===s.WritingMode.horizontal||(Y=!0),(ee.hidden||ee.writingMode===s.WritingMode.vertical)&&!Y){Vi(ee.numGlyphs,N);continue}Y=!1;const H=new s.pointGeometry(ee.tileAnchorX,ee.tileAnchorY),re=T?T(H):[0,0,0],_e=S.projection.projectTilePoint(H.x,H.y,C.canonical),Ae=[_e.x+re[0],_e.y+re[1],_e.z+re[2]],Se=[...Ae,1];if(s.transformMat4$1(Se,Se,t),!ud(Se,V)){Vi(ee.numGlyphs,N);continue}const Ce=Ti(o.transform.cameraToCenterDistance,Se[3]),Ge=s.evaluateSizeForFeature(k,O,ee),ge=g?Ge/Ce:Ge*Ce,Ue=dr(new s.pointGeometry(Ae[0],Ae[1]),f,Ae[2]);if(Ue.signedDistanceFromCamera<=0){Vi(ee.numGlyphs,N);continue}let Oe={};const st=g?null:T,be=ga(ee,ge,!1,v,t,f,m,l.glyphOffsetArray,R,N,Ue.point,H,Oe,Z,st,S.projection,C);Y=be.useVertical,st&&be.needsFlipping&&(Oe={}),(be.notEnoughRoom||Y||be.needsFlipping&&ga(ee,ge,!0,v,t,f,m,l.glyphOffsetArray,R,N,Ue.point,H,Oe,Z,st,S.projection,C).notEnoughRoom)&&Vi(ee.numGlyphs,N)}u?l.text.dynamicLayoutVertexBuffer.updateData(N):l.icon.dynamicLayoutVertexBuffer.updateData(N)}function _a(l,t,o,u,f,m,g,v,T,C,S,k,O,V,N){const R=v.glyphStartIndex+v.numGlyphs,Q=v.lineStartIndex,Z=v.lineStartIndex+v.lineLength,Y=t.getoffsetX(v.glyphStartIndex),X=t.getoffsetX(R-1),ee=Oo(l*Y,o,u,f,m,g,v.segment,Q,Z,T,C,S,k,O,!0,V,N);if(!ee)return null;const H=Oo(l*X,o,u,f,m,g,v.segment,Q,Z,T,C,S,k,O,!0,V,N);return H?{first:ee,last:H}:null}function Fo(l,t,o,u){return l.writingMode===s.WritingMode.horizontal&&Math.abs(o.y-t.y)>Math.abs(o.x-t.x)*u?{useVertical:!0}:l.writingMode===s.WritingMode.vertical?t.y<o.y?{needsFlipping:!0}:null:l.flipState!==0&&function(f,m,g){const v=(m.x-f.x)*g;return v===0||Math.abs((m.y-f.y)/v)>Nt}(t,o,u)?l.flipState===1?{needsFlipping:!0}:null:t.x>o.x?{needsFlipping:!0}:null}function ga(l,t,o,u,f,m,g,v,T,C,S,k,O,V,N,R,Q){const Z=t/24,Y=l.lineOffsetX*Z,X=l.lineOffsetY*Z;let ee;if(l.numGlyphs>1){const H=l.glyphStartIndex+l.numGlyphs,re=l.lineStartIndex,_e=l.lineStartIndex+l.lineLength,Ae=_a(Z,v,Y,X,o,S,k,l,T,m,O,N,!1,R,Q);if(!Ae)return{notEnoughRoom:!0};const Se=dr(Ae.first.point,g).point,Ce=dr(Ae.last.point,g).point;if(u&&!o){const Ge=Fo(l,Se,Ce,V);if(l.flipState=Ge&&Ge.needsFlipping?1:2,Ge)return Ge}ee=[Ae.first];for(let Ge=l.glyphStartIndex+1;Ge<H-1;Ge++)ee.push(Oo(Z*v.getoffsetX(Ge),Y,X,o,S,k,l.segment,re,_e,T,m,O,N,!1,!1,R,Q));ee.push(Ae.last)}else{if(u&&!o){const re=dr(k,f).point,_e=l.lineStartIndex+l.segment+1,Ae=new s.pointGeometry(T.getx(_e),T.gety(_e)),Se=dr(Ae,f),Ce=Fo(l,re,Se.signedDistanceFromCamera>0?Se.point:$t(k,Ae,re,1,f,void 0,R,Q.canonical),V);if(l.flipState=Ce&&Ce.needsFlipping?1:2,Ce)return Ce}const H=Oo(Z*v.getoffsetX(l.glyphStartIndex),Y,X,o,S,k,l.segment,l.lineStartIndex,l.lineStartIndex+l.lineLength,T,m,O,N,!1,!1,R,Q);if(!H)return{notEnoughRoom:!0};ee=[H]}for(const H of ee)s.addDynamicAttributes(C,H.point,H.angle);return{}}function zl(l,t,o,u,f){const m=u.projectTilePoint(l.x,l.y,t);if(!f)return dr(m,o,m.z);const g=f(l);return dr(new s.pointGeometry(m.x+g[0],m.y+g[1]),o,m.z+g[2])}function $t(l,t,o,u,f,m,g,v){const T=zl(l.add(l.sub(t)._unit()),v,f,g,m).point,C=o.sub(T);return o.add(C._mult(u/C.mag()))}function Oo(l,t,o,u,f,m,g,v,T,C,S,k,O,V,N,R,Q){const Z=u?l-t:l+t;let Y=Z>0?1:-1,X=0;u&&(Y*=-1,X=Math.PI),Y<0&&(X+=Math.PI);let ee=Y>0?v+g:v+g+1,H=f,re=f,_e=0,Ae=0;const Se=Math.abs(Z),Ce=[],Ge=[];let ge=m;const Ue=()=>{const rt=ee-Y;return _e===0?m:new s.pointGeometry(C.getx(rt),C.gety(rt))},Oe=()=>$t(Ue(),ge,re,Se-_e+1,S,O,R,Q.canonical);for(;_e+Ae<=Se;){if(ee+=Y,ee<v||ee>=T)return null;if(re=H,Ce.push(H),V&&Ge.push(ge||Ue()),H=k[ee],H===void 0){ge=new s.pointGeometry(C.getx(ee),C.gety(ee));const rt=zl(ge,Q.canonical,S,R,O);H=rt.signedDistanceFromCamera>0?k[ee]=rt.point:Oe()}else ge=null;_e+=Ae,Ae=re.dist(H)}N&&O&&(ge=ge||new s.pointGeometry(C.getx(ee),C.gety(ee)),k[ee]=H=k[ee]===void 0?H:Oe(),Ae=re.dist(H));const st=(Se-_e)/Ae,be=H.sub(re),pt=be.mult(st)._add(re);o&&pt._add(be._unit()._perp()._mult(o*Y));const gt=X+Math.atan2(H.y-re.y,H.x-re.x);return Ce.push(pt),V&&(ge=ge||new s.pointGeometry(C.getx(ee),C.gety(ee)),Ge.push(function(rt,nt,At){const Pt=1-At;return new s.pointGeometry(rt.x*Pt+nt.x*At,rt.y*Pt+nt.y*At)}(Ge.length>0?Ge[Ge.length-1]:ge,ge,st))),{point:pt,angle:gt,path:Ce,tilePath:Ge}}const Dl=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Vi(l,t){for(let o=0;o<l;o++){const u=t.length;t.resize(u+4),t.float32.set(Dl,3*u)}}function Er(l,t,o){const u=t[0],f=t[1];return l[0]=o[0]*u+o[4]*f+o[12],l[1]=o[1]*u+o[5]*f+o[13],l[3]=o[3]*u+o[7]*f+o[15],l}const rn=100;class ya{constructor(t,o,u=new ho(t.width+200,t.height+200,25),f=new ho(t.width+200,t.height+200,25)){this.transform=t,this.grid=u,this.ignoredGrid=f,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+rn,this.screenBottomBoundary=t.height+rn,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.fogState=o}placeCollisionBox(t,o,u,f,m,g,v){let T=o.projectedAnchorX,C=o.projectedAnchorY,S=o.projectedAnchorZ;const k=o.elevation,O=o.tileID;if(k&&O){const ee=this.transform.projection.upVector(O.canonical,o.tileAnchorX,o.tileAnchorY),H=this.transform.projection.upVectorScale(O.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;T+=ee[0]*k*H,C+=ee[1]*k*H,S+=ee[2]*k*H}const V=this.projectAndGetPerspectiveRatio(g,[T,C,S],o.tileID,this.transform.projection.name==="globe"||!!k||this.transform.pitch>0),N=m*V.perspectiveRatio,R=(o.x1*t+u.x-o.padding)*N+V.point.x,Q=(o.y1*t+u.y-o.padding)*N+V.point.y,Z=(o.x2*t+u.x+o.padding)*N+V.point.x,Y=(o.y2*t+u.y+o.padding)*N+V.point.y,X=V.perspectiveRatio<=.55||V.occluded;return!this.isInsideGrid(R,Q,Z,Y)||!f&&this.grid.hitTest(R,Q,Z,Y,v)||X?{box:[],offscreen:!1,occluded:V.occluded}:{box:[R,Q,Z,Y],offscreen:this.isOffscreen(R,Q,Z,Y),occluded:!1}}placeCollisionCircles(t,o,u,f,m,g,v,T,C,S,k,O,V,N){const R=[],Q=this.transform.elevation,Z=Q?Q.getAtTileOffsetFunc(N,this.transform.center.lat,this.transform.worldSize,this.transform.projection):Oe=>[0,0,0],Y=new s.pointGeometry(o.tileAnchorX,o.tileAnchorY),X=this.transform.projection.projectTilePoint(o.tileAnchorX,o.tileAnchorY,N.canonical),ee=Z(Y),H=[X.x+ee[0],X.y+ee[1],X.z+ee[2]],re=this.projectAndGetPerspectiveRatio(g,[H[0],H[1],H[2]],N,this.transform.projection.name==="globe"||!!Q||this.transform.pitch>0),{perspectiveRatio:_e}=re,Ae=(S?m/_e:m*_e)/s.ONE_EM,Se=dr(new s.pointGeometry(H[0],H[1]),v,H[2]).point,Ce=re.signedDistanceFromCamera>0?_a(Ae,f,o.lineOffsetX*Ae,o.lineOffsetY*Ae,!1,Se,Y,o,u,v,{},Q&&!S?Z:null,S&&!!Q,this.transform.projection,N):null;let Ge=!1,ge=!1,Ue=!0;if(Ce&&!re.occluded){const Oe=.5*O*_e+V,st=new s.pointGeometry(-100,-100),be=new s.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),pt=new pn,gt=Ce.first,rt=Ce.last;let nt=[];for(let ct=gt.path.length-1;ct>=1;ct--)nt.push(gt.path[ct]);for(let ct=1;ct<rt.path.length;ct++)nt.push(rt.path[ct]);const At=2.5*Oe;if(T){const ct=nt.map(Q?(Ct,Ht)=>{const Mi=Z(Ht<gt.path.length-1?gt.tilePath[gt.path.length-1-Ht]:rt.tilePath[Ht-gt.path.length+2]);return dr(Ct,T,Mi[2])}:Ct=>dr(Ct,T));nt=ct.some(Ct=>Ct.signedDistanceFromCamera<=0)?[]:ct.map(Ct=>Ct.point)}let Pt=[];if(nt.length>0){const ct=nt[0].clone(),Ct=nt[0].clone();for(let Ht=1;Ht<nt.length;Ht++)ct.x=Math.min(ct.x,nt[Ht].x),ct.y=Math.min(ct.y,nt[Ht].y),Ct.x=Math.max(Ct.x,nt[Ht].x),Ct.y=Math.max(Ct.y,nt[Ht].y);Pt=ct.x>=st.x&&Ct.x<=be.x&&ct.y>=st.y&&Ct.y<=be.y?[nt]:Ct.x<st.x||ct.x>be.x||Ct.y<st.y||ct.y>be.y?[]:s.clipLine([nt],st.x,st.y,be.x,be.y)}for(const ct of Pt){pt.reset(ct,.25*Oe);let Ct=0;Ct=pt.length<=.5*Oe?1:Math.ceil(pt.paddedLength/At)+1;for(let Ht=0;Ht<Ct;Ht++){const Mi=Ht/Math.max(Ct-1,1),nr=pt.lerp(Mi),or=nr.x+rn,zr=nr.y+rn;R.push(or,zr,Oe,0);const sn=or-Oe,Cn=zr-Oe,jn=or+Oe,Mn=zr+Oe;if(Ue=Ue&&this.isOffscreen(sn,Cn,jn,Mn),ge=ge||this.isInsideGrid(sn,Cn,jn,Mn),!t&&this.grid.hitTestCircle(or,zr,Oe,k)&&(Ge=!0,!C))return{circles:[],offscreen:!1,collisionDetected:Ge,occluded:!1}}}}return{circles:!C&&Ge||!ge?[]:R,offscreen:Ue,collisionDetected:Ge,occluded:re.occluded}}queryRenderedSymbols(t){if(t.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const o=[];let u=1/0,f=1/0,m=-1/0,g=-1/0;for(const S of t){const k=new s.pointGeometry(S.x+rn,S.y+rn);u=Math.min(u,k.x),f=Math.min(f,k.y),m=Math.max(m,k.x),g=Math.max(g,k.y),o.push(k)}const v=this.grid.query(u,f,m,g).concat(this.ignoredGrid.query(u,f,m,g)),T={},C={};for(const S of v){const k=S.key;if(T[k.bucketInstanceId]===void 0&&(T[k.bucketInstanceId]={}),T[k.bucketInstanceId][k.featureIndex])continue;const O=[new s.pointGeometry(S.x1,S.y1),new s.pointGeometry(S.x2,S.y1),new s.pointGeometry(S.x2,S.y2),new s.pointGeometry(S.x1,S.y2)];s.polygonIntersectsPolygon(o,O)&&(T[k.bucketInstanceId][k.featureIndex]=!0,C[k.bucketInstanceId]===void 0&&(C[k.bucketInstanceId]=[]),C[k.bucketInstanceId].push(k.featureIndex))}return C}insertCollisionBox(t,o,u,f,m){(o?this.ignoredGrid:this.grid).insert({bucketInstanceId:u,featureIndex:f,collisionGroupID:m},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,o,u,f,m){const g=o?this.ignoredGrid:this.grid,v={bucketInstanceId:u,featureIndex:f,collisionGroupID:m};for(let T=0;T<t.length;T+=4)g.insertCircle(v,t[T],t[T+1],t[T+2])}projectAndGetPerspectiveRatio(t,o,u,f){const m=[o[0],o[1],o[2],1];let g=!1;return o[2]||this.transform.pitch>0?(s.transformMat4$1(m,m,t),this.fogState&&u&&(g=function(v,T,C,S,k,O){const V=O.calculateFogTileMatrix(k),N=[T,C,S];return s.transformMat4(N,N,V),Wt(v,N,O.pitch,O._fov)}(this.fogState,o[0],o[1],o[2],u.toUnwrapped(),this.transform)>.9)):Er(m,m,t),{point:new s.pointGeometry((m[0]/m[3]+1)/2*this.transform.width+rn,(-m[1]/m[3]+1)/2*this.transform.height+rn),perspectiveRatio:Math.min(.5+this.transform.cameraToCenterDistance/m[3]*.5,1.5),signedDistanceFromCamera:m[3],occluded:f&&m[2]>m[3]||g}}isOffscreen(t,o,u,f){return u<rn||t>=this.screenRightBoundary||f<rn||o>this.screenBottomBoundary}isInsideGrid(t,o,u,f){return u>=0&&t<this.gridRightBoundary&&f>=0&&o<this.gridBottomBoundary}getViewportMatrix(){const t=s.identity([]);return s.translate(t,t,[-100,-100,0]),t}}class Ri{constructor(t,o,u,f){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?o:-o))):f&&u?1:0,this.placed=u}isHidden(){return this.opacity===0&&!this.placed}}class An{constructor(t,o,u,f,m,g=!1){this.text=new Ri(t?t.text:null,o,u,m),this.icon=new Ri(t?t.icon:null,o,f,m),this.clipped=g}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class bn{constructor(t,o,u,f=!1){this.text=t,this.icon=o,this.skipFade=u,this.clipped=f}}class er{constructor(){this.invProjMatrix=s.create(),this.viewportMatrix=s.create(),this.circles=[]}}class kl{constructor(t,o,u,f,m){this.bucketInstanceId=t,this.featureIndex=o,this.sourceLayerIndex=u,this.bucketIndex=f,this.tileID=m}}class nn{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const o=++this.maxGroupID;this.collisionGroups[t]={ID:o,predicate:u=>u.collisionGroupID===o}}return this.collisionGroups[t]}}function No(l,t,o,u,f){const{horizontalAlign:m,verticalAlign:g}=s.getAnchorAlignment(l),v=-(m-.5)*t,T=-(g-.5)*o,C=s.evaluateVariableOffset(l,u);return new s.pointGeometry(v+C[0]*f,T+C[1]*f)}function Uo(l,t,o,u,f){const m=new s.pointGeometry(l,t);return o&&m._rotate(u?f:-f),m}class hd{constructor(t,o,u,f,m){this.transform=t.clone(),this.collisionIndex=new ya(this.transform,m),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=o,this.retainedQueryData={},this.collisionGroups=new nn(u),this.collisionCircleArrays={},this.prevPlacement=f,f&&(f.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(t,o,u,f){const m=u.getBucket(o),g=u.latestFeatureIndex;if(!m||!g||o.id!==m.layerIds[0])return;const v=m.layers[0].layout,T=u.collisionBoxArray,C=Math.pow(2,this.transform.zoom-u.tileID.overscaledZ),S=u.tileSize/s.EXTENT,k=u.tileID.toUnwrapped(),O=this.transform.calculateProjMatrix(k),V=v.get("text-pitch-alignment")==="map",N=v.get("text-rotation-alignment")==="map";o.compileFilter();const R=o.dynamicFilter(),Q=o.dynamicFilterNeedsFeature(),Z=this.transform.calculatePixelsToTileUnitsMatrix(u),Y=po(O,u.tileID.canonical,V,N,this.transform,Z);let X=null;if(V){const re=Ro(O,u.tileID.canonical,V,N,this.transform,Z);X=s.multiply$1([],this.transform.labelPlaneMatrix,re)}let ee=null;R&&u.latestFeatureIndex&&(ee={unwrappedTileID:k,dynamicFilter:R,dynamicFilterNeedsFeature:Q,featureIndex:u.latestFeatureIndex}),this.retainedQueryData[m.bucketInstanceId]=new kl(m.bucketInstanceId,g,m.sourceLayerIndex,m.index,u.tileID);const H={bucket:m,layout:v,posMatrix:O,textLabelPlaneMatrix:Y,labelToScreenMatrix:X,clippingData:ee,scale:C,textPixelRatio:S,holdingForFade:u.holdingForFade(),collisionBoxArray:T,partiallyEvaluatedTextSize:s.evaluateSizeForZoom(m.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:s.evaluateSizeForZoom(m.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(m.sourceID)};if(f)for(const re of m.sortKeyRanges){const{sortKey:_e,symbolInstanceStart:Ae,symbolInstanceEnd:Se}=re;t.push({sortKey:_e,symbolInstanceStart:Ae,symbolInstanceEnd:Se,parameters:H})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:m.symbolInstances.length,parameters:H})}attemptAnchorPlacement(t,o,u,f,m,g,v,T,C,S,k,O,V,N,R,Q,Z,Y){const X=[O.textOffset0,O.textOffset1],ee=No(t,u,f,X,m),H=this.collisionIndex.placeCollisionBox(m,o,Uo(ee.x,ee.y,g,v,this.transform.angle),k,T,C,S.predicate);if((!Q||this.collisionIndex.placeCollisionBox(N.getSymbolInstanceIconSize(Y,this.transform.zoom,V),Q,Uo(ee.x,ee.y,g,v,this.transform.angle),k,T,C,S.predicate).box.length!==0)&&H.box.length>0){let re;return this.prevPlacement&&this.prevPlacement.variableOffsets[O.crossTileID]&&this.prevPlacement.placements[O.crossTileID]&&this.prevPlacement.placements[O.crossTileID].text&&(re=this.prevPlacement.variableOffsets[O.crossTileID].anchor),this.variableOffsets[O.crossTileID]={textOffset:X,width:u,height:f,anchor:t,textScale:m,prevAnchor:re},this.markUsedJustification(N,t,O,R),N.allowVerticalPlacement&&(this.markUsedOrientation(N,R,O),this.placedOrientations[O.crossTileID]=R),{shift:ee,placedGlyphBoxes:H}}}placeLayerBucketPart(t,o,u,f){const{bucket:m,layout:g,posMatrix:v,textLabelPlaneMatrix:T,labelToScreenMatrix:C,clippingData:S,textPixelRatio:k,holdingForFade:O,collisionBoxArray:V,partiallyEvaluatedTextSize:N,partiallyEvaluatedIconSize:R,collisionGroup:Q}=t.parameters,Z=g.get("text-optional"),Y=g.get("icon-optional"),X=g.get("text-allow-overlap"),ee=g.get("icon-allow-overlap"),H=g.get("text-rotation-alignment")==="map",re=g.get("text-pitch-alignment")==="map",_e=g.get("icon-text-fit")!=="none",Ae=g.get("symbol-z-order")==="viewport-y";let Se=X&&(ee||!m.hasIconData()||Y),Ce=ee&&(X||!m.hasTextData()||Z);!m.collisionArrays&&V&&m.deserializeCollisionBoxes(V),u&&f&&m.updateCollisionDebugBuffers(this.transform.zoom,V);const Ge=(ge,Ue,Oe)=>{if(S){const Si={zoom:this.transform.zoom,pitch:this.transform.pitch};let Di=null;if(S.dynamicFilterNeedsFeature){const ii=this.retainedQueryData[m.bucketInstanceId];Di=S.featureIndex.loadFeature({featureIndex:ge.featureIndex,bucketIndex:ii.bucketIndex,sourceLayerIndex:ii.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,S.dynamicFilter)(Si,Di,this.retainedQueryData[m.bucketInstanceId].tileID.canonical,new s.pointGeometry(ge.tileAnchorX,ge.tileAnchorY),this.transform.calculateDistanceTileData(S.unwrappedTileID)))return this.placements[ge.crossTileID]=new bn(!1,!1,!1,!0),void(o[ge.crossTileID]=!0)}if(o[ge.crossTileID])return;if(O)return void(this.placements[ge.crossTileID]=new bn(!1,!1,!1));let st=!1,be=!1,pt=!0,gt=!1,rt=!1,nt=null,At={box:null,offscreen:null,occluded:null},Pt={box:null,offscreen:null,occluded:null},ct=null,Ct=null,Ht=null,Mi=0,nr=0,or=0;Oe.textFeatureIndex?Mi=Oe.textFeatureIndex:ge.useRuntimeCollisionCircles&&(Mi=ge.featureIndex),Oe.verticalTextFeatureIndex&&(nr=Oe.verticalTextFeatureIndex);const zr=Si=>{Si.tileID=this.retainedQueryData[m.bucketInstanceId].tileID,(this.transform.elevation||Si.elevation)&&(Si.elevation=this.transform.elevation?this.transform.elevation.getAtTileOffset(this.retainedQueryData[m.bucketInstanceId].tileID,Si.tileAnchorX,Si.tileAnchorY):0)},sn=Oe.textBox;if(sn){zr(sn);const Si=ii=>{let Fi=s.WritingMode.horizontal;if(m.allowVerticalPlacement&&!ii&&this.prevPlacement){const Dr=this.prevPlacement.placedOrientations[ge.crossTileID];Dr&&(this.placedOrientations[ge.crossTileID]=Dr,Fi=Dr,this.markUsedOrientation(m,Fi,ge))}return Fi},Di=(ii,Fi)=>{if(m.allowVerticalPlacement&&ge.numVerticalGlyphVertices>0&&Oe.verticalTextBox){for(const Dr of m.writingModes)if(Dr===s.WritingMode.vertical?(At=Fi(),Pt=At):At=ii(),At&&At.box&&At.box.length)break}else At=ii()};if(g.get("text-variable-anchor")){let ii=g.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[ge.crossTileID]){const Ei=this.prevPlacement.variableOffsets[ge.crossTileID];ii.indexOf(Ei.anchor)>0&&(ii=ii.filter(Gr=>Gr!==Ei.anchor),ii.unshift(Ei.anchor))}const Fi=(Ei,Gr,Ys)=>{const kr=m.getSymbolInstanceTextSize(N,ge,this.transform.zoom,Ue),Ao=(Ei.x2-Ei.x1)*kr+2*Ei.padding,ih=(Ei.y2-Ei.y1)*kr+2*Ei.padding,mc=_e&&!ee?Gr:null;mc&&zr(mc);let Qo={box:[],offscreen:!1,occluded:!1};const Sd=X?2*ii.length:ii.length;for(let Zn=0;Zn<Sd;++Zn){const _c=this.attemptAnchorPlacement(ii[Zn%ii.length],Ei,Ao,ih,kr,H,re,k,v,Q,Zn>=ii.length,ge,Ue,m,Ys,mc,N,R);if(_c&&(Qo=_c.placedGlyphBoxes,Qo&&Qo.box&&Qo.box.length)){st=!0,nt=_c.shift;break}}return Qo};Di(()=>Fi(sn,Oe.iconBox,s.WritingMode.horizontal),()=>{const Ei=Oe.verticalTextBox;return Ei&&zr(Ei),m.allowVerticalPlacement&&!(At&&At.box&&At.box.length)&&ge.numVerticalGlyphVertices>0&&Ei?Fi(Ei,Oe.verticalIconBox,s.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),At&&(st=At.box,pt=At.offscreen,gt=At.occluded);const Dr=Si(At&&At.box);if(!st&&this.prevPlacement){const Ei=this.prevPlacement.variableOffsets[ge.crossTileID];Ei&&(this.variableOffsets[ge.crossTileID]=Ei,this.markUsedJustification(m,Ei.anchor,ge,Dr))}}else{const ii=(Fi,Dr)=>{const Ei=m.getSymbolInstanceTextSize(N,ge,this.transform.zoom,Ue),Gr=this.collisionIndex.placeCollisionBox(Ei,Fi,new s.pointGeometry(0,0),X,k,v,Q.predicate);return Gr&&Gr.box&&Gr.box.length&&(this.markUsedOrientation(m,Dr,ge),this.placedOrientations[ge.crossTileID]=Dr),Gr};Di(()=>ii(sn,s.WritingMode.horizontal),()=>{const Fi=Oe.verticalTextBox;return m.allowVerticalPlacement&&ge.numVerticalGlyphVertices>0&&Fi?(zr(Fi),ii(Fi,s.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),Si(At&&At.box&&At.box.length)}}if(ct=At,st=ct&&ct.box&&ct.box.length>0,pt=ct&&ct.offscreen,gt=ct&&ct.occluded,ge.useRuntimeCollisionCircles){const Si=m.text.placedSymbolArray.get(ge.centerJustifiedTextSymbolIndex>=0?ge.centerJustifiedTextSymbolIndex:ge.verticalPlacedTextSymbolIndex),Di=s.evaluateSizeForFeature(m.textSizeData,N,Si),ii=g.get("text-padding");Ct=this.collisionIndex.placeCollisionCircles(X,Si,m.lineVertexArray,m.glyphOffsetArray,Di,v,T,C,u,re,Q.predicate,ge.collisionCircleDiameter*Di/s.ONE_EM,ii,this.retainedQueryData[m.bucketInstanceId].tileID),st=X||Ct.circles.length>0&&!Ct.collisionDetected,pt=pt&&Ct.offscreen,gt=Ct.occluded}if(Oe.iconFeatureIndex&&(or=Oe.iconFeatureIndex),Oe.iconBox){const Si=Di=>{zr(Di);const ii=_e&&nt?Uo(nt.x,nt.y,H,re,this.transform.angle):new s.pointGeometry(0,0),Fi=m.getSymbolInstanceIconSize(R,this.transform.zoom,Ue);return this.collisionIndex.placeCollisionBox(Fi,Di,ii,ee,k,v,Q.predicate)};Pt&&Pt.box&&Pt.box.length&&Oe.verticalIconBox?(Ht=Si(Oe.verticalIconBox),be=Ht.box.length>0):(Ht=Si(Oe.iconBox),be=Ht.box.length>0),pt=pt&&Ht.offscreen,rt=Ht.occluded}const Cn=Z||ge.numHorizontalGlyphVertices===0&&ge.numVerticalGlyphVertices===0,jn=Y||ge.numIconVertices===0;if(Cn||jn?jn?Cn||(be=be&&st):st=be&&st:be=st=be&&st,st&&ct&&ct.box&&this.collisionIndex.insertCollisionBox(ct.box,g.get("text-ignore-placement"),m.bucketInstanceId,Pt&&Pt.box&&nr?nr:Mi,Q.ID),be&&Ht&&this.collisionIndex.insertCollisionBox(Ht.box,g.get("icon-ignore-placement"),m.bucketInstanceId,or,Q.ID),Ct&&(st&&this.collisionIndex.insertCollisionCircles(Ct.circles,g.get("text-ignore-placement"),m.bucketInstanceId,Mi,Q.ID),u)){const Si=m.bucketInstanceId;let Di=this.collisionCircleArrays[Si];Di===void 0&&(Di=this.collisionCircleArrays[Si]=new er);for(let ii=0;ii<Ct.circles.length;ii+=4)Di.circles.push(Ct.circles[ii+0]),Di.circles.push(Ct.circles[ii+1]),Di.circles.push(Ct.circles[ii+2]),Di.circles.push(Ct.collisionDetected?1:0)}const Mn=this.transform.projection.name!=="globe";Se=Se&&(Mn||!gt),Ce=Ce&&(Mn||!rt),this.placements[ge.crossTileID]=new bn(st||Se,be||Ce,pt||m.justReloaded),o[ge.crossTileID]=!0};if(Ae){const ge=m.getSortedSymbolIndexes(this.transform.angle);for(let Ue=ge.length-1;Ue>=0;--Ue){const Oe=ge[Ue];Ge(m.symbolInstances.get(Oe),Oe,m.collisionArrays[Oe])}}else for(let ge=t.symbolInstanceStart;ge<t.symbolInstanceEnd;ge++)Ge(m.symbolInstances.get(ge),ge,m.collisionArrays[ge]);if(u&&m.bucketInstanceId in this.collisionCircleArrays){const ge=this.collisionCircleArrays[m.bucketInstanceId];s.invert(ge.invProjMatrix,v),ge.viewportMatrix=this.collisionIndex.getViewportMatrix()}m.justReloaded=!1}markUsedJustification(t,o,u,f){let m;m=f===s.WritingMode.vertical?u.verticalPlacedTextSymbolIndex:{left:u.leftJustifiedTextSymbolIndex,center:u.centerJustifiedTextSymbolIndex,right:u.rightJustifiedTextSymbolIndex}[s.getAnchorJustification(o)];const g=[u.leftJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.rightJustifiedTextSymbolIndex,u.verticalPlacedTextSymbolIndex];for(const v of g)v>=0&&(t.text.placedSymbolArray.get(v).crossTileID=m>=0&&v!==m?0:u.crossTileID)}markUsedOrientation(t,o,u){const f=o===s.WritingMode.horizontal||o===s.WritingMode.horizontalOnly?o:0,m=o===s.WritingMode.vertical?o:0,g=[u.leftJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.rightJustifiedTextSymbolIndex];for(const v of g)t.text.placedSymbolArray.get(v).placedOrientation=f;u.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(u.verticalPlacedTextSymbolIndex).placedOrientation=m)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const o=this.prevPlacement;let u=!1;this.prevZoomAdjustment=o?o.zoomAdjustment(this.transform.zoom):0;const f=o?o.symbolFadeChange(t):1,m=o?o.opacities:{},g=o?o.variableOffsets:{},v=o?o.placedOrientations:{};for(const T in this.placements){const C=this.placements[T],S=m[T];S?(this.opacities[T]=new An(S,f,C.text,C.icon,null,C.clipped),u=u||C.text!==S.text.placed||C.icon!==S.icon.placed):(this.opacities[T]=new An(null,f,C.text,C.icon,C.skipFade,C.clipped),u=u||C.text||C.icon)}for(const T in m){const C=m[T];if(!this.opacities[T]){const S=new An(C,f,!1,!1);S.isHidden()||(this.opacities[T]=S,u=u||C.text.placed||C.icon.placed)}}for(const T in g)this.variableOffsets[T]||!this.opacities[T]||this.opacities[T].isHidden()||(this.variableOffsets[T]=g[T]);for(const T in v)this.placedOrientations[T]||!this.opacities[T]||this.opacities[T].isHidden()||(this.placedOrientations[T]=v[T]);u?this.lastPlacementChangeTime=t:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=o?o.lastPlacementChangeTime:t)}updateLayerOpacities(t,o){const u={};for(const f of o){const m=f.getBucket(t);m&&f.latestFeatureIndex&&t.id===m.layerIds[0]&&this.updateBucketOpacities(m,u,f.collisionBoxArray)}}updateBucketOpacities(t,o,u){t.hasTextData()&&t.text.opacityVertexArray.clear(),t.hasIconData()&&t.icon.opacityVertexArray.clear(),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const f=t.layers[0].layout,m=!!t.layers[0].dynamicFilter(),g=new An(null,0,!1,!1,!0),v=f.get("text-allow-overlap"),T=f.get("icon-allow-overlap"),C=f.get("text-variable-anchor"),S=f.get("text-rotation-alignment")==="map",k=f.get("text-pitch-alignment")==="map",O=f.get("icon-text-fit")!=="none",V=new An(null,0,v&&(T||!t.hasIconData()||f.get("icon-optional")),T&&(v||!t.hasTextData()||f.get("text-optional")),!0);!t.collisionArrays&&u&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(u);const N=(Q,Z,Y)=>{for(let X=0;X<Z/4;X++)Q.opacityVertexArray.emplaceBack(Y)};let R=0;for(let Q=0;Q<t.symbolInstances.length;Q++){const Z=t.symbolInstances.get(Q),{numHorizontalGlyphVertices:Y,numVerticalGlyphVertices:X,crossTileID:ee}=Z;let H=this.opacities[ee];o[ee]?H=g:H||(H=V,this.opacities[ee]=H),o[ee]=!0;const re=Y>0||X>0,_e=Z.numIconVertices>0,Ae=this.placedOrientations[Z.crossTileID],Se=Ae===s.WritingMode.vertical,Ce=Ae===s.WritingMode.horizontal||Ae===s.WritingMode.horizontalOnly;if(!re&&!_e||H.isHidden()||R++,re){const Ge=hu(H.text);N(t.text,Y,Se?Aa:Ge),N(t.text,X,Ce?Aa:Ge);const ge=H.text.isHidden();[Z.rightJustifiedTextSymbolIndex,Z.centerJustifiedTextSymbolIndex,Z.leftJustifiedTextSymbolIndex].forEach(st=>{st>=0&&(t.text.placedSymbolArray.get(st).hidden=ge||Se?1:0)}),Z.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(Z.verticalPlacedTextSymbolIndex).hidden=ge||Ce?1:0);const Ue=this.variableOffsets[Z.crossTileID];Ue&&this.markUsedJustification(t,Ue.anchor,Z,Ae);const Oe=this.placedOrientations[Z.crossTileID];Oe&&(this.markUsedJustification(t,"left",Z,Oe),this.markUsedOrientation(t,Oe,Z))}if(_e){const Ge=hu(H.icon);Z.placedIconSymbolIndex>=0&&(N(t.icon,Z.numIconVertices,Se?Aa:Ge),t.icon.placedSymbolArray.get(Z.placedIconSymbolIndex).hidden=H.icon.isHidden()),Z.verticalPlacedIconSymbolIndex>=0&&(N(t.icon,Z.numVerticalIconVertices,Ce?Aa:Ge),t.icon.placedSymbolArray.get(Z.verticalPlacedIconSymbolIndex).hidden=H.icon.isHidden())}if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const Ge=t.collisionArrays[Q];if(Ge){let ge=new s.pointGeometry(0,0),Ue=!0;if(Ge.textBox||Ge.verticalTextBox){if(C){const st=this.variableOffsets[ee];st?(ge=No(st.anchor,st.width,st.height,st.textOffset,st.textScale),S&&ge._rotate(k?this.transform.angle:-this.transform.angle)):Ue=!1}m&&(Ue=!H.clipped),Ge.textBox&&on(t.textCollisionBox.collisionVertexArray,H.text.placed,!Ue||Se,ge.x,ge.y),Ge.verticalTextBox&&on(t.textCollisionBox.collisionVertexArray,H.text.placed,!Ue||Ce,ge.x,ge.y)}const Oe=Ue&&Boolean(!Ce&&Ge.verticalIconBox);Ge.iconBox&&on(t.iconCollisionBox.collisionVertexArray,H.icon.placed,Oe,O?ge.x:0,O?ge.y:0),Ge.verticalIconBox&&on(t.iconCollisionBox.collisionVertexArray,H.icon.placed,!Oe,O?ge.x:0,O?ge.y:0)}}}if(t.fullyClipped=R===0,t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.bucketInstanceId in this.collisionCircleArrays){const Q=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=Q.invProjMatrix,t.placementViewportMatrix=Q.viewportMatrix,t.collisionCircleArray=Q.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}}symbolFadeChange(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,o){const u=this.zoomAtLastRecencyCheck===o?1-this.zoomAdjustment(o):1;return this.zoomAtLastRecencyCheck=o,this.commitTime+this.fadeDuration*u>t}setStale(){this.stale=!0}}function on(l,t,o,u,f){l.emplaceBack(t?1:0,o?1:0,u||0,f||0),l.emplaceBack(t?1:0,o?1:0,u||0,f||0),l.emplaceBack(t?1:0,o?1:0,u||0,f||0),l.emplaceBack(t?1:0,o?1:0,u||0,f||0)}const dd=Math.pow(2,25),uu=Math.pow(2,24),Cr=Math.pow(2,17),xa=Math.pow(2,16),Bn=Math.pow(2,9),Pl=Math.pow(2,8),va=Math.pow(2,1);function hu(l){if(l.opacity===0&&!l.placed)return 0;if(l.opacity===1&&l.placed)return 4294967295;const t=l.placed?1:0,o=Math.floor(127*l.opacity);return o*dd+t*uu+o*Cr+t*xa+o*Bn+t*Pl+o*va+t}const Aa=0;class Bl{constructor(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&t.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,o,u,f,m){const g=this._bucketParts;for(;this._currentTileIndex<t.length;)if(o.getBucketParts(g,f,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,m())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,g.sort((v,T)=>v.sortKey-T.sortKey));this._currentPartIndex<g.length;){const v=g[this._currentPartIndex];if(o.placeLayerBucketPart(v,this._seenCrossTileIDs,u,v.symbolInstanceStart===0),this._currentPartIndex++,m())return!0}return!1}}class pd{constructor(t,o,u,f,m,g,v,T){this.placement=new hd(t,m,g,v,T),this._currentPlacementIndex=o.length-1,this._forceFullPlacement=u,this._showCollisionBoxes=f,this._done=!1}isDone(){return this._done}continuePlacement(t,o,u){const f=s.exported.now(),m=()=>{const g=s.exported.now()-f;return!this._forceFullPlacement&&g>2};for(;this._currentPlacementIndex>=0;){const g=o[t[this._currentPlacementIndex]],v=this.placement.collisionIndex.transform.zoom;if(g.type==="symbol"&&(!g.minzoom||g.minzoom<=v)&&(!g.maxzoom||g.maxzoom>v)){if(this._inProgressLayer||(this._inProgressLayer=new Bl(g)),this._inProgressLayer.continuePlacement(u[g.source],this.placement,this._showCollisionBoxes,g,m))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const du=512/s.EXTENT/2;class fd{constructor(t,o,u){this.tileID=t,this.indexedSymbolInstances={},this.bucketInstanceId=u;for(let f=0;f<o.length;f++){const m=o.get(f),g=m.key;this.indexedSymbolInstances[g]||(this.indexedSymbolInstances[g]=[]),this.indexedSymbolInstances[g].push({crossTileID:m.crossTileID,coord:this.getScaledCoordinates(m,t)})}}getScaledCoordinates(t,o){const u=du/Math.pow(2,o.canonical.z-this.tileID.canonical.z);return{x:Math.floor((o.canonical.x*s.EXTENT+t.tileAnchorX)*u),y:Math.floor((o.canonical.y*s.EXTENT+t.tileAnchorY)*u)}}findMatches(t,o,u){const f=this.tileID.canonical.z<o.canonical.z?1:Math.pow(2,this.tileID.canonical.z-o.canonical.z);for(let m=0;m<t.length;m++){const g=t.get(m);if(g.crossTileID)continue;const v=this.indexedSymbolInstances[g.key];if(!v)continue;const T=this.getScaledCoordinates(g,o);for(const C of v)if(Math.abs(C.coord.x-T.x)<=f&&Math.abs(C.coord.y-T.y)<=f&&!u[C.crossTileID]){u[C.crossTileID]=!0,g.crossTileID=C.crossTileID;break}}}}class pu{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class md{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const o=Math.round((t-this.lng)/360);if(o!==0)for(const u in this.indexes){const f=this.indexes[u],m={};for(const g in f){const v=f[g];v.tileID=v.tileID.unwrapTo(v.tileID.wrap+o),m[v.tileID.key]=v}this.indexes[u]=m}this.lng=t}addBucket(t,o,u){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===o.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let m=0;m<o.symbolInstances.length;m++)o.symbolInstances.get(m).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const f=this.usedCrossTileIDs[t.overscaledZ];for(const m in this.indexes){const g=this.indexes[m];if(Number(m)>t.overscaledZ)for(const v in g){const T=g[v];T.tileID.isChildOf(t)&&T.findMatches(o.symbolInstances,t,f)}else{const v=g[t.scaledTo(Number(m)).key];v&&v.findMatches(o.symbolInstances,t,f)}}for(let m=0;m<o.symbolInstances.length;m++){const g=o.symbolInstances.get(m);g.crossTileID||(g.crossTileID=u.generate(),f[g.crossTileID]=!0)}return this.indexes[t.overscaledZ]===void 0&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new fd(t,o.symbolInstances,o.bucketInstanceId),!0}removeBucketCrossTileIDs(t,o){for(const u in o.indexedSymbolInstances)for(const f of o.indexedSymbolInstances[u])delete this.usedCrossTileIDs[t][f.crossTileID]}removeStaleBuckets(t){let o=!1;for(const u in this.indexes){const f=this.indexes[u];for(const m in f)t[f[m].bucketInstanceId]||(this.removeBucketCrossTileIDs(u,f[m]),delete f[m],o=!0)}return o}}class ba{constructor(){this.layerIndexes={},this.crossTileIDs=new pu,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,o,u,f){let m=this.layerIndexes[t.id];m===void 0&&(m=this.layerIndexes[t.id]=new md);let g=!1;const v={};f.name!=="globe"&&m.handleWrapJump(u);for(const T of o){const C=T.getBucket(t);C&&t.id===C.layerIds[0]&&(C.bucketInstanceId||(C.bucketInstanceId=++this.maxBucketInstanceId),m.addBucket(T.tileID,C,this.crossTileIDs)&&(g=!0),v[C.bucketInstanceId]=!0)}return m.removeStaleBuckets(v)&&(g=!0),g}pruneUnusedLayers(t){const o={};t.forEach(u=>{o[u]=!0});for(const u in this.layerIndexes)o[u]||delete this.layerIndexes[u]}}const ws=(l,t)=>s.emitValidationErrors(l,t&&t.filter(o=>o.identifier!=="source.canvas")),fu=s.pick(at,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),mu=s.pick(at,["setCenter","setZoom","setBearing","setPitch"]),_u={version:8,layers:[],sources:{}},fo={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class yr extends s.Evented{constructor(t,o={}){super(),this.map=t,this.dispatcher=new Ot(Tt(),this),this.imageManager=new mi,this.imageManager.setEventedParent(this),this.glyphManager=new s.GlyphManager(t._requestManager,o.localFontFamily?s.LocalGlyphMode.all:o.localIdeographFontFamily?s.LocalGlyphMode.ideographs:s.LocalGlyphMode.none,o.localFontFamily||o.localIdeographFontFamily),this.lineAtlas=new s.LineAtlas(256,512),this.crossTileSymbolIndex=new ba,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this.zoomHistory=new s.ZoomHistory,this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",s.getReferrer());const u=this;this._rtlTextPluginCallback=yr.registerForPluginStateChange(f=>{u.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:f.pluginStatus,pluginURL:f.pluginURL},(m,g)=>{if(s.triggerPluginCompletionEvent(m),g&&g.every(v=>v))for(const v in u._sourceCaches){const T=u._sourceCaches[v],C=T.getSource().type;C!=="vector"&&C!=="geojson"||T.reload()}})}),this.on("data",f=>{if(f.dataType!=="source"||f.sourceDataType!=="metadata")return;const m=this.getSource(f.sourceId);if(m&&m.vectorLayerIds)for(const g in this._layers){const v=this._layers[g];v.source===m.id&&this._validateLayer(v)}})}loadURL(t,o={}){this.fire(new s.Event("dataloading",{dataType:"style"}));const u=typeof o.validate=="boolean"?o.validate:!s.isMapboxURL(t);t=this.map._requestManager.normalizeStyleURL(t,o.accessToken);const f=this.map._requestManager.transformRequest(t,s.ResourceType.Style);this._request=s.getJSON(f,(m,g)=>{this._request=null,m?this.fire(new s.ErrorEvent(m)):g&&this._load(g,u)})}loadJSON(t,o={}){this.fire(new s.Event("dataloading",{dataType:"style"})),this._request=s.exported.frame(()=>{this._request=null,this._load(t,o.validate!==!1)})}loadEmpty(){this.fire(new s.Event("dataloading",{dataType:"style"})),this._load(_u,!1)}_updateLayerCount(t,o){const u=o?1:-1;t.is3D()&&(this._num3DLayers+=u),t.type==="circle"&&(this._numCircleLayers+=u),t.type==="symbol"&&(this._numSymbolLayers+=u)}_load(t,o){if(o&&ws(this,s.validateStyle(t)))return;this._loaded=!0,this.stylesheet=t,this._updateMapProjection();for(const f in t.sources)this.addSource(f,t.sources[f],{validate:!1});this._changed=!1,t.sprite?this._loadSprite(t.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(t.glyphs);const u=ei(this.stylesheet.layers);this._order=u.map(f=>f.id),this._layers={},this._serializedLayers={};for(let f of u)f=s.createStyleLayer(f),f.setEventedParent(this,{layer:{id:f.id}}),this._layers[f.id]=f,this._serializedLayers[f.id]=f.serialize(),this._updateLayerCount(f,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Jr(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new s.Event("data",{dataType:"style"})),this.fire(new s.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(t){t?this.stylesheet.projection=t:delete this.stylesheet.projection,this.map._explicitProjection||this.map._updateProjection()}_updateMapProjection(){this.map._explicitProjection?this.applyProjectionUpdate():this.map._updateProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_loadSprite(t){this._spriteRequest=function(o,u,f){let m,g,v;const T=s.exported.devicePixelRatio>1?"@2x":"";let C=s.getJSON(u.transformRequest(u.normalizeSpriteURL(o,T,".json"),s.ResourceType.SpriteJSON),(O,V)=>{C=null,v||(v=O,m=V,k())}),S=s.getImage(u.transformRequest(u.normalizeSpriteURL(o,T,".png"),s.ResourceType.SpriteImage),(O,V)=>{S=null,v||(v=O,g=V,k())});function k(){if(v)f(v);else if(m&&g){const O=s.exported.getImageData(g),V={};for(const N in m){const{width:R,height:Q,x:Z,y:Y,sdf:X,pixelRatio:ee,stretchX:H,stretchY:re,content:_e}=m[N],Ae=new s.RGBAImage({width:R,height:Q});s.RGBAImage.copy(O,Ae,{x:Z,y:Y},{x:0,y:0},{width:R,height:Q}),V[N]={data:Ae,pixelRatio:ee,sdf:X,stretchX:H,stretchY:re,content:_e}}f(null,V)}}return{cancel(){C&&(C.cancel(),C=null),S&&(S.cancel(),S=null)}}}(t,this.map._requestManager,(o,u)=>{if(this._spriteRequest=null,o)this.fire(new s.ErrorEvent(o));else if(u)for(const f in u)this.imageManager.addImage(f,u[f]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new s.Event("data",{dataType:"style"}))})}_validateLayer(t){const o=this.getSource(t.source);if(!o)return;const u=t.sourceLayer;u&&(o.type==="geojson"||o.vectorLayerIds&&o.vectorLayerIds.indexOf(u)===-1)&&this.fire(new s.ErrorEvent(new Error(`Source layer "${u}" does not exist on source "${o.id}" as specified by style layer "${t.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const t in this._sourceCaches)if(!this._sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(t){const o=[];for(const u of t){const f=this._layers[u];f.type!=="custom"&&o.push(f.serialize())}return o}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const t in this._sourceCaches)if(this._sourceCaches[t].hasTransition())return!0;for(const t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(t){return!!this.terrain&&fo[t.type]}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(t){if(!this._loaded)return;const o=this._changed;if(this._changed){const f=Object.keys(this._updatedLayers),m=Object.keys(this._removedLayers);(f.length||m.length)&&this._updateWorkerLayers(f,m);for(const g in this._updatedSources){const v=this._updatedSources[g];v==="reload"?this._reloadSource(g):v==="clear"&&this._clearSource(g)}this._updateTilesForChangedImages();for(const g in this._updatedPaintProps)this._layers[g].updateTransitions(t);this.light.updateTransitions(t),this.fog&&this.fog.updateTransitions(t),this._resetUpdates()}const u={};for(const f in this._sourceCaches){const m=this._sourceCaches[f];u[f]=m.used,m.used=!1}for(const f of this._order){const m=this._layers[f];if(m.recalculate(t,this._availableImages),!m.isHidden(t.zoom)){const v=this._getLayerSourceCache(m);v&&(v.used=!0)}const g=this.map.painter;if(g){const v=m.getProgramIds();if(!v)continue;const T=m.getProgramConfiguration(t.zoom);for(const C of v)g.useProgram(C,T)}}for(const f in u){const m=this._sourceCaches[f];u[f]!==m.used&&m.getSource().fire(new s.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:m.getSource().id}))}this.light.recalculate(t),this.terrain&&this.terrain.recalculate(t),this.fog&&this.fog.recalculate(t),this.z=t.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),o&&this.fire(new s.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const o in this._sourceCaches)this._sourceCaches[o].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateWorkerLayers(t,o){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(t),removedIds:o})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(t){if(this._checkLoaded(),ws(this,s.validateStyle(t)))return!1;(t=s.clone$1(t)).layers=ei(t.layers);const o=function(f,m){if(!f)return[{command:at.setStyle,args:[m]}];let g=[];try{if(!J(f.version,m.version))return[{command:at.setStyle,args:[m]}];J(f.center,m.center)||g.push({command:at.setCenter,args:[m.center]}),J(f.zoom,m.zoom)||g.push({command:at.setZoom,args:[m.zoom]}),J(f.bearing,m.bearing)||g.push({command:at.setBearing,args:[m.bearing]}),J(f.pitch,m.pitch)||g.push({command:at.setPitch,args:[m.pitch]}),J(f.sprite,m.sprite)||g.push({command:at.setSprite,args:[m.sprite]}),J(f.glyphs,m.glyphs)||g.push({command:at.setGlyphs,args:[m.glyphs]}),J(f.transition,m.transition)||g.push({command:at.setTransition,args:[m.transition]}),J(f.light,m.light)||g.push({command:at.setLight,args:[m.light]}),J(f.fog,m.fog)||g.push({command:at.setFog,args:[m.fog]}),J(f.projection,m.projection)||g.push({command:at.setProjection,args:[m.projection]});const v={},T=[];(function(k,O,V,N){let R;for(R in O=O||{},k=k||{})k.hasOwnProperty(R)&&(O.hasOwnProperty(R)||ti(R,V,N));for(R in O)O.hasOwnProperty(R)&&(k.hasOwnProperty(R)?J(k[R],O[R])||(k[R].type==="geojson"&&O[R].type==="geojson"&&vn(k,O,R)?V.push({command:at.setGeoJSONSourceData,args:[R,O[R].data]}):uo(R,O,V,N)):Kt(R,O,V))})(f.sources,m.sources,T,v);const C=[];f.layers&&f.layers.forEach(k=>{k.source&&v[k.source]?g.push({command:at.removeLayer,args:[k.id]}):C.push(k)});let S=f.terrain;S&&v[S.source]&&(g.push({command:at.setTerrain,args:[void 0]}),S=void 0),g=g.concat(T),J(S,m.terrain)||g.push({command:at.setTerrain,args:[m.terrain]}),function(k,O,V){O=O||[];const N=(k=k||[]).map(Gt),R=O.map(Gt),Q=k.reduce(Rt,{}),Z=O.reduce(Rt,{}),Y=N.slice(),X=Object.create(null);let ee,H,re,_e,Ae,Se,Ce;for(ee=0,H=0;ee<N.length;ee++)re=N[ee],Z.hasOwnProperty(re)?H++:(V.push({command:at.removeLayer,args:[re]}),Y.splice(Y.indexOf(re,H),1));for(ee=0,H=0;ee<R.length;ee++)re=R[R.length-1-ee],Y[Y.length-1-ee]!==re&&(Q.hasOwnProperty(re)?(V.push({command:at.removeLayer,args:[re]}),Y.splice(Y.lastIndexOf(re,Y.length-H),1)):H++,Se=Y[Y.length-ee],V.push({command:at.addLayer,args:[Z[re],Se]}),Y.splice(Y.length-ee,0,re),X[re]=!0);for(ee=0;ee<R.length;ee++)if(re=R[ee],_e=Q[re],Ae=Z[re],!X[re]&&!J(_e,Ae))if(J(_e.source,Ae.source)&&J(_e["source-layer"],Ae["source-layer"])&&J(_e.type,Ae.type)){for(Ce in He(_e.layout,Ae.layout,V,re,null,at.setLayoutProperty),He(_e.paint,Ae.paint,V,re,null,at.setPaintProperty),J(_e.filter,Ae.filter)||V.push({command:at.setFilter,args:[re,Ae.filter]}),J(_e.minzoom,Ae.minzoom)&&J(_e.maxzoom,Ae.maxzoom)||V.push({command:at.setLayerZoomRange,args:[re,Ae.minzoom,Ae.maxzoom]}),_e)_e.hasOwnProperty(Ce)&&Ce!=="layout"&&Ce!=="paint"&&Ce!=="filter"&&Ce!=="metadata"&&Ce!=="minzoom"&&Ce!=="maxzoom"&&(Ce.indexOf("paint.")===0?He(_e[Ce],Ae[Ce],V,re,Ce.slice(6),at.setPaintProperty):J(_e[Ce],Ae[Ce])||V.push({command:at.setLayerProperty,args:[re,Ce,Ae[Ce]]}));for(Ce in Ae)Ae.hasOwnProperty(Ce)&&!_e.hasOwnProperty(Ce)&&Ce!=="layout"&&Ce!=="paint"&&Ce!=="filter"&&Ce!=="metadata"&&Ce!=="minzoom"&&Ce!=="maxzoom"&&(Ce.indexOf("paint.")===0?He(_e[Ce],Ae[Ce],V,re,Ce.slice(6),at.setPaintProperty):J(_e[Ce],Ae[Ce])||V.push({command:at.setLayerProperty,args:[re,Ce,Ae[Ce]]}))}else V.push({command:at.removeLayer,args:[re]}),Se=Y[Y.lastIndexOf(re)+1],V.push({command:at.addLayer,args:[Ae,Se]})}(C,m.layers,g)}catch(v){console.warn("Unable to compute style diff:",v),g=[{command:at.setStyle,args:[m]}]}return g}(this.serialize(),t).filter(f=>!(f.command in mu));if(o.length===0)return!1;const u=o.filter(f=>!(f.command in fu));if(u.length>0)throw new Error(`Unimplemented: ${u.map(f=>f.command).join(", ")}.`);return o.forEach(f=>{f.command!=="setTransition"&&this[f.command].apply(this,f.args)}),this.stylesheet=t,this._updateMapProjection(),!0}addImage(t,o){return this.getImage(t)?this.fire(new s.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(t,o),this._afterImageUpdated(t),this)}updateImage(t,o){this.imageManager.updateImage(t,o)}getImage(t){return this.imageManager.getImage(t)}removeImage(t){return this.getImage(t)?(this.imageManager.removeImage(t),this._afterImageUpdated(t),this):this.fire(new s.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new s.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(t,o,u={}){if(this._checkLoaded(),this.getSource(t)!==void 0)throw new Error("There is already a source with this ID");if(!o.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(o).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(o.type)>=0&&this._validate(s.validateSource,`sources.${t}`,o,null,u))return;this.map&&this.map._collectResourceTiming&&(o.collectResourceTiming=!0);const f=fe(t,o,this.dispatcher,this);f.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(t),source:f.serialize(),sourceId:t}));const m=g=>{const v=(g?"symbol:":"other:")+t,T=this._sourceCaches[v]=new s.SourceCache(v,f,g);(g?this._symbolSourceCaches:this._otherSourceCaches)[t]=T,T.style=this,T.onAdd(this.map)};m(!1),o.type!=="vector"&&o.type!=="geojson"||m(!0),f.onAdd&&f.onAdd(this.map),this._changed=!0}removeSource(t){this._checkLoaded();const o=this.getSource(t);if(!o)throw new Error("There is no source with this ID");for(const f in this._layers)if(this._layers[f].source===t)return this.fire(new s.ErrorEvent(new Error(`Source "${t}" cannot be removed while layer "${f}" is using it.`)));if(this.terrain&&this.terrain.get().source===t)return this.fire(new s.ErrorEvent(new Error(`Source "${t}" cannot be removed while terrain is using it.`)));const u=this._getSourceCaches(t);for(const f of u)delete this._sourceCaches[f.id],delete this._updatedSources[f.id],f.fire(new s.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:f.getSource().id})),f.setEventedParent(null),f.clearTiles();return delete this._otherSourceCaches[t],delete this._symbolSourceCaches[t],o.setEventedParent(null),o.onRemove&&o.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(t,o){this._checkLoaded(),this.getSource(t).setData(o),this._changed=!0}getSource(t){const o=this._getSourceCache(t);return o&&o.getSource()}addLayer(t,o,u={}){this._checkLoaded();const f=t.id;if(this.getLayer(f))return void this.fire(new s.ErrorEvent(new Error(`Layer with id "${f}" already exists on this map`)));let m;if(t.type==="custom"){if(ws(this,s.validateCustomStyleLayer(t)))return;m=s.createStyleLayer(t)}else{if(typeof t.source=="object"&&(this.addSource(f,t.source),t=s.clone$1(t),t=s.extend(t,{source:f})),this._validate(s.validateLayer,`layers.${f}`,t,{arrayIndex:-1},u))return;m=s.createStyleLayer(t),this._validateLayer(m),m.setEventedParent(this,{layer:{id:f}}),this._serializedLayers[m.id]=m.serialize(),this._updateLayerCount(m,!0)}const g=o?this._order.indexOf(o):this._order.length;if(o&&g===-1)return void this.fire(new s.ErrorEvent(new Error(`Layer with id "${o}" does not exist on this map.`)));this._order.splice(g,0,f),this._layerOrderChanged=!0,this._layers[f]=m;const v=this._getLayerSourceCache(m);if(this._removedLayers[f]&&m.source&&v&&m.type!=="custom"){const T=this._removedLayers[f];delete this._removedLayers[f],T.type!==m.type?this._updatedSources[m.source]="clear":(this._updatedSources[m.source]="reload",v.pause())}this._updateLayer(m),m.onAdd&&m.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(t,o){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new s.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===o)return;const u=this._order.indexOf(t);this._order.splice(u,1);const f=o?this._order.indexOf(o):this._order.length;o&&f===-1?this.fire(new s.ErrorEvent(new Error(`Layer with id "${o}" does not exist on this map.`))):(this._order.splice(f,0,t),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(t){this._checkLoaded();const o=this._layers[t];if(!o)return void this.fire(new s.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be removed.`)));o.setEventedParent(null),this._updateLayerCount(o,!1);const u=this._order.indexOf(t);this._order.splice(u,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=o,delete this._layers[t],delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],o.onRemove&&o.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(t){return this._layers[t]}hasLayer(t){return t in this._layers}hasLayerType(t){for(const o in this._layers)if(this._layers[o].type===t)return!0;return!1}setLayerZoomRange(t,o,u){this._checkLoaded();const f=this.getLayer(t);f?f.minzoom===o&&f.maxzoom===u||(o!=null&&(f.minzoom=o),u!=null&&(f.maxzoom=u),this._updateLayer(f)):this.fire(new s.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(t,o,u={}){this._checkLoaded();const f=this.getLayer(t);if(f){if(!J(f.filter,o))return o==null?(f.filter=void 0,void this._updateLayer(f)):void(this._validate(s.validateFilter,`layers.${f.id}.filter`,o,{layerType:f.type},u)||(f.filter=s.clone$1(o),this._updateLayer(f)))}else this.fire(new s.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be filtered.`)))}getFilter(t){const o=this.getLayer(t);return o&&s.clone$1(o.filter)}setLayoutProperty(t,o,u,f={}){this._checkLoaded();const m=this.getLayer(t);m?J(m.getLayoutProperty(o),u)||(m.setLayoutProperty(o,u,f),this._updateLayer(m)):this.fire(new s.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(t,o){const u=this.getLayer(t);if(u)return u.getLayoutProperty(o);this.fire(new s.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style.`)))}setPaintProperty(t,o,u,f={}){this._checkLoaded();const m=this.getLayer(t);m?J(m.getPaintProperty(o),u)||(m.setPaintProperty(o,u,f)&&this._updateLayer(m),this._changed=!0,this._updatedPaintProps[t]=!0):this.fire(new s.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(t,o){const u=this.getLayer(t);return u&&u.getPaintProperty(o)}setFeatureState(t,o){this._checkLoaded();const u=t.source,f=t.sourceLayer,m=this.getSource(u);if(!m)return void this.fire(new s.ErrorEvent(new Error(`The source '${u}' does not exist in the map's style.`)));const g=m.type;if(g==="geojson"&&f)return void this.fire(new s.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(g==="vector"&&!f)return void this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));t.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided.")));const v=this._getSourceCaches(u);for(const T of v)T.setFeatureState(f,t.id,o)}removeFeatureState(t,o){this._checkLoaded();const u=t.source,f=this.getSource(u);if(!f)return void this.fire(new s.ErrorEvent(new Error(`The source '${u}' does not exist in the map's style.`)));const m=f.type,g=m==="vector"?t.sourceLayer:void 0;if(m==="vector"&&!g)return void this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(o&&typeof t.id!="string"&&typeof t.id!="number")return void this.fire(new s.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const v=this._getSourceCaches(u);for(const T of v)T.removeFeatureState(g,t.id,o)}getFeatureState(t){this._checkLoaded();const o=t.source,u=t.sourceLayer,f=this.getSource(o);if(f){if(f.type!=="vector"||u)return t.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(o)[0].getFeatureState(u,t.id);this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new s.ErrorEvent(new Error(`The source '${o}' does not exist in the map's style.`)))}getTransition(){return s.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const t={};for(const o in this._sourceCaches){const u=this._sourceCaches[o].getSource();t[u.id]||(t[u.id]=u.serialize())}return s.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.stylesheet.terrain,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:t,layers:this._serializeLayers(this._order)},o=>o!==void 0)}_updateLayer(t){this._updatedLayers[t.id]=!0;const o=this._getLayerSourceCache(t);t.source&&!this._updatedSources[t.source]&&o&&o.getSource().type!=="raster"&&(this._updatedSources[t.source]="reload",o.pause()),this._changed=!0,t.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(t){const o=g=>this._layers[g].type==="fill-extrusion",u={},f=[];for(let g=this._order.length-1;g>=0;g--){const v=this._order[g];if(o(v)){u[v]=g;for(const T of t){const C=T[v];if(C)for(const S of C)f.push(S)}}}f.sort((g,v)=>v.intersectionZ-g.intersectionZ);const m=[];for(let g=this._order.length-1;g>=0;g--){const v=this._order[g];if(o(v))for(let T=f.length-1;T>=0;T--){const C=f[T].feature;if(u[C.layer.id]<g)break;m.push(C),f.pop()}else for(const T of t){const C=T[v];if(C)for(const S of C)m.push(S.feature)}}return m}queryRenderedFeatures(t,o,u){o&&o.filter&&this._validate(s.validateFilter,"queryRenderedFeatures.filter",o.filter,null,o);const f={};if(o&&o.layers){if(!Array.isArray(o.layers))return this.fire(new s.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const T of o.layers){const C=this._layers[T];if(!C)return this.fire(new s.ErrorEvent(new Error(`The layer '${T}' does not exist in the map's style and cannot be queried for features.`))),[];f[C.source]=!0}}const m=[];o.availableImages=this._availableImages;const g=o&&o.layers?o.layers.some(T=>{const C=this.getLayer(T);return C&&C.is3D()}):this.has3DLayers(),v=Be.createFromScreenPoints(t,u);for(const T in this._sourceCaches){const C=this._sourceCaches[T].getSource().id;o.layers&&!f[C]||m.push(ye(this._sourceCaches[T],this._layers,this._serializedLayers,v,o,u,g,!!this.map._showQueryGeometry))}return this.placement&&m.push(function(T,C,S,k,O,V,N){const R={},Q=V.queryRenderedSymbols(k),Z=[];for(const Y of Object.keys(Q).map(Number))Z.push(N[Y]);Z.sort(Ke);for(const Y of Z){const X=Y.featureIndex.lookupSymbolFeatures(Q[Y.bucketInstanceId],C,Y.bucketIndex,Y.sourceLayerIndex,O.filter,O.layers,O.availableImages,T);for(const ee in X){const H=R[ee]=R[ee]||[],re=X[ee];re.sort((_e,Ae)=>{const Se=Y.featureSortOrder;if(Se){const Ce=Se.indexOf(_e.featureIndex);return Se.indexOf(Ae.featureIndex)-Ce}return Ae.featureIndex-_e.featureIndex});for(const _e of re)H.push(_e)}}for(const Y in R)R[Y].forEach(X=>{const ee=X.feature,H=S(T[Y]).getFeatureState(ee.layer["source-layer"],ee.id);ee.source=ee.layer.source,ee.layer["source-layer"]&&(ee.sourceLayer=ee.layer["source-layer"]),ee.state=H});return R}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),v.screenGeometry,o,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(m)}querySourceFeatures(t,o){o&&o.filter&&this._validate(s.validateFilter,"querySourceFeatures.filter",o.filter,null,o);const u=this._getSourceCaches(t);let f=[];for(const m of u)f=f.concat(ke(m,o));return f}addSourceType(t,o,u){return yr.getSourceType(t)?u(new Error(`A source type called "${t}" already exists.`)):(yr.setSourceType(t,o),o.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:o.workerSourceURL},u):u(null,null))}getLight(){return this.light.getLight()}setLight(t,o={}){this._checkLoaded();const u=this.light.getLight();let f=!1;for(const g in t)if(!J(t[g],u[g])){f=!0;break}if(!f)return;const m={now:s.exported.now(),transition:s.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,o),this.light.updateTransitions(m)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(t,o=1){if(this._checkLoaded(),!t)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if(o===1){if(typeof t.source=="object"){const u="terrain-dem-src";this.addSource(u,t.source),t=s.clone$1(t),t=s.extend(t,{source:u})}if(this._validate(s.validateTerrain,"terrain",t))return}if(!this.terrain||this.terrain&&o!==this.terrain.drapeRenderMode)this._createTerrain(t,o);else{const u=this.terrain,f=u.get();for(const m in t)if(!J(t[m],f[m])){u.set(t),this.stylesheet.terrain=t;const g={now:s.exported.now(),transition:s.extend({duration:0},this.stylesheet.transition)};u.updateTransitions(g);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(t){const o=this.fog=new hr(t,this.map.transform);this.stylesheet.fog=t;const u={now:s.exported.now(),transition:s.extend({duration:0},this.stylesheet.transition)};o.updateTransitions(u)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const t of this.map._markers)t._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(t){if(this._checkLoaded(),!t)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const o=this.fog,u=o.get();for(const f in t)if(!J(t[f],u[f])){o.set(t),this.stylesheet.fog=t;const m={now:s.exported.now(),transition:s.extend({duration:0},this.stylesheet.transition)};o.updateTransitions(m);break}}else this._createFog(t);this._markersNeedUpdate=!0}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const t=this._order.filter(u=>this.isLayerDraped(this._layers[u])),o=this._order.filter(u=>!this.isLayerDraped(this._layers[u]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...t),this._drapedFirstOrder.push(...o)}_createTerrain(t,o){const u=this.terrain=new ci(t,o);this.stylesheet.terrain=t,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const f={now:s.exported.now(),transition:s.extend({duration:0},this.stylesheet.transition)};u.updateTransitions(f)}_force3DLayerUpdate(){for(const t in this._layers){const o=this._layers[t];o.type==="fill-extrusion"&&this._updateLayer(o)}}_forceSymbolLayerUpdate(){for(const t in this._layers){const o=this._layers[t];o.type==="symbol"&&this._updateLayer(o)}}_validate(t,o,u,f,m={}){return(!m||m.validate!==!1)&&ws(this,t.call(s.validateStyle,s.extend({key:o,style:this.serialize(),value:u,styleSpec:s.spec},f)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),s.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const t in this._layers)this._layers[t].setEventedParent(null);for(const t in this._sourceCaches)this._sourceCaches[t].clearTiles(),this._sourceCaches[t].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(t){const o=this._getSourceCaches(t);for(const u of o)u.clearTiles()}_reloadSource(t){const o=this._getSourceCaches(t);for(const u of o)u.resume(),u.reload()}_updateSources(t){for(const o in this._sourceCaches)this._sourceCaches[o].update(t)}_generateCollisionBoxes(){for(const t in this._sourceCaches){const o=this._sourceCaches[t];o.resume(),o.reload()}}_updatePlacement(t,o,u,f,m=!1){let g=!1,v=!1;const T={};for(const C of this._order){const S=this._layers[C];if(S.type!=="symbol")continue;if(!T[S.source]){const O=this._getLayerSourceCache(S);if(!O)continue;T[S.source]=O.getRenderableIds(!0).map(V=>O.getTileByID(V)).sort((V,N)=>N.tileID.overscaledZ-V.tileID.overscaledZ||(V.tileID.isLessThan(N.tileID)?-1:1))}const k=this.crossTileSymbolIndex.addLayer(S,T[S.source],t.center.lng,t.projection);g=g||k}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),m=m||this._layerOrderChanged||u===0,this._layerOrderChanged&&this.fire(new s.Event("neworder")),(m||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(s.exported.now(),t.zoom))&&(this.pauseablePlacement=new pd(t,this._order,m,o,u,f,this.placement,this.fog&&t.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,T),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(s.exported.now()),v=!0),g&&this.pauseablePlacement.placement.setStale()),v||g)for(const C of this._order){const S=this._layers[C];S.type==="symbol"&&this.placement.updateLayerOpacities(S,T[S.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(s.exported.now())}_releaseSymbolFadeTiles(){for(const t in this._sourceCaches)this._sourceCaches[t].releaseSymbolFadeTiles()}getImages(t,o,u){this.imageManager.getImages(o.icons,u),this._updateTilesForChangedImages();const f=m=>{m&&m.setDependencies(o.tileID.key,o.type,o.icons)};f(this._otherSourceCaches[o.source]),f(this._symbolSourceCaches[o.source])}getGlyphs(t,o,u){this.glyphManager.getGlyphs(o.stacks,u)}getResource(t,o,u){return s.makeRequest(o,u)}_getSourceCache(t){return this._otherSourceCaches[t]}_getLayerSourceCache(t){return t.type==="symbol"?this._symbolSourceCaches[t.source]:this._otherSourceCaches[t.source]}_getSourceCaches(t){const o=[];return this._otherSourceCaches[t]&&o.push(this._otherSourceCaches[t]),this._symbolSourceCaches[t]&&o.push(this._symbolSourceCaches[t]),o}_isSourceCacheLoaded(t){const o=this._getSourceCaches(t);return o.length===0?(this.fire(new s.ErrorEvent(new Error(`There is no source with ID '${t}'`))),!1):o.every(u=>u.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}yr.getSourceType=function(l){return me[l]},yr.setSourceType=function(l,t){me[l]=t},yr.registerForPluginStateChange=s.registerForPluginStateChange;var Ts=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}
#endif`,Es="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}";let mo={},Ln={};mo=yt("",`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {return currentElevation(apos);}
#endif
float unpack_depth(vec4 rgba_depth)
{const vec4 bit_shift=vec4(1.0/(256.0*256.0*256.0),1.0/(256.0*256.0),1.0/256.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;vec4 bounds=vec4(d,vec2(1.0)-d);h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,!0),Ln=yt(`#ifdef FOG
uniform float u_fog_temporal_offset;float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,`#ifdef FOG
uniform mat4 u_fog_matrix;vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,!0);const wa=yt(`
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}
#ifdef TERRAIN
highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(256.0*256.0*256.0,256.0*256.0,256.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/256.0,1.0/256.0,1.0/256.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#endif`,`
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),Cs=Ts;var Ms={background:yt(`uniform vec4 u_color;uniform float u_opacity;void main() {vec4 out_color=u_color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:yt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_mix);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:yt(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;attribute float a_scale;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);
#ifdef PROJECTION_GLOBE_VIEW
vec2 scaled_extrude=extrude*a_scale;vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=scaled_extrude.x*surface_vectors[0]+scaled_extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);vec4 world_center=vec4(pos,1);
#else 
mat3 surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);vec4 world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
#if defined(SCALE_WITH_MAP) && defined(PROJECTION_GLOBE_VIEW)
view_scale*=a_scale;
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);vec4 occlusion_world_center=vec4(circle_center,cantilevered_height,1);vec4 occlusion_projected_center=u_matrix*occlusion_world_center;
#else
vec4 occlusion_world_center=world_center;vec4 occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:yt("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:yt(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;attribute float a_scale;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);
#ifdef PROJECTION_GLOBE_VIEW
extrude*=a_scale;vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
vec3 pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:yt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:yt("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:yt("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:yt("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:yt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:yt(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:yt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=mix(color1,color2,u_fade);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:yt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:yt(`varying vec4 v_color;void main() {vec4 color=v_color;
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 pos=vec3(pos_nx.xy,h);
#else
vec3 pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(pos.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.rgb+=clamp(color.rgb*directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:yt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);out_color=out_color*v_lighting;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 p=vec3(pos_nx.xy,h);
#else
vec3 p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:yt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos);float f=getElevation(v_pos+vec2(epsilon.x,0));float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float h=getElevation(v_pos+vec2(0,epsilon.y));float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:yt(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:yt(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;uniform float u_mix;uniform vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;varying highp vec2 v_uv;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash_from
#pragma mapbox: define lowp vec4 dash_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash_from
#pragma mapbox: initialize lowp vec4 dash_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist_a=texture2D(u_dash_image,v_tex_a).a;float sdfdist_b=texture2D(u_dash_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfwidth=min(dash_from.z*u_scale.y,dash_to.z*u_scale.z);float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/sdfwidth;alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
#ifdef RENDER_LINE_GRADIENT
vec4 out_color=texture2D(u_gradient_image,v_uv);
#else
vec4 out_color=color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#ifdef RENDER_LINE_GRADIENT
attribute vec3 a_packed;
#else
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform mediump vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;varying highp vec2 v_uv;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash_from
#pragma mapbox: define lowp vec4 dash_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash_from
#pragma mapbox: initialize lowp vec4 dash_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_GRADIENT
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];float a_linesofar=a_packed[2];highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);
#endif
#ifdef RENDER_LINE_DASH
float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;float scaleA=dash_from.z==0.0 ? 0.0 : tileZoomRatio/(dash_from.z*fromScale);float scaleB=dash_to.z==0.0 ? 0.0 : tileZoomRatio/(dash_to.z*toScale);float heightA=dash_from.y;float heightB=dash_to.y;v_tex_a=vec2(a_linesofar*scaleA/floorwidth,(-normal.y*heightA+dash_from.x+0.5)/u_texsize.y);v_tex_b=vec2(a_linesofar*scaleB/floorwidth,(-normal.y*heightB+dash_to.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:yt(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:yt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:yt(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchor_z=a_z_tile_anchor.x;vec2 tile_anchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(vec3(a_pos,anchor_z)+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;float globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
vec3 world_pos=vec3(a_pos,anchor_z)+h;float globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point=u_matrix*vec4(a_pos+vec2(1,0),anchor_z,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(vec3(a_projected_pos.xy,anchor_z),mercator_pos,u_zoom_transition);
#else
vec3 proj_pos=vec3(a_projected_pos.xy,anchor_z);
#endif
#ifdef PROJECTED_POS_ON_VIEWPORT
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xy,0.0,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xyz+h,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:yt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchor_z=a_z_tile_anchor.x;vec2 tile_anchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(vec3(a_pos,anchor_z)+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;float globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
vec3 world_pos=vec3(a_pos,anchor_z)+h;float globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point=u_matrix*vec4(a_pos+vec2(1,0),anchor_z,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(vec3(a_projected_pos.xy,anchor_z),mercator_pos,u_zoom_transition);
#else
vec3 proj_pos=vec3(a_projected_pos.xy,anchor_z);
#endif
#ifdef PROJECTED_POS_ON_VIEWPORT
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xy,0.0,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xyz+h,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:yt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchor_z=a_z_tile_anchor.x;vec2 tile_anchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(vec3(a_pos,anchor_z)+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;float globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
vec3 world_pos=vec3(a_pos,anchor_z)+h;float globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),anchor_z,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(vec3(a_projected_pos.xy,anchor_z),mercator_pos,u_zoom_transition);
#else
vec3 proj_pos=vec3(a_projected_pos.xy,anchor_z);
#endif
#ifdef PROJECTED_POS_ON_VIEWPORT
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xy,0.0,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xyz+h,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:yt(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef FOG
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
const float skirtOffset=24575.0;const float wireframeOffset=0.00015;void main() {v_pos0=a_texture_pos/8192.0;float skirt=float(a_pos.x >=skirtOffset);float elevation=elevation(a_texture_pos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=u_skirt_height*u_skirt_height*wireframeOffset;
#endif
vec2 decodedPos=a_pos-vec2(skirt*skirtOffset,0.0);gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
}`),terrainDepth:yt(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying float v_depth;void main() {float elevation=elevation(a_texture_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:yt(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Es),skyboxGradient:yt(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Es),skyboxCapture:yt(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:yt(`uniform sampler2D u_image0;varying vec2 v_pos0;void main() {gl_FragColor=texture2D(u_image0,v_pos0);
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_merc_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 merc_pos=a_merc_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idy=u_grid_matrix[1][2];float S=u_grid_matrix[2][2];vec3 latLng=u_grid_matrix*vec3(a_pos,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=a_pos[0]*S;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;uv=uv*EXTENT;vec4 up_vector=vec4(elevationVector(uv),1.0);float height=elevation(uv);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
vec4 globe=u_globe_matrix*vec4(globe_pos+up_vector.xyz*height,1.0);vec4 mercator=vec4(0.0);if (u_zoom_transition > 0.0) {mercator=vec4(merc_pos,height,1.0);mercator.xy-=u_merc_center;mercator.x=wrap(mercator.x,-0.5,0.5);mercator=u_merc_matrix*mercator;}vec3 position=mix(globe.xyz,mercator.xyz,u_zoom_transition);gl_Position=u_proj_matrix*vec4(position,1.0);}`),globeAtmosphere:yt(`uniform float u_opacity;uniform highp float u_fadeout_range;uniform vec3 u_start_color;uniform vec3 u_end_color;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;varying highp vec3 v_ray_dir;void main() {highp vec3 dir=normalize(v_ray_dir);highp vec3 closest_point=abs(dot(u_globe_pos,dir))*dir;float norm_dist_from_center=length(closest_point-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 1.0)
discard;float t=clamp(1.0-sqrt(norm_dist_from_center-1.0)/u_fadeout_range,0.0,1.0);vec3 color=mix(u_start_color,u_end_color,1.0-t);gl_FragColor=vec4(color*t*u_opacity,u_opacity);}`,"attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;varying highp vec3 v_ray_dir;void main() {v_ray_dir=mix(mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);gl_Position=vec4(a_pos,1.0);}")};function yt(l,t,o){const u=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,f=/uniform (highp |mediump |lowp )?([\w]+) ([\w]+)([\s]*)([\w]*)/g,m=t.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),g=l.match(f),v=t.match(f),T=Ts.match(f);let C=v?v.concat(g):g;o||(mo.staticUniforms&&(C=mo.staticUniforms.concat(C)),Ln.staticUniforms&&(C=Ln.staticUniforms.concat(C))),C&&(C=C.concat(T));const S={};return{fragmentSource:l=l.replace(u,(k,O,V,N,R)=>(S[R]=!0,O==="define"?`
#ifndef HAS_UNIFORM_u_${R}
varying ${V} ${N} ${R};
#else
uniform ${V} ${N} u_${R};
#endif
`:`
#ifdef HAS_UNIFORM_u_${R}
    ${V} ${N} ${R} = u_${R};
#endif
`)),vertexSource:t=t.replace(u,(k,O,V,N,R)=>{const Q=N==="float"?"vec2":"vec4",Z=R.match(/color/)?"color":Q;return S[R]?O==="define"?`
#ifndef HAS_UNIFORM_u_${R}
uniform lowp float u_${R}_t;
attribute ${V} ${Q} a_${R};
varying ${V} ${N} ${R};
#else
uniform ${V} ${N} u_${R};
#endif
`:Z==="vec4"?`
#ifndef HAS_UNIFORM_u_${R}
    ${R} = a_${R};
#else
    ${V} ${N} ${R} = u_${R};
#endif
`:`
#ifndef HAS_UNIFORM_u_${R}
    ${R} = unpack_mix_${Z}(a_${R}, u_${R}_t);
#else
    ${V} ${N} ${R} = u_${R};
#endif
`:O==="define"?`
#ifndef HAS_UNIFORM_u_${R}
uniform lowp float u_${R}_t;
attribute ${V} ${Q} a_${R};
#else
uniform ${V} ${N} u_${R};
#endif
`:Z==="vec4"?`
#ifndef HAS_UNIFORM_u_${R}
    ${V} ${N} ${R} = a_${R};
#else
    ${V} ${N} ${R} = u_${R};
#endif
`:`
#ifndef HAS_UNIFORM_u_${R}
    ${V} ${N} ${R} = unpack_mix_${Z}(a_${R}, u_${R}_t);
#else
    ${V} ${N} ${R} = u_${R};
#endif
`}),staticAttributes:m,staticUniforms:C}}class Ta{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,o,u,f,m,g,v,T){this.context=t;let C=this.boundPaintVertexBuffers.length!==f.length;for(let S=0;!C&&S<f.length;S++)this.boundPaintVertexBuffers[S]!==f[S]&&(C=!0);t.extVertexArrayObject&&this.vao&&this.boundProgram===o&&this.boundLayoutVertexBuffer===u&&!C&&this.boundIndexBuffer===m&&this.boundVertexOffset===g&&this.boundDynamicVertexBuffer===v&&this.boundDynamicVertexBuffer2===T?(t.bindVertexArrayOES.set(this.vao),v&&v.bind(),m&&m.dynamicDraw&&m.bind(),T&&T.bind()):this.freshBind(o,u,f,m,g,v,T)}freshBind(t,o,u,f,m,g,v){let T;const C=t.numAttributes,S=this.context,k=S.gl;if(S.extVertexArrayObject)this.vao&&this.destroy(),this.vao=S.extVertexArrayObject.createVertexArrayOES(),S.bindVertexArrayOES.set(this.vao),T=0,this.boundProgram=t,this.boundLayoutVertexBuffer=o,this.boundPaintVertexBuffers=u,this.boundIndexBuffer=f,this.boundVertexOffset=m,this.boundDynamicVertexBuffer=g,this.boundDynamicVertexBuffer2=v;else{T=S.currentNumAttributes||0;for(let O=C;O<T;O++)k.disableVertexAttribArray(O)}o.enableAttributes(k,t);for(const O of u)O.enableAttributes(k,t);g&&g.enableAttributes(k,t),v&&v.enableAttributes(k,t),o.bind(),o.setVertexAttribPointers(k,t,m);for(const O of u)O.bind(),O.setVertexAttribPointers(k,t,m);g&&(g.bind(),g.setVertexAttribPointers(k,t,m)),f&&f.bind(),v&&(v.bind(),v.setVertexAttribPointers(k,t,m)),S.currentNumAttributes=C}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function gu(l,t){const o=Math.pow(2,t.canonical.z),u=t.canonical.y;return[new s.MercatorCoordinate(0,u/o).toLngLat().lat,new s.MercatorCoordinate(0,(u+1)/o).toLngLat().lat]}function yu(l,t,o,u,f,m,g){const v=l.context,T=v.gl,C=o.fbo;if(!C)return;l.prepareDrawTile();const S=l.useProgram("hillshade");v.activeTexture.set(T.TEXTURE0),T.bindTexture(T.TEXTURE_2D,C.colorAttachment.get());const k=((R,Q,Z,Y)=>{const X=Z.paint.get("hillshade-shadow-color"),ee=Z.paint.get("hillshade-highlight-color"),H=Z.paint.get("hillshade-accent-color");let re=Z.paint.get("hillshade-illumination-direction")*(Math.PI/180);Z.paint.get("hillshade-illumination-anchor")==="viewport"&&(re-=R.transform.angle);const _e=!R.options.moving;return{u_matrix:Y||R.transform.calculateProjMatrix(Q.tileID.toUnwrapped(),_e),u_image:0,u_latrange:gu(0,Q.tileID),u_light:[Z.paint.get("hillshade-exaggeration"),re],u_shadow:X,u_highlight:ee,u_accent:H}})(l,o,u,l.terrain?t.projMatrix:null);l.prepareDrawProgram(v,S,t.toUnwrapped());const{tileBoundsBuffer:O,tileBoundsIndexBuffer:V,tileBoundsSegments:N}=l.getTileBoundsBuffers(o);S.draw(v,T.TRIANGLES,f,m,g,s.CullFaceMode.disabled,k,u.id,O,V,N)}function Ll(l,t,o){if(!t.needsDEMTextureUpload)return;const u=l.context,f=u.gl;u.pixelStoreUnpackPremultiplyAlpha.set(!1),t.demTexture=t.demTexture||l.getTileTexture(o.stride);const m=o.getPixels();t.demTexture?t.demTexture.update(m,{premultiply:!1}):t.demTexture=new s.Texture(u,m,f.RGBA,{premultiply:!1}),t.needsDEMTextureUpload=!1}function Rl(l,t,o,u,f,m){const g=l.context,v=g.gl;if(!t.dem)return;const T=t.dem;if(g.activeTexture.set(v.TEXTURE1),Ll(l,t,T),!t.demTexture)return;t.demTexture.bind(v.NEAREST,v.CLAMP_TO_EDGE);const C=T.dim;g.activeTexture.set(v.TEXTURE0);let S=t.fbo;if(!S){const N=new s.Texture(g,{width:C,height:C,data:null},v.RGBA);N.bind(v.LINEAR,v.CLAMP_TO_EDGE),S=t.fbo=g.createFramebuffer(C,C,!0),S.colorAttachment.set(N.texture)}g.bindFramebuffer.set(S.framebuffer),g.viewport.set([0,0,C,C]);const{tileBoundsBuffer:k,tileBoundsIndexBuffer:O,tileBoundsSegments:V}=l.getMercatorTileBoundsBuffers();l.useProgram("hillshadePrepare").draw(g,v.TRIANGLES,u,f,m,s.CullFaceMode.disabled,((N,R)=>{const Q=R.stride,Z=s.create();return s.ortho(Z,0,s.EXTENT,-s.EXTENT,0,0,1),s.translate(Z,Z,[0,-s.EXTENT,0]),{u_matrix:Z,u_image:1,u_dimension:[Q,Q],u_zoom:N.overscaledZ,u_unpack:R.unpackVector}})(t.tileID,T),o.id,k,O,V),t.needsHillshadePrepare=!1}const Fl=(l,t)=>({u_matrix:new s.UniformMatrix4f(l,t.u_matrix),u_image0:new s.Uniform1i(l,t.u_image0),u_skirt_height:new s.Uniform1f(l,t.u_skirt_height)}),xu=(l,t)=>({u_matrix:l,u_image0:0,u_skirt_height:t}),vu=(l,t,o,u,f,m)=>({u_proj_matrix:Float32Array.from(l),u_globe_matrix:t,u_merc_matrix:o,u_zoom_transition:u,u_merc_center:f,u_image0:0,u_grid_matrix:m?Float32Array.from(m):new Float32Array(9)});function Ea(l,t){return l!=null&&t!=null&&!(!l.hasData()||!t.hasData())&&l.demTexture!=null&&t.demTexture!=null&&l.tileID.key!==t.tileID.key}const Rn=new class{constructor(){this.operations={}}newMorphing(l,t,o,u,f){if(l in this.operations){const m=this.operations[l];m.to.tileID.key!==o.tileID.key&&(m.queued=o)}else this.operations[l]={startTime:u,phase:0,duration:f,from:t,to:o,queued:null}}getMorphValuesForProxy(l){if(!(l in this.operations))return null;const t=this.operations[l];return{from:t.from,to:t.to,phase:t.phase}}update(l){for(const t in this.operations){const o=this.operations[t];for(o.phase=(l-o.startTime)/o.duration;o.phase>=1||!this._validOp(o);)if(!this._nextOp(o,l)){delete this.operations[t];break}}}_nextOp(l,t){return!!l.queued&&(l.from=l.to,l.to=l.queued,l.queued=null,l.phase=0,l.startTime=t,!0)}_validOp(l){return l.from.hasData()&&l.to.hasData()}},Vo={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Ol(l,t){const o=1<<l.z;return!t&&(l.x===0||l.x===o-1)||l.y===0||l.y===o-1}const Ca=l=>({u_matrix:l});function Nl(l,t,o,u,f){if(f>0){const m=s.exported.now(),g=(m-l.timeAdded)/f,v=t?(m-t.timeAdded)/f:-1,T=o.getSource(),C=u.coveringZoomLevel({tileSize:T.tileSize,roundZoom:T.roundZoom}),S=!t||Math.abs(t.tileID.overscaledZ-C)>Math.abs(l.tileID.overscaledZ-C),k=S&&l.refreshedUponExpiration?1:s.clamp(S?g:1-v,0,1);return l.refreshedUponExpiration&&g>=1&&(l.refreshedUponExpiration=!1),t?{opacity:1,mix:1-k}:{opacity:k,mix:0}}return{opacity:1,mix:0}}const _d=2*s.mercatorZfromAltitude(1,0)*s.GLOBE_RADIUS*Math.PI;class Ss extends s.SourceCache{constructor(t){const o={type:"raster-dem",maxzoom:t.transform.maxZoom},u=new Ot(Tt(),null),f=fe("mock-dem",o,u,t.style);super("mock-dem",f,!1),f.setEventedParent(this),this._sourceLoaded=!0}_loadTile(t,o){t.state="loaded",o(null)}}class Is extends s.SourceCache{constructor(t){const o=fe("proxy",{type:"geojson",maxzoom:t.transform.maxZoom},new Ot(Tt(),null),t.style);super("proxy",o,!1),o.setEventedParent(this),this.map=this.getSource().map=t,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(t,o,u){if(t.freezeTileCoverage)return;this.transform=t;const f=t.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((m,g)=>{if(m[g.key]="",!this._tiles[g.key]){const v=new s.Tile(g,this._source.tileSize*g.overscaleFactor(),t.tileZoom);v.state="loaded",this._tiles[g.key]=v}return m},{});for(const m in this._tiles)m in f||(this.freeFBO(m),this._tiles[m].unloadVectorData(),delete this._tiles[m])}freeFBO(t){const o=this.proxyCachedFBO[t];if(o!==void 0){const u=Object.values(o);this.renderCachePool.push(...u),delete this.proxyCachedFBO[t]}}deallocRenderCache(){this.renderCache.forEach(t=>t.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Ul extends s.OverscaledTileID{constructor(t,o,u){super(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y),this.proxyTileKey=o,this.projMatrix=u}}class Mr extends s.Elevation{constructor(t,o){super(),this.painter=t,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[u,f,m]=function(T){const C=new s.StructArrayLayout4i8,S=new s.StructArrayLayout3ui6,k=131;C.reserve(17161),S.reserve(33800);const O=s.EXTENT/128,V=s.EXTENT+O/2,N=V+O;for(let Q=-O;Q<N;Q+=O)for(let Z=-O;Z<N;Z+=O){const Y=Z<0||Z>V||Q<0||Q>V?24575:0,X=s.clamp(Math.round(Z),0,s.EXTENT),ee=s.clamp(Math.round(Q),0,s.EXTENT);C.emplaceBack(X+Y,ee,X,ee)}const R=(Q,Z)=>{const Y=Z*k+Q;S.emplaceBack(Y+1,Y,Y+k),S.emplaceBack(Y+k,Y+k+1,Y+1)};for(let Q=1;Q<129;Q++)for(let Z=1;Z<129;Z++)R(Z,Q);return[0,129].forEach(Q=>{for(let Z=0;Z<130;Z++)R(Z,Q),R(Q,Z)}),[C,S,32768]}(),g=t.context;this.gridBuffer=g.createVertexBuffer(u,s.boundsAttributes.members),this.gridIndexBuffer=g.createIndexBuffer(f),this.gridSegments=s.SegmentVector.simpleSegment(0,0,u.length,f.length),this.gridNoSkirtSegments=s.SegmentVector.simpleSegment(0,0,u.length,m),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Is(o.map),this.orthoMatrix=s.create(),s.ortho(this.orthoMatrix,0,s.EXTENT,0,s.EXTENT,0,1);const v=g.gl;this._overlapStencilMode=new s.StencilMode({func:v.GEQUAL,mask:255},0,255,v.KEEP,v.KEEP,v.REPLACE),this._previousZoom=t.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=o,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Ss(o.map)}set style(t){t.on("data",this._onStyleDataEvent.bind(this)),t.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=t,this._checkRenderCacheEfficiency()}update(t,o,u){if(t&&t.terrain){this._style!==t&&(this.style=t),this.enabled=!0;const f=t.terrain.properties;this.sourceCache=t.terrain.drapeRenderMode===0?this._mockSourceCache:t._getSourceCache(f.get("source")),this._exaggeration=f.get("exaggeration");const m=()=>{this.sourceCache.used&&s.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const g=this.getScaledDemTileSize();this.sourceCache.update(o,g,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,m(),this._initializing=!0),m(),o.updateElevation(!u),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(o),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(t){this._findCoveringTileCache[t]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const t=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||t.efficiency!==100&&s.warnOnce(`Terrain render cache efficiency is not optimal (${t.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${t.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(t){t.coord&&t.dataType==="source"?this._clearRenderCacheForTile(t.sourceCacheId,t.coord):t.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const t in this._style._sourceCaches)this._style._sourceCaches[t].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(t=>t.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const t=2*this.proxySourceCache.getSource().tileSize;return[t,t]}set useVertexMorphing(t){this._useVertexMorphing=t}updateTileBinding(t){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const o=this.proxySourceCache,u=this.painter.transform;this._initializing&&(this._initializing=u._centerAltitude===0&&this.getAtPointOrZero(s.MercatorCoordinate.fromLngLat(u.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const f=this.proxyCoords=o.getIds().map(T=>{const C=o.getTileByID(T).tileID;return C.projMatrix=u.calculateProjMatrix(C.toUnwrapped()),C});(function(T,C){const S=C.transform.pointCoordinate(C.transform.getCameraPoint()),k=new s.pointGeometry(S.x,S.y);T.sort((O,V)=>{if(V.overscaledZ-O.overscaledZ)return V.overscaledZ-O.overscaledZ;const N=new s.pointGeometry(O.canonical.x+(1<<O.canonical.z)*O.wrap,O.canonical.y),R=new s.pointGeometry(V.canonical.x+(1<<V.canonical.z)*V.wrap,V.canonical.y),Q=k.mult(1<<O.canonical.z);return Q.x-=.5,Q.y-=.5,Q.distSqr(N)-Q.distSqr(R)})})(f,this.painter),this._previousZoom=u.zoom;const m=this.proxyToSource||{};this.proxyToSource={},f.forEach(T=>{this.proxyToSource[T.key]={}}),this.terrainTileForTile={};const g=this._style._sourceCaches;for(const T in g){const C=g[T];if(!C.used||(C!==this.sourceCache&&this.resetTileLookupCache(C.id),this._setupProxiedCoordsForOrtho(C,t[T],m),C.usedForTerrain))continue;const S=t[T];C.getSource().reparseOverscaled&&this._assignTerrainTiles(S)}this.proxiedCoords[o.id]=f.map(T=>new Ul(T,T.key,this.orthoMatrix)),this._assignTerrainTiles(f),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(m),this.renderingToTexture=!1,this._updateTimestamp=s.exported.now();const v={};this._visibleDemTiles=[];for(const T of this.proxyCoords){const C=this.terrainTileForTile[T.key];if(!C)continue;const S=C.tileID.key;S in v||(this._visibleDemTiles.push(C),v[S]=S)}}_assignTerrainTiles(t){this._initializing||t.forEach(o=>{if(this.terrainTileForTile[o.key])return;const u=this._findTileCoveringTileID(o,this.sourceCache);u&&(this.terrainTileForTile[o.key]=u)})}_prepareDEMTextures(){const t=this.painter.context,o=t.gl;for(const u in this.terrainTileForTile){const f=this.terrainTileForTile[u],m=f.dem;!m||f.demTexture&&!f.needsDEMTextureUpload||(t.activeTexture.set(o.TEXTURE1),Ll(this.painter,f,m))}}_prepareDemTileUniforms(t,o,u,f){if(!o||o.demTexture==null)return!1;const m=t.tileID.canonical,g=Math.pow(2,o.tileID.canonical.z-m.z),v=f||"";return u[`u_dem_tl${v}`]=[m.x*g%1,m.y*g%1],u[`u_dem_scale${v}`]=g,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const t=this.painter.context,o=t.gl;if(!this._emptyDepthBufferTexture){const u=new s.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new s.Texture(t,u,o.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let t=0;const o=this._visibleDemTiles.reduce((u,f)=>{if(!f.dem)return u;const m=f.dem.tree.minimums[0];return m>0&&t++,u+m},0);return t?o/t:0}_updateEmptyDEMTexture(){const t=this.painter.context,o=t.gl;t.activeTexture.set(o.TEXTURE2);const u=this._getLoadedAreaMinimum(),f=new s.RGBAImage({width:1,height:1},new Uint8Array(s.DEMData.pack(u,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let m=this._emptyDEMTexture;return m?m.update(f,{premultiply:!1}):m=this._emptyDEMTexture=new s.Texture(t,f,o.RGBA,{premultiply:!1}),m}setupElevationDraw(t,o,u){const f=this.painter.context,m=f.gl,g=(v=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:s.DEMData.getUnpackVector(v),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0,u_tile_tl_up:[0,0,1],u_tile_tr_up:[0,0,1],u_tile_br_up:[0,0,1],u_tile_bl_up:[0,0,1],u_tile_up_scale:1});var v;g.u_dem_size=this.sourceCache.getSource().tileSize,g.u_exaggeration=this.exaggeration();const T=this.painter.transform,C=T.projection,S=t.tileID.canonical;g.u_tile_tl_up=C.upVector(S,0,0),g.u_tile_tr_up=C.upVector(S,s.EXTENT,0),g.u_tile_br_up=C.upVector(S,s.EXTENT,s.EXTENT),g.u_tile_bl_up=C.upVector(S,0,s.EXTENT),g.u_tile_up_scale=u&&u.useDenormalizedUpVectorScale?_d:C.upVectorScale(S,T.center.lat,T.worldSize).metersToTile;let k=null,O=null,V=1;if(u&&u.morphing&&this._useVertexMorphing){const N=u.morphing.srcDemTile,R=u.morphing.dstDemTile;V=u.morphing.phase,N&&R&&(this._prepareDemTileUniforms(t,N,g,"_prev")&&(O=N),this._prepareDemTileUniforms(t,R,g)&&(k=R))}if(O&&k?(f.activeTexture.set(m.TEXTURE2),k.demTexture.bind(m.NEAREST,m.CLAMP_TO_EDGE,m.NEAREST),f.activeTexture.set(m.TEXTURE4),O.demTexture.bind(m.NEAREST,m.CLAMP_TO_EDGE,m.NEAREST),g.u_dem_lerp=V):(k=this.terrainTileForTile[t.tileID.key],f.activeTexture.set(m.TEXTURE2),(this._prepareDemTileUniforms(t,k,g)?k.demTexture:this.emptyDEMTexture).bind(m.NEAREST,m.CLAMP_TO_EDGE)),f.activeTexture.set(m.TEXTURE3),u&&u.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(m.NEAREST,m.CLAMP_TO_EDGE),this._depthFBO&&(g.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(m.NEAREST,m.CLAMP_TO_EDGE),g.u_depth_size_inv=[1,1]),u&&u.useMeterToDem&&k){const N=(1<<k.tileID.canonical.z)*s.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;g.u_meter_to_dem=N}u&&u.labelPlaneMatrixInv&&(g.u_label_plane_matrix_inv=u.labelPlaneMatrixInv),o.setTerrainUniformValues(f,g)}renderToBackBuffer(t){const o=this.painter,u=this.painter.context;t.length!==0&&(u.bindFramebuffer.set(null),u.viewport.set([0,0,o.width,o.height]),this.renderingToTexture=!1,function(f,m,g,v,T){if(f.transform.projection.name==="globe")(function(C,S,k,O,V){const N=C.context,R=N.gl;let Q,Z;const Y=C.options.showTerrainWireframe?2:0,X=(Ce,Ge)=>{if(Z===Ce)return;const ge=[Vo[Ce],"PROJECTION_GLOBE_VIEW"];Ge&&ge.push(Vo[Y]),Q=C.useProgram("globeRaster",null,ge),Z=Ce},ee=C.colorModeForRenderPass(),H=new s.DepthMode(R.LEQUAL,s.DepthMode.ReadWrite,C.depthRangeFor3D);Rn.update(V);const re=C.transform,_e=s.calculateGlobeMercatorMatrix(re),Ae=[s.mercatorXfromLng(re.center.lng),s.mercatorYfromLat(re.center.lat)],Se=C.globeSharedBuffers;if((Y?[!1,!0]:[!1]).forEach(Ce=>{Z=-1;const Ge=Ce?R.LINES:R.TRIANGLES;for(const ge of O){const Ue=k.getTile(ge),Oe=s.StencilMode.disabled,st=S.prevTerrainTileForTile[ge.key],be=S.terrainTileForTile[ge.key];Ea(st,be)&&Rn.newMorphing(ge.key,st,be,V,250),N.activeTexture.set(R.TEXTURE0),Ue.texture.bind(R.LINEAR,R.CLAMP_TO_EDGE);const pt=Rn.getMorphValuesForProxy(ge.key),gt=pt?1:0,rt={useDenormalizedUpVectorScale:!0};pt&&s.extend$1(rt,{morphing:{srcDemTile:pt.from,dstDemTile:pt.to,phase:s.easeCubicInOut(pt.phase)}});const nt=Float32Array.from(re.globeMatrix),At=s.globeTileLatLngCorners(ge.canonical),Pt=s.getGridMatrix(ge.canonical,At),ct=vu(re.projMatrix,nt,_e,s.globeToMercatorTransition(re.zoom),Ae,Pt);if(X(gt,Ce),S.setupElevationDraw(Ue,Q,rt),C.prepareDrawProgram(N,Q,ge.toUnwrapped()),Se){const[Ct,Ht,Mi]=Ce?Se.getWirefameBuffers(C.context):Se.getGridBuffers();Q.draw(N,Ge,H,Oe,ee,s.CullFaceMode.backCCW,ct,"globe_raster",Ct,Ht,Mi)}}}),Se){Q=C.useProgram("globeRaster",null,["GLOBE_POLES","PROJECTION_GLOBE_VIEW"]);for(const Ce of O){const{x:Ge,y:ge,z:Ue}=Ce.canonical,Oe=ge===0,st=ge===(1<<Ue)-1,[be,pt,gt,rt]=Se.getPoleBuffers(Ue);if(rt&&(Oe||st)){const nt=k.getTile(Ce);N.activeTexture.set(R.TEXTURE0),nt.texture.bind(R.LINEAR,R.CLAMP_TO_EDGE);let At=s.globePoleMatrixForTile(Ue,Ge,re);const Pt=(ct,Ct)=>ct.draw(N,R.TRIANGLES,H,s.StencilMode.disabled,ee,s.CullFaceMode.disabled,vu(re.projMatrix,At,At,0,Ae),"globe_pole_raster",Ct,gt,rt);S.setupElevationDraw(nt,Q,{}),C.prepareDrawProgram(N,Q,Ce.toUnwrapped()),Oe&&Pt(Q,be),st&&(At=s.scale(s.create(),At,[1,-1,1]),Pt(Q,pt))}}}})(f,m,g,v,T);else{const C=f.context,S=C.gl;let k,O;const V=f.options.showTerrainWireframe?2:0,N=(X,ee)=>{if(O===X)return;const H=[Vo[X]];ee&&H.push(Vo[V]),k=f.useProgram("terrainRaster",null,H),O=X},R=f.colorModeForRenderPass(),Q=new s.DepthMode(S.LEQUAL,s.DepthMode.ReadWrite,f.depthRangeFor3D);Rn.update(T);const Z=f.transform,Y=6*Math.pow(1.5,22-Z.zoom)*m.exaggeration();(V?[!1,!0]:[!1]).forEach(X=>{O=-1;const ee=X?S.LINES:S.TRIANGLES,[H,re]=X?m.getWirefameBuffer():[m.gridIndexBuffer,m.gridSegments];for(const _e of v){const Ae=g.getTile(_e),Se=s.StencilMode.disabled,Ce=m.prevTerrainTileForTile[_e.key],Ge=m.terrainTileForTile[_e.key];Ea(Ce,Ge)&&Rn.newMorphing(_e.key,Ce,Ge,T,250),C.activeTexture.set(S.TEXTURE0),Ae.texture.bind(S.LINEAR,S.CLAMP_TO_EDGE,S.LINEAR_MIPMAP_NEAREST);const ge=Rn.getMorphValuesForProxy(_e.key),Ue=ge?1:0;let Oe;ge&&(Oe={morphing:{srcDemTile:ge.from,dstDemTile:ge.to,phase:s.easeCubicInOut(ge.phase)}});const st=xu(_e.projMatrix,Ol(_e.canonical,Z.renderWorldCopies)?Y/10:Y);N(Ue,X),m.setupElevationDraw(Ae,k,Oe),f.prepareDrawProgram(C,k,_e.toUnwrapped()),k.draw(C,ee,Q,Se,R,s.CullFaceMode.backCCW,st,"terrain_raster",m.gridBuffer,H,re)}})}}(o,this,this.proxySourceCache,t,this._updateTimestamp),this.renderingToTexture=!0,t.splice(0,t.length))}renderBatch(t){if(this._drapedRenderBatches.length===0)return t+1;this.renderingToTexture=!0;const o=this.painter,u=this.painter.context,f=this.proxySourceCache,m=this.proxiedCoords[f.id],g=this._drapedRenderBatches.shift(),v=[],T=o.style.order;let C=0;for(const S of m){const k=f.getTileByID(S.proxyTileKey),O=f.proxyCachedFBO[S.key]?f.proxyCachedFBO[S.key][t]:void 0,V=O!==void 0?f.renderCache[O]:this.pool[C++],N=O!==void 0;if(k.texture=V.tex,N&&!V.dirty){v.push(k.tileID);continue}let R;u.bindFramebuffer.set(V.fb.framebuffer),this.renderedToTile=!1,V.dirty&&(u.clear({color:s.Color.transparent,stencil:0}),V.dirty=!1);for(let Q=g.start;Q<=g.end;++Q){const Z=o.style._layers[T[Q]];if(Z.isHidden(o.transform.zoom))continue;const Y=o.style._getLayerSourceCache(Z),X=Y?this.proxyToSource[S.key][Y.id]:[S];if(!X)continue;const ee=X;u.viewport.set([0,0,V.fb.width,V.fb.height]),R!==(Y?Y.id:null)&&(this._setupStencil(V,X,Z,Y),R=Y?Y.id:null),o.renderLayer(o,Y,Z,ee)}this.renderedToTile?(V.dirty=!0,v.push(k.tileID)):N||--C,C===5&&(C=0,this.renderToBackBuffer(v))}return this.renderToBackBuffer(v),this.renderingToTexture=!1,u.bindFramebuffer.set(null),u.viewport.set([0,0,o.width,o.height]),g.end+1}postRender(){}renderCacheEfficiency(t){const o=t.order.length;if(o===0)return{efficiency:100};let u,f=0,m=0,g=!1;for(let v=0;v<o;++v){const T=t._layers[t.order[v]];this._style.isLayerDraped(T)?(g&&++f,++m):g||(g=!0,u=T.id)}return m===0?{efficiency:100}:{efficiency:100*(1-f/m),firstUndrapedLayer:u}}getMinElevationBelowMSL(){let t=0;return this._visibleDemTiles.filter(o=>o.dem).forEach(o=>{t=Math.min(t,o.dem.tree.minimums[0])}),t===0?t:(t-30)*this._exaggeration}raycast(t,o,u){if(!this._visibleDemTiles)return null;const f=this._visibleDemTiles.filter(m=>m.dem).map(m=>{const g=m.tileID,v=Math.pow(2,g.overscaledZ),{x:T,y:C}=g.canonical,S=T/v,k=(T+1)/v,O=C/v,V=(C+1)/v;return{minx:S,miny:O,maxx:k,maxy:V,t:m.dem.tree.raycastRoot(S,O,k,V,t,o,u),tile:m}});f.sort((m,g)=>(m.t!==null?m.t:Number.MAX_VALUE)-(g.t!==null?g.t:Number.MAX_VALUE));for(const m of f){if(m.t==null)return null;const g=m.tile.dem.tree.raycast(m.minx,m.miny,m.maxx,m.maxy,t,o,u);if(g!=null)return g}return null}_createFBO(){const t=this.painter.context,o=t.gl,u=this.drapeBufferSize;t.activeTexture.set(o.TEXTURE0);const f=new s.Texture(t,{width:u[0],height:u[1],data:null},o.RGBA);f.bind(o.LINEAR,o.CLAMP_TO_EDGE);const m=t.createFramebuffer(u[0],u[1],!1);return m.colorAttachment.set(f.texture),m.depthAttachment=new Lo(t,m.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=t.createRenderbuffer(t.gl.DEPTH_STENCIL,u[0],u[1]),this._stencilRef=0,m.depthAttachment.set(this._sharedDepthStencil),t.clear({stencil:0})):m.depthAttachment.set(this._sharedDepthStencil),t.extTextureFilterAnisotropic&&!t.extTextureFilterAnisotropicForceOff&&o.texParameterf(o.TEXTURE_2D,t.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,t.extTextureFilterAnisotropicMax),{fb:m,tex:f,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const t in this._style._sourceCaches)if(this._style._sourceCaches[t].hasTransition())return!0;return this._style.order.some(t=>{const o=this._style._layers[t],u=o.isHidden(this.painter.transform.zoom),f=o.getCrossfadeParameters(),m=!!f&&f.t!==1,g=o.hasTransition();return o.type!=="custom"&&!u&&(m||g)})}_clearRasterFadeFromRenderCache(){let t=!1;for(const o in this._style._sourceCaches)if(this._style._sourceCaches[o]._source instanceof L){t=!0;break}if(t)for(let o=0;o<this._style.order.length;++o){const u=this._style._layers[this._style.order[o]],f=u.isHidden(this.painter.transform.zoom),m=this._style._getLayerSourceCache(u);if(u.type!=="raster"||f||!m)continue;const g=u.paint.get("raster-fade-duration");for(const v of this.proxyCoords){const T=this.proxyToSource[v.key][m.id];if(T)for(const C of T){const S=Nl(m.getTile(C),m.findLoadedParent(C,0),m,this.painter.transform,g);(S.opacity!==1||S.mix!==0)&&this._clearRenderCacheForTile(m.id,C)}}}}_setupDrapedRenderBatches(){const t=this._style.order,o=t.length;if(o===0)return;const u=[];let f,m=0,g=this._style._layers[t[m]];for(;!this._style.isLayerDraped(g)&&g.isHidden(this.painter.transform.zoom)&&++m<o;)g=this._style._layers[t[m]];for(;m<o;++m){const v=this._style._layers[t[m]];v.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(v)?f===void 0&&(f=m):f!==void 0&&(u.push({start:f,end:m-1}),f=void 0))}f!==void 0&&u.push({start:f,end:m-1}),this._drapedRenderBatches=u}_setupRenderCache(t){const o=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,o.renderCache.length>o.renderCachePool.length){const g=Object.values(o.proxyCachedFBO);o.proxyCachedFBO={};for(let v=0;v<g.length;++v){const T=Object.values(g[v]);o.renderCachePool.push(...T)}}return}this._clearRasterFadeFromRenderCache();const u=this.proxyCoords,f=this._tilesDirty;for(let g=u.length-1;g>=0;g--){const v=u[g];if(o.getTileByID(v.key),o.proxyCachedFBO[v.key]!==void 0){const T=t[v.key],C=this.proxyToSource[v.key];let S=0;for(const k in C){const O=C[k],V=T[k];if(!V||V.length!==O.length||O.some((N,R)=>N!==V[R]||f[k]&&f[k].hasOwnProperty(N.key))){S=-1;break}++S}for(const k in o.proxyCachedFBO[v.key])o.renderCache[o.proxyCachedFBO[v.key][k]].dirty=S<0||S!==Object.values(T).length}}const m=[...this._drapedRenderBatches];m.sort((g,v)=>v.end-v.start-(g.end-g.start));for(const g of m)for(const v of u){if(o.proxyCachedFBO[v.key])continue;let T=o.renderCachePool.pop();T===void 0&&o.renderCache.length<50&&(T=o.renderCache.length,o.renderCache.push(this._createFBO())),T!==void 0&&(o.proxyCachedFBO[v.key]={},o.proxyCachedFBO[v.key][g.start]=T,o.renderCache[T].dirty=!0)}this._tilesDirty={}}_setupStencil(t,o,u,f){if(!f||!this._sourceTilesOverlap[f.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const m=this.painter.context,g=m.gl;if(o.length<=1)return void(this._overlapStencilType=!1);let v;if(u.isTileClipped())v=o.length,this._overlapStencilMode.test={func:g.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(o[0].overscaledZ>o[o.length-1].overscaledZ))return void(this._overlapStencilType=!1);v=1,this._overlapStencilMode.test={func:g.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+v>255&&(m.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=v,this._overlapStencilMode.ref=this._stencilRef,u.isTileClipped()&&this._renderTileClippingMasks(o,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(t){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs.get(t.key)||0),this._overlapStencilMode):s.StencilMode.disabled}_renderTileClippingMasks(t,o){const u=this.painter,f=this.painter.context,m=f.gl;u._tileClippingMaskIDs.clear(),f.setColorMode(s.ColorMode.disabled),f.setDepthMode(s.DepthMode.disabled);const g=u.useProgram("clippingMask");for(const v of t){const T=--o;u._tileClippingMaskIDs.set(v.key,T),g.draw(f,m.TRIANGLES,s.DepthMode.disabled,new s.StencilMode({func:m.ALWAYS,mask:0},T,255,m.KEEP,m.KEEP,m.REPLACE),s.ColorMode.disabled,s.CullFaceMode.disabled,Ca(v.projMatrix),"$clipping",u.tileExtentBuffer,u.quadTriangleIndexBuffer,u.tileExtentSegments)}}pointCoordinate(t){const o=this.painter.transform;if(t.x<0||t.x>o.width||t.y<0||t.y>o.height)return null;const u=[t.x,t.y,1,1];s.transformMat4$1(u,u,o.pixelMatrixInverse),s.scale$1(u,u,1/u[3]),u[0]/=o.worldSize,u[1]/=o.worldSize;const f=o._camera.position,m=s.mercatorZfromAltitude(1,o.center.lat),g=[f[0],f[1],f[2]/m,0],v=s.subtract([],u.slice(0,3),g);s.normalize(v,v);const T=this.raycast(g,v,this._exaggeration);return T!==null&&T?(s.scaleAndAdd(g,g,v,T),g[3]=g[2],g[2]*=m,g):null}drawDepth(){const t=this.painter,o=t.context,u=this.proxySourceCache,f=Math.ceil(t.width),m=Math.ceil(t.height);if(!this._depthFBO||this._depthFBO.width===f&&this._depthFBO.height===m||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const g=o.gl,v=o.createFramebuffer(f,m,!0);o.activeTexture.set(g.TEXTURE0);const T=new s.Texture(o,{width:f,height:m,data:null},g.RGBA);T.bind(g.NEAREST,g.CLAMP_TO_EDGE),v.colorAttachment.set(T.texture);const C=o.createRenderbuffer(o.gl.DEPTH_COMPONENT16,f,m);v.depthAttachment.set(C),this._depthFBO=v,this._depthTexture=T}o.bindFramebuffer.set(this._depthFBO.framebuffer),o.viewport.set([0,0,f,m]),function(g,v,T,C){if(g.transform.projection.name==="globe")return;const S=g.context,k=S.gl;S.clear({depth:1});const O=g.useProgram("terrainDepth"),V=new s.DepthMode(k.LESS,s.DepthMode.ReadWrite,g.depthRangeFor3D);for(const N of C){const R=T.getTile(N),Q=xu(N.projMatrix,0);v.setupElevationDraw(R,O),O.draw(S,k.TRIANGLES,V,s.StencilMode.disabled,s.ColorMode.unblended,s.CullFaceMode.backCCW,Q,"terrain_depth",v.gridBuffer,v.gridIndexBuffer,v.gridNoSkirtSegments)}}(t,this,u,this.proxyCoords)}_setupProxiedCoordsForOrtho(t,o,u){if(t.getSource()instanceof ne)return this._setupProxiedCoordsForImageSource(t,o,u);this._findCoveringTileCache[t.id]=this._findCoveringTileCache[t.id]||{};const f=this.proxiedCoords[t.id]=[],m=this.proxyCoords;for(let v=0;v<m.length;v++){const T=m[v],C=this._findTileCoveringTileID(T,t);if(C){const S=this._createProxiedId(T,C,u[T.key]&&u[T.key][t.id]);f.push(S),this.proxyToSource[T.key][t.id]=[S]}}let g=!1;for(let v=0;v<o.length;v++){const T=t.getTile(o[v]);if(!T||!T.hasData())continue;const C=this._findTileCoveringTileID(T.tileID,this.proxySourceCache);if(C&&C.tileID.canonical.z!==T.tileID.canonical.z){const S=this.proxyToSource[C.tileID.key][t.id],k=this._createProxiedId(C.tileID,T,u[C.tileID.key]&&u[C.tileID.key][t.id]);S?S.splice(S.length-1,0,k):this.proxyToSource[C.tileID.key][t.id]=[k],f.push(k),g=!0}}this._sourceTilesOverlap[t.id]=g}_setupProxiedCoordsForImageSource(t,o,u){if(!t.getSource().loaded())return;const f=this.proxiedCoords[t.id]=[],m=this.proxyCoords,g=t.getSource(),v=new s.pointGeometry(g.tileID.x,g.tileID.y)._div(1<<g.tileID.z),T=g.coordinates.map(s.MercatorCoordinate.fromLngLat).reduce((S,k)=>(S.min.x=Math.min(S.min.x,k.x-v.x),S.min.y=Math.min(S.min.y,k.y-v.y),S.max.x=Math.max(S.max.x,k.x-v.x),S.max.y=Math.max(S.max.y,k.y-v.y),S),{min:new s.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new s.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),C=(S,k)=>{const O=S.wrap+S.canonical.x/(1<<S.canonical.z),V=S.canonical.y/(1<<S.canonical.z),N=s.EXTENT/(1<<S.canonical.z),R=k.wrap+k.canonical.x/(1<<k.canonical.z),Q=k.canonical.y/(1<<k.canonical.z);return O+N<R+T.min.x||O>R+T.max.x||V+N<Q+T.min.y||V>Q+T.max.y};for(let S=0;S<m.length;S++){const k=m[S];for(let O=0;O<o.length;O++){const V=t.getTile(o[O]);if(!V||!V.hasData()||C(k,V.tileID))continue;const N=this._createProxiedId(k,V,u[k.key]&&u[k.key][t.id]),R=this.proxyToSource[k.key][t.id];R?R.push(N):this.proxyToSource[k.key][t.id]=[N],f.push(N)}}}_createProxiedId(t,o,u){let f=this.orthoMatrix;if(u){const m=u.find(g=>g.key===o.tileID.key);if(m)return m}if(o.tileID.key!==t.key){const m=t.canonical.z-o.tileID.canonical.z;let g,v,T;f=s.create();const C=o.tileID.wrap-t.wrap<<t.overscaledZ;m>0?(g=s.EXTENT>>m,v=g*((o.tileID.canonical.x<<m)-t.canonical.x+C),T=g*((o.tileID.canonical.y<<m)-t.canonical.y)):(g=s.EXTENT<<-m,v=s.EXTENT*(o.tileID.canonical.x-(t.canonical.x+C<<-m)),T=s.EXTENT*(o.tileID.canonical.y-(t.canonical.y<<-m))),s.ortho(f,0,g,0,g,0,1),s.translate(f,f,[v,T,0])}return new Ul(o.tileID,t.key,f)}_findTileCoveringTileID(t,o){let u=o.getTile(t);if(u&&u.hasData())return u;const f=this._findCoveringTileCache[o.id],m=f[t.key];if(u=m?o.getTileByID(m):null,u&&u.hasData()||m===null)return u;let g=u?u.tileID:t,v=g.overscaledZ;const T=o.getSource().minzoom,C=[];if(!m){const k=o.getSource().maxzoom;if(t.canonical.z>=k){const O=t.canonical.z-k;o.getSource().reparseOverscaled?(v=Math.max(t.canonical.z+2,o.transform.tileZoom),g=new s.OverscaledTileID(v,t.wrap,k,t.canonical.x>>O,t.canonical.y>>O)):O!==0&&(v=k,g=new s.OverscaledTileID(v,t.wrap,k,t.canonical.x>>O,t.canonical.y>>O))}g.key!==t.key&&(C.push(g.key),u=o.getTile(g))}const S=k=>{C.forEach(O=>{f[O]=k}),C.length=0};for(v-=1;v>=T&&(!u||!u.hasData());v--){u&&S(u.tileID.key);const k=g.calculateScaledKey(v);if(u=o.getTileByID(k),u&&u.hasData())break;const O=f[k];if(O===null)break;O===void 0?C.push(k):u=o.getTileByID(O)}return S(u?u.tileID.key:null),u&&u.hasData()?u:null}findDEMTileFor(t){return this.enabled?this._findTileCoveringTileID(t,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(t,o){let u=this._tilesDirty[t];u||(u=this._tilesDirty[t]={}),u[o.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const t=function(o){let u=0;const f=new s.StructArrayLayout2ui4,m=131;for(let g=1;g<129;g++){for(let v=1;v<129;v++)u=g*m+v,f.emplaceBack(u,u+1),f.emplaceBack(u,u+m),f.emplaceBack(u+1,u+m),g===128&&f.emplaceBack(u+m,u+m+1);f.emplaceBack(u+1,u+1+m)}return f}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(t),this.wireframeSegments=s.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,t.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}function Ma(l){const t=[];for(let o=0;o<l.length;o++){if(l[o]===null)continue;const u=l[o].split(" ");t.push(u.pop())}return t}class zs{static cacheKey(t,o,u){let f=`${t}${u?u.cacheKey:""}`;for(const m of o)f+=`/${m}`;return f}constructor(t,o,u,f,m,g){const v=t.gl;this.program=v.createProgram();const T=Ma(u.staticAttributes),C=f?f.getBinderAttributes():[],S=T.concat(C),k=u.staticUniforms?Ma(u.staticUniforms):[],O=f?f.getBinderUniforms():[],V=k.concat(O),N=[];for(const H of V)N.indexOf(H)<0&&N.push(H);let R=f?f.defines():[];R=R.concat(g.map(H=>`#define ${H}`));const Q=R.concat(`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,Cs,wa.fragmentSource,Ln.fragmentSource,u.fragmentSource).join(`
`),Z=R.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,Cs,wa.vertexSource,Ln.vertexSource,mo.vertexSource,u.vertexSource).join(`
`),Y=v.createShader(v.FRAGMENT_SHADER);if(v.isContextLost())return void(this.failedToCreate=!0);v.shaderSource(Y,Q),v.compileShader(Y),v.attachShader(this.program,Y);const X=v.createShader(v.VERTEX_SHADER);if(v.isContextLost())return void(this.failedToCreate=!0);v.shaderSource(X,Z),v.compileShader(X),v.attachShader(this.program,X),this.attributes={};const ee={};this.numAttributes=S.length;for(let H=0;H<this.numAttributes;H++)S[H]&&(v.bindAttribLocation(this.program,H,S[H]),this.attributes[S[H]]=H);v.linkProgram(this.program),v.deleteShader(X),v.deleteShader(Y);for(let H=0;H<N.length;H++){const re=N[H];if(re&&!ee[re]){const _e=v.getUniformLocation(this.program,re);_e&&(ee[re]=_e)}}this.fixedUniforms=m(t,ee),this.binderUniforms=f?f.getUniforms(t,ee):[],g.indexOf("TERRAIN")!==-1&&(this.terrainUniforms=((H,re)=>({u_dem:new s.Uniform1i(H,re.u_dem),u_dem_prev:new s.Uniform1i(H,re.u_dem_prev),u_dem_unpack:new s.Uniform4f(H,re.u_dem_unpack),u_dem_tl:new s.Uniform2f(H,re.u_dem_tl),u_dem_scale:new s.Uniform1f(H,re.u_dem_scale),u_dem_tl_prev:new s.Uniform2f(H,re.u_dem_tl_prev),u_dem_scale_prev:new s.Uniform1f(H,re.u_dem_scale_prev),u_dem_size:new s.Uniform1f(H,re.u_dem_size),u_dem_lerp:new s.Uniform1f(H,re.u_dem_lerp),u_exaggeration:new s.Uniform1f(H,re.u_exaggeration),u_depth:new s.Uniform1i(H,re.u_depth),u_depth_size_inv:new s.Uniform2f(H,re.u_depth_size_inv),u_meter_to_dem:new s.Uniform1f(H,re.u_meter_to_dem),u_label_plane_matrix_inv:new s.UniformMatrix4f(H,re.u_label_plane_matrix_inv),u_tile_tl_up:new s.Uniform3f(H,re.u_tile_tl_up),u_tile_tr_up:new s.Uniform3f(H,re.u_tile_tr_up),u_tile_br_up:new s.Uniform3f(H,re.u_tile_br_up),u_tile_bl_up:new s.Uniform3f(H,re.u_tile_bl_up),u_tile_up_scale:new s.Uniform1f(H,re.u_tile_up_scale)}))(t,ee)),g.indexOf("FOG")!==-1&&(this.fogUniforms=((H,re)=>({u_fog_matrix:new s.UniformMatrix4f(H,re.u_fog_matrix),u_fog_range:new s.Uniform2f(H,re.u_fog_range),u_fog_color:new s.Uniform4f(H,re.u_fog_color),u_fog_horizon_blend:new s.Uniform1f(H,re.u_fog_horizon_blend),u_fog_temporal_offset:new s.Uniform1f(H,re.u_fog_temporal_offset)}))(t,ee))}setTerrainUniformValues(t,o){if(!this.terrainUniforms)return;const u=this.terrainUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const f in o)u[f].set(o[f])}}setFogUniformValues(t,o){if(!this.fogUniforms)return;const u=this.fogUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const f in o)u[f].location&&u[f].set(o[f])}}draw(t,o,u,f,m,g,v,T,C,S,k,O,V,N,R,Q){const Z=t.gl;if(this.failedToCreate)return;t.program.set(this.program),t.setDepthMode(u),t.setStencilMode(f),t.setColorMode(m),t.setCullFace(g);for(const X of Object.keys(this.fixedUniforms))this.fixedUniforms[X].set(v[X]);N&&N.setUniforms(t,this.binderUniforms,O,{zoom:V});const Y={[Z.LINES]:2,[Z.TRIANGLES]:3,[Z.LINE_STRIP]:1}[o];for(const X of k.get()){const ee=X.vaos||(X.vaos={});(ee[T]||(ee[T]=new Ta)).bind(t,this,C,N?N.getPaintVertexBuffers():[],S,X.vertexOffset,R,Q),Z.drawElements(o,X.primitiveLength*Y,Z.UNSIGNED_SHORT,X.primitiveOffset*Y*2)}}}function Ds(l,t,o){const u=1/Ui(o,1,t.transform.tileZoom),f=Math.pow(2,o.tileID.overscaledZ),m=o.tileSize*Math.pow(2,t.transform.tileZoom)/f,g=m*(o.tileID.canonical.x+o.tileID.wrap*f),v=m*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_scale:[u,l.fromScale,l.toScale],u_fade:l.t,u_pixel_coord_upper:[g>>16,v>>16],u_pixel_coord_lower:[65535&g,65535&v]}}const Vl=s.create(),Sa=(l,t,o,u,f,m,g,v,T)=>{const C=t.style.light,S=C.properties.get("position"),k=[S.x,S.y,S.z],O=s.create$1();C.properties.get("anchor")==="viewport"&&(s.fromRotation(O,-t.transform.angle),s.transformMat3(k,k,O));const V=C.properties.get("color"),N=t.transform,R={u_matrix:l,u_lightpos:k,u_lightintensity:C.properties.get("intensity"),u_lightcolor:[V.r,V.g,V.b],u_vertical_gradient:+o,u_opacity:u,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Vl,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0};return N.projection.name==="globe"&&(R.u_tile_id=[f.canonical.x,f.canonical.y,1<<f.canonical.z],R.u_zoom_transition=g,R.u_inv_rot_matrix=T,R.u_merc_center=v,R.u_up_dir=N.projection.upVector(new s.CanonicalTileID(0,0,0),v[0]*s.EXTENT,v[1]*s.EXTENT),R.u_height_lift=m),R},Ia=(l,t,o,u,f,m,g,v,T,C,S)=>{const k=Sa(l,t,o,u,f,v,T,C,S),O={u_height_factor:-Math.pow(2,f.overscaledZ)/g.tileSize/8};return s.extend(k,Ds(m,t,g),O)},za=l=>({u_matrix:l}),Da=(l,t,o,u)=>s.extend(za(l),Ds(o,t,u)),ka=(l,t)=>({u_matrix:l,u_world:t}),Au=(l,t,o,u,f)=>s.extend(Da(l,t,o,u),{u_world:f}),bu=s.create(),Go=(l,t,o,u,f,m)=>{const g=l.transform,v=g.projection.name==="globe";let T;if(m.paint.get("circle-pitch-alignment")==="map")if(v){const S=s.globePixelsToTileUnits(g.zoom,t.canonical);T=Float32Array.from([S,0,0,S])}else T=g.calculatePixelsToTileUnitsMatrix(o);else T=new Float32Array([g.pixelsToGLUnits[0],0,0,g.pixelsToGLUnits[1]]);const C={u_camera_to_center_distance:g.cameraToCenterDistance,u_matrix:l.translatePosMatrix(t.projMatrix,o,m.paint.get("circle-translate"),m.paint.get("circle-translate-anchor")),u_device_pixel_ratio:s.exported.devicePixelRatio,u_extrude_scale:T,u_inv_rot_matrix:bu,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};return v&&(C.u_inv_rot_matrix=u,C.u_merc_center=f,C.u_tile_id=[t.canonical.x,t.canonical.y,1<<t.canonical.z],C.u_zoom_transition=s.globeToMercatorTransition(g.zoom),C.u_up_dir=g.projection.upVector(t.canonical,f[0],f[1])),C},gd=l=>{const t=[];return l.paint.get("circle-pitch-alignment")==="map"&&t.push("PITCH_WITH_MAP"),l.paint.get("circle-pitch-scale")==="map"&&t.push("SCALE_WITH_MAP"),t},yd=(l,t,o)=>{const u=s.EXTENT/o.tileSize;return{u_matrix:l,u_camera_to_center_distance:t.cameraToCenterDistance,u_extrude_scale:[t.pixelsToGLUnits[0]/u,t.pixelsToGLUnits[1]/u]}},wu=(l,t,o=1)=>({u_matrix:l,u_color:t,u_overlay:0,u_overlay_scale:o}),xd=s.create(),vd=(l,t,o,u,f,m,g)=>{const v=l.transform,T=v.projection.name==="globe",C=T?s.globePixelsToTileUnits(v.zoom,t.canonical):Ui(o,1,m),S={u_matrix:t.projMatrix,u_extrude_scale:C,u_intensity:g,u_inv_rot_matrix:xd,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};return T&&(S.u_inv_rot_matrix=u,S.u_merc_center=f,S.u_tile_id=[t.canonical.x,t.canonical.y,1<<t.canonical.z],S.u_zoom_transition=s.globeToMercatorTransition(v.zoom),S.u_up_dir=v.projection.upVector(t.canonical,f[0],f[1])),S},Ad=(l,t,o,u,f,m,g)=>{const v=l.transform,T=v.calculatePixelsToTileUnitsMatrix(t),C={u_matrix:_o(l,t,o,f),u_pixels_to_tile_units:T,u_device_pixel_ratio:g,u_units_to_pixels:[1/v.pixelsToGLUnits[0],1/v.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:m,u_texsize:[0,0],u_scale:[0,0,0],u_mix:0,u_alpha_discard_threshold:0};if(jl(o)){const S=Pa(t,l.transform);C.u_texsize=t.lineAtlasTexture.size,C.u_scale=[S,u.fromScale,u.toScale],C.u_mix=u.t}return C},Gl=(l,t,o,u,f,m)=>{const g=l.transform,v=Pa(t,g);return{u_matrix:_o(l,t,o,f),u_texsize:t.imageAtlasTexture.size,u_pixels_to_tile_units:g.calculatePixelsToTileUnitsMatrix(t),u_device_pixel_ratio:m,u_image:0,u_scale:[v,u.fromScale,u.toScale],u_fade:u.t,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function Pa(l,t){return 1/Ui(l,1,t.tileZoom)}function _o(l,t,o,u){return l.translatePosMatrix(u||t.tileID.projMatrix,t,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}function jl(l){const t=l.paint.get("line-dasharray").value;return t.value||t.kind!=="constant"}const Tu=(l,t,o,u,f,m)=>{return{u_matrix:l,u_tl_parent:t,u_scale_parent:o,u_fade_t:u.mix,u_opacity:u.opacity*f.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:f.paint.get("raster-brightness-min"),u_brightness_high:f.paint.get("raster-brightness-max"),u_saturation_factor:(v=f.paint.get("raster-saturation"),v>0?1-1/(1.001-v):-v),u_contrast_factor:(g=f.paint.get("raster-contrast"),g>0?1/(1-g):1+g),u_spin_weights:Zl(f.paint.get("raster-hue-rotate")),u_perspective_transform:m};var g,v};function Zl(l){l*=Math.PI/180;const t=Math.sin(l),o=Math.cos(l);return[(2*o+1)/3,(-Math.sqrt(3)*t-o+1)/3,(Math.sqrt(3)*t-o+1)/3]}const Fn=s.create(),ql=(l,t,o,u,f,m,g,v,T,C,S,k,O,V)=>{const N=f.transform,R={u_is_size_zoom_constant:+(l==="constant"||l==="source"),u_is_size_feature_constant:+(l==="constant"||l==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:N.cameraToCenterDistance,u_rotate_symbol:+o,u_aspect_ratio:N.width/N.height,u_fade_change:f.options.fadeDuration?f.symbolFadeChange:1,u_matrix:m,u_label_plane_matrix:g,u_coord_matrix:v,u_is_text:+T,u_pitch_with_map:+u,u_texsize:C,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Fn,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Fn};return N.projection.name==="globe"&&(R.u_tile_id=[S.canonical.x,S.canonical.y,1<<S.canonical.z],R.u_zoom_transition=k,R.u_inv_rot_matrix=V,R.u_merc_center=O,R.u_camera_forward=N._camera.forward(),R.u_ecef_origin=s.globeECEFOrigin(N.globeMatrix,S.toUnwrapped()),R.u_tile_matrix=Float32Array.from(N.globeMatrix)),R},go=(l,t,o,u,f,m,g,v,T,C,S,k,O,V,N)=>{const{cameraToCenterDistance:R,_pitch:Q}=f.transform;return s.extend(ql(l,t,o,u,f,m,g,v,T,C,k,O,V,N),{u_gamma_scale:u?R*Math.cos(f.terrain?0:Q):1,u_device_pixel_ratio:s.exported.devicePixelRatio,u_is_halo:+S})},jo=(l,t,o,u,f,m,g,v,T,C,S,k,O,V)=>s.extend(go(l,t,o,u,f,m,g,v,!0,T,!0,S,k,O,V),{u_texsize_icon:C,u_texture_icon:1}),Eu=(l,t,o)=>({u_matrix:l,u_opacity:t,u_color:o}),Wl=(l,t,o,u,f,m)=>s.extend(function(g,v,T,C){const S=T.imageManager.getPattern(g.from.toString()),k=T.imageManager.getPattern(g.to.toString()),{width:O,height:V}=T.imageManager.getPixelSize(),N=Math.pow(2,C.tileID.overscaledZ),R=C.tileSize*Math.pow(2,T.transform.tileZoom)/N,Q=R*(C.tileID.canonical.x+C.tileID.wrap*N),Z=R*C.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:S.tl,u_pattern_br_a:S.br,u_pattern_tl_b:k.tl,u_pattern_br_b:k.br,u_texsize:[O,V],u_mix:v.t,u_pattern_size_a:S.displaySize,u_pattern_size_b:k.displaySize,u_scale_a:v.fromScale,u_scale_b:v.toScale,u_tile_units_to_pixels:1/Ui(C,1,T.transform.tileZoom),u_pixel_coord_upper:[Q>>16,Z>>16],u_pixel_coord_lower:[65535&Q,65535&Z]}}(u,m,o,f),{u_matrix:l,u_opacity:t}),ai={fillExtrusion:(l,t)=>({u_matrix:new s.UniformMatrix4f(l,t.u_matrix),u_lightpos:new s.Uniform3f(l,t.u_lightpos),u_lightintensity:new s.Uniform1f(l,t.u_lightintensity),u_lightcolor:new s.Uniform3f(l,t.u_lightcolor),u_vertical_gradient:new s.Uniform1f(l,t.u_vertical_gradient),u_opacity:new s.Uniform1f(l,t.u_opacity),u_tile_id:new s.Uniform3f(l,t.u_tile_id),u_zoom_transition:new s.Uniform1f(l,t.u_zoom_transition),u_inv_rot_matrix:new s.UniformMatrix4f(l,t.u_inv_rot_matrix),u_merc_center:new s.Uniform2f(l,t.u_merc_center),u_up_dir:new s.Uniform3f(l,t.u_up_dir),u_height_lift:new s.Uniform1f(l,t.u_height_lift)}),fillExtrusionPattern:(l,t)=>({u_matrix:new s.UniformMatrix4f(l,t.u_matrix),u_lightpos:new s.Uniform3f(l,t.u_lightpos),u_lightintensity:new s.Uniform1f(l,t.u_lightintensity),u_lightcolor:new s.Uniform3f(l,t.u_lightcolor),u_vertical_gradient:new s.Uniform1f(l,t.u_vertical_gradient),u_height_factor:new s.Uniform1f(l,t.u_height_factor),u_tile_id:new s.Uniform3f(l,t.u_tile_id),u_zoom_transition:new s.Uniform1f(l,t.u_zoom_transition),u_inv_rot_matrix:new s.UniformMatrix4f(l,t.u_inv_rot_matrix),u_merc_center:new s.Uniform2f(l,t.u_merc_center),u_up_dir:new s.Uniform3f(l,t.u_up_dir),u_height_lift:new s.Uniform1f(l,t.u_height_lift),u_image:new s.Uniform1i(l,t.u_image),u_texsize:new s.Uniform2f(l,t.u_texsize),u_pixel_coord_upper:new s.Uniform2f(l,t.u_pixel_coord_upper),u_pixel_coord_lower:new s.Uniform2f(l,t.u_pixel_coord_lower),u_scale:new s.Uniform3f(l,t.u_scale),u_fade:new s.Uniform1f(l,t.u_fade),u_opacity:new s.Uniform1f(l,t.u_opacity)}),fill:(l,t)=>({u_matrix:new s.UniformMatrix4f(l,t.u_matrix)}),fillPattern:(l,t)=>({u_matrix:new s.UniformMatrix4f(l,t.u_matrix),u_image:new s.Uniform1i(l,t.u_image),u_texsize:new s.Uniform2f(l,t.u_texsize),u_pixel_coord_upper:new s.Uniform2f(l,t.u_pixel_coord_upper),u_pixel_coord_lower:new s.Uniform2f(l,t.u_pixel_coord_lower),u_scale:new s.Uniform3f(l,t.u_scale),u_fade:new s.Uniform1f(l,t.u_fade)}),fillOutline:(l,t)=>({u_matrix:new s.UniformMatrix4f(l,t.u_matrix),u_world:new s.Uniform2f(l,t.u_world)}),fillOutlinePattern:(l,t)=>({u_matrix:new s.UniformMatrix4f(l,t.u_matrix),u_world:new s.Uniform2f(l,t.u_world),u_image:new s.Uniform1i(l,t.u_image),u_texsize:new s.Uniform2f(l,t.u_texsize),u_pixel_coord_upper:new s.Uniform2f(l,t.u_pixel_coord_upper),u_pixel_coord_lower:new s.Uniform2f(l,t.u_pixel_coord_lower),u_scale:new s.Uniform3f(l,t.u_scale),u_fade:new s.Uniform1f(l,t.u_fade)}),circle:(l,t)=>({u_camera_to_center_distance:new s.Uniform1f(l,t.u_camera_to_center_distance),u_extrude_scale:new s.UniformMatrix2f(l,t.u_extrude_scale),u_device_pixel_ratio:new s.Uniform1f(l,t.u_device_pixel_ratio),u_matrix:new s.UniformMatrix4f(l,t.u_matrix),u_inv_rot_matrix:new s.UniformMatrix4f(l,t.u_inv_rot_matrix),u_merc_center:new s.Uniform2f(l,t.u_merc_center),u_tile_id:new s.Uniform3f(l,t.u_tile_id),u_zoom_transition:new s.Uniform1f(l,t.u_zoom_transition),u_up_dir:new s.Uniform3f(l,t.u_up_dir)}),collisionBox:(l,t)=>({u_matrix:new s.UniformMatrix4f(l,t.u_matrix),u_camera_to_center_distance:new s.Uniform1f(l,t.u_camera_to_center_distance),u_extrude_scale:new s.Uniform2f(l,t.u_extrude_scale)}),collisionCircle:(l,t)=>({u_matrix:new s.UniformMatrix4f(l,t.u_matrix),u_inv_matrix:new s.UniformMatrix4f(l,t.u_inv_matrix),u_camera_to_center_distance:new s.Uniform1f(l,t.u_camera_to_center_distance),u_viewport_size:new s.Uniform2f(l,t.u_viewport_size)}),debug:(l,t)=>({u_color:new s.UniformColor(l,t.u_color),u_matrix:new s.UniformMatrix4f(l,t.u_matrix),u_overlay:new s.Uniform1i(l,t.u_overlay),u_overlay_scale:new s.Uniform1f(l,t.u_overlay_scale)}),clippingMask:(l,t)=>({u_matrix:new s.UniformMatrix4f(l,t.u_matrix)}),heatmap:(l,t)=>({u_extrude_scale:new s.Uniform1f(l,t.u_extrude_scale),u_intensity:new s.Uniform1f(l,t.u_intensity),u_matrix:new s.UniformMatrix4f(l,t.u_matrix),u_inv_rot_matrix:new s.UniformMatrix4f(l,t.u_inv_rot_matrix),u_merc_center:new s.Uniform2f(l,t.u_merc_center),u_tile_id:new s.Uniform3f(l,t.u_tile_id),u_zoom_transition:new s.Uniform1f(l,t.u_zoom_transition),u_up_dir:new s.Uniform3f(l,t.u_up_dir)}),heatmapTexture:(l,t)=>({u_image:new s.Uniform1i(l,t.u_image),u_color_ramp:new s.Uniform1i(l,t.u_color_ramp),u_opacity:new s.Uniform1f(l,t.u_opacity)}),hillshade:(l,t)=>({u_matrix:new s.UniformMatrix4f(l,t.u_matrix),u_image:new s.Uniform1i(l,t.u_image),u_latrange:new s.Uniform2f(l,t.u_latrange),u_light:new s.Uniform2f(l,t.u_light),u_shadow:new s.UniformColor(l,t.u_shadow),u_highlight:new s.UniformColor(l,t.u_highlight),u_accent:new s.UniformColor(l,t.u_accent)}),hillshadePrepare:(l,t)=>({u_matrix:new s.UniformMatrix4f(l,t.u_matrix),u_image:new s.Uniform1i(l,t.u_image),u_dimension:new s.Uniform2f(l,t.u_dimension),u_zoom:new s.Uniform1f(l,t.u_zoom),u_unpack:new s.Uniform4f(l,t.u_unpack)}),line:(l,t)=>({u_matrix:new s.UniformMatrix4f(l,t.u_matrix),u_pixels_to_tile_units:new s.UniformMatrix2f(l,t.u_pixels_to_tile_units),u_device_pixel_ratio:new s.Uniform1f(l,t.u_device_pixel_ratio),u_units_to_pixels:new s.Uniform2f(l,t.u_units_to_pixels),u_dash_image:new s.Uniform1i(l,t.u_dash_image),u_gradient_image:new s.Uniform1i(l,t.u_gradient_image),u_image_height:new s.Uniform1f(l,t.u_image_height),u_texsize:new s.Uniform2f(l,t.u_texsize),u_scale:new s.Uniform3f(l,t.u_scale),u_mix:new s.Uniform1f(l,t.u_mix),u_alpha_discard_threshold:new s.Uniform1f(l,t.u_alpha_discard_threshold)}),linePattern:(l,t)=>({u_matrix:new s.UniformMatrix4f(l,t.u_matrix),u_texsize:new s.Uniform2f(l,t.u_texsize),u_pixels_to_tile_units:new s.UniformMatrix2f(l,t.u_pixels_to_tile_units),u_device_pixel_ratio:new s.Uniform1f(l,t.u_device_pixel_ratio),u_image:new s.Uniform1i(l,t.u_image),u_units_to_pixels:new s.Uniform2f(l,t.u_units_to_pixels),u_scale:new s.Uniform3f(l,t.u_scale),u_fade:new s.Uniform1f(l,t.u_fade),u_alpha_discard_threshold:new s.Uniform1f(l,t.u_alpha_discard_threshold)}),raster:(l,t)=>({u_matrix:new s.UniformMatrix4f(l,t.u_matrix),u_tl_parent:new s.Uniform2f(l,t.u_tl_parent),u_scale_parent:new s.Uniform1f(l,t.u_scale_parent),u_fade_t:new s.Uniform1f(l,t.u_fade_t),u_opacity:new s.Uniform1f(l,t.u_opacity),u_image0:new s.Uniform1i(l,t.u_image0),u_image1:new s.Uniform1i(l,t.u_image1),u_brightness_low:new s.Uniform1f(l,t.u_brightness_low),u_brightness_high:new s.Uniform1f(l,t.u_brightness_high),u_saturation_factor:new s.Uniform1f(l,t.u_saturation_factor),u_contrast_factor:new s.Uniform1f(l,t.u_contrast_factor),u_spin_weights:new s.Uniform3f(l,t.u_spin_weights),u_perspective_transform:new s.Uniform2f(l,t.u_perspective_transform)}),symbolIcon:(l,t)=>({u_is_size_zoom_constant:new s.Uniform1i(l,t.u_is_size_zoom_constant),u_is_size_feature_constant:new s.Uniform1i(l,t.u_is_size_feature_constant),u_size_t:new s.Uniform1f(l,t.u_size_t),u_size:new s.Uniform1f(l,t.u_size),u_camera_to_center_distance:new s.Uniform1f(l,t.u_camera_to_center_distance),u_rotate_symbol:new s.Uniform1i(l,t.u_rotate_symbol),u_aspect_ratio:new s.Uniform1f(l,t.u_aspect_ratio),u_fade_change:new s.Uniform1f(l,t.u_fade_change),u_matrix:new s.UniformMatrix4f(l,t.u_matrix),u_label_plane_matrix:new s.UniformMatrix4f(l,t.u_label_plane_matrix),u_coord_matrix:new s.UniformMatrix4f(l,t.u_coord_matrix),u_is_text:new s.Uniform1i(l,t.u_is_text),u_pitch_with_map:new s.Uniform1i(l,t.u_pitch_with_map),u_texsize:new s.Uniform2f(l,t.u_texsize),u_tile_id:new s.Uniform3f(l,t.u_tile_id),u_zoom_transition:new s.Uniform1f(l,t.u_zoom_transition),u_inv_rot_matrix:new s.UniformMatrix4f(l,t.u_inv_rot_matrix),u_merc_center:new s.Uniform2f(l,t.u_merc_center),u_camera_forward:new s.Uniform3f(l,t.u_camera_forward),u_tile_matrix:new s.UniformMatrix4f(l,t.u_tile_matrix),u_ecef_origin:new s.Uniform3f(l,t.u_ecef_origin),u_texture:new s.Uniform1i(l,t.u_texture)}),symbolSDF:(l,t)=>({u_is_size_zoom_constant:new s.Uniform1i(l,t.u_is_size_zoom_constant),u_is_size_feature_constant:new s.Uniform1i(l,t.u_is_size_feature_constant),u_size_t:new s.Uniform1f(l,t.u_size_t),u_size:new s.Uniform1f(l,t.u_size),u_camera_to_center_distance:new s.Uniform1f(l,t.u_camera_to_center_distance),u_rotate_symbol:new s.Uniform1i(l,t.u_rotate_symbol),u_aspect_ratio:new s.Uniform1f(l,t.u_aspect_ratio),u_fade_change:new s.Uniform1f(l,t.u_fade_change),u_matrix:new s.UniformMatrix4f(l,t.u_matrix),u_label_plane_matrix:new s.UniformMatrix4f(l,t.u_label_plane_matrix),u_coord_matrix:new s.UniformMatrix4f(l,t.u_coord_matrix),u_is_text:new s.Uniform1i(l,t.u_is_text),u_pitch_with_map:new s.Uniform1i(l,t.u_pitch_with_map),u_texsize:new s.Uniform2f(l,t.u_texsize),u_texture:new s.Uniform1i(l,t.u_texture),u_gamma_scale:new s.Uniform1f(l,t.u_gamma_scale),u_device_pixel_ratio:new s.Uniform1f(l,t.u_device_pixel_ratio),u_tile_id:new s.Uniform3f(l,t.u_tile_id),u_zoom_transition:new s.Uniform1f(l,t.u_zoom_transition),u_inv_rot_matrix:new s.UniformMatrix4f(l,t.u_inv_rot_matrix),u_merc_center:new s.Uniform2f(l,t.u_merc_center),u_camera_forward:new s.Uniform3f(l,t.u_camera_forward),u_tile_matrix:new s.UniformMatrix4f(l,t.u_tile_matrix),u_ecef_origin:new s.Uniform3f(l,t.u_ecef_origin),u_is_halo:new s.Uniform1i(l,t.u_is_halo)}),symbolTextAndIcon:(l,t)=>({u_is_size_zoom_constant:new s.Uniform1i(l,t.u_is_size_zoom_constant),u_is_size_feature_constant:new s.Uniform1i(l,t.u_is_size_feature_constant),u_size_t:new s.Uniform1f(l,t.u_size_t),u_size:new s.Uniform1f(l,t.u_size),u_camera_to_center_distance:new s.Uniform1f(l,t.u_camera_to_center_distance),u_rotate_symbol:new s.Uniform1i(l,t.u_rotate_symbol),u_aspect_ratio:new s.Uniform1f(l,t.u_aspect_ratio),u_fade_change:new s.Uniform1f(l,t.u_fade_change),u_matrix:new s.UniformMatrix4f(l,t.u_matrix),u_label_plane_matrix:new s.UniformMatrix4f(l,t.u_label_plane_matrix),u_coord_matrix:new s.UniformMatrix4f(l,t.u_coord_matrix),u_is_text:new s.Uniform1i(l,t.u_is_text),u_pitch_with_map:new s.Uniform1i(l,t.u_pitch_with_map),u_texsize:new s.Uniform2f(l,t.u_texsize),u_texsize_icon:new s.Uniform2f(l,t.u_texsize_icon),u_texture:new s.Uniform1i(l,t.u_texture),u_texture_icon:new s.Uniform1i(l,t.u_texture_icon),u_gamma_scale:new s.Uniform1f(l,t.u_gamma_scale),u_device_pixel_ratio:new s.Uniform1f(l,t.u_device_pixel_ratio),u_is_halo:new s.Uniform1i(l,t.u_is_halo)}),background:(l,t)=>({u_matrix:new s.UniformMatrix4f(l,t.u_matrix),u_opacity:new s.Uniform1f(l,t.u_opacity),u_color:new s.UniformColor(l,t.u_color)}),backgroundPattern:(l,t)=>({u_matrix:new s.UniformMatrix4f(l,t.u_matrix),u_opacity:new s.Uniform1f(l,t.u_opacity),u_image:new s.Uniform1i(l,t.u_image),u_pattern_tl_a:new s.Uniform2f(l,t.u_pattern_tl_a),u_pattern_br_a:new s.Uniform2f(l,t.u_pattern_br_a),u_pattern_tl_b:new s.Uniform2f(l,t.u_pattern_tl_b),u_pattern_br_b:new s.Uniform2f(l,t.u_pattern_br_b),u_texsize:new s.Uniform2f(l,t.u_texsize),u_mix:new s.Uniform1f(l,t.u_mix),u_pattern_size_a:new s.Uniform2f(l,t.u_pattern_size_a),u_pattern_size_b:new s.Uniform2f(l,t.u_pattern_size_b),u_scale_a:new s.Uniform1f(l,t.u_scale_a),u_scale_b:new s.Uniform1f(l,t.u_scale_b),u_pixel_coord_upper:new s.Uniform2f(l,t.u_pixel_coord_upper),u_pixel_coord_lower:new s.Uniform2f(l,t.u_pixel_coord_lower),u_tile_units_to_pixels:new s.Uniform1f(l,t.u_tile_units_to_pixels)}),terrainRaster:Fl,terrainDepth:Fl,skybox:(l,t)=>({u_matrix:new s.UniformMatrix4f(l,t.u_matrix),u_sun_direction:new s.Uniform3f(l,t.u_sun_direction),u_cubemap:new s.Uniform1i(l,t.u_cubemap),u_opacity:new s.Uniform1f(l,t.u_opacity),u_temporal_offset:new s.Uniform1f(l,t.u_temporal_offset)}),skyboxGradient:(l,t)=>({u_matrix:new s.UniformMatrix4f(l,t.u_matrix),u_color_ramp:new s.Uniform1i(l,t.u_color_ramp),u_center_direction:new s.Uniform3f(l,t.u_center_direction),u_radius:new s.Uniform1f(l,t.u_radius),u_opacity:new s.Uniform1f(l,t.u_opacity),u_temporal_offset:new s.Uniform1f(l,t.u_temporal_offset)}),skyboxCapture:(l,t)=>({u_matrix_3f:new s.UniformMatrix3f(l,t.u_matrix_3f),u_sun_direction:new s.Uniform3f(l,t.u_sun_direction),u_sun_intensity:new s.Uniform1f(l,t.u_sun_intensity),u_color_tint_r:new s.Uniform4f(l,t.u_color_tint_r),u_color_tint_m:new s.Uniform4f(l,t.u_color_tint_m),u_luminance:new s.Uniform1f(l,t.u_luminance)}),globeRaster:(l,t)=>({u_proj_matrix:new s.UniformMatrix4f(l,t.u_proj_matrix),u_globe_matrix:new s.UniformMatrix4f(l,t.u_globe_matrix),u_merc_matrix:new s.UniformMatrix4f(l,t.u_merc_matrix),u_zoom_transition:new s.Uniform1f(l,t.u_zoom_transition),u_merc_center:new s.Uniform2f(l,t.u_merc_center),u_image0:new s.Uniform1i(l,t.u_image0),u_grid_matrix:new s.UniformMatrix3f(l,t.u_grid_matrix)}),globeAtmosphere:(l,t)=>({u_frustum_tl:new s.Uniform3f(l,t.u_frustum_tl),u_frustum_tr:new s.Uniform3f(l,t.u_frustum_tr),u_frustum_br:new s.Uniform3f(l,t.u_frustum_br),u_frustum_bl:new s.Uniform3f(l,t.u_frustum_bl),u_globe_pos:new s.Uniform3f(l,t.u_globe_pos),u_globe_radius:new s.Uniform1f(l,t.u_globe_radius),u_opacity:new s.Uniform1f(l,t.u_opacity),u_fadeout_range:new s.Uniform1f(l,t.u_fadeout_range),u_start_color:new s.Uniform3f(l,t.u_start_color),u_end_color:new s.Uniform3f(l,t.u_end_color)})};let yo;function Cu(l,t,o,u,f,m,g){const v=l.context,T=v.gl,C=l.useProgram("collisionBox"),S=[];let k=0,O=0;for(let X=0;X<u.length;X++){const ee=u[X],H=t.getTile(ee),re=H.getBucket(o);if(!re)continue;let _e=ee.projMatrix;f[0]===0&&f[1]===0||(_e=l.translatePosMatrix(ee.projMatrix,H,f,m));const Ae=g?re.textCollisionBox:re.iconCollisionBox,Se=re.collisionCircleArray;if(Se.length>0){const Ce=s.create(),Ge=_e;s.mul(Ce,re.placementInvProjMatrix,l.transform.glCoordMatrix),s.mul(Ce,Ce,re.placementViewportMatrix),S.push({circleArray:Se,circleOffset:O,transform:Ge,invTransform:Ce}),k+=Se.length/4,O=k}Ae&&(l.terrain&&l.terrain.setupElevationDraw(H,C),C.draw(v,T.LINES,s.DepthMode.disabled,s.StencilMode.disabled,l.colorModeForRenderPass(),s.CullFaceMode.disabled,yd(_e,l.transform,H),o.id,Ae.layoutVertexBuffer,Ae.indexBuffer,Ae.segments,null,l.transform.zoom,null,Ae.collisionVertexBuffer,Ae.collisionVertexBufferExt))}if(!g||!S.length)return;const V=l.useProgram("collisionCircle"),N=new s.StructArrayLayout2f1f2i16;N.resize(4*k),N._trim();let R=0;for(const X of S)for(let ee=0;ee<X.circleArray.length/4;ee++){const H=4*ee,re=X.circleArray[H+0],_e=X.circleArray[H+1],Ae=X.circleArray[H+2],Se=X.circleArray[H+3];N.emplace(R++,re,_e,Ae,Se,0),N.emplace(R++,re,_e,Ae,Se,1),N.emplace(R++,re,_e,Ae,Se,2),N.emplace(R++,re,_e,Ae,Se,3)}(!yo||yo.length<2*k)&&(yo=function(X){const ee=2*X,H=new s.StructArrayLayout3ui6;H.resize(ee),H._trim();for(let re=0;re<ee;re++){const _e=6*re;H.uint16[_e+0]=4*re+0,H.uint16[_e+1]=4*re+1,H.uint16[_e+2]=4*re+2,H.uint16[_e+3]=4*re+2,H.uint16[_e+4]=4*re+3,H.uint16[_e+5]=4*re+0}return H}(k));const Q=v.createIndexBuffer(yo,!0),Z=v.createVertexBuffer(N,s.collisionCircleLayout.members,!0);for(const X of S){const ee={u_matrix:X.transform,u_inv_matrix:X.invTransform,u_camera_to_center_distance:(Y=l.transform).cameraToCenterDistance,u_viewport_size:[Y.width,Y.height]};V.draw(v,T.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,l.colorModeForRenderPass(),s.CullFaceMode.disabled,ee,o.id,Z,Q,s.SegmentVector.simpleSegment(0,2*X.circleOffset,X.circleArray.length,X.circleArray.length/2),null,l.transform.zoom,null,null,null)}var Y;Z.destroy(),Q.destroy()}const Hl=s.create();function ks(l,t,o,u,f,m){const{horizontalAlign:g,verticalAlign:v}=s.getAnchorAlignment(l),T=-(g-.5)*t,C=-(v-.5)*o,S=s.evaluateVariableOffset(l,u);return new s.pointGeometry((T/f+S[0])*m,(C/f+S[1])*m)}function bd(l,t,o,u,f,m,g,v,T,C,S,k){const O=l.text.placedSymbolArray,V=l.text.dynamicLayoutVertexArray,N=l.icon.dynamicLayoutVertexArray,R={},Q=v.projMatrix,Z=m.elevation,Y=k.upVectorScale(v.canonical,m.center.lat,m.worldSize);V.clear();for(let X=0;X<O.length;X++){const ee=O.get(X),H=l.allowVerticalPlacement&&!ee.placedOrientation,re=ee.hidden||!ee.crossTileID||H?null:u[ee.crossTileID];if(re){const _e=new s.pointGeometry(ee.tileAnchorX,ee.tileAnchorY),Ae=k.upVector(v.canonical,_e.x,_e.y),Se=Z?Z.getAtTileOffset(v,_e.x,_e.y):0,Ce=Nr([ee.projectedAnchorX+Se*Ae[0]*Y.metersToTile,ee.projectedAnchorY+Se*Ae[1]*Y.metersToTile,ee.projectedAnchorZ+Se*Ae[2]*Y.metersToTile],o?Q:g),Ge=Ti(m.cameraToCenterDistance,Ce.signedDistanceFromCamera);let ge=f.evaluateSizeForFeature(l.textSizeData,C,ee)*Ge/s.ONE_EM;o&&(ge*=l.tilePixelRatio/T);const{width:Ue,height:Oe,anchor:st,textOffset:be,textScale:pt}=re,gt=ks(st,Ue,Oe,be,pt,ge),rt=o?dr(_e.add(gt),g,Se*Y.metersToLabelSpace).point:Ce.point.add(t?gt.rotate(-m.angle):gt),nt=l.allowVerticalPlacement&&ee.placedOrientation===s.WritingMode.vertical?Math.PI/2:0;for(let At=0;At<ee.numGlyphs;At++)s.addDynamicAttributes(V,rt,nt);S&&ee.associatedIconIndex>=0&&(R[ee.associatedIconIndex]={shiftedAnchor:rt,angle:nt})}else Vi(ee.numGlyphs,V)}if(S){N.clear();const X=l.icon.placedSymbolArray;for(let ee=0;ee<X.length;ee++){const H=X.get(ee);if(H.hidden)Vi(H.numGlyphs,N);else{const re=R[ee];if(re)for(let _e=0;_e<H.numGlyphs;_e++)s.addDynamicAttributes(N,re.shiftedAnchor,re.angle);else Vi(H.numGlyphs,N)}}l.icon.dynamicLayoutVertexBuffer.updateData(N)}l.text.dynamicLayoutVertexBuffer.updateData(V)}function wd(l,t,o){return o.iconsInText&&t?"symbolTextAndIcon":l?"symbolSDF":"symbolIcon"}function Yl(l,t,o,u,f,m,g,v,T,C,S,k){const O=l.context,V=O.gl,N=l.transform,R=v==="map",Q=T==="map",Z=R&&o.layout.get("symbol-placement")!=="point",Y=R&&!Q&&!Z,X=o.layout.get("symbol-sort-key").constantOr(1)!==void 0;let ee=!1;const H=l.depthModeForSublayer(0,s.DepthMode.ReadOnly),re=[s.mercatorXfromLng(N.center.lng),s.mercatorYfromLat(N.center.lat)],_e=o.layout.get("text-variable-anchor"),Ae=N.projection.name==="globe",Se=Ae?s.globeToMercatorTransition(N.zoom):0,Ce=[],Ge=[];l.terrain&&Q&&Ge.push("PITCH_WITH_MAP_TERRAIN"),Ae&&Ge.push("PROJECTION_GLOBE_VIEW");for(const ge of u){const Ue=t.getTile(ge),Oe=Ue.getBucket(o);if(!Oe||Oe.projection!==N.projection.name)continue;const st=f?Oe.text:Oe.icon;if(!st||Oe.fullyClipped||!st.segments.get().length)continue;const be=st.programConfigurations.get(o.id),pt=f||Oe.sdfIcons,gt=f?Oe.textSizeData:Oe.iconSizeData,rt=Q||N.pitch!==0,nt=s.evaluateSizeForZoom(gt,N.zoom);let At,Pt,ct,Ct,Ht=[0,0],Mi=null;if(f){if(Pt=Ue.glyphAtlasTexture,ct=V.LINEAR,At=Ue.glyphAtlasTexture.size,Oe.iconsInText){Ht=Ue.imageAtlasTexture.size,Mi=Ue.imageAtlasTexture;const kr=gt.kind==="composite"||gt.kind==="camera";Ct=rt||l.options.rotating||l.options.zooming||kr?V.LINEAR:V.NEAREST}}else{const kr=o.layout.get("icon-size").constantOr(0)!==1||Oe.iconsNeedLinear;Pt=Ue.imageAtlasTexture,ct=pt||l.options.rotating||l.options.zooming||kr||rt?V.LINEAR:V.NEAREST,At=Ue.imageAtlasTexture.size}const nr=l.transform.calculatePixelsToTileUnitsMatrix(Ue),or=po(ge.projMatrix,Ue.tileID.canonical,Q,R,l.transform,nr),zr=l.terrain&&Q&&Z?s.invert(s.create(),or):Hl,sn=Ro(ge.projMatrix,Ue.tileID.canonical,Q,R,l.transform,nr),Cn=_e&&Oe.hasTextData(),jn=o.layout.get("icon-text-fit")!=="none"&&Cn&&Oe.hasIconData();if(Z){const kr=N.elevation,Ao=kr?kr.getAtTileOffsetFunc(ge,N.center.lat,N.worldSize,N.projection):ih=>[0,0,0];bs(Oe,ge.projMatrix,l,f,or,sn,Q,C,Ao,ge)}const Mn=Z||f&&_e||jn,Si=l.translatePosMatrix(ge.projMatrix,Ue,m,g),Di=Mn?Hl:or,ii=l.translatePosMatrix(sn,Ue,m,g,!0),Fi=N.projection.createInversionMatrix(N,ge.canonical),Dr=Mn?Ge.concat(["PROJECTED_POS_ON_VIEWPORT"]):Ge,Ei=pt&&o.paint.get(f?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Gr;Gr=pt?Oe.iconsInText?jo(gt.kind,nt,Y,Q,l,Si,Di,ii,At,Ht,ge,Se,re,Fi):go(gt.kind,nt,Y,Q,l,Si,Di,ii,f,At,!0,ge,Se,re,Fi):ql(gt.kind,nt,Y,Q,l,Si,Di,ii,f,At,ge,Se,re,Fi);const Ys={program:l.useProgram(wd(pt,f,Oe),be,Dr),buffers:st,uniformValues:Gr,atlasTexture:Pt,atlasTextureIcon:Mi,atlasInterpolation:ct,atlasInterpolationIcon:Ct,isSDF:pt,hasHalo:Ei,tile:Ue,labelPlaneMatrixInv:zr};if(X&&Oe.canOverlap){ee=!0;const kr=st.segments.get();for(const Ao of kr)Ce.push({segments:new s.SegmentVector([Ao]),sortKey:Ao.sortKey,state:Ys})}else Ce.push({segments:st.segments,sortKey:0,state:Ys})}ee&&Ce.sort((ge,Ue)=>ge.sortKey-Ue.sortKey);for(const ge of Ce){const Ue=ge.state;if(l.terrain&&l.terrain.setupElevationDraw(Ue.tile,Ue.program,{useDepthForOcclusion:!Ae,labelPlaneMatrixInv:Ue.labelPlaneMatrixInv}),O.activeTexture.set(V.TEXTURE0),Ue.atlasTexture.bind(Ue.atlasInterpolation,V.CLAMP_TO_EDGE),Ue.atlasTextureIcon&&(O.activeTexture.set(V.TEXTURE1),Ue.atlasTextureIcon&&Ue.atlasTextureIcon.bind(Ue.atlasInterpolationIcon,V.CLAMP_TO_EDGE)),Ue.isSDF){const Oe=Ue.uniformValues;Ue.hasHalo&&(Oe.u_is_halo=1,Mu(Ue.buffers,ge.segments,o,l,Ue.program,H,S,k,Oe)),Oe.u_is_halo=0}Mu(Ue.buffers,ge.segments,o,l,Ue.program,H,S,k,Ue.uniformValues)}}function Mu(l,t,o,u,f,m,g,v,T){const C=u.context;f.draw(C,C.gl.TRIANGLES,m,g,v,s.CullFaceMode.disabled,T,o.id,l.layoutVertexBuffer,l.indexBuffer,t,o.paint,u.transform.zoom,l.programConfigurations.get(o.id),l.dynamicLayoutVertexBuffer,l.opacityVertexBuffer)}function Ba(l,t,o,u,f,m,g){const v=l.context.gl,T=o.paint.get("fill-pattern"),C=T&&T.constantOr(1),S=o.getCrossfadeParameters();let k,O,V,N,R;g?(O=C&&!o.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",k=v.LINES):(O=C?"fillPattern":"fill",k=v.TRIANGLES);for(const Q of u){const Z=t.getTile(Q);if(C&&!Z.patternsLoaded())continue;const Y=Z.getBucket(o);if(!Y)continue;l.prepareDrawTile();const X=Y.programConfigurations.get(o.id),ee=l.useProgram(O,X);C&&(l.context.activeTexture.set(v.TEXTURE0),Z.imageAtlasTexture.bind(v.LINEAR,v.CLAMP_TO_EDGE),X.updatePaintBuffers(S));const H=T.constantOr(null);if(H&&Z.imageAtlas){const _e=Z.imageAtlas,Ae=_e.patternPositions[H.to.toString()],Se=_e.patternPositions[H.from.toString()];Ae&&Se&&X.setConstantPatternPositions(Ae,Se)}const re=l.translatePosMatrix(Q.projMatrix,Z,o.paint.get("fill-translate"),o.paint.get("fill-translate-anchor"));if(g){N=Y.indexBuffer2,R=Y.segments2;const _e=l.terrain&&l.terrain.renderingToTexture?l.terrain.drapeBufferSize:[v.drawingBufferWidth,v.drawingBufferHeight];V=O==="fillOutlinePattern"&&C?Au(re,l,S,Z,_e):ka(re,_e)}else N=Y.indexBuffer,R=Y.segments,V=C?Da(re,l,S,Z):za(re);l.prepareDrawProgram(l.context,ee,Q.toUnwrapped()),ee.draw(l.context,k,f,l.stencilModeForClipping(Q),m,s.CullFaceMode.disabled,V,o.id,Y.layoutVertexBuffer,N,R,o.paint,l.transform.zoom,X)}}function Zo(l,t,o,u,f,m,g){const v=l.context,T=v.gl,C=l.transform,S=o.paint.get("fill-extrusion-pattern"),k=S.constantOr(1),O=o.getCrossfadeParameters(),V=o.paint.get("fill-extrusion-opacity"),N=function(X){if(X.projection.name!=="globe")return 0;const ee=Math.PI/32,H=Math.tan(ee),re=s.earthRadius;return re*Math.sqrt(1+2*H*H)-re}(C),R=C.projection.name==="globe",Q=R?s.globeToMercatorTransition(C.zoom):0,Z=[s.mercatorXfromLng(C.center.lng),s.mercatorYfromLat(C.center.lat)],Y=[];R&&Y.push("PROJECTION_GLOBE_VIEW");for(const X of u){const ee=t.getTile(X),H=ee.getBucket(o);if(!H||H.projection!==C.projection.name)continue;const re=H.programConfigurations.get(o.id),_e=l.useProgram(k?"fillExtrusionPattern":"fillExtrusion",re,Y);if(l.terrain){const Ue=l.terrain;if(l.style.terrainSetForDrapingOnly())Ue.setupElevationDraw(ee,_e,{useMeterToDem:!0});else{if(!H.enableTerrain)continue;if(Ue.setupElevationDraw(ee,_e,{useMeterToDem:!0}),Ps(v,t,X,H,o,Ue),!H.centroidVertexBuffer){const Oe=_e.attributes.a_centroid_pos;Oe!==void 0&&T.vertexAttrib2f(Oe,0,0)}}}k&&(l.context.activeTexture.set(T.TEXTURE0),ee.imageAtlasTexture.bind(T.LINEAR,T.CLAMP_TO_EDGE),re.updatePaintBuffers(O));const Ae=S.constantOr(null);if(Ae&&ee.imageAtlas){const Ue=ee.imageAtlas,Oe=Ue.patternPositions[Ae.to.toString()],st=Ue.patternPositions[Ae.from.toString()];Oe&&st&&re.setConstantPatternPositions(Oe,st)}const Se=l.translatePosMatrix(X.projMatrix,ee,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),Ce=C.projection.createInversionMatrix(C,X.canonical),Ge=o.paint.get("fill-extrusion-vertical-gradient"),ge=k?Ia(Se,l,Ge,V,X,O,ee,N,Q,Z,Ce):Sa(Se,l,Ge,V,X,N,Q,Z,Ce);l.prepareDrawProgram(v,_e,X.toUnwrapped()),_e.draw(v,v.gl.TRIANGLES,f,m,g,s.CullFaceMode.backCCW,ge,o.id,H.layoutVertexBuffer,H.indexBuffer,H.segments,o.paint,l.transform.zoom,re,l.terrain?H.centroidVertexBuffer:null,R?H.layoutVertexExtBuffer:null)}}function Ps(l,t,o,u,f,m){const g=[Z=>{let Y=Z.canonical.x-1,X=Z.wrap;return Y<0&&(Y=(1<<Z.canonical.z)-1,X--),new s.OverscaledTileID(Z.overscaledZ,X,Z.canonical.z,Y,Z.canonical.y)},Z=>{let Y=Z.canonical.x+1,X=Z.wrap;return Y===1<<Z.canonical.z&&(Y=0,X++),new s.OverscaledTileID(Z.overscaledZ,X,Z.canonical.z,Y,Z.canonical.y)},Z=>new s.OverscaledTileID(Z.overscaledZ,Z.wrap,Z.canonical.z,Z.canonical.x,(Z.canonical.y===0?1<<Z.canonical.z:Z.canonical.y)-1),Z=>new s.OverscaledTileID(Z.overscaledZ,Z.wrap,Z.canonical.z,Z.canonical.x,Z.canonical.y===(1<<Z.canonical.z)-1?0:Z.canonical.y+1)],v=Z=>{const Y=t.getSource().minzoom,X=H=>{const re=t.getTileByID(H);if(re&&re.hasData())return re.getBucket(f)},ee=[0,-1,1];for(const H of ee){if(Z.overscaledZ+H<Y)continue;const re=X(Z.calculateScaledKey(Z.overscaledZ+H));if(re)return re}},T=[0,0,0],C=(Z,Y)=>(T[0]=Math.min(Z.min.y,Y.min.y),T[1]=Math.max(Z.max.y,Y.max.y),T[2]=s.EXTENT-Y.min.x>Z.max.x?Y.min.x-s.EXTENT:Z.max.x,T),S=(Z,Y)=>(T[0]=Math.min(Z.min.x,Y.min.x),T[1]=Math.max(Z.max.x,Y.max.x),T[2]=s.EXTENT-Y.min.y>Z.max.y?Y.min.y-s.EXTENT:Z.max.y,T),k=[(Z,Y)=>C(Z,Y),(Z,Y)=>C(Y,Z),(Z,Y)=>S(Z,Y),(Z,Y)=>S(Y,Z)],O=new s.pointGeometry(0,0);let V,N,R;const Q=(Z,Y,X,ee,H)=>{const re=[[ee?X:Z,ee?Z:X,0],[ee?X:Y,ee?Y:X,0]],_e=H<0?s.EXTENT+H:H,Ae=[ee?_e:(Z+Y)/2,ee?(Z+Y)/2:_e,0];return X===0&&H<0||X!==0&&H>0?m.getForTilePoints(R,[Ae],!0,N):re.push(Ae),m.getForTilePoints(o,re,!0,V),Math.max(re[0][2],re[1][2],Ae[2])/m.exaggeration()};for(let Z=0;Z<4;Z++){const Y=(Z<2?1:5)-Z,X=u.borders[Z];if(X.length===0)continue;const ee=R=g[Z](o),H=v(ee);if(!(H&&H instanceof s.FillExtrusionBucket&&H.enableTerrain)||u.borderDoneWithNeighborZ[Z]===H.canonical.z&&H.borderDoneWithNeighborZ[Y]===u.canonical.z||(N=m.findDEMTileFor(ee),!N||!N.dem))continue;if(!V){const Se=m.findDEMTileFor(o);if(!Se||!Se.dem)return;V=Se}const re=H.borders[Y];let _e=0;const Ae=H.borderDoneWithNeighborZ[Y]!==u.canonical.z;if(u.canonical.z===H.canonical.z){for(let Se=0;Se<X.length;Se++){const Ce=u.featuresOnBorder[X[Se]],Ge=Ce.borders[Z];let ge;for(;_e<re.length&&(ge=H.featuresOnBorder[re[_e]],!(ge.borders[Y][1]>Ge[0]+3));)Ae&&H.encodeCentroid(void 0,ge,!1),_e++;if(ge&&_e<re.length){const Ue=_e;let Oe=0;for(;!(ge.borders[Y][0]>Ge[1]-3)&&(Oe++,++_e!==re.length);)ge=H.featuresOnBorder[re[_e]];if(ge=H.featuresOnBorder[re[Ue]],Ce.intersectsCount()>1||ge.intersectsCount()>1||Oe!==1){Oe!==1&&(_e=Ue),u.encodeCentroid(void 0,Ce,!1),Ae&&H.encodeCentroid(void 0,ge,!1);continue}const st=k[Z](Ce,ge),be=Z%2?s.EXTENT-1:0;O.x=Q(st[0],Math.min(s.EXTENT-1,st[1]),be,Z<2,st[2]),O.y=0,u.encodeCentroid(O,Ce,!1),Ae&&H.encodeCentroid(O,ge,!1)}else u.encodeCentroid(void 0,Ce,!1)}u.borderDoneWithNeighborZ[Z]=H.canonical.z,u.needsCentroidUpdate=!0,Ae&&(H.borderDoneWithNeighborZ[Y]=u.canonical.z,H.needsCentroidUpdate=!0)}else{for(const Se of X)u.encodeCentroid(void 0,u.featuresOnBorder[Se],!1);if(Ae){for(const Se of re)H.encodeCentroid(void 0,H.featuresOnBorder[Se],!1);H.borderDoneWithNeighborZ[Y]=u.canonical.z,H.needsCentroidUpdate=!0}u.borderDoneWithNeighborZ[Z]=H.canonical.z,u.needsCentroidUpdate=!0}}(u.needsCentroidUpdate||!u.centroidVertexBuffer&&u.centroidVertexArray.length!==0)&&u.uploadCentroid(l)}const Xl=new s.Color(1,0,0,1),Ql=new s.Color(0,1,0,1),Su=new s.Color(0,0,1,1),La=new s.Color(1,0,1,1),Ra=new s.Color(0,1,1,1);function $e(l,t,o,u){Bs(l,0,t+o/2,l.transform.width,o,u)}function Ur(l,t,o,u){Bs(l,t-o/2,0,o,l.transform.height,u)}function Bs(l,t,o,u,f,m){const g=l.context,v=g.gl;v.enable(v.SCISSOR_TEST),v.scissor(t*s.exported.devicePixelRatio,o*s.exported.devicePixelRatio,u*s.exported.devicePixelRatio,f*s.exported.devicePixelRatio),g.clear({color:m}),v.disable(v.SCISSOR_TEST)}function Iu(l,t,o){const u=l.context,f=u.gl,m=l.transform.projection.name==="globe",g=o.projMatrix,v=l.useProgram("debug",null,m?["PROJECTION_GLOBE_VIEW"]:null),T=t.getTileByID(o.key);l.terrain&&l.terrain.setupElevationDraw(T,v);const C=s.DepthMode.disabled,S=s.StencilMode.disabled,k=l.colorModeForRenderPass(),O="$debug";u.activeTexture.set(f.TEXTURE0),l.emptyTexture.bind(f.LINEAR,f.CLAMP_TO_EDGE),m?T._makeGlobeTileDebugBuffers(l.context,l.transform.projection):T._makeDebugTileBoundsBuffers(l.context,l.transform.projection);const V=T._tileDebugBuffer||l.debugBuffer,N=T._tileDebugIndexBuffer||l.debugIndexBuffer,R=T._tileDebugSegments||l.debugSegments;v.draw(u,f.LINE_STRIP,C,S,k,s.CullFaceMode.disabled,wu(g,s.Color.red),O,V,N,R,null,null,null,T._globeTileDebugBorderBuffer);const Q=T.latestRawTileData,Z=Math.floor((Q&&Q.byteLength||0)/1024),Y=t.getTile(o).tileSize,X=512/Math.min(Y,512)*(o.overscaledZ/l.transform.zoom)*.5;let ee=o.canonical.toString();o.overscaledZ!==o.canonical.z&&(ee+=` => ${o.overscaledZ}`),function(Ae,Se){Ae.initDebugOverlayCanvas();const Ce=Ae.debugOverlayCanvas,Ge=Ae.context.gl,ge=Ae.debugOverlayCanvas.getContext("2d");ge.clearRect(0,0,Ce.width,Ce.height),ge.shadowColor="white",ge.shadowBlur=2,ge.lineWidth=1.5,ge.strokeStyle="white",ge.textBaseline="top",ge.font="bold 36px Open Sans, sans-serif",ge.fillText(Se,5,5),ge.strokeText(Se,5,5),Ae.debugOverlayTexture.update(Ce),Ae.debugOverlayTexture.bind(Ge.LINEAR,Ge.CLAMP_TO_EDGE)}(l,`${ee} ${Z}kb`);const H=T._tileDebugTextBuffer||l.debugBuffer,re=T._tileDebugTextIndexBuffer||l.quadTriangleIndexBuffer,_e=T._tileDebugTextSegments||l.debugSegments;v.draw(u,f.TRIANGLES,C,S,s.ColorMode.alphaBlended,s.CullFaceMode.disabled,wu(g,s.Color.transparent,X),O,H,re,_e,null,null,null,T._globeTileDebugTextBuffer)}const zu=s.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:qo}=zu;function wn(l,t,o,u){l.emplaceBack(t,o,u)}class Ls{constructor(t){this.vertexArray=new s.StructArrayLayout3f12,this.indices=new s.StructArrayLayout3ui6,wn(this.vertexArray,-1,-1,1),wn(this.vertexArray,1,-1,1),wn(this.vertexArray,-1,1,1),wn(this.vertexArray,1,1,1),wn(this.vertexArray,-1,-1,-1),wn(this.vertexArray,1,-1,-1),wn(this.vertexArray,-1,1,-1),wn(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=t.createVertexBuffer(this.vertexArray,qo),this.indexBuffer=t.createIndexBuffer(this.indices),this.segment=s.SegmentVector.simpleSegment(0,0,36,12)}}function On(l,t,o,u,f,m){const g=l.gl,v=t.paint.get("sky-atmosphere-color"),T=t.paint.get("sky-atmosphere-halo-color"),C=t.paint.get("sky-atmosphere-sun-intensity"),S=((k,O,V,N,R)=>({u_matrix_3f:k,u_sun_direction:O,u_sun_intensity:V,u_color_tint_r:[N.r,N.g,N.b,N.a],u_color_tint_m:[R.r,R.g,R.b,R.a],u_luminance:5e-5}))(s.fromMat4(s.create$1(),u),f,C,v,T);g.framebufferTexture2D(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.TEXTURE_CUBE_MAP_POSITIVE_X+m,t.skyboxTexture,0),o.draw(l,g.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,s.ColorMode.unblended,s.CullFaceMode.frontCW,S,"skyboxCapture",t.skyboxGeometry.vertexBuffer,t.skyboxGeometry.indexBuffer,t.skyboxGeometry.segment)}function Nn(l,t){return s.transformMat4(l,l,t)}const Kl={symbol:function(l,t,o,u,f){if(l.renderPass!=="translucent")return;const m=s.StencilMode.disabled,g=l.colorModeForRenderPass();o.layout.get("text-variable-anchor")&&function(v,T,C,S,k,O,V){const N=T.transform,R=k==="map",Q=O==="map";for(const Z of v){const Y=S.getTile(Z),X=Y.getBucket(C);if(!X||X.projection!==N.projection.name||!X.text||!X.text.segments.get().length)continue;const ee=s.evaluateSizeForZoom(X.textSizeData,N.zoom),H=T.transform.calculatePixelsToTileUnitsMatrix(Y),re=po(Z.projMatrix,Y.tileID.canonical,Q,R,T.transform,H),_e=C.layout.get("icon-text-fit")!=="none"&&X.hasIconData();if(ee){const Ae=Math.pow(2,N.zoom-Y.tileID.overscaledZ);bd(X,R,Q,V,s.symbolSize,N,re,Z,Ae,ee,_e,N.projection)}}}(u,l,o,t,o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),f),o.paint.get("icon-opacity").constantOr(1)!==0&&Yl(l,t,o,u,!1,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),o.layout.get("icon-rotation-alignment"),o.layout.get("icon-pitch-alignment"),o.layout.get("icon-keep-upright"),m,g),o.paint.get("text-opacity").constantOr(1)!==0&&Yl(l,t,o,u,!0,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),o.layout.get("text-keep-upright"),m,g),t.map.showCollisionBoxes&&(Cu(l,t,o,u,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),!0),Cu(l,t,o,u,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),!1))},circle:function(l,t,o,u){if(l.renderPass!=="translucent")return;const f=o.paint.get("circle-opacity"),m=o.paint.get("circle-stroke-width"),g=o.paint.get("circle-stroke-opacity"),v=o.layout.get("circle-sort-key").constantOr(1)!==void 0;if(f.constantOr(1)===0&&(m.constantOr(1)===0||g.constantOr(1)===0))return;const T=l.context,C=T.gl,S=l.transform,k=l.depthModeForSublayer(0,s.DepthMode.ReadOnly),O=s.StencilMode.disabled,V=l.colorModeForRenderPass(),N=S.projection.name==="globe",R=[s.mercatorXfromLng(S.center.lng),s.mercatorYfromLat(S.center.lat)],Q=[];for(let Y=0;Y<u.length;Y++){const X=u[Y],ee=t.getTile(X),H=ee.getBucket(o);if(!H)continue;const re=H.programConfigurations.get(o.id),_e=gd(o);N&&_e.push("PROJECTION_GLOBE_VIEW");const Ae=l.useProgram("circle",re,_e),Se=H.layoutVertexBuffer,Ce=H.globeExtVertexBuffer,Ge=H.indexBuffer,ge=S.projection.createInversionMatrix(S,X.canonical),Ue={programConfiguration:re,program:Ae,layoutVertexBuffer:Se,globeExtVertexBuffer:Ce,indexBuffer:Ge,uniformValues:Go(l,X,ee,ge,R,o),tile:ee};if(v){const Oe=H.segments.get();for(const st of Oe)Q.push({segments:new s.SegmentVector([st]),sortKey:st.sortKey,state:Ue})}else Q.push({segments:H.segments,sortKey:0,state:Ue})}v&&Q.sort((Y,X)=>Y.sortKey-X.sortKey);const Z={useDepthForOcclusion:!N};for(const Y of Q){const{programConfiguration:X,program:ee,layoutVertexBuffer:H,globeExtVertexBuffer:re,indexBuffer:_e,uniformValues:Ae,tile:Se}=Y.state,Ce=Y.segments;l.terrain&&l.terrain.setupElevationDraw(Se,ee,Z),l.prepareDrawProgram(T,ee,Se.tileID.toUnwrapped()),ee.draw(T,C.TRIANGLES,k,O,V,s.CullFaceMode.disabled,Ae,o.id,H,_e,Ce,o.paint,S.zoom,X,N?re:null)}},heatmap:function(l,t,o,u){if(o.paint.get("heatmap-opacity")!==0)if(l.renderPass==="offscreen"){const f=l.context,m=f.gl,g=s.StencilMode.disabled,v=new s.ColorMode([m.ONE,m.ONE],s.Color.transparent,[!0,!0,!0,!0]);(function(O,V,N){const R=O.gl;O.activeTexture.set(R.TEXTURE1),O.viewport.set([0,0,V.width/4,V.height/4]);let Q=N.heatmapFbo;if(Q)R.bindTexture(R.TEXTURE_2D,Q.colorAttachment.get()),O.bindFramebuffer.set(Q.framebuffer);else{const Z=R.createTexture();R.bindTexture(R.TEXTURE_2D,Z),R.texParameteri(R.TEXTURE_2D,R.TEXTURE_WRAP_S,R.CLAMP_TO_EDGE),R.texParameteri(R.TEXTURE_2D,R.TEXTURE_WRAP_T,R.CLAMP_TO_EDGE),R.texParameteri(R.TEXTURE_2D,R.TEXTURE_MIN_FILTER,R.LINEAR),R.texParameteri(R.TEXTURE_2D,R.TEXTURE_MAG_FILTER,R.LINEAR),Q=N.heatmapFbo=O.createFramebuffer(V.width/4,V.height/4,!1),function(Y,X,ee,H){const re=Y.gl;re.texImage2D(re.TEXTURE_2D,0,re.RGBA,X.width/4,X.height/4,0,re.RGBA,Y.extRenderToTextureHalfFloat?Y.extTextureHalfFloat.HALF_FLOAT_OES:re.UNSIGNED_BYTE,null),H.colorAttachment.set(ee)}(O,V,Z,Q)}})(f,l,o),f.clear({color:s.Color.transparent});const T=l.transform,C=T.projection.name==="globe",S=C?["PROJECTION_GLOBE_VIEW"]:null,k=[s.mercatorXfromLng(T.center.lng),s.mercatorYfromLat(T.center.lat)];for(let O=0;O<u.length;O++){const V=u[O];if(t.hasRenderableParent(V))continue;const N=t.getTile(V),R=N.getBucket(o);if(!R)continue;const Q=R.programConfigurations.get(o.id),Z=l.useProgram("heatmap",Q,S),{zoom:Y}=l.transform;l.terrain&&l.terrain.setupElevationDraw(N,Z),l.prepareDrawProgram(f,Z,V.toUnwrapped());const X=T.projection.createInversionMatrix(T,V.canonical);Z.draw(f,m.TRIANGLES,s.DepthMode.disabled,g,v,s.CullFaceMode.disabled,vd(l,V,N,X,k,Y,o.paint.get("heatmap-intensity")),o.id,R.layoutVertexBuffer,R.indexBuffer,R.segments,o.paint,l.transform.zoom,Q,C?R.globeExtVertexBuffer:null)}f.viewport.set([0,0,l.width,l.height])}else l.renderPass==="translucent"&&(l.context.setColorMode(l.colorModeForRenderPass()),function(f,m){const g=f.context,v=g.gl,T=m.heatmapFbo;if(!T)return;g.activeTexture.set(v.TEXTURE0),v.bindTexture(v.TEXTURE_2D,T.colorAttachment.get()),g.activeTexture.set(v.TEXTURE1);let C=m.colorRampTexture;C||(C=m.colorRampTexture=new s.Texture(g,m.colorRamp,v.RGBA)),C.bind(v.LINEAR,v.CLAMP_TO_EDGE),f.useProgram("heatmapTexture").draw(g,v.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,f.colorModeForRenderPass(),s.CullFaceMode.disabled,((S,k,O,V)=>({u_image:0,u_color_ramp:1,u_opacity:k.paint.get("heatmap-opacity")}))(0,m),m.id,f.viewportBuffer,f.quadTriangleIndexBuffer,f.viewportSegments,m.paint,f.transform.zoom)}(l,o))},line:function(l,t,o,u){if(l.renderPass!=="translucent")return;const f=o.paint.get("line-opacity"),m=o.paint.get("line-width");if(f.constantOr(1)===0||m.constantOr(1)===0)return;const g=l.depthModeForSublayer(0,s.DepthMode.ReadOnly),v=l.colorModeForRenderPass(),T=l.terrain&&l.terrain.renderingToTexture?1:s.exported.devicePixelRatio,C=o.paint.get("line-dasharray"),S=C.constantOr(1),k=o.layout.get("line-cap"),O=o.paint.get("line-pattern"),V=O.constantOr(1),N=o.paint.get("line-gradient"),R=o.getCrossfadeParameters(),Q=V?"linePattern":"line",Z=l.context,Y=Z.gl,X=(H=>{const re=[];jl(H)&&re.push("RENDER_LINE_DASH"),H.paint.get("line-gradient")&&re.push("RENDER_LINE_GRADIENT");const _e=H.paint.get("line-pattern").constantOr(1),Ae=H.paint.get("line-opacity").constantOr(1)!==1;return!_e&&Ae&&re.push("RENDER_LINE_ALPHA_DISCARD"),re})(o);let ee=X.includes("RENDER_LINE_ALPHA_DISCARD");l.terrain&&l.terrain.clipOrMaskOverlapStencilType()&&(ee=!1);for(const H of u){const re=t.getTile(H);if(V&&!re.patternsLoaded())continue;const _e=re.getBucket(o);if(!_e)continue;l.prepareDrawTile();const Ae=_e.programConfigurations.get(o.id),Se=l.useProgram(Q,Ae,X),Ce=O.constantOr(null);if(Ce&&re.imageAtlas){const be=re.imageAtlas,pt=be.patternPositions[Ce.to.toString()],gt=be.patternPositions[Ce.from.toString()];pt&&gt&&Ae.setConstantPatternPositions(pt,gt)}const Ge=C.constantOr(null),ge=k.constantOr(null);if(!V&&Ge&&ge&&re.lineAtlas){const be=re.lineAtlas,pt=be.getDash(Ge.to,ge),gt=be.getDash(Ge.from,ge);pt&&gt&&Ae.setConstantPatternPositions(pt,gt)}const Ue=l.terrain?H.projMatrix:null,Oe=V?Gl(l,re,o,R,Ue,T):Ad(l,re,o,R,Ue,_e.lineClipsArray.length,T);if(N){const be=_e.gradients[o.id];let pt=be.texture;if(o.gradientVersion!==be.version){let gt=256;if(o.stepInterpolant){const rt=t.getSource().maxzoom,nt=H.canonical.z===rt?Math.ceil(1<<l.transform.maxZoom-H.canonical.z):1;gt=s.clamp(s.nextPowerOfTwo(_e.maxLineLength/s.EXTENT*1024*nt),256,Z.maxTextureSize)}be.gradient=s.renderColorRamp({expression:o.gradientExpression(),evaluationKey:"lineProgress",resolution:gt,image:be.gradient||void 0,clips:_e.lineClipsArray}),be.texture?be.texture.update(be.gradient):be.texture=new s.Texture(Z,be.gradient,Y.RGBA),be.version=o.gradientVersion,pt=be.texture}Z.activeTexture.set(Y.TEXTURE1),pt.bind(o.stepInterpolant?Y.NEAREST:Y.LINEAR,Y.CLAMP_TO_EDGE)}S&&(Z.activeTexture.set(Y.TEXTURE0),re.lineAtlasTexture.bind(Y.LINEAR,Y.REPEAT),Ae.updatePaintBuffers(R)),V&&(Z.activeTexture.set(Y.TEXTURE0),re.imageAtlasTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),Ae.updatePaintBuffers(R)),l.prepareDrawProgram(Z,Se,H.toUnwrapped());const st=be=>{Se.draw(Z,Y.TRIANGLES,g,be,v,s.CullFaceMode.disabled,Oe,o.id,_e.layoutVertexBuffer,_e.indexBuffer,_e.segments,o.paint,l.transform.zoom,Ae,_e.layoutVertexBuffer2)};if(ee){const be=l.stencilModeForClipping(H).ref;be===0&&l.terrain&&Z.clear({stencil:0});const pt={func:Y.EQUAL,mask:255};Oe.u_alpha_discard_threshold=.8,st(new s.StencilMode(pt,be,255,Y.KEEP,Y.KEEP,Y.INVERT)),Oe.u_alpha_discard_threshold=0,st(new s.StencilMode(pt,be,255,Y.KEEP,Y.KEEP,Y.KEEP))}else st(l.stencilModeForClipping(H))}ee&&(l.resetStencilClippingMasks(),l.terrain&&Z.clear({stencil:0}))},fill:function(l,t,o,u){const f=o.paint.get("fill-color"),m=o.paint.get("fill-opacity");if(m.constantOr(1)===0)return;const g=l.colorModeForRenderPass(),v=o.paint.get("fill-pattern"),T=l.opaquePassEnabledForLayer()&&!v.constantOr(1)&&f.constantOr(s.Color.transparent).a===1&&m.constantOr(0)===1?"opaque":"translucent";if(l.renderPass===T){const C=l.depthModeForSublayer(1,l.renderPass==="opaque"?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly);Ba(l,t,o,u,C,g,!1)}if(l.renderPass==="translucent"&&o.paint.get("fill-antialias")){const C=l.depthModeForSublayer(o.getPaintProperty("fill-outline-color")?2:0,s.DepthMode.ReadOnly);Ba(l,t,o,u,C,g,!0)}},"fill-extrusion":function(l,t,o,u){const f=o.paint.get("fill-extrusion-opacity");if(f!==0&&l.renderPass==="translucent"){const m=new s.DepthMode(l.context.gl.LEQUAL,s.DepthMode.ReadWrite,l.depthRangeFor3D);if(f!==1||o.paint.get("fill-extrusion-pattern").constantOr(1))Zo(l,t,o,u,m,s.StencilMode.disabled,s.ColorMode.disabled),Zo(l,t,o,u,m,l.stencilModeFor3D(),l.colorModeForRenderPass()),l.resetStencilClippingMasks();else{const g=l.colorModeForRenderPass();Zo(l,t,o,u,m,s.StencilMode.disabled,g)}}},hillshade:function(l,t,o,u){if(l.renderPass!=="offscreen"&&l.renderPass!=="translucent")return;const f=l.context,m=l.depthModeForSublayer(0,s.DepthMode.ReadOnly),g=l.colorModeForRenderPass(),v=l.terrain&&l.terrain.renderingToTexture,[T,C]=l.renderPass!=="translucent"||v?[{},u]:l.stencilConfigForOverlap(u);for(const S of C){const k=t.getTile(S);if(k.needsHillshadePrepare&&l.renderPass==="offscreen")Rl(l,k,o,m,s.StencilMode.disabled,g);else if(l.renderPass==="translucent"){const O=v&&l.terrain?l.terrain.stencilModeForRTTOverlap(S):T[S.overscaledZ];yu(l,S,k,o,m,O,g)}}f.viewport.set([0,0,l.width,l.height]),l.resetStencilClippingMasks()},raster:function(l,t,o,u,f,m){if(l.renderPass!=="translucent"||o.paint.get("raster-opacity")===0||!u.length)return;const g=l.context,v=g.gl,T=t.getSource(),C=l.useProgram("raster"),S=l.colorModeForRenderPass(),k=l.terrain&&l.terrain.renderingToTexture,[O,V]=T instanceof ne||k?[{},u]:l.stencilConfigForOverlap(u),N=V[V.length-1].overscaledZ,R=!l.options.moving;for(const Q of V){const Z=k?s.DepthMode.disabled:l.depthModeForSublayer(Q.overscaledZ-N,o.paint.get("raster-opacity")===1?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly,v.LESS),Y=Q.toUnwrapped(),X=t.getTile(Q);if(k&&(!X||!X.hasData()))continue;const ee=k?Q.projMatrix:l.transform.calculateProjMatrix(Y,R),H=l.terrain&&k?l.terrain.stencilModeForRTTOverlap(Q):O[Q.overscaledZ],re=m?0:o.paint.get("raster-fade-duration");X.registerFadeDuration(re);const _e=t.findLoadedParent(Q,0),Ae=Nl(X,_e,t,l.transform,re);let Se,Ce;l.terrain&&l.terrain.prepareDrawTile();const Ge=o.paint.get("raster-resampling")==="nearest"?v.NEAREST:v.LINEAR;g.activeTexture.set(v.TEXTURE0),X.texture.bind(Ge,v.CLAMP_TO_EDGE),g.activeTexture.set(v.TEXTURE1),_e?(_e.texture.bind(Ge,v.CLAMP_TO_EDGE),Se=Math.pow(2,_e.tileID.overscaledZ-X.tileID.overscaledZ),Ce=[X.tileID.canonical.x*Se%1,X.tileID.canonical.y*Se%1]):X.texture.bind(Ge,v.CLAMP_TO_EDGE);const ge=Tu(ee,Ce||[0,0],Se||1,Ae,o,T instanceof ne?T.perspectiveTransform:[0,0]);if(l.prepareDrawProgram(g,C,Y),T instanceof ne)T.boundsBuffer&&T.boundsSegments&&C.draw(g,v.TRIANGLES,Z,s.StencilMode.disabled,S,s.CullFaceMode.disabled,ge,o.id,T.boundsBuffer,l.quadTriangleIndexBuffer,T.boundsSegments);else{const{tileBoundsBuffer:Ue,tileBoundsIndexBuffer:Oe,tileBoundsSegments:st}=l.getTileBoundsBuffers(X);C.draw(g,v.TRIANGLES,Z,H,S,s.CullFaceMode.disabled,ge,o.id,Ue,Oe,st)}}l.resetStencilClippingMasks()},background:function(l,t,o,u){const f=o.paint.get("background-color"),m=o.paint.get("background-opacity");if(m===0)return;const g=l.context,v=g.gl,T=l.transform,C=T.tileSize,S=o.paint.get("background-pattern");if(l.isPatternMissing(S))return;const k=!S&&f.a===1&&m===1&&l.opaquePassEnabledForLayer()?"opaque":"translucent";if(l.renderPass!==k)return;const O=s.StencilMode.disabled,V=l.depthModeForSublayer(0,k==="opaque"?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly),N=l.colorModeForRenderPass(),R=l.useProgram(S?"backgroundPattern":"background");let Q,Z=u;Z||(Q=l.getBackgroundTiles(),Z=Object.values(Q).map(X=>X.tileID)),S&&(g.activeTexture.set(v.TEXTURE0),l.imageManager.bind(l.context));const Y=o.getCrossfadeParameters();for(const X of Z){const ee=X.toUnwrapped(),H=u?X.projMatrix:l.transform.calculateProjMatrix(ee);l.prepareDrawTile();const re=t?t.getTile(X):Q?Q[X.key]:new s.Tile(X,C,T.zoom,l),_e=S?Wl(H,m,l,S,{tileID:X,tileSize:C},Y):Eu(H,m,f);l.prepareDrawProgram(g,R,ee);const{tileBoundsBuffer:Ae,tileBoundsIndexBuffer:Se,tileBoundsSegments:Ce}=l.getTileBoundsBuffers(re);R.draw(g,v.TRIANGLES,V,O,N,s.CullFaceMode.disabled,_e,o.id,Ae,Se,Ce)}},sky:function(l,t,o){const u=l.transform,f=u.projection.name==="mercator"||u.projection.name==="globe"?1:s.smoothstep(7,8,u.zoom),m=o.paint.get("sky-opacity")*f;if(m===0)return;const g=l.context,v=o.paint.get("sky-type"),T=new s.DepthMode(g.gl.LEQUAL,s.DepthMode.ReadOnly,[0,1]),C=l.frameCounter/1e3%1;v==="atmosphere"?l.renderPass==="offscreen"?o.needsSkyboxCapture(l)&&(function(S,k,O,V){const N=S.context,R=N.gl;let Q=k.skyboxFbo;if(!Q){Q=k.skyboxFbo=N.createFramebuffer(32,32,!1),k.skyboxGeometry=new Ls(N),k.skyboxTexture=N.gl.createTexture(),R.bindTexture(R.TEXTURE_CUBE_MAP,k.skyboxTexture),R.texParameteri(R.TEXTURE_CUBE_MAP,R.TEXTURE_WRAP_S,R.CLAMP_TO_EDGE),R.texParameteri(R.TEXTURE_CUBE_MAP,R.TEXTURE_WRAP_T,R.CLAMP_TO_EDGE),R.texParameteri(R.TEXTURE_CUBE_MAP,R.TEXTURE_MIN_FILTER,R.LINEAR),R.texParameteri(R.TEXTURE_CUBE_MAP,R.TEXTURE_MAG_FILTER,R.LINEAR);for(let ee=0;ee<6;++ee)R.texImage2D(R.TEXTURE_CUBE_MAP_POSITIVE_X+ee,0,R.RGBA,32,32,0,R.RGBA,R.UNSIGNED_BYTE,null)}N.bindFramebuffer.set(Q.framebuffer),N.viewport.set([0,0,32,32]);const Z=k.getCenter(S,!0),Y=S.useProgram("skyboxCapture"),X=new Float64Array(16);s.identity(X),s.rotateY(X,X,.5*-Math.PI),On(N,k,Y,X,Z,0),s.identity(X),s.rotateY(X,X,.5*Math.PI),On(N,k,Y,X,Z,1),s.identity(X),s.rotateX(X,X,.5*-Math.PI),On(N,k,Y,X,Z,2),s.identity(X),s.rotateX(X,X,.5*Math.PI),On(N,k,Y,X,Z,3),s.identity(X),On(N,k,Y,X,Z,4),s.identity(X),s.rotateY(X,X,Math.PI),On(N,k,Y,X,Z,5),N.viewport.set([0,0,S.width,S.height])}(l,o),o.markSkyboxValid(l)):l.renderPass==="sky"&&function(S,k,O,V,N){const R=S.context,Q=R.gl,Z=S.transform,Y=S.useProgram("skybox");R.activeTexture.set(Q.TEXTURE0),Q.bindTexture(Q.TEXTURE_CUBE_MAP,k.skyboxTexture);const X=((ee,H,re,_e,Ae)=>({u_matrix:ee,u_sun_direction:H,u_cubemap:0,u_opacity:_e,u_temporal_offset:Ae}))(Z.skyboxMatrix,k.getCenter(S,!1),0,V,N);S.prepareDrawProgram(R,Y),Y.draw(R,Q.TRIANGLES,O,s.StencilMode.disabled,S.colorModeForRenderPass(),s.CullFaceMode.backCW,X,"skybox",k.skyboxGeometry.vertexBuffer,k.skyboxGeometry.indexBuffer,k.skyboxGeometry.segment)}(l,o,T,m,C):v==="gradient"&&l.renderPass==="sky"&&function(S,k,O,V,N){const R=S.context,Q=R.gl,Z=S.transform,Y=S.useProgram("skyboxGradient");k.skyboxGeometry||(k.skyboxGeometry=new Ls(R)),R.activeTexture.set(Q.TEXTURE0);let X=k.colorRampTexture;X||(X=k.colorRampTexture=new s.Texture(R,k.colorRamp,Q.RGBA)),X.bind(Q.LINEAR,Q.CLAMP_TO_EDGE);const ee=((H,re,_e,Ae,Se)=>({u_matrix:H,u_color_ramp:0,u_center_direction:re,u_radius:s.degToRad(_e),u_opacity:Ae,u_temporal_offset:Se}))(Z.skyboxMatrix,k.getCenter(S,!1),k.paint.get("sky-gradient-radius"),V,N);S.prepareDrawProgram(R,Y),Y.draw(R,Q.TRIANGLES,O,s.StencilMode.disabled,S.colorModeForRenderPass(),s.CullFaceMode.backCW,ee,"skyboxGradient",k.skyboxGeometry.vertexBuffer,k.skyboxGeometry.indexBuffer,k.skyboxGeometry.segment)}(l,o,T,m,C)},debug:function(l,t,o){for(let u=0;u<o.length;u++)Iu(l,t,o[u])},custom:function(l,t,o){const u=l.context,f=o.implementation;if(l.transform.projection.unsupportedLayers&&l.transform.projection.unsupportedLayers.includes("custom"))s.warnOnce("Custom layers are not yet supported with non-mercator projections. Use mercator to enable custom layers.");else if(l.renderPass==="offscreen"){const m=f.prerender;m&&(l.setCustomLayerDefaults(),u.setColorMode(l.colorModeForRenderPass()),m.call(f,u.gl,l.transform.customLayerMatrix()),u.setDirty(),l.setBaseState())}else if(l.renderPass==="translucent"){l.setCustomLayerDefaults(),u.setColorMode(l.colorModeForRenderPass()),u.setStencilMode(s.StencilMode.disabled);const m=f.renderingMode==="3d"?new s.DepthMode(l.context.gl.LEQUAL,s.DepthMode.ReadWrite,l.depthRangeFor3D):l.depthModeForSublayer(0,s.DepthMode.ReadOnly);u.setDepthMode(m),f.render(u.gl,l.transform.customLayerMatrix()),u.setDirty(),l.setBaseState(),u.bindFramebuffer.set(null)}}};class Du{constructor(t,o){this.context=new D(t),this.transform=o,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=s.SourceCache.maxUnderzooming+s.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ba,this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this._tileClippingMaskIDs=new Map,this._skippedStencilTileIDs=new Set}updateTerrain(t,o){const u=!!t&&!!t.terrain&&this.transform.projection.supportsTerrain;if(!(u||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Mr(this,t));const f=this._terrain;this.transform.elevation=u?f:null,f.update(t,this.transform,o)}_updateFog(t){const o=t.fog;if(!o||o.getOpacity(this.transform.pitch)<1||o.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[u,f]=o.getFovAdjustedRange(this.transform._fov);if(u>f)return void(this.transform.fogCullDistSq=null);const m=u+.78*(f-u);this.transform.fogCullDistSq=m*m}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(t,o){if(this.width=t*s.exported.devicePixelRatio,this.height=o*s.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const u of this.style.order)this.style._layers[u].resize()}setup(){const t=this.context,o=new s.StructArrayLayout2i4;o.emplaceBack(0,0),o.emplaceBack(s.EXTENT,0),o.emplaceBack(0,s.EXTENT),o.emplaceBack(s.EXTENT,s.EXTENT),this.tileExtentBuffer=t.createVertexBuffer(o,s.posAttributes.members),this.tileExtentSegments=s.SegmentVector.simpleSegment(0,0,4,2);const u=new s.StructArrayLayout2i4;u.emplaceBack(0,0),u.emplaceBack(s.EXTENT,0),u.emplaceBack(0,s.EXTENT),u.emplaceBack(s.EXTENT,s.EXTENT),this.debugBuffer=t.createVertexBuffer(u,s.posAttributes.members),this.debugSegments=s.SegmentVector.simpleSegment(0,0,4,5);const f=new s.StructArrayLayout2i4;f.emplaceBack(-1,-1),f.emplaceBack(1,-1),f.emplaceBack(-1,1),f.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(f,s.posAttributes.members),this.viewportSegments=s.SegmentVector.simpleSegment(0,0,4,2);const m=new s.StructArrayLayout4i8;m.emplaceBack(0,0,0,0),m.emplaceBack(s.EXTENT,0,s.EXTENT,0),m.emplaceBack(0,s.EXTENT,0,s.EXTENT),m.emplaceBack(s.EXTENT,s.EXTENT,s.EXTENT,s.EXTENT),this.mercatorBoundsBuffer=t.createVertexBuffer(m,s.boundsAttributes.members),this.mercatorBoundsSegments=s.SegmentVector.simpleSegment(0,0,4,2);const g=new s.StructArrayLayout3ui6;g.emplaceBack(0,1,2),g.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(g);const v=new s.StructArrayLayout1ui2;for(const C of[0,1,3,2,0])v.emplaceBack(C);this.debugIndexBuffer=t.createIndexBuffer(v),this.emptyTexture=new s.Texture(t,new s.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),t.gl.RGBA),this.identityMat=s.create();const T=this.context.gl;this.stencilClearMode=new s.StencilMode({func:T.ALWAYS,mask:0},0,255,T.ZERO,T.ZERO,T.ZERO),this.loadTimeStamps.push(s.window.performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(t){return t._makeTileBoundsBuffers(this.context,this.transform.projection),t._tileBoundsBuffer?{tileBoundsBuffer:t._tileBoundsBuffer,tileBoundsIndexBuffer:t._tileBoundsIndexBuffer,tileBoundsSegments:t._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const t=this.context,o=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs.clear(),this._skippedStencilTileIDs.clear(),this.useProgram("clippingMask").draw(t,o.TRIANGLES,s.DepthMode.disabled,this.stencilClearMode,s.ColorMode.disabled,s.CullFaceMode.disabled,Ca(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs.clear(),this._skippedStencilTileIDs.clear())}_renderTileClippingMasks(t,o,u){if(!o||this.currentStencilSource===o.id||!t.isTileClipped()||!u||u.length===0)return;const f=[];let m=!1;if(this._tileClippingMaskIDs&&!this.terrain){for(const S of u)if(this._tileClippingMaskIDs.has(S.key)||(m=!0),this._skippedStencilTileIDs.has(S.key)){if(!o.getTile(S).getBucket(t))continue;this._skippedStencilTileIDs.delete(S.key),f.push(S)}if(!m&&f.length===0)return}const g=this.context,v=g.gl;g.setColorMode(s.ColorMode.disabled),g.setDepthMode(s.DepthMode.disabled);const T=this.useProgram("clippingMask"),C=S=>{const k=o.getTile(S),{tileBoundsBuffer:O,tileBoundsIndexBuffer:V,tileBoundsSegments:N}=this.getTileBoundsBuffers(k);T.draw(g,v.TRIANGLES,s.DepthMode.disabled,new s.StencilMode({func:v.GREATER,mask:255},this._tileClippingMaskIDs.get(S.key)||0,255,v.KEEP,v.KEEP,v.REPLACE),s.ColorMode.disabled,s.CullFaceMode.disabled,Ca(S.projMatrix),"$clipping",O,V,N)};if(!m&&f.length>0)for(const S of f)C(S);else{(this._tileClippingMaskIDs.size===0||this.nextStencilID+u.length>256)&&this.clearStencil(),this._tileClippingMaskIDs.clear(),this._skippedStencilTileIDs.clear();for(const S of u)this._tileClippingMaskIDs.set(S.key,this.nextStencilID++),o.getTile(S).getBucket(t)?C(S):this._skippedStencilTileIDs.add(S.key)}this._skippedStencilTileIDs.size===0&&(this.currentStencilSource=o.id)}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,o=this.context.gl;return new s.StencilMode({func:o.NOTEQUAL,mask:255},t,255,o.KEEP,o.KEEP,o.REPLACE)}stencilModeForClipping(t){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(t);const o=this.context.gl;return new s.StencilMode({func:o.EQUAL,mask:255},this._tileClippingMaskIDs.get(t.key)||0,0,o.KEEP,o.KEEP,o.REPLACE)}stencilConfigForOverlap(t){const o=this.context.gl,u=t.sort((g,v)=>v.overscaledZ-g.overscaledZ),f=u[u.length-1].overscaledZ,m=u[0].overscaledZ-f+1;if(m>1){this.currentStencilSource=void 0,this.nextStencilID+m>256&&this.clearStencil();const g={};for(let v=0;v<m;v++)g[v+f]=new s.StencilMode({func:o.GEQUAL,mask:255},v+this.nextStencilID,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID+=m,[g,u]}return[{[f]:s.StencilMode.disabled},u]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new s.ColorMode([t.CONSTANT_COLOR,t.ONE],new s.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?s.ColorMode.unblended:s.ColorMode.alphaBlended}depthModeForSublayer(t,o,u){if(!this.opaquePassEnabledForLayer())return s.DepthMode.disabled;const f=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new s.DepthMode(u||this.context.gl.LEQUAL,o,[f,f])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,o){this.style=t,this.options=o,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(s.exported.now()),this.imageManager.beginFrame();const u=this.style.order,f=this.style._sourceCaches;for(const C in f){const S=f[C];S.used&&S.prepare(this.context)}const m={},g={},v={};for(const C in f){const S=f[C];m[C]=S.getVisibleCoordinates(),g[C]=m[C].slice().reverse(),v[C]=S.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let C=0;C<u.length;C++)if(this.style._layers[u[C]].is3D()){this.opaquePassCutoff=C;break}if(this.terrain&&(this.terrain.updateTileBinding(v),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new s.GlobeSharedBuffers(this.context)),!s.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const C of u){const S=this.style._layers[C],k=t._getLayerSourceCache(S);if(!S.hasOffscreenPass()||S.isHidden(this.transform.zoom))continue;const O=k?g[k.id]:void 0;(S.type==="custom"||S.isSky()||O&&O.length)&&this.renderLayer(this,k,S,O)}this.depthRangeFor3D=[0,1-(t.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);let T=s.Color.transparent;if(this.style.fog&&this.style.fog.getOpacity(this.transform.pitch)&&(T=this.style.fog.properties.get("color")),this.context.clear({color:o.showOverdrawInspector?s.Color.black:T,depth:1}),this.clearStencil(),this._showOverdrawInspector=o.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=u.length-1;this.currentLayer>=0;this.currentLayer--){const C=this.style._layers[u[this.currentLayer]],S=t._getLayerSourceCache(C);if(C.isSky())continue;const k=S?g[S.id]:void 0;this._renderTileClippingMasks(C,S,k),this.renderLayer(this,S,C,k)}if(this.renderPass="sky",(s.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<u.length;this.currentLayer++){const C=this.style._layers[u[this.currentLayer]],S=t._getLayerSourceCache(C);C.isSky()&&this.renderLayer(this,S,C,S?g[S.id]:void 0)}for(this.transform.projection.name==="globe"&&function(C){const S=C.context,k=S.gl,O=C.transform,V=new s.DepthMode(k.LEQUAL,s.DepthMode.ReadOnly,[0,1]),N=C.useProgram("globeAtmosphere"),R=O.centerOffset,Q=O._camera.getCameraToClipPerspective(O._fov,O.width/O.height,O._nearZ,O._farZ);Q[8]=2*-R.x/O.width,Q[9]=2*R.y/O.height;const Z=s.invert([],Q),Y=s.mul([],Z,O.projMatrix),X={u_frustum_tl:Nn([-1,1,1],Z),u_frustum_tr:Nn([1,1,1],Z),u_frustum_br:Nn([1,-1,1],Z),u_frustum_bl:Nn([-1,-1,1],Z),u_globe_pos:Nn([O.globeMatrix[12],O.globeMatrix[13],O.globeMatrix[14]],Y),u_globe_radius:O.worldSize/2/Math.PI-1,u_opacity:1-s.globeToMercatorTransition(O.zoom),u_fadeout_range:2,u_start_color:[1,1,1],u_end_color:[.0118,.7451,.9882]};C.prepareDrawProgram(S,N);const ee=C.globeSharedBuffers;ee&&N.draw(S,k.TRIANGLES,V,s.StencilMode.disabled,s.ColorMode.alphaBlended,s.CullFaceMode.backCW,X,"skybox",ee.atmosphereVertexBuffer,ee.atmosphereIndexBuffer,ee.atmosphereSegments)}(this),this.renderPass="translucent",this.currentLayer=0;this.currentLayer<u.length;){const C=this.style._layers[u[this.currentLayer]],S=t._getLayerSourceCache(C);if(C.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(C)){if(C.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const k=S?(C.type==="symbol"?v:g)[S.id]:void 0;this._renderTileClippingMasks(C,S,S?m[S.id]:void 0),this.renderLayer(this,S,C,k),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry){let C=null;s.values(this.style._layers).forEach(S=>{const k=t._getLayerSourceCache(S);k&&!S.isHidden(this.transform.zoom)&&(!C||C.getSource().maxzoom<k.getSource().maxzoom)&&(C=k)}),C&&this.options.showTileBoundaries&&Kl.debug(this,C,C.getVisibleCoordinates())}this.options.showPadding&&function(C){const S=C.transform.padding;$e(C,C.transform.height-(S.top||0),3,Xl),$e(C,S.bottom||0,3,Ql),Ur(C,S.left||0,3,Su),Ur(C,C.transform.width-(S.right||0),3,La);const k=C.transform.centerPoint;(function(O,V,N,R){Bs(O,V-1,N-10,2,20,R),Bs(O,V-10,N-1,20,2,R)})(C,k.x,C.transform.height-k.y,Ra)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(s.window.performance.now()),this.saveCanvasCopy())}renderLayer(t,o,u,f){u.isHidden(this.transform.zoom)||(u.type==="background"||u.type==="sky"||u.type==="custom"||f&&f.length)&&(this.id=u.id,this.gpuTimingStart(u),t.transform.projection.unsupportedLayers&&t.transform.projection.unsupportedLayers.includes(u.type)||Kl[u.type](t,o,u,f,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(t){if(!this.options.gpuTiming)return;const o=this.context.extTimerQuery;let u=this.gpuTimers[t.id];u||(u=this.gpuTimers[t.id]={calls:0,cpuTime:0,query:o.createQueryEXT()}),u.calls++,o.beginQueryEXT(o.TIME_ELAPSED_EXT,u.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const t=this.context.extTimerQuery;t.endQueryEXT(t.TIME_ELAPSED_EXT)}collectGpuTimers(){const t=this.gpuTimers;return this.gpuTimers={},t}queryGpuTimers(t){const o={};for(const u in t){const f=t[u],m=this.context.extTimerQuery,g=m.getQueryObjectEXT(f.query,m.QUERY_RESULT_EXT)/1e6;m.deleteQueryEXT(f.query),o[u]=g}return o}translatePosMatrix(t,o,u,f,m){if(!u[0]&&!u[1])return t;const g=m?f==="map"?this.transform.angle:0:f==="viewport"?-this.transform.angle:0;if(g){const C=Math.sin(g),S=Math.cos(g);u=[u[0]*S-u[1]*C,u[0]*C+u[1]*S]}const v=[m?u[0]:Ui(o,u[0],this.transform.zoom),m?u[1]:Ui(o,u[1],this.transform.zoom),0],T=new Float32Array(16);return s.translate(T,t,v),T}saveTileTexture(t){const o=this._tileTextures[t.size[0]];o?o.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const o=this._tileTextures[t];return o&&o.length>0?o.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const o=this.imageManager.getPattern(t.from.toString()),u=this.imageManager.getPattern(t.to.toString());return!o||!u}currentGlobalDefines(){const t=this.terrain&&this.terrain.renderingToTexture,o=this.style&&this.style.fog,u=[];return this.terrain&&!this.terrain.renderingToTexture&&u.push("TERRAIN"),o&&!t&&o.getOpacity(this.transform.pitch)!==0&&u.push("FOG"),t&&u.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&u.push("OVERDRAW_INSPECTOR"),u}useProgram(t,o,u){this.cache=this.cache||{};const f=u||[],m=this.currentGlobalDefines().concat(f),g=zs.cacheKey(t,m,o);return this.cache[g]||(this.cache[g]=new zs(this.context,t,Ms[t],o,ai[t],m)),this.cache[g]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=s.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new s.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(t,o,u){if(this.terrain&&this.terrain.renderingToTexture)return;const f=this.style.fog;if(f){const m=f.getOpacity(this.transform.pitch);m!==0&&o.setFogUniformValues(t,((g,v,T,C)=>{const S=v.properties.get("color"),k=g.frameCounter/1e3%1,O=[S.r/S.a,S.g/S.a,S.b/S.a,C];return{u_fog_matrix:T?g.transform.calculateFogTileMatrix(T):g.identityMat,u_fog_range:v.getFovAdjustedRange(g.transform._fov),u_fog_color:O,u_fog_horizon_blend:v.properties.get("horizon-blend"),u_fog_temporal_offset:k}})(this,f,u,m))}}setTileLoadedFlag(t){this.tileLoaded=t}saveCanvasCopy(){this.frameCopies.push(this.canvasCopy()),this.tileLoaded=!1}canvasCopy(){const t=this.context.gl,o=t.createTexture();return t.bindTexture(t.TEXTURE_2D,o),t.copyTexImage2D(t.TEXTURE_2D,0,t.RGBA,0,0,t.drawingBufferWidth,t.drawingBufferHeight,0),o}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const t=this.style&&this.style.fog;return!!t&&t.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const t=this._backgroundTiles,o=this._backgroundTiles={},u=this.transform.coveringTiles({tileSize:512});for(const f of u)o[f.key]=t[f.key]||new s.Tile(f,512,this.transform.tileZoom,this);return o}clearBackgroundTiles(){this._backgroundTiles={}}}class Un{constructor(t=0,o=0,u=0,f=0){if(isNaN(t)||t<0||isNaN(o)||o<0||isNaN(u)||u<0||isNaN(f)||f<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=o,this.left=u,this.right=f}interpolate(t,o,u){return o.top!=null&&t.top!=null&&(this.top=s.number(t.top,o.top,u)),o.bottom!=null&&t.bottom!=null&&(this.bottom=s.number(t.bottom,o.bottom,u)),o.left!=null&&t.left!=null&&(this.left=s.number(t.left,o.left,u)),o.right!=null&&t.right!=null&&(this.right=s.number(t.right,o.right,u)),this}getCenter(t,o){const u=s.clamp((this.left+t-this.right)/2,0,t),f=s.clamp((this.top+o-this.bottom)/2,0,o);return new s.pointGeometry(u,f)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new Un(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function ku(l,t){const o=s.getColumn(l,3);s.fromQuat(l,t),s.setColumn(l,3,o)}function $l(l,t){const o=s.identity$1([]);return s.rotateZ$1(o,o,-t),s.rotateX$1(o,o,-l),o}function Fa(l,t){const o=[l[0],l[1],0],u=[t[0],t[1],0];if(s.length(o)>=1e-15){const g=s.normalize([],o);s.scale$2(u,g,s.dot(u,g)),t[0]=u[0],t[1]=u[1]}const f=s.cross([],t,l);if(s.len(f)<1e-15)return null;const m=Math.atan2(-f[1],f[0]);return $l(Math.atan2(Math.sqrt(l[0]*l[0]+l[1]*l[1]),-l[2]),m)}class Rs{constructor(t,o){this.position=t,this.orientation=o}get position(){return this._position}set position(t){if(t){const o=t instanceof s.MercatorCoordinate?t:new s.MercatorCoordinate(t[0],t[1],t[2]);this._renderWorldCopies&&(o.x=s.wrap(o.x,0,1)),this._position=o}else this._position=null}lookAtPoint(t,o){if(this.orientation=null,!this.position)return;const u=this._elevation?this._elevation.getAtPointOrZero(s.MercatorCoordinate.fromLngLat(t)):0,f=this.position,m=s.MercatorCoordinate.fromLngLat(t,u),g=[m.x-f.x,m.y-f.y,m.z-f.z];o||(o=[0,0,1]),o[2]=Math.abs(o[2]),this.orientation=Fa(g,o)}setPitchBearing(t,o){this.orientation=$l(s.degToRad(t),s.degToRad(-o))}}class Fs{constructor(t,o){this._transform=s.identity([]),this.orientation=o,this.position=t}get mercatorPosition(){const t=this.position;return new s.MercatorCoordinate(t[0],t[1],t[2])}get position(){const t=s.getColumn(this._transform,3);return[t[0],t[1],t[2]]}set position(t){var o;t&&s.setColumn(this._transform,3,[(o=t)[0],o[1],o[2],1])}get orientation(){return this._orientation}set orientation(t){this._orientation=t||s.identity$1([]),t&&ku(this._transform,this._orientation)}getPitchBearing(){const t=this.forward(),o=this.right();return{bearing:Math.atan2(-o[1],o[0]),pitch:Math.atan2(Math.sqrt(t[0]*t[0]+t[1]*t[1]),-t[2])}}setPitchBearing(t,o){this._orientation=$l(t,o),ku(this._transform,this._orientation)}forward(){const t=s.getColumn(this._transform,2);return[-t[0],-t[1],-t[2]]}up(){const t=s.getColumn(this._transform,1);return[-t[0],-t[1],-t[2]]}right(){const t=s.getColumn(this._transform,0);return[t[0],t[1],t[2]]}getCameraToWorld(t,o){const u=new Float64Array(16);return s.invert(u,this.getWorldToCamera(t,o)),u}getWorldToCameraPosition(t,o,u){const f=this.position;s.scale$2(f,f,-t);const m=new Float64Array(16);return s.fromScaling(m,[u,u,u]),s.translate(m,m,f),m[10]*=o,m}getWorldToCamera(t,o){const u=new Float64Array(16),f=new Float64Array(4),m=this.position;return s.conjugate(f,this._orientation),s.scale$2(m,m,-t),s.fromQuat(u,f),s.translate(u,u,m),u[1]*=-1,u[5]*=-1,u[9]*=-1,u[13]*=-1,u[8]*=o,u[9]*=o,u[10]*=o,u[11]*=o,u}getCameraToClipPerspective(t,o,u,f){const m=new Float64Array(16);return s.perspective(m,t,o,u,f),m}getDistanceToElevation(t){const o=t===0?0:s.mercatorZfromAltitude(t,this.position[1]),u=this.forward();return(o-this.position[2])/u[2]}clone(){return new Fs([...this.position],[...this.orientation])}}function Jl(l,t){const o=Os(l),u=function(m,g,v,T,C){const S=new s.LngLat(v.lng-180*Vn,v.lat),k=new s.LngLat(v.lng+180*Vn,v.lat),O=m.project(S.lng,S.lat),V=m.project(k.lng,k.lat),N=-Math.atan2(V.y-O.y,V.x-O.x),R=s.MercatorCoordinate.fromLngLat(v);R.y=s.clamp(R.y,-.999975,.999975);const Q=R.toLngLat(),Z=m.project(Q.lng,Q.lat),Y=s.MercatorCoordinate.fromLngLat(Q);Y.x+=Vn;const X=Y.toLngLat(),ee=m.project(X.lng,X.lat),H=ic(ee.x-Z.x,ee.y-Z.y,N),re=s.MercatorCoordinate.fromLngLat(Q);re.y+=Vn;const _e=re.toLngLat(),Ae=m.project(_e.lng,_e.lat),Se=ic(Ae.x-Z.x,Ae.y-Z.y,N),Ce=Math.abs(H.x)/Math.abs(Se.y),Ge=s.identity([]);s.rotateZ(Ge,Ge,-N*(1-(C?0:T)));const ge=s.identity([]);return s.scale(ge,ge,[1,1-(1-Ce)*T,1]),ge[4]=-Se.x/Se.y*T,s.rotateZ(ge,ge,N),s.multiply$1(ge,Ge,ge),ge}(l.projection,0,l.center,o,t),f=ec(l);return s.scale(u,u,[f,f,1]),u}function ec(l){const t=l.projection,o=Os(l),u=tc(t,l.center),f=tc(t,s.LngLat.convert(t.center));return Math.pow(2,u*o+(1-o)*f)}function Os(l){const t=l.projection.range;if(!t)return 0;const o=Math.max(l.width,l.height),u=Math.log(o/1024)/Math.LN2;return s.smoothstep(t[0]+u,t[1]+u,l.zoom)}const Vn=1/4e4;function tc(l,t){const o=s.clamp(t.lat,-s.MAX_MERCATOR_LATITUDE,s.MAX_MERCATOR_LATITUDE),u=new s.LngLat(t.lng-180*Vn,o),f=new s.LngLat(t.lng+180*Vn,o),m=l.project(u.lng,o),g=l.project(f.lng,o),v=s.MercatorCoordinate.fromLngLat(u),T=s.MercatorCoordinate.fromLngLat(f),C=g.x-m.x,S=g.y-m.y,k=T.x-v.x,O=T.y-v.y,V=Math.sqrt((k*k+O*O)/(C*C+S*S));return Math.log(V)/Math.LN2}function ic(l,t,o){const u=Math.cos(o),f=Math.sin(o);return{x:l*u-t*f,y:l*f+t*u}}class Oa{constructor(t,o,u,f,m,g,v){this.tileSize=512,this._renderWorldCopies=m===void 0||m,this._minZoom=t||0,this._maxZoom=o||22,this._minPitch=u==null?0:u,this._maxPitch=f==null?60:f,this.setProjection(g),this.setMaxBounds(v),this.width=0,this.height=0,this._center=new s.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Un,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Fs,this._centerAltitude=0,this._centerAltitudeValidForExaggeration=0,this._averageElevation=0,this.cameraElevationReference="ground",this._projectionScaler=1,this._horizonShift=.1}clone(){const t=new Oa(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return t._elevation=this._elevation,t._centerAltitude=this._centerAltitude,t._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,t.tileSize=this.tileSize,t.width=this.width,t.height=this.height,t.cameraElevationReference=this.cameraElevationReference,t._center=this._center,t._setZoom(this.zoom),t._seaLevelZoom=this._seaLevelZoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._nearZ=this._nearZ,t._farZ=this._farZ,t._averageElevation=this._averageElevation,t._unmodified=this._unmodified,t._edgeInsets=this._edgeInsets.clone(),t._camera=this._camera.clone(),t._calcMatrices(),t.freezeTileCoverage=this.freezeTileCoverage,t}get elevation(){return this._elevation}set elevation(t){this._elevation!==t&&(this._elevation=t,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(t){const o=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||o)&&this._updateCameraOnTerrain(),(t||o)&&this._constrainCameraAltitude(),this._calcMatrices()}getProjection(){return s.pick(this.projection,["name","center","parallels"])}setProjection(t){t==null&&(t={name:"mercator"}),this.projectionOptions=t;const o=this.projection?this.getProjection():void 0;this.projection=s.getProjection(t);const u=this.getProjection();return J(o,u)?null:(this._calcMatrices(),u)}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this.tileSize*this.scale}get cameraWorldSize(){const t=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(t))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.cameraWorldSize)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new s.pointGeometry(this.width,this.height)}get bearing(){return s.wrap(this.rotation,-180,180)}set bearing(t){this.rotation=t}get rotation(){return-this.angle/Math.PI*180}set rotation(t){const o=-t*Math.PI/180;var u;this.angle!==o&&(this._unmodified=!1,this.angle=o,this._calcMatrices(),this.rotationMatrix=(u=new s.ARRAY_TYPE(4),s.ARRAY_TYPE!=Float32Array&&(u[1]=0,u[2]=0),u[0]=1,u[3]=1,u),function(f,m,g){var v=m[0],T=m[1],C=m[2],S=m[3],k=Math.sin(g),O=Math.cos(g);f[0]=v*O+C*k,f[1]=T*O+S*k,f[2]=v*-k+C*O,f[3]=T*-k+S*O}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(t){const o=s.clamp(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==o&&(this._unmodified=!1,this._pitch=o,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(t){this._averageElevation=t,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(t){const o=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==o&&(this._unmodified=!1,this._setZoom(o),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(t){this._zoom=t,this.scale=this.zoomScale(t),this.tileZoom=Math.floor(t),this.zoomFraction=t-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=0);const t=this._elevation;this._centerAltitude=t.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=t.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const t=this._elevation,o=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],u=this.horizonLineFromTop();let f=0,m=0;for(let g=0;g<o.length;g++){const v=new s.pointGeometry(o[g][0]*this.width,u+o[g][1]*(this.height-u)),T=t.pointCoordinate(v);if(!T)continue;const C=1/Math.hypot(T[0]-this._camera.position[0],T[1]-this._camera.position[1]);f+=T[3]*C,m+=C}return m===0?NaN:f/m}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const t=this._seaLevelZoom,o=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),u=this.pixelsPerMeter/this.worldSize*o,f=this._mercatorZfromZoom(t),m=this._mercatorZfromZoom(this._maxZoom),g=Math.max(f-u,m);this._setZoom(this._zoomFromMercatorZ(g))}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}computeZoomRelativeTo(t){const o=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,t.toAltitude()));let u;u=t.z<this._camera.position[2]?[o.x,o.y,o.z]:[t.x,t.y,t.z];const f=s.length(s.sub([],this._camera.position,u));return s.clamp(this._zoomFromMercatorZ(f),this._minZoom,this._maxZoom)}setFreeCameraOptions(t){if(!this.height||!t.position&&!t.orientation)return;this._updateCameraState();let o=!1;if(t.orientation&&!s.exactEquals(t.orientation,this._camera.orientation)&&(o=this._setCameraOrientation(t.orientation)),t.position){const u=[t.position.x,t.position.y,t.position.z];s.exactEquals$1(u,this._camera.position)||(this._setCameraPosition(u),o=!0)}o&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const t=this._camera.position,o=new Rs;return o.position=new s.MercatorCoordinate(t[0],t[1],t[2]),o.orientation=this._camera.orientation,o._elevation=this.elevation,o._renderWorldCopies=this.renderWorldCopies,o}_setCameraOrientation(t){if(!s.length$1(t))return!1;s.normalize$1(t,t);const o=s.transformQuat([],[0,0,-1],t),u=s.transformQuat([],[0,-1,0],t);if(u[2]<0)return!1;const f=Fa(o,u);return!!f&&(this._camera.orientation=f,!0)}_setCameraPosition(t){const o=this.zoomScale(this.minZoom)*this.tileSize,u=this.zoomScale(this.maxZoom)*this.tileSize,f=this.cameraToCenterDistance;t[2]=s.clamp(t[2],f/u,f/o),this._camera.position=t}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,o,u){this._unmodified=!1,this._edgeInsets.interpolate(t,o,u),this._constrain(),this._calcMatrices()}coveringZoomLevel(t){const o=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,o)}getVisibleUnwrappedCoordinates(t){const o=[new s.UnwrappedTileID(0,t)];if(this.renderWorldCopies){const u=this.pointCoordinate(new s.pointGeometry(0,0)),f=this.pointCoordinate(new s.pointGeometry(this.width,0)),m=this.pointCoordinate(new s.pointGeometry(this.width,this.height)),g=this.pointCoordinate(new s.pointGeometry(0,this.height)),v=Math.floor(Math.min(u.x,f.x,m.x,g.x)),T=Math.floor(Math.max(u.x,f.x,m.x,g.x)),C=1;for(let S=v-C;S<=T+C;S++)S!==0&&o.push(new s.UnwrappedTileID(S,t))}return o}coveringTiles(t){let o=this.coveringZoomLevel(t);const u=o,f=this.elevation&&!t.isTerrainDEM,m=this.projection.name==="mercator";if(t.minzoom!==void 0&&o<t.minzoom)return[];t.maxzoom!==void 0&&o>t.maxzoom&&(o=t.maxzoom);const g=this.locationCoordinate(this.center),v=this.center.lat,T=1<<o,C=[T*g.x,T*g.y,0],S=this.projection.name==="globe",k=!S,O=s.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,o,k),V=S?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),N=T*s.mercatorZfromAltitude(1,this.center.lat),R=this._camera.position[2]/s.mercatorZfromAltitude(1,this.center.lat),Q=[T*V.x,T*V.y,R*(k?1:N)],Z=this.cameraToCenterDistance/t.tileSize*(t.roundZoom?1:.502),Y=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?o:0,X=t.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,ee=t.isTerrainDEM?-X:this._elevation?this._elevation.getMinElevationBelowMSL():0,H=this.projection.isReprojectedInTileSpace?ec(this):1,re=be=>{const gt=new s.MercatorCoordinate(be.x+25e-6,be.y,be.z),rt=new s.MercatorCoordinate(be.x,be.y+25e-6,be.z),nt=be.toLngLat(),At=gt.toLngLat(),Pt=rt.toLngLat(),ct=this.locationCoordinate(nt),Ct=this.locationCoordinate(At),Ht=this.locationCoordinate(Pt),Mi=Math.hypot(Ct.x-ct.x,Ct.y-ct.y),nr=Math.hypot(Ht.x-ct.x,Ht.y-ct.y);return Math.sqrt(Mi*nr)*H/25e-6},_e=be=>{const pt=X,gt=ee;return{aabb:s.tileAABB(this,T,0,0,0,be,gt,pt,this.projection),zoom:0,x:0,y:0,minZ:gt,maxZ:pt,wrap:be,fullyVisible:!1}},Ae=[];let Se=[];const Ce=o,Ge=t.reparseOverscaled?u:o,ge=be=>be*be,Ue=ge((R-this._centerAltitude)*N),Oe=be=>{if(!this._elevation||!be.tileID||!m)return;const pt=this._elevation.getMinMaxForTile(be.tileID),gt=be.aabb;pt?(gt.min[2]=pt.min,gt.max[2]=pt.max,gt.center[2]=(gt.min[2]+gt.max[2])/2):(be.shouldSplit=st(be),be.shouldSplit||(gt.min[2]=gt.max[2]=gt.center[2]=this._centerAltitude))},st=be=>{if(be.zoom<Y)return!0;if(be.zoom===Ce)return!1;if(be.shouldSplit!=null)return be.shouldSplit;const pt=be.aabb.distanceX(Q),gt=be.aabb.distanceY(Q);let rt=Ue,nt=1;if(S){rt=ge(be.aabb.distanceZ(Q));const Pt=Math.pow(2,be.zoom),ct=s.latFromMercatorY((be.y+1)/Pt),Ct=s.latFromMercatorY(be.y/Pt),Ht=Math.min(Math.max(v,ct),Ct),Mi=s.circumferenceAtLatitude(Ht)/s.circumferenceAtLatitude(v);nt=Math.min(Mi,1)}else if(f&&(rt=ge(be.aabb.distanceZ(Q)*N)),this.projection.isReprojectedInTileSpace&&u<=5){const Pt=Math.pow(2,be.zoom),ct=re(new s.MercatorCoordinate((be.x+.5)/Pt,(be.y+.5)/Pt));nt=ct>.85?1:ct}const At=pt*pt+gt*gt+rt;return At<ge((1<<Ce-be.zoom)*Z*nt*((Pt,ct)=>{if(ct*ge(.707)<Pt)return 1;const Ct=Math.sqrt(ct/Pt);return Ct/(1.4144271570014144+(Math.pow(1.1,Ct-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(rt,Ue),At))};if(this.renderWorldCopies)for(let be=1;be<=3;be++)Ae.push(_e(-be)),Ae.push(_e(be));for(Ae.push(_e(0));Ae.length>0;){const be=Ae.pop(),pt=be.x,gt=be.y;let rt=be.fullyVisible;if(!rt){const nt=be.aabb.intersects(O);if(nt===0)continue;rt=nt===2}if(be.zoom!==Ce&&st(be))for(let nt=0;nt<4;nt++){const At=(pt<<1)+nt%2,Pt=(gt<<1)+(nt>>1),ct={aabb:m?be.aabb.quadrant(nt):s.tileAABB(this,T,be.zoom+1,At,Pt,be.wrap,be.minZ,be.maxZ,this.projection),zoom:be.zoom+1,x:At,y:Pt,wrap:be.wrap,fullyVisible:rt,tileID:void 0,shouldSplit:void 0,minZ:be.minZ,maxZ:be.maxZ};f&&!S&&(ct.tileID=new s.OverscaledTileID(be.zoom+1===Ce?Ge:be.zoom+1,be.wrap,be.zoom+1,At,Pt),Oe(ct)),Ae.push(ct)}else{const nt=be.zoom===Ce?Ge:be.zoom;if(t.minzoom&&t.minzoom>nt)continue;const At=C[0]-(.5+pt+(be.wrap<<be.zoom))*(1<<o-be.zoom),Pt=C[1]-.5-gt,ct=be.tileID?be.tileID:new s.OverscaledTileID(nt,be.wrap,be.zoom,pt,gt);Se.push({tileID:ct,distanceSq:At*At+Pt*Pt})}}if(this.fogCullDistSq){const be=this.fogCullDistSq,pt=this.horizonLineFromTop();Se=Se.filter(gt=>{const rt=[0,0,0,1],nt=[s.EXTENT,s.EXTENT,0,1],At=this.calculateFogTileMatrix(gt.tileID.toUnwrapped());s.transformMat4$1(rt,rt,At),s.transformMat4$1(nt,nt,At);const Pt=s.getAABBPointSquareDist(rt,nt);if(Pt===0)return!0;let ct=!1;const Ct=this._elevation;if(Ct&&Pt>be&&pt!==0){const Ht=this.calculateProjMatrix(gt.tileID.toUnwrapped());let Mi;t.isTerrainDEM||(Mi=Ct.getMinMaxForTile(gt.tileID)),Mi||(Mi={min:ee,max:X});const nr=s.furthestTileCorner(this.rotation),or=[nr[0]*s.EXTENT,nr[1]*s.EXTENT,Mi.max];s.transformMat4(or,or,Ht),ct=(1-or[1])*this.height*.5<pt}return Pt<be||ct})}return Se.sort((be,pt)=>be.distanceSq-pt.distanceSq).map(be=>be.tileID)}resize(t,o){this.width=t,this.height=o,this.pixelsToGLUnits=[2/t,-2/o],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(t){const o=s.clamp(t.lat,-s.MAX_MERCATOR_LATITUDE,s.MAX_MERCATOR_LATITUDE),u=this.projection.project(t.lng,o);return new s.pointGeometry(u.x*this.worldSize,u.y*this.worldSize)}unproject(t){return this.projection.unproject(t.x/this.worldSize,t.y/this.worldSize)}get point(){return this.project(this.center)}setLocationAtPoint(t,o){let u,f;const m=this.centerPoint;if(this.projection.name==="globe"){const v=this.worldSize;u=(o.x-m.x)/v,f=(o.y-m.y)/v}else{const v=this.pointCoordinate(o),T=this.pointCoordinate(m);u=v.x-T.x,f=v.y-T.y}const g=this.locationCoordinate(t);this.setLocation(new s.MercatorCoordinate(g.x-u,g.y-f))}setLocation(t){this.center=this.coordinateLocation(t),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(t){return this.projection.locationPoint(this,t)}locationPoint3D(t){return this._coordinatePoint(this.locationCoordinate(t),!0)}pointLocation(t){return this.coordinateLocation(this.pointCoordinate(t))}pointLocation3D(t){return this.coordinateLocation(this.pointCoordinate3D(t))}locationCoordinate(t,o){const u=o?s.mercatorZfromAltitude(o,t.lat):void 0,f=this.projection.project(t.lng,t.lat);return new s.MercatorCoordinate(f.x,f.y,u)}coordinateLocation(t){return this.projection.unproject(t.x,t.y)}pointRayIntersection(t,o){const u=o!=null?o:this._centerAltitude,f=[t.x,t.y,0,1],m=[t.x,t.y,1,1];s.transformMat4$1(f,f,this.pixelMatrixInverse),s.transformMat4$1(m,m,this.pixelMatrixInverse);const g=m[3];s.scale$1(f,f,1/f[3]),s.scale$1(m,m,1/g);const v=f[2],T=m[2];return{p0:f,p1:m,t:v===T?0:(u-v)/(T-v)}}screenPointToMercatorRay(t){const o=[t.x,t.y,0,1],u=[t.x,t.y,1,1];return s.transformMat4$1(o,o,this.pixelMatrixInverse),s.transformMat4$1(u,u,this.pixelMatrixInverse),s.scale$1(o,o,1/o[3]),s.scale$1(u,u,1/u[3]),o[2]=s.mercatorZfromAltitude(o[2],this._center.lat)*this.worldSize,u[2]=s.mercatorZfromAltitude(u[2],this._center.lat)*this.worldSize,s.scale$1(o,o,1/this.worldSize),s.scale$1(u,u,1/this.worldSize),new s.Ray([o[0],o[1],o[2]],s.normalize([],s.sub([],u,o)))}rayIntersectionCoordinate(t){const{p0:o,p1:u,t:f}=t,m=s.mercatorZfromAltitude(o[2],this._center.lat),g=s.mercatorZfromAltitude(u[2],this._center.lat);return new s.MercatorCoordinate(s.number(o[0],u[0],f)/this.worldSize,s.number(o[1],u[1],f)/this.worldSize,s.number(m,g,f))}pointCoordinate(t,o=this._centerAltitude){return this.projection.pointCoordinate(this,t.x,t.y,o)}pointCoordinate3D(t){if(!this.elevation)return this.pointCoordinate(t);const o=this.elevation;let u=this.elevation.pointCoordinate(t);if(u)return new s.MercatorCoordinate(u[0],u[1],u[2]);let f=0,m=this.horizonLineFromTop();if(t.y>m)return this.pointCoordinate(t);const g=.02*m,v=t.clone();for(let T=0;T<10&&m-f>g;T++){v.y=s.number(f,m,.66);const C=o.pointCoordinate(v);C?(m=v.y,u=C):f=v.y}return u?new s.MercatorCoordinate(u[0],u[1],u[2]):this.pointCoordinate(t)}isPointAboveHorizon(t){if(this.elevation)return!this.elevation.pointCoordinate(t);{const o=this.horizonLineFromTop();return t.y<o}}_coordinatePoint(t,o){const u=o&&this.elevation?this.elevation.getAtPointOrZero(t,this._centerAltitude):this._centerAltitude,f=[t.x*this.worldSize,t.y*this.worldSize,u+t.toAltitude(),1];return s.transformMat4$1(f,f,this.pixelMatrix),f[3]>0?new s.pointGeometry(f[0]/f[3],f[1]/f[3]):new s.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getBounds(t,o){const u=new s.pointGeometry(this._edgeInsets.left,this._edgeInsets.top),f=new s.pointGeometry(this.width-this._edgeInsets.right,this._edgeInsets.top),m=new s.pointGeometry(this.width-this._edgeInsets.right,this.height-this._edgeInsets.bottom),g=new s.pointGeometry(this._edgeInsets.left,this.height-this._edgeInsets.bottom);let v=this.pointCoordinate(u,t),T=this.pointCoordinate(f,t);const C=this.pointCoordinate(m,o),S=this.pointCoordinate(g,o),k=(O,V)=>(V.y-O.y)/(V.x-O.x);return v.y>1&&T.y>=0?v=new s.MercatorCoordinate((1-S.y)/k(S,v)+S.x,1):v.y<0&&T.y<=1&&(v=new s.MercatorCoordinate(-S.y/k(S,v)+S.x,0)),T.y>1&&v.y>=0?T=new s.MercatorCoordinate((1-C.y)/k(C,T)+C.x,1):T.y<0&&v.y<=1&&(T=new s.MercatorCoordinate(-C.y/k(C,T)+C.x,0)),new s.LngLatBounds().extend(this.coordinateLocation(v)).extend(this.coordinateLocation(T)).extend(this.coordinateLocation(S)).extend(this.coordinateLocation(C))}_getBounds3D(){const t=this.elevation;if(!t.visibleDemTiles.length)return this._getBounds(0,0);const o=t.visibleDemTiles.reduce((u,f)=>{if(f.dem){const m=f.dem.tree;u.min=Math.min(u.min,m.minimums[0]),u.max=Math.max(u.max,m.maximums[0])}return u},{min:Number.MAX_VALUE,max:0});return this._getBounds(o.min*t.exaggeration(),o.max*t.exaggeration())}getBounds(){return this._terrainEnabled()?this._getBounds3D():this._getBounds(0,0)}horizonLineFromTop(t=!0){const o=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,u=this.height/2-o*(1-this._horizonShift);return t?Math.max(0,u):u}getMaxBounds(){return this.maxBounds}setMaxBounds(t){this.maxBounds=t,this.minLat=-s.MAX_MERCATOR_LATITUDE,this.maxLat=s.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,t&&(this.minLat=t.getSouth(),this.maxLat=t.getNorth(),this.minLng=t.getWest(),this.maxLng=t.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=s.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=s.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=s.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=s.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(t,o){return this.projection.createTileMatrix(this,o,t)}calculateDistanceTileData(t){const o=t.key,u=this._distanceTileDataCache;if(u[o])return u[o];const f=t.canonical,m=1/this.height,g=this.cameraWorldSize/this.zoomScale(f.z),v=(f.x+Math.pow(2,f.z)*t.wrap)*g,T=f.y*g,C=this.point,S=this.angle,k=Math.sin(-S),O=-Math.cos(-S);return u[o]={bearing:[k,O],center:[(C.x-v)*m,(C.y-T)*m],scale:g/s.EXTENT*m},u[o]}calculateFogTileMatrix(t){const o=t.key,u=this._fogTileMatrixCache;if(u[o])return u[o];const f=this.calculatePosMatrix(t,this.cameraWorldSize);return s.multiply$1(f,this.worldToFogMatrix,f),u[o]=new Float32Array(f),u[o]}calculateProjMatrix(t,o=!1){const u=t.key,f=o?this._alignedProjMatrixCache:this._projMatrixCache;if(f[u])return f[u];const m=this.calculatePosMatrix(t,this.worldSize);return s.multiply$1(m,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:o?this.alignedProjMatrix:this.projMatrix,m),f[u]=new Float32Array(m),f[u]}calculatePixelsToTileUnitsMatrix(t){const o=t.tileID.key,u=this._pixelsToTileUnitsCache;if(u[o])return u[o];const f=function(m,g){const{scale:v}=m.tileTransform,T=v*s.EXTENT/(m.tileSize*Math.pow(2,g.zoom-m.tileID.overscaledZ+m.tileID.canonical.z));return C=new Float32Array(4),O=(S=g.inverseAdjustmentMatrix)[1],V=S[2],N=S[3],Q=(k=[T,T])[1],C[0]=S[0]*(R=k[0]),C[1]=O*R,C[2]=V*Q,C[3]=N*Q,C;var C,S,k,O,V,N,R,Q}(t,this);return u[o]=f,u[o]}customLayerMatrix(){return this.mercatorMatrix.slice()}recenterOnTerrain(){if(!this._elevation)return;const t=this._elevation;this._updateCameraState();const o=s.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,u=this._computeCameraPosition(o),f=this._camera.forward(),m=s.mercatorZfromAltitude(1,this._center.lat);u[2]/=m,f[2]/=m,s.normalize(f,f);const g=t.raycast(u,f,t.exaggeration());if(g){const v=s.scaleAndAdd([],u,f,g),T=new s.MercatorCoordinate(v[0],v[1],s.mercatorZfromAltitude(v[2],s.latFromMercatorY(v[1]))),C=(T.z+s.length([T.x-u[0],T.y-u[1],T.z-u[2]*m]))*this._projectionScaler;this._seaLevelZoom=this._zoomFromMercatorZ(C),this._centerAltitude=T.toAltitude(),this._center=this.coordinateLocation(T),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCameraAltitude(){if(!this._elevation)return;const t=this._elevation;this._updateCameraState();const o=s.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,u=this._computeCameraPosition(o),f=t.getAtPointOrZero(new s.MercatorCoordinate(...u)),m=this._minimumHeightOverTerrain()*Math.cos(s.degToRad(this._maxPitch)),g=this._camera.position[2]-this.pixelsPerMeter/this.worldSize*f;if(g<m){const v=this.locationCoordinate(this._center,this._centerAltitude),T=[v.x-u[0],v.y-u[1],v.z-u[2]],C=s.length(T);T[2]-=(m-g)/this._projectionScaler;const S=s.length(T);if(S===0)return;s.scale$2(T,T,C/S*this._projectionScaler),this._camera.position=[v.x-T[0],v.y-T[1],v.z*this._projectionScaler-T[2]],this._camera.orientation=Fa(T,this._camera.up()),this._updateStateFromCamera()}}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;if(this._constraining=!0,this.projection.isReprojectedInTileSpace){const k=this.center;return k.lat=s.clamp(k.lat,this.minLat,this.maxLat),!this.maxBounds&&this.renderWorldCopies||(k.lng=s.clamp(k.lng,this.minLng,this.maxLng)),this.center=k,void(this._constraining=!1)}const t=this._unmodified,{x:o,y:u}=this.point;let f=0,m=o,g=u;const v=this.width/2,T=this.height/2,C=this.worldMinY*this.scale,S=this.worldMaxY*this.scale;if(u-T<C&&(g=C+T),u+T>S&&(g=S-T),S-C<this.height&&(f=Math.max(f,this.height/(S-C)),g=(S+C)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const k=this.worldMinX*this.scale,O=this.worldMaxX*this.scale,V=this.worldSize/2-(k+O)/2;m=(o+V+this.worldSize)%this.worldSize-V,m-v<k&&(m=k+v),m+v>O&&(m=O-v),O-k<this.width&&(f=Math.max(f,this.width/(O-k)),m=(O+k)/2)}m===o&&g===u||(this.center=this.unproject(new s.pointGeometry(m,g))),f&&(this.zoom+=this.scaleZoom(f)),this._constrainCameraAltitude(),this._unmodified=t,this._constraining=!1}_minZoomForBounds(){let t=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(t=Math.max(t,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),t}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const t=this._fov/2,o=this.centerOffset,u=this.pixelsPerMeter;this._projectionScaler=u/(s.mercatorZfromAltitude(1,this.center.lat)*this.worldSize),this.cameraToCenterDistance=.5/Math.tan(t)*this.height*this._projectionScaler,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const f=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?u:1),m=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);m[8]=2*-o.x/this.width,m[9]=2*o.y/this.height;let g=s.mul([],m,f);if(this.projection.isReprojectedInTileSpace){const ee=this.locationCoordinate(this.center),H=s.identity([]);s.translate(H,H,[ee.x*this.worldSize,ee.y*this.worldSize,0]),s.multiply$1(H,H,Jl(this)),s.translate(H,H,[-ee.x*this.worldSize,-ee.y*this.worldSize,0]),s.multiply$1(g,g,H),this.inverseAdjustmentMatrix=function(re){const _e=Jl(re,!0);return Ki([],[_e[0],_e[1],_e[4],_e[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=s.scale([],g,[this.worldSize,this.worldSize,this.worldSize/u,1]),this.projMatrix=g,this.invProjMatrix=s.invert(new Float64Array(16),this.projMatrix);const v=new Float32Array(16);s.identity(v),s.scale(v,v,[1,-1,1]),s.rotateX(v,v,this._pitch),s.rotateZ(v,v,this.angle);const T=s.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),C=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;T[8]=2*-o.x/this.width,T[9]=2*(o.y+C)/this.height,this.skyboxMatrix=s.multiply$1(v,T,v);const S=this.point,k=S.x,O=S.y,V=this.width%2/2,N=this.height%2/2,R=Math.cos(this.angle),Q=Math.sin(this.angle),Z=k-Math.round(k)+R*V+Q*N,Y=O-Math.round(O)+R*N+Q*V,X=new Float64Array(g);if(s.translate(X,X,[Z>.5?Z-1:Z,Y>.5?Y-1:Y,0]),this.alignedProjMatrix=X,g=s.create(),s.scale(g,g,[this.width/2,-this.height/2,1]),s.translate(g,g,[1,-1,0]),this.labelPlaneMatrix=g,g=s.create(),s.scale(g,g,[1,-1,1]),s.translate(g,g,[-1,-1,0]),s.scale(g,g,[2/this.width,2/this.height,1]),this.glCoordMatrix=g,this.pixelMatrix=s.multiply$1(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},g=s.invert(new Float64Array(16),this.pixelMatrix),!g)throw new Error("failed to invert matrix");this.pixelMatrixInverse=g,this.globeMatrix=this.projection.name==="globe"?s.calculateGlobeMatrix(this):g,this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const t=this.cameraWorldSize,o=this.cameraPixelsPerMeter,u=this._camera.position,f=1/this.height,m=[t,t,o];s.scale$2(m,m,f),s.scale$2(u,u,-1),s.multiply$2(u,u,m);const g=s.create();s.translate(g,g,u),s.scale(g,g,m),this.mercatorFogMatrix=g,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(t,o,f)}_computeCameraPosition(t){const o=(t=t||this.pixelsPerMeter)/this.pixelsPerMeter,u=this._camera.forward(),f=this.point,m=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*o-t/this.worldSize*this._centerAltitude;return[f.x/this.worldSize-u[0]*m,f.y/this.worldSize-u[1]*m,t/this.worldSize*this._centerAltitude-u[2]*m]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(t){const o=this._maxCameraBoundsDistance()*Math.cos(this._pitch),u=t[2];let f=1;u>0&&(f=Math.min((o-this._camera.position[2])/u,1)),this._camera.position=s.scaleAndAdd([],this._camera.position,t,f),this._updateStateFromCamera(),this.projection.wrap&&(this.center=this.center.wrap())}_updateStateFromCamera(){const t=this._camera.position,o=this._camera.forward(),{pitch:u,bearing:f}=this._camera.getPitchBearing(),m=s.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._projectionScaler,g=this._mercatorZfromZoom(this._maxZoom)*Math.cos(s.degToRad(this._maxPitch)),v=Math.max((t[2]-m)/Math.cos(u),g),T=this._zoomFromMercatorZ(v);s.scaleAndAdd(t,t,o,v),this._pitch=s.clamp(u,s.degToRad(this.minPitch),s.degToRad(this.maxPitch)),this.angle=s.wrap(f,-Math.PI,Math.PI),this._setZoom(s.clamp(T,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new s.MercatorCoordinate(t[0],t[1],t[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(t){return Math.pow(2,t)*this.tileSize}_mercatorZfromZoom(t){return this.cameraToCenterDistance/this._worldSizeFromZoom(t)}_minimumHeightOverTerrain(){const t=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+2,this._maxZoom);return this._mercatorZfromZoom(t)}_zoomFromMercatorZ(t){return this.scaleZoom(this.cameraToCenterDistance/(t*this.tileSize))}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(s.warnOnce("Terrain is not yet supported with alternate projections. Use mercator to enable terrain."),1))}anyCornerOffEdge(t,o){const u=Math.min(t.x,o.x),f=Math.max(t.x,o.x),m=Math.min(t.y,o.y),g=Math.max(t.y,o.y);if(m<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const v=[new s.pointGeometry(u,m),new s.pointGeometry(f,g),new s.pointGeometry(u,g),new s.pointGeometry(f,m)],T=this.renderWorldCopies?-3:0,C=this.renderWorldCopies?4:1;for(const S of v){const k=this.pointRayIntersection(S);if(k.t<0)return!0;const O=this.rayIntersectionCoordinate(k);if(O.x<T||O.y<0||O.x>C||O.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+s.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new s.pointGeometry(0,0),new s.pointGeometry(this.width,this.height))}zoomDeltaToMovement(t,o){const u=s.length(s.sub([],this._camera.position,t)),f=this._zoomFromMercatorZ(u)+o;return u-this._mercatorZfromZoom(f)}getCameraPoint(){const t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.pointGeometry(0,t))}}function rc(l,t){let o=!1,u=null;const f=()=>{u=null,o&&(l(),u=setTimeout(f,t),o=!1)};return()=>(o=!0,u||f(),u)}class Pu{constructor(t){this._hashName=t&&encodeURIComponent(t),s.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=rc(this._updateHashUnthrottled.bind(this),300)}addTo(t){return this._map=t,s.window.addEventListener("hashchange",this._onHashChange,!1),t.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),s.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(t){const o=this._map;if(!o)return"";const u=o.getCenter(),f=Math.round(100*o.getZoom())/100,m=Math.ceil((f*Math.LN2+Math.log(512/360/.5))/Math.LN10),g=Math.pow(10,m),v=Math.round(u.lng*g)/g,T=Math.round(u.lat*g)/g,C=o.getBearing(),S=o.getPitch();let k="";if(k+=t?`/${v}/${T}/${f}`:`${f}/${T}/${v}`,(C||S)&&(k+="/"+Math.round(10*C)/10),S&&(k+=`/${Math.round(S)}`),this._hashName){const O=this._hashName;let V=!1;const N=s.window.location.hash.slice(1).split("&").map(R=>{const Q=R.split("=")[0];return Q===O?(V=!0,`${Q}=${k}`):R}).filter(R=>R);return V||N.push(`${O}=${k}`),`#${N.join("&")}`}return`#${k}`}_getCurrentHash(){const t=s.window.location.hash.replace("#","");if(this._hashName){let o;return t.split("&").map(u=>u.split("=")).forEach(u=>{u[0]===this._hashName&&(o=u)}),(o&&o[1]||"").split("/")}return t.split("/")}_onHashChange(){const t=this._map;if(!t)return!1;const o=this._getCurrentHash();if(o.length>=3&&!o.some(u=>isNaN(u))){const u=t.dragRotate.isEnabled()&&t.touchZoomRotate.isEnabled()?+(o[3]||0):t.getBearing();return t.jumpTo({center:[+o[2],+o[1]],zoom:+o[0],bearing:u,pitch:+(o[4]||0)}),!0}return!1}_updateHashUnthrottled(){const t=s.window.location.href.replace(/(#.+)?$/,this.getHashString());s.window.history.replaceState(s.window.history.state,null,t)}}const Tn={linearity:.3,easing:s.bezier(0,0,.3,1)},Bu=s.extend({deceleration:2500,maxSpeed:1400},Tn),Lu=s.extend({deceleration:20,maxSpeed:1400},Tn),Ru=s.extend({deceleration:1e3,maxSpeed:360},Tn),Fu=s.extend({deceleration:1e3,maxSpeed:90},Tn);class Ou{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:s.exported.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,o=s.exported.now();for(;t.length>0&&o-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const o={zoom:0,bearing:0,pitch:0,pan:new s.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:m}of this._inertiaBuffer)o.zoom+=m.zoomDelta||0,o.bearing+=m.bearingDelta||0,o.pitch+=m.pitchDelta||0,m.panDelta&&o.pan._add(m.panDelta),m.around&&(o.around=m.around),m.pinchAround&&(o.pinchAround=m.pinchAround);const u=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,f={};if(o.pan.mag()){const m=qi(o.pan.mag(),u,s.extend({},Bu,t||{}));f.offset=o.pan.mult(m.amount/o.pan.mag()),f.center=this._map.transform.center,Ns(f,m)}if(o.zoom){const m=qi(o.zoom,u,Lu);f.zoom=this._map.transform.zoom+m.amount,Ns(f,m)}if(o.bearing){const m=qi(o.bearing,u,Ru);f.bearing=this._map.transform.bearing+s.clamp(m.amount,-179,179),Ns(f,m)}if(o.pitch){const m=qi(o.pitch,u,Fu);f.pitch=this._map.transform.pitch+m.amount,Ns(f,m)}if(f.zoom||f.bearing){const m=o.pinchAround===void 0?o.around:o.pinchAround;f.around=m?this._map.unproject(m):this._map.getCenter()}return this.clear(),f.noMoveStart=!0,f}}function Ns(l,t){(!l.duration||l.duration<t.duration)&&(l.duration=t.duration,l.easing=t.easing)}function qi(l,t,o){const{maxSpeed:u,linearity:f,deceleration:m}=o,g=s.clamp(l*f/(t/1e3),-u,u),v=Math.abs(g)/(m*f);return{easing:o.easing,duration:1e3*v,amount:g*(v/2)}}class Sr extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,o,u,f={}){const m=wi(o.getCanvasContainer(),u),g=o.unproject(m);super(t,s.extend({point:m,lngLat:g,originalEvent:u},f)),this._defaultPrevented=!1,this.target=o}}class Us extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,o,u){const f=t==="touchend"?u.changedTouches:u.touches,m=It(o.getCanvasContainer(),f),g=m.map(T=>o.unproject(T)),v=m.reduce((T,C,S,k)=>T.add(C.div(k.length)),new s.pointGeometry(0,0));super(t,{points:m,point:v,lngLats:g,lngLat:o.unproject(v),originalEvent:u}),this._defaultPrevented=!1}}class Td extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,o,u){super(t,{originalEvent:u}),this._defaultPrevented=!1}}class Ed{constructor(t,o){this._map=t,this._clickTolerance=o.clickTolerance}reset(){this._mousedownPos=void 0}wheel(t){return this._firePreventable(new Td(t.type,this._map,t))}mousedown(t,o){return this._mousedownPos=o,this._firePreventable(new Sr(t.type,this._map,t))}mouseup(t){this._map.fire(new Sr(t.type,this._map,t))}preclick(t){const o=s.extend({},t);o.type="preclick",this._map.fire(new Sr(o.type,this._map,o))}click(t,o){this._mousedownPos&&this._mousedownPos.dist(o)>=this._clickTolerance||(this.preclick(t),this._map.fire(new Sr(t.type,this._map,t)))}dblclick(t){return this._firePreventable(new Sr(t.type,this._map,t))}mouseover(t){this._map.fire(new Sr(t.type,this._map,t))}mouseout(t){this._map.fire(new Sr(t.type,this._map,t))}touchstart(t){return this._firePreventable(new Us(t.type,this._map,t))}touchmove(t){this._map.fire(new Us(t.type,this._map,t))}touchend(t){this._map.fire(new Us(t.type,this._map,t))}touchcancel(t){this._map.fire(new Us(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class En{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(t){this._map.fire(new Sr(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Sr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._map.fire(new Sr(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Nu{constructor(t,o){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=o.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,o){this.isEnabled()&&t.shiftKey&&t.button===0&&(dt(),this._startPos=this._lastPos=o,this._active=!0)}mousemoveWindow(t,o){if(!this._active)return;const u=o;if(this._lastPos.equals(u)||!this._box&&u.dist(this._startPos)<this._clickTolerance)return;const f=this._startPos;this._lastPos=u,this._box||(this._box=pe("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));const m=Math.min(f.x,u.x),g=Math.max(f.x,u.x),v=Math.min(f.y,u.y),T=Math.max(f.y,u.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${m}px,${v}px)`,this._box.style.width=g-m+"px",this._box.style.height=T-v+"px")})}mouseupWindow(t,o){if(!this._active||t.button!==0)return;const u=this._startPos,f=o;if(this.reset(),Jt(),u.x!==f.x||u.y!==f.y)return this._map.fire(new s.Event("boxzoomend",{originalEvent:t})),{cameraAnimation:m=>m.fitScreenCoordinates(u,f,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",t)}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),Lt(),delete this._startPos,delete this._lastPos}_fireEvent(t,o){return this._map.fire(new s.Event(t,{originalEvent:o}))}}function Gn(l,t){const o={};for(let u=0;u<l.length;u++)o[l[u].identifier]=t[u];return o}class fn{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(t,o,u){(this.centroid||u.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=t.timeStamp),u.length===this.numTouches&&(this.centroid=function(f){const m=new s.pointGeometry(0,0);for(const g of f)m._add(g);return m.div(f.length)}(o),this.touches=Gn(u,o)))}touchmove(t,o,u){if(this.aborted||!this.centroid)return;const f=Gn(u,o);for(const m in this.touches){const g=this.touches[m],v=f[m];(!v||v.dist(g)>30)&&(this.aborted=!0)}}touchend(t,o,u){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),u.length===0){const f=!this.aborted&&this.centroid;if(this.reset(),f)return f}}}class xo{constructor(t){this.singleTap=new fn(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(t,o,u){this.singleTap.touchstart(t,o,u)}touchmove(t,o,u){this.singleTap.touchmove(t,o,u)}touchend(t,o,u){const f=this.singleTap.touchend(t,o,u);if(f){const m=t.timeStamp-this.lastTime<500,g=!this.lastTap||this.lastTap.dist(f)<30;if(m&&g||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=f,this.count===this.numTaps)return this.reset(),f}}}class tt{constructor(){this._zoomIn=new xo({numTouches:1,numTaps:2}),this._zoomOut=new xo({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,o,u){this._zoomIn.touchstart(t,o,u),this._zoomOut.touchstart(t,o,u)}touchmove(t,o,u){this._zoomIn.touchmove(t,o,u),this._zoomOut.touchmove(t,o,u)}touchend(t,o,u){const f=this._zoomIn.touchend(t,o,u),m=this._zoomOut.touchend(t,o,u);return f?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:g=>g.easeTo({duration:300,zoom:g.getZoom()+1,around:g.unproject(f)},{originalEvent:t})}):m?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:g=>g.easeTo({duration:300,zoom:g.getZoom()-1,around:g.unproject(m)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Uu={0:1,2:2};class Na{constructor(t){this.reset(),this._clickTolerance=t.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(t,o){return!1}_move(t,o){return{}}mousedown(t,o){if(this._lastPoint)return;const u=cr(t);this._correctButton(t,u)&&(this._lastPoint=o,this._eventButton=u)}mousemoveWindow(t,o){const u=this._lastPoint;if(u){if(t.preventDefault(),this._eventButton!=null&&function(f,m){const g=Uu[m];return f.buttons===void 0||(f.buttons&g)!==g}(t,this._eventButton))this.reset();else if(this._moved||!(o.dist(u)<this._clickTolerance))return this._moved=!0,this._lastPoint=o,this._move(u,o)}}mouseupWindow(t){this._lastPoint&&cr(t)===this._eventButton&&(this._moved&&Jt(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Vs extends Na{mousedown(t,o){super.mousedown(t,o),this._lastPoint&&(this._active=!0)}_correctButton(t,o){return o===0&&!t.ctrlKey}_move(t,o){return{around:o,panDelta:o.sub(t)}}}class Wo extends Na{_correctButton(t,o){return o===0&&t.ctrlKey||o===2}_move(t,o){const u=.8*(o.x-t.x);if(u)return this._active=!0,{bearingDelta:u}}contextmenu(t){t.preventDefault()}}class nc extends Na{_correctButton(t,o){return o===0&&t.ctrlKey||o===2}_move(t,o){const u=-.5*(o.y-t.y);if(u)return this._active=!0,{pitchDelta:u}}contextmenu(t){t.preventDefault()}}class Vu{constructor(t,o){this._map=t,this._el=t.getCanvasContainer(),this._minTouches=1,this._clickTolerance=o.clickTolerance||1,this.reset(),s.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new s.pointGeometry(0,0)}touchstart(t,o,u){return this._calculateTransform(t,o,u)}touchmove(t,o,u){if(this._active&&!(u.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(u.length===1)return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return t.preventDefault(),this._calculateTransform(t,o,u)}}touchend(t,o,u){this._calculateTransform(t,o,u),this._active&&u.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,o,u){u.length>0&&(this._active=!0);const f=Gn(u,o),m=new s.pointGeometry(0,0),g=new s.pointGeometry(0,0);let v=0;for(const C in f){const S=f[C],k=this._touches[C];k&&(m._add(S),g._add(S.sub(k)),v++,f[C]=S)}if(this._touches=f,v<this._minTouches||!g.mag())return;const T=g.div(v);return this._sum._add(T),this._sum.mag()<this._clickTolerance?void 0:{around:m.div(v),panDelta:T}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=pe("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility==="hidden"&&(this._alertContainer.style.visibility="visible"),this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show")},500)}}class Ua{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(t){}_move(t,o,u){return{}}touchstart(t,o,u){this._firstTwoTouches||u.length<2||(this._firstTwoTouches=[u[0].identifier,u[1].identifier],this._start([o[0],o[1]]))}touchmove(t,o,u){const f=this._firstTwoTouches;if(!f)return;t.preventDefault();const[m,g]=f,v=Gs(u,o,m),T=Gs(u,o,g);if(!v||!T)return;const C=this._aroundCenter?null:v.add(T).div(2);return this._move([v,T],C,t)}touchend(t,o,u){if(!this._firstTwoTouches)return;const[f,m]=this._firstTwoTouches,g=Gs(u,o,f),v=Gs(u,o,m);g&&v||(this._active&&Jt(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Gs(l,t,o){for(let u=0;u<l.length;u++)if(l[u].identifier===o)return t[u]}function oc(l,t){return Math.log(l/t)/Math.LN2}class Gu extends Ua{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,o){const u=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(oc(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:oc(this._distance,u),pinchAround:o}}}function sc(l,t){return 180*l.angleWith(t)/Math.PI}class Va extends Ua{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,o){const u=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:sc(this._vector,u),pinchAround:o}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const o=25/(Math.PI*this._minDiameter)*360,u=sc(t,this._startVector);return Math.abs(u)<o}}function js(l){return Math.abs(l.y)>Math.abs(l.x)}class Ga extends Ua{constructor(t){super(),this._map=t}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(t){this._lastPoints=t,js(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,o,u){const f=this._lastPoints;if(!f)return;const m=t[0].sub(f[0]),g=t[1].sub(f[1]);return this._map._cooperativeGestures&&u.touches.length<3||(this._valid=this.gestureBeginsVertically(m,g,u.timeStamp),!this._valid)?void 0:(this._lastPoints=t,this._active=!0,{pitchDelta:(m.y+g.y)/2*-.5})}gestureBeginsVertically(t,o,u){if(this._valid!==void 0)return this._valid;const f=t.mag()>=2,m=o.mag()>=2;if(!f&&!m)return;if(!f||!m)return this._firstMove==null&&(this._firstMove=u),u-this._firstMove<100&&void 0;const g=t.y>0==o.y>0;return js(t)&&js(o)&&g}}const ju={panStep:100,bearingStep:15,pitchStep:10};class Zu{constructor(){const t=ju;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let o=0,u=0,f=0,m=0,g=0;switch(t.keyCode){case 61:case 107:case 171:case 187:o=1;break;case 189:case 109:case 173:o=-1;break;case 37:t.shiftKey?u=-1:(t.preventDefault(),m=-1);break;case 39:t.shiftKey?u=1:(t.preventDefault(),m=1);break;case 38:t.shiftKey?f=1:(t.preventDefault(),g=-1);break;case 40:t.shiftKey?f=-1:(t.preventDefault(),g=1);break;default:return}return this._rotationDisabled&&(u=0,f=0),{cameraAnimation:v=>{const T=v.getZoom();v.easeTo({duration:300,easeId:"keyboardHandler",easing:qu,zoom:o?Math.round(T)+o*(t.shiftKey?2:1):T,bearing:v.getBearing()+u*this._bearingStep,pitch:v.getPitch()+f*this._pitchStep,offset:[-m*this._panStep,-g*this._panStep],center:v.getCenter()},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function qu(l){return l*(2-l)}const ac=4.000244140625;class Wu{constructor(t,o){this._map=t,this._el=t.getCanvasContainer(),this._handler=o,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,s.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert","_isFullscreen"],this)}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&t.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(t){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(t.ctrlKey||t.metaKey||this.isZooming()||this._isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let o=t.deltaMode===s.window.WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const u=s.exported.now(),f=u-(this._lastWheelEventTime||0);this._lastWheelEventTime=u,o!==0&&o%ac==0?this._type="wheel":o!==0&&Math.abs(o)<4?this._type="trackpad":f>400?(this._type=null,this._lastValue=o,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(f*o)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,o+=this._lastValue)),t.shiftKey&&o&&(o/=4),this._type&&(this._lastWheelEvent=t,this._delta-=o,this._active||this._start(t)),t.preventDefault()}_onTimeout(t){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(t)}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const o=wi(this._el,t);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:o,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._map.transform,o=()=>t._terrainEnabled()&&this._aroundCoord?t.computeZoomRelativeTo(this._aroundCoord):t.zoom;if(this._delta!==0){const T=this._type==="wheel"&&Math.abs(this._delta)>ac?this._wheelZoomRate:this._defaultZoomRate;let C=2/(1+Math.exp(-Math.abs(this._delta*T)));this._delta<0&&C!==0&&(C=1/C);const S=o(),k=Math.pow(2,S),O=typeof this._targetZoom=="number"?t.zoomScale(this._targetZoom):k;this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(O*C))),this._type==="wheel"&&(this._startZoom=o(),this._easing=this._smoothOutEasing(200)),this._delta=0}const u=typeof this._targetZoom=="number"?this._targetZoom:o(),f=this._startZoom,m=this._easing;let g,v=!1;if(this._type==="wheel"&&f&&m){const T=Math.min((s.exported.now()-this._lastWheelEventTime)/200,1),C=m(T);g=s.number(f,u,C),T<1?this._frameId||(this._frameId=!0):v=!0}else g=u,v=!0;return this._active=!0,v&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!v,zoomDelta:g-o(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let o=s.ease;if(this._prevEase){const u=this._prevEase,f=(s.exported.now()-u.start)/u.duration,m=u.easing(f+.01)-u.easing(f),g=.27/Math.sqrt(m*m+1e-4)*.01,v=Math.sqrt(.0729-g*g);o=s.bezier(g,v,.25,1)}return this._prevEase={start:s.exported.now(),duration:t,easing:o},o}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=pe("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(s.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_isFullscreen(){return!!s.window.document.fullscreenElement||!!s.window.document.webkitFullscreenElement}_showBlockerAlert(){this._alertContainer.style.visibility==="hidden"&&(this._alertContainer.style.visibility="visible"),this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show")},200)}}class Hu{constructor(t,o){this._clickZoom=t,this._tapZoom=o}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Yu{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(t,o){return t.preventDefault(),{cameraAnimation:u=>{u.easeTo({duration:300,zoom:u.getZoom()+(t.shiftKey?-1:1),around:u.unproject(o)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class lc{constructor(){this._tap=new xo({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(t,o,u){this._swipePoint||(this._tapTime&&t.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?u.length>0&&(this._swipePoint=o[0],this._swipeTouch=u[0].identifier):this._tap.touchstart(t,o,u))}touchmove(t,o,u){if(this._tapTime){if(this._swipePoint){if(u[0].identifier!==this._swipeTouch)return;const f=o[0],m=f.y-this._swipePoint.y;return this._swipePoint=f,t.preventDefault(),this._active=!0,{zoomDelta:m/128}}}else this._tap.touchmove(t,o,u)}touchend(t,o,u){this._tapTime?this._swipePoint&&u.length===0&&this.reset():this._tap.touchend(t,o,u)&&(this._tapTime=t.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Xu{constructor(t,o,u){this._el=t,this._mousePan=o,this._touchPan=u}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Qu{constructor(t,o,u){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=o,this._mousePitch=u}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Ku{constructor(t,o,u,f){this._el=t,this._touchZoom=o,this._touchRotate=u,this._tapDragZoom=f,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Zs=l=>l.zoom||l.drag||l.pitch||l.rotate;class cc extends s.Event{}class $u{constructor(){this.constants=[1,1,.01],this.radius=0}setup(t,o){const u=s.sub([],o,t);this.radius=s.length(u[2]<0?s.div([],u,this.constants):[u[0],u[1],0])}projectRay(t){s.div(t,t,this.constants),s.normalize(t,t),s.mul$1(t,t,this.constants);const o=s.scale$2([],t,this.radius);if(o[2]>0){const u=s.scale$2([],[0,0,1],s.dot(o,[0,0,1])),f=s.scale$2([],s.normalize([],[o[0],o[1],0]),this.radius),m=s.add([],o,s.scale$2([],s.sub([],s.add([],f,u),o),2));o[0]=m[0],o[1]=m[1]}return o}}function Ho(l){return l.panDelta&&l.panDelta.mag()||l.zoomDelta||l.bearingDelta||l.pitchDelta}class Ju{constructor(t,o){this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Ou(t),this._bearingSnap=o.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new $u,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(o),s.bindAll(["handleEvent","handleWindowEvent"],this);const u=this._el;this._listeners=[[u,"touchstart",{passive:!0}],[u,"touchmove",{passive:!1}],[u,"touchend",void 0],[u,"touchcancel",void 0],[u,"mousedown",void 0],[u,"mousemove",void 0],[u,"mouseup",void 0],[s.window.document,"mousemove",{capture:!0}],[s.window.document,"mouseup",void 0],[u,"mouseover",void 0],[u,"mouseout",void 0],[u,"dblclick",void 0],[u,"click",void 0],[u,"keydown",{capture:!1}],[u,"keyup",void 0],[u,"wheel",{passive:!1}],[u,"contextmenu",void 0],[s.window,"blur",void 0]];for(const[f,m,g]of this._listeners)f.addEventListener(m,f===s.window.document?this.handleWindowEvent:this.handleEvent,g)}destroy(){for(const[t,o,u]of this._listeners)t.removeEventListener(o,t===s.window.document?this.handleWindowEvent:this.handleEvent,u)}_addDefaultHandlers(t){const o=this._map,u=o.getCanvasContainer();this._add("mapEvent",new Ed(o,t));const f=o.boxZoom=new Nu(o,t);this._add("boxZoom",f);const m=new tt,g=new Yu;o.doubleClickZoom=new Hu(g,m),this._add("tapZoom",m),this._add("clickZoom",g);const v=new lc;this._add("tapDragZoom",v);const T=o.touchPitch=new Ga(o);this._add("touchPitch",T);const C=new Wo(t),S=new nc(t);o.dragRotate=new Qu(t,C,S),this._add("mouseRotate",C,["mousePitch"]),this._add("mousePitch",S,["mouseRotate"]);const k=new Vs(t),O=new Vu(o,t);o.dragPan=new Xu(u,k,O),this._add("mousePan",k),this._add("touchPan",O,["touchZoom","touchRotate"]);const V=new Va,N=new Gu;o.touchZoomRotate=new Ku(u,N,V,v),this._add("touchRotate",V,["touchPan","touchZoom"]),this._add("touchZoom",N,["touchPan","touchRotate"]),this._add("blockableMapEvent",new En(o));const R=o.scrollZoom=new Wu(o,this);this._add("scrollZoom",R,["mousePan"]);const Q=o.keyboard=new Zu;this._add("keyboard",Q);for(const Z of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])t.interactive&&t[Z]&&o[Z].enable(t[Z])}_add(t,o,u){this._handlers.push({handlerName:t,handler:o,allowed:u}),this._handlersById[t]=o}stop(t){if(!this._updatingCamera){for(const{handler:o}of this._handlers)o.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Zs(this._eventsInProgress)||this.isZooming()}_blockedByActive(t,o,u){for(const f in t)if(f!==u&&(!o||o.indexOf(f)<0))return!0;return!1}handleWindowEvent(t){this.handleEvent(t,`${t.type}Window`)}_getMapTouches(t){const o=[];for(const u of t)this._el.contains(u.target)&&o.push(u);return o}handleEvent(t,o){this._updatingCamera=!0;const u=t.type==="renderFrame",f=u?void 0:t,m={needsRenderFrame:!1},g={},v={},T=t.touches?this._getMapTouches(t.touches):void 0,C=T?It(this._el,T):u?void 0:wi(this._el,t);for(const{handlerName:O,handler:V,allowed:N}of this._handlers){if(!V.isEnabled())continue;let R;this._blockedByActive(v,N,O)?V.reset():V[o||t.type]&&(R=V[o||t.type](t,C,T),this.mergeHandlerResult(m,g,R,O,f),R&&R.needsRenderFrame&&this._triggerRenderFrame()),(R||V.isActive())&&(v[O]=V)}const S={};for(const O in this._previousActiveHandlers)v[O]||(S[O]=f);this._previousActiveHandlers=v,(Object.keys(S).length||Ho(m))&&(this._changes.push([m,g,S]),this._triggerRenderFrame()),(Object.keys(v).length||Ho(m))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:k}=m;k&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],k(this._map))}mergeHandlerResult(t,o,u,f,m){if(!u)return;s.extend(t,u);const g={handlerName:f,originalEvent:u.originalEvent||m};u.zoomDelta!==void 0&&(o.zoom=g),u.panDelta!==void 0&&(o.drag=g),u.pitchDelta!==void 0&&(o.pitch=g),u.bearingDelta!==void 0&&(o.rotate=g)}_applyChanges(){const t={},o={},u={};for(const[f,m,g]of this._changes)f.panDelta&&(t.panDelta=(t.panDelta||new s.pointGeometry(0,0))._add(f.panDelta)),f.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+f.zoomDelta),f.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+f.bearingDelta),f.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+f.pitchDelta),f.around!==void 0&&(t.around=f.around),f.aroundCoord!==void 0&&(t.aroundCoord=f.aroundCoord),f.pinchAround!==void 0&&(t.pinchAround=f.pinchAround),f.noInertia&&(t.noInertia=f.noInertia),s.extend(o,m),s.extend(u,g);this._updateMapTransform(t,o,u),this._changes=[]}_updateMapTransform(t,o,u){const f=this._map,m=f.transform,g=Y=>[Y.x,Y.y,Y.z];if((Y=>{const X=this._eventsInProgress.drag;return X&&!this._handlersById[X.handlerName].isActive()})()&&!Ho(t)){const Y=m.zoom;m.cameraElevationReference="sea",m.recenterOnTerrain(),m.cameraElevationReference="ground",Y!==m.zoom&&this._map._update(!0)}if(!Ho(t))return void this._fireEvents(o,u,!0);let{panDelta:v,zoomDelta:T,bearingDelta:C,pitchDelta:S,around:k,aroundCoord:O,pinchAround:V}=t;V!==void 0&&(k=V),(Y=>o.drag&&!this._eventsInProgress.drag)()&&k&&(this._dragOrigin=g(m.pointCoordinate3D(k)),this._trackingEllipsoid.setup(m._camera.position,this._dragOrigin)),m.cameraElevationReference="sea",f._stop(!0),k=k||f.transform.centerPoint,C&&(m.bearing+=C),S&&(m.pitch+=S),m._updateCameraState();const N=[0,0,0];if(v){const Y=m.pointCoordinate(k);if(m.projection.name==="globe"){const X=s.latFromMercatorY(Y.y),ee=m.center.lat,H=Math.min(s.mercatorZfromAltitude(1,X)/s.mercatorZfromAltitude(1,ee),2);v=v.rotate(-m.angle),N[0]=-v.x/m.worldSize*H,N[1]=-v.y/m.worldSize*H}else{const X=m.pointCoordinate(k.sub(v));Y&&X&&(N[0]=X.x-Y.x,N[1]=X.y-Y.y)}}const R=m.zoom,Q=[0,0,0];if(T){const Y=g(O||m.pointCoordinate3D(k)),X={dir:s.normalize([],s.sub([],Y,m._camera.position))};if(X.dir[2]<0){const ee=m.zoomDeltaToMovement(Y,T);s.scale$2(Q,X.dir,ee)}}const Z=s.add(N,N,Q);m._translateCameraConstrained(Z),T&&Math.abs(m.zoom-R)>1e-4&&m.recenterOnTerrain(),m.cameraElevationReference="ground",this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(o,u,!0)}_fireEvents(t,o,u){const f=Zs(this._eventsInProgress),m=Zs(t),g={};for(const S in t){const{originalEvent:k}=t[S];this._eventsInProgress[S]||(g[`${S}start`]=k),this._eventsInProgress[S]=t[S]}!f&&m&&this._fireEvent("movestart",m.originalEvent);for(const S in g)this._fireEvent(S,g[S]);m&&this._fireEvent("move",m.originalEvent);for(const S in t){const{originalEvent:k}=t[S];this._fireEvent(S,k)}const v={};let T;for(const S in this._eventsInProgress){const{handlerName:k,originalEvent:O}=this._eventsInProgress[S];this._handlersById[k].isActive()||(delete this._eventsInProgress[S],T=o[k]||O,v[`${S}end`]=T)}for(const S in v)this._fireEvent(S,v[S]);const C=Zs(this._eventsInProgress);if(u&&(f||m)&&!C){this._updatingCamera=!0;const S=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),k=O=>O!==0&&-this._bearingSnap<O&&O<this._bearingSnap;S?(k(S.bearing||this._map.getBearing())&&(S.bearing=0),this._map.easeTo(S,{originalEvent:T})):(this._map.fire(new s.Event("moveend",{originalEvent:T})),k(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(t,o){this._map.fire(new s.Event(t,o?{originalEvent:o}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(t=>{this._frameId=void 0,this.handleEvent(new cc("renderFrame",{timeStamp:t})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const ja="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class uc extends s.Evented{constructor(t,o){super(),this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=o.bearingSnap,s.bindAll(["_renderFrameCallback"],this)}getCenter(){return new s.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(t,o){return this.jumpTo({center:t},o)}panBy(t,o,u){return t=s.pointGeometry.convert(t).mult(-1),this.panTo(this.transform.center,s.extend({offset:t},o),u)}panTo(t,o,u){return this.easeTo(s.extend({center:t},o),u)}getZoom(){return this.transform.zoom}setZoom(t,o){return this.jumpTo({zoom:t},o),this}zoomTo(t,o,u){return this.easeTo(s.extend({zoom:t},o),u)}zoomIn(t,o){return this.zoomTo(this.getZoom()+1,t,o),this}zoomOut(t,o){return this.zoomTo(this.getZoom()-1,t,o),this}getBearing(){return this.transform.bearing}setBearing(t,o){return this.jumpTo({bearing:t},o),this}getPadding(){return this.transform.padding}setPadding(t,o){return this.jumpTo({padding:t},o),this}rotateTo(t,o,u){return this.easeTo(s.extend({bearing:t},o),u)}resetNorth(t,o){return this.rotateTo(0,s.extend({duration:1e3},t),o),this}resetNorthPitch(t,o){return this.easeTo(s.extend({bearing:0,pitch:0,duration:1e3},t),o),this}snapToNorth(t,o){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,o):this}getPitch(){return this.transform.pitch}setPitch(t,o){return this.jumpTo({pitch:t},o),this}cameraForBounds(t,o){t=s.LngLatBounds.convert(t);const u=o&&o.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),u,o)}_extendCameraOptions(t){const o={top:0,bottom:0,right:0,left:0};if(typeof(t=s.extend({padding:o,offset:[0,0],maxZoom:this.transform.maxZoom},t)).padding=="number"){const u=t.padding;t.padding={top:u,bottom:u,right:u,left:u}}return t.padding=s.extend(o,t.padding),t}_cameraForBoxAndBearing(t,o,u,f){const m=this._extendCameraOptions(f),g=this.transform,v=g.padding,T=g.project(s.LngLat.convert(t)),C=g.project(s.LngLat.convert(o)),S=new s.pointGeometry(T.x,C.y),k=new s.pointGeometry(C.x,T.y),O=-s.degToRad(u),V=T.rotate(O),N=C.rotate(O),R=S.rotate(O),Q=k.rotate(O),Z=new s.pointGeometry(Math.max(V.x,N.x,R.x,Q.x),Math.max(V.y,N.y,R.y,Q.y)),Y=new s.pointGeometry(Math.min(V.x,N.x,R.x,Q.x),Math.min(V.y,N.y,R.y,Q.y)),X=Z.sub(Y),ee=(g.width-((v.left||0)+(v.right||0)+m.padding.left+m.padding.right))/X.x,H=(g.height-((v.top||0)+(v.bottom||0)+m.padding.top+m.padding.bottom))/X.y;if(H<0||ee<0)return void s.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const re=Math.min(g.scaleZoom(g.scale*Math.min(ee,H)),m.maxZoom),_e=typeof m.offset.x=="number"&&typeof m.offset.y=="number"?new s.pointGeometry(m.offset.x,m.offset.y):s.pointGeometry.convert(m.offset),Ae=new s.pointGeometry((m.padding.left-m.padding.right)/2,(m.padding.top-m.padding.bottom)/2).rotate(u*Math.PI/180),Se=_e.add(Ae).mult(g.scale/g.zoomScale(re));return{center:g.unproject(T.add(C).div(2).sub(Se)),zoom:re,bearing:u}}_cameraForBox(t,o,u,f,m){const g=this._extendCameraOptions(m);u=u||0,f=f||0,t=s.LngLat.convert(t),o=s.LngLat.convert(o);const v=this.transform.clone();v.padding=g.padding;const T=this.getFreeCameraOptions(),C=new s.LngLat(.5*(t.lng+o.lng),.5*(t.lat+o.lat)),S=.5*(u+f);if(v._camera.position[2]<s.mercatorZfromAltitude(S,C.lat))return void s.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");T.lookAtPoint(C),v.setFreeCameraOptions(T);const k=s.MercatorCoordinate.fromLngLat(t),O=s.MercatorCoordinate.fromLngLat(o),V=v.pointRayIntersection(v.centerPoint,S),N=[(R=v.rayIntersectionCoordinate(V)).x,R.y,R.z];var R;const Q=v.screenPointToMercatorRay(v.centerPoint),Z=v.projection.name!=="globe";let Y,X=0;do{const ee=Math.floor(v.zoom),H=1<<ee,re=Math.min(H*k.x,H*O.x),_e=Math.min(H*k.y,H*O.y),Ae=Math.max(H*k.x,H*O.x),Se=Math.max(H*k.y,H*O.y),Ce=new s.Aabb([re,_e,u],[Ae,Se,f]),Ge=s.Frustum.fromInvProjectionMatrix(v.invProjMatrix,v.worldSize,ee,Z);if(Ce.intersects(Ge)!==2){Y&&(v._camera.position=s.scaleAndAdd([],v._camera.position,Q.dir,-Y),v._updateStateFromCamera());break}const ge=s.sub([],v._camera.position,N);Y=.5*s.length(ge),v._camera.position=s.scaleAndAdd([],v._camera.position,Q.dir,Y);try{v._updateStateFromCamera()}catch{return void s.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}}while(++X<10);return{center:v.center,zoom:v.zoom,bearing:v.bearing,pitch:v.pitch}}fitBounds(t,o,u){return this._fitInternal(this.cameraForBounds(t,o),o,u)}_raycastElevationBox(t,o){const u=this.transform.elevation;if(!u)return;const f=new s.pointGeometry(t.x,o.y),m=new s.pointGeometry(o.x,t.y),g=u.pointCoordinate(t);if(!g)return;const v=u.pointCoordinate(o);if(!v)return;const T=u.pointCoordinate(f);if(!T)return;const C=u.pointCoordinate(m);if(!C)return;const S=new s.MercatorCoordinate(g[0],g[1]).toLngLat(),k=new s.MercatorCoordinate(v[0],v[1]).toLngLat(),O=new s.MercatorCoordinate(T[0],T[1]).toLngLat(),V=new s.MercatorCoordinate(C[0],C[1]).toLngLat(),N=Math.min(S.lng,Math.min(k.lng,Math.min(O.lng,V.lng))),R=Math.min(S.lat,Math.min(k.lat,Math.min(O.lat,V.lat))),Q=Math.max(S.lng,Math.max(k.lng,Math.max(O.lng,V.lng))),Z=Math.max(S.lat,Math.max(k.lat,Math.max(O.lat,V.lat))),Y=Math.min(g[3],Math.min(v[3],Math.min(T[3],C[3]))),X=Math.max(g[3],Math.max(v[3],Math.max(T[3],C[3])));return{minLngLat:new s.LngLat(N,R),maxLngLat:new s.LngLat(Q,Z),minAltitude:Y,maxAltitude:X}}fitScreenCoordinates(t,o,u,f,m){let g,v,T,C;const S=s.pointGeometry.convert(t),k=s.pointGeometry.convert(o),O=this._raycastElevationBox(S,k);if(O)g=O.minLngLat,v=O.maxLngLat,T=O.minAltitude,C=O.maxAltitude;else{if(this.transform.anyCornerOffEdge(S,k))return this;g=this.transform.pointLocation(S),v=this.transform.pointLocation(k)}return this._fitInternal(this.transform.pitch===0?this._cameraForBoxAndBearing(this.transform.pointLocation(s.pointGeometry.convert(t)),this.transform.pointLocation(s.pointGeometry.convert(o)),u,f):this._cameraForBox(g,v,T,C,f),f,m)}_fitInternal(t,o,u){return t?(delete(o=s.extend(t,o)).padding,o.linear?this.easeTo(o,u):this.flyTo(o,u)):this}jumpTo(t,o){this.stop();const u=t.preloadOnly?this.transform.clone():this.transform;let f=!1,m=!1,g=!1;return"zoom"in t&&u.zoom!==+t.zoom&&(f=!0,u.zoom=+t.zoom),t.center!==void 0&&(u.center=s.LngLat.convert(t.center)),"bearing"in t&&u.bearing!==+t.bearing&&(m=!0,u.bearing=+t.bearing),"pitch"in t&&u.pitch!==+t.pitch&&(g=!0,u.pitch=+t.pitch),t.padding==null||u.isPaddingEqual(t.padding)||(u.padding=t.padding),t.preloadOnly?(this._preloadTiles(u),this):(this.fire(new s.Event("movestart",o)).fire(new s.Event("move",o)),f&&this.fire(new s.Event("zoomstart",o)).fire(new s.Event("zoom",o)).fire(new s.Event("zoomend",o)),m&&this.fire(new s.Event("rotatestart",o)).fire(new s.Event("rotate",o)).fire(new s.Event("rotateend",o)),g&&this.fire(new s.Event("pitchstart",o)).fire(new s.Event("pitch",o)).fire(new s.Event("pitchend",o)),this.fire(new s.Event("moveend",o)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||s.warnOnce(ja),this.transform.getFreeCameraOptions()}setFreeCameraOptions(t,o){const u=this.transform;if(!u.projection.supportsFreeCamera)return s.warnOnce(ja),this;this.stop();const f=u.zoom,m=u.pitch,g=u.bearing;u.setFreeCameraOptions(t);const v=f!==u.zoom,T=m!==u.pitch,C=g!==u.bearing;return this.fire(new s.Event("movestart",o)).fire(new s.Event("move",o)),v&&this.fire(new s.Event("zoomstart",o)).fire(new s.Event("zoom",o)).fire(new s.Event("zoomend",o)),C&&this.fire(new s.Event("rotatestart",o)).fire(new s.Event("rotate",o)).fire(new s.Event("rotateend",o)),T&&this.fire(new s.Event("pitchstart",o)).fire(new s.Event("pitch",o)).fire(new s.Event("pitchend",o)),this.fire(new s.Event("moveend",o)),this}easeTo(t,o){this._stop(!1,t.easeId),((t=s.extend({offset:[0,0],duration:500,easing:s.ease},t)).animate===!1||!t.essential&&s.exported.prefersReducedMotion)&&(t.duration=0);const u=this.transform,f=this.getZoom(),m=this.getBearing(),g=this.getPitch(),v=this.getPadding(),T="zoom"in t?+t.zoom:f,C="bearing"in t?this._normalizeBearing(t.bearing,m):m,S="pitch"in t?+t.pitch:g,k="padding"in t?t.padding:u.padding,O=s.pointGeometry.convert(t.offset);let V,N,R;if(u.projection.name==="globe"){const Se=s.MercatorCoordinate.fromLngLat(u.center),Ce=O.rotate(-u.angle);Se.x+=Ce.x/u.worldSize,Se.y+=Ce.y/u.worldSize;const Ge=Se.toLngLat(),ge=s.LngLat.convert(t.center||Ge);this._normalizeCenter(ge),V=u.centerPoint.add(Ce),N=new s.pointGeometry(Se.x,Se.y).mult(u.worldSize),R=new s.pointGeometry(s.mercatorXfromLng(ge.lng),s.mercatorYfromLat(ge.lat)).mult(u.worldSize).sub(N)}else{V=u.centerPoint.add(O);const Se=u.pointLocation(V),Ce=s.LngLat.convert(t.center||Se);this._normalizeCenter(Ce),N=u.project(Se),R=u.project(Ce).sub(N)}const Q=u.zoomScale(T-f);let Z,Y;t.around&&(Z=s.LngLat.convert(t.around),Y=u.locationPoint(Z));const X=this._zooming||T!==f,ee=this._rotating||m!==C,H=this._pitching||S!==g,re=!u.isPaddingEqual(k),_e=Se=>Ce=>{if(X&&(Se.zoom=s.number(f,T,Ce)),ee&&(Se.bearing=s.number(m,C,Ce)),H&&(Se.pitch=s.number(g,S,Ce)),re&&(Se.interpolatePadding(v,k,Ce),V=Se.centerPoint.add(O)),Z)Se.setLocationAtPoint(Z,Y);else{const Ge=Se.zoomScale(Se.zoom-f),ge=T>f?Math.min(2,Q):Math.max(.5,Q),Ue=Math.pow(ge,1-Ce),Oe=Se.unproject(N.add(R.mult(Ce*Ue)).mult(Ge));Se.setLocationAtPoint(Se.renderWorldCopies?Oe.wrap():Oe,V)}return t.preloadOnly||this._fireMoveEvents(o),Se};if(t.preloadOnly){const Se=this._emulate(_e,t.duration,u);return this._preloadTiles(Se),this}const Ae={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=X,this._rotating=ee,this._pitching=H,this._padding=re,this._easeId=t.easeId,this._prepareEase(o,t.noMoveStart,Ae),this._ease(_e(u),Se=>{u.recenterOnTerrain(),this._afterEase(o,Se)},t),this}_prepareEase(t,o,u={}){this._moving=!0,this.transform.cameraElevationReference="sea",o||u.moving||this.fire(new s.Event("movestart",t)),this._zooming&&!u.zooming&&this.fire(new s.Event("zoomstart",t)),this._rotating&&!u.rotating&&this.fire(new s.Event("rotatestart",t)),this._pitching&&!u.pitching&&this.fire(new s.Event("pitchstart",t))}_fireMoveEvents(t){this.fire(new s.Event("move",t)),this._zooming&&this.fire(new s.Event("zoom",t)),this._rotating&&this.fire(new s.Event("rotate",t)),this._pitching&&this.fire(new s.Event("pitch",t))}_afterEase(t,o){if(this._easeId&&o&&this._easeId===o)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const u=this._zooming,f=this._rotating,m=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,u&&this.fire(new s.Event("zoomend",t)),f&&this.fire(new s.Event("rotateend",t)),m&&this.fire(new s.Event("pitchend",t)),this.fire(new s.Event("moveend",t))}flyTo(t,o){if(!t.essential&&s.exported.prefersReducedMotion){const rt=s.pick(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(rt,o)}this.stop(),t=s.extend({offset:[0,0],speed:1.2,curve:1.42,easing:s.ease},t);const u=this.transform,f=this.getZoom(),m=this.getBearing(),g=this.getPitch(),v=this.getPadding(),T="zoom"in t?s.clamp(+t.zoom,u.minZoom,u.maxZoom):f,C="bearing"in t?this._normalizeBearing(t.bearing,m):m,S="pitch"in t?+t.pitch:g,k="padding"in t?t.padding:u.padding,O=u.zoomScale(T-f),V=s.pointGeometry.convert(t.offset);let N=u.centerPoint.add(V);const R=u.pointLocation(N),Q=s.LngLat.convert(t.center||R);this._normalizeCenter(Q);const Z=u.project(R),Y=u.project(Q).sub(Z);let X=t.curve;const ee=Math.max(u.width,u.height),H=ee/O,re=Y.mag();if("minZoom"in t){const rt=s.clamp(Math.min(t.minZoom,f,T),u.minZoom,u.maxZoom),nt=ee/u.zoomScale(rt-f);X=Math.sqrt(nt/re*2)}const _e=X*X;function Ae(rt){const nt=(H*H-ee*ee+(rt?-1:1)*_e*_e*re*re)/(2*(rt?H:ee)*_e*re);return Math.log(Math.sqrt(nt*nt+1)-nt)}function Se(rt){return(Math.exp(rt)-Math.exp(-rt))/2}function Ce(rt){return(Math.exp(rt)+Math.exp(-rt))/2}const Ge=Ae(0);let ge=function(rt){return Ce(Ge)/Ce(Ge+X*rt)},Ue=function(rt){return ee*((Ce(Ge)*(Se(nt=Ge+X*rt)/Ce(nt))-Se(Ge))/_e)/re;var nt},Oe=(Ae(1)-Ge)/X;if(Math.abs(re)<1e-6||!isFinite(Oe)){if(Math.abs(ee-H)<1e-6)return this.easeTo(t,o);const rt=H<ee?-1:1;Oe=Math.abs(Math.log(H/ee))/X,Ue=function(){return 0},ge=function(nt){return Math.exp(rt*X*nt)}}t.duration="duration"in t?+t.duration:1e3*Oe/("screenSpeed"in t?+t.screenSpeed/X:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0);const st=m!==C,be=S!==g,pt=!u.isPaddingEqual(k),gt=rt=>nt=>{const At=nt*Oe,Pt=1/ge(At);rt.zoom=nt===1?T:f+rt.scaleZoom(Pt),st&&(rt.bearing=s.number(m,C,nt)),be&&(rt.pitch=s.number(g,S,nt)),pt&&(rt.interpolatePadding(v,k,nt),N=rt.centerPoint.add(V));const ct=nt===1?Q:rt.unproject(Z.add(Y.mult(Ue(At))).mult(Pt));return rt.setLocationAtPoint(rt.renderWorldCopies?ct.wrap():ct,N),rt._updateCameraOnTerrain(),t.preloadOnly||this._fireMoveEvents(o),rt};if(t.preloadOnly){const rt=this._emulate(gt,t.duration,u);return this._preloadTiles(rt),this}return this._zooming=!0,this._rotating=st,this._pitching=be,this._padding=pt,this._prepareEase(o,!1),this._ease(gt(u),()=>this._afterEase(o),t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,o){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const u=this._onEaseEnd;this._onEaseEnd=void 0,u.call(this,o)}if(!t){const u=this.handlers;u&&u.stop(!1)}return this}_ease(t,o,u){u.animate===!1||u.duration===0?(t(1),o()):(this._easeStart=s.exported.now(),this._easeOptions=u,this._onEaseFrame=t,this._onEaseEnd=o,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const t=Math.min((s.exported.now()-this._easeStart)/this._easeOptions.duration,1),o=this._onEaseFrame;o&&o(this._easeOptions.easing(t)),t<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(t,o){t=s.wrap(t,-180,180);const u=Math.abs(t-o);return Math.abs(t-360-o)<u&&(t-=360),Math.abs(t+360-o)<u&&(t+=360),t}_normalizeCenter(t){const o=this.transform;if(!o.renderWorldCopies||o.maxBounds)return;const u=t.lng-o.center.lng;t.lng+=u>180?-360:u<-180?360:0}_emulate(t,o,u){const f=Math.ceil(15*o/1e3),m=[],g=t(u.clone());for(let v=0;v<=f;v++){const T=g(v/f);m.push(T.clone())}return m}}class Za{constructor(t={}){this.options=t,s.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(t){const o=this.options&&this.options.compact;return this._map=t,this._container=pe("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=pe("button","mapboxgl-ctrl-attrib-button",this._container),pe("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=pe("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),o&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),o===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(t,o){const u=this._map._getUIString(`AttributionControl.${o}`);t.setAttribute("aria-label",u),t.removeAttribute("title"),t.firstElementChild&&t.firstElementChild.setAttribute("title",u)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let t=this._editLink;t||(t=this._editLink=this._container.querySelector(".mapbox-improve-map"));const o=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||s.config.ACCESS_TOKEN}];if(t){const u=o.reduce((f,m,g)=>(m.value&&(f+=`${m.key}=${m.value}${g<o.length-1?"&":""}`),f),"?");t.href=`${s.config.FEEDBACK_URL}/${u}${this._map._hash?this._map._hash.getHashString(!0):""}`,t.rel="noopener nofollow",this._setElementTitle(t,"MapFeedback")}}_updateData(t){!t||t.sourceDataType!=="metadata"&&t.sourceDataType!=="visibility"&&t.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let t=[];if(this._map.style.stylesheet){const f=this._map.style.stylesheet;this.styleOwner=f.owner,this.styleId=f.id}const o=this._map.style._sourceCaches;for(const f in o){const m=o[f];if(m.used){const g=m.getSource();g.attribution&&t.indexOf(g.attribution)<0&&t.push(g.attribution)}}t.sort((f,m)=>f.length-m.length),t=t.filter((f,m)=>{for(let g=m+1;g<t.length;g++)if(t[g].indexOf(f)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=[...this.options.customAttribution,...t]:t.unshift(this.options.customAttribution));const u=t.join(" | ");u!==this._attribHTML&&(this._attribHTML=u,t.length?(this._innerContainer.innerHTML=u,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class eh{constructor(){s.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(t){this._map=t,this._container=pe("div","mapboxgl-ctrl");const o=pe("a","mapboxgl-ctrl-logo");return o.target="_blank",o.rel="noopener nofollow",o.href="https://www.mapbox.com/",o.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),o.setAttribute("rel","noopener nofollow"),this._container.appendChild(o),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(t){t&&t.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const t=this._map.style._sourceCaches;if(Object.entries(t).length===0)return!0;for(const o in t){const u=t[o].getSource();if(u.hasOwnProperty("mapbox_logo")&&!u.mapbox_logo)return!1}return!0}_updateCompact(){const t=this._container.children;if(t.length){const o=t[0];this._map.getCanvasContainer().offsetWidth<250?o.classList.add("mapboxgl-compact"):o.classList.remove("mapboxgl-compact")}}}class th{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const o=++this._id;return this._queue.push({callback:t,id:o,cancelled:!1}),o}remove(t){const o=this._currentlyRunning,u=o?this._queue.concat(o):this._queue;for(const f of u)if(f.id===t)return void(f.cancelled=!0)}run(t=0){const o=this._currentlyRunning=this._queue;this._queue=[];for(const u of o)if(!u.cancelled&&(u.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function qa(l,t,o){if(l=new s.LngLat(l.lng,l.lat),t){const u=new s.LngLat(l.lng-360,l.lat),f=new s.LngLat(l.lng+360,l.lat),m=360*Math.ceil(Math.abs(l.lng-o.center.lng)/360),g=o.locationPoint(l).distSqr(t),v=t.x<0||t.y<0||t.x>o.width||t.y>o.height;o.locationPoint(u).distSqr(t)<g&&(v||Math.abs(u.lng-o.center.lng)<m)?l=u:o.locationPoint(f).distSqr(t)<g&&(v||Math.abs(f.lng-o.center.lng)<m)&&(l=f)}for(;Math.abs(l.lng-o.center.lng)>180;){const u=o.locationPoint(l);if(u.x>=0&&u.y>=0&&u.x<=o.width&&u.y<=o.height)break;l.lng>o.center.lng?l.lng-=360:l.lng+=360}return l}const Wa={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Ha extends s.Evented{constructor(t,o){if(super(),(t instanceof s.window.HTMLElement||o)&&(t=s.extend({element:t},o)),s.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment!=="auto"?t.pitchAlignment:this._rotationAlignment,this._updateMoving=()=>this._update(!0),t&&t.element)this._element=t.element,this._offset=s.pointGeometry.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=pe("div");const f=41,m=27,g=Ee("svg",{display:"block",height:f*this._scale+"px",width:m*this._scale+"px",viewBox:`0 0 ${m} ${f}`},this._element),v=Ee("radialGradient",{id:"shadowGradient"},Ee("defs",{},g));Ee("stop",{offset:"10%","stop-opacity":.4},v),Ee("stop",{offset:"100%","stop-opacity":.05},v),Ee("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},g),Ee("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},g),Ee("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},g),Ee("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},g),this._offset=s.pointGeometry.convert(t&&t.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",f=>{f.preventDefault()}),this._element.addEventListener("mousedown",f=>{f.preventDefault()});const u=this._element.classList;for(const f in Wa)u.remove(`mapboxgl-marker-anchor-${f}`);u.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(t){return t===this._map||(this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._updateMoving),t.on("moveend",this._update),t.on("remove",this._clearFadeTimer),t._addMarker(this),this.setDraggable(this._draggable),this._update(),t.on("click",this._onMapClick)),this}remove(){const t=this._map;return t&&(t.off("click",this._onMapClick),t.off("move",this._updateMoving),t.off("moveend",this._update),t.off("mousedown",this._addDragHandler),t.off("touchstart",this._addDragHandler),t.off("mouseup",this._onUp),t.off("touchend",this._onUp),t.off("mousemove",this._onMove),t.off("touchmove",this._onMove),t.off("remove",this._clearFadeTimer),t._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=s.LngLat.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const f=Math.sqrt(Math.pow(13.5,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[f,-1*(38.1-13.5+f)],"bottom-right":[-f,-1*(38.1-13.5+f)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=t,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(t){const o=t.code,u=t.charCode||t.keyCode;o!=="Space"&&o!=="Enter"&&u!==32&&u!==13||this.togglePopup()}_onMapClick(t){const o=t.originalEvent.target,u=this._element;this._popup&&(o===u||u.contains(o))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const t=this._popup;return t?(t.isOpen()?(t.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(t.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_evaluateOpacity(){const t=this._map;if(!t)return;const o=this._pos;if(!o||o.x<0||o.x>t.transform.width||o.y<0||o.y>t.transform.height)return void this._clearFadeTimer();const u=t.unproject(o);let f=!1;if(t.transform._terrainEnabled()&&t.getTerrain()){const g=t.getFreeCameraOptions();if(g.position){const v=g.position.toLngLat();f=v.distanceTo(u)<.9*v.distanceTo(this._lngLat)}}const m=(1-t._queryFogOpacity(u))*(f?.2:1);this._element.style.opacity=`${m}`,this._popup&&this._popup._setOpacity(`${m}`),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const t=this._pos;if(!t)return;const o=this._offset.mult(this._scale),u=this._calculatePitch(),f=this._calculateRotation();this._element.style.transform=`
            translate(${t.x}px, ${t.y}px) ${Wa[this._anchor]}
            rotateX(${u}deg) rotateZ(${f}deg)
            translate(${o.x}px, ${o.y}px)
        `}_calculatePitch(){return this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?0:this._map&&this._pitchAlignment==="map"?this._map.getPitch():0}_calculateRotation(){return this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?this._rotation:this._map&&this._rotationAlignment==="map"?this._rotation-this._map.getBearing():0}_update(t){s.window.cancelAnimationFrame(this._updateFrameId);const o=this._map;o&&(o.transform.renderWorldCopies&&(this._lngLat=qa(this._lngLat,this._pos,o.transform)),this._pos=o.project(this._lngLat),t===!0?this._updateFrameId=s.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),o._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),!o.getTerrain()&&!o.getFog()||this._fadeTimer||(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(t){return this._offset=s.pointGeometry.convert(t),this._update(),this}_onMove(t){const o=this._map;if(o){if(!this._isDragging){const u=this._clickTolerance||o._clickTolerance;this._isDragging=t.point.dist(this._pointerdownPos)>=u}this._isDragging&&(this._pos=t.point.sub(this._positionDelta),this._lngLat=o.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new s.Event("dragstart"))),this.fire(new s.Event("drag")))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const t=this._map;t&&(t.off("mousemove",this._onMove),t.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new s.Event("dragend")),this._state="inactive"}_addDragHandler(t){const o=this._map;o&&this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(this._pos),this._pointerdownPos=t.point,this._state="pending",o.on("mousemove",this._onMove),o.on("touchmove",this._onMove),o.once("mouseup",this._onUp),o.once("touchend",this._onUp))}setDraggable(t){this._draggable=!!t;const o=this._map;return o&&(t?(o.on("mousedown",this._addDragHandler),o.on("touchstart",this._addDragHandler)):(o.off("mousedown",this._addDragHandler),o.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&t!=="auto"?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}class Cd{constructor(t){this.jumpTo(t)}getValue(t){if(t<=this._startTime)return this._start;if(t>=this._endTime)return this._end;const o=s.easeCubicInOut((t-this._startTime)/(this._endTime-this._startTime));return this._start*(1-o)+this._end*o}isEasing(t){return t>=this._startTime&&t<=this._endTime}jumpTo(t){this._startTime=-1/0,this._endTime=-1/0,this._start=t,this._end=t}easeTo(t,o,u){this._start=this.getValue(o),this._end=t,this._startTime=o,this._endTime=o+u}}const Md={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},hc={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0};function qs(l){l.parentNode&&l.parentNode.removeChild(l)}const dc={showCompass:!0,showZoom:!0,visualizePitch:!1};class pc{constructor(t,o,u=!1){this._clickTolerance=10,this.element=o,this.mouseRotate=new Wo({clickTolerance:t.dragRotate._mouseRotate._clickTolerance}),this.map=t,u&&(this.mousePitch=new nc({clickTolerance:t.dragRotate._mousePitch._clickTolerance})),s.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),o.addEventListener("mousedown",this.mousedown),o.addEventListener("touchstart",this.touchstart,{passive:!1}),o.addEventListener("touchmove",this.touchmove),o.addEventListener("touchend",this.touchend),o.addEventListener("touchcancel",this.reset)}down(t,o){this.mouseRotate.mousedown(t,o),this.mousePitch&&this.mousePitch.mousedown(t,o),dt()}move(t,o){const u=this.map,f=this.mouseRotate.mousemoveWindow(t,o),m=f&&f.bearingDelta;if(m&&u.setBearing(u.getBearing()+m),this.mousePitch){const g=this.mousePitch.mousemoveWindow(t,o),v=g&&g.pitchDelta;v&&u.setPitch(u.getPitch()+v)}}off(){const t=this.element;t.removeEventListener("mousedown",this.mousedown),t.removeEventListener("touchstart",this.touchstart,{passive:!1}),t.removeEventListener("touchmove",this.touchmove),t.removeEventListener("touchend",this.touchend),t.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){Lt(),s.window.removeEventListener("mousemove",this.mousemove),s.window.removeEventListener("mouseup",this.mouseup)}mousedown(t){this.down(s.extend({},t,{ctrlKey:!0,preventDefault:()=>t.preventDefault()}),wi(this.element,t)),s.window.addEventListener("mousemove",this.mousemove),s.window.addEventListener("mouseup",this.mouseup)}mousemove(t){this.move(t,wi(this.element,t))}mouseup(t){this.mouseRotate.mouseupWindow(t),this.mousePitch&&this.mousePitch.mouseupWindow(t),this.offTemp()}touchstart(t){t.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=It(this.element,t.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>t.preventDefault()},this._startPos))}touchmove(t){t.targetTouches.length!==1?this.reset():(this._lastPos=It(this.element,t.targetTouches)[0],this.move({preventDefault:()=>t.preventDefault()},this._lastPos))}touchend(t){t.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const xr={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1};let Ir,Ws=0,vo=!1;const fc={maxWidth:100,unit:"metric"};function Ya(l,t,o){const u=o&&o.maxWidth||100,f=l._containerHeight/2,m=l._containerWidth/2-u/2,g=l.unproject([m,f]),v=l.unproject([m+u,f]),T=g.distanceTo(v);if(o&&o.unit==="imperial"){const C=3.2808*T;C>5280?Yo(t,u,C/5280,l._getUIString("ScaleControl.Miles"),l):Yo(t,u,C,l._getUIString("ScaleControl.Feet"),l)}else o&&o.unit==="nautical"?Yo(t,u,T/1852,l._getUIString("ScaleControl.NauticalMiles"),l):T>=1e3?Yo(t,u,T/1e3,l._getUIString("ScaleControl.Kilometers"),l):Yo(t,u,T,l._getUIString("ScaleControl.Meters"),l)}function Yo(l,t,o,u,f){const m=function(v){const T=Math.pow(10,`${Math.floor(v)}`.length-1);let C=v/T;return C=C>=10?10:C>=5?5:C>=3?3:C>=2?2:C>=1?1:function(S){const k=Math.pow(10,Math.ceil(-Math.log(S)/Math.LN10));return Math.round(S*k)/k}(C),T*C}(o),g=m/o;f._requestDomTask(()=>{l.style.width=t*g+"px",l.innerHTML=`${m}&nbsp;${u}`})}const Vr={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},gi=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Hs(l=new s.pointGeometry(0,0),t="bottom"){if(typeof l=="number"){const o=Math.round(Math.sqrt(.5*Math.pow(l,2)));switch(t){case"top":return new s.pointGeometry(0,l);case"top-left":return new s.pointGeometry(o,o);case"top-right":return new s.pointGeometry(-o,o);case"bottom":return new s.pointGeometry(0,-l);case"bottom-left":return new s.pointGeometry(o,-o);case"bottom-right":return new s.pointGeometry(-o,-o);case"left":return new s.pointGeometry(l,0);case"right":return new s.pointGeometry(-l,0)}return new s.pointGeometry(0,0)}return l instanceof s.pointGeometry||Array.isArray(l)?s.pointGeometry.convert(l):s.pointGeometry.convert(l[t]||[0,0])}const Xo={version:s.version,supported:K,setRTLTextPlugin:s.setRTLTextPlugin,getRTLTextPluginStatus:s.getRTLTextPluginStatus,Map:class extends uc{constructor(l){if((l=s.extend({},hc,l)).minZoom!=null&&l.maxZoom!=null&&l.minZoom>l.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(l.minPitch!=null&&l.maxPitch!=null&&l.minPitch>l.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(l.minPitch!=null&&l.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(l.maxPitch!=null&&l.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(l.antialias&&s.isSafariWithAntialiasingBug(s.window)&&(l.antialias=!1,s.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Oa(l.minZoom,l.maxZoom,l.minPitch,l.maxPitch,l.renderWorldCopies),l),this._interactive=l.interactive,this._minTileCacheSize=l.minTileCacheSize,this._maxTileCacheSize=l.maxTileCacheSize,this._failIfMajorPerformanceCaveat=l.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=l.preserveDrawingBuffer,this._antialias=l.antialias,this._trackResize=l.trackResize,this._bearingSnap=l.bearingSnap,this._refreshExpiredTiles=l.refreshExpiredTiles,this._fadeDuration=l.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=l.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=l.collectResourceTiming,this._optimizeForTerrain=l.optimizeForTerrain,this._renderTaskQueue=new th,this._domRenderTaskQueue=new th,this._controls=[],this._markers=[],this._mapId=s.uniqueId(),this._locale=s.extend({},Md,l.locale),this._clickTolerance=l.clickTolerance,this._cooperativeGestures=l.cooperativeGestures,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Cd(0),this._explicitProjection=null,this._requestManager=new s.RequestManager(l.transformRequest,l.accessToken,l.testMode),this._silenceAuthErrors=!!l.testMode,typeof l.container=="string"){if(this._container=s.window.document.getElementById(l.container),!this._container)throw new Error(`Container '${l.container}' not found.`)}else{if(!(l.container instanceof s.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=l.container}if(this._container.childNodes.length>0&&s.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),l.maxBounds&&this.setMaxBounds(l.maxBounds),s.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),s.window!==void 0&&(s.window.addEventListener("online",this._onWindowOnline,!1),s.window.addEventListener("resize",this._onWindowResize,!1),s.window.addEventListener("orientationchange",this._onWindowResize,!1),s.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1)),this.handlers=new Ju(this,l),this._localFontFamily=l.localFontFamily,this._localIdeographFontFamily=l.localIdeographFontFamily,l.style&&this.setStyle(l.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),l.projection&&this.setProjection(l.projection),this._hash=l.hash&&new Pu(typeof l.hash=="string"&&l.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:l.center,zoom:l.zoom,bearing:l.bearing,pitch:l.pitch}),l.bounds&&(this.resize(),this.fitBounds(l.bounds,s.extend({},l.fitBoundsOptions,{duration:0})))),this.resize(),l.attributionControl&&this.addControl(new Za({customAttribution:l.customAttribution})),this._logoControl=new eh,this.addControl(this._logoControl,l.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",t=>{this._update(t.dataType==="style"),this.fire(new s.Event(`${t.dataType}data`,t))}),this.on("dataloading",t=>{this.fire(new s.Event(`${t.dataType}dataloading`,t))})}_getMapId(){return this._mapId}addControl(l,t){if(t===void 0&&(t=l.getDefaultPosition?l.getDefaultPosition():"top-right"),!l||!l.onAdd)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const o=l.onAdd(this);this._controls.push(l);const u=this._controlPositions[t];return t.indexOf("bottom")!==-1?u.insertBefore(o,u.firstChild):u.appendChild(o),this}removeControl(l){if(!l||!l.onRemove)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(l);return t>-1&&this._controls.splice(t,1),l.onRemove(this),this}hasControl(l){return this._controls.indexOf(l)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(l){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const t=!this._moving;return t&&this.fire(new s.Event("movestart",l)).fire(new s.Event("move",l)),this.fire(new s.Event("resize",l)),t&&this.fire(new s.Event("moveend",l)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(l){return this.transform.setMaxBounds(s.LngLatBounds.convert(l)),this._update()}setMinZoom(l){if((l=l==null?-2:l)>=-2&&l<=this.transform.maxZoom)return this.transform.minZoom=l,this._update(),this.getZoom()<l?this.setZoom(l):this.fire(new s.Event("zoomstart")).fire(new s.Event("zoom")).fire(new s.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(l){if((l=l==null?22:l)>=this.transform.minZoom)return this.transform.maxZoom=l,this._update(),this.getZoom()>l?this.setZoom(l):this.fire(new s.Event("zoomstart")).fire(new s.Event("zoom")).fire(new s.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(l){if((l=l==null?0:l)<0)throw new Error("minPitch must be greater than or equal to 0");if(l>=0&&l<=this.transform.maxPitch)return this.transform.minPitch=l,this._update(),this.getPitch()<l?this.setPitch(l):this.fire(new s.Event("pitchstart")).fire(new s.Event("pitch")).fire(new s.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(l){if((l=l==null?85:l)>85)throw new Error("maxPitch must be less than or equal to 85");if(l>=this.transform.minPitch)return this.transform.maxPitch=l,this._update(),this.getPitch()>l?this.setPitch(l):this.fire(new s.Event("pitchstart")).fire(new s.Event("pitch")).fire(new s.Event("pitchend")),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(l){return this.transform.renderWorldCopies=l,this._update()}getProjection(){return this._explicitProjection?this._explicitProjection:this.style&&this.style.stylesheet&&this.style.stylesheet.projection?this.style.stylesheet.projection:{name:"mercator",center:[0,0]}}setProjection(l){return this._lazyInitEmptyStyle(),l?typeof l=="string"&&(l={name:l}):l=null,this._updateProjection(l)}_updateProjection(l){l===null&&(this._explicitProjection=null);const t=l||this.getProjection(),o=this.transform.setProjection(t);if(l&&(this._explicitProjection=this.transform.getProjection()),o){this.painter.clearBackgroundTiles();for(const u in this.style._sourceCaches)this.style._sourceCaches[u].clearTiles();this.style.applyProjectionUpdate(),this._update(!0)}return this}project(l){return this.transform.locationPoint3D(s.LngLat.convert(l))}unproject(l){return this.transform.pointLocation3D(s.pointGeometry.convert(l))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_createDelegatedListener(l,t,o){if(l==="mouseenter"||l==="mouseover"){let u=!1;const f=g=>{const v=t.filter(C=>this.getLayer(C)),T=v.length?this.queryRenderedFeatures(g.point,{layers:v}):[];T.length?u||(u=!0,o.call(this,new Sr(l,this,g.originalEvent,{features:T}))):u=!1},m=()=>{u=!1};return{layers:new Set(t),listener:o,delegates:{mousemove:f,mouseout:m}}}if(l==="mouseleave"||l==="mouseout"){let u=!1;const f=g=>{const v=t.filter(T=>this.getLayer(T));(v.length?this.queryRenderedFeatures(g.point,{layers:v}):[]).length?u=!0:u&&(u=!1,o.call(this,new Sr(l,this,g.originalEvent)))},m=g=>{u&&(u=!1,o.call(this,new Sr(l,this,g.originalEvent)))};return{layers:new Set(t),listener:o,delegates:{mousemove:f,mouseout:m}}}{const u=f=>{const m=t.filter(v=>this.getLayer(v)),g=m.length?this.queryRenderedFeatures(f.point,{layers:m}):[];g.length&&(f.features=g,o.call(this,f),delete f.features)};return{layers:new Set(t),listener:o,delegates:{[l]:u}}}}on(l,t,o){if(o===void 0)return super.on(l,t);Array.isArray(t)||(t=[t]);const u=this._createDelegatedListener(l,t,o);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[l]=this._delegatedListeners[l]||[],this._delegatedListeners[l].push(u);for(const f in u.delegates)this.on(f,u.delegates[f]);return this}once(l,t,o){if(o===void 0)return super.once(l,t);Array.isArray(t)||(t=[t]);const u=this._createDelegatedListener(l,t,o);for(const f in u.delegates)this.once(f,u.delegates[f]);return this}off(l,t,o){if(o===void 0)return super.off(l,t);t=new Set(Array.isArray(t)?t:[t]);const u=(m,g)=>{if(m.size!==g.size)return!1;for(const v of m)if(!g.has(v))return!1;return!0},f=this._delegatedListeners?this._delegatedListeners[l]:void 0;return f&&(m=>{for(let g=0;g<m.length;g++){const v=m[g];if(v.listener===o&&u(v.layers,t)){for(const T in v.delegates)this.off(T,v.delegates[T]);return m.splice(g,1),this}}})(f),this}queryRenderedFeatures(l,t){return this.style?(t!==void 0||l===void 0||l instanceof s.pointGeometry||Array.isArray(l)||(t=l,l=void 0),this.style.queryRenderedFeatures(l=l||[[0,0],[this.transform.width,this.transform.height]],t=t||{},this.transform)):[]}querySourceFeatures(l,t){return this.style.querySourceFeatures(l,t)}queryTerrainElevation(l,t){const o=this.transform.elevation;return o?(t=s.extend({},{exaggerated:!0},t),o.getAtPoint(s.MercatorCoordinate.fromLngLat(l),null,t.exaggerated)):null}setStyle(l,t){return(t=s.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},t)).diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&t.localFontFamily===this._localFontFamily&&this.style&&l?(this._diffStyle(l,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._localFontFamily=t.localFontFamily,this._updateStyle(l,t))}_getUIString(l){const t=this._locale[l];if(t==null)throw new Error(`Missing UI string '${l}'`);return t}_updateStyle(l,t){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),l&&(this.style=new yr(this,t||{}),this.style.setEventedParent(this,{style:this.style}),typeof l=="string"?this.style.loadURL(l):this.style.loadJSON(l)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new yr(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(l,t){if(typeof l=="string"){const o=this._requestManager.normalizeStyleURL(l),u=this._requestManager.transformRequest(o,s.ResourceType.Style);s.getJSON(u,(f,m)=>{f?this.fire(new s.ErrorEvent(f)):m&&this._updateDiff(m,t)})}else typeof l=="object"&&this._updateDiff(l,t)}_updateDiff(l,t){try{this.style.setState(l)&&this._update(!0)}catch(o){s.warnOnce(`Unable to perform style diff: ${o.message||o.error||o}.  Rebuilding the style from scratch.`),this._updateStyle(l,t)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(s.warnOnce("There is no style added to the map."),!1)}addSource(l,t){return this._lazyInitEmptyStyle(),this.style.addSource(l,t),this._update(!0)}isSourceLoaded(l){return!!this.style&&this.style._isSourceCacheLoaded(l)}areTilesLoaded(){const l=this.style&&this.style._sourceCaches;for(const t in l){const o=l[t]._tiles;for(const u in o){const f=o[u];if(f.state!=="loaded"&&f.state!=="errored")return!1}}return!0}addSourceType(l,t,o){this._lazyInitEmptyStyle(),this.style.addSourceType(l,t,o)}removeSource(l){return this.style.removeSource(l),this._updateTerrain(),this._update(!0)}getSource(l){return this.style.getSource(l)}addImage(l,t,{pixelRatio:o=1,sdf:u=!1,stretchX:f,stretchY:m,content:g}={}){if(this._lazyInitEmptyStyle(),t instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&t instanceof s.window.ImageBitmap){const{width:v,height:T,data:C}=s.exported.getImageData(t);this.style.addImage(l,{data:new s.RGBAImage({width:v,height:T},C),pixelRatio:o,stretchX:f,stretchY:m,content:g,sdf:u,version:0})}else if(t.width===void 0||t.height===void 0)this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:v,height:T}=t,C=t;this.style.addImage(l,{data:new s.RGBAImage({width:v,height:T},new Uint8Array(C.data)),pixelRatio:o,stretchX:f,stretchY:m,content:g,sdf:u,version:0,userImage:C}),C.onAdd&&C.onAdd(this,l)}}updateImage(l,t){const o=this.style.getImage(l);if(!o)return void this.fire(new s.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const u=t instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&t instanceof s.window.ImageBitmap?s.exported.getImageData(t):t,{width:f,height:m}=u;f!==void 0&&m!==void 0?f===o.data.width&&m===o.data.height?(o.data.replace(u.data,!(t instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&t instanceof s.window.ImageBitmap)),this.style.updateImage(l,o)):this.fire(new s.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(l){return l?!!this.style.getImage(l):(this.fire(new s.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(l){this.style.removeImage(l)}loadImage(l,t){s.getImage(this._requestManager.transformRequest(l,s.ResourceType.Image),(o,u)=>{t(o,u instanceof s.window.HTMLImageElement?s.exported.getImageData(u):u)})}listImages(){return this.style.listImages()}addLayer(l,t){return this._lazyInitEmptyStyle(),this.style.addLayer(l,t),this._update(!0)}moveLayer(l,t){return this.style.moveLayer(l,t),this._update(!0)}removeLayer(l){return this.style.removeLayer(l),this._update(!0)}getLayer(l){return this.style.getLayer(l)}setLayerZoomRange(l,t,o){return this.style.setLayerZoomRange(l,t,o),this._update(!0)}setFilter(l,t,o={}){return this.style.setFilter(l,t,o),this._update(!0)}getFilter(l){return this.style.getFilter(l)}setPaintProperty(l,t,o,u={}){return this.style.setPaintProperty(l,t,o,u),this._update(!0)}getPaintProperty(l,t){return this.style.getPaintProperty(l,t)}setLayoutProperty(l,t,o,u={}){return this.style.setLayoutProperty(l,t,o,u),this._update(!0)}getLayoutProperty(l,t){return this.style.getLayoutProperty(l,t)}setLight(l,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(l,t),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(l){return this._lazyInitEmptyStyle(),!l&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(l),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(l){return this._lazyInitEmptyStyle(),this.style.setFog(l),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(l){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(s.LngLat.convert(l),this.transform):0}setFeatureState(l,t){return this.style.setFeatureState(l,t),this._update()}removeFeatureState(l,t){return this.style.removeFeatureState(l,t),this._update()}getFeatureState(l){return this.style.getFeatureState(l)}_updateContainerDimensions(){if(!this._container)return;const l=this._container.getBoundingClientRect().width||400,t=this._container.getBoundingClientRect().height||300;let o,u,f,m=this._container;for(;m&&(!u||!f);){const g=s.window.getComputedStyle(m).transform;g&&g!=="none"&&(o=g.match(/matrix.*\((.+)\)/)[1].split(", "),o[0]&&o[0]!=="0"&&o[0]!=="1"&&(u=o[0]),o[3]&&o[3]!=="0"&&o[3]!=="1"&&(f=o[3])),m=m.parentElement}this._containerWidth=u?Math.abs(l/u):l,this._containerHeight=f?Math.abs(t/f):t}_detectMissingCSS(){s.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&s.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const l=this._container;l.classList.add("mapboxgl-map"),(this._missingCSSCanary=pe("div","mapboxgl-canary",l)).style.visibility="hidden",this._detectMissingCSS();const t=this._canvasContainer=pe("div","mapboxgl-canvas-container",l);this._interactive&&t.classList.add("mapboxgl-interactive"),this._canvas=pe("canvas","mapboxgl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const o=this._controlContainer=pe("div","mapboxgl-control-container",l),u=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(f=>{u[f]=pe("div",`mapboxgl-ctrl-${f}`,o)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(l,t){const o=s.exported.devicePixelRatio||1;this._canvas.width=o*Math.ceil(l),this._canvas.height=o*Math.ceil(t),this._canvas.style.width=`${l}px`,this._canvas.style.height=`${t}px`}_addMarker(l){this._markers.push(l)}_removeMarker(l){const t=this._markers.indexOf(l);t!==-1&&this._markers.splice(t,1)}_setupPainter(){const l=s.extend({},K.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),t=this._canvas.getContext("webgl",l)||this._canvas.getContext("experimental-webgl",l);t?(s.storeAuthState(t,!0),this.painter=new Du(t,this.transform),this.on("data",o=>{o.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),s.exported$1.testSupport(t)):this.fire(new s.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(l){l.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new s.Event("webglcontextlost",{originalEvent:l}))}_contextRestored(l){this._setupPainter(),this.resize(),this._update(),this.fire(new s.Event("webglcontextrestored",{originalEvent:l}))}_onMapScroll(l){if(l.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(l){return this.style?(this._styleDirty=this._styleDirty||l,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(l){return this._update(),this._renderTaskQueue.add(l)}_cancelRenderFrame(l){this._renderTaskQueue.remove(l)}_requestDomTask(l){!this.loaded()||this.loaded()&&!this.isMoving()?l():this._domRenderTaskQueue.add(l)}_render(l){let t;const o=this.painter.context.extTimerQuery,u=s.exported.now();if(this.listens("gpu-timing-frame")&&(t=o.createQueryEXT(),o.beginQueryEXT(o.TIME_ELAPSED_EXT,t)),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(l),this._domRenderTaskQueue.run(l),this._removed)return;let f=!1;const m=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const T=this.transform.zoom,C=this.transform.pitch,S=s.exported.now();this.style.zoomHistory.update(T,S);const k=new s.EvaluationParameters(T,{now:S,fadeDuration:m,pitch:C,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),O=k.crossFadingFactor();O===1&&O===this._crossFadingFactor||(f=!0,this._crossFadingFactor=O),this.style.update(k)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let g=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),g=this._updateAverageElevation(u),this.style._updateSources(this.transform),this._forceMarkerUpdate()):g=this._updateAverageElevation(u),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,m,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:m,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),speedIndexTiming:this.speedIndexTiming}),this.fire(new s.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new s.Event("load"))),this.style&&(this.style.hasTransitions()||f)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const T=s.exported.now()-u;o.endQueryEXT(o.TIME_ELAPSED_EXT,t),setTimeout(()=>{const C=o.getQueryObjectEXT(t,o.QUERY_RESULT_EXT)/1e6;o.deleteQueryEXT(t),this.fire(new s.Event("gpu-timing-frame",{cpuTime:T,gpuTime:C}))},50)}if(this.listens("gpu-timing-layer")){const T=this.painter.collectGpuTimers();setTimeout(()=>{const C=this.painter.queryGpuTimers(T);this.fire(new s.Event("gpu-timing-layer",{layerTimes:C}))},50)}const v=this._sourcesDirty||this._styleDirty||this._placementDirty||g;if(v||this._repaint)this.triggerRepaint();else{const T=!this.isMoving()&&this.loaded();if(T&&(g=this._updateAverageElevation(u,!0)),g)this.triggerRepaint();else if(this._triggerFrame(!1),T&&(this.fire(new s.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const C=this._calculateSpeedIndex();this.fire(new s.Event("speedindexcompleted",{speedIndex:C})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||v||(this._fullyLoaded=!0,this._authenticate())}_forceMarkerUpdate(){for(const l of this._markers)l._update()}_updateAverageElevation(l,t=!1){const o=u=>(this.transform.averageElevation=u,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&o(0);if((t||l-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(l)){const u=this.transform.averageElevation;let f=this.transform.sampleAverageElevation(),m=!1;this.transform.elevation&&(m=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(f)?f=0:this._averageElevationLastSampledAt=l;const g=Math.abs(u-f);if(g>1){if(this._isInitialLoad||m)return this._averageElevation.jumpTo(f),o(f);this._averageElevation.easeTo(f,l,300)}else if(g>1e-4)return this._averageElevation.jumpTo(f),o(f)}return!!this._averageElevation.isEasing(l)&&o(this._averageElevation.getValue(l))}_authenticate(){s.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,l=>{if(l&&(l.message===s.AUTH_ERR_MSG||l.status===401)){const t=this.painter.context.gl;s.storeAuthState(t,!1),this._logoControl instanceof eh&&this._logoControl._updateLogo(),t&&t.clear(t.DEPTH_BUFFER_BIT|t.COLOR_BUFFER_BIT|t.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new s.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),s.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){this.painter.updateTerrain(this.style,this.isMoving()||this.isRotating()||this.isZooming())}_calculateSpeedIndex(){const l=this.painter.canvasCopy(),t=this.painter.getCanvasCopiesAndTimestamps();t.timeStamps.push(performance.now());const o=this.painter.context.gl,u=o.createFramebuffer();function f(m){o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,m,0);const g=new Uint8Array(o.drawingBufferWidth*o.drawingBufferHeight*4);return o.readPixels(0,0,o.drawingBufferWidth,o.drawingBufferHeight,o.RGBA,o.UNSIGNED_BYTE,g),g}return o.bindFramebuffer(o.FRAMEBUFFER,u),this._canvasPixelComparison(f(l),t.canvasCopies.map(f),t.timeStamps)}_canvasPixelComparison(l,t,o){let u=o[1]-o[0];const f=l.length/4;for(let m=0;m<t.length;m++){const g=t[m];let v=0;for(let T=0;T<g.length;T+=4)g[T]===l[T]&&g[T+1]===l[T+1]&&g[T+2]===l[T+2]&&g[T+3]===l[T+3]&&(v+=1);u+=(o[m+2]-o[m+1])*(1-v/f)}return u}remove(){this._hash&&this._hash.remove();for(const t of this._controls)t.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),s.window!==void 0&&(s.window.removeEventListener("resize",this._onWindowResize,!1),s.window.removeEventListener("orientationchange",this._onWindowResize,!1),s.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),s.window.removeEventListener("online",this._onWindowOnline,!1));const l=this.painter.context.gl.getExtension("WEBGL_lose_context");l&&l.loseContext(),qs(this._canvasContainer),qs(this._controlContainer),qs(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),s.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new s.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(l){this._renderNextFrame=this._renderNextFrame||l,this.style&&!this._frame&&(this._frame=s.exported.frame(t=>{const o=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,o&&this._render(t)}))}_preloadTiles(l){const t=this.style?Object.values(this.style._sourceCaches):[];return s.asyncAll(t,(o,u)=>o._preloadTiles(l,u),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(l){this._trackResize&&this.resize({originalEvent:l})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(l){this._showTileBoundaries!==l&&(this._showTileBoundaries=l,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(l){this._showTerrainWireframe!==l&&(this._showTerrainWireframe=l,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(l){this._speedIndexTiming!==l&&(this._speedIndexTiming=l,this._update())}get showPadding(){return!!this._showPadding}set showPadding(l){this._showPadding!==l&&(this._showPadding=l,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(l){this._showCollisionBoxes!==l&&(this._showCollisionBoxes=l,l?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(l){this._showOverdrawInspector!==l&&(this._showOverdrawInspector=l,this._update())}get repaint(){return!!this._repaint}set repaint(l){this._repaint!==l&&(this._repaint=l,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(l){this._vertices=l,this._update()}_setCacheLimits(l,t){s.setCacheLimits(l,t)}get version(){return s.version}},NavigationControl:class{constructor(l){this.options=s.extend({},dc,l),this._container=pe("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(s.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",t=>{this._map&&this._map.zoomIn({},{originalEvent:t})}),pe("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",t=>{this._map&&this._map.zoomOut({},{originalEvent:t})}),pe("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(s.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",t=>{const o=this._map;o&&(this.options.visualizePitch?o.resetNorthPitch({},{originalEvent:t}):o.resetNorth({},{originalEvent:t}))}),this._compassIcon=pe("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const l=this._map;if(!l)return;const t=l.getZoom(),o=t===l.getMaxZoom(),u=t===l.getMinZoom();this._zoomInButton.disabled=o,this._zoomOutButton.disabled=u,this._zoomInButton.setAttribute("aria-disabled",o.toString()),this._zoomOutButton.setAttribute("aria-disabled",u.toString())}_rotateCompassArrow(){const l=this._map;if(!l)return;const t=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(l.transform.pitch*(Math.PI/180)),.5)}) rotateX(${l.transform.pitch}deg) rotateZ(${l.transform.angle*(180/Math.PI)}deg)`:`rotate(${l.transform.angle*(180/Math.PI)}deg)`;l._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=t)})}onAdd(l){return this._map=l,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),l.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&l.on("pitch",this._rotateCompassArrow),l.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new pc(l,this._compass,this.options.visualizePitch)),this._container}onRemove(){const l=this._map;l&&(this._container.remove(),this.options.showZoom&&l.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&l.off("pitch",this._rotateCompassArrow),l.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(l,t){const o=pe("button",l,this._container);return o.type="button",o.addEventListener("click",t),o}_setButtonTitle(l,t){if(!this._map)return;const o=this._map._getUIString(`NavigationControl.${t}`);l.setAttribute("aria-label",o),l.firstElementChild&&l.firstElementChild.setAttribute("title",o)}},GeolocateControl:class extends s.Evented{constructor(l){super(),this.options=s.extend({},xr,l),s.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=rc(this._updateMarkerRotation,20)}onAdd(l){var t;return this._map=l,this._container=pe("div","mapboxgl-ctrl mapboxgl-ctrl-group"),t=this._setupUI,Ir!==void 0?t(Ir):s.window.navigator.permissions!==void 0?s.window.navigator.permissions.query({name:"geolocation"}).then(o=>{Ir=o.state!=="denied",t(Ir)}):(Ir=!!s.window.navigator.geolocation,t(Ir)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(s.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,Ws=0,vo=!1}_isOutOfMapMaxBounds(l){const t=this._map.getMaxBounds(),o=l.coords;return!!t&&(o.longitude<t.getWest()||o.longitude>t.getEast()||o.latitude<t.getSouth()||o.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(l){if(this._map){if(this._isOutOfMapMaxBounds(l))return this._setErrorState(),this.fire(new s.Event("outofmaxbounds",l)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=l,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(l),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(l),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("geolocate",l)),this._finish()}}_updateCamera(l){const t=new s.LngLat(l.coords.longitude,l.coords.latitude),o=l.coords.accuracy,u=this._map.getBearing(),f=s.extend({bearing:u},this.options.fitBoundsOptions);this._map.fitBounds(t.toBounds(o),f,{geolocateSource:!0})}_updateMarker(l){if(l){const t=new s.LngLat(l.coords.longitude,l.coords.latitude);this._accuracyCircleMarker.setLngLat(t).addTo(this._map),this._userLocationDotMarker.setLngLat(t).addTo(this._map),this._accuracy=l.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const l=this._map._containerHeight/2,t=this._map.unproject([0,l]),o=this._map.unproject([100,l]),u=t.distanceTo(o)/100,f=Math.ceil(2*this._accuracy/u);this._circleElement.style.width=`${f}px`,this._circleElement.style.height=`${f}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(l){if(this._map){if(this.options.trackUserLocation)if(l.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(l.code===3&&vo)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("error",l)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(l){if(this._container.addEventListener("contextmenu",t=>t.preventDefault()),this._geolocateButton=pe("button","mapboxgl-ctrl-geolocate",this._container),pe("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",l===!1){s.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t)}else{const t=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=pe("div","mapboxgl-user-location"),this._dotElement.appendChild(pe("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(pe("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Ha({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=pe("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ha({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",t=>{t.geolocateSource||this._watchState!=="ACTIVE_LOCK"||t.originalEvent&&t.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new s.Event("trackuserlocationend")))})}_onDeviceOrientation(l){this._userLocationDotMarker&&(l.webkitCompassHeading?this._heading=l.webkitCompassHeading:l.absolute===!0&&(this._heading=-1*l.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return s.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Ws--,vo=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new s.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let l;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Ws++,Ws>1?(l={maximumAge:6e5,timeout:0},vo=!0):(l=this.options.positionOptions,vo=!1),this._geolocationWatchID=s.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,l),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else s.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const l=()=>{s.window.addEventListener("ondeviceorientationabsolute"in s.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};s.window.DeviceMotionEvent!==void 0&&typeof s.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(t=>{t==="granted"&&l()}).catch(console.error):l()}_clearWatch(){s.window.navigator.geolocation.clearWatch(this._geolocationWatchID),s.window.removeEventListener("deviceorientation",this._onDeviceOrientation),s.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Za,ScaleControl:class{constructor(l){this.options=s.extend({},fc,l),s.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){Ya(this._map,this._container,this.options)}onAdd(l){return this._map=l,this._container=pe("div","mapboxgl-ctrl mapboxgl-ctrl-scale",l.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._onMove),this._map=void 0}setUnit(l){this.options.unit=l,Ya(this._map,this._container,this.options)}},FullscreenControl:class{constructor(l){this._fullscreen=!1,l&&l.container&&(l.container instanceof s.window.HTMLElement?this._container=l.container:s.warnOnce("Full screen control 'container' must be a DOM element.")),s.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in s.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in s.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(l){return this._map=l,this._container||(this._container=this._map.getContainer()),this._controlContainer=pe("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",s.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,s.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!s.window.document.fullscreenEnabled&&!s.window.document.webkitFullscreenEnabled)}_setupUI(){const l=this._fullscreenButton=pe("button","mapboxgl-ctrl-fullscreen",this._controlContainer);pe("span","mapboxgl-ctrl-icon",l).setAttribute("aria-hidden","true"),l.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),s.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const l=this._getTitle();this._fullscreenButton.setAttribute("aria-label",l),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",l)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(s.window.document.fullscreenElement||s.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?s.window.document.exitFullscreen?s.window.document.exitFullscreen():s.window.document.webkitCancelFullScreen&&s.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends s.Evented{constructor(l){super(),this.options=s.extend(Object.create(Vr),l),s.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(l&&l.className?l.className.trim().split(/\s+/):[])}addTo(l){return this._map&&this.remove(),this._map=l,this.options.closeOnClick&&l.on("preclick",this._onClose),this.options.closeOnMove&&l.on("move",this._onClose),l.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(l.on("mousemove",this._onMouseEvent),l.on("mouseup",this._onMouseEvent),l._canvasContainer.classList.add("mapboxgl-track-pointer")):l.on("move",this._update),this.fire(new s.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const l=this._map;return l&&(l.off("move",this._update),l.off("move",this._onClose),l.off("preclick",this._onClose),l.off("click",this._onClose),l.off("remove",this.remove),l.off("mousemove",this._onMouseEvent),l.off("mouseup",this._onMouseEvent),l.off("drag",this._onMouseEvent),this._map=void 0),this.fire(new s.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(l){this._lngLat=s.LngLat.convert(l),this._pos=null,this._trackPointer=!1,this._update();const t=this._map;return t&&(t.on("move",this._update),t.off("mousemove",this._onMouseEvent),t._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const l=this._map;return l&&(l.off("move",this._update),l.on("mousemove",this._onMouseEvent),l.on("drag",this._onMouseEvent),l._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(l){return this.setDOMContent(s.window.document.createTextNode(l))}setHTML(l){const t=s.window.document.createDocumentFragment(),o=s.window.document.createElement("body");let u;for(o.innerHTML=l;u=o.firstChild,u;)t.appendChild(u);return this.setDOMContent(t)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(l){return this.options.maxWidth=l,this._update(),this}setDOMContent(l){let t=this._content;if(t)for(;t.hasChildNodes();)t.firstChild&&t.removeChild(t.firstChild);else t=this._content=pe("div","mapboxgl-popup-content",this._container||void 0);if(t.appendChild(l),this.options.closeButton){const o=this._closeButton=pe("button","mapboxgl-popup-close-button",t);o.type="button",o.setAttribute("aria-label","Close popup"),o.setAttribute("aria-hidden","true"),o.innerHTML="&#215;",o.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(l){return this._classList.add(l),this._updateClassList(),this}removeClassName(l){return this._classList.delete(l),this._updateClassList(),this}setOffset(l){return this.options.offset=l,this._update(),this}toggleClassName(l){let t;return this._classList.delete(l)?t=!1:(this._classList.add(l),t=!0),this._updateClassList(),t}_onMouseEvent(l){this._update(l.point)}_getAnchor(l){if(this.options.anchor)return this.options.anchor;const t=this._map,o=this._container,u=this._pos;if(!t||!o||!u)return"bottom";const f=o.offsetWidth,m=o.offsetHeight,g=u.x<f/2,v=u.x>t.transform.width-f/2;if(u.y+l<m)return g?"top-left":v?"top-right":"top";if(u.y>t.transform.height-m){if(g)return"bottom-left";if(v)return"bottom-right"}return g?"left":v?"right":"bottom"}_updateClassList(){const l=this._container;if(!l)return;const t=[...this._classList];t.push("mapboxgl-popup"),this._anchor&&t.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&t.push("mapboxgl-popup-track-pointer"),l.className=t.join(" ")}_update(l){const t=this._map,o=this._content;if(!t||!this._lngLat&&!this._trackPointer||!o)return;let u=this._container;if(u||(u=this._container=pe("div","mapboxgl-popup",t.getContainer()),this._tip=pe("div","mapboxgl-popup-tip",u),u.appendChild(o)),this.options.maxWidth&&u.style.maxWidth!==this.options.maxWidth&&(u.style.maxWidth=this.options.maxWidth),t.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=qa(this._lngLat,this._pos,t.transform)),!this._trackPointer||l){const f=this._pos=this._trackPointer&&l?l:t.project(this._lngLat),m=Hs(this.options.offset),g=this._anchor=this._getAnchor(m.y),v=Hs(this.options.offset,g),T=f.add(v).round();t._requestDomTask(()=>{this._container&&g&&(this._container.style.transform=`${Wa[g]} translate(${T.x}px,${T.y}px)`)})}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const l=this._container.querySelector(gi);l&&l.focus()}_onClose(){this.remove()}_setOpacity(l){this._content&&(this._content.style.opacity=l),this._tip&&(this._tip.style.opacity=l)}},Marker:Ha,Style:yr,LngLat:s.LngLat,LngLatBounds:s.LngLatBounds,Point:s.pointGeometry,MercatorCoordinate:s.MercatorCoordinate,FreeCameraOptions:Rs,Evented:s.Evented,config:s.config,prewarm:function(){Tt().acquire(vt)},clearPrewarmedResources:function(){const l=_t;l&&(l.isPreloaded()&&l.numActive()===1?(l.release(vt),_t=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return s.config.ACCESS_TOKEN},set accessToken(l){s.config.ACCESS_TOKEN=l},get baseApiUrl(){return s.config.API_URL},set baseApiUrl(l){s.config.API_URL=l},get workerCount(){return mt.workerCount},set workerCount(l){mt.workerCount=l},get maxParallelImageRequests(){return s.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(l){s.config.MAX_PARALLEL_IMAGE_REQUESTS=l},clearStorage(l){s.clearTileCache(l)},workerUrl:"",workerClass:null,setNow:s.exported.setNow,restoreNow:s.exported.restoreNow};return Xo});var G=I;return G})})(Gy);var sf=Gy.exports,sw="/assets/logoText.a03b827a.png",aw="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAATCAYAAACgADyUAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAH7SURBVHgBpVJBbxJREH6z+zBEwdAbsCayePEmSdF43AZiPPoPir8AvHkr/ILSmzfLP9BbTWi6vXmAdPsHyl6EvUnSxqh9u+PM42HIdpseOgmPtzPzzfe9mQGxYaWGV3ooZRcROgBYM+5AIAZJnBtEwVG4zoX1xXnV2sUYhuQpiWxbohCDxWQ85A+Lj8rLVhcTOGQQBf1EiJ1fSm3NJ2PgOyKOWBCx7JeJQDOWG29rlq3ODNOAkvtZdNVmm/17zExFXbvoPB0CwGt6x+F8evzBJO0VK/UvxWr9Y8Gpl6/mF98u5xd+oVr3iPV5zrL+WAR6wckJwEi/tdnep7++VgBaXs+wCX6jpkfY5Tc2+B5Nxr4JdjKUdvnIKxWsWoo1a3MU4g4LA3+5vjNQV8lL2TC+gzTAdFWUm23PuAIGftUVEHWbuauAeECal/rHs5se91YKsWMKnUKNJP6V8qdukJLu5nZsmh6bVLNVnnIt1q0ZuKJUn8Ut9j9GY4sCP9TNycVxn+hDar3HM0yD2McxzkniWI/E5mMZhb8LzrNzWI3Ce/TEDa9+zM45Vtl+844W/pOp8T46O/muFaQq94VZq2uAnQfXpMzGk6x1hLQsZ7s1RAAeOHdV3LbDdhp4uZgdPa64WwLAI1AeUYwW03EvnXcDuAbTgrOa0yzQvewfEunarqBTnyYAAAAASUVORK5CYII=",lw="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAAUCAYAAABvVQZ0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAADASURBVHgB7ZQxDoIwFIb/1zSGUW8Aq4nExUFdPIZ4C47gDTyFuukNdFJHwgXgCGwyKE8cSBoSg9B24xua/mma9+VPWkINfx4kILiiYC96HNM25wIGofFsM5WST99p6ARl5bKLb/stTZbrCzGtoIkYPEeSCnJLK/zqqImqQ+TO0GhnstoUghJ/EUAHO2bancGWWX1SZdqU1bt2zeL7wWuTVfrO/ssqZs0YnBLI1X6bTp6J90uEYKToTPk5MsLoes4+Hz91ix2+A44AAAAASUVORK5CYII=",cw="/assets/girlOnCall.a9bd4ad1.png",uw="/assets/cover.efae5d55.png";const hw={data(){return{showMessageCover:!1}},mounted(){const d=[69.340188,41.348679];document.getElementById("map").value;const y=new sf.Map({container:"map",style:"mapbox://styles/mapbox/streets-v11",center:d,zoom:16});new sf.Marker().setLngLat(d).addTo(y);const b=()=>{document.getElementById("email").value=""};document.getElementById("form").addEventListener("submit",()=>{let I=document.getElementById("email").value,B=`Email:  ${I}`;if(I=="")return;const K=`https://api.telegram.org/bot5398248085:AAHtX4fgYmWfVzDbe4GjVxWMmXiGK0ZTOys/sendMessage?chat_id=${-633562777}&text=${B}`;let ue=new XMLHttpRequest;ue.open("GET",K,!0),ue.send(),b(),this.showMessageCover=!this.showMessageCover})}},Po=d=>(pa("data-v-c907f6a0"),d=d(),fa(),d),dw={class:"home-footer"},pw=Po(()=>Xe("h1",null,"\u0421\u0432\u044F\u0436\u0438\u0442\u0435\u0441\u044C \u0441 \u043D\u0430\u043C\u0438",-1)),fw=Po(()=>Xe("div",{class:"contacts"},[Xe("img",{class:"logoText",src:sw,alt:"logo-text"}),Xe("div",null,[Xe("img",{src:aw,alt:""}),Xe("p",null,[ir("\u0433. \u0422\u0430\u0448\u043A\u0435\u043D\u0442, \u041C\u0438\u0440\u0437\u043E-\u0423\u043B\u0443\u0433\u0431\u0435\u043A\u0441\u043A\u0438\u0439 \u0440\u0430\u0439\u043E\u043D, \u043C\u0430\u0441\u0441\u0438\u0432 "),Xe("br"),ir(' \u042F\u043B\u0430\u043D\u0433\u0430\u0447, \u0443\u043B\u0438\u0446\u0430 \u0417\u0430\u0444\u0430\u0440\u0430 \u0414\u0438\u0451\u0440\u0430, \u0434\u043E\u043C 119 "\u0410"')])]),Xe("div",null,[Xe("img",{src:lw,alt:""}),Xe("p",null,[ir("\u043F\u043D-\u0441\u0431"),Xe("br"),ir("\u0441 09:00 - 18:00 ")])]),Xe("h4",null,"(998) 99 218-55-88")],-1)),mw={class:"map-form"},_w=Po(()=>Xe("div",{id:"map",class:"map"},null,-1)),gw={class:"message"},yw=Po(()=>Xe("div",{class:"img-form"},[Xe("img",{src:cw,alt:""}),Xe("div",null,[Xe("h5",null,"\u0415\u0441\u0442\u044C \u0432\u043E\u043F\u0440\u043E\u0441\u044B? "),Xe("p",null,"\u0417\u0430\u0434\u0430\u0439\u0442\u0435 \u0438\u0445 \u043C\u0435\u043D\u0435\u0436\u0435\u0440\u0443!")])],-1)),xw=Po(()=>Xe("img",{src:uw,alt:""},null,-1)),vw=Po(()=>Xe("h2",null,"\u041C\u044B \u0441\u0432\u044F\u0436\u0435\u043C\u0441\u044F \u0441 \u0432\u0430\u043C\u0438!",-1)),Aw=[xw,vw],bw=Po(()=>Xe("input",{type:"email",required:"",id:"email",placeholder:"E-mail"},null,-1)),ww=Po(()=>Xe("input",{type:"submit",value:"\u041F\u043E\u043B\u0443\u0447\u0438\u0442\u044C \u043A\u043E\u043D\u0441\u0443\u043B\u044C\u0442\u0430\u0446\u0438\u044E"},null,-1)),Tw=Po(()=>Xe("p",null,[ir(" \u041D\u0430\u0436\u043C\u0438\u043C\u0430\u044F \u043A\u043D\u043E\u043F\u043A\u0443 \u201C\u041E\u0442\u043F\u0440\u0430\u0432\u0438\u0442\u201D \u0432\u044B \u0441\u043E\u0433\u043B\u0430\u0448\u0435\u0442\u0435\u0441\u044C \u0441 "),Xe("span",{class:"yellow"},"\u043F\u043E\u043B\u0438\u0442\u0438\u043A\u043E\u0439 \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u0438\u043A\u0438 \u043F\u0435\u0440\u0441\u043E\u043D\u0430\u043B\u044C\u043D\u044B\u0445 \u0434\u0430\u043D\u043D\u044B\u0445")],-1));function Ew(d,y,b,M,I,B){return $r(),hn("div",dw,[pw,fw,Xe("div",mw,[_w,Xe("div",gw,[yw,Xe("form",{id:"form",action:"",onSubmit:y[0]||(y[0]=My(()=>{},["prevent"]))},[Xe("div",{class:xs(["cover",I.showMessageCover?"showMessageCover":""])},Aw,2),bw,ww],32),Tw])])])}var Cw=dn(hw,[["render",Ew],["__scopeId","data-v-c907f6a0"]]),Mw="/assets/LogoGrossProfitHorizontal.3350db40.png";const Sw={},Iw={class:"home-bottom"},zw=Ml('<div class="text" data-v-d649b2d2><img class="logo" src="'+Mw+'" alt="" data-v-d649b2d2><p data-v-d649b2d2>\u0418\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u044F \u0438 \u0444\u043E\u0442\u043E\u043A\u043E\u043D\u0442\u0435\u043D\u0442 \u043D\u0430 \u0441\u0430\u0439\u0442\u0435 \u0437\u0430\u0449\u0438\u0449\u0435\u043D\u044B. \u0418\u0445 \u043D\u0435\u043B\u044C\u0437\u044F \u0437\u0430\u043F\u0438\u0441\u044B\u0432\u0430\u0442\u044C, \u043A\u043E\u043F\u0438\u0440\u043E\u0432\u0430\u0442\u044C, \u0440\u0430\u0441\u043F\u0440\u043E\u0441\u0442\u0440\u0430\u043D\u044F\u0442\u044C, \u0438\u043D\u0430\u0447\u0435 \u0432\u043E\u0437\u043D\u0438\u043A\u043D\u0435\u0442 \u0441\u043E\u0431\u043B\u0430\u0437\u043D \u0438\u0445 \u0441\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C! </p><div class="social-links" data-v-d649b2d2><a target="_blank" href="https://www.instagram.com/grossprofit_uz/" data-v-d649b2d2><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" data-v-d649b2d2><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z" data-v-d649b2d2></path></svg></a><a target="_blank" href="https://www.facebook.com/taxandadvisetashkent/" data-v-d649b2d2><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" data-v-d649b2d2><path d="M279.14 288l14.22-92.66h-88.91v-60.13c0-25.35 12.42-50.06 52.24-50.06h40.42V6.26S260.43 0 225.36 0c-73.22 0-121.08 44.38-121.08 124.72v70.62H22.89V288h81.39v224h100.17V288z" data-v-d649b2d2></path></svg></a><a target="_blank" href="https://t.me/grossprofit_uzb" data-v-d649b2d2><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" data-v-d649b2d2><path d="M248,8C111.033,8,0,119.033,0,256S111.033,504,248,504,496,392.967,496,256,384.967,8,248,8ZM362.952,176.66c-3.732,39.215-19.881,134.378-28.1,178.3-3.476,18.584-10.322,24.816-16.948,25.425-14.4,1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25,5.342-39.5,3.652-3.793,67.107-61.51,68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608,69.142-14.845,10.194-26.894,9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7,18.45-13.7,108.446-47.248,144.628-62.3c68.872-28.647,83.183-33.623,92.511-33.789,2.052-.034,6.639.474,9.61,2.885a10.452,10.452,0,0,1,3.53,6.716A43.765,43.765,0,0,1,362.952,176.66Z" data-v-d649b2d2></path></svg></a></div></div><p class="copyRight" data-v-d649b2d2>\xA9 Copyright 2022 D. Q. A. \u0412\u0441\u0435 \u043F\u0440\u0430\u0432\u0430 \u0437\u0430\u0449\u0438\u0449\u0435\u043D\u044B! <a target="_blank" href="http://rdevs.uz/gross-profit" data-v-d649b2d2>\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A\u0438</a></p>',2),Dw=[zw];function kw(d,y){return $r(),hn("div",Iw,Dw)}var Pw=dn(Sw,[["render",kw],["__scopeId","data-v-d649b2d2"]]),Bw="/assets/modalTick.9b71acce.png";const Lw={data(){return{showForm:ld}},methods:{showModal(){const d=document.getElementById("modal");d.classList.add("showModal"),setTimeout(()=>{d.classList.remove("showModal")},1e3)},sendMessage(){let d=document.getElementById("name").value,y=document.getElementById("phoneNumber").value,b=document.getElementById("description").value;if(d==""||y==""||b=="")return;let M=`\u0418\u043C\u044F:  ${d}%0A\u0422\u0435\u043B\u0435\u0444\u043E\u043D\u043D\u044B\u0439 \u043D\u043E\u043C\u0435\u0440:  ${y}%0A\u0414\u043E\u043F\u043E\u043B\u043D\u0438\u0442\u0435\u043B\u044C\u043D\u0430\u044F \u0438\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u044F:  ${b}`;const G=`https://api.telegram.org/bot5398248085:AAHtX4fgYmWfVzDbe4GjVxWMmXiGK0ZTOys/sendMessage?chat_id=${-633562777}&text=${M}`;let s=new XMLHttpRequest;s.open("GET",G,!0),s.send(),this.showForm.isVisible=!1,this.cleanMessage(),this.showModal()},cleanMessage(){document.getElementById("name").value="",document.getElementById("phoneNumber").value="",document.getElementById("description").value=""}}},Rw=d=>(pa("data-v-2965bb32"),d=d(),fa(),d),Fw=Ml('<h1 data-v-2965bb32>\u0417\u0430\u043A\u0430\u0437\u0430\u0442\u044C \u0437\u0432\u043E\u043D\u043E\u043A</h1><p data-v-2965bb32>\u0412\u0430\u0448\u0435 \u0438\u043C\u044F <span class="yellow" data-v-2965bb32>*</span></p><input required type="text" id="name" data-v-2965bb32><p data-v-2965bb32>\u0412\u0430\u0448 \u0442\u0435\u043B\u0435\u0444\u043E\u043D <span class="yellow" data-v-2965bb32>*</span></p><input required type="text" id="phoneNumber" data-v-2965bb32><p data-v-2965bb32>\u0414\u043E\u043F\u043E\u043B\u043D\u0438\u0442\u0435\u043B\u044C\u043D\u0430\u044F \u0438\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u044F</p><textarea required name="" id="description" cols="30" rows="10" data-v-2965bb32></textarea>',7),Ow={class:"submit"},Nw=Rw(()=>Xe("div",{class:"modal",id:"modal"},[Xe("div",{class:"top"},[Xe("img",{src:Bw,alt:""})]),Xe("div",{class:"bottom"},[Xe("h2",null,"O\u0442\u043B\u0438\u0447\u043D\u043E!"),Xe("p",null,"B\u0430\u0448\u0435 \u0441\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u0435 \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u043E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u043E!")])],-1));function Uw(d,y,b,M,I,B){return $r(),hn("main",null,[Xe("form",{onSubmit:y[1]||(y[1]=My(()=>{},["prevent"])),class:xs(["bot-form",I.showForm.isVisible?"":"hideForm"])},[Fw,Xe("div",Ow,[Xe("input",{onClick:y[0]||(y[0]=(...G)=>B.sendMessage&&B.sendMessage(...G)),type:"submit",value:"\u0417\u0430\u043A\u0430\u0437\u0430\u0442\u044C \u0437\u0432\u043E\u043D\u043E\u043A"})])],34),Nw])}var Vw=dn(Lw,[["render",Uw],["__scopeId","data-v-2965bb32"]]);const Gw={components:{HomeIntro:rb,HomeService:Tb,HomeAbout:Nb,HomeStakeholders:Xb,HomeContactDetails:nw,HomeFooter:Cw,HomeBottom:Pw,Form:Vw}},jw={class:"home",id:"home"};function Zw(d,y,b,M,I,B){const G=Rr("HomeIntro"),s=Rr("HomeService"),K=Rr("HomeAbout"),ue=Rr("HomeStakeholders"),he=Rr("HomeContactDetails"),J=Rr("HomeFooter"),pe=Rr("HomeBottom"),Ee=Rr("Form");return $r(),hn("div",jw,[li(G),li(s),li(K),li(ue),li(he),li(J),li(pe),li(Ee)])}var Zy=dn(Gw,[["render",Zw]]);window.addEventListener("scroll",()=>{document.querySelector("header").classList.toggle("sticky",window.scrollY>0)});const qw=wf({components:{HomeView:Zy},data(){return{showNav:OA.isVisible,showForm:ld,activeLink:1}},methods:{showNavLinks(){this.showNav=!this.showNav},showBotForm(){this.showForm.isVisible=!this.showForm.isVisible}}}),Il=d=>(pa("data-v-a2e6bc48"),d=d(),fa(),d),Ww={class:"app"},Hw=Il(()=>Xe("svg",{class:"logo",width:"50",height:"42",viewBox:"0 0 50 42",fill:"none",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},[Xe("rect",{width:"49.9796",height:"42",fill:"url(#pattern0)"}),Xe("defs",null,[Xe("pattern",{id:"pattern0",patternContentUnits:"objectBoundingBox",width:"1",height:"1"},[Xe("use",{"xlink:href":"#image0_143_649",transform:"translate(0 -0.0120217) scale(0.000882613 0.0010503)"})]),Xe("image",{id:"image0_143_649",width:"1133",height:"975","xlink:href":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABG0AAAPPCAYAAAB+HTasAAAACXBIWXMAAC4jAAAuIwF4pT92AAAHwmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNi4wLWMwMDYgNzkuMTY0NzUzLCAyMDIxLzAyLzE1LTExOjUyOjEzICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdGVEYXRlPSIyMDIxLTExLTI0VDEzOjIyOjAzKzA1OjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAyMS0xMS0yNFQxMzoyMzo1OCswNTowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMS0xMS0yNFQxMzoyMzo1OCswNTowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo5NGExNDNiNi1iN2UwLWJhNGQtYjliNi00MmI3NmNlMmZmNjgiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDo2NTYwMjNiZi0wZjI3LWNhNGMtYTYwZS1mYzBkMjAxMzcyMGIiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDphN2U2YzE1MS02ZTgxLTEwNDQtOWYyNi02YmFhNTQxZGFkZDMiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDphN2U2YzE1MS02ZTgxLTEwNDQtOWYyNi02YmFhNTQxZGFkZDMiIHN0RXZ0OndoZW49IjIwMjEtMTEtMjRUMTM6MjM6NTgrMDU6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCAyMi4zIChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY29udmVydGVkIiBzdEV2dDpwYXJhbWV0ZXJzPSJmcm9tIGFwcGxpY2F0aW9uL3ZuZC5hZG9iZS5waG90b3Nob3AgdG8gaW1hZ2UvcG5nIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJkZXJpdmVkIiBzdEV2dDpwYXJhbWV0ZXJzPSJjb252ZXJ0ZWQgZnJvbSBhcHBsaWNhdGlvbi92bmQuYWRvYmUucGhvdG9zaG9wIHRvIGltYWdlL3BuZyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6OTRhMTQzYjYtYjdlMC1iYTRkLWI5YjYtNDJiNzZjZTJmZjY4IiBzdEV2dDp3aGVuPSIyMDIxLTExLTI0VDEzOjIzOjU4KzA1OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgMjIuMyAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOmE3ZTZjMTUxLTZlODEtMTA0NC05ZjI2LTZiYWE1NDFkYWRkMyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDphN2U2YzE1MS02ZTgxLTEwNDQtOWYyNi02YmFhNTQxZGFkZDMiIHN0UmVmOm9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDphN2U2YzE1MS02ZTgxLTEwNDQtOWYyNi02YmFhNTQxZGFkZDMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4GfkYiAABPWElEQVR4nO3dT3aT2ZkG8Cd9wohBq1cQZQVRVlCqKZO4VhCzgsAKClYAWQHOCso9YVqqFURZQalX0OoBIwb04DMxUGBL1p/33u/7/c7RMRCgnu4q29Kj9773dx8+fAgAAAAAbfmP6gAAAAAA/JbSBgAAAKBBShsAAACABiltAAAAABqktAEAAABokNIGAAAAoEFKGwAAAIAGKW0AAAAAGqS0AQAAAGiQ0gYAAACgQUobAAAAgAYpbQAAAAAapLQBAAAAaJDSBgAAAKBBShsAAACABiltAAAAABqktAEAAABokNIGAAAAoEFKGwAAAIAGKW0AAAAAGqS0AQAAAGiQ0gYAAACgQUobAAAAgAYpbQAAAAAapLQBAAAAaJDSBgAAAKBBShsAAACABiltAAAAABqktAEAAABokNIGAAAAoEFKGwAAAIAGKW0AAAAAGqS0AQAAAGiQ0gYAAACgQUobAAAAgAYpbQAAAAAapLQBAAAAaJDSBgAAAKBBShsAAACABiltAAAAABr0++oAh3r39lF1BKDOz9UBjmSb5F/VIY5kc/MYg3WGfzcAn3n85P1Bf97zV4CHOfTrb4+6L22ASVtWBziii+oAjNY2QwE1Bpsk/1MdYg/b9PP/+1V1AADgt5Q2ADBus4yr4GS8tjl9ybVO8n+H/iXv3j5a52GTeOvHT94/5M8BMFG/+/DhQ3WGgxgvhUnr+wsYAHzbJvcfN93m7uO1d/0d6zgCCnTG8SgAAKAF85vHfS6O/M9dfeXX1vnthNKXv+9rfw6AA5m0AXrW9xcwABinbT4/6rbObemzye30z6c/BriXSRsAAIDDzPL5Lq3lV3/X59YZyp5tbo98ffy1TZQ7wEQpbQAAgGqLT3588Y3fs7l5bDMUOx9/vo79PMBIKW0AAIAezHO75+fiK//7KreFzjq3hQ5At5Q2AADAGCxvPl588evrm8f/ZCh21jGZA3TCImKgZ31/AQMAqmwylDe/3Hxc1UUBdmURMQAAwPjNbx4Xn/zaKp+XONtzBgL4GqUNAADAcLxq+cnPVxlKnFVM4gBFHI8Cetb3FzAAoBfbJNcZSpzrmMKBElM8HvUf1QEAAAAaN0tymeRNkv9N8nOSZ7m9zQrgJJQ2AAAA+1kmeZXk1yT/zFDgzOriAGOltAEAAHi4RYYC53+T/JRhIgfgKJQ2AAAAx3GR2yNUbzIUOgAPprQBAAA4rlmGiZt/3jwu4/gU8ABKGwAAgNNZZJi6+TWmb4A9KW0AAABOb5bb6ZufMxylAriT0gYAAOC8lhmWFv8aN08Bd1DaAAAA1Jjn9urwFzc/B/g3pQ0AAECtWZIfc7v3Zl4ZBmiH0gYAAKAdl1HeADeUNgAAAO25zFDe/JxhBw4wQUobAACAdi0zFDfKG5ggpQ0AAED7llHewOQobQAAAPqxjPIGJkNpAwAA0J9llDcwekobAACAfi2jvIHRUtoAAAD0bxnlDYyO0gYAAGA8llHewGgobQAAAMZnGeUNdE9pAwAAMF7LKG+gW0obAACA8VtGeQPdUdoAAABMxzLKG+iG0gYAAGB6lhmKmzdJ5qVJgG9S2gAAAEzXZZJfo7yBJiltAAAAuIzyBpqjtAEAAOCjyyhvoBlKGwAAAL50mdvyZlaaBCZMaQMAAMC3XGYob15EeQNnp7QBAADgLrMkP2Yob56VJoGJUdoAAACwi1mSVxnKm8vSJDARShsAAAD2Mc+w6+bnJMvSJDByShsAAAAeYpmhuPkpbpqCk1DaAAAAcIiLWFYMJ6G0AQAA4Bg+Liu+LM4Bo6G0AQAA4Fhmse8GjkZpAwAAwLEtMxQ3b+LIFDyY0gYAAIBTucxwZOpZbQzok9IGAACAU5oleZXkn0kWpUmgM0obAAAAzmGRobh5FUemYCdKGwAAAM7pWYYjUxe1MaB9ShsAAADObZbkp5vHvDQJNExpAwAAQJWLDEemntXGgDYpbQAAAKg0y7Dn5udYVAyfUdoAAADQgmWGqZsXtTGgHUobAAAAWvJjXA8OSZQ2AAAAtGcRUzegtAEAAKBZpm6YNKUNAAAALVvE1A0TpbQBAACgBz9muGFqXpwDzkZpAwAAQC+WGaZuLmtjwHkobQAAAOjJLMmbJD/d/BhGS2kDAABAjy6S/Jph+gZGSWkDAABAr2YZ9ty8Ks4BJ6G0AQAAoHfPMuy6mdfGgONS2gAAADAGi1hSzMgobQAAABiLWYYlxW9iSTEjoLQBAABgbC4z7LpZ1MaAwyhtAAAAGKNFhuLmsjYGPJzSBgAAgLGa5fa4FHRHaQMAAMDYXcbtUnRIaQMAAMAULDIUN8vaGLA7pQ0AAABTMcuw5+ZFbQzYjdIGAACAqfkxyU9xLTiNU9oAAAAwRRdxLTiNU9oAAAAwVYsMxc1FbQz4OqUNAAAAUzbLcFTqWW0M+C2lDQAAACSvkryJPTc0RGkDAAAAg8sMx6VmtTFgoLQBAACAW4skv8aCYhqgtAEAAIDPzWJBMQ1Q2gAAAMBvzWJBMcWUNgAAAPBtHxcUw9kpbQAAAOBulxmmbma1MZgapQ0AAADc7yJuluLMlDYAAACwm0WSf8bNUpyJ0gYAAAB2N88wcbOojcEUKG0AAABgP7MMxc1lbQzGTmkDAAAA+5tluFXqsjYGY6a0AQAAgId7k+RZdQjGSWkDAAAAh3mVobyBo1LaAAAAwOEuo7jhyJQ2AAAAcByXUdxwREobAAAAOJ7LDDdLzWpjMAZKGwAAADiuZRQ3HIHSBgAAAI5vEcUNB1LaAAAAwGksorjhAEobAAAAOJ1FFDc8kNIGAAAATmsRxQ0PoLQBAACA01tEccOelDYAAABwHosobtiD0gYAAADOZxHFDTtS2gAAAMB5LaK4YQdKGwAAADi/RRQ33ENpAwAAADUWUdxwB6UNAAAA1FlEccM3KG0AAACg1iJDcQOfUdoAAABAvUWSN9UhaIvSBgAAANpwGcUNn1DaAAAAQDsuo7jhhtIGAAAA2nKZ5EVxBhqgtAEAAID2/JihvGHClDYAAADQpjdR3Eya0gYAAADa9SbDzVJMkNIGAAAA2vZzFDeTpLQBAACAts0yFDfz2hicm9IGAAAA2jdL8tPNRyZCaQMAAAB9WGSYuGEilDYAAADQj0WG5cRMgNIGAAAA+nKZ5EVxBs5AaQMAAAD9+TFDecOIKW0AAACgT2/iKvBRU9oAAABAv1wFPmJKGwAAAOjXLK4CHy2lDQAAAPRtETdKjZLSBgAAAPp3keRVdQiOS2kDAAAA4/AsbpQaFaUNAAAAjMeruFFqNJQ2AAAAMB6zDDdKzWpjcAxKGwAAABiXWYbihs79vjoAwAG+rw4A0IBZ6sfg/5BkfqK/e37CvxtgzBYZjko9L87BAX734cOH6gwHeff2UXUEgAd5/OT9QX/e1z+AvSzysKMCs+xXiv3njr9/378X4KGeJrmqDnEMhz5/7pFJGwAApmB9wJ+9/vQnZyzd57l7ymj5jV//1uTTt34/MG6vMnwNXNfG4CGUNgAA0KbNzeNbVgf+/bP8dtpn+cmPPy1/5nFMDXo1S/JTkj8n2ZYmYW9KGwAAmKZtflv8fPnzr1l+8vEPGYqfxTECASczT/ImyQ/FOdiT0gYAANjH6ouPHy1vHn+6+Tg7TxxgRxdJniV5XZqCvShtAACAY1jl8yJnkaG8+S5KHGjFqwyfp+vaGOzqP6oDAAAAo7TO8I7+D0n+K8M+jef5YrEzcHY/RYnaDaUNAABwDuvclji/S/L9zc83VYFgouYZ9tvQAaUNAABQYZVh8uaPN4/nOfxGLGA3Fxn229A4pQ0AAFBtk2Hq5vsMR6mexjEqOLVXcfNb85Q2AABAS7ZJrnK7C0eBA6djv03jlDYAAECrtvltgbOuiwOjM4/9Nk1T2gAAAD3YZihw/pxhB87LWGIMx3CR5LI4A9+gtAEAAHqzSfIiQ3nzfYYyB3i4VxmmbmiM0gYAAOjZKsOxqf/KcAPVpjIMdGqWYb8NjVHaAAAAY7DNcAOV6Rt4mEWGCTYaorQBAADGZpVh+ubj7pttZRjoyI9xDXhTlDYAAMBYbTJMDny8eWpTmAV64RrwhihtAACAKbjK7dGpVWkSaNs8w8QNDVDaAAAAU7LKUNx8n+S6NAm061mSZXEGorQBAACmaZXkhwzTN1elSaBNb+KYVDmlDQAAMGWb3C4tvipNAm2ZxzGpckobAAAA5Q18zbM4JlVKaQMAAHBrk9vyZlWaBNrgmFQhpQ0AAMBvbXK7sHhVmgRqzeOYVBmlDQAAwLetMhQ3P2QocmCKnsUxqRJKGwAAgPtdZzgy9TzJtjQJ1HBMqoDSBgAAYHevM5Q3r2tjwNnN45jU2SltAAAA9rPNMHFjWTFT8yzJojjDpChtAAAAHmYT+26YnjfVAaZEaQMAAHCY6yR/TvKyOAecwyLJi+IMk6G0AQAAONw2wwvZP8eRKcbvbxl23HBiShsAAIDjWWc4MuWWKcZsFsekzkJpAwAAcHyvM0zdXNfGgJNZJrkozjB6ShsAAIDT2GRYUvxDTN0wTq8yTN1wIkobAACA07rOcD34dW0MOLp5kh+rQ4yZ0gYAAOD0tjF1wzg9y3CjFCegtAEAADif67hhivF5VR1grJQ2AAAA57XJ7Q1TMAbLJJfFGUZJaQMAAFDjdYapm3VtDDiKH2Mp8dH9vjoAALfevX00y7jPBC/imzmcyjrj3JOxjRe0jNs6w9TNq5hUoG/zDPttXpSmGJnfffjwoTrDQd69fVQdATi9+c3jLss9/r7vHhokSgeAsdnmsFLolyP+c1YH5GAcLuMKZfr3xwxHAI/u8ZP3p/hrm6a0AY5tns8Lli9/nny9NJll3BMmAPBQm/z2BdA2yb+++LV1Pp+2+vLn9GGR5E08L6Jf1xluSTs6pU2HlDZwcrPcPmlY3Pz8P/P5E4nl+eIAAA+wyW3xs07yf/l8+md13jjcYxbHpejb9znB1xWlTYeUNnCwWYYCZn7z+MMnP55XBAIAyqwzlDm/5LbU+fhrnN9lhqkb6M06w5Lto1LadEhpA3tZZiho/nDzcRFnpgGA+20zvAj7JbdFzqYqzMQskvwUb6bRn6dJro75FyptOqS0gW9aZChp/pTbggYA4Fg2uS1yVnHL1ynNMhQ3y9oYsJdNhmmb7bH+QqVNh5Q28G/Lm8d38Q0dADi/TYby5pcMi0i3dVFG603suaEvL3PEK8CVNh1S2jBhyyhpAIB2rZL8d4YCZ1MZZGQuY88N/dhmuAJ8e4y/TGnTIaUNE7LIbUlzURkEAGBP6wwlzj/iGNUxLJL8HLsJ6cNVhv02B1PadEhpw4jNMpQ0f7n5OK+LAgBwNJsM0zcKnMMsMkzcLGpjwE7+mCNM3CltOqS0YWTmGaZoPhY1AABjtslQ3lzFEaqHmGWYuFnUxoB7XeUI0zZKmw4pbRiBRZK/5vY6bgCAKVon+XssMX4IC4rpwfcZjkk+mNKmQ0obOrXIUNRcxLEnAIBPbXN7fGpVGaQzr5I8qw4Bd1hlKG4eTGnTIaUNHVlEUQMAsI9NhiuDr2P6ZheXcbMUbTto2maKpc1/VAeAkVtkeNfj1yT/zPDux7wuDgBAV+YZSohfbz7OK8N04CpHuqUHTuTH6gC9UdrA8c0zlDP/jKIGAOAYZhmmSH7NsHh3WZildVdJ/hyTSbRpGZ+/e1HawPFcJvkpw5OJV7FUGADgFJYZiptfY/nut6wzHEPZ1saAr3pVHaAnShs4zCLDF53/zTCye1EZBgBgQua5PTp1WZqkTesobmjTIj5nd6a0gf3NMnyR+fT406wsDQDAtM0zlDf/m+RFPC/71DqKG9pkt82OlDawu3k+X4S3qAwDAMBnZhleCP4a5c2n1hl23KxrY8Bn5jFtsxOlDdzvIp+fm54VZgEA4G6zDOXNP+NF4UebDBM369oY8BnTNjtQ2sDXzTK8Q/NrhuXCy8IsAADsbx47bz61jeKGtszjc/NeShv43Dy339x/jKu6AQB6N8/w/M5V4Yob2vO36gCtU9rAYJnb67ov4wgUAMDYLDMUNz9l2m/MbaO4oR2LKFPvpLRh6i4yfPP+Oa7rBgCYgotYVrxN8kPcKkUb7La5g9KGqbqMfTUAAFP2cVnxRXGOKpu4Dpw2LOM12TcpbZiay9xe2T0vTQIAQLV5hjfxfs40nxuuo7ihDaZtvkFpw1RcRlkDAMDXLTNM3byojVFiHcUN9ZYZ9tvwBaUNY3cZZQ0AAPeb5fbI1KI0yfmtMxQ3UMlNUl+htGGsLqOsAQBgf4tMc+pmneRpdQgm7TJeu/2G0oaxWUZZAwDA4aY4dXMVxQ217Lb5gtKGsVjm9urueWkSAADGYpHpTd1cJXldnIHpushwVJEbSht6N8/txv9laRIAAMbq49TNvDjHuTzPUN7Auc2SPCvO0BSlDb2aJXmV4SjURWkSAACmYJGhuLmsjXE2T5OsqkMwSRYSf0JpQ49eZChrntXGAABgYmYZdie+yTSOcPyQYUExnNMs0ylH76W0oSfLDGXNj5nGN0kAANp0meF4/qI2xsltMxQ329oYTJCFxDeUNvRgHkuGAQBoyyLD89PL2hgnt0nyfXUIJmceO0uTKG1o2yy3R6GWlUEAAOArZhmOSr0qznFq67gKnPOz2yZKG9p1kWHRm7E4AABa9yzDc9dZbYyTuoqrwDmvizhpobShOfMMV3j/FJ+gAAD0Y5FhQnxRG+OknseNUpzX5KdtlDa05FmGdyguamMAAMCDzDL+PTc/ZNhzA+dwWR2gmtKGFiwylDWvMu6RUgAAxm+WYc/Ni9oYJ7ONG6U4n1kmXtwobaj2IkNhs6iNAQAAR/VjhvJmjNYZjkrBOUz6iJTShirLWDQMAMC4XWa8C4qvYjEx57HIhN/kV9pQ4VWGs76L4hwAAHBqiwzPfWe1MU7ieYapGzi1yU7bKG04p0WGdxqe1cYAAICzWmS8N0vZb8M5XGScxee9lDacy4vYXQMAwHTNMs5p802Sp9UhGL1ZJnrLsNKGU5vH7hoAAEjGW9xcx34bTm+SR6SUNpzSs5iuAQCAT80yFDeXtTGOzn4bTm3x7u2jRXWIc1PacAqzJD9lWDg8K00CAADtmWW4DvyyNsbR2W/DqU1u2kZpw7EtMyxZu6iNAQAAzRtbcbPJMHEDp3Lx7u2jWXWIc1LacEwvMt7rDAEA4BTGVtxcZdhxA6cwy8QGBJQ2HMMsQ1lj2TAAAOxvbMXN0wxTN3AKf60OcE5KGw61zHAcalkbAwAAuvYm43lOvY1rwDmd5bu3j+bVIc5FacMhXsRxKAAAOJafMp6bV1dxDTinc1kd4FyUNjzELMM3FMehAADgeGYZ3hRd1MY4mpdxTIrTmMwRKaUN+1ok+WcmtvwJAADOZJbxFDfbOCbFaczfvX20qA5xDkob9nGZ4RvIvDYGAACM2izDZPusNsZRrOKYFKfxt+oA56C0YVevMixHmxXnAACAKZhnPPsjHZPiFC6qA5yD0ob7zDJ8s3hWGwMAACZnkWHipnfbOCbF8c3evX10UR3i1JQ23GWRobBZ1sYAAIDJWmaYeO/dKslVcQbG5y/VAU7tdx8+fKjOcJB3bx9VRxirZcZzjhYAAHr3PP3vhpkl+TVeY3A82yR/fPzk/bY4x8mYtOFrLjOe87MAADAGr9L/Do9thvIJjmWW/j8v7qS04UsfFw4DAABteZP+rwK/ynBUCo5l1EekHI/io1mGwuayNgYAAHCHdZLvM0yt9Gqe4ZgUHMt/jfWIlEkbktsboi5rYwAAAPdYpP/J+E2Ga8DhWC6qA5yK0oZ5hsJmURsDAADY0UWSF8UZDvU6Q3kDxzDaI1JKm2lbJPlnFDYAANCbHzPc+NqrbUzbcDwX794+mlWHOAWlzXQt4oYoAADo2U8ZJud7dRVLiTmei+oAp6C0mabLKGwAAKB3swzFTc9cAc6xjPKIlNJmei4zLC6b1cYAAACOYJHhFtherTNM3MChltUBTkFpMy2X6X/TPAAA8Lln6fsF6/P0fYU5bZi9e/voojrEsSltpuMyChsAABirn9LvNP02yd+rQzAKozsipbSZhjdR2AAAwJjN0vdz/tcxbcPhLqoDHJvSZvzeZJiyAQAAxu0i/T7338ZSYg43e/f20aI6xDEpbcZNYQMAANPyKv1eA36VZFOcgf79tTrAMSltxkthAwAA0zNL38ekXlYHoHvL6gDHpLQZJ4UNAABM1zLDjVI9ukqyKs5A3xbv3j6aV4c4FqXN+ChsAACAH9PvMSnTNhzqojrAsShtxkVhAwAAJH0fk1rFtA2H+a46wLEobcbjRRQ2AADArWX6nTgwbcMhLqoDHIvSZhwuM4w/AgAAfOpNhqmb3qxi2oYDvHv7aFmd4RiUNv27TL9jjwAAwGnN0u8bvKZtOMRfqgMcg9Kmb5dR2AAAAHd7lj6vQV7FtA0Pt6wOcAxKm35dRGEDAADsptdpm79XB6Bbo7j6W2nTp0UUNgAAwO6W6fPikuskm+IM9GtZHeBQSpv+LJL8nD6XiQEAAHVepc/XEXbb8FDdX/2ttOnLLMlP6fMLLQAAUGuWYb9Nb65i2oaHWVYHOJTSph+zDBM289oYAABAx35Mn68p7LbhIebv3j5aVIc4hNKmHz9lOBoFAABwiB6XEl8l2RZnoE/L6gCHUNr04U06/w8NAABoxmX6e32xzVDcwL663mujtGnfs/S55R0AAGhXj9M2jkjxEMvqAIdQ2rTtMsOGdwAAgGNapr8Xs5uYtmF/s5732iht2rWIwgYAADidHqdt/lEdgC4tqwM8lNKmTbMMN0XNamMAAAAjtkx/L2ZXcf03+/tTdYCHUtq0ZxaFDQAAcB49Ttu8rA5Ad5bVAR5KadOeV3G1NwAAcB7L9PeC9jqu/2Y/83dvH82rQzyE0qYtz+KmKAAA4Lx6m7bZZihuYB/L6gAPobRpxzIWDwMAAOe3TH8vaF3/zb663GujtGnDPMlP1SEAAIDJ6m3aZn3zgF0tqwM8hNKm3ixDYTOrjQEAAEzYMv29qDVtwz4W1QEeQmlTz+JhAACgBX+tDrCn6+oA9OXd20fL6gz7UtrUuozFwwAAQBsuM6xu6MU2yVVxBvqyrA6wL6VNnUUsHgYAANryt+oAe/rv6gB0pbtlxEqbGrPYYwMAALTnMn29TrlOsinOQD+W1QH2pbSp8SZ9jR0CAADTMEt/KxyuqwPQjdm7t4/m1SH2obQ5v8skF8UZAAAAvqW3I1L/qA5AVxbVAfahtDmvReyxAQAA2jZPX8dI1nFEit0tqgPsQ2lzXm/S1/lQAABgmnq7/tu0Dbv6rjrAPpQ25/MqnTV6AADAZF2mrzecr6oD0I1FdYB9KG3OY5nkWXEGAACAfVxWB9jDJsMxKbhPV8uIlTanN8twvTcAAEBPLCRmrObVAXaltDk9e2wAAIAezdPXUZJVdQC6sawOsCulzWldxvXeAABAv3qatlnHLVLs5k/VAXaltDmdeVzvDQAA9O2iOsCerqsD0IV5dYBdKW1Ox7EoAACgd7P0tZDYXht2sagOsCulzWk8S0dn5AAAAO7wl+oAe1gn2RZnoAPv3j5aVmfYhdLm+OZJfqwOAQAAcCQX6esUwXV1ALowrw6wC6XN8TkWBQAAjM1FdYA9/FIdgC7MqwPsQmlzXBdxLAoAABifno5IXVcHoAvfVQfYhdLmeGYZpmwAAADG5iL9nCjYJlkVZ6B98+oAu1DaHI9jUQAAwJhdVAfYgyNS3GdeHWAXSpvjWKavL2AAAAD7ckSKUenhBimlzeFmcSwKAAAYv2V1gD2s4+pv7jerDnAfpc3hnqWTsSoAAIADzNLXCYNVdQCat6gOcB+lzWHmSX6sDgEAAHAmXdy4c8NeG+7zh+oA91HaHMaxKAAAYEouqgPsYVUdgObNqwPcR2nzcBfp60wnAADAoebp4IXujXXsteFuy+oA91HaPMwsyavqEAAAAAUuqgPsYVUdAA6htHmYZ+mnXQYAADgme20Yjdav/Vba7G+e5G/VIQAAAIosqwPsYV0dgObNqgPcRWmzv1dp/F8qAADACc3SwVXJN1bVAWjeojrAXZQ2+1mmr/ObAAAAp3BRHWAPq+oANO0/qwPcRWmznx+rAwAAADSgp7026+oANG1RHeAuSpvdXaavs5sAAACnsqgOsId/VQegabPqAHf5fXWAjpiygc9tkry8+QgAtGWRYRcjnMosw39n69IUu1lVB6Bpi+oAd1Ha7OZFXPENH20ylDVXtTH69/jJ+4P+/Lu3j46UBIB9dPL1e5Vkm+TNOf5hTNYyfZQ2mwyfD7PSFPAAjkfdbxZXfEMyfLN7muSPUdgAQA+ukvw5w4tVOAV7bRiFd28fLaszfIvS5n7PopFl2jZR1gBAr9ZJvo/ihtNYVAfYw7o6ADyE41F3m8WUDdO1iWNQAPAbHR5PXWcobn6ONyM5rnmG/6a2pSl2Yxkxd1mk0d1HJm3u9iq+sTE9m5isAYCxWWf43r6ujcEILaoD7GhdHYCmzaoDfIvS5tvmGa75hqnYRFkDAGO2zTBxs66NwcgsqwPsaF0dgKb9oTrAtyhtvs0V30zFKsoaAJiKbRQ3HNefqgPsYV0dgGbNqwN8i9Lm6+YxZcP4rTI8afs+yhoAmJJthlulrmpjMBKL6gB72FQHgH0pbb7OlA1jtsptWbMqTQIAVHoaxQ2Hm6fhfSBfsIyYb1lUB/gWpc1vzWPKhnFaRVkDAHxOccMxLKoD7GhTHYBmzaoDfIvS5rdM2TA2qyhrAIBvU9xwqEV1gB1tqgPAvpQ2n5vHlA3jsYqyBgDYjeKGQzR7884XVtUBaNe7t4+W1Rm+RmnzOVM2jMEqyhoAYH+KGx5qUR1gD9vqALAPpc2tWZKL4gxwiE2SH6KsAQAe7nlci8z+FtUB9rCuDgD7UNrcepaGlw/BHbYZnmD9Mcl1aRIAoHfbDG8CbWtj0JlZ+nktta0OQLMW1QG+RmkzmCX5W3UIeICrDGXN69oYAMCIbDIclYJ9LKoD7Mi133zLrDrA1yhtBpdp9F8QfMM6wzGop/FuAQBwfNfxphD7mVcH2NG2OgDsQ2kzMGVDL7ZJXib5c+ytAQBO62Vckczu5tUBdrSuDkCz/rM6wNcobYYpm3lxBtjFKkNZ86I2BgAwEdsMe/NgF71c+w3fsqgO8DVKm+Sv1QHgHtsMT5i+j3e7AIDzuo7pXnYzrw6wo1V1ANjH1Eub5c0DWrXOMF3zujYGADBhpm3Yxbw6AIzR1EsbUza07OPumk1xDgBg2tYZbqyEu8yrA+xhXR0AdjXl0maeYZ8NtGaT4SjUi9oYAAD/9rI6AF2YVQfY0bY6AE1aVgf4mimXNpfVAeArruNmKACgPZt4fsL9FtUBYGymXNq45pvWPE/yQzT/AECb/l4dAI7kl+oAsKupljaX6Wd0j/HbZjgO9bo2BgDAna5j1x53W1YHgLGZamljATGtWMdxKACgH9fVAQCmZIqlzTwaYNpwlWHCZlMbAwBgZ/+oDgBHsKkOQJvevX00r87wpSmWNnbZ0IKXSZ7G/hoAoC/reP7Ct31XHWBHm+oANGteHeBLUyxtLqsDMHlP4zpvAKBf19UBAKZiaqXNZSwgps42w3Goq9oYAAAHcfMOwJn8vjrAmVlATJVthsJmXRsDAOBg6+oANGteHWBH2+oAsKspTdrMYwExNdZR2AAA47GuDkCz5tUBdrSuDgC7mlJpc1kdgElaR2EDAIzPqjoAwBRMqbRxNIpzW2cobLa1MQAAjm5bHQBgCqZS2izTz6ge47COwgYAGK9/VQcAmIKplDambDindRQ2AAAAHGgqpc1FdQAmYx2FDQAwfpvqADRrXh0AxmQKpc1FkllxBqZhHYUNADANm+oANGteHQDGZAqljaNRnMM6ChsAAACOaOylzSyORnF62yhsAAAAOLKxlzYX1QEYvW0UNgAAAJzA2Eubv1QHYNS2GQqbdW0MAICzW1QHAJiCMZc2s5i04bSeR2EDAEzTrDoAwBSMubS5qA7AqD1PclUdAgAAgPEac2njaBSncpXkdXEGAIBK31UHAJiCMZc2y+oAjNIqydPqEAAAxWbVAQCmYKylzUV8I+H4Nkl+qA4BANCARXUAmrWqDgBjMtbSxtEojm2bobDZ1sYAACi3rA4AMBVjLW0uqgMwOm6KAgAYLKoDAEzFGEubRRyN4riu4qYoAICPLCGmd4vqALCrMZY2f60OwKisY/EwAMCnltUB4ECz6gCwqzGWNsvqAIzGNhYPAwB86iJe8AKczdhKm3mMunE8zzPcGAUAwMCFH9xlVR0AxmZspc2yOgCjcR17bAAAvnRRHQCOYF4dgGatqwN8aWyljeafY9jEHhsAgC9dxtEoxmFeHYA2PX7yflud4UtjK22W1QEYhacZ9tkAAHDLhR/cZ1MdAMZmTKXNIpp/Dvc6zuICAHxpEW+Qcr//qQ6wo/+sDgC7GlNpc1EdgO5tkrysDgEA0KC/VQeAI1pUB4Bdjam0+a46AN1zLAoA4LfmGfbZwH021QHgANvqAF8zptJmWR2Arl3HsSgAgK95VR2AbmyqA+xoXh2AJq2rA3zNWEqbZXUAuraN26IAAL5mGWsIGJ95dQDYldIGkudpdBQOAKDYj9UB6MqqOgCMzVhKG/tseKhVkqviDAAALVrGm6OMz7I6AM3aVgf4mrGUNsvqAHTLbVEAAF/3pjoAXVlVB4AD/as6wNeMobRZVgegW1fxzQUA4Guexd4PxmlRHQD2obRhqrYxZQMA8DXz2GXD/n6pDrCjWXUA2McYSps/VQegS39PP1cSAgCc05t4Ycv+ttUBduT1I9+yqQ7wNWMobZbVAejONsnr4gwAAC16Ec+veZh1dYAdzaoD0KxNdYCv6bq0eff20Tw+6djf39PPOwEAAOdyEceieLhNdYAdLasDwD66Lm3iE479bTK8gwQAwK1F3BbFYTbVAXYwqw5A0zbVAb6m99LGeUT2ZfkwAMDnlkl+jhe0PNyqOsCOFtUBaNfjJ+831Rm+pvfSZlEdgK5sMlzzDQDA4FkUNhxuUx1gR4vqALCv31cHONCyOgBdMWUDADCYJ3mVYY8NHOp/qgPs6A/VAWjWpjrAt3Rb2rx7+2hRnYGubJNcF2cAAKg2yzBd87eYruF4VtUBdrSoDkCzNtUBvqXb0iY+4diPG6MAgCmbRVnD6ayrA+xoUR0A9tVzaWMJMbvaJnldnAEAoMIyyV8zHIOaVQZhtDbp483RWXwO8G2/VAf4lp5Lm0V1ALpxnT6+kQAAHMNFku9uPs4rgzAJ6+oAO1pUB4CH6Lm0WVYHoBsWEAMAYzXL8GJ0maGoWdZFYaL+VR1gR8vqADRtUx3gW7osbSwhZg/rNPwJCACwh0WGyZlFhlUBH38OlVbVAXZkvQZ32VQH+JYuS5v45sTu/l4dAABgD8svPn6X22kaaNG6OsCO5tUBaNq2OsC39FraLKoD0I3r6gAAwOQtP/nxIrfLUL+7+TiPF5T0aZ2GX+x+YVEdgHY9fvJ+XZ3hW3otbYy2sYur9PNNBABoz/IrvzbLb1/8/Smf30ozjxKGaVhVB9jRsjoATdtWB7hLr6XNvDoAXfjv6gAAwJ0WefgVvMsdf98fcvdzx/k9/zvwbZYQMwbr6gB36bW0WVQHoAvX1QE4uRfVAQ7x7u2j6giwr+/u/y2MzCyedwHftqoOsCMnNehWd6WNm6PY0XV1AM7ix+oAAAATtUnDN+58YVkdgKb9Uh3gLv9RHeAB5tUB6IKjUQAAcDqr6gA7mufhxzCZhm11gLv0WNosqgPQhVV1AAAAGLFe3iRdVgegeevqAHfpsbT5Q3UAmrdOP6OaAADQo1V1gB3Zx8Z9ttUB7tJjaTOvDkDzVtUBAABgxNZp/IXuJ5bVAWjb4yfv19UZ7tJjabOoDkDzml4kBQAAnevlaNQ83vTnbpvqAPfpsbSZVQegeavqAAAAMGLX1QF2tKwOQPM21QHu01Vp47pvdrBOP6OaAADQm20aX9z6CftsuM+6OsB9uiptYsqG+62qAwAAwIhdVwfYw0V1AJr3f9UB7tNbabOsDkDz7LMBAIDT6WWfzSLe9Od+q+oA9+mttIH7rKsDAADASG3Tz6TNsjoAXdhUB7hPb6XNn6oD0LRtOvikAwCATl1XB9jDX6oD0L7HT95vqjPcp7fSZlYdgKatqwMAAMCI9XI0ahaTNtxvXR1gF72VNvPqADTNPhsAADiNbfqZtFlWB6ALm+oAu1DaMCab6gAAADBS19UB9uBoFLv4V3WAXXRT2rx7+2hWnYHmrasDAADASPVyNCpx1Te7WVcH2EU3pU2GK9vgLuvqAAAAMELb9DNps4hdqOxmUx1gFz2VNnCXTXUAAAAYqavqAHv4a3UA+vD4yft1dYZd9FTazKsD0LRNdQAAABipf1QH2MNFdQC6sKoOsCulDWPh5igAADi+dfpZQ7CI143sZlMdYFc9lTYAAACcV09TNsvqAHSji5ujkr5Kmz9UB6Bpq+oAAAAwQlfVAfZgnw27WlcH2FVPpc28OgAAAMCEXGW4OaoH87hxmN2tqwPsqqfSBu6yqg4AAAAj8/fqAHu4qA5ANzaPn7zfVofYldIGAACAL63T0TRCkr9VB6Ab6+oA++iptFlWB6BZ6+oAAAAwMj1N2SxinQa762YJcdJXaQPfsq0OAAAAI7KNBcSM16o6wD6UNozBtjoAAACMSE9TNol9NuxnXR1gH0obxqCr8TYAAGjc6+oAe7iIo1HsrqslxEknpc27t48W1RkAAAAm4Cp9TbL/pToAXVlVB9hXF6VNkll1AAAAgAl4WR1gD7M4GsV+ujul0UtpA3dZVQcAAIARuEqyKc6wj4t4g5/9rKsD7EtpAwAAQNLXlE2S/K06AH15/OT9qjrDvpQ2AAAAXKWvKZt5kkVxBvqyqg7wEEobAAAATNkwduvqAA/RS2kzqw5A09bVAQAAoGNX6WvKJkkuqwPQnV+qAzxEL6XNojoATdtWBwAAgI71NmVzGW/ss791dYCH6KW0AQAA4Piu0t+UzV+rA9CdzeMn7zfVIR5CaQMAADBdvU3ZLJIsizPQn1V1gIdS2gAAAEzT6/Q3ZWMBMQ/R5T6bRGkDAAAwRdv0N2UziwXEPMyqOsBDKW0AAACm5+/p70KPZ9UB6FK3+2wSpQ0AAMDUbJK8KM7wEBYQ8xCr6gCHUNoAAABMy/PqAA9wmWRenIE+dbvPJlHaAAAATMkqyXVxhof4sToA3VpVBziE0gYAAGA6nlYHeIBlTNnwMF3vs0mUNgAAAFPxMv1d8Z2YsuHhVtUBDqW0AQAAGL9NktfFGR5iefOAh/jv6gCHUtoAAACM39P0d8V34sYoDrOqDnAopQ0AAMC4XafPF6/zDLdGwUOsHz95v60OcaheSpttdQAAAIAObdPn8uHELhsO0/3RqKSf0mZdHYCmLaoDAABAo3o9FjWPKRsOs6oOcAy9lDZwl1l1AAAAaND1zaNHpmw4xPbxk/er6hDHoLQBAAAYn236PRY1jykbDrOqDnAsShsAAIDx6fVYVGLKhsONYp9NorRhHObVAQAAoCHX6fdY1DymbDjcdXWAY1HaMAbz6gAAANCITfo9FpUkb6oD0L1RXPX9US+lzbo6AAAAQAd6Pha1vHnAIf5RHeCYuihtxtSScRL/WR0AAAAa8DJ9L2C1y4ZjWFUHOKYuShu4x6I6AAAAFFsleVGc4RAXMWXD4TaPn7xfV4c4JqUNAABA37ZJfqgOcaBX1QEYhevqAMfWU2mzqQ5AsxbVAQAAoNAP6XePTZI8i8tFOI7RXPX9kdKGMZhVBwAAgCK977GZxS4bjmP7+Mn7VXWIY+uptIG7zKsDAADAmV2n7z02yVDYzKpDMArX1QFOQWnDWMyrAwAAwBltMlzv3bN5hqNRcAyjOxqV9FXa/FIdgKbNqwMAAMCZbNP/HpskeVMdgNHYPn7y/ro6xCn0VNrAXebVAQAA4EyeJllXhzjQRVzxzfFcVwc4FaUNY/GH6gAAAHAGL9P/C9RZXPHNcY3yaFTSV2mzqg5A0+bVAQAA4MSu0v/i4cQV3xzXaI9GJX2VNnCXZXUAAAA4oXX6XzycDGWNK745puvqAKfUU2mzrQ5A82bVAQAA4ATWSb6vDnEklg9zbKM9GpUkv/vw4UN1hp29e/uon7BU+D6O0U2NrwkAwNhtk/w5wxXfvbuM0obj2j5+8v6/qkOcUk+TNnCfZXUAAAA4om2GNyY3tTGOYhbLhzm+q+oAp9ZbabOqDkDT3CAFAMCYfJ/+r/b+6E2sM+D4/lEd4NR6K23gLovqAAAAcCRPM57C5uLmAce0efzk/bo6xKn1VtqsqwPQtEV1AAAAOIKnGc+xj1nsseE0Rj9lk/RX2vxfdQCat6wOAAAABxhTYZM4FsXpXFUHOIfeSpt1dQCat6gOAAAADzS2wuYijkVxGuvHT95vqkOcQ2+lzbY6AM37rjoAAAA8wNgKm1kci+J0/l4d4Fx6K23W1QFo3rI6AAAA7GlshU3iWBSns01yXZzhbLoqbR4/eb+tzkDzZnFECgCAfoyxsLmMY1GczvWUuoGuSpsb6+oANG9ZHQAAAHYwxsJmnuRVdQhGbRK3Rn3UY2mzrQ5A8+y1AQCgdWMsbJLkpzgWxelsHj95v6oOcU49lja/VAegecvqAAAAcIexFjYvYlUBpzWZBcQf9VjabKoD0LxZFDcAALRprIXNMsmP1SEYvevqAOemtGGs/lIdAAAAPrFN8ueMs7CZZTgWBad0/fjJ+011iHPrsbRZVwegCxfVAQAA4MY2yfcZ72sZe2w4h0ktIP6ou9Lm5mqvbXEM2je/eQAAQKV1hgmbdW2Mk3kRqwk4vU0meDQq6bC0ubGuDkAXLqoDAAAwaesMEzab2hgns4w9NpzH5BYQf6S0Ycz+Vh0AAIDJusowYbOtjXEy89hjw/lcVQeo0mtp8z/VAejCPK4cBADg/F5muCVqrGaxx4bzucp4y8979VrarKsD0A3TNgAAnMs2Q1nzojbGyb2KN0c5n0kuIP5IacPYXcQ7AAAAnN4mw/6aq9oYJ/csyWVxBqZjnWRVnKFUl6XNzQ1Sm+IY9GEWC4kBADitVcZ9Q9RHywxTNnAuk11A/FGXpc2NdXUAuuGIFAAAp/I6w4TNtjbGyS1i8TDntc34J9fu1XNp86/qAHRjkeFdAQAAOJZtkh+SPC/OcQ6zJG9i7QDnNfkpm6Tv0mZVHYCu/FgdAACA0VhnmK65ro1xNj/H4mHO73V1gBb0XNqsqwPQlWV8owEA4HBXGQqbdW2Ms3kTz6M5v6uM/8jhTrotbSwj5gHstgEA4KG2GY5DPc10Xky+iJuiqPGyOkArui1tbqyrA9CVyyTz4gwAAPRnneF2qOvaGGd1GSsGqLGKAY1/6720sYyYffnGAwDAPl5mKGw2xTnOaZnhWBRUMGXzid5Lm1V1ALpzGdM2AADcb5OhrHlRG+PsFnG1N3XW8Tr/M12XNo+fvF9VZ6BL3jUAAOAurzMUNuvaGGe3yHBT1Kw2BhPmmu8vdF3a3FhXB6A7y5sHAAB8apPhZqjnmc6y4Y9mGSZsZrUxmLBNhluj+MQYSptVdQC6ZLcNAACfep1humZVG6PELMOEzbw2BhNnl81XjKG0sYyYh1jG9YUAAEx7uia5LWwWtTGYuG1M2XzVGEqbVXUAuvVjjH8CAEzZx5uhVsU5qsyisKENdtl8wxhKm02mdf0exzNP8qw4AwAA57fK7c1Q28oghWZR2NCGbYbjiXzFGEqbZLrNOIf7W5zdBQCYim2SpxmOQ61Lk9SaRWFDO/6e6Zan9xpLafNLdQC6NYsrwAEApuB1kj/G3oxZFDa0YxtTNncaS2mzqg5A15ZJLoozAABwGqsMR6Gmumj4U7MobGiLKZt7jKW02cReGw7zJpYSAwCMySbJD3EU6qNZFDa0ZRtTNvcaS2mTmLbhMLMMt0kBANC3bYZbof6Y5Lo0STtmUdjQHlM2OxhTaWOvDYd6luGoFAAAffpY1rwoztGSWRQ2tGcbUzY7GVNpc10dgFFwTAoAoD9XuS1rtpVBGjOLwoY2mbLZ0ZhKm22cVeVw8zgmBQDQi6sMZc3T2HH5pUWSf0ZhQ3u2MWWzszGVNom9NhzHs7hNCgCgZasMC4aVNV+3yDBhM6+NAV9lymYPYytt/rs6AKPhmBQAQHtWGcqa7+MN229ZZihsZrUx4Ku2MWWzl7GVNqto7DiOWZKfqkMAAJBkOAb15yhr7nMZhQ1texmv2fcyttIm8UWc41nGzQMAAJWucruzZl2apH0vMkyLQ6s2MWWztzGWNo5IcUw/xvI2AIBz2mZ4YWfB8O7exGUatO9ldYAe/e7Dhw/VGQ7y7u2jL39pluR/z5+EEdtmeNKwrY3BV/T9BQwA+NQmw4LSq3jetatZhiP9y9oYcK9NhtdUB3n85P3hSTozxkmbbYxOclyz2G8DAHAqqwwTNX/MMGGzLczSk0WG/TXL2hiwk6fVAXo1xtImSf5RHYDRWSZ5VR0CAGAktvl8ufBVYZYeLTMUNovaGLCTVeyefbCxljbX1QEYpWcZNvIDAPAw17mdqrFc+GGexQ1R9MUumwP8vjrAiWxuHvPSFIzRqwxPLta1MQAAurDJ8A77LxkKm21dlO7NMjwXvayNAXu5iimbg4y1tEmGbwrPijMwPrMM72z8OW4yAAD40irDm1v/uvnxpi7KqMwz7Fhc1MaAvWxjyuZgYy5t/hGlDacxy/BN8/t4twgAmJ51bi//+L/cljObmjijt8zw3HNWGwP29vf4unCwMZc26zgixeksclvcAAD0bp3bN6O2GSZlks/LmNX54nDjRZIfq0PAA2wz3AbHgcZc2iSOSHFayyRv4vo6AOD8Vt/49U2S/9nh92/iHfCWzTK8QbisjQEP9jxOJRzF2EsbR6Q4tcubj4obAOjTNoddMLDOcERoV5vsVpas4wXPVC3jOBR9W2VYQMwRjL20WccRKU7vMsONCFe1MQA4oU3ankrY5OvTFee0znlKhk3a/ncBh3gRx6Hon+XDRzT20iYZpm184ePU3tx8vKoMAWe2Sd8vnLa53dnQo20Omw5owao6AEAj5hmeTy5rY8DBruL7+1H97sOHD9UZDvLu7aP7fss8ya+nTwJJhmNSV9UhJmRZHeBA68dP3m8f+od3+PoHALTvIkNhM6uNAQfbJvljTjh1+fjJ+1P91c2awqTNJsM7kYvSFEyFiZvzWlUHOMQUv+kAAP82y/Dc8aI2BhzNy9jFdXT/UR3gTP5RHYBJeZPbBcUAAPClZZJ/RmHDeGziiu+TmEppc1UdgMlR3AAA8KVZkldJfo7LUhgXt+meyFRKm22S6+IMTI/iBgCAj5YZpmue1caAo7tK52sLWjaV0iZxRIoaihsAgGmbxXQN47VN8rw6xJhNqbS5jqVI1HiT2wXFAABMx0WGm2yf1caAk7F8+MSmVNokdttQ5zKKGwCAqZgn+enmMStNAqeziuXDJze10ubv1QGYtMsMY7Gz2hgAAJzQs7gZimlwLOoMplbabGJBErWWUdwAAIzRMkNZ8yqe6zF+L5Osq0NMwdRKm8RCYuotMpxtXtTGAADgCGYZjsH/HM/vmIZNHIs6mymWNlexKIl6swzf2C9rYwAAcIAXGd6Mu6yNAWf1NF5Tn80US5vEQmLaMMvwrsyr4hwAAOznIkNZ82MchWJaXsfKkbOaamljITEteRZ7bgAAerDM8Lztpww3RMGUbDPssuGMplrabKIdpC3LDIvrFrUxAAD4inlu99YsS5NAHceiCky1tElM29CeeYbi5lltDAAAbswyHGW3t4apu755cGZTLm2uM0zcQGtexXEpAIBKs9wuGX5WGQQasM0wZUOBKZc2iWkb2rXM8CThojYGAMCkzHJb1lgyDAPHogpNvbS5iv/4aNcsw5K7V/GEAQDglGZR1sDXXMexqFJTL222cf037XuWYdfNsjYGAMDozKKsgW/ZxLGoclMvbRJHpOjDPMOeG1M3AACHm0dZA/dxLKoBSpuhPbwqzgC7eha7bgAAHmqe4epuZQ3c7XWSVXEGorT56B/VAWAPswy7bn7O8MQDAIC7LTM8f3J1N9xvneRldQgGSpvBKlpE+rPM8MTjRbxLBADwNZcZdgP+HJPKsCvHohqitLmlSaRXP8a7RgAAH81zu6/mTZJFYRbozcsMkzY0QmlzaxX/cdKvWYYnJW6ZAgCmapnP99XMK8NAh1YZCk8aorT5nJuk6N0iw/jvz1HeAADjN8vtRQ0/x+QxPNQ2rvduktLmc1cZbpOC3i2jvAEAxusiw1TN/yZ5FVM1cKin8Vq4SUqb37LbhjFZRnkDAIzDPENB82uGm6AuK8PAiFwluS7OwDcobX7rKhpGxmcZ5Q0A0J9ZhuNP/8xQ1jyLqRo4pnWS59Uh+DalzdeZtmGsllHeAABtm2WYovkpt8efFnVxYLS2cb1385Q2X3cV0zaM2zLKGwCgLRe5vf3pzc3PgdN5HjcoN09p822mbZiCZYbi5tc4Fw4AnN8itwuFP+6pmdXFgcm4unnQOKXNt13FtA3TMc/tO1uXpUkAgLFb5Hah8D+jqIFzW8cem24obe7mP2SmZh7lDQBwfPPcLhT+ZywUhirb2GPTFaXN3a6TrIozQIV5lDcAwGFmGZ5HfDyKbaEw1LPHpjNKm/vZbcOUzaO8AQD2c5nbm5/exKUH0Iqr2GPTHaXN/VYxbQPzKG8AgG+7yO1CYTc/QXvWGY5F0RmlzW7stoHBPMobAGCwyHDkyc1P0LZtkh+qQ/Awv/vw4UN1hoO8e/voXP+oN/EiFb60iVvWAGCK5rFIGHrxfUZyeuTxk/fVEc7u99UBOvIyw5jnrDYGNGUeT9gAAKBVzzOSwmaqHI/a3SbJ36tDAAAAwA6ukrwuzsCBlDb7eR332QMAANC2dexmHQWlzX628R8+AAAA7dpmWDy8rY3BMSht9ncVZwIBAABo0w9xWchoKG0e5mV1AAAAAPjC0xgyGBWlzcOsMkzcAAAAQAuu4nXq6ChtHu55nBEEAACg3irDlA0jo7R5uG0ckwIAAKDWOsMeG0ZIaXOY1xk+QQAAAODcthkmbLa1MTgVpc3hXAEOAABAhe9jkGDUlDaHW2WYuAEAAIBzeRqFzegpbY7jZYyjAQAAcB7P46aoSVDaHMc2NnUDAABweldx2mMylDbHc33zAAAAgFO4joGBSVHaHJet3QAAAJzCOgqbyVHaHNc2w34bAAAAOJZ1hpuitrUxODelzfG9znCjFAAAABxqG6c6Jktpcxo+oQAAADjUNsOEzbo2BlWUNqexiWNSAAAAHEZhM3FKm9N5HbdJAQAA8DBPo7CZPKXNaTkmBQAAwL6eJrmqDkE9pc1pbeNKNgAAAHansOHflDandx2fcAAAANzvdbx+5BNKm/N4nmE5MQAAAHzNVYbXjvBvSpvz2Cb5oToEAAAATbqK1Rp8hdLmfNZxDTgAAACfu4rChm9Q2pzXiySr4gwAAAC04SoKG+6gtDm/H+IacAAAgKm7isKGeyhtzm8b+20AAACm7CoKG3agtKmxiv02AAAAU3QVhQ07UtrUeRH7bQAAAKbkKgob9qC0qWW/DQAAwDRcRWHDnpQ2tbax3wYAAGDsrqKw4QGUNvVWSZ5XhwAAAOAkrqKw4YGUNm14neETGQAAgPG4isKGAyht2vE8ybo6BAAAAEdxFYUNB1LatGMbi4kBAADG4CoKG45AadOWTSwmBgAA6NnTKGw4EqVNe1bxCQ4AANCjp7GvlCNS2rTpKj7RAQAAeqKw4eiUNu16mmHqBgAAgHZtk3wfhQ0noLRp2w9xoxQAAECrthkKm1VtDMZKadO2bdwoBQAA0KJNhsJmXRuDMVPatG+T4QvBtjYGAAAAN9ZJ/hyFDSemtOnDOsnz6hAAAABkHW+scyZKm35cxVXgAAAAla4yTNhsa2MwFUqbvlwleV2cAQAAYIpexxvpnNnvqwOwt+dJZkkua2MAAABMxtO40psCJm369DTJdXUIAACAkdtm2F9zVRuDqVLa9OtpbCoHAAA4lU2GwmZVG4MpU9r0a5vhC8i6NgYAAMDorONKbxqgtOnbNoobAACAY7qKG6JohNKmf9sobgAAAI7hedwQRUOUNuOwzfCFZVsbAwAAoEvbJD9kuNYbmqG0GY91hombbW0MAACArqwzvJa6ro0Bv6W0GZd1FDcAAAC7WsW6CRqmtBmfdRQ3AAAA93kdr51onNJmnNbxxQcAAOBrthl2gj4vzgH3UtqM1zqKGwAAgE+tM7xOuqqNAbtR2ozbOoobAACAZFg0bH8NXVHajN86vjABAADT9jzDld7b4hywF6XNNKyjuAEAAKZnm+G10OvaGPAwSpvp2EZxAwAATMcqyR9vPkKXlDbTso3iBgAAGL+Xsd+TEVDaTM82tqUDAADjtM3weudFbQw4DqXNNG2TPI3iBgAAGI/rOA7FyChtpu1pLOQCAAD653YoRklpw/MM5Q0AAEBv1kn+HG9GM1JKG5LhmNTTaKUBAIB+vI6LVhg5pQ0fXcV2dQAAoH3bDEehnsfrF0ZOacOn1hlGC9e1MQAAAL7qOsOy4evaGHAeShu+tMkwcbOqjQEAAPBv21g2zAQpbfiabYbi5qo2BgAAQFaxbJiJUtpwl6dxsxQAAFDneYY3lDfFOaCE0ob7XGVotbe1MQAAgAlZx3QNKG3YyToWFAMAAKe3TfIyXn9AEqUNu9vEnhsAAOB0VhnKmhe1MaAdShv2sc2w4+Z5cQ4AAGA8trG7Br5KacNDvI49NwAAwOFWsbsGvklpw0Otk/wxwxdZAACAfWyT/BDTNXAnpQ2H2Gb4IvuyOAcAANCP1xneAL6ujQHtU9pwDC8ylDfb2hgAAEDD1hleNzyP1w6wE6UNx7KK41IAAMBvbXN7jfeqNAl0RmnDMW3juBQAAHDrOq7xhgdT2nAKLzJ8Yd7UxgAAAIpsMryh+0O8LoAHU9pwKuu4ug8AAKZmm2Hy3uoEOAKlDae0zbBk7IdYNAYAAGN3laGseVEbA8ZDacM5XMeVfgAAMFarDEehnsabtXBUShvOZZth4sbUDQAAjMMmQ1HzfRyFgpNQ2nBu13HVHwAA9Gyb2701V6VJYOSUNlTY5HaT/LY0CQAAsI/XsbcGzkZpQ6Xr2HUDAAA9uM7w3P15vPEKZ6O0odo2t7tuNqVJAACAL61yOyW/KU0CE6S0oRXXGXbdvK6NAQAAJFlnKGssGYZCShtass0wbvnnDN8kAACA89pkuBHK5SHQAKUNLVpn+CbhvCwAAJzHJkNZ40YoaIjShpa9jm8aAABwSpsoa6BZShtat83wTcRZWgAAOJ5NlDXQPKUNvVhlKG6expEpAAB4qE2UNdANpQ29ucrwDeZllDcAALCrTZQ10B2lDT3aJnmRYVnxVWUQAABo3CrKGuiW0oaebeI6QgAA+JpVhvUC30dZA91S2jAG69x+Q1qVJgEAgFpXGd7U9NwYRkBpw5iscruseFOaBAAAzmeb5HWGI1BPM7ypCYyA0oYxusrtN6xNaRIAADidTZLnGZ77Po/nvjA6ShvG7CrKGwAAxmeV5IcMz3Vfx62qMFpKG6bgKsobAAD6ts3n+2quC7MAZ6K0YUquorwBAKAvm9wegbKvBiZGacMUXcU3PQAA2nadYaLGESiYMKUNU3YV1yECANCOTZKXGYqaH+I5Kkze76sDQANWN49Fkr8luayLAgDABF0l+e/YUwN8waQN3FpnODL1xwzvcGwrwwAAMGrrDLtq/ivDc9DryjBAm5Q28FubJC9y+w10XZgFAIDx2GbYT/Pnm8freKMQuIPSBu52ldu9N1elSQAA6NVVhh01/5VhumZdGQbox+8+fPhQneEg794+qo7AtMwz7Lz5682PAQDga65zu6dmWxkExuLxk/fVEc5OaQMPd5GhvLmojQEAQCPWSf6RYbJmWxkExmiKpY3bo+Dhrm8eswzTN3+L6RsAgKlZZyhqrjPsRgQ4GpM2cFyLDOXNRYYyBwCA8Vnl9ujTpjIITMkUJ22UNnA6F3F8CgBgLK5jRw2UmmJp43gUnM51bo9PXST5SxQ4AAC92Obzogbg7EzawHnNosABAGjVOrclzboyCPBbU5y0UdpAnVkUOAAAlbYZCppf4tgTNE9p0yGlDSMxS7LMbYEzq4sCADBqqwzTNKuYpoGuKG06pLRhpJYZCpxlhhupAAB4mHVuS5pVZRDgMFMsbSwihjatcvukYp7PS5zZ+eMAAHRjleG40/rmx9u6KACHMWkD/VlkOEL1XYYSBwBgqrYZyplfYpIGRs+kDdCDdT4/f728eShxAICxW+e2pPn4Y4DRUtpA/1b5/F2l5c3jT3GcCgDo1yZDKfOvmKIBJkppA+OzyudPauYZjlQtMkzjLKLIAQDass5tQfPxx9uqMACtUNrA+G1uHtef/Nost0XOLEOZ8/HXAABOYZvbMuZfuZ2kWdfEAWif0gamaZtvjxnPv3j8Z27LnEVM6QDA1G3z26JlneT/Pvn56ov/bXu6OADjpbQBvrS5edxn+Y0f/yFD2fPRLCZ4AOAc1rm7HFnn82Jllz+7yW7PCwA4AaUN8FCrb/x4F4t8fWJn+Y3f/+m0z7fM83lZBAD72OawYzq/nPCft8/vBWBElDZAhfU3fn11pn/+PIcVPIuc/pjYn87wz6i0yLj/76Nvm4xzsmDfUuGY1jnd8ZhNzvzv6/GT9wf9+XdvHx0pCQBjp7QBpmiTw57gr44RwpN+AADgLv9RHQAAAACA31LaAAAAADRIaQMAAADQIKUNAAAAQIOUNgAAAAANUtoAAAAANEhpAwAAANAgpQ0AAABAg5Q2AAAAAA1S2gAAAAA0SGkDAAAA0CClDQAAAECDlDYAAAAADVLaAAAAADRIaQMAAADQIKUNAAAAQIOUNgAAAAANUtoAAAAANEhpAwAAANAgpQ0AAABAg5Q2AAAAAA1S2gAAAAA0SGkDAAAA0CClDQAAAECDlDYAAAAADVLaAAAAADRIaQMAAADQIKUNAAAAQIOUNgAAAAANUtoAAAAANEhpAwAAANAgpQ0AAABAg5Q2AAAAAA1S2gAAAAA0SGkDAAAA0CClDQAAAECDlDYAAAAADVLaAAAAADRIaQMAAADQIKUNAAAAQIN+Xx0A4AA/Vwc4xLu3j6ojAEzF99UBAOAhlDZAz5bVAQAAAE7F8SgAAACABiltAAAAABqktAEAAABokNIGAAAAoEFKGwAAAIAGKW0AAAAAGqS0AQAAAGiQ0gYAAACgQUobAAAAgAYpbQAAAAAapLQBAAAAaJDSBgAAAKBBShsAAACABiltAAAAABqktAEAAABokNIGAAAAoEFKGwAAAIAGKW0AAAAAGqS0AQAAAGiQ0gYAAACgQUobAAAAgAYpbQAAAAAapLQBAAAAaJDSBgAAAKBBShsAAACABiltAAAAABqktAEAAABokNIGAAAAoEFKGwAAAIAGKW0AAAAAGqS0AQAAAGiQ0gYAAACgQUobAAAAgAYpbQAAAAAapLQBAAAAaJDSBgAAAKBBShsAAACABiltAAAAABqktAEAAABokNIGAAAAoEFKGwAAAIAGKW0AAAAAGqS0AQAAAGiQ0gYAAACgQUobAAAAgAYpbQAAAAAapLQBAAAAaJDSBgAAAKBBShsAAACABiltAAAAABqktAEAAABokNIGAAAAoEFKGwAAAIAGKW0AAAAAGqS0AQAAAGiQ0gYAAACgQUobAAAAgAYpbQAAAAAapLQBAAAAaJDSBgAAAKBBShsAAACABiltAAAAABqktAEAAABokNIGAAAAoEFKGwAAAIAGKW0AAAAAGqS0AQAAAGiQ0gYAAACgQUobAAAAgAYpbQAAAAAapLQBAAAAaJDSBgAAAKBBShsAAACABiltAAAAABqktAEAAABokNIGAAAAoEFKGwAAAIAGKW0AAAAAGqS0AQAAAGiQ0gYAAACgQUobAAAAgAYpbQAAAAAapLQBAAAAaJDSBgAAAKBBShsAAACABiltAAAAABqktAEAAABokNIGAAAAoEFKGwAAAIAGKW0AAAAAGqS0AQAAAGiQ0gYAAACgQUobAAAAgAYpbQAAAAAapLQBAAAAaJDSBgAAAKBBShsAAACABiltAAAAABqktAEAAABokNIGAAAAoEFKGwAAAIAGKW0AAAAAGqS0AQAAAGiQ0gYAAACgQUobAAAAgAYpbQAAAAAapLQBAAAAaJDSBgAAAKBBShsAAACABiltAAAAABqktAEAAABokNIGAAAAoEFKGwAAAIAGKW0AAAAAGqS0AQAAAGiQ0gYAAACgQUobAAAAgAYpbQAAAAAapLQBAAAAaJDSBgAAAKBBShsAAACABiltAAAAABqktAEAAABokNIGAAAAoEFKGwAAAIAGKW0AAAAAGqS0AQAAAGiQ0gYAAACgQUobAAAAgAYpbQAAAAAapLQBAAAAaJDSBgAAAKBBv/vw4UN1BgAAAAC+YNIGAAAAoEFKGwAAAIAGKW0AAAAAGqS0AQAAAGiQ0gYAAACgQUobAAAAgAYpbQAAAAAapLQBAAAAaJDSBgAAAKBBShsAAACABiltAAAAABqktAEAAABokNIGAAAAoEFKGwAAAIAGKW0AAAAAGqS0AQAAAGiQ0gYAAACgQUobAAAAgAYpbQAAAAAapLQBAAAAaJDSBgAAAKBBShsAAACABiltAAAAABqktAEAAABokNIGAAAAoEFKGwAAAIAGKW0AAAAAGqS0AQAAAGiQ0gYAAACgQUobAAAAgAYpbQAAAAAapLQBAAAAaJDSBgAAAKBBShsAAACABiltAAAAABqktAEAAABokNIGAAAAoEFKGwAAAIAGKW0AAAAAGqS0AQAAAGiQ0gYAAACgQUobAAAAgAYpbQAAAAAapLQBAAAAaJDSBgAAAKBBShsAAACABiltAAAAABqktAEAAABokNIGAAAAoEFKGwAAAIAGKW0AAAAAGqS0AQAAAGiQ0gYAAACgQf8PASlwIILbYWUAAAAASUVORK5CYII="})])],-1)),Yw=Il(()=>Xe("div",{class:"logoText"},[Xe("svg",{width:"163",height:"23",viewBox:"0 0 163 23",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[Xe("path",{d:"M14.1751 12.52H18.9001V20.35C17.8201 21.124 16.5781 21.718 15.1741 22.132C13.7701 22.546 12.366 22.753 10.962 22.753C8.98205 22.753 7.20005 22.339 5.61605 21.511C4.03205 20.665 2.79005 19.495 1.89005 18.001C0.990048 16.507 0.540048 14.815 0.540048 12.925C0.540048 11.035 0.990048 9.343 1.89005 7.849C2.79005 6.355 4.04105 5.194 5.64305 4.366C7.24505 3.52 9.05405 3.097 11.07 3.097C12.834 3.097 14.418 3.394 15.8221 3.988C17.2261 4.582 18.3961 5.437 19.3321 6.553L15.9301 9.631C14.6521 8.227 13.1221 7.525 11.34 7.525C9.72005 7.525 8.41505 8.02 7.42505 9.01C6.43505 9.982 5.94005 11.287 5.94005 12.925C5.94005 13.969 6.16505 14.905 6.61505 15.733C7.06505 16.543 7.69505 17.182 8.50505 17.65C9.31505 18.1 10.242 18.325 11.286 18.325C12.312 18.325 13.2751 18.118 14.1751 17.704V12.52ZM26.9334 9.496C27.4554 8.83 28.1304 8.335 28.9584 8.011C29.8044 7.669 30.7674 7.498 31.8474 7.498V12.115C31.3794 12.061 30.9924 12.034 30.6864 12.034C29.5884 12.034 28.7244 12.331 28.0944 12.925C27.4824 13.519 27.1764 14.428 27.1764 15.652V22.375H22.0464V7.741H26.9334V9.496ZM41.1765 22.618C39.6105 22.618 38.1975 22.294 36.9375 21.646C35.6775 20.998 34.6875 20.098 33.9675 18.946C33.2655 17.794 32.9145 16.489 32.9145 15.031C32.9145 13.591 33.2655 12.295 33.9675 11.143C34.6875 9.991 35.6685 9.1 36.9105 8.47C38.1705 7.822 39.5925 7.498 41.1765 7.498C42.7605 7.498 44.1825 7.822 45.4425 8.47C46.7025 9.1 47.6835 9.991 48.3855 11.143C49.0875 12.277 49.4385 13.573 49.4385 15.031C49.4385 16.489 49.0875 17.794 48.3855 18.946C47.6835 20.098 46.7025 20.998 45.4425 21.646C44.1825 22.294 42.7605 22.618 41.1765 22.618ZM41.1765 18.541C42.0765 18.541 42.8145 18.235 43.3905 17.623C43.9665 16.993 44.2545 16.129 44.2545 15.031C44.2545 13.951 43.9665 13.105 43.3905 12.493C42.8145 11.881 42.0765 11.575 41.1765 11.575C40.2765 11.575 39.5385 11.881 38.9625 12.493C38.3865 13.105 38.0985 13.951 38.0985 15.031C38.0985 16.129 38.3865 16.993 38.9625 17.623C39.5385 18.235 40.2765 18.541 41.1765 18.541ZM57.134 22.618C55.91 22.618 54.704 22.483 53.516 22.213C52.328 21.925 51.374 21.556 50.654 21.106L52.193 17.596C52.859 18.01 53.651 18.343 54.569 18.595C55.487 18.829 56.396 18.946 57.296 18.946C58.124 18.946 58.709 18.865 59.051 18.703C59.411 18.523 59.591 18.271 59.591 17.947C59.591 17.623 59.375 17.398 58.943 17.272C58.529 17.128 57.863 16.993 56.945 16.867C55.775 16.723 54.776 16.534 53.948 16.3C53.138 16.066 52.436 15.634 51.842 15.004C51.248 14.374 50.951 13.492 50.951 12.358C50.951 11.422 51.23 10.594 51.788 9.874C52.346 9.136 53.156 8.56 54.218 8.146C55.298 7.714 56.585 7.498 58.079 7.498C59.141 7.498 60.194 7.606 61.238 7.822C62.282 8.038 63.155 8.344 63.857 8.74L62.318 12.223C61.022 11.503 59.618 11.143 58.106 11.143C57.296 11.143 56.702 11.242 56.324 11.44C55.946 11.62 55.757 11.863 55.757 12.169C55.757 12.511 55.964 12.754 56.378 12.898C56.792 13.024 57.476 13.159 58.43 13.303C59.636 13.483 60.635 13.69 61.427 13.924C62.219 14.158 62.903 14.59 63.479 15.22C64.073 15.832 64.37 16.696 64.37 17.812C64.37 18.73 64.091 19.558 63.533 20.296C62.975 21.016 62.147 21.583 61.049 21.997C59.969 22.411 58.664 22.618 57.134 22.618ZM71.8996 22.618C70.6756 22.618 69.4696 22.483 68.2816 22.213C67.0936 21.925 66.1396 21.556 65.4196 21.106L66.9586 17.596C67.6246 18.01 68.4166 18.343 69.3346 18.595C70.2526 18.829 71.1616 18.946 72.0616 18.946C72.8896 18.946 73.4746 18.865 73.8166 18.703C74.1766 18.523 74.3566 18.271 74.3566 17.947C74.3566 17.623 74.1406 17.398 73.7086 17.272C73.2946 17.128 72.6286 16.993 71.7106 16.867C70.5406 16.723 69.5416 16.534 68.7136 16.3C67.9036 16.066 67.2016 15.634 66.6076 15.004C66.0136 14.374 65.7166 13.492 65.7166 12.358C65.7166 11.422 65.9956 10.594 66.5536 9.874C67.1116 9.136 67.9216 8.56 68.9836 8.146C70.0636 7.714 71.3506 7.498 72.8446 7.498C73.9066 7.498 74.9596 7.606 76.0036 7.822C77.0476 8.038 77.9206 8.344 78.6226 8.74L77.0836 12.223C75.7876 11.503 74.3836 11.143 72.8716 11.143C72.0616 11.143 71.4676 11.242 71.0896 11.44C70.7116 11.62 70.5226 11.863 70.5226 12.169C70.5226 12.511 70.7296 12.754 71.1436 12.898C71.5576 13.024 72.2416 13.159 73.1956 13.303C74.4016 13.483 75.4006 13.69 76.1926 13.924C76.9846 14.158 77.6686 14.59 78.2446 15.22C78.8386 15.832 79.1356 16.696 79.1356 17.812C79.1356 18.73 78.8566 19.558 78.2986 20.296C77.7406 21.016 76.9126 21.583 75.8146 21.997C74.7346 22.411 73.4296 22.618 71.8996 22.618ZM90.2292 3.475C91.9392 3.475 93.4242 3.763 94.6842 4.339C95.9442 4.897 96.9162 5.707 97.6002 6.769C98.2842 7.813 98.6262 9.046 98.6262 10.468C98.6262 11.89 98.2842 13.123 97.6002 14.167C96.9162 15.211 95.9442 16.021 94.6842 16.597C93.4242 17.155 91.9392 17.434 90.2292 17.434H86.9352V22.375H81.5892V3.475H90.2292ZM89.9052 13.222C91.0032 13.222 91.8312 12.988 92.3892 12.52C92.9472 12.034 93.2262 11.35 93.2262 10.468C93.2262 9.586 92.9472 8.902 92.3892 8.416C91.8312 7.93 91.0032 7.687 89.9052 7.687H86.9352V13.222H89.9052ZM106.009 9.496C106.531 8.83 107.206 8.335 108.034 8.011C108.88 7.669 109.843 7.498 110.923 7.498V12.115C110.455 12.061 110.068 12.034 109.762 12.034C108.664 12.034 107.8 12.331 107.17 12.925C106.558 13.519 106.252 14.428 106.252 15.652V22.375H101.122V7.741H106.009V9.496ZM120.252 22.618C118.686 22.618 117.273 22.294 116.013 21.646C114.753 20.998 113.763 20.098 113.043 18.946C112.341 17.794 111.99 16.489 111.99 15.031C111.99 13.591 112.341 12.295 113.043 11.143C113.763 9.991 114.744 9.1 115.986 8.47C117.246 7.822 118.668 7.498 120.252 7.498C121.836 7.498 123.258 7.822 124.518 8.47C125.778 9.1 126.759 9.991 127.461 11.143C128.163 12.277 128.514 13.573 128.514 15.031C128.514 16.489 128.163 17.794 127.461 18.946C126.759 20.098 125.778 20.998 124.518 21.646C123.258 22.294 121.836 22.618 120.252 22.618ZM120.252 18.541C121.152 18.541 121.89 18.235 122.466 17.623C123.042 16.993 123.33 16.129 123.33 15.031C123.33 13.951 123.042 13.105 122.466 12.493C121.89 11.881 121.152 11.575 120.252 11.575C119.352 11.575 118.614 11.881 118.038 12.493C117.462 13.105 117.174 13.951 117.174 15.031C117.174 16.129 117.462 16.993 118.038 17.623C118.614 18.235 119.352 18.541 120.252 18.541ZM136.479 8.281H139.962V12.115H136.614V22.375H131.484V12.115H129.351V8.281H131.484V7.903C131.484 6.121 132.015 4.708 133.077 3.664C134.157 2.62 135.66 2.098 137.586 2.098C138.234 2.098 138.864 2.161 139.476 2.287C140.088 2.413 140.592 2.602 140.988 2.854L139.719 6.472C139.215 6.184 138.702 6.04 138.18 6.04C137.64 6.04 137.217 6.202 136.911 6.526C136.623 6.85 136.479 7.327 136.479 7.957V8.281ZM144.012 7.741H149.142V22.375H144.012V7.741ZM146.577 6.121C145.641 6.121 144.885 5.86 144.309 5.338C143.733 4.816 143.445 4.168 143.445 3.394C143.445 2.62 143.733 1.972 144.309 1.45C144.885 0.927996 145.641 0.666996 146.577 0.666996C147.513 0.666996 148.269 0.918996 148.845 1.423C149.421 1.909 149.709 2.539 149.709 3.313C149.709 4.123 149.421 4.798 148.845 5.338C148.269 5.86 147.513 6.121 146.577 6.121ZM162.557 21.781C162.125 22.051 161.594 22.258 160.964 22.402C160.352 22.546 159.695 22.618 158.993 22.618C157.085 22.618 155.618 22.15 154.592 21.214C153.566 20.278 153.053 18.883 153.053 17.029V12.115H150.92V8.281H153.053V4.474H158.183V8.281H161.531V12.115H158.183V16.975C158.183 17.497 158.318 17.911 158.588 18.217C158.876 18.505 159.254 18.649 159.722 18.649C160.316 18.649 160.838 18.496 161.288 18.19L162.557 21.781Z",fill:"#182061"})]),Xe("svg",{width:"98",height:"6",viewBox:"0 0 98 6",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[Xe("path",{d:"M2.53961 3.20825H1.45961V5.375H0.973605V0.649999H1.45961V2.7695H2.53961L4.13936 0.649999H4.67936L2.92436 2.945L4.78061 5.375H4.20686L2.53961 3.20825ZM7.06126 5.40875C6.71926 5.40875 6.41101 5.33225 6.13651 5.17925C5.86201 5.02175 5.64601 4.80575 5.48851 4.53125C5.33101 4.25675 5.25226 3.94625 5.25226 3.59975C5.25226 3.25325 5.33101 2.94275 5.48851 2.66825C5.64601 2.39375 5.86201 2.18 6.13651 2.027C6.41101 1.874 6.71926 1.7975 7.06126 1.7975C7.40326 1.7975 7.71151 1.874 7.98601 2.027C8.26051 2.18 8.47426 2.39375 8.62726 2.66825C8.78476 2.94275 8.86351 3.25325 8.86351 3.59975C8.86351 3.94625 8.78476 4.25675 8.62726 4.53125C8.47426 4.80575 8.26051 5.02175 7.98601 5.17925C7.71151 5.33225 7.40326 5.40875 7.06126 5.40875ZM7.06126 4.9835C7.31326 4.9835 7.53826 4.92725 7.73626 4.81475C7.93876 4.69775 8.09626 4.5335 8.20876 4.322C8.32126 4.1105 8.37751 3.86975 8.37751 3.59975C8.37751 3.32975 8.32126 3.089 8.20876 2.8775C8.09626 2.666 7.93876 2.504 7.73626 2.3915C7.53826 2.2745 7.31326 2.216 7.06126 2.216C6.80926 2.216 6.58201 2.2745 6.37951 2.3915C6.18151 2.504 6.02401 2.666 5.90701 2.8775C5.79451 3.089 5.73826 3.32975 5.73826 3.59975C5.73826 3.86975 5.79451 4.1105 5.90701 4.322C6.02401 4.5335 6.18151 4.69775 6.37951 4.81475C6.58201 4.92725 6.80926 4.9835 7.06126 4.9835ZM10.0903 1.8245H10.5695V3.39725H12.8038V1.8245H13.283V5.375H12.8038V3.809H10.5695V5.375H10.0903V1.8245ZM16.3327 5.40875C15.9817 5.40875 15.6667 5.33225 15.3877 5.17925C15.1132 5.02625 14.8972 4.8125 14.7397 4.538C14.5822 4.259 14.5035 3.94625 14.5035 3.59975C14.5035 3.25325 14.5822 2.94275 14.7397 2.66825C14.8972 2.39375 15.1132 2.18 15.3877 2.027C15.6667 1.874 15.9817 1.7975 16.3327 1.7975C16.6387 1.7975 16.911 1.85825 17.1495 1.97975C17.3925 2.09675 17.5837 2.27 17.7232 2.4995L17.3655 2.7425C17.2485 2.567 17.1 2.4365 16.92 2.351C16.74 2.261 16.5442 2.216 16.3327 2.216C16.0762 2.216 15.8445 2.2745 15.6375 2.3915C15.435 2.504 15.2752 2.666 15.1582 2.8775C15.0457 3.089 14.9895 3.32975 14.9895 3.59975C14.9895 3.87425 15.0457 4.11725 15.1582 4.32875C15.2752 4.53575 15.435 4.69775 15.6375 4.81475C15.8445 4.92725 16.0762 4.9835 16.3327 4.9835C16.5442 4.9835 16.74 4.94075 16.92 4.85525C17.1 4.76975 17.2485 4.63925 17.3655 4.46375L17.7232 4.70675C17.5837 4.93625 17.3925 5.11175 17.1495 5.23325C16.9065 5.35025 16.6342 5.40875 16.3327 5.40875ZM20.0754 1.7975C20.5389 1.7975 20.8944 1.9145 21.1419 2.1485C21.3894 2.378 21.5132 2.72 21.5132 3.1745V5.375H21.0542V4.8215C20.9462 5.006 20.7864 5.15 20.5749 5.2535C20.3679 5.357 20.1204 5.40875 19.8324 5.40875C19.4364 5.40875 19.1214 5.31425 18.8874 5.12525C18.6534 4.93625 18.5364 4.6865 18.5364 4.376C18.5364 4.0745 18.6444 3.8315 18.8604 3.647C19.0809 3.4625 19.4297 3.37025 19.9067 3.37025H21.0339V3.15425C21.0339 2.84825 20.9484 2.6165 20.7774 2.459C20.6064 2.297 20.3567 2.216 20.0282 2.216C19.8032 2.216 19.5872 2.25425 19.3802 2.33075C19.1732 2.40275 18.9954 2.504 18.8469 2.6345L18.6309 2.27675C18.8109 2.12375 19.0269 2.00675 19.2789 1.92575C19.5309 1.84025 19.7964 1.7975 20.0754 1.7975ZM19.9067 5.03075C20.1767 5.03075 20.4084 4.97 20.6019 4.8485C20.7954 4.7225 20.9394 4.5425 21.0339 4.3085V3.728H19.9202C19.3127 3.728 19.0089 3.9395 19.0089 4.3625C19.0089 4.5695 19.0877 4.73375 19.2452 4.85525C19.4027 4.97225 19.6232 5.03075 19.9067 5.03075ZM25.894 1.8245V5.375H25.4147V2.24975H23.7137L23.6665 3.12725C23.6305 3.86525 23.545 4.43225 23.41 4.82825C23.275 5.22425 23.0342 5.42225 22.6877 5.42225C22.5932 5.42225 22.4785 5.40425 22.3435 5.36825L22.3772 4.9565C22.4582 4.9745 22.5145 4.9835 22.546 4.9835C22.7305 4.9835 22.87 4.898 22.9645 4.727C23.059 4.556 23.122 4.3445 23.1535 4.0925C23.185 3.8405 23.212 3.5075 23.2345 3.0935L23.2952 1.8245H25.894ZM29.9564 2.24975H28.6131V5.375H28.1339V2.24975H26.7906V1.8245H29.9564V2.24975ZM30.8518 1.8245H31.331V4.646L33.7003 1.8245H34.1255V5.375H33.6463V2.5535L31.2838 5.375H30.8518V1.8245ZM35.7015 1.8245H36.1808V3.39725H38.415V1.8245H38.8943V5.375H38.415V3.809H36.1808V5.375H35.7015V1.8245ZM42.9699 2.24975H40.9382V5.375H40.4589V1.8245H42.9699V2.24975ZM45.165 5.40875C44.823 5.40875 44.5148 5.33225 44.2403 5.17925C43.9658 5.02175 43.7498 4.80575 43.5923 4.53125C43.4348 4.25675 43.356 3.94625 43.356 3.59975C43.356 3.25325 43.4348 2.94275 43.5923 2.66825C43.7498 2.39375 43.9658 2.18 44.2403 2.027C44.5148 1.874 44.823 1.7975 45.165 1.7975C45.507 1.7975 45.8153 1.874 46.0898 2.027C46.3643 2.18 46.578 2.39375 46.731 2.66825C46.8885 2.94275 46.9673 3.25325 46.9673 3.59975C46.9673 3.94625 46.8885 4.25675 46.731 4.53125C46.578 4.80575 46.3643 5.02175 46.0898 5.17925C45.8153 5.33225 45.507 5.40875 45.165 5.40875ZM45.165 4.9835C45.417 4.9835 45.642 4.92725 45.84 4.81475C46.0425 4.69775 46.2 4.5335 46.3125 4.322C46.425 4.1105 46.4813 3.86975 46.4813 3.59975C46.4813 3.32975 46.425 3.089 46.3125 2.8775C46.2 2.666 46.0425 2.504 45.84 2.3915C45.642 2.2745 45.417 2.216 45.165 2.216C44.913 2.216 44.6858 2.2745 44.4833 2.3915C44.2853 2.504 44.1278 2.666 44.0108 2.8775C43.8983 3.089 43.842 3.32975 43.842 3.59975C43.842 3.86975 43.8983 4.1105 44.0108 4.322C44.1278 4.5335 44.2853 4.69775 44.4833 4.81475C44.6858 4.92725 44.913 4.9835 45.165 4.9835ZM50.4553 3.539C50.9368 3.6515 51.1775 3.94175 51.1775 4.40975C51.1775 4.72025 51.0628 4.95875 50.8333 5.12525C50.6038 5.29175 50.2618 5.375 49.8073 5.375H48.194V1.8245H49.76C50.165 1.8245 50.4823 1.90325 50.7118 2.06075C50.9413 2.21825 51.056 2.44325 51.056 2.73575C51.056 2.92925 51.002 3.09575 50.894 3.23525C50.7905 3.37025 50.6443 3.4715 50.4553 3.539ZM48.6598 3.404H49.7263C50.0008 3.404 50.21 3.35225 50.354 3.24875C50.5025 3.14525 50.5768 2.9945 50.5768 2.7965C50.5768 2.5985 50.5025 2.45 50.354 2.351C50.21 2.252 50.0008 2.2025 49.7263 2.2025H48.6598V3.404ZM49.787 4.997C50.093 4.997 50.3225 4.9475 50.4755 4.8485C50.6285 4.7495 50.705 4.59425 50.705 4.38275C50.705 4.17125 50.6353 4.016 50.4958 3.917C50.3563 3.8135 50.1358 3.76175 49.8343 3.76175H48.6598V4.997H49.787ZM53.968 5.40875C53.626 5.40875 53.3177 5.33225 53.0432 5.17925C52.7687 5.02175 52.5527 4.80575 52.3952 4.53125C52.2377 4.25675 52.159 3.94625 52.159 3.59975C52.159 3.25325 52.2377 2.94275 52.3952 2.66825C52.5527 2.39375 52.7687 2.18 53.0432 2.027C53.3177 1.874 53.626 1.7975 53.968 1.7975C54.31 1.7975 54.6182 1.874 54.8927 2.027C55.1672 2.18 55.381 2.39375 55.534 2.66825C55.6915 2.94275 55.7702 3.25325 55.7702 3.59975C55.7702 3.94625 55.6915 4.25675 55.534 4.53125C55.381 4.80575 55.1672 5.02175 54.8927 5.17925C54.6182 5.33225 54.31 5.40875 53.968 5.40875ZM53.968 4.9835C54.22 4.9835 54.445 4.92725 54.643 4.81475C54.8455 4.69775 55.003 4.5335 55.1155 4.322C55.228 4.1105 55.2842 3.86975 55.2842 3.59975C55.2842 3.32975 55.228 3.089 55.1155 2.8775C55.003 2.666 54.8455 2.504 54.643 2.3915C54.445 2.2745 54.22 2.216 53.968 2.216C53.716 2.216 53.4887 2.2745 53.2862 2.3915C53.0882 2.504 52.9307 2.666 52.8137 2.8775C52.7012 3.089 52.645 3.32975 52.645 3.59975C52.645 3.86975 52.7012 4.1105 52.8137 4.322C52.9307 4.5335 53.0882 4.69775 53.2862 4.81475C53.4887 4.92725 53.716 4.9835 53.968 4.9835ZM60.102 3.74825H57.132C57.159 4.11725 57.3007 4.4165 57.5572 4.646C57.8137 4.871 58.1377 4.9835 58.5292 4.9835C58.7497 4.9835 58.9522 4.94525 59.1367 4.86875C59.3212 4.78775 59.481 4.67075 59.616 4.51775L59.886 4.82825C59.7285 5.01725 59.5305 5.16125 59.292 5.26025C59.058 5.35925 58.7992 5.40875 58.5157 5.40875C58.1512 5.40875 57.8272 5.33225 57.5437 5.17925C57.2647 5.02175 57.0465 4.80575 56.889 4.53125C56.7315 4.25675 56.6527 3.94625 56.6527 3.59975C56.6527 3.25325 56.727 2.94275 56.8755 2.66825C57.0285 2.39375 57.2355 2.18 57.4965 2.027C57.762 1.874 58.059 1.7975 58.3875 1.7975C58.716 1.7975 59.0107 1.874 59.2717 2.027C59.5327 2.18 59.7375 2.39375 59.886 2.66825C60.0345 2.93825 60.1087 3.24875 60.1087 3.59975L60.102 3.74825ZM58.3875 2.20925C58.0455 2.20925 57.7575 2.3195 57.5235 2.54C57.294 2.756 57.1635 3.0395 57.132 3.3905H59.6497C59.6182 3.0395 59.4855 2.756 59.2515 2.54C59.022 2.3195 58.734 2.20925 58.3875 2.20925ZM64.5629 1.7975C65.0264 1.7975 65.3819 1.9145 65.6294 2.1485C65.8769 2.378 66.0007 2.72 66.0007 3.1745V5.375H65.5417V4.8215C65.4337 5.006 65.2739 5.15 65.0624 5.2535C64.8554 5.357 64.6079 5.40875 64.3199 5.40875C63.9239 5.40875 63.6089 5.31425 63.3749 5.12525C63.1409 4.93625 63.0239 4.6865 63.0239 4.376C63.0239 4.0745 63.1319 3.8315 63.3479 3.647C63.5684 3.4625 63.9172 3.37025 64.3942 3.37025H65.5214V3.15425C65.5214 2.84825 65.4359 2.6165 65.2649 2.459C65.0939 2.297 64.8442 2.216 64.5157 2.216C64.2907 2.216 64.0747 2.25425 63.8677 2.33075C63.6607 2.40275 63.4829 2.504 63.3344 2.6345L63.1184 2.27675C63.2984 2.12375 63.5144 2.00675 63.7664 1.92575C64.0184 1.84025 64.2839 1.7975 64.5629 1.7975ZM64.3942 5.03075C64.6642 5.03075 64.8959 4.97 65.0894 4.8485C65.2829 4.7225 65.4269 4.5425 65.5214 4.3085V3.728H64.4077C63.8002 3.728 63.4964 3.9395 63.4964 4.3625C63.4964 4.5695 63.5752 4.73375 63.7327 4.85525C63.8902 4.97225 64.1107 5.03075 64.3942 5.03075ZM69.99 2.24975H67.9582V5.375H67.479V1.8245H69.99V2.24975ZM73.8253 3.74825H70.8553C70.8823 4.11725 71.0241 4.4165 71.2806 4.646C71.5371 4.871 71.8611 4.9835 72.2526 4.9835C72.4731 4.9835 72.6756 4.94525 72.8601 4.86875C73.0446 4.78775 73.2043 4.67075 73.3393 4.51775L73.6093 4.82825C73.4518 5.01725 73.2538 5.16125 73.0153 5.26025C72.7813 5.35925 72.5226 5.40875 72.2391 5.40875C71.8746 5.40875 71.5506 5.33225 71.2671 5.17925C70.9881 5.02175 70.7698 4.80575 70.6123 4.53125C70.4548 4.25675 70.3761 3.94625 70.3761 3.59975C70.3761 3.25325 70.4503 2.94275 70.5988 2.66825C70.7518 2.39375 70.9588 2.18 71.2198 2.027C71.4853 1.874 71.7823 1.7975 72.1108 1.7975C72.4393 1.7975 72.7341 1.874 72.9951 2.027C73.2561 2.18 73.4608 2.39375 73.6093 2.66825C73.7578 2.93825 73.8321 3.24875 73.8321 3.59975L73.8253 3.74825ZM72.1108 2.20925C71.7688 2.20925 71.4808 2.3195 71.2468 2.54C71.0173 2.756 70.8868 3.0395 70.8553 3.3905H73.3731C73.3416 3.0395 73.2088 2.756 72.9748 2.54C72.7453 2.3195 72.4573 2.20925 72.1108 2.20925ZM75.0954 1.8245H75.5747V3.39725H77.8089V1.8245H78.2882V5.375H77.8089V3.809H75.5747V5.375H75.0954V1.8245ZM82.3503 2.24975H81.0071V5.375H80.5278V2.24975H79.1846V1.8245H82.3503V2.24975ZM84.566 5.40875C84.215 5.40875 83.9 5.33225 83.621 5.17925C83.3465 5.02625 83.1305 4.8125 82.973 4.538C82.8155 4.259 82.7367 3.94625 82.7367 3.59975C82.7367 3.25325 82.8155 2.94275 82.973 2.66825C83.1305 2.39375 83.3465 2.18 83.621 2.027C83.9 1.874 84.215 1.7975 84.566 1.7975C84.872 1.7975 85.1442 1.85825 85.3827 1.97975C85.6257 2.09675 85.817 2.27 85.9565 2.4995L85.5987 2.7425C85.4817 2.567 85.3332 2.4365 85.1532 2.351C84.9732 2.261 84.7775 2.216 84.566 2.216C84.3095 2.216 84.0777 2.2745 83.8707 2.3915C83.6682 2.504 83.5085 2.666 83.3915 2.8775C83.279 3.089 83.2227 3.32975 83.2227 3.59975C83.2227 3.87425 83.279 4.11725 83.3915 4.32875C83.5085 4.53575 83.6682 4.69775 83.8707 4.81475C84.0777 4.92725 84.3095 4.9835 84.566 4.9835C84.7775 4.9835 84.9732 4.94075 85.1532 4.85525C85.3332 4.76975 85.4817 4.63925 85.5987 4.46375L85.9565 4.70675C85.817 4.93625 85.6257 5.11175 85.3827 5.23325C85.1397 5.35025 84.8675 5.40875 84.566 5.40875ZM89.5185 2.24975H88.1753V5.375H87.696V2.24975H86.3528V1.8245H89.5185V2.24975ZM92.6752 3.539C93.1567 3.6515 93.3975 3.94175 93.3975 4.40975C93.3975 4.72025 93.2827 4.95875 93.0532 5.12525C92.8237 5.29175 92.4817 5.375 92.0272 5.375H90.414V1.8245H91.98C92.385 1.8245 92.7022 1.90325 92.9317 2.06075C93.1612 2.21825 93.276 2.44325 93.276 2.73575C93.276 2.92925 93.222 3.09575 93.114 3.23525C93.0105 3.37025 92.8642 3.4715 92.6752 3.539ZM90.8797 3.404H91.9462C92.2207 3.404 92.43 3.35225 92.574 3.24875C92.7225 3.14525 92.7967 2.9945 92.7967 2.7965C92.7967 2.5985 92.7225 2.45 92.574 2.351C92.43 2.252 92.2207 2.2025 91.9462 2.2025H90.8797V3.404ZM92.007 4.997C92.313 4.997 92.5425 4.9475 92.6955 4.8485C92.8485 4.7495 92.925 4.59425 92.925 4.38275C92.925 4.17125 92.8552 4.016 92.7157 3.917C92.5762 3.8135 92.3557 3.76175 92.0542 3.76175H90.8797V4.997H92.007ZM96.1879 5.40875C95.8459 5.40875 95.5376 5.33225 95.2631 5.17925C94.9886 5.02175 94.7726 4.80575 94.6151 4.53125C94.4576 4.25675 94.3789 3.94625 94.3789 3.59975C94.3789 3.25325 94.4576 2.94275 94.6151 2.66825C94.7726 2.39375 94.9886 2.18 95.2631 2.027C95.5376 1.874 95.8459 1.7975 96.1879 1.7975C96.5299 1.7975 96.8381 1.874 97.1126 2.027C97.3871 2.18 97.6009 2.39375 97.7539 2.66825C97.9114 2.94275 97.9901 3.25325 97.9901 3.59975C97.9901 3.94625 97.9114 4.25675 97.7539 4.53125C97.6009 4.80575 97.3871 5.02175 97.1126 5.17925C96.8381 5.33225 96.5299 5.40875 96.1879 5.40875ZM96.1879 4.9835C96.4399 4.9835 96.6649 4.92725 96.8629 4.81475C97.0654 4.69775 97.2229 4.5335 97.3354 4.322C97.4479 4.1105 97.5041 3.86975 97.5041 3.59975C97.5041 3.32975 97.4479 3.089 97.3354 2.8775C97.2229 2.666 97.0654 2.504 96.8629 2.3915C96.6649 2.2745 96.4399 2.216 96.1879 2.216C95.9359 2.216 95.7086 2.2745 95.5061 2.3915C95.3081 2.504 95.1506 2.666 95.0336 2.8775C94.9211 3.089 94.8649 3.32975 94.8649 3.59975C94.8649 3.86975 94.9211 4.1105 95.0336 4.322C95.1506 4.5335 95.3081 4.69775 95.5061 4.81475C95.7086 4.92725 95.9359 4.9835 96.1879 4.9835Z",fill:"#182061"})])],-1)),Xw=Il(()=>Xe("p",{class:"accounting"},[ir(" \u0411\u0443\u0445\u0433\u0430\u043B\u0442\u0435\u0440\u0441\u043A\u0438\u0439 "),Xe("br"),ir(" \u0430\u0443\u0442\u0441\u043E\u0440\u0441\u0438\u043D\u0433 \u0443\u0441\u043B\u0443\u0433 ")],-1)),Qw=ir("\u0413\u043B\u0430\u0432\u043D\u0430\u044F"),Kw=ir("\u041E \u043D\u0430\u0441"),$w=ir("\u0423\u0441\u043B\u0443\u0433\u0438"),Jw=Il(()=>Xe("p",null,"(998) 99 218-55-88",-1)),e5=ir("\u0417\u0430\u043A\u0430\u0437\u0430\u0442\u044C"),t5=Il(()=>Xe("br",null,null,-1)),i5=ir("\u0437\u0432\u043E\u043D\u043E\u043A"),r5=[e5,t5,i5],n5=Il(()=>Xe("svg",{width:"300",height:"300",viewBox:"0 0 32 42",xmlns:"http://www.w3.org/2000/svg",onclick:"this.classList.toggle('active')"},[Xe("g",{transform:"matrix(1,0,0,1,-389.5,-264.004)"},[Xe("g",{id:"arrow_left2"},[Xe("g",{transform:"matrix(1,0,0,1,0,5)"},[Xe("path",{id:"top",d:"M390,270L420,270L420,270C420,270 420.195,250.19 405,265C389.805,279.81 390,279.967 390,279.967"})]),Xe("g",{transform:"matrix(1,1.22465e-16,1.22465e-16,-1,0.00024296,564.935)"},[Xe("path",{id:"bottom",d:"M390,270L420,270L420,270C420,270 420.195,250.19 405,265C389.805,279.81 390,279.967 390,279.967"})]),Xe("path",{id:"middle",d:"M390,284.967L420,284.967"})])])],-1)),o5=[n5];function s5(d,y,b,M,I,B){const G=Rr("RouterLink"),s=Rr("RouterView");return $r(),hn("div",Ww,[Xe("header",null,[Xe("nav",null,[li(G,{to:"/",class:"logoPart"},{default:aa(()=>[Hw,Yw,Xw]),_:1}),Xe("ul",{class:xs(d.showNav?"showNav":"")},[Xe("li",null,[li(G,{to:"/"},{default:aa(()=>[Qw]),_:1})]),Xe("li",null,[li(G,{to:"/about"},{default:aa(()=>[Kw]),_:1})]),Xe("li",null,[li(G,{to:"/service"},{default:aa(()=>[$w]),_:1})])],2),Xe("div",{class:xs(["phoneNumber",d.showNav?"showNav2":""])},[Jw,Xe("button",{onClick:y[0]||(y[0]=(...K)=>d.showBotForm&&d.showBotForm(...K))},r5)],2),Xe("div",{class:"icons",onClick:y[1]||(y[1]=(...K)=>d.showNavLinks&&d.showNavLinks(...K))},o5)])]),li(s)])}var a5=dn(qw,[["render",s5],["__scopeId","data-v-a2e6bc48"]]);const l5="modulepreload",Eg={},c5="/",Cg=function(y,b){return!b||b.length===0?y():Promise.all(b.map(M=>{if(M=`${c5}${M}`,M in Eg)return;Eg[M]=!0;const I=M.endsWith(".css"),B=I?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${M}"]${B}`))return;const G=document.createElement("link");if(G.rel=I?"stylesheet":l5,I||(G.as="script",G.crossOrigin=""),G.href=M,document.head.appendChild(G),I)return new Promise((s,K)=>{G.addEventListener("load",s),G.addEventListener("error",()=>K(new Error(`Unable to preload CSS for ${M}`)))})})).then(()=>y())},u5=V2({history:r2("/"),routes:[{path:"/",name:"home",component:Zy},{path:"/about",name:"about",component:()=>Cg(()=>import("./AboutView.2f6e33e5.js"),["assets/AboutView.2f6e33e5.js","assets/AboutView.71c475b2.css"])},{path:"/service",name:"service",component:()=>Cg(()=>import("./ServiceView.48950cf9.js"),["assets/ServiceView.48950cf9.js","assets/ServiceView.343ecb65.css"])}]});sf.accessToken="pk.eyJ1IjoiYWJkdWxraGFrIiwiYSI6ImNsMjd1ZTN5ejAxODIzY3AzcTRjc2sxcHAifQ.5NyEXgxDRXYrFwLhn7zW5Q";const Df=PA(a5);Df.use(FA());Df.use(u5);Df.mount("#app");export{Vw as F,Cw as H,dn as _,Ml as a,Pw as b,hn as c,li as d,fa as e,Xe as f,ir as g,wf as h,db as i,pb as j,mb as k,_b as l,fb as m,Io as n,$r as o,pa as p,p5 as q,Rr as r,ld as s,h5 as t,Qv as u,xs as v,d5 as w};
